(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{0:function(e,t,n){var o,r;window.GC?e.exports=window.GC:((o=n(428)).Spread.Sheets.LicenseKey=(r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC+aJAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAB3RJTUUH5AkSBgUFv5FyKQAAEvBJREFUaN7tWnl4nlWVP+fed/32L1/2rWlKl9BSCkilbC2biKMFkU1nRAccGZwqoKODMDMs44rr8KDD4+AoqCjoIFQUSimlUGQpLXSxadM0aZZmT779+97t3jN/vF/SlCZtuow8Po/3Sf7Im/e99/zOfs85SETwl7zYu03AXwG82wQc71JO8H4kCQh8u0L0fwkIAMYfMkQEwBN1IJ4QIyYSQISMz5Cy0vvIAY8XyXECIJIC2QEx2tne4sjOYrLdznR5xTESFkmBis6VoBau1aNNZqLFLJvP1UDpeykQEfDYNfnYAZD0JkjP9r+R6ng207uxOLrLs5IgPUAGyBAQEIEkEQFJAGCqqYXrg9Wnx5oujjW9Tw1UHCeMYwFAJBEAkBHJ0V2/Htz6UG5gE3k2U0xUdAAk4ZJ0iYRPNAAiMmQKchWRk/SEVwTpqaHaxLwPVy35tFk27x0c+X8EMHHMaNsT+1//dn7wLcZ1roVJOMLNAUmuR7VQrRauU4NVXA0h49KzPCvp5Pqc7H63MCiFw7jBtRBJIewU1yOJlmvrz7pdC9WWAB+NKI4KQEnj7Wxv57rbku1Pc8XkWthzMtKzjNjsaOOFseZLw3XLVLN8ui3yw9vSXS+kOtbk+jdJN8+NOCJziyNqoKrh3LuqFt8AvkYxfqIBEAEQIBtrX9259nNuYUgNVAonK91CqHZp9emryhdcDQBS2Nm+13N9rxXH2tz8oHDzJD2umlyL6tFZwcpTw3VnG7FmALDSnf2bHxht/ZVXHFMC5SRcz0qWt1zbfOl/cTU4c3WaGQAi39/1vvbN3lfu4WoIFcMtDJmJloZz7krMu8LXqOEdP88NbvYKIyQ9RAbIEdm4EUuSAoCYGjRizbHmS6tP/Qc92uQWR3s23jW842eInOsRJzcQqFw0//LHjVjzDDHMBID/Au5b/6X+Td9Tg9UkXeFkq5bcNPui7wLA4NaH+rc8UBzdhagw1WRMmwhffghDAPDdEQBJIYUl3QLXwvE5H6g/59/M+NxM7ysda262ku1qsMorjiqBiparVgfKF84EwwwAkARkXS/d2ffafVqoVrg5ZGrz+36QmP+R3MDmjrWr8gNbuBpkqgkERHIc8GHOZIiMpCfsDFONqtNunnX+V4lk21PXje1ZrQWrPDujmPGF16414nOOaA9HAODzoH/LA/vWfV4L1ggny43YgiufDFYu3v/Gd3pf+Q8A4lqYSI57zKNYyBSSwrNGQzVL513+Kz1c37nu1oEtD2rBKs9O6dHZiz72omLEfA4eCwCf+nT3i7t+s5LrYenZTA0uvO45s2x++7OfHt72E8UsR2RE4mhJPxiGKuwUN2Lzr3g8XLusc91tA1t+qIVq3fxArPmyBVc+AUCHyVCm97hEyBTPznQ8twq56uOcf8VjZtn8PU9fP7ztJ2qwGvys5vgWSZfrUekUWn+zMrv/1dkXfS+x4Go3P6AGq5Ptv+vb9H0AJOkdNQAiCQA9L/+7ldzDtbCwkrMuuC9ce1bn87eO7Pylb8pHVveZYvCYagDJXU9eZaX2zvvQzwOViz0rqQQq9r/2jeJYGzKFplHRqQEQCWQ81//m0I6H1UClWxgqm/+RqsU3DG778cBbP1SDVSTdE0L6JAyCKaa0s7ufvBoA5lz2EDKOyIST7XnlHpheh6YGgIAAsP/1+0i4JD3FLG++5H4729u94U5FjxNJRIbIS7aFDH2XDwCAiPzY8mSSHtejheE/daxdFaw4pfr0z7iFEcVMJPf8LtO7EaYxtikAEElAlhvYnNq3VjHinjVWc8YqxSjrfP4W4WSQqyCFcHKenSbPAmTkWZ6dFk6uxEkn4zlpEs4x3FpIuqqZGNr+cLbv9YZz79WjTeRZRHJgyw9LjJ2RBIgAYHjHI+TZJF090li79Avpng2pjmcVI07CBcYSLdfULbvdLG8RdtqsWFi37PaylquJJHKlfNH1tUu/qEebSNjHdF9BAOjZeBciVp92k2dnFCOW7nqhONaGyA511ofGOULGPTud6nyO6xHPTlcuvgGR973+HQAEYFJYFQtvmH3Bt5Ap0VkXdr14e9OF3w7XLCUSe/EfFSPetOI+AIg0nLf3mU9JJwfIj8rWiYSiRTI9GzP7/1i15Ka+Td8n6Xh2aqx9dd3Sf/a193AS8I0927vRznQjU5iiV55yvZXqzPZu5FqYSABiqOZMP8IHyhdFZl0QSJwMAIg8XH9euO4cf59Q1WlqqEZK9whC8O8JyPwL0AEZkBx8+7+5GojOulDYWa6YqY41AHBoZnGIChEAQLprPRBJr2gmWsyyBSO7HhNuvhTSCVIdz7jFEQBIdvx+5E+PjnX8AQDsXN/IzkdHWn/pWkkAGOt4xknvY1yDw0R6ROkW3MKw52Slk5NufjxfkkwNZnpeJOkm5l8JJJhiFkZ2WqkOAHiHFr0TkE9lbnALUwzpFiP15wFAunMt4zqQBJJMMVJ7n2nLD6rBKjVUU7fs9sLw9t1tT3A9VjZ3pfSsfetuk8LK9W+Sno1MnVZ/kEmvWDbv8kjD8kzPBqaYJNzR3b9hahBIMq65uYF01/po4wrFTBAJYafzQ28bsWYimizUgyVABABuftBOdyHXCChSf45w88WxNqYYE0kH43qme4ObH2xYdkf14hvr3vtFkiLW9L6a0z5Td+bnQ3XLkm1PSTuLXD2M9iMy6eQCFacEq08vm3tFuO4cM7FAuPmSiiMSyXTPBq6F9VgzeTYQ5Ye2HVCSKQH42a+d3S/sFCBjihGoOKU40upZSWDK5C8Z183yhYoeAwBFi4TqlgXKF/j/ClYuVgIVgAyOmOciCicr7AxJj6TjWSkEBuNFJGRqYWg7AJhlC6RwkClWaq8vusPYgC+BAenZQJJrYS1UW0y2k3RxstgQmWJkul5Ida2TnpXu3Tiy/eHhnb/y7Iyd6x/a/rB08yVrOyjGwUExDhki53oUmQoAilmuGPHJrESuOtleADBis4EEMsXNDwIAHuwVDrYBIkDwrKSv7lwLMcVw8/2T80EiIawcIHojre1Pf9KsWFQc3elk9lvJ9kzXC0QiP/gWIifhMjUg3TxJD5BxNUgkhZMDIMZ1ZIpXHAPAwbceTHWscTLdRIJxQzHiJP1wS4hcOBkAUoNVBATIfFlhSRdwaiMGAClsACIg5BoASLcwfqli0i0Eq5Y0nHuP9Apcj47teap34311y25NLLhaelb3hjsKwztO+sCP9UiTlerYt+7W+rPvjNSfZ2d6OtfdoocbG5d/VdEig1sfyva9NveS+xHZ4Nb/CdecGZ19iZPt7X7pX6V0mGICSSAARCkcKRymmCWrkC6RwINpnsnFeVxkJJliFEdb093rG8+92zd3AAjVLI3UnQ0Ag9EmK9kWb/6AYsTNxILO52+J1J8XrlsWrFrSue42xYjFZ18KAJnejYWRHbFZFwFAtPECf+9AokUNVv/p0RUHWw5OTcn0NgAAwBQTEBGQPBsAmBaaMF9ELuxstuflkqzcPCBIr1ACKBwiEHYGAISdBgDh5gDAs9O+7vnZmBTWRFpWGG3d/eQ1VrIdAIzILDVYQ9IBREAAIsY1xnXp5ktmzdUjBTJEAFCMOCAHZMLJCbeghWr82FhSTcaZFpps9JMii196KUGdtD8iAMhSFoDAJniZ6nh2YMuv80NbAYBgcpqAJAU3YgDg5AcQEEgoehRLiQlOAwAQALRQDeM6IBNO1sn2mGXzkGvjQQBpsjNVQySA67HSx1wDQKaGfGoApO8xmGISCW5Ep9ABZIoxkSAcKI8iIElXDzcAgJXcC0wh6Y3fAaePxP41QAvXKUZcOFkprPzQtrK5l6tmQrh5RIVKziHrvx9runjxJ9eHa8/y/5y1/Gu1S7+gGDEAKI60eoW0FDYAcDWw4KrVZmzOFJpMRDROE0nPSpKUyNE32WDVEgAoju1mXJNuwYzP9T+BaSMxIgCpZrkeayZhI/JM78uMa2biZPIsRASSTA3kB98aePtHAMC1cLRxBVOM4Z2PFkZbjdiccM1SRG5nunteuYep2tD2n/pcDtcsLab2+kYPRDhOAnIVCJii+6o7a/nXuB4B6QEQMiXauMItjtqpDuQ6IAtUnnoIAw7xQn71M1TznmzPS0wNZXtfAYB48/vTXeu4n44TMaZ1rf/SWNtvg5WnEon80NZMz0tasCbSuFwL1XrWWKpzjVdMqoHyVMezO36xPFR3lp3qzA28ecrfbQQA5LqVbN/95DWAaKU61GC099VvDG37KZFgSsDno/RsLVwXaTh/ZNfjnp1SjDLFTPgCOWwgG7e3aOOF/W/ezxTdGtuTG3wr0XJNzx+/cqA0gMjUQLb3lXTXegBgXFPNhHTzo62PE0lEZFqIqQGSHlOD+aGt2f43gKQeneXrOjIunGyq8zmSLuM6UwOFoW15uRkA/eiJXPPsdHnLtQAwuvsJxlTpFiIN5+rheiA6fCoBvh+I1C0zYs0kHJLe0PafasHqWNNFwskcKJKR5FpIDZSrgXKmhUgKQK4YcTVQrphliAqQ9AliakA1y33DmFB7YJzrEUWPoaL77yh6TNGjihH32w6M61Wn3eQWRzI9G7gWkcKKNV8GU1VxDo0DSNJjaiA+52+Ek+VGdKztt8LJ1r33X5Apk6tgRJKkR9Ibd6NEJEh6fhF3slKOPywZK2MqEAFJv1NWeoeE/4OMCzsdnX1JsGLxwOYfeMUkAKlmRdlJH5rg7+EBlF6qWPRxpoUQuVsY6n3168GqJYn5VwkreQxNlAOHcQ0AimO7cdp7JpKUjOuzzv+qcLJD23+iGHHPTsXmXKZHGokEzASAX8AIJFrKTlrpFcdUIzG09cdWet/si/9TDVZJzzrqZhYCkGRcB+RDOx4ZaX2c65HxpO0dJytecbT6jFVm2fyuDV9284PIFKYYNad/ZnyjQ5gy/ZlQ994v+kFXeIXOtau4Fp598f3SLeA0e027iJCpnp3e8Yvlnc/903R9YmSKZ42FG85tPO/edM+G4e2PKIEKrziSWHBtsHIJkcCpGMfvvvvuKfZCJOmpwUrh5lOda7RgVX5oG3K16tQbATG59/dcDx/5vnLwjiA9YSW5GpyUmBxEvXCyWqh24XXPA9Cu/10pvSIAKUZs7gd/xrUwAkxZH5i+bM04ADScfWew6gzPSqqB8v1//MrYntX1y+6oOfNWNz+Ik+sIM8OAij5lAwGZKpysYsRPvvoPihHb9cSVdrqLa2HPSjWcd68WqvEvFVPuehgKkEggU+e8/0Hkmu/U25+5MdPzUtMF36o7+w7XGoWjbYweKjREZIpXHNEiDQs/ut6Iz2lb/bfp7vVqoNLJ9Vcs+njlouuB5GFOmVGDY6T18fbff0IxE1LYiOykDz4Sn33pSOtjnetuE3ZaMWJAx1BnR2RcClvY6fhJH5y38peM67tXf3Ss7bdasMYtDIVqzlx43Vr0fe70xaUjt5j8Jk/f5vu7XvhnNVBFwpHCbjz/3pozPufk+vauuTnd+RwylWmhUrPjCBui3/mTwhZ2Rg1W1S/7cvVpNzv5wbanrs31va4Gq93CsFk29+Tr1qpmOZEYz8yPFQD4rXlkfZu+2/XiHYoZR2RuYbRs3ofnvP9BRY8mO9f0vf7tbN9rJF2uBJDryFjJUukA2f5GJF3pFaVwtFBN+ckfrV92J9dCI62P7Vv/JWGNKWa5mx80y1tarnraV/0T0eQDAH+CBtnQjp91Pn8LAnE96haG1UBl7dLP15zxWQDI9m8a3vFIpudlO9Pt36FKPVZAICKQ/jiLYiYC5aeUzb288pRPMMUojOzofvmu1N5nuBZGRXdzA9Gmi+atfFQx4iewzTouBpKIPNv/xt5nP10caVWDVSQcz0oa8bmVi/++6tQb/TKRldqb63+zONrq5AeEkyXhMjWoGHEj1hSoXBKqfo8/qpLp3di/+YFU5xqSnmqUCTcnPav6jFVNK745obczIevoZiV8rgg33/Xil4d3PAwkuRGXniXsjBpIhGqWRpsuijScH0icPCXz3MJwrn9TqmtdpntDcWwXEChGnKTrWUkz0TJrxdfjpYxN4owd9DEMe5R4k93/au9r38x0vUAkFT1KQNLNS89miq4YZWqwUjESXAsCMvJsz0m7+WGvOCzsDAAyNcAUU3pF4WT1SGPlqZ+qPeOzTA2QFOP2M9N1TPNCRATSdw6ZnpcH3v5RpusF1xpjTGGK6TfkxjNQ6TtBRI5MAcYBgDxbehYwbpbNr1j4sYpFn1DNxIR4j5aW4xh4IoHj13ArvS/dtS7d/WJhcKuT65NesXQfmPDfRACATOFGzIzPDdWdFWu6OFx3jp+fkvRmPq52wgBMwCi5dgAAEG7eSrZb6U473e1ZY9IrkvSYYnA1qIVq9WiTET9JD9cf+Fx6xzk5d2KG/vx5FF9VZva6B+jDfpeH/qagza+TTMy4+A/HT0OE4xrx+zMA+HOvv/jJ3b8CeLfX/wFwDQ+oD4/bFQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMC0wOS0xOFQwNjowMzo1MCswMDowMCVYxZkAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjAtMDktMThUMDY6MDM6NTArMDA6MDBUBX0lAAAAAElFTkSuQmCC/WYNR3JhcGVDaXR5LUludGVybmFsLVVzZS1Pbmx5LFd5biBEYXNoYm9hcmQsNTY4MzM3Mzk0NTE5NDQyI0IwcjNyNElsYXBkaldpZEhTa1Z6SzlKbVVXSjdWNk5HZXpzU2RydDRWbUpFUklGbWM3b0hXWVpEU0JoVWJrVlZZaVJWZUhwVlNFWmtjeEk1VTh3VWFuaFZTWHBIYlM1R2JUUlZWaFJsYWpkRWRGZDRVWFpqY0ZoRFdabFhkRlJHU0ZKSE5uTkhheUZqYXZGbFl4Sm5TNDltVnhsNk45WVhiNnNrYllSSGFEVmphbE5uWnJJRlpqVnpTSHRXTXMzbU1vNW1TdUpITjdkN0s4UlVWWUZsUzVvVVZaTmpZS3RrTlZaWE1NZDZiaFpsV0RsVWR4ZFZWcTlXYjlSNGJhdEdVT3Q2ZHNSa01ybFRNOU41U3lFSE41ZHpTdWQ2Tm1SRGNKcG1SQmRXZXBSa0kwSXlVaXdpSUJGa1FCSnpRd1FqSTBJQ1Npd2lNd2dUTzdjRE85QWpNMElpY2ZKeWUmUWYzNVZmaVVVUkpabEkwSXlRaXdpSTRFakw2QkNJVHBFSWtGV1p5QjdVaW9qSU9KeWVicGpJa0pIVWl3aUk3UUROeVlETWdBak14RURNeUFqTWlvakk0SjdRaXdpSXlWR1p1Rm1jQ0JTYWhobVdpb2pJaDk0UWl3aUl5UUROOUVUTjRrek03TXpNOFlUTmlvaklrbGtJczRYWnp4V1ltcGpJeU5IWmlzbk9pd21iQkp5ZTBJQ1Jpd2lJMzR6WjZKWFlWNWtNNGdWV1NSSFU0VlZiSnR5Y1FSNU1CSlVibnA1UktoV1VuVlRRcmxtU3pWNlFGWm1iSzNFZFM5R2NLM1VTaVJIZXg4a1dyUVZOeXR5Tk9aWFJtQnpWdUZGZVlabVF2TVZXcVZHVjU0NlZsRlRPOE56THZsVFp4ZDROTWRFZEJoR1M4SVZhbjltVHY5bU52UjVTeHVtZTY=",atob(r.substring(r.indexOf("/WYN")+4))),window.GC=o,e.exports=o)},428:function(e,t,n){var o,r,i="object"==typeof i?i:{};
/*!
 * 
 * SpreadJS Library 13.1.1
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */i.Spread=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){var o,r;if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;if(o=Object.create(null),n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./all.entry.js")}({"./all.entry.js":function(e,t,n){(i=i||{}).Spread=i.Spread||{},i.Spread=n("./node_modules_local/@grapecity/js-sheets-common/index.js"),i.Spread.CalcEngine=n("./node_modules_local/@grapecity/js-calc/index.js"),i.Spread.CalcEngine.BasicFunctions=n("./node_modules_local/@grapecity/js-calc-basicfunctions/index.js"),i.Spread.CalcEngine.AdvancedFunctions=n("./node_modules_local/@grapecity/js-calc-advancedfunctions/index.js"),i.Spread.Sheets=n("./dist/core/core.entry.js"),i.Spread.Sheets.Bindings=n("./dist/plugins/data/data.entry.js"),i.Spread.Sheets.CalcEngine=n("./dist/plugins/sheetsCalc/sheetsCalc.entry.js"),i.Spread.Sheets.ConditionalFormatting=n("./dist/plugins/conditional/conditional.entry.js"),i.Spread.Sheets.DataValidation=n("./dist/plugins/validation/datavalidation.entry.js"),i.Spread.Sheets.Touch=n("./dist/plugins/touch/touch.entry.js"),i.Spread.Sheets.Sparklines=n("./dist/plugins/sparkline/sparkline-wrapper.entry.js"),i.Spread.Sheets.CellTypes=n("./dist/plugins/celltype/celltypes.entry.js"),i.Spread.Sheets.Tables=n("./dist/plugins/table/table.entry.js"),i.Spread.Sheets.Fill=n("./dist/plugins/fill/fill.entry.js"),i.Spread.Sheets.ContextMenu=n("./dist/plugins/contextMenu/context-menu.entry.js"),i.Spread.Sheets.FormulaTextBox=n("./dist/plugins/formulaTextbox/formulaTextBox.entry.js"),e.exports=i.Spread},"./dist/core/celltype/basecelltype.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y;function K(e){var t=Q[e.charCodeAt(0)];return t?String.fromCharCode(t):e}function $(e,t,n){return g(e.x)||(e.x+=t.width),e.width=e.width-t.width-n.width,e}function X(e,t,n,o){var r,i,a=e.conditionalFormats;if(a)return r=e.getValue(t,n,o),i=a.oRa(e,t,n,r).iconSet,a.bp(t,n,o)&&i}function ee(e,t,n){var o,r,i=0;for(o=0;o<e.length;o++)void 0,r=e[o].style&&e[o].style.font?e[o].style.font:t,i=Math.max(y(r,O,b(e[o].text))/n,i),(e[o].style&&1===e[o].style.vertAlign||2===e[o].style.vertAlign)&&(i=Math.max(y(r,O,b(e[o].text))/n+2*a.To.No(r,W).fontSize*.218,i));return i}function te(e,t,n,o,r){var s,l,u,c,f,h=i.Vn.bm();if(!h)return 0;for(s=0,l=0;l<e.length;l++)u=void 0,u=e[l].style&&e[l].style.font?e[l].style.font:t,e[l].style&&e[l].style.vertAlign&&(u=a.To.No(u,W).font),C(h,u),"",c=l===e.length-1&&r?i.Vn.Rvb(e[l].text):e[l].text,f=0,o?f=y(u)*c.length/n:g(e[l].text)||(f=A(h,u,e[l].text)/n),s+=f;return s}function ne(e,t,n,o,r,i,s,l,u){var c,f,h,p=s.backColor,d=s.backgroundImage,g=s.textOrientation,m=s.isVerticalText,y=s.textIndent&&0!==s.textIndent,v=s.backgroundImageLayout,b=u.row,C=u.col,w=u.sheet&&u.sheet.getSpan(b,C),x=s&&(s.borderLeft||s.borderTop||s.borderRight||s.borderBottom),A=0,M=t;e.save(),g&&0!==g&&x&&l&&!w&&!m&&!y?(c=z(g*Math.PI/180),f=L(c),A=F(r/f),g>-90&&g<0&&(M=t-A),g>0&&g<90&&(M=t+A),h=function(){e.beginPath(),e.moveTo(M,n),e.lineTo(M+o,n),e.lineTo(t+o,n+r),e.lineTo(t,n+r),e.fill()}):h=function(){e.fillRect(t,n,o,r)},(p||d)&&(p&&a.To.setFillStyle(e,p,Math.min(M,t),n,o+A,r,h),J.ap(e,t,n,o,r,d,v,i)),e.restore()}function oe(e){return parseInt(16*e.zoom(),10)}function re(e,t,n,o){var r=e.cellPadding,i=0,a=e.labelOptions;return n&&(r=a?a.margin:"0"),r&&(i=typeof(i=parseInt(ae(r)[t],10))===j&&i>0?i:0),o===O?i:i*o}function ie(e,t,n,o){var i,a,s,l,u=o&&o.sheet;u&&n&&(i=o.canvasOffset||u._eventHandler.bG(),a=u.Dr(),(s=t.backColor||"white").stops&&(s=(l=s.stops)[0]&&l[0].color),s.backgroundColor&&(s=s.backgroundColor),r.GC$(e).width(n.width).height(n.height).css({top:i.top+a.y+n.y-2,left:i.left+a.x+n.x-2,"background-color":s}))}function ae(e){var t,n,o,r,i=["0","0","0","0"];return typeof e===D&&(o=void 0,r=void 0,1===(n=(t=e.split(" ",4)).length)?i=[o=t[0],o,o,o]:2===n?i=[o=t[0],r=t[1],o,r]:3===n?(r=t[1],i=[t[0],r,t[2],r]):4===n&&(i=[t[0],t[1],t[2],t[3]])),i}function se(e,t){var n,o=re(e,0),r=re(e,2),i=re(e,0,!0),a=re(e,2,!0);if(re(e,3,!0)+re(e,1,!0)>=t.width)return!1;if((n=e.labelOptions.alignment)===O&&(n=e.labelOptions.alignment=0),0===n||1===n||2===n){if(o>0&&i+a<o)return!0}else if((3===n||4===n||5===n)&&o<t.height&&r>0&&i+a<r)return!0;return!1}function le(e){var t="left";return 1===e||4===e?t="center":2!==e&&5!==e||(t="right"),t}function ue(e,t,n,o){var r=new i.Point(e.x,e.y),a=parseInt(n.fontSize,10),s=re(t,0),l=re(t,2),u=re(t,3,!0),c=re(t,1,!0),f=e.width,h=e.height,p=a>8?1:2,d=o-(o/2-a/2+(a>8?Math.floor((a-8)/5+2):1)-1)+re(t,0,!0),g=d+1,m=s+l>h?s+d:h-l+d-1;switch(t.labelOptions.alignment){case 0:r.x+=u+p+1,r.y+=g;break;case 1:r.x+=u+(f-u-c)/2,r.y+=g;break;case 2:r.x+=f-c-2,r.y+=g;break;case 3:r.x+=u+p+1,r.y+=m;break;case 4:r.x+=u+(f-u-c)/2,r.y+=m;break;case 5:r.x+=f-c-2,r.y+=m}return r}function ce(e,t){var n,o,r;if(e.cellPadding){for(n=ae(e.cellPadding),o=void 0,r=[],o=0;o<4;o++)r[o]=parseInt(n[o],10),"number"==typeof r[o]&&r[o]>0&&(r[o]*=t);e.cellPadding=r.join(" ")}}function fe(e,t,n){var o,r,i;if(m(t,D))return o=0,U[e.font+t]?o=U[e.font+t]:(o=A(e,e.font,t),U[e.font+t]=o),o;if(n&&t&&t[0]&&t[0].value)return t[0].value.length*y(e.font);for(r=0,i=0;i<t.length;i++)"fillingChar"!==t[i].type&&(o=0,U[e.font+t[i].value]?o=U[e.font+t[i].value]:(o=A(e,e.font,t[i].value),U[e.font+t[i].value]=o),r+=o);return r}function he(e){for(var t=0;t<e.length;t++)if("fillingChar"===e[t].type)return!0;return!1}function pe(e,t,n,o,r){var i;return i=o?Math.floor(t/r):Math.floor(t/A(e,e.font,n)),Array(i+1).join(n)}function de(e){var t=e.clone();return t.width--,t.height--,t}function ge(e,t,n){var o,r,i;for(o=0;o<e.length;o++)void 0,e[o].style=e[o].style||{},r=(i=e[o].style).font?a.To.No(i.font,n).font:t,i.font=r}function me(e,t,n,o,r){var a=n*B(-o)+r*H(-o),s=n*B(-o)+r*H(-o),l=e-a/2,u=t-s/2;return new i.Rect(l,u,a,s)}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("./dist/core/util/domUtil.js"),i=n("./dist/core/util/common.js"),a=n("./dist/core/worksheet/stylehelper.js"),s=n("./dist/core/core.enum.js"),l=n("./dist/core/celltype/celltype.ns.js"),u=n("@grapecity/js-calc"),o.Common.F,c=o.Common.CultureManager,f=o.Common.o,h=o.Common.l,p=o.Common.pc,d=o.Common.j,g=d.Fa,m=d.Ma,y=i.Ul.fp,v=i.Ul.ol,b=i.Ul.uWa,C=i.Ul.lZa,w=i.Ul.hZa,x=i.Ul.K_a,A=i.Ul.pL,M=i.Ul.Fxb,S=i.Ul.lHb,T=r.GC$.extend,N=i.Ul.Ml,I="left",R="right",k="center",E="alphabetic",D="string",j="number",_=null,O=void 0,F=Math.floor,P=Math.ceil,H=Math.sin,B=Math.cos,L=Math.tan,z=Math.abs,V="General",G=Math.max,W=.7,U={},Z="...",function(e){e[e.top=0]="top",e[e.right=1]="right",e[e.bottom=2]="bottom",e[e.left=3]="left"}(q||(q={})),J=function(){function e(){}return e.Gxb=function(e){var t,n,o=e.split("e")[1];if(o&&o.length>0&&("+"===o[0]?t=!0:"-"===o[0]&&(t=!1),n=o.slice(1)),void 0!==t)return{isAdd:t,length:n}},e.Apb=function(t,n,o){var r=e.Hxb,i=r[n+o];return i||(i=A(t,n,o),r[n+o]=i),i},e.Ixb=function(t,n,o,r,i){var a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M=r.font;if(o=o-1-3*i,a=r.textIndent&&0!==r.textIndent,s=r.isVerticalText,typeof n===j&&!0!==r.shrinkToFit&&!s&&!a){if(l=n<0,n=z(n),u=l?e.Apb(t,M,"-"):0,c=""+n,f=e.Gxb(c),h=void 0,p=e.Jxb(r._autoFormatter,n),f)return h=(""+f.length).length,h=G(h,2),e.Kxb(t,o,r,h,u,f.isAdd,p);if(d=u,g=e.Apb(t,M,"0"),m=c.split("."),d+=y=g*(""+Math.round(n)).length,v=e.Apb(t,M,"."),b=void 0,y<=o){if(!m[1]||0===m[1].length)return r._autoFormatter;if((d=d+m[1].length*g+v)<=o)return r._autoFormatter;if(n<.001)return h=(""+m[1].length).length,h=G(h,2),e.Kxb(t,o,r,h,u,!1,p);for(C=o-u-y-v,w=Math.floor(C/g),b="0",(w=Math.min(w,m[1].length))>0&&(b+="."),x=0;x<w;x++)b+="0";return b}return A=Math.round(n),h=G(h=(""+(""+A).length).length,2),e.Kxb(t,o,r,h,u,!0,p)}return r._autoFormatter},e.Kxb=function(t,n,o,r,i,a,s){var l,u,c,f=o.font,h=e.Apb(t,f,"0"),p=e.Apb(t,f,"E"),d=e.Apb(t,f,"+"),g=e.Apb(t,f,"-"),m=n-i-r*h-p-(a?d:g)-h,y=m-e.Apb(t,f,".");if(y<=h)return a?"0E+00":m>0?"0E-00":"0";for(l=Math.floor(y/h),l=Math.min(l,s),u="0",c=0;c<l;c++)0===c&&(u+="."),u+="0";return u+(a?"E+00":"E-00")},e.Lxb=function(t,n,o,r,i){var a,s,l,u,c,f,h=r.font;if(o=o-1-3*i,a=r.textIndent||0,s=o,1!==r.hAlign&&a>0&&(s=o-8*a),s<A(t,r.font,n)){for(l=e.Apb(t,h,"#"),u=Math.floor(o/l),c="",f=0;f<u;f++)c+="#";return c}return n},e.ap=function(e,t,n,o,r,i,a,s){var l,u,c,f,h,p,d,g,m,y;if(i&&"none"!==i&&s)try{s.ko(i)?(l=s.lo(i),u=void 0,N.msie&&((u=document.createElement("div")).appendChild(l),document.body.appendChild(u)),c=l.width,f=l.height,N.msie&&(u.removeChild(l),document.body.removeChild(u)),0,0,h=c,p=f,d=o,g=r,m=t,y=n,1===a?(h=o>=c?c:o,p=r>=f?f:r,m=o>c&&c>0?P(t+o/2-c/2):t,y=r>f&&f>0?P(n+r/2-f/2):n,d=h,g=p):2===a?r>0&&f>0&&o/r>c/f?m=t+o/2-(d=c/f*r)/2:o>0&&c>0&&r/o>f/c&&(y=n+r/2-(g=f/c*o)/2):3===a&&(d=h=o>=c?c:o,g=p=r>=f?f:r),e.drawImage(l,0,0,h,p,m,y,d,g)):s.fo(i)}catch(e){}},e.cp=function(e,t,n,o,r){var a,s,l,u,c,f,h,p,d,g,m,v,b,C,w,x,A,M,S,N,I,R=0,k=r&&r.sheet,E=n.textIndent,j=n.hAlign,_=n.isVerticalText,O=n.textOrientation,F=n.borderTop||n.borderBottom||n.borderLeft||n.borderRight,P=n.font,L=r.row,V=r.col;if(O&&-90<=O&&O<=90&&(u=z(O*Math.PI/180),s=H(u),l=B(u)),k&&typeof t===D&&t)if(c=[],f=void 0,e&&e.richText)if(h=n.formatter||n._autoFormatter,d=(p=k.getCellType(L,V)).T_a(h,e.text),ge(f=T(!0,[],p.U_a(e,t,d,P,n.foreColor)),P,o),_)if(n.wordWrap){if(g=r.sheetArea,m=k.Sl(L),(v=k._modelManager.findSpan(L,V,g))&&v.row>=L&&v.col>=V&&v.rowCount>1)for(b=L+1;b<L+v.rowCount;b++)m+=k.Sl(b);for(C=0,E>0&&(C=8*E),(w=re(n,0))>0&&(m-=w),(x=re(n,2))>0&&(m-=x),m++,c=i.Vn.M_a(t,m-3-C,P,f,_),a=0;a<c.length;a++)R+=ee(c[a].textInfos,P,o)}else R=ee(f,P,o);else{if(n.wordWrap){for(A=t.split(/\r\n|\r|\n/),a=0;a<A.length;a++)(M=[]).push(A[a]),c.push(M);for(c=i.Vn.O_a(c,i.Vn.P_a(f)),a=0;a<c.length;a++)R=Math.max(R,te(c[a],P,o,_,!0))}else R=te(f,P,o);1!==j&&E>0&&(R+=8*E/o),X(k,L,V,r.sheetArea)&&(R+=oe(k))}else if(c=t.split(/\r\n|\r|\n/),S=n.font,N=y(S)/o,_)if(n.wordWrap)for(a=0;a<c.length;a++)R+=N;else R=N;else{if(n.wordWrap){if(O)return I=k.Sl(L),i.Vn.mHb(L,V,s,l,t,S,I);for(a=0;a<c.length;a++)R=Math.max(R,i.Vn.Xn(c[a],S,!0)/o)}else R=O?F?(N+4)/s:l*(k.dp(t,S)/o)+N*s:k.dp(t,S)/o;1!==j&&E>0&&(R+=8*E/o),X(k,L,V,r.sheetArea)&&(R+=16)}return R},e.ep=function(e,t,n,o,r){var a,s,l,u,c,f,h,p,d,g,m,v,b,C,w,x,A,S,N,I,R,k,E,j,_,O,F,P=0,L=r&&r.sheet,V=n.font,G=n.isVerticalText,W=n.textIndent,U=n.vAlign,Z=n.textOrientation,q=r.row,J=r.col;if(Z&&-90<=Z&&Z<=90&&(w=z(Z*Math.PI/180),b=H(w),C=B(w)),L&&typeof t===D&&t)if(x=[],A=void 0,e&&e.richText)if(S=n.formatter||n._autoFormatter,I=(N=L.getCellType(q,J)).T_a(S,e.text),ge(A=T(!0,[],N.U_a(e,t,I,V,n.foreColor)),V,o),G){if(n.wordWrap){for(R=t.split(/\r\n|\r|\n/),a=0;a<R.length;a++)(k=[]).push(R[a]),x.push(k);for(x=i.Vn.O_a(x,i.Vn.P_a(A)),a=0;a<x.length;a++)P=Math.max(P,te(x[a],V,o,G,!0))}else P=te(A,V,o,G);1!==U&&W>0&&(P+=8*W/o)}else if(n.wordWrap){if(s=r.sheetArea,l=L.Tl(J),(c=L._modelManager.findSpan(q,J,s))&&c.row>=q&&c.col>=J&&c.colCount>1)for(f=J+1;f<J+c.colCount;f++)l+=L.Tl(f);for(p=0,W>0&&(p=8*W),d=re(n,1),(g=re(n,3))>0&&(l-=g),d>0&&(l-=d),l++,x=i.Vn.M_a(t,l-3-p,V,A),a=0;a<x.length;a++)P+=ee(x[a].textInfos,V,o)}else P=ee(A,V,o);else if(E=n.font,j=y(E)/o,G){if(n.wordWrap)for(x=t.split(/\r\n|\r|\n/),a=0;a<x.length;a++)_=x[a].length*j,P=Math.max(P,_);else P=t.length*j;1!==U&&W>0&&(P+=8*W/o)}else if(n.wordWrap){if(s=r.sheetArea,l=L.Tl(J),u=L.Sl(q),(c=L._modelManager.findSpan(q,J,s))&&c.row>=q&&c.col>=J&&c.colCount>1){for(f=J+1;f<J+c.colCount;f++)l+=L.Tl(f);for(h=q+1;h<q+c.colCount;h++)u+=L.Sl(h)}if(p=0,W>0&&(p=8*W),d=re(n,1),(g=re(n,3))>0&&(l-=g),d>0&&(l-=d),(m=re(n,0))>0&&(u-=m),(v=re(n,2))>0&&(u-=v),1===s&&(!!((O=L.rowFilter&&L.rowFilter())&&O.Dl(q,J,s)&&O.filterButtonVisible(J))&&(l-=L.oK(new i.Rect(0,0,l,u),s).width)),Z)return F=(u-j*C)/b,x=i.Vn.Wn(t,F,E),b*(L.dp(x[0],E)/o)+j*C;P=(x=M(e)?[t]:i.Vn.Wn(t,l-3-p,E)).length*j}else Z?P=b*(L.dp(t,E)/o)+j*C:P=j;return P},e.gp=function(e,t,n,o,r,i,a,s,l,u,c){var f;1===l?(e.beginPath(),(f=e.createLinearGradient(t,n+1,t,n+r-2)).addColorStop(0,s.borderLeftColor),f.addColorStop(1,s.borderRightColor),e.strokeStyle!==f&&(e.strokeStyle=f),i.borderLeft||(e.moveTo(t+.5,n),e.lineTo(t+.5,n+r)),i.borderRight||(e.moveTo(t+o-.5,n),e.lineTo(t+o-.5,n+r)),u&&!i.borderTop&&(e.moveTo(t,n+.5),e.lineTo(t+o,n+.5)),e.stroke(),s.borderBottomWidth&&!i.borderBottom&&(e.beginPath(),e.strokeStyle!==s.borderBottomColor&&(e.strokeStyle=s.borderBottomColor),e.moveTo(t+1,n+r-.5),e.lineTo(t+o,n+r-.5),e.stroke())):(e.beginPath(),(f=e.createLinearGradient(t,n,t+o-2,n)).addColorStop(0,s.borderTopColor),f.addColorStop(1,s.borderBottomColor),e.strokeStyle!==f&&(e.strokeStyle=f),i.borderTop||(e.moveTo(t,n+.5),e.lineTo(t+o,n+.5)),i.borderBottom||(e.moveTo(t,n+r-.5),e.lineTo(t+o,n+r-.5)),c&&!i.borderLeft&&(e.moveTo(t+.5,n),e.lineTo(t+.5,n+r)),e.stroke(),s.borderRightWidth&&!i.borderRight&&(e.beginPath(),e.strokeStyle!==s.borderRightColor&&(e.strokeStyle=s.borderRightColor),e.moveTo(t+o-.5,n+1),e.lineTo(t+o-.5,n+r),e.stroke()))},e.hp=function(e,t){var n;n=2===t?"active":4===t?"inactive":0===t?"disabled":"auto",r.GC$(e).css("ime-mode",n)},e.bDc=function(e,t,n,o,r,i,a){var s,l;return!!(t&&"SparklineExValue"===t.typeName&&(s=a&&a.parent,s&&(l=s.getSparklineEx(t.name))))&&(l.paint(e,t.value,n,o,r,i,{zoomFactor:a.zoom(),sheet:a}),!0)},e.Hxb={},e.Jxb=function(e,t){var n,o,r,i,a;return e&&e.Ud&&((n=e.Ud(t).format(t))&&n[1]&&"decimalSeparator"===n[1].type)?(o=n[2])&&"number"===o.type?(r=o.value,a=(i=n[3])&&"exponent"===i.type&&i.value&&i.value.indexOf("E")>-1,!g(r)&&a?r.length:5):0:5},e.u5=re,e}(),t.Context=J,Q={9001:65087,9002:65088,10216:65087,10217:65088,10092:65087,10093:65088,10096:65087,10097:65088,12296:65087,12297:65088,9121:65089,9126:65090,12300:65089,12301:65090,65378:65089,65379:65090,40:9180,41:9181,91:9140,93:9141,65339:9140,65341:9141,123:9182,125:9183,10100:9182,10101:9183,65115:9182,65116:9183,65371:9182,65373:9183,12310:65047,12311:65048,10098:65081,10099:65082,12308:65081,12309:65082,65117:65081,65118:65082,12304:65083,12305:65084,10218:65085,10219:65086,12298:65085,12299:65086,12302:65091,12303:65092},Y=function(){function e(){this.allowOverflow=!1,this.typeName="0"}return e.prototype.uxb=function(t,n,o,r){var i={ctx:t,options:{rect:n,context:o,value:r}};return e.ao(o.sheet,"paintCellPadding",i),i.options.rect},e.prototype.Mfc=function(t,n,o){var r={context:t,options:{dom:n,cellRect:o,contentRect:o.clone(),leftExternalRect:new i.Rect(0,0,0,0),rightExternalRect:new i.Rect(0,0,0,0)}};return e.ao(t.sheet,"onCreateCellEditor",r),r.options.dom},e.prototype.TBb=function(t,n,o){var r={ctx:null,options:{rect:n.clone(),context:t,value:null,style:o}};return e.ao(t.sheet,"getCellButtonRect",r),r.options.rect},e.prototype.Nfc=function(t,n,o,r){var a={context:t,options:{dom:n,cellRect:o,cellStyle:r,contentRect:o.clone(),leftExternalRect:new i.Rect(0,0,0,0),rightExternalRect:new i.Rect(0,0,0,0)}};return e.ao(t.sheet,"onActivateCellEditor",a),a},e.prototype.VBb=function(t,n,o,r){var a={context:t,contentContainer:n,editorBounds:o,cellStyle:r,contentRect:o.clone(),leftExternalRect:new i.Rect(0,0,0,0),rightExternalRect:new i.Rect(0,0,0,0)};return e.ao(t.sheet,"onUpdateContainer",a),a},e.prototype.Ofc=function(t,n,o){var r={context:t,options:{dom:n,cellRect:o,contentRect:o.clone(),leftExternalRect:new i.Rect(0,0,0,0),rightExternalRect:new i.Rect(0,0,0,0)}};return e.ao(t.sheet,"onDeactivateCellEditor",r),r.options.dom},e.prototype.XBb=function(e,t,n){this.deactivateEditor(e,t),this.Ofc(t,e,n)},e.prototype.i5=function(e,t,n,o){var r,i,s,l,u,c,f,h,p,d,g=n.labelOptions;if(g&&(r=o.sheet,i=n.watermark)){if(s=g.visibility,l=r.getText(o.row,o.col,o.sheetArea),1===s||(2===s||s===O)&&""===l)return;1!==(u=r.zoom())&&ce(n,u),void 0,f=(c=g.font)?a.To.No(c,u):a.To.No(n.font,1),h=y(f.font),p=function(e,t){var n=re(t,0),o=re(t,3,!0),r=re(t,2,!0),i=e.clone(),a=t.labelOptions.alignment;return 0===a||1===a||2===a?n<e.height&&(i.height=n-r+1):3!==a&&4!==a&&5!==a||(i.height=e.height-r),i.x+=o,i.width-=o+re(t,1,!0),i}(t,n),d=void 0,se(n,t)&&(d=ue(t,n,f,h)),d&&(e.save(),e.textAlign=le(g.alignment),e.textBaseline="alphabetic",C(e,f.font),e.fillStyle=g.foreColor||n.foreColor||"grey",e.rect(p.x,p.y,p.width,p.height),e.clip(),e.beginPath(),e.fillText(i,d.x,d.y),e.restore())}},e.prototype.f5=function(e,t){var n=e.clone(),o=re(t,0),r=re(t,1),i=re(t,2),a=re(t,3);return o>0&&(n.y+=o,n.height-=o),i>0&&(n.height-=i),a>0&&(n.x+=a,n.width-=a),r>0&&(n.width-=r),r+a>=e.width&&(n.width=0),o+i>=e.height&&(n.height=0),n},e.prototype.Ama=function(t,n,o,r){var i;return i={ctx:t,options:{rect:n=this.f5(n,o),context:r}},e.ao(r.sheet,"getCellPaddingRect",i),i.options.rect},e.prototype.e5=function(e,t,n,o){var a,s,l,u,c,f,h,p,d,g,m,v,b,C=n.labelOptions;C&&(s=(a=o.sheet).getText(o.row,o.col,o.sheetArea),l=n.watermark,1!==(u=C.visibility)&&l&&(c=C.font||n.font||a._render.Bl(),1!==(f=a.zoom())&&(c=a._render.Cl(c),ce(n,f)),h=y(c),se(n,t)&&(p=function(e,t){var n=re(t,3,!0),o=re(t,1,!0),r=re(t,0,!0),i=re(t,2,!0),a=e.clone(),s=t.labelOptions.alignment;return a.x=n+1,a.width-=n+o,0===s||1===s||2===s?(a.y=r,a.height=re(t,0)-r-i):3!==s&&4!==s&&5!==s||(a.y=e.height-re(t,2)+r,a.height=re(t,2)-r-i),2!==s&&5!==s||(a.width-=2),a}(t,n)),p&&((d=r.GC$(i.Ul.Nl("span"))).text(l),g=(2===u||u===O)&&""===s,m=p.height-h,v=p.y+(g&&m>0?m:0),d.css({display:"block",position:"absolute",left:p.x,top:v,width:p.width,height:p.height,font:w(c),color:C.foreColor||n.foreColor||"grey",textAlign:le(C.alignment),overflow:"hidden",whiteSpace:"nowrap"}).attr("gcUIElement","gcEditorLabel"),r.GC$(e).append(d),g&&(b=setInterval((function(){v--,d.css("top",v),v<=p.y&&clearInterval(b)}),20)))))},e.prototype._createCellTypeElement=function(e){var t,n,o=i.Ul.Nl("div");return o.style.cssText="position: absolute; margin: 0;padding: 0 ;overflow: hidden; box-sizing: content-box;resize: none;outline: none;border: 2px #5292f7 solid;box-shadow: 1px 2px 5px rgba(0,0,0,0.4);background-color: white",(t=i.Ul.Nl("div")).style.cssText="position: absolute; outline: none; border: none",r.GC$(o).append(r.GC$(t)),(n=this.createEditorElement(e,o))&&r.GC$(t).append(r.GC$(n)),this.Mfc(e,o,e.sheet.getCellRect(e.row,e.col)),o},e.prototype._activateEditorWrapper=function(e,t,n,o){var i,a,s,l,u,c,f,h,p;e&&e.firstChild&&(i=this,ie(e,t,a=de(n),o),l=(s=i.Nfc(o,e,a,t)).options.contentRect,u=s.options.cellRect,c=s.options.leftExternalRect,f=s.options.rightExternalRect,i.e5&&i.e5(e,l,t,o),h=$(l=i.f5?i.f5(l,t):l,c,f),p=e.firstChild,r.GC$(p).css({left:(+r.GC$(p).css("left").replace("px","")||0)+re(t,3),top:(+r.GC$(p).css("top").replace("px","")||0)+re(t,0)}),i.activateEditor(e.firstChild.firstChild,t,h,o,u,c,f))},e.prototype.updateEditorContainer=function(e,t,n,o,i,a,s){var l,u,c,f,h,p;e&&t&&((u=(l=e.parentNode)?l.parentNode:O)&&i&&(c=r.GC$(u),f=i.width,h=i.height,f>0&&(c.width(f),p=u.lastChild,n&&"gcEditorLabel"===p.getAttribute("gcUIElement")&&r.GC$(p).width(f-re(n,3,!0)-re(n,1,!0)-2)),h>0&&c.height(h),g(i.x)||c.css("left",i.x+"px"),g(i.y)||c.css("top",i.y+"px")))},e.prototype._updateEditorWrapper=function(e,t,n,o,r){var i,a,s,l,u,c,f,h,p,d,g,m=this,y=e.firstChild,v=o.sheet,b=de(n);ie(e,t,b,o),i=m.VBb(o,y,b,t),r&&v&&ce(t,v.zoom()),a=i.editorBounds,s=i.contentRect,l=i.leftExternalRect,u=i.rightExternalRect,c=y.firstChild,f=$(s=m.f5?m.f5(s,t):s,l,u),h=m.updateEditor(c,t,f,o,a,l,u),p={width:l.width,height:l.height},d={width:u.width,height:u.height},g={width:!isNaN(h&&h.width)&&h.width+p.width+d.width>a.width?h.width+p.width+d.width:a.width,height:!isNaN(h&&h.height)&&h.height+p.height+d.height>a.height?h.height+p.height+d.height:a.height},m.updateEditorContainer(c,h,t,o,g,p,d)},e.prototype.h5=function(e,t,n,o,r){return this.getCellAndPaddingHitInfo(e,t,n,o,r)},e.prototype.X4=function(e,t,n,o,r){var i=function(e,t){var n={context:e,value:0,cellStyle:t};return Y.ao(e.sheet,"getCellButtonAutoWidth",n),n.value}(r,n)+function(e){var t={context:e,value:0};return Y.ao(e.sheet,"getOutlineColumnOffset",t),t.value}(r),a=this.getAutoFitWidth(e,t,n,o,r);return a>0&&(i+=a+re(n,3,!1)+re(n,1,!1)),i},e.prototype.Y4=function(e,t,n,o,r){var i=0,a=this.getAutoFitHeight(e,t,n,o,r);return a>0&&(i+=a+re(n,0,!1)+re(n,2,!1)),Math.max(function(e,t){var n={context:e,value:0,cellStyle:t};return Y.ao(e.sheet,"getCellButtonAutoHeight",n),n.value}(r,n),i)},e.prototype.paintValue=function(e,t,n,o,r,i,a,s){var l,u,c={};s.quotePrefix=a.quotePrefix,(l=this.format(x(t),a.formatter||a._autoFormatter,c,s))&&(u=this.Pfc(e,l,a,s,n,o,r,i),this.paintText(e,t,n,o,r,i,a,s,l,c,O,u.externals))},e.prototype.S_a=function(e,t,n){var o=0;return e>0&&(o=8*e),t&&t.XQa(n)&&(o=0),o},e.prototype.T_a=function(e,t){return!!(!e||m(e,D)&&e===V||e&&e.formatString&&e.formatString()===V)||!(t&&(!isNaN(t)||"TRUE"===t.toUpperCase()||"FALSE"===t.toUpperCase())&&"@"!==e)},e.prototype.Qfc=function(e){var t,n=0;for(t=0;t<e.length;t++)n+=e[t].width;return n},e.prototype.Rfc=function(e){var t,n=0;for(t=0;t<e.length;t++)n+=e[t].height;return n},e.prototype.Sfc=function(t,n,o,r,i){var a={ctx:t,options:{rect:o,context:n,value:r,style:i}};e.ao(n.sheet,"beforePaintLabel",a)},e.prototype.Pfc=function(t,n,o,r,a,s,l,u){var c={ctx:t,text:n,rect:new i.Rect(a,s,l,u),style:o,context:r,externals:{left:[],right:[]}};return e.ao(r.sheet,"beforePaintText",c),c},e.prototype.Tfc=function(t,n,o,r,a,s,l,u,c){var f={ctx:t,style:n,context:o,textRect:new i.Rect(r,a,s,l),availRect:u};return e.ao(o.sheet,c,f),f},e.prototype.Ufc=function(e,t,n,o,r,i,a,s){return this.Tfc(e,t,n,o,r,i,a,s,"beforeFillTextArea")},e.prototype.Vfc=function(e,t,n,o,r,i,a,s){return this.Tfc(e,t,n,o,r,i,a,s,"afterFillTextArea")},e.prototype.paintText=function(e,t,n,o,r,i,a,s,l,u,c,f){var h,p,d,m=this;e.save(),e.beginPath(),h=a.textOrientation,p=a.textIndent&&0!==a.textIndent,d=a.isVerticalText,t&&t.richText&&t.richText.length>0||d?m.Fpb(e,t,n,o,r,i,a,s,l,u,c,f):0!==h&&!g(h)&&-90<=h&&h<=90&&!p&&!d?m.nHb(e,t,n,o,r,i,a,s,l,u,c,f):m.N$a(e,t,n,o,r,i,a,s,l,u,c,f),e.restore()},e.prototype.oHb=function(e,t,n,o,r,i,a,s,l,u){var c,f,h,p,d,g,m,y,v,b,C,w,x=t.sheet,A=t.row,M=t.col,S=r.vAlign,T=t.sheetArea;for(c=0;c<n.length;c++)if(f=n[c].text,h=o[c].lineHeight,p=1===S?0:s,d=this.pHb(e,"0"),g="",(m=i)-1-2-p<f.length*h){if(m<3*d)u.push(0),g=Z;else if(y=F((m-1-2-3*d-(1===S?0:s))/h),v=0,0===S){for(b=0;b<y;b++)g+=f[b];C=g.length,3*d+((g+=Z).length-3)*h+s>m-1-2?(g=g.substring(0,g.length-4)+Z,u.push(g.split(Z)[0].length)):u.push(C)}else if(1===S){for(w=0;w<P(y/2);w++)g+=f.charAt(w),v=w;for(C=g.length,g+=Z,w=P(f.length-y/2);w<f.length;w++)g+=f.charAt(w);3*d+(g.length-3)*h+s>m-1-2?(g=g.replace(f[v],""),u.push(g.split(Z)[0].length)):u.push(C),l[c].y=a+(i-(3*d+(g.length-3)*h))/2}else{for(u.push(0),b=f.length-1;b>=f.length-y;b--)g=f[b]+g;3*d+((g=Z+g).length-3)*h+s>m-1-2&&(g=g.replace(f[f.length-y],"")),l[c].y=a+i-s-(3*d+(g.length-3)*h)-2}n[c].textInfos[0].text=g,x._modelManager.qHb(A,M,f,T)}else x._modelManager.qHb(A,M,null,T)},e.prototype.Fpb=function(e,t,n,o,r,a,s,l,u,c,f,h){var p,d,g,m,y,C,w,x,A,M,S,N,I,E,D,j,_,O,F,P,H,B=this,L=new i.Rect(n,o,r,a),z=B.S_a(s.textIndent,l.sheet.outlineColumn,l.col),V=s.hAlign;if(3===V&&(V=v(V,t,s.formatter)),d=!!(p=s.isVerticalText)&&b(u),g=s.font,m=s.formatter||s._autoFormatter,y=B.T_a(m,t.text),C=T(!0,[],B.U_a(t,u,y,g,s.foreColor)),t&&t.richText&&t.richText.length>0&&(w=l.sheet?l.sheet.zoom():1,B.V_a(C,g,w)),x=0,A=0,h&&(x=B.Qfc(h.left),A=B.Qfc(h.right)),M=x+A,S={left:x,right:A},!s.wordWrap&&s.shrinkToFit&&B.W_a(C,r-M,a,s,g,1,p),N=B.X_a(e,u,s.font,p?a:r-M,z,p?s.vAlign:s.hAlign,s.wordWrap,p,C),I=B.Y_a(N,s,V,f),E=B.Z_a(e,s,n,o,r,a,s.wordWrap,l.cellOverflowLayout,V,z,p,N[0].textLength,I[0].lineHeight),D=!1,s.showEllipsis&&p&&!t.richText&&(D=!0),j=B.$_a(n,o,r,a,V,s.vAlign,z,p,d,N,I,S,D),_=N.length,O=[],D&&c&&(c.content&&1===c.content.length&&"text"===c.content[0].type||!c.content&&1===N.length&&N[0].text)&&this.oHb(e,l,N,I,s,a,o,z,j,O),1===_&&c&&!y)B.__a(e,l.sheet,u,c,j[0].x,j[0].y,r,a,V,s,E.width,E.height,z,p,N[0].textLength,l,S,L);else{for(F=B.Wfc(N),P=j[0].x,e.textAlign===k?P-=F/2:e.textAlign===R&&(P-=F),B.Ufc(e,s,l,P,j[0].y,F,0,L),H=0;H<_;H++)B.a0a(e,l.sheet,j[H].x,j[H].y,I[H],V,N[H],O[H]);B.Ufc(e,s,l,P,j[0].x,F,0,L)}},e.prototype.Wfc=function(e){var t,n=e[0].textLength;for(t=0;t<e.length;t++)n=G(n,e[t].textLength);return n},e.prototype.pHb=function(e,t){var n=0,o=e.font+t;return U[o]?n=U[o]:(n=A(e,e.font,t),U[o]=n),n},e.prototype.rHb=function(e,t,n,o,r,i,a){var s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M=t&&t.content,S=e.sheetArea;if(s=M?t.content[0].value:n,l=this.pHb(o,s),u=e.sheet,c=e.row,f=e.col,h=r,p=0,d=this.pHb(o,"0"),p=this.pHb(o,Z),l>h-1-2-(1===i?0:a)){if(g="",2===i)for(m=s.length-1;m>=0;m--){if(p>h-1-2-a){y=g.length,g=Z+g.substring(1,y);break}g=(v=s.charAt(m))+g,p+=this.pHb(o,v)}else if(1===i){for(b=P((h-p)/d),m=0;m<b/2;m++)g+=v=s.charAt(m);for(g+=Z,m=F(s.length-b/2);m<s.length;m++)g+=v=s.charAt(m);for(C=this.pHb(o,g);C>h-1-2&&g!==Z;)x=(w=g.split(Z))[0],A=w[1],g=x.length>A.length?x.substring(0,x.length-1)+Z+A:x+Z+A.substring(1,A.length),C=this.pHb(o,g)}else for(m=0;m<s.length;m++){if(p>h-1-2-a){y=g.length,g=g.substring(0,y-1)+Z;break}g+=v=s.charAt(m),p+=this.pHb(o,v)}M?t.content[0].value=g:t.content=[{value:g,type:"text"}],u._modelManager.qHb(c,f,s,S)}},e.prototype.N$a=function(e,t,n,o,r,l,u,c,f,h,d,m){var w,x,M,S,T,N,I,D,j,_,O,P,H,B,L,z,V,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe,ie,ae,se,le=this,ue=0,ce=u.textIndent,fe=u.wordWrap,he=u.hAlign,pe=u.vAlign,de=u.shrinkToFit,ge=u.textDecoration,me="left",ye=2,ve=2,be=u.font,Ce=0,we=[],xe=0,Ae=c.sheet,Me=new i.Rect(n,o,r,l);if(g(c.fontInfo)&&(c.fontInfo=a.To.No(u.font,Ae.zoom())),w=parseInt(c.fontInfo.fontSize,10),g(c.lineHeight)&&(c.lineHeight=y(a.To.No(u.font,Ae.zoom()).font,!1,b(f))),x=c.lineHeight,M=u.foreColor,M=i.Im._ob(Ae,M),(S=h.conditionalForeColor)&&(M=S),d=g(u.opacity)?d:u.opacity,g(d)||((T=p.ec(M)).a=d,M=p.bc(T)),e.fillStyle!==M&&(e.fillStyle=M||"#000000"),ce>0&&(ue=8*ce),Ae.outlineColumn&&Ae.outlineColumn.XQa(c.col)&&(ue=0),3===he&&(he=v(he,t,u.formatter)),C(e,be),N=0,I=0,m&&(N=le.Qfc(m.left),I=le.Qfc(m.right)),D=N+I,j={left:N,right:I},!fe&&de)for(_=0,O={value:!1},P=0;P<3&&!1===O.value&&(H=e.measureText(f).width,(_=G(0,r-4-(1===he?0:ue)-D))<H);P++)be=a.To.No(be,_/H,O,!0).font,C(e,be);if((B=Ae.parent&&Ae.parent.options.numbersFitMode===s.NumbersFitMode.overflow||!1)||(B=h&&h.content?!(!h.content||1!==h.content.length||"text"!==h.content[0].type):"string"==typeof t&&t===f),!fe&&!de&&u.showEllipsis&&B&&this.rHb(c,h,f,e,r,he,ue),ye+=ue+N,1===he?(ye=(r+N-I)/2,me=k):2===he&&(ye=r-I-1-2,ye-=ue,me=R),e.textAlign!==me&&(e.textAlign=me),L=0,fe&&(L=r-D-3-ue,L-=1,(xe=(we=i.Vn.Wn(f,L,be,!1,e)).length)>1&&0!==pe&&(Ce=(xe-1)*x)),ve+=x-(V=x/2-w/2+(z=w>8?F((w-8)/5+2):1)-1),1===pe?ve=(l-Ce)/2+x/2-V:2===pe&&(ve=l-Ce-2-V),e.textBaseline!==E&&(e.textBaseline=E),Z={x:(U=(W=c.cellOverflowLayout)&&W.layout)?U.x:n+1,y:U?U.y:o+1,width:U?U.width:r-2,height:U?U.height:l-2},q=U&&U.width>r,J=Z.x,Q=Z.y,Y=Z.width,K=Z.height,fe)if(e.rect(J,Q,Y,K),e.clip(),e.beginPath(),$=o+ve,xe>1){for(X=n+ye,e.textAlign===k?X-=L/2:e.textAlign===R&&(X-=L),le.Ufc(e,u,c,X,$,L,x*xe,Me),P=0;P<xe;P++)e.fillText(we[P],n+ye,$),ge&&(H=e.measureText(we[P]).width,le.ip(e,ge,n+ye,$,H,w,z)),$+=x;le.Ufc(e,u,c,X,$,L,x*xe,Me)}else le.Oja(e,f,h,n+ye,o+ve,he,Y,ue,ge,z,w,c,u,j,Me,q);else te=(ee=A(e,e.font,f))>Y-(n+1-J)||x>K,ne=re(u,0),oe=re(u,1),ie=re(u,2),ae=re(u,3),te||(1===he?W&&(((se=ee/2)>W.backgroundLeftWidth||se>W.backgroundRightWidth)&&(te=!0)):(ee+ue+ne+ie>Y||Ce+ae+oe>K)&&(te=!0)),te&&(e.rect(J,Q,Y,K),e.clip(),e.beginPath()),le.Oja(e,f,h,n+ye,o+ve,he,Y,ue,ge,z,w,c,u,j,Me,q)},e.prototype.nHb=function(e,t,n,o,r,s,l,u,c,f,h,d){var m,y,b,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,P,V,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe,ie,ae,se=this,le=l.wordWrap,ue=l.hAlign,ce=l.vAlign,fe=l.shrinkToFit,he=l.textDecoration,pe=2,de=2,ge=l.font,ye=[],ve=0,be=parseInt(u.fontInfo.fontSize,10),Ce=u.sheet,we=new i.Rect(n,o,r,s),xe=u.cellOverflowLayout,Ae=xe&&xe.layout,Me=l&&(l.borderLeft||l.borderTop||l.borderRight||l.borderBottom)&&!Ce.getSpan(u.row,u.col),Se=l.textOrientation,Te=Se*Math.PI/180,Ne=z(Te),Ie=B(Ne),Re=H(Ne),ke=L(Ne),Ee=u.lineHeight,De=90===Se||-90===Se;if(Me&&(Se>-90&&Se<0&&(b=!1),Se>0&&Se<90&&(b=!0)),x=(w={x:Ae?Ae.x:n+1,y:Ae?Ae.y:o+1,width:Ae?Ae.width:r-2,height:Ae?Ae.height:s-2}).x,A=w.y,M=w.width,S=w.height,T=Ee/2*H(Ne),N=Ee/2*B(Ne),R=Ee/2-be/2+(I=be>8?F((be-8)/5+2):1)-1,f&&f.content&&f.content.length>0&&!fe&&(c=se.sHb(e,f.content,s-4,ge)),k=Ce.dp(c,ge),E=l.foreColor,E=i.Im._ob(Ce,E),(D=f.conditionalForeColor)&&(E=D),h=g(l.opacity)?h:l.opacity,g(h)||((j=p.ec(E)).a=h,E=p.bc(j)),e.fillStyle!==E&&(e.fillStyle=E||"#000000"),3===ue&&(ue=v(ue,t,l.formatter,Se)),C(e,ge),_=0,O=0,d&&(_=se.Qfc(d.left),O=se.Qfc(d.right)),!le&&fe)for(P=0,V={value:!1},W=0;W<3&&!1===V.value&&(P=G(0,(s-4-2*N)/Re))<k;W++)ge=a.To.No(ge,P/k,V,!0).font,C(e,ge),be=parseInt(u.fontInfo.fontSize,10),k=Ce.dp(c,ge),T=(Ee=i.Ul.fp(ge))/2*H(Ne),N=Ee/2*B(Ne);if(U=0,Z=0,le)for(Z=(s-4-2*N)/Re,ve=(ye=i.Vn.Wn(c,Z,ge,!1,e)).length,k=Ce.dp(ye[0],ge),q=0;q<ve;q++)(J=Ce.dp(ye[q],ge))>U&&(U=J);switch(s<=(le?U:k)*Re+2*N&&(ce=2),m=k/2*Ie,y=(le?U:k)/2*Re,""+ue+ce){case"00":pe+=m+T+_,de+=y,De||(de+=N),Me&&(pe=(s-de)/ke*(b?1:-1)+(Ee/2+2)/Re);break;case"01":pe+=m+T+_,de=s/2,Me&&(pe=(s-de)/ke*(b?1:-1)+(Ee/2+2)/Re);break;case"02":pe+=m+T+_,de+=y,De||(de+=N),Me&&(pe=de/ke*(b?1:-1)+(Ee/2+2)/Re),de=s-de;break;case"10":pe=(r+_-O)/2,de+=y,De||(de+=N),Me&&(pe+=(b?1:-1)*(s-de)/ke);break;case"11":pe=(r+_-O)/2,de=s/2,Me&&(pe+=(b?1:-1)*(s-de)/ke);break;case"12":pe=(r+_-O)/2,de+=y,De||(de+=N),Me&&(pe+=(b?1:-1)*de/ke),de=s-de;break;case"20":pe=r-2-m-T-O,de+=y,De||(de+=N),Me&&(pe=r+(s-de)/ke*(b?1:-1)-(Ee/2+2)/Re);break;case"21":pe=r-2-m-T-O,de=s/2,Me&&(pe=r+(s-de)/ke*(b?1:-1)-(Ee/2+2)/Re);break;case"22":pe=r-2-m-T-O,de+=y,De||(de+=N),Me&&(pe=r+de/ke*(b?1:-1)-(Ee/2+2)/Re),de=s-de}if(le)if(Q=n+pe,Y=Ee/Re,K=void 0,ve>1){for(1===ue&&(Q-=ve%2!=0?Y*(ve-1)/2:Y*(ve/2)-.5*Y),X=($=me(Q,o+de,k,Te,Ee)).width+Y*(ve-1),ee=$.height,te=2===ue?$.x-Y*(ve-1):$.x+Y*(ve-1),ne=$.y,se.Ufc(e,l,u,te,ne,X,ee,we),W=0;W<ve;W++)K=W,(l.textOrientation>0&&2===ue||l.textOrientation<0&&(0===ue||1===ue))&&(K=ve-W-1),se.tHb(e,Te,ye[K],Q,o+de,he,be,I,R),Q=2===ue?Q-Y:Q+Y;se.Ufc(e,l,u,te,ne,X,ee,we)}else se.Xfc(e,c,n,o,pe,de,u,l,k,Te,he,be,I,Ee,R,we);else oe=k*Re+be*Re+2,ie=re(l,0),ae=re(l,2),(oe>S-(o+1-A)||Ee>S||oe+ie+ae>S)&&(e.rect(x,A,M,S),e.clip()),se.Xfc(e,c,n,o,pe,de,u,l,k,Te,he,be,I,Ee,R,we)},e.prototype.Xfc=function(e,t,n,o,r,i,a,s,l,u,c,f,h,p,d,g){var m=this,y=me(n,o,l,u,p),v=y.width,b=y.height,C=y.x,w=y.y;m.Ufc(e,s,a,C,w,v,b,g),m.tHb(e,u,t,n+r,o+i,c,f,h,d),m.Ufc(e,s,a,C,w,v,b,g)},e.prototype.V_a=function(e,t,n){ge(e,t,n)},e.prototype.W_a=function(e,t,n,o,r,i,s){var l,u,c,f=0,h={value:!1};for(l=0;l<3&&!1===h.value&&(u=te(e,r,i,s),f=G(0,(s?n:t)-4),(s?o.vAlign:1!==o.hAlign&&o.textIndent)&&(f=G(0,f-8*o.textIndent)),f<u);l++)for(c=0;c<e.length;c++)e[c].style.font=a.To.No(e[c].style.font,f/u,h,!0).font},e.prototype.U_a=function(e,t,n,o,r){var i=e.richText;return!g(i)&&n||(i=[{style:{font:o,foreColor:r},text:t}]),i},e.prototype.Z_a=function(e,t,n,o,r,i,a,s,l,u,c,f,h){var p=s&&s.layout,d={x:p?p.x:n+1,y:p?p.y:o+1,width:p?p.width:r-2,height:p?p.height:i-2},g=d.x,m=d.y,y=d.width,v=d.height;return a?(e.rect(g,m,y,v),e.clip(),e.beginPath()):this.b0a(t,l,t.vAlign,n,o,v,y,g,m,f,h,u,c,s)&&(e.rect(g,m,y,v),e.clip(),e.beginPath()),d},e.prototype.b0a=function(e,t,n,o,r,i,a,s,l,u,c,f,h,p){var d,g,m=re(e,0),y=re(e,1),v=re(e,2),b=re(e,3);return h?(!(d=u>i-(r+1-l)||c>a)&&1!==n&&u+f+m+v>i||c+b+y>a)&&(d=!0):(d=u>a-(o+1-s)||c>i)||(1===t?p&&(((g=u/2)>p.backgroundLeftWidth||g>p.backgroundRightWidth)&&(d=!0)):(u+f+b+y>a||c+m+v>i)&&(d=!0)),d},e.prototype.X_a=function(e,t,n,o,r,s,l,u,c){var f,h,p,d,g;if(1!==s?o=o-3-r:o-=3,l)return i.Vn.M_a(t,o,n,c,u,e);for(f=0,h=0;h<c.length;h++)p=c[h].text,u?f+=y(c[h].style.font)*(p?p.length:0):(d=a.To.No(c[h].style.font,1),g=c[h].style.vertAlign?d.fontSize*W+"px "+d.fontFamily:c[h].style.font,f+=A(e,g,p));return[{textLength:f,text:t,textInfos:c}]},e.prototype.__a=function(e,t,n,o,r,i,s,l,u,c,f,h,p,d,g,m,y,v){var b,C,w=c.font,x=a.To.No(w,1).fontSize,A=x>8?F((x-8)/5+2):1;this.L$a(e,t,c),(b=o.conditionalForeColor)&&e.fillStyle!==b&&(e.fillStyle=b),d?this.c0a(e,n,o,c,r,i,h,p,h,m,y,v):(C=f>s,this.Oja(e,n,o,r,i,u,f,p,c.textDecoration,A,x,m,c,y,v,C,g))},e.prototype.c0a=function(e,t,n,o,r,i,a,s,l,u,c,f){var h,p,d,g=n.content,m=i;if(this.Ufc(e,o,u,r,m,l,l*t.length,f),g&&g.length>0)for(p=(p=a-s-fe(e,g,!0)-2)>0?p:0,void 0,h=0;h<g.length;h++)"fillingChar"===g[h].type?(d=pe(e,p,g[h].value,!0),this.vWa(e,d,r,i),i+=p):"placeholder"===g[h].type?i+=g[h].value?g[h].value.length*l:0:"numberPlaceholder"===g[h].type?i+=l:(this.vWa(e,g[h].value,r,i),i+=g[h].value?g[h].value.length*l:0);else if(t)for(h=0;h<t.length;h++)i=this.vWa(e,t[h],r,i,l).y;this.Vfc(e,o,u,r,m,l,i-m,f)},e.prototype.d0a=function(e){var t=I;return 1===e?t=k:2===e&&(t=R),t},e.prototype.a0a=function(e,t,n,o,r,i,a,s){var l,u,c=[],f=a.textInfos;for(l=0;l<f.length;l++)c.push(T(!0,{},r,f[l].style));for(l=0;l<f.length;l++)n=(u=this.f0a(e,t,n,o,c[l],f[l].text,s)).x,o=u.y},e.prototype.Y_a=function(e,t,n,o){var r,i,a=[],s=e.length;for(r=0;r<s;r++)i=this.g0a(t,n,o,e[r].textInfos),a.push(i);return a},e.prototype.g0a=function(e,t,n,o){var r,i,s,l=0,u=0;for(r=0;r<o.length;r++)void 0,i=o[r].style&&o[r].style.font?o[r].style.font:e.font,l=Math.max(y(i,O,b(o[r].text)),l),u=Math.max(a.To.No(i,1).fontSize,u),(o[r].style&&1===o[r].style.vertAlign||2===o[r].style.vertAlign)&&(l=Math.max(y(i,O,b(o[r].text))+2*a.To.No(i,W).fontSize*.218,l));return{lineHeight:l,fontSize:u,baselineOffset:s=u>8?F((u-8)/5+2):1,lineOffset:l/2-u/2+s-1,font:e.font,foreColor:e.foreColor,textDecoration:e.textDecoration,isVerticalText:e.isVerticalText,textAlign:this.d0a(t),textBaseline:E,opacity:n}},e.prototype.h0a=function(e,t,n){var o,r=0,i=0;for(o=0;o<e.length;o++)i+=t[o].lineHeight,r=Math.max(e[o].textLength,r);return{width:n?i:r,height:n?r:i}},e.prototype.$_a=function(e,t,n,o,r,i,a,s,l,u,c,f,h){var p,d=this.h0a(u,c,s),g=d.height,m=d.width,y=[];if(s)for(p=0;p<u.length;p++)y.push(this.i0a(e,t,n,o,r,i,a,m,u[p].textLength,c[p].lineHeight,c[p].lineOffset,l,f,u[p],h)),l?e-=c[p].lineHeight:e+=c[p].lineHeight;else for(p=0;p<u.length;p++)y.push(this.j0a(e,t,n,o,r,i,a,u[p].textLength,g,c[p].lineHeight,c[p].lineOffset,f)),t+=c[p].lineHeight;return y},e.prototype.j0a=function(e,t,n,o,r,i,a,s,l,u,c,f){var h=0,p=f.left,d=f.right;return 1===r?h=(n-s+p-d)/2:2===r?(h=n-1-2-s-d,h-=a):h=2+a+p,{x:e+h,y:t+(1===i?(o-l)/2+u-c:2===i?o-l-2+u-c:2+u-c)}},e.prototype.i0a=function(e,t,n,o,r,i,a,s,l,u,c,f,h,p,d){var g=0,m=h.left,y=h.right;return f?0===r?g=2+s+y-u/2:1===r?g=(n-m+y+s)/2-u/2:2===r&&(g=n-m-1-2-u/2):1===r?g=(n-s+m-y)/2+u/2:2===r?g=n-1-2-y-s+u/2:0===r&&(g=2+m+u/2),{x:e+g,y:t+(1===i?(o-l)/2:2===i?o-a-l-2:2+a)}},e.prototype.f0a=function(e,t,n,o,r,i,a){var s,l;return e.save(),this.L$a(e,t,r),s=r.vertAlign,l=r.isVerticalText?this.vWa(e,i,n,o,r.textDecoration,r.baselineOffset,a):this.k0a(e,n,o,r,i,s),e.restore(),l},e.prototype.L$a=function(e,t,n){var o,r,a=n.foreColor,s=n.opacity;a=i.Im._ob(t,a),g(s)||((o=p.ec(a)).a=s,a=p.bc(o)),e.fillStyle!==a&&(e.fillStyle=a),r=n.vertAlign?this.l0a(n.font):n.font,g(n.textBaseline)||e.textBaseline===n.textBaseline?g(e.textBaseline)&&e.textBaseline!==E&&(e.textBaseline=E):e.textBaseline=n.textBaseline,n.isVerticalText?e.textAlign!==k&&(e.textAlign=k):e.textAlign!==I&&(e.textAlign=I),C(e,r)},e.prototype.l0a=function(e){var t=a.To.Ko(e),n=parseFloat(t.fontSize)*W;return t.fontSize=n+"px",this.m0a(t)},e.prototype.m0a=function(e){var t="",n="normal",o=e.fontStyle,r=e.fontSize,i=e.fontWeight,a=e.fontFamily;return t=void 0!==o?o:n,t+=void 0!==i?(t?" ":"")+i:(t?" ":"")+n,(t+=(t?" ":"")+r)+(void 0!==a?(t?" ":"")+a:(t?" ":"")+"Calibri")},e.prototype.vWa=function(e,t,n,o,r,i,s){var l,u,c,f,h,p,d,g,m;if(t&&t.length>0)for(l=e.font,u=y(l,O,b(t)),c=function(e,t){return t/2-e/2+(e>8?F((e-8)/5+2):1)-1}(a.To.No(l,1).fontSize,u),h=(f=this.pHb(e,"0"))/2,p=0;p<t.length;p++)d=K(t[p]),o=o+((g=void 0!==s&&p>=s&&p<=s+2&&(s+3===t.length||0===s&&s+3<t.length||0!==s&&s+3<t.length))?f:u)-(m=g?h:c),e.fillText(d,n,o),this.Mxb(e,r,n,o,A(e,e.font,d),a.To.No(e.font,1).fontSize,i),o+=m;return{x:n,y:o}},e.prototype.Mxb=function(e,t,n,o,r,i,a){var s,l,u,c;e.strokeStyle!==e.fillStyle&&(e.strokeStyle=e.fillStyle),s=0,u=.5,l=F(((i<=12?12:i)-12)/21+1),e.lineWidth!==l&&(e.lineWidth=l),0==(1&l)&&(u=0),(c=e.textAlign)===k?n-=r/2:c===R&&(n-=r),e.beginPath(),2==(2&t)&&(s=P(o+a-i/2)-u,e.moveTo(n,s),e.lineTo(n+r,s)),e.stroke()},e.prototype.k0a=function(e,t,n,o,r,i){var s,l,u,c,f;return g(r)?{x:t,y:n}:(l=(s=a.To.No(e.font,1).fontSize)>8?F((s-8)/5+2):1,u=0,i?(u=1===i?.74*s:.28*-s,e.fillText(r,t,n-u)):e.fillText(r,t,n),c=A(e,e.font,r),f=o.textDecoration,this.ip(e,f,t,n,c,s,l-u),{x:t+c,y:n})},e.prototype.jp=function(t,n,o,r,i,a,s,l){var u={row:l.row,col:l.col,sheet:l.sheet,sheetArea:l.sheetArea,style:s,underline:s.textDecoration,foreColor:s.foreColor};e.ao(l.sheet,"applyHyperlinkStyle",u),this.paint(t,n,o,r,i,a,s,l)},e.prototype.paint=function(e,t,n,o,r,a,s,l){var u,c,f;e&&(u=s.backColor,l.parentBackColor!==u&&ne(e,n,o,r,a,l.imageLoader,s,t,l),c=this,f=new i.Rect(n,o,r,a),c.Sfc(e,l,f,t,s),c.i5&&(c.i5(e,f,s,l),f=c.f5(f,s)),l.cellOverflowLayout||c.uxb(e,f,l,x(t)),f.width>0&&f.height>0&&(s&&s.showEllipsis&&l.sheet._modelManager.qHb(l.row,l.col,null,l.sheetArea),c.paintContent(e,t,f.x,f.y,f.width,f.height,s,l)))},e.prototype.paintContent=function(e,t,n,o,r,a,s,l){var u,c,f,h,p,d,g,m,y=l.sheetArea;2!==y&&1!==y||(u=l.visualState||0,c="columnHeader",2===y&&(c="rowHeader"),f=this.getThemeStyle(l.visualState,"gc-"+c+"-"+i.Im.Jm(u)),J.gp(e,n,o,r,a,s,c,f,y)),(p=l.conditionalFormats)&&(h=p.jp(e,x(t),n,o,r,a,s,l)),l.showBarIconOnly=h,(d=l.sparkline)&&d.paintSparkline(e,n,o,r,a),g=J.bDc(e,x(t),n,o,r,a,l.sheet),l.cellOverflowLayout||h||g||(m=new i.Rect(n,o,r,a),function(e,t,n,o,r,i){if(0===e&&X(t,n,o,r)){var a=oe(t);i.x+=a,i.width-=a}}(s.hAlign,l.sheet,l.row,l.col,l.sheetArea,m),this.paintValue(e,t,m.x,m.y,m.width,m.height,s,l))},e.prototype.createEditorElement=function(e,t){return _},e.prototype.getEditorValue=function(e,t){return _},e.prototype.kp=function(e,t,n,o){return n},e.prototype.setEditorValue=function(e,t,n){},e.prototype.getEditingElement=function(){return _},e.prototype.parse=function(e,t,n){var r,i=g(t),a=g(e);try{if(r=o.Formatter&&o.Formatter.GeneralFormatter,!i&&!a&&r)return(typeof t===D?new r(t):t).parse(e)}catch(e){}return a?"":""+e},e.prototype.format=function(e,t,n,r){var a,s,l,p=S(t);if(r&&p&&(a=r.sheet.aHb(r.row,r.col,t),g(a)||(e=a)),g(e)||""===e)return"";if(r&&r.quotePrefix)return""+e;if(!p&&typeof t===D&&"object"!=typeof e)return i.mn.un(e,t,n);if(!t||"General"===t||p)return"boolean"==typeof e||e instanceof Boolean?(u&&(e=e?u.getBoolean().boolean_true:u.getBoolean().boolean_false),(""+e).toUpperCase()):e instanceof Date?(l=(s=c.q4(c.culture()).DateTimeFormat).shortDatePattern,0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()||(l=s.defaultDatePattern),h.Vb(e,l)):(typeof e===j&&(e=f.nb(""+e)),""+e);try{return o.Formatter&&o.Formatter.GeneralFormatter?(_,(typeof t===D?i.mn.tn(t):t).format(e,n)):""+e}catch(t){return""+e}},e.prototype.focus=function(e,t){e&&e.focus&&e.focus()},e.prototype.getThemeStyle=function(e,t){return i.Im.Km(e,t)},e.prototype.activateEditor=function(e,t,n,o,r,i,a){},e.prototype.deactivateEditor=function(e,t){},e.prototype.selectAll=function(e,t){e&&e.select&&e.select()},e.prototype.updateEditor=function(e,t,n,o,r,i,a){},e.prototype.setImeMode=function(e,t,n){this.isImeAware(n)?this.updateImeMode(e,t,n):e&&J.hp(e,0)},e.prototype.updateImeMode=function(e,t,n){e&&J.hp(e,t)},e.prototype.getHitInfo=function(e,t,n,o,r){return _},e.prototype.getCellAndPaddingHitInfo=function(t,n,o,r,i){var a,s;if(i){if(a={x:t,y:n,context:i,cellStyle:o,cellRect:r,paddingHitInfo:null},e.ao(i.sheet,"getCellButtonHitInfo",a,(function(){return null!==a.paddingHitInfo&&void 0!==a.paddingHitInfo})),s=a.paddingHitInfo,a.paddingHitInfo&&!g(a.paddingHitInfo.cellButtonHitInfo)&&!g(a.paddingHitInfo.cellButtonHitInfo.buttonConfig))return a.paddingHitInfo;if(a.cellRect=this.f5?this.f5(a.cellRect,o):a.cellRect,e.ao(i.sheet,"getCellTextHitInfo",a,(function(){return!g(a.paddingHitInfo)&&a.paddingHitInfo.isReservedLocation})),a.paddingHitInfo&&a.paddingHitInfo.isReservedLocation)return a.paddingHitInfo;if(3===i.sheetArea)return e.ao(i.sheet,"getCellPaddingHitInfo",a,(function(){return!g(a.paddingHitInfo)&&a.paddingHitInfo.isReservedLocation})),a.paddingHitInfo?a.paddingHitInfo:s||this.getHitInfo(t,n,o,r,i)}return this.getHitInfo(t,n,o,r,i)},e.prototype.processCellAndPaddingMouseDown=function(t){return e.ao(t.sheet,"processMouseDownOnCellPadding",t),this.processMouseDown(t)},e.prototype.processMouseDown=function(e){return!1},e.prototype.YBb=function(t){return e.ao(t.sheet,"processMouseMoveOnCellPadding",t),this.processMouseMove(t)},e.prototype.processMouseMove=function(e){return!1},e.prototype.XGb=function(t){return e.ao(t.sheet,"processMouseUpOnCellPadding",t),this.processMouseUp(t)},e.prototype.processMouseUp=function(e){return!1},e.prototype.processMouseEnter=function(e){return!1},e.prototype.ZBb=function(t){return e.ao(t.sheet,"processMouseLeaveOnCellPadding",t),this.processMouseLeave(t)},e.prototype.processMouseLeave=function(e){return!1},e.prototype.isReservedKey=function(e,t){return!1},e.prototype.isEditingValueChanged=function(e,t,n){return n.klb&&(e=e.replace(/\r\n?/g,"\n")),e!==t},e.prototype.processKeyDown=function(e,t){return!1},e.prototype.processKeyUp=function(e,t){return!1},e.prototype.getAutoFitWidth=function(e,t,n,o,r){return J.cp(e,t,n,o,r)},e.prototype.getAutoFitHeight=function(e,t,n,o,r){return J.ep(e,t,n,o,r)},e.prototype.Oja=function(e,t,n,o,r,i,a,s,l,u,c,f,h,p,d,g,m,y){var v;n&&n.content&&n.content.length>0&&(y||!g)?this.Pja(e,n.content,o,r,i,a,s,l,u,c,f,h,p,d,m):(m=m||A(e,e.font,t),v=o,e.textAlign===k?v-=m/2:e.textAlign===R&&(v-=m),this.Ufc(e,h,f,v,r,m,f.lineHeight,d),e.fillText(t,o,r),l&&this.ip(e,l,o,r,m,c,u),this.Vfc(e,h,f,v,r,m,f.lineHeight,d))},e.prototype.tHb=function(e,t,n,o,r,i,a,s,l){if(e.save(),e.textAlign="center",e.textBaseline="middle",e.translate(o,r),e.rotate(-t),e.fillText(n,0,0),i){var u=e.measureText(n).width;this.ip(e,i,0,l,u,a,s)}e.restore()},e.prototype.sHb=function(e,t,n,o){var r,i,a;for(e.font||C(e,o),r=(r=n-fe(e,t))>0?r:0,i=[],a=0;a<t.length;a++)if("fillingChar"===t[a].type)i.push(pe(e,r,t[a].value));else{if("placeholder"===t[a].type||"numberPlaceholder"===t[a].type)continue;i.push(t[a].value)}return i.join("")},e.prototype.Pja=function(e,t,n,o,r,i,a,s,l,u,c,f,h,p,d){var m,y,v,b,C;e.save(),e.textAlign!==I&&(e.textAlign=I),b=(b=i-a-(m=fe(e,t))-((y=h?h.left:0)+(v=h?h.right:0))-2)>0?b:0,g(d)?he(t)?1===r?(n-=(i+y-v)/2,n+=a+y):2===r&&(n=n-i+v+2,n+=a+y):g(m)||(1===r?n-=m/2:2===r&&(n-=m)):he(t)?1===r?(n=n+(d||m)/2-(i+y-v)/2,n+=a+y):2===r&&(n=n+(d||m)-i+v+2,n+=a+y):g(m)||(1===r?n=n+d/2-m/2:2===r&&(n=n+d-m)),this.Ufc(e,f,c,n,o,m,c.lineHeight,p),C=this.Qja(e,t,n,o,b,s,l,u),this.Vfc(e,f,c,n,o,C-n,c.lineHeight,p),e.restore()},e.prototype.Qja=function(e,t,n,o,r,i,a,s,l){var u,c,f,h=0;for(U[e.font+"0"]?h=U[e.font+"0"]:(h=A(e,e.font,"0"),U[e.font+"0"]=h),u=0;u<t.length;u++)"fillingChar"===t[u].type?(e.fillText(pe(e,r,t[u].value),n,o),i&&this.ip(e,i,n,o,r,s,a),n+=r):"placeholder"===t[u].type?n+=A(e,e.font,t[u].value):"numberPlaceholder"===t[u].type?n+=h:((c=t[u].value)!==_&&e.fillText(c,n,o),f=A(e,e.font,c),i&&this.ip(e,i,n,o,f,s,a),n+=f);return n},e.prototype.ip=function(e,t,n,o,r,i,a){var s,l,u,c;e.strokeStyle!==e.fillStyle&&(e.strokeStyle=e.fillStyle),s=e.textAlign,l=0,c=.5,u=F(((i<=12?12:i)-12)/21+1),e.lineWidth!==u&&(e.lineWidth=u),0==(1&u)&&(c=0),s===k?n-=r/2:s===R&&(n-=r),e.beginPath(),4==(4&t)&&(l=P(o+a-i-1)-c,e.moveTo(n,l),e.lineTo(n+r,l)),2==(2&t)&&(l=P(o+a-i/2)-c,e.moveTo(n,l),e.lineTo(n+r,l)),1==(1&t)&&(l=P(o+a-1)-c,e.moveTo(n,l),e.lineTo(n+r,l)),8==(8&t)&&(l=P(o+a-1)-c,e.moveTo(n,l-u),e.lineTo(n+r,l-u),e.moveTo(n,l+u),e.lineTo(n+r,l+u)),e.stroke()},e.prototype.lp=function(e,t){var n="";4==(4&t)&&(n="overline"),2==(2&t)&&(n+=" line-through"),1==(1&t)&&(n+=" underline"),e.css("text-decoration",n)},e.prototype.gQa=function(){return _},e.prototype.isImeAware=function(e){return!1},e.prototype.isEditting=function(){return!1},e.prototype.toJSON=function(){var e,t={},n=this;for(e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t},e.prototype.fromJSON=function(e){if(e)for(var t in e)g(e[t])||(this[t]=e[t])},e}(),t.Base=Y,i.Zn(Y),l._o[0]=Y},"./dist/core/celltype/cellType.entry.js":function(e,t,n){"use strict";function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),o(n("./dist/core/celltype/celltype.ns.js")),o(n("./dist/core/celltype/basecelltype.js")),o(n("./dist/core/celltype/textcelltype.js")),o(n("./dist/core/celltype/headercelltype.js"))},"./dist/core/celltype/celltype.ns.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._o={}},"./dist/core/celltype/headercelltype.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function S(e,t){return e=e||0,c.Km(e,"gc-"+t+"-"+c.Jm(e))}function T(e,t,n,o,r,i){var a=new Image,s=i;s=(s=s.replace('url("',"")).replace('")',""),a.src=s,e.drawImage(a,t,n,o,r)}function N(e,t,n,o,r,i,s,c,f){var p,d,m,y,b,C,w,x,A,M,S,N,I;function R(){e.fillRect(t+1,n+1,o-1,r-1)}if(!g(c)){if(e.save(),e.beginPath(),p=i.backColor,0===c&&p)a.To.setFillStyle(e,p,t,n,o,r,R);else try{if(p=f&&f.backgroundColor,d=f&&f.backgroundImage,m=s.sheet,y=s.row,b=s.col,C=s.sheetArea,w=void 0,x=!1,m.cellStates&&c===u.VisualState.hover&&((w=m.cellStates.getStyle(y,b,C))&&w.backColor&&(p=w.backColor,x=!0)),!x&&d&&-1!==d.indexOf("linear-gradient")){for(A=h(d),M={degree:90,stops:[]},S=0,N=A.length;S<N;S++)I=A[S],M.stops.push({position:I.point,color:I.color});a.To.setFillStyle_Gradient(e,M,t,n,o,r,R)}else p?(e.fillStyle=p,R()):d&&d!==v&&T(e,t+1,n+1,o-1,r-1,d)}catch(e){}l.Context.ap(e,t,n,o,r,i.backgroundImage,i.backgroundImageLayout,s.imageLoader),e.restore()}}function I(e,t,n,o,r,a,s,u,c,f,h,p){var d,g,m;t&&(N(t,o,r,a,s,u,c,d=c.visualState||0,g=S(d,f)),l.Context.gp(t,o,r,a,s,u,f,g,h,c.needTopGridline,c.needLeftGridline),m=new i.Rect(o,r,a,s),e.Sfc(t,c,m,n,u),e.i5&&(e.i5(t,m,u,c),m=e.f5(m,u)),m.width>0&&m.height>0&&e.paintContent(t,n,m.x,m.y,m.width,m.height,u,c,p))}function R(e,t,n,o,r,i){var s,l={font:t,fillStyle:n},u=o.sheet;return 0!==o.visualState&&parseInt(i.zIndex,10)>2007&&u.vp(o.row,o.col,r)&&(void 0,s=u.wp(o.row,o.col,r)?e(o.visualState,"gc-columnHeader-selected"):e(o.visualState,"gc-columnHeader-highlight"),l.fillStyle=s.color,l.font=a.To.Ro(l.font,"bold")),l}function k(e,t,n,o,r,a,s,l,u,c,f,h){var p,d,g={},y=e.format(m(n),l.formatter,g),v=u.sheet;y&&(t.save(),t.beginPath(),(!!((p=v.rowFilter&&v.rowFilter())&&p.Dl(u.row,u.col,c)&&p.filterButtonVisible(u.col))||h)&&(a-=v.oK(new i.Rect(o,r,a,s),c).width),(d=l.foreColor)||(d=f.color),d&&t.fillStyle!==d&&(t.fillStyle=d),n&&n.richText&&n.richText.length>0||l.isVerticalText?E(e,v,t,n,o,r,a,s,l,y,g,u,c,f):D(e,t,n,o,r,a,s,l,y,g,u,c,f),t.restore())}function E(e,t,n,o,r,i,a,s,l,u,c,f,h,d){var g,v,b,w,x,A,M,S,T,N,I,k,E,D,j,_,O=new C(r,i,a,s),F=R(e.getThemeStyle,l.font||n.font,n.fillStyle,f,h,d),P=l.isVerticalText,H=l.hAlign,B=function(e){var t=0,n=e.textIndent;return n>0&&(t=8*n),t}(l),L=e.T_a(l.formatter||l._autoFormatter,o.text),z=y(!0,[],e.U_a(o,u,L,F.font,F.fillStyle));if(o&&o.richText&&o.richText.length>0&&(g=f.sheet?f.sheet.zoom():1,e.V_a(z,F,g)),v=e.Pfc(n,m(o),l,f,r,i,a,s),x=(b=e.Qfc(v.externals.left))+(w=e.Qfc(v.externals.right)),A={left:b,right:w},!l.wordWrap&&l.shrinkToFit&&e.W_a(z,a-x,s,l,F,1,P),M=e.X_a(n,u,l.font,P?s:a-x,B,P?l.vAlign:l.hAlign,l.wordWrap,P,z),S=e.Y_a(M,l,H),function(e,t,n,o,r,i,a,s,l){(!!t.wordWrap||(t.isVerticalText?s+a>i||l>r:s+a>r||l>i))&&(e.rect(n,o,r,i),e.clip(),e.beginPath())}(n,l,r,i,a,s,B,M[0].textLength,S[0].lineHeight),T=P?p(u):void 0,N=!1,l.wordWrap||l.shrinkToFit||!l.showEllipsis||!P||o.richText||(N=!0),I=e.$_a(O.x,O.y,O.width,O.height,H,l.vAlign,B,P,T,M,S,A,N),k=[],N&&c&&(c.content&&1===c.content.length&&"text"===c.content[0].type||!c.content&&1===M.length&&M[0].text)&&e.oHb(n,f,M,S,l,s,i,B,I,k),1===(E=M.length)&&c.content&&!L)e.__a(n,t,u,c,I[0].x,I[0].y,a,s,H,l,O.width,O.height,B,P,M[0].textLength,f,A,O);else for(D=0;D<E;D++)j=e.Wfc(M),_=I[0].x,"center"===n.textAlign?_-=j/2:"right"===n.textAlign&&(_-=j),e.Ufc(n,l,f,_,I[0].y,j,0,O),e.a0a(n,t,I[D].x,I[D].y,S[D],H,M[D],k[D]),e.Ufc(n,l,f,_,I[0].x,j,0,O)}function D(e,t,n,o,r,i,s,l,u,c,h,p,g){var m,y,v,w,x,A,M,S,T,N,I,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X=new C(o,r,i,s),ee=R(e.getThemeStyle,l.font||t.font,t.fillStyle,h,p,g);if(d(t,ee.font),t.fillStyle=ee.fillStyle,m=0,(y=l.textIndent)>0&&(m=8*y),v=parseInt(h.fontInfo.fontSize,10),w=l.hAlign,x=l.vAlign,A="left",M=2,S=e.Pfc(t,u,l,h,o,r,i,s),I=(T=e.Qfc(S.externals.left))+(N=e.Qfc(S.externals.right)),k={left:T,right:N},M+=m+T,1===w?(M=(i+T-N)/2,A="center"):2===w&&(M=i-N-1,M-=m,A="right"),t.textAlign!==A&&(t.textAlign=A),E=0,D="alphabetic",j=2,_=l.wordWrap,O=l.shrinkToFit,F=l.font,P=h.lineHeight,H=[],B=0,!_&&O)for(L=0,z={value:!1},V=0;V<3&&!1===z.value&&(G=t.measureText(u).width,(L=Math.max(0,i-4-(1===w?0:m)))<G);V++)F=a.To.No(F,L/G,z,!0).font,d(t,F);if(W=0,_&&(W=i-I-3-m,W-=1,(B=(H=f.Wn(u,W,ee.font)).length)>1&&0!==x&&(E=(B-1)*P)),Z=P/2-v/2+(U=v>8?b((v-8)/5+2):1)-1,!_&&l.showEllipsis&&e.rHb(h,c,u,t,i,w,m),j+=P-Z,1===x?j=(s-E)/2+P/2-Z:2===x&&(j=s-E-2-Z),t.textBaseline!==D&&(t.textBaseline=D),q=l.textDecoration,J=X.x,Q=X.y,Y=X.width,K=X.height,l.wordWrap)if(t.rect(J,Q,Y,K),t.clip(),t.beginPath(),$=r+j,B>1){for(e.Ufc(t,l,h,o+M,$,W,P*B,X),V=0;V<B;V++)t.fillText(H[V],o+M,$),q&&(G=t.measureText(H[V]).width,e.ip(t,q,o+M,$,G,v,U)),$+=P;e.Ufc(t,l,h,o+M,$,W,P*B,X)}else e.Oja(t,u,c,o+M,r+j,w,Y,m,q,U,v,h,l,k,X);else(t.measureText(u).width>Y||P>K)&&(t.rect(J,Q,Y,K),t.clip(),t.beginPath()),e.Oja(t,u,c,o+M,r+j,w,Y,m,q,U,v,h,l,k,X,void 0,void 0,l.showEllipsis)}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("./dist/core/util/domUtil.js"),i=n("./dist/core/util/common.js"),a=n("./dist/core/worksheet/stylehelper.js"),s=n("./dist/core/celltype/celltype.ns.js"),l=n("./dist/core/celltype/basecelltype.js"),u=n("./dist/core/core.enum.js"),c=i.Im,f=i.Vn,h=i.Ul.wl,p=i.Ul.uWa,d=i.Ul.lZa,g=o.Common.j.Fa,m=i.Ul.K_a,y=r.GC$.extend,v="none",b=Math.floor,C=i.Rect,w=function(e){function t(){var t=e.call(this)||this;return t.typeName="2",t}return M(t,e),t.prototype.paint=function(e,t,n,o,r,i,a,s,l){I(this,e,t,n,o,r,i,a,s,"columnHeader",1,l)},t.prototype.paintContent=function(e,t,n,o,r,i,a,s,u){l.Context.bDc(e,m(t),n,o,r,i,s.sheet)||k(this,e,t,n,o,r,i,a,s,1,S(s.visualState,"columnHeader"),u)},t}(l.Base),t.ColumnHeader=w,s._o[2]=w,x=function(e){function t(){var t=e.call(this)||this;return t.typeName="3",t}return M(t,e),t.prototype.paint=function(e,t,n,o,r,i,a,s){I(this,e,t,n,o,r,i,a,s,"rowHeader",2)},t.prototype.paintContent=function(e,t,n,o,r,i,a,s){l.Context.bDc(e,m(t),n,o,r,i,s.sheet)||k(this,e,t,n,o,r,i,a,s,2,S(s.visualState,"rowHeader"))},t}(l.Base),t.RowHeader=x,s._o[3]=x,A=function(e){function t(){var t=e.call(this)||this;return t.typeName="4",t}return M(t,e),t.prototype.paint=function(e,t,n,o,r,i,a,s){var l,u,f,p,d,g,m,y,b,C,w,x,A,M,S;if(e){e.save(),e.rect(n,o,r,i),e.clip(),e.beginPath(),this,l=s.visualState||0;try{f=(u=this.getThemeStyle(s.visualState,"gc-corner-"+c.Jm(l)))&&u.backgroundColor,p=u&&u.backgroundImage,f?(e.fillStyle=f,e.fillRect(n,o,r,i)):p&&p!==v&&T(e,n,o,r,i,p)}catch(e){}if(g=(d=this.getThemeStyle(4,"gc-corner-triangle-"+c.Jm(l)))&&d.backgroundImage,m=d&&d.backgroundColor,y=e.createLinearGradient(n+r/2,o,n+r/2,o+i),g&&-1!==g.indexOf("linear-gradient")){for(C=0,w=(b=h(g)).length;C<w;C++)x=b[C],y.addColorStop(x.point,x.color);e.fillStyle=y}else m&&(y.addColorStop(.125,"#f6fafb"),y.addColorStop(1,m),e.fillStyle=y);(A=e.createLinearGradient(n+r,o+1,n+r,o+i-2)).addColorStop(0,d.borderLeftColor),A.addColorStop(1,d.borderRightColor),e.beginPath(),e.strokeStyle=A,e.moveTo(n+r-.5,o),e.lineTo(n+r-.5,o+i),e.stroke(),s.needLeftGridline&&(e.beginPath(),e.strokeStyle=d.borderLeftColor,e.moveTo(n+.5,o),e.lineTo(n+.5,o+i),e.stroke()),(M=e.createLinearGradient(n,o,n+r-2,o)).addColorStop(0,d.borderTopColor),M.addColorStop(1,d.borderBottomColor),e.beginPath(),e.strokeStyle=M,e.moveTo(n,o+i-.5),e.lineTo(n+r,o+i-.5),e.stroke(),s.needTopGridline&&(e.beginPath(),e.strokeStyle=d.borderTopColor,e.moveTo(n,o+.5),e.lineTo(n+r,o+.5),e.stroke()),e.beginPath(),3,S=i,r<i&&(S=r),e.moveTo(n+r-S+3,o+i-3),e.lineTo(n+r-3,o+i-3),e.lineTo(n+r-3,o+i-S+3),e.fill(),e.restore()}},t}(l.Base),t.Corner=A,s._o[4]=A},"./dist/core/celltype/textcelltype.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe,re,ie,ae,se,le,ue,ce,fe,he,pe,de,ge=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function me(e){return function(e){return re||0===e}(e)?i.GC$(v("textarea")):i.GC$(v("div"))}function ye(e){return e&&"DIV"===e.tagName&&"true"===e.contentEditable}function ve(e){return ye(e)?C&&parseFloat(b.version)<10?g.Woa(e):e.innerText:e.value}function be(e,t){ye(e)?e.innerText=t:e.value=t}function Ce(e){var t;return ye(e)?(t=te.getSelection()).rangeCount>0?t.getRangeAt(0).startOffset:0:e.selectionStart}function we(e){var t;return ye(e)?(t=te.getSelection()).rangeCount>0?t.getRangeAt(0).endOffset:0:e.selectionEnd}function xe(e){return e&&"BR"===e.tagName}function Ae(e){return e&&"SPAN"===e.tagName}function Me(e){return e&&"DIV"===e.tagName}function Se(e){return e instanceof Text}function Te(e,t,n,o){return e.substr(0,t)+o+e.substr(n,e.length-n)}function Ne(e,t,n,o,r){var i,a,s=String.fromCharCode(function(e){var t=e.keyCode,n=e.shiftKey,o={106:42,107:43,109:45,110:46,111:47,173:45},r={186:59,187:61,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39},i={186:58,187:43,188:60,189:95,190:62,191:63,192:126,219:123,220:124,221:125,222:34},a=t;return t>=96&&t<=105?a=t-48:o[t]?a=o[t]:n&&i[t]?a=i[t]:!n&&r[t]?a=r[t]:!n&&t>=65&&t<=90&&(a=t+32),a}(r));return ye(e)?(i=te.getSelection()).rangeCount>0&&Se((a=i.getRangeAt(0)).startContainer)?function e(t,n,o,r,i,a){var s,l,u,c,f,h="",p=t.childNodes,d=p.length;for(s=0;s<d;s++)Ae(l=p[s])?h+=e(l,n,o,r,i,a):Se(l)?(u=n&&n.startContainer,c=n&&n.endContainer,f=l.textContent,l===u||l===c?u!==c?l===u?(h+=Te(f,o,f.length,i),a=!0):(h+=Te(f,0,r,""),a=!1):h+=Te(f,o,r,i):a||(h+=f)):xe(l)&&!a&&(h+="\n");return h}(e,a,n,o,s):a&&a.startOffset===a.endOffset?t+s:s:Te(t,n,o,s)}function Ie(e){var t=function(e){var t,n=e;return n?((t=n.length)>0&&"\n"===n[t-1]&&(n+=""),n):n}(e);return t&&t.indexOf(" ")>=0&&(t=E(t," ","")),t}function Re(e,t,n,o,i,a){var s,l,u,c,f,h,p,g,m,y,v=e.srcElement||e.target;v&&"gcEditingInput"===v.getAttribute(B)&&13===e.keyCode&&(e.ctrlKey||e.altKey)&&((s=d.Xl())instanceof r.Worksheet&&((l=s.getCellType(s.Jl,s.Kl))&&(ye(v)?(n&&(v.blur(),v.focus()),(u=te.getSelection()).rangeCount>0&&(c=u.getRangeAt(0),(f=ne.createElement("span")).innerHTML="<br/>",c.insertNode(f),(h=ne.createRange()).setStartAfter(f),h.setEndAfter(f),h.collapse(!1),u.removeAllRanges(),u.addRange(h))):(p=v.selectionStart,m=(g=v.value).substr(0,p),y=g.substr(p,g.length-p),v.value=m+"\n"+y,v.selectionStart=p+1,v.selectionEnd=p+1),l.$fc(s._editor,ie,ie,e,t,!0))),A(e))}function ke(e){var t,n=e;return n?n.indexOf("")<0&&n.indexOf("\n")<0?n:((t=e.split("\n")).forEach((function(e,t,n){(function(e){return""===e})(e[0])&&(n[t]=e.substr(1))})),t.join("\n")):n}function Ee(e){var t,n,o,r,i,a=te.getSelection(),s=!1,l=0,u=0;if(a.rangeCount>0)return t=a.getRangeAt(0),n=Ce(e),o=we(e),r=t.startContainer,i=t.endContainer,Me(r)&&(s=!0,l=n),Me(i)&&(u=o),function e(t,n,o,r,i,a,s,l){var u,c,f,h,p,d,g;if(r===i&&!a)return{content:ke(r.textContent.slice(n,o))};for(u="",c=s,p=t.childNodes,d=l||p.length;c<d;c++)if(Ae(g=p[c])){if(f=e(g,n,o,r,i,a,0,0),u+=f.content,f.startFlag&&(a=!0),f.endFlag){h=!0;break}}else if(Se(g)&&g===r)u+=g.textContent.slice(n,g.textContent.length),a=!0;else{if(Se(g)&&g===i){u+=g.textContent.slice(0,o),h=!0;break}a&&(u+=xe(g)?"\n":g.innerText||g.textContent)}return{content:ke(u),startFlag:a,endFlag:h}}(e,n,o,r,i,s,l,u).content}function De(e,t){var n,o=e.length,r=[];for(n=0;n<o;n++)r.push(R(e[n],t));return r}function je(e,t,n,o){var r,i=0,a=n;for(r=0;r<e.length;r++)x&&(a=o[r]),e[r]>t?i+=a*se(e[r]/t):i+=a;return i}function _e(e){var t,n,o,r,i=["0","0","0","0"];return"string"==typeof e&&(o=void 0,r=void 0,1===(n=(t=e.split(" ",4)).length)?i=[o=t[0],o,o,o]:2===n?i=[o=t[0],r=t[1],o,r]:3===n?(r=t[1],i=[t[0],r,t[2],r]):4===n&&(i=[t[0],t[1],t[2],t[3]])),i}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("./dist/core/worksheet/worksheet.js"),i=n("./dist/core/util/domUtil.js"),a=n("./dist/core/util/common.js"),s=n("./dist/core/celltype/celltype.ns.js"),l=n("./dist/core/celltype/basecelltype.js"),u=n("./dist/core/core.enum.js"),c=n("./dist/core/util/common.js"),f=o.Common.j.Fa,h=a.Vn,p=a.Events.EditChange,d=a.Vl,g=a.Ul,m=a.uHb,y=g.lHb,v=g.Nl,b=g.Ml,C=b.msie,w=b.edge,x=b.chrome,A=g.nl,M=g.ol,S=g.Il,T=g.vl,N=g.rl(),I=g.fp,R=g.Voa,k=g.pL,E=g.Ika,D=g.hZa,j=g.K_a,_=g.Fxb,O="left",F="right",P="center",H="top",B="gcUIElement",L="none",z=".gcEditingInput",V="width",G="height",W="text-align",U="hidden",Z="word-wrap",q="overflow",J="vertical-align",Q="normal",Y="break-word",K="overflow-y",$="scroll",X="word-break",ee="float",te=window,ne=document,oe=N.ipad,re=N.iphone||oe||N.android,ie=null,ae=void 0,se=Math.ceil,le=Math.min,ue=Math.sin,ce=Math.cos,fe=Math.abs,he=Math.max,pe=parseInt,function(e){e[e.textarea=0]="textarea",e[e.editableDiv=1]="editableDiv"}(t.EditorType||(t.EditorType={})),de=function(e){function t(t){var n=e.call(this)||this;return n.allowOverflow=!0,n.typeName="1",n.editorType=f(t)?1:t,n}return ge(t,e),t.prototype.getText=function(e,t){return e},t.prototype.paintValue=function(e,t,n,o,r,i,a,s){var c,f,h,p,d,g,m,v,b,C,w,A,S,T,N,I,R,k,E,D,O=this,F=s.sheet,P=F.zoom?F.zoom():1;if(t=O.getText(t,s),c={},s.quotePrefix=a.quotePrefix,p=(h=a.formatter)&&"General"!==h,d=y(h),"string"==typeof h&&(p=p&&!d),g=a.textOrientation,m=a.textIndent&&0!==a.textIndent,v=a.isVerticalText,b=r,g&&-90<=g&&g<=90&&!m&&!v&&(C=fe(g*Math.PI/180),b=(i-s.lineHeight*ce(C))/ue(C)),w=O.Pfc(e,f,a,s,n,o,r,i).externals,A=O.Qfc(w.left),S=O.Qfc(w.right),3===(T=a.hAlign)&&(T=M(T,t,a.formatter)),2===T?b-=S:0===T&&(b-=A),N=a._autoFormatter&&a._autoFormatter.formatCached&&"General"!==a._autoFormatter.formatCached,p?I=a.formatter:N?I=a._autoFormatter:F.parent&&F.parent.options.numbersFitMode===u.NumbersFitMode.mask?I=l.Context.Ixb(e,t,b,a,P):F.parent&&F.parent.options.numbersFitMode===u.NumbersFitMode.overflow&&(I=a._autoFormatter),f=d&&(t instanceof Date||"boolean"==typeof t||t instanceof Boolean||"number"==typeof t)?O.format(t,h,{}):O.format(j(t),I,c,s),!0!==a.shrinkToFit&&!v)if(_(t)){if(F.parent){switch(R=f,F.parent.options.numbersFitMode){case u.NumbersFitMode.mask:R=this.Yfc(e,f,b,a,P,s,c,F);break;case u.NumbersFitMode.overflow:R=this.Klb(e,s,t,a,F,f,c)}f=R}}else void 0===F._modelManager.uIb(s.row,s.col,s.sheetArea)||a.showEllipsis||F._modelManager.qHb(s.row,s.col,void 0,s.sheetArea);return k=a.labelOptions,E=a.watermark,D=!k||0!==k.visibility,E&&!f&&D?void O.paintText(e,E,n,o,r,i,a,s,E,c,.337):void((f||c.content&&c.content.length)&&(1===a.vAlign&&x&&o--,O.paintText(e,t,n,o,r,i,a,s,f,c,ae,w)))},t.prototype.Yfc=function(e,t,n,o,r,i,a,s){var u=l.Context.Lxb(e,t,n,o,r),c=i.row,f=i.col;return t!==u?(delete a.content,o.textIndent=0,s._modelManager.qHb(c,f,s.getText(c,f,i.sheetArea),i.sheetArea)):s._modelManager.qHb(c,f,void 0,i.sheetArea),u},t.prototype.Klb=function(e,t,n,o,r,i,a){var s,l,u,c,f=t.row,h=t.col;if("number"==typeof n&&delete a.content,o.wordWrap&&(o.wordWrap=!1),s=k(e,o.font,i),l=r.ss._m(h),c=void 0,!(u=t.cellOverflowLayout)&&l<s)c=r.getText(f,h,t.sheetArea);else if(u&&l<s&&this.lDc(u.backgroundWidth)&&this.lDc(u.valueWidth)){if(!this.lDc(o.hAlign))return;void 0,c=(1!==o.hAlign?u.valueWidth>u.backgroundWidth:u.valueWidth/2>u.backgroundLeftWidth||u.valueWidth/2>u.backgroundRightWidth)?r.getText(f,h,t.sheetArea):void 0}return r._modelManager.qHb(f,h,c,t.sheetArea),i},t.prototype.lDc=function(e){return null!=e},t.prototype.createEditorElement=function(e,t){var n,o=e&&e.sheet&&e.sheet.parent&&e.sheet.parent._host,r=T(o)+1e3;return i.GC$(t).css("z-index",r),n=me(this.editorType),i.GC$(n).css({font:"normal 11pt calibri",outline:L,resize:L,border:L,padding:"1px","vertical-align":"top","min-height":"0px","box-sizing":"content-box",background:"transparent"}).css(Z,Q).attr({tabindex:-1,autocomplete:"off",contenteditable:!0}).css(q,U).attr(B,"gcEditingInput"),b.safari&&i.GC$(n).css("-webkit-user-select","auto"),ye(i.GC$(n)[0])&&(i.GC$(n).css("display","table-cell"),i.GC$(n).css(X,Q)),i.GC$(n)[0]},t.prototype.getEditorValue=function(e,t){var n,o;return e&&(n=ve(e),!f(n)&&n.length>0)?(o=(o=ke(n)).replace(/\r\n?/g,"\n")).indexOf("")<0?o:E(o,""," "):ie},t.prototype.setEditorValue=function(e,t,n,o){var r,i;e&&(r=n&&n.sheet&&n.sheet.HF,i=Ie(t),C?r&&n.isImeInput||be(e,f(i)?o?"%":"":i):be(e,r?o?"%":"":i))},t.prototype.selectAll=function(e,t){e&&e.select?e.select():te.getSelection().selectAllChildren(e)},t.prototype.focus=function(e,t){this.isImeAware()&&e?(e.focus(),function(e){if(ye(e)){var t=te.getSelection();t.selectAllChildren(e),t.rangeCount>0&&t.collapseToEnd()}else e.selectionStart=e.selectionEnd=e.value.length}(e)):e.parentNode.parentNode.focus()},t.prototype.kp=function(e,t,n,o){var r=e&&o&&o.sheet,i={},a=S(t,n,r,i);return e.oja=i.formatter||ae,a},t.prototype.activateEditor=function(e,t,n,o,r,a,s){var l,u,c,h,d=o&&o.sheet;d&&(l=this,(u=e)&&(c=i.GC$(u),h=ye(u),l._editingElement=u,N.android&&c.bind("input"+z,(function(e){try{l.$fc(u,t,n,e,o,!1,r,a,s)}catch(e){}})),c.bind("keydown"+z,(function(e){var i;try{i=e.keyCode,h&&(8===i?m.processBackspaceAndLeftArrowKeyEvent(e,!0):46===i?m.processDeleteAndRightArrowKeyEvent(e,!0):37===i?m.processBackspaceAndLeftArrowKeyEvent(e,!1):39===i&&m.processDeleteAndRightArrowKeyEvent(e,!1)),229===i||0===i||l.kK||l.$fc(u,t,n,e,o,!0,r,a,s),Re(e,o,l.kK)}catch(e){}})),c.bind("keyup"+z,(function(e){var c=e.keyCode,f=e.ctrlKey,g=e.altKey;229===c||0===c||l.kK||(46!==c&&8!==c&&(90!==c&&89!==c||!f||g)||(h&&"\n"===u.innerText&&i.GC$(u).empty(),l.$fc(u,t,n,e,o,!1,r,a,s)),(13!==c&&9!==c&&27!==c&&16!==c||f||g)&&d.Wq(p,{sheet:d,sheetName:d.name(),row:d.Jl,col:d.Kl,editingText:l.getEditorValue(u,o)}))})),c.bind("mousedown"+z,(function(){1===d._editorStatus&&(d._editorStatus=2,d._raiseEditorStatusChanged(1,2))})),c.bind("textInput"+z,(function(e){if(e.data&&(l.probabilityAddPercentSpec||l.probabilityAddPercent)&&/^[0-9]+.?[0-9]*/.test(e.data)){var t=document.createElement("span");t.innerText="%",t.id="updateEditorImpAddPercent","#text"===u.firstChild.nodeName?u.appendChild(t):u.firstChild.appendChild(t),delete l.probabilityAddPercentSpec,delete l.probabilityAddPercent}})),c.bind("compositionstart"+z,(function(){l.kK=!0,l.nK=ve(u)})),c.bind("compositionupdate"+z,(function(e){l.$fc(u,t,n,e||ie,o,!0,r,a,s)})),c.bind("compositionend"+z,(function(e){var i,c,f,h;l.$fc(u,t,n,e||ie,o,!1,r,a,s),l.kK=!1,i=e.keyCode,c=e.ctrlKey,f=e.altKey,h=l.getEditorValue(u,o)||"",l.nK!==h&&(i===ae||13!==i&&9!==i||c||f)&&d.Wq(p,{sheet:d,sheetName:d.name(),row:d.Jl,col:d.Kl,editingText:h})})),h&&(c.bind("copy"+z,(function(e){var t=te.clipboardData,n=e.clipboardData,o=Ee(e.currentTarget);f(o)||(t&&t.setData?(t.setData("text",o),A(e)):n&&n.setData&&(n.setData("text/plain",o),A(e)))})),c.bind("paste"+z,(function(e){var i,c,f,p,d,g,m,y=!1;if(h)try{i=void 0,C&&!w&&te.clipboardData&&te.clipboardData.getData?i=te.clipboardData.getData("text"):e.clipboardData&&e.clipboardData.getData&&(i=e.clipboardData.getData("text/plain")),i=Ie(i=i.replace(/\r\n?/g,"\n")),(c=te.getSelection()).rangeCount>0&&((p=(f=c.getRangeAt(0)).startOffset)!==f.endOffset&&f.deleteContents(),function(e,t,n){var o=ve(e);return o&&"="===o[0]||""===o&&"="===t[0]||0===n&&"="===t[0]}(u,i,p)||(d=ne.createElement("span"),"\n"===(i=i.replace(/\u200B/g,""))[(g=i.length)-1]&&(i="\r"===i[g-2]?i.substr(0,g-2):i.substr(0,g-1)),d.innerText=i,f.insertNode(d),(m=document.createRange()).setStartAfter(d),m.setEndAfter(d),m.collapse(!1),c.removeAllRanges(),c.addRange(m),y=!0))}catch(e){}if(l.mK=te.setTimeout((function(){l.$fc(u,t,n,e,o,!1,r,a,s),l.mK&&(clearTimeout(l.mK),delete l.mK)}),10),y)return!1})))))},t.prototype.deactivateEditor=function(e,t){var n,o,r,a,s,l;if(e){if(n=e,this.kK&&oe&&t&&t.sheet&&t.sheet.CH)try{n&&i.GC$(n).trigger("compositionend"+z)}catch(e){}if(o=t.sheet.getActualStyle(t.row,t.col,t.sheetArea).cellPadding)for(r=[O,H],a=[3,0],s=0;s<r.length;s++)l="number"==typeof(l=parseInt(_e(o)[a[s]],10))&&l>0?l:0,this.shiftPadding(n,r[s],l);i.GC$(e).unbind(z)}this._editingElement=ie},t.prototype.shiftPadding=function(e,t,n){var o=i.GC$(e).parent();o&&(t===O?o.css({left:(+i.GC$(o).css(O).replace("px","")||0)-n}):t===H&&o.css({top:(+i.GC$(o).css(H).replace("px","")||0)-n}))},t.prototype.getEditingElement=function(){return this._editingElement},t.prototype.lK=function(e,t,n,o,r,a,s,u,c){var p,d,g,m,y,v,b,w,A,S,T,N,R,k,E,j,_,H,B,z,te,ne,oe,re,ie,ae,ue,ce,fe,de,ge,me,be,xe,Ae,Me,Se,Te,Ie=r&&r.sheet,Re=this,ke=Ie.options.sheetAreaOffset,Ee=e;if(Ee&&Ie&&(p=i.GC$(Ee),d=Ie._render,g=r.preventOverflow,m=ve(Ee),Ie.isEditing())){if(y=ye(Ee),v=void 0,b=O,w=void 0,A=l.Context.u5,S=0,T=0,N=0,R=0,t&&(S=A(t,0),T=A(t,1),N=A(t,2),R=A(t,3),1===(v=M(t.hAlign,e.LF))?b=P:2===v&&(b=F),p.css(W,b),t.foreColor&&p.css("color",t.foreColor),(w=t.font||d.Bl())&&(Ie.zoom()>1&&(w=d.Cl(w)),p.css("font",D(w))),t.textDecoration&&Re.lp(p,t.textDecoration)),k=pe(p.css("padding-left"),10)+pe(p.css("padding-right"),10),E=pe(p.css("padding-top"),10)+pe(p.css("padding-bottom"),10),f(s)&&(s=n),s&&(j=Ie.am(),_=n.width,s.x+s.width-ke.left>j.width&&(n.width=j.width-n.x,s.width=j.width-s.x),p.css(V,_-k).css(G,n.height-E),Ee.maxWidth=ke.left+j.width-n.x-k-T,p.css("max-width",Ee.maxWidth+"px"),Ee.maxHeight=ke.top+j.height-n.y-E-N,Ee.minWidth=pe(Ee.style.width,10),Ee.minHeight=pe(Ee.style.height,10)),H=Ce(Ee),B=we(Ee),z=(a=(a=a&&o&&o.keyCode&&Ie._eventHandler.LH(o)&&0===H&&B===m.length)||Ie.HF)?"":m,(w=Ee.style.font)||(w=d.Cl(d.Bl())),te=I(w),o&&Re.probabilityAddPercent&&((ne=o.keyCode)&&(ne>=96&&ne<=105||ne>=48&&ne<=57)&&(Ie.parent.options.enableFormulaTextbox?(re=Ee.innerText,/[a-z]/i.test(re)?Re.probabilityAddPercent=!1:((oe=document.createElement("span")).innerText="%",oe.id="updateEditorImpAddPercent",Ee.appendChild(oe),delete Re.probabilityAddPercent)):((oe=document.createElement("span")).innerText="%",oe.id="updateEditorImpAddPercent",Ee.firstChild.appendChild(oe),delete Re.probabilityAddPercent))),!a&&o&&(Ie._eventHandler.LH(o)&&8!==o.keyCode&&(z=Ne(Ee,z,H,B,o)),Re.kK&&(z=C?m:Re.nK+o.data)),[],ae=void 0,ue=void 0,ce=(ie=t&&t.wordWrap?h.Wn(z,pe(Ee.style.width)-k,w):z.split(/\r\n|\r|\n/)).length,Ee.minWidth=le(Ee.minWidth,Ee.maxWidth),Ee.minHeight=le(Ee.minHeight,Ee.maxHeight),t&&t.wordWrap||ce>0){if(fe=void 0,de=void 0,x?fe=function(e){var t,n=e.length,o=0;for(t=0;t<n;t++)o+=e[t];return o}(de=De(ie,w)):fe=ce*te,t&&t.wordWrap)p.css(Z,Y).css(q,U).css("max-width",Ee.style.width);else{for(ge=0,me=[],ae=0;ae<ce;ae++)ue=se(Ie.rt(ie[ae],w)),me.push(ue),ge=he(ge,ue);be=p.css(Z),xe=pe(Ee.style.width),t||be!==Y?ge<=Ee.minWidth?(p.css(V,Ee.minWidth).css(Z,Q).css(q,U),y&&p.css(X,Q)):ge>Ee.minWidth&&ge<=Ee.maxWidth&&!g?(p.css(V,ge).css(Z,Q).css(q,U),y&&p.css(X,Q)):ge>Ee.maxWidth&&!g&&(p.css(V,Ee.maxWidth-2).css(Z,Y).css(q,U),fe=je(me,Ee.maxWidth,te,de)):ge>xe&&!g&&(fe=je(me,xe,te,de))}fe<=Ee.minHeight?p.css(G,Ee.minHeight).css(ee,L):fe>Ee.minHeight&&fe<=Ee.maxHeight?p.css(G,fe).css(ee,L):fe>Ee.maxHeight&&p.css(G,Ee.maxHeight-1).css(K,$).css(ee,O)}return v=p.css(W),Ae=p.width()-Ee.minWidth,f(v)||v===O||(v===P?p.css(O,Ee.originalLeft-Ae/2):v===F&&p.css(O,Ee.originalLeft-Ae)),t&&y&&(1===(Me=t.vAlign)?p.css(J,"middle"):2===Me&&p.css(J,"bottom")),Se=pe(Ee.style.height)+E+S+N,Te=k+R+T,p.css(K)===$?{width:Ee.offsetWidth+Te,height:a?0:Se}:{width:pe(Ee.style.width)+Te,height:Se}}},t.prototype.updateEditor=function(e,t,n,o,r,a,s){var l,u,h;return n=this.lK(e,t,n,ie,o,!1,r,a,s),C&&e&&(u=(l=i.GC$(e)).width(),l.width(u+1).width(u)),!f(n)&&e&&(h=new c.Rect(e.style.left?parseFloat(e.style.left):0,e.style.top?parseFloat(e.style.top):0,n.width,n.height)),h},t.prototype.$fc=function(e,t,n,o,r,a,s,l,u){if(n=this.lK(e,t,n,o,r,a,s,l,u),C&&e){var c=i.GC$(e),h=c.width();c.width(h+1).width(h)}!f(n)&&e&&(f(s)?s=n:(s.x=ae,s.y=ae),this.updateEditorContainer(e,n,t,r,s,l,u))},t.prototype.updateEditorContainer=function(t,n,o,r,a,s,l){var u,c,f;r&&r.preventOverflow?(e.prototype.updateEditorContainer.call(this,t,n,o,r,a,s,l),(u=t.parentNode)&&n&&(c=i.GC$(u),(f=n.width)>0&&c.width(f))):(n&&n.width&&a&&a.width&&(a.width=n.width),n&&n.height&&a&&a.height&&(a.height=n.height),e.prototype.updateEditorContainer.call(this,t,n,o,r,a,s,l))},t.prototype.updateImeMode=function(e,t,n){this.isImeAware()&&e&&l.Context.hp(e,t)},t.prototype.isReservedKey=function(e,t){var n=e.srcElement||e.target,o=e.keyCode,r=e.ctrlKey,i=e.altKey,a=e.metaKey;return!!(n&&t&&t.isEditing&&"gcEditingInput"===n.getAttribute(B))&&(13===o&&(r&&!e.shiftKey||i)||90===o&&r&&!i||89===o&&r&&!i||67===o&&(r||a)&&!i||88===o&&(r||a)&&!i)},t.prototype.isImeAware=function(e){return!0},t.prototype.toJSON=function(){var e,t={},n=this;for(e in n)n.hasOwnProperty(e)&&"_editingElement"!==e&&(t[e]=n[e]);return t},t}(l.Base),t.Text=de,s._o[1]=de},"./dist/core/core.definition.js":function(e,t){},"./dist/core/core.entry.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u;function c(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),n("./dist/core/core.res.en.js"),c(n("./dist/core/core.ns.js")),c(n("./dist/core/core.enum.js")),c(n("./dist/core/util/common.js")),c(n("./dist/core/util/domUtil.js")),n("./dist/core/core.definition.js"),o=n("./dist/core/util/common.js"),Object.defineProperty(t,"getTypeFromString",{set:function(e){o.getTypeFromString=e},get:function(){return o.getTypeFromString}}),a=-1,1===(i=(r=n("./dist/core/lc/releaseLc.js")).Soa)&&(a=Math.floor(5*Math.random()),t["G".concat("C","$")]["s".concat("d")]=a),c(n("./dist/core/util/theme.js")),c(n("./dist/core/util/basedialog.js")),c(n("./dist/core/util/imageLoader.js")),c(n("./dist/core/util/tasks.js")),0===a&&n("./dist/core/lc/lcRegister.js"),c(n("./dist/core/worksheet/stylehelper.js")),1===a&&n("./dist/core/lc/lcRegister.js"),c(n("./dist/core/worksheet/style.js")),2===a&&n("./dist/core/lc/lcRegister.js"),c(n("./dist/core/worksheet/clipboardhelper.js")),3===a&&n("./dist/core/lc/lcRegister.js"),c(n("./dist/core/worksheet/worksheet-model.js")),4===a&&n("./dist/core/lc/lcRegister.js"),c(n("./dist/core/worksheet/worksheet.js")),n("./dist/core/worksheet/worksheet-formatter.js"),c(n("./dist/core/worksheet/worksheet-actions.js")),c(n("./dist/core/worksheet/worksheet-border.js")),n("./dist/core/worksheet/worksheet-edit.js"),c(n("./dist/core/worksheet/worksheet-event.js")),n("./dist/core/worksheet/worksheet-json.js"),c(n("./dist/core/worksheet/worksheet-render.js")),n("./dist/core/worksheet/worksheet-selection.js"),n("./dist/core/worksheet/worksheet-sort.js"),c(n("./dist/core/worksheet/worksheet-ui.js")),c(n("./dist/core/worksheet/worksheet-static.js")),c(n("./dist/core/workbook/workbook.js")),n("./dist/core/workbook/workbook-json.js"),c(n("./dist/core/workbook/sheettabbase.js")),c(n("./dist/core/workbook/sheettab.js")),c(n("./dist/core/workbook/sheettab2007.js")),c(n("./dist/core/workbook/workbookpanelex.js")),s=n("./dist/core/celltype/cellType.entry.js"),t.CellTypes=s,l=n("./dist/core/celltype/headercelltype.js"),Object.defineProperty(s,"Corner",{set:function(e){e!==l.Corner&&(l.Corner=e)},get:function(){return l.Corner}}),Object.defineProperty(s,"ColumnHeader",{set:function(e){e!==l.ColumnHeader&&(l.ColumnHeader=e)},get:function(){return l.ColumnHeader}}),Object.defineProperty(s,"RowHeader",{set:function(e){e!==l.RowHeader&&(l.RowHeader=e)},get:function(){return l.RowHeader}}),u=n("./dist/core/celltype/textcelltype.js"),Object.defineProperty(s,"Text",{set:function(e){e!==u.Text&&(u.Text=e)},get:function(){return u.Text}}),s.vHb=l,s.wHb=u,1!==i&&2!==i||r.Gb(t)},"./dist/core/core.enum.js":function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.pixels=0]="pixels",e[e.continuous=1]="continuous"}(t.ScrollType||(t.ScrollType={})),function(e){e[e.setRowCount=0]="setRowCount",e[e.setColumnCount=1]="setColumnCount",e[e.addRows=2]="addRows",e[e.deleteRows=3]="deleteRows",e[e.addColumns=4]="addColumns",e[e.deleteColumns=5]="deleteColumns",e[e.setRowHeight=6]="setRowHeight",e[e.setColumnWidth=7]="setColumnWidth",e[e.setRowVisible=8]="setRowVisible",e[e.setColumnVisible=9]="setColumnVisible",e[e.filterRows=10]="filterRows",e[e.outlineExpandRows=11]="outlineExpandRows",e[e.outlineExpandColumns=12]="outlineExpandColumns"}(t.AxisInfoChangeType||(t.AxisInfoChangeType={})),function(e){e[e.hide=0]="hide",e[e.show=1]="show",e[e.active=2]="active",e[e.unactive=3]="unactive"}(t.ScrollbarState||(t.ScrollbarState={})),function(e){e[e.none=0]="none",e[e.column=1]="column",e[e.row=2]="row",e[e.both=3]="both"}(t.ShowResizeTip||(t.ShowResizeTip={})),function(e){e[e.skin=0]="skin",e[e.mobile=1]="mobile"}(t.ScrollbarAppearance||(t.ScrollbarAppearance={})),function(e){e[e.none=0]="none",e[e.horizontal=1]="horizontal",e[e.vertical=2]="vertical",e[e.both=3]="both"}(t.ShowScrollTip||(t.ShowScrollTip={})),function(e){e[e.right=0]="right",e[e.down=1]="down"}(t.InsertShiftCell||(t.InsertShiftCell={})),function(e){e[e.normal=0]="normal",e[e.split=1]="split"}(t.ResizeMode||(t.ResizeMode={})),function(e){e[e.noHeaders=0]="noHeaders",e[e.rowHeaders=1]="rowHeaders",e[e.columnHeaders=2]="columnHeaders",e[e.allHeaders=3]="allHeaders"}(t.CopyPasteHeaderOptions||(t.CopyPasteHeaderOptions={})),function(e){e[e.noHeaders=0]="noHeaders",e[e.rowHeaders=1]="rowHeaders",e[e.columnHeaders=2]="columnHeaders",e[e.allHeaders=3]="allHeaders"}(t.HeaderOptions||(t.HeaderOptions={})),function(e){e[e.default=0]="default",e[e.enhanced=1]="enhanced"}(t.ResizeZeroIndicator||(t.ResizeZeroIndicator={})),function(e){e[e.setFormula=0]="setFormula",e[e.copyPaste=1]="copyPaste",e[e.dragFill=2]="dragFill",e[e.dragDrop=3]="dragDrop",e[e.changePartOfArrayFormula=4]="changePartOfArrayFormula",e[e.changeSheetName=5]="changeSheetName"}(t.InvalidOperationType||(t.InvalidOperationType={})),function(e){e[e.cell=0]="cell",e[e.cellWithHeader=1]="cellWithHeader"}(t.AutoFitType||(t.AutoFitType={})),function(e){e[e.all=0]="all",e[e.values=1]="values",e[e.formatting=2]="formatting",e[e.formulas=3]="formulas",e[e.valuesAndFormatting=4]="valuesAndFormatting",e[e.formulasAndFormatting=5]="formulasAndFormatting"}(t.ClipboardPasteOptions||(t.ClipboardPasteOptions={})),function(e){e[e.topLeft=0]="topLeft",e[e.topCenter=1]="topCenter",e[e.topRight=2]="topRight",e[e.bottomLeft=3]="bottomLeft",e[e.bottomCenter=4]="bottomCenter",e[e.bottomRight=5]="bottomRight"}(t.LabelAlignment||(t.LabelAlignment={})),function(e){e[e.visible=0]="visible",e[e.hidden=1]="hidden",e[e.auto=2]="auto"}(t.LabelVisibility||(t.LabelVisibility={})),function(e){e[e.underline=1]="underline",e[e.lineThrough=2]="lineThrough",e[e.overline=4]="overline",e[e.doubleUnderline=8]="doubleUnderline",e[e.none=0]="none"}(t.TextDecorationType||(t.TextDecorationType={})),function(e){e[e.left=0]="left",e[e.center=1]="center",e[e.right=2]="right",e[e.general=3]="general"}(t.HorizontalAlign||(t.HorizontalAlign={})),function(e){e[e.top=0]="top",e[e.center=1]="center",e[e.bottom=2]="bottom"}(t.VerticalAlign||(t.VerticalAlign={})),function(e){e[e.normal=0]="normal",e[e.superscript=1]="superscript",e[e.subscript=2]="subscript"}(t.VertAlign||(t.VertAlign={})),function(e){e[e.smallDecrement=0]="smallDecrement",e[e.smallIncrement=1]="smallIncrement",e[e.largeDecrement=2]="largeDecrement",e[e.largeIncrement=3]="largeIncrement",e[e.thumbPosition=4]="thumbPosition",e[e.thumbTrack=5]="thumbTrack",e[e.endScroll=6]="endScroll"}(t.Nxb||(t.Nxb={})),function(e){e[e.normal=0]="normal",e[e.highlight=1]="highlight",e[e.selected=2]="selected",e[e.active=3]="active",e[e.hover=4]="hover",e[e.activeNotSelected=5]="activeNotSelected"}(t.VisualState||(t.VisualState={})),function(e){e[e.ready=0]="ready",e[e.enter=1]="enter",e[e.edit=2]="edit"}(t.EditorStatus||(t.EditorStatus={})),function(e){e[e.auto=1]="auto",e[e.active=2]="active",e[e.inactive=4]="inactive",e[e.disabled=0]="disabled"}(t.ImeMode||(t.ImeMode={})),function(e){e[e.single=0]="single",e[e.range=1]="range",e[e.multiRange=2]="multiRange"}(t.SelectionPolicy||(t.SelectionPolicy={})),function(e){e[e.cell=0]="cell",e[e.row=1]="row",e[e.column=2]="column"}(t.SelectionUnit||(t.SelectionUnit={})),function(e){e[e.data=1]="data",e[e.style=2]="style",e[e.comment=4]="comment",e[e.tag=8]="tag",e[e.sparkline=16]="sparkline",e[e.axis=32]="axis",e[e.bindingPath=64]="bindingPath",e[e.hyperlink=256]="hyperlink"}(t.StorageType||(t.StorageType={})),function(e){e[e.blank=0]="blank",e[e.numbers=1]="numbers",e[e.letters=2]="letters"}(t.HeaderAutoText||(t.HeaderAutoText={})),function(e){e[e.dragDrop=0]="dragDrop",e[e.dragFill=1]="dragFill",e[e.clear=2]="clear",e[e.paste=3]="paste",e[e.sort=4]="sort",e[e.setArrayFormula=5]="setArrayFormula",e[e.evaluateFormula=6]="evaluateFormula"}(t.RangeChangedAction||(t.RangeChangedAction={})),function(e){e[e.normal=0]="normal",e[e.richText=1]="richText"}(t.ValueType||(t.ValueType={})),function(e){e[e.stretch=0]="stretch",e[e.center=1]="center",e[e.zoom=2]="zoom",e[e.none=3]="none"}(t.ImageLayout||(t.ImageLayout={})),function(e){e.ThumbButton="thumbButton",e.TrackButton="trackButton",e.LeftButton="leftButton",e.RightButton="rightButton",e.UpButton="upButton",e.DownButton="downButton"}(t.Oxb||(t.Oxb={})),function(e){e[e.left=0]="left",e[e.center=1]="center",e[e.right=2]="right",e[e.nearest=3]="nearest"}(t.HorizontalPosition||(t.HorizontalPosition={})),function(e){e[e.top=0]="top",e[e.center=1]="center",e[e.bottom=2]="bottom",e[e.nearest=3]="nearest"}(t.VerticalPosition||(t.VerticalPosition={})),function(e){e[e.corner=0]="corner",e[e.colHeader=1]="colHeader",e[e.rowHeader=2]="rowHeader",e[e.viewport=3]="viewport"}(t.SheetArea||(t.SheetArea={})),function(e){e[e.none=0]="none",e[e.ascending=1]="ascending",e[e.descending=2]="descending"}(t.SortState||(t.SortState={})),function(e){e[e.hover=1]="hover",e[e.invalid=2]="invalid",e[e.readonly=4]="readonly",e[e.edit=8]="edit",e[e.active=16]="active",e[e.selected=32]="selected",e[e.dirty=64]="dirty"}(t.CellStatesType||(t.CellStatesType={})),function(e){e[e.always=0]="always",e[e.onSelected=1]="onSelected",e[e.onEditing=2]="onEditing"}(t.ButtonVisibility||(t.ButtonVisibility={})),function(e){e[e.none=0]="none",e[e.custom=1]="custom",e[e.clear=2]="clear",e[e.cancel=3]="cancel",e[e.ok=4]="ok",e[e.dropdown=5]="dropdown",e[e.ellipsis=6]="ellipsis",e[e.left=7]="left",e[e.right=8]="right",e[e.plus=9]="plus",e[e.minus=10]="minus",e[e.undo=11]="undo",e[e.redo=12]="redo",e[e.search=13]="search",e[e.separator=14]="separator",e[e.spinLeft=15]="spinLeft",e[e.spinRight=16]="spinRight",e[e.collapse=17]="collapse",e[e.expand=18]="expand"}(o=t.ButtonImageType||(t.ButtonImageType={})),o.calcel=o.cancel,function(e){e[e.colorPicker=0]="colorPicker",e[e.dateTimePicker=1]="dateTimePicker",e[e.timePicker=2]="timePicker",e[e.monthPicker=3]="monthPicker",e[e.list=4]="list",e[e.slider=5]="slider",e[e.calculator=6]="calculator",e[e.workflowList=7]="workflowList",e[e.multiColumn=8]="multiColumn"}(t.DropDownType||(t.DropDownType={})),function(e){e[e.left=0]="left",e[e.right=1]="right",e[e.leftOfText=2]="leftOfText",e[e.rightOfText=3]="rightOfText"}(t.ButtonPosition||(t.ButtonPosition={})),function(e){e[e.left=0]="left",e[e.right=1]="right"}(t.CaptionAlignment||(t.CaptionAlignment={})),function(e){e[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical"}(t.LayoutDirection||(t.LayoutDirection={})),function(e){e[e.inline=0]="inline",e[e.popup=1]="popup",e[e.tree=2]="tree"}(t.LayoutDisplayAs||(t.LayoutDisplayAs={})),function(e){e[e.year=1]="year",e[e.month=2]="month",e[e.day=3]="day"}(t.CalendarPage||(t.CalendarPage={})),function(e){e[e.monday=1]="monday",e[e.tuesday=2]="tuesday",e[e.wednesday=3]="wednesday",e[e.thursday=4]="thursday",e[e.friday=5]="friday",e[e.saturday=6]="saturday",e[e.sunday=7]="sunday"}(t.CalendarStartDay||(t.CalendarStartDay={})),function(e){e[e.none=0]="none",e[e.group=1]="group",e[e.child=2]="child",e[e.full=3]="full"}(t.GroupSort||(t.GroupSort={})),function(e){e[e.string=0]="string",e[e.array=1]="array"}(t.DropdownListValue||(t.DropdownListValue={})),function(e){e[e.solid=1]="solid",e[e.darkGray=2]="darkGray",e[e.mediumGray=3]="mediumGray",e[e.lightGray=4]="lightGray",e[e.gray125=5]="gray125",e[e.gray0625=6]="gray0625",e[e.darkHorizontal=7]="darkHorizontal",e[e.darkVertical=8]="darkVertical",e[e.darkDown=9]="darkDown",e[e.darkUp=10]="darkUp",e[e.darkGrid=11]="darkGrid",e[e.darkTrellis=12]="darkTrellis",e[e.lightHorizontal=13]="lightHorizontal",e[e.lightVertical=14]="lightVertical",e[e.lightDown=15]="lightDown",e[e.lightUp=16]="lightUp",e[e.lightGrid=17]="lightGrid",e[e.lightTrellis=18]="lightTrellis"}(t.PatternType||(t.PatternType={})),function(e){e[e.mask=0]="mask",e[e.overflow=1]="overflow"}(t.NumbersFitMode||(t.NumbersFitMode={}))},"./dist/core/core.ns.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("./dist/core/core.res.en.js");t.SR={en:o}},"./dist/core/core.res.en.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_NotSupported="NotSupportException",t.Exp_PasteExtentIsNull="pasteExtent is null",t.Exp_InvalidPastedArea="The pasted area should have the same size as the copy or cut area.",t.Exp_MultipleSelections="This action won't work on multiple selections.",t.Exp_ChangePartOfArray="Cannot change part of an array.",t.Exp_InvalidAndSpace="Invalid {0}: {1} (must be between {2} and {3}).",t.Exp_SrcIsNull="The argument 'src' is null",t.Exp_DestIsNull="The argument 'dest' is null",t.Exp_InvalidCustomFunction="invalid custom function",t.Exp_InvalidCustomName="invalid custom name",t.Exp_IndexOutOfRange="Index is out of range!",t.Exp_InvalidRange="Invalid range",t.Exp_ArgumentOutOfRange="ArgumentOutOfRange",t.Exp_PasteSourceCellsLocked="Source sheet's cells are locked.",t.Exp_InvalidCopyPasteSize="The copy and paste areas are not the same size.",t.Exp_PasteDestinationCellsLocked="The cell you are trying to change is protected and therefore read-only.",t.Exp_PasteChangeMergeCell="Cannot change part of a merged cell.",t.Tip_Row="Row: ",t.Tip_Column="Column: ",t.Tip_Height="Height: {0} pixels",t.Tip_Width="Width: {0} pixels",t.NewTab="New...",t.Exp_EmptyNamedStyle="The name of named style cannot be empty or null",t.Exp_SheetNameInvalid="The sheet name can not be blank or contains these characters : *, :, [, ], ?, \\, /",t.Exp_ArrayFormulaSpan="Array formulas are not valid in merged cells.",t.Exp_DestSheetIsNull="destSheet is null",t.Exp_SheetIsNull="sheet is null.",t.Exp_OverlappingSpans="This operation will cause overlapping spans.",t.NeedCanvasSupport="You need a browser which full supports HTML5 Canvas to run SpreadJS",t.ARIA_Resize="resize",t.ARIA_First="first",t.ARIA_PreviousArrow="previous arrow",t.ARIA_NextArrow="next arrow",t.ARIA_Last="last",t.ARIA_PreviousButton="previous button",t.ARIA_NextButton="next button",t.ARIA_SheetTab="sheet tab",t.ARIA_NewSheet="new sheet",t.ARIA_Blank="blank",t.ARIA_Scrollbar_Left_Button="scrollbar left button",t.ARIA_Scrollbar_Top_Button="scrollbar top button",t.ARIA_Scrollbar_Thumb_Button="scrollbar thumb button",t.ARIA_Scrollbar_Right_Button="scrollbar right button",t.ARIA_Scrollbar_Bottom_Button="scrollbar bottom button",t.ARIA_Scrollbar_TRACK_Button="scrollbar track button",t.ARIA_Cell="cell",t.ARIA_HasValue="has value {0}",t.ARIA_RowHeader="row header",t.ARIA_ColumnHeader="column header",t.SHEET_NAME="Sheet",t.lsru=["","6465706c6f796d656e74"],t.lsde=["","64657369676e6572"],t.ls1=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f752063616e206f6e6c79206465706c6f792074686973204556414c554154494f4e2076657273696f6e206c6f63616c6c792e0d0a54656d706f72617279207b317d206b6579732061726520617661696c61626c6520666f722074657374696e672e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d2e"],t.ls2=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b6579206578706972657320696e207b307d206461792873292e"],t.ls3=["","4c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561644a532e0d0a54656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e0d0a496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e6365206f7220726571756573742061206b6579206174206763676f2e746f2f736a736b65792e"],t.ls4=["","496e76616c6964206c6963656e7365206b65792e20456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e6565642068656c702e"],t.ls5=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b65792068617320657870697265642e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20666f722068656c702e"],t.ls6=["","506f776572656420627920477261706543697479205370726561644a53204576616c756174696f6e2056657273696f6e0d0a4e6f74204c6963656e73656420666f7220446973747269627574696f6e"],t.Exp_InsertCopiedCutCells="This selection is not valid. The copy/paste area must be the same size",t.Exp_InsertCopiedCutCellsOnSpanTable="This wont work because it would move cells in a table on your worksheet or will cause some merged cells to unmerge.",t.Exp_InsertCopiedCutCellsNoRange="New cells can not be inserted as there are non-empty cells that would extend beyond the worksheet.",t.Exp_InvalidSortArrayFormulaInRange="Can't sort current range as array formula exist.",t.Exp_InvalidSortSpanInRange="Can't sort current range as span exist.",t.Exp_InvalidSortPartTableOrMultiTableInRange="Can't sort current range as part table or more than one table exist."},"./dist/core/lc/common.js":function(e,t,n){"use strict";(function(e){var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T;function N(){return T}function I(e,t){var n,o,r,i,a="",s=0;for(n=0;n<e.length;n++)s=Math.max(s,e[n].length);for(n=0;n<s;n++){for(t&&(o=""),i=0;i<e.length;i++)t?o+=n>=e[i].length?"00":e[i].charAt(n)+e[i].charAt(n+1):n<e[i].length&&(a+=e[i].charAt(n));t&&(r=parseInt(o,16),a+=String.fromCharCode(r),n++)}return a}function R(e,t,n){var o,r=I(["Lcnee","iesKy"]),i=N()[r];return u(i,{pK:"l6/zrbWoSbcLFwEetFh38rH3ErBZE9H+Cqix3R+wTlfA1wD5B+lUcCQn+EJ60I4RGrm0x1sFjkiLWwB0jAn6BWZv0W4WbqAKriOdeoivxDp1Wmjs3qkEDhvbsjPtfvwx2BHil6o+/tDrdMJQSGs18WZm2PoQLQuL+9VhZ4FNRHUQU3Jtioke/OZEGHJOdYVwvCGalzBad6QFOiVbDBQPePpS3++GJzOxN8SN/7lyS5/IdKiy3WJRaVGkB370+HbN6hKraDfUgReLX26yxRaKC/5aWnGAJ2NnWLoGyAGRcwT9dVjo4bcAZNrrA0U9JVKQxaSskhdv2p49XzJkltXx5w==",aC:"B0"},(function(r){(o=k(r,"VIEE")).hl=!!i,o.m=i?o.m:-1,t.call(e,o),D(o,e,i,n)}),(function(){(o=k()).hl=!!i,o.m=i?o.m:-1,t.call(e,o),D(o,e,i,n)})),o}function k(e,t){var n,o,r,i,a={isVd:function(e){var t=this;return e=1===N().Workbook.lm||e,t.s&&!t.e&&(!t.adr||!!t.adr.dsr==!!e)}},s=function(){var e=c(M);return function(e){var t=c("VdgJHc#wJb59"),n=c("Zdg3Ga#UHbw5");return e&&(function(e){var t=c("MlSZto#Z");return e&&e===t}(e[t])||function(e){var t=c("yXbog&w");return e&&e===t}(e[t])||function(e){var t=c("4LJITMx8UMcA"),n=c("jOxo"),o=c("JYw3Gb4NOb6x"),r=c("g1Jbww#Y"),i=RegExp("^[\\w\\-]+\\."+r+"$","i");return e&&(e===t||e===n||e===o||d.test(e)||i.test(e))}(e[n]))}(p[e])}();return a.b=s,a.s=function(){var a,l,u,c,f,h,p;if(!e)return!1;if(!(a=e[y])||!a.length)return!1;for(c=0,f=a.length;c<f;c++)if(u=(l=a[c])&&l[b]===t){n=l[v];break}if(!u)return!1;if(e[A]&&(i=e[A]),e[x]){if(h=new Date,p=function(e){return new Date(E(e.substr(0,4))||0,E(e.substr(4,2))-1||0,E(e.substr(6,2))||0)}(e[x]),r=Math.ceil((p-h)/864e5),o=r<=0)return!1}else r=void 0;return!!(s||!e[C]&&!e[w]||j(e[C],e[w])||_(e[C],e[w]))}(),a.m=e?e[m]?-1:1:0,a.n=n,a.e=o,o||(a.d=r),a.adr=i,a}function E(e){return parseInt(e,10)}function D(e,t,n,o){O(e)?o||t.repaint&&!t.Js&&t.repaint():F(t,e)}function j(e,t){var n,o,r,i;return!!(function(){var e=c(M),t=c("VdgJHc#wJb59"),n=c("Udg36Y#oUddV"),o=p[e];return o&&o[t]===n}()&&(n=c(M),o=c("1agFGc#UHbw5"),r=p[n]&&p[n][o],r&&(r=r.toLowerCase(),i=e.split(","),e&&function(e,t){var n,o,r,i;if(!e||0!==e.indexOf("//"))return!1;if((n=e.slice(2).split("/")).length<1)return!1;for(o=n[0],r=0,i=t.length;r<i;r++)if(t[r]===o)return!0;return!1}(r,i))))}function _(e,t){var n,o=c(M),r=c("Zdg3Ga#UHbw5"),i=p[o]&&p[o][r];return!i||(i=i.toLowerCase(),n=e.split(","),!(!e||!function(e,t){var n,o,r,i,a;for(n=0,o=t.length;n<o;n++){if(i=!1,(r=t[n])&&0===r.lastIndexOf("*.",0)&&(i=!0),(r=i?r.slice(2):r)===e)return!0;if(i&&((a=e.indexOf("."+r))>0&&a===e.length-r.length-1))return!0}return!1}(i,n))||!(!e||!function(e,t){var n,o,r,i;if(e&&4===e.split(".").length)for(n=0,o=t.length;n<o;n++)if((r=t[n])&&((i=r.length-2)>0&&(r===e||".*"===r.substr(i)&&e.substr(0,i)===r.substr(0,i)&&g.test(e))))return!0;return!1}(i,n)))}function O(e){return e&&(e.isVd(!1)||e.b&&!e.hl)}function F(e,t){var n,o;function r(){o.width=i.GC$(n).width(),o.height=i.GC$(n).height(),function(e,t,n,o){var r,i,a,l,u;if(!o||!o.isVd(!1))for(r=o.hl?o.adr&&o.adr.dsr?"l4":o.e?"l5":"l4":"l3",i=H(r,S,o),s(e,"16pt calibri"),e.fillStyle="black",e.fillRect(0,0,t,n),e.fillStyle="white",20,a=30,l=0;l<i.length;l++)u=i[l],e.fillText(u,20,a),a+=25}(o.getContext("2d"),o.width,o.height,t)}e.XIc||(e.XIc=!0,n=e._host,e.sheets=[],e.no(),n&&(o=document.createElement("canvas"),n.appendChild(o),r(),i.GC$(window).bind("resize",(function(){setTimeout(r,100)}))))}function P(e){return new o.Common.ResourceManager(r.SR).getResource()[e]}function H(e,t,n){var o,r,i,a=P(I([e,"s"])),s=P(1===N().Workbook.lm?I(["ld","se"]):I(["lr","su"])),l=B(a,t);for(s=B(s,t),l=(l=l.replace("{0}",n.d)).replace("{1}",s).replace("{1}",s),o=[],r=0,i=0;i<l.length;i++)"\r"!==l[i]&&"\n"!==l[i]||(o.push(l.substring(r,i)),"\r"===l[i]&&i<l.length-1&&"\n"===l[i+1]&&i++,r=i+1);return r<l.length&&o.push(l.substring(r,l.length)),o}function B(e,t){var n,o,r,i=!0,a="";if(e)if("string"==typeof e)(e=e.trim())&&(n=[e]);else if(Array.isArray(e)){for(o=!0,n=[],r=0;r<e.length;r++)a=e[r].trim(),n.push(a),o&&a&&(o=!1);o&&(n=null)}return n||(i=!1,n=t),I(n,i)}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("./dist/core/core.ns.js"),i=n("./dist/core/util/domUtil.js"),a=n("./dist/core/util/common.js"),s=a.Ul.lZa,l=n("./dist/core/lc/lcValidator.js"),u=l.VIc,c=l.WIc,f="object"==typeof e&&e&&e.Object===Object&&e,h="object"==typeof self&&self&&self.Object===Object&&self,p=f||h||Function("return this")(),d=/^[\w\-]+$/i,g=/^[0-9.]+$/,m=c("XRsZ"),y=c("HUkJ"),v=c("T&g"),b=c("Q&w"),C=c("GRz1"),w=c("XSzB"),x=c("XRwh"),A=c("WQs5"),M="JYx3Gb#8Pb5R",S=["Ivldlcneky mi pedslsgaeiycmi o edassac.","nai ies e.Ealsra.ae@rpct.o fyune sitne"],t.VIc=R,t.Gb=function(e,t){var n,o,r,i,a,s,l,u;T=t,o=t.Workbook.prototype,r=o.ad,o.ad=function(){var e=this;if(R(e,(function(t){e.ls=t,n=t,e.ul=function(){R(e,(function(t){e.ls=t,n=t}))}})),!n||O(n))return r.apply(e,arguments)},i=t.Worksheet.prototype,a=i.ad,i.ad=function(){if(n||this.parent||R(this,(function(e){n=e})),!n||O(n))return a.apply(this,arguments)},s=t.oJ.prototype,l=s.Pw,s.Pw=function(t,o){l.apply(this,arguments),n&&(-1===n.m||!n.hl&&n.b)&&e(this.kj,t,o,n)},u=s.RI,s.RI=function(t,o){u.apply(this,arguments),n&&(-1===n.m||!n.hl&&n.b)&&e(this.kj,t,o,n)}},t.Hhc=F,t.e6=H,t.YIc=function(e){return P(I([e,"sa"]))}}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./dist/core/lc/lcRegister.js":function(e,t,n){"use strict";var o,r,i,a,s;function l(){if(s=null,a[0])try{var e=a[0].tc;e&&e._host&&o.VIc(e,(function(t){var n,r=e.getActiveSheet();r&&((n=r.l)&&(t=n),n||t.b||-1!==t.m||!t.d||(t.s=!1,o.Hhc(e,t)))}),!0)}finally{a=[]}}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/lc/releaseLc.js"),i=(r=n("./dist/core/util/domUtil.js")).GC$.sd,a=[],r.GC$[i]=function(e){a.push(e),s||(s=setTimeout(l,5e3*Math.random()+3e3))}},"./dist/core/lc/lcValidator.js":function(e,t){var n=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}return n.m=e,n.c=t,n.p="dist",n(0)}([function(e,t){(function(e){"use strict";var n,o,r,i,a,s,l,u;function c(e,t,n,o){return 1==e.length||e.splice(n,1,o(e.splice(t,1,o(e[n]))[0])),e}function f(e){var t,n=e.split(""),o=function(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e.charCodeAt(0);return n>=65&&n<=90?e.toLowerCase():n>=97&&n<=122?e.toUpperCase():n>=48&&n<=57?r(48+(n-48+10+t)%10):e}(e,-1)};for(t=n.length-5;t>=0;t--)c(n,t+1,t+3,o),c(n,t,t+2,o);return n.join("")}function h(e){var t,n,o,r,i,s,l=[],u="",c=a,f=e,h=f.length%3;if(h>0)for(;h++<3;)u+="=",f+="\0";for(h=0;h<f.length;h+=3)n=(t=f.charCodeAt(h)<<16|f.charCodeAt(h+1)<<8|f.charCodeAt(h+2))>>18&63,o=t>>12&63,r=t>>6&63,i=63&t,l[h/3]=c.charAt(n)+c.charAt(o)+c.charAt(r)+c.charAt(i);return(s=l.join("")).slice(0,s.length-u.length)+u}function p(e){var t,n,o,i,s,l,u,c=[],f=a,h=e;for(u=0;u<h.length;u+=4)t=(l=f.indexOf(h.charAt(u))<<18|f.indexOf(h.charAt(u+1))<<12|(i=f.indexOf(h.charAt(u+2)))<<6|(s=f.indexOf(h.charAt(u+3))))>>>16&255,n=l>>>8&255,o=255&l,c[u/4]=r(t,n,o),64==s&&(c[u/4]=r(t,n)),64==i&&(c[u/4]=r(t));return c.join("")}function d(e){return(o&&window.atob||p)(e)}function g(e){return(o&&window.btoa||h)(e)}function m(e){return g(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return r(parseInt(t,16))})))}function y(e){var t,n;return e?(t=function(e){return e.split("").reverse().join("")}(t=f(e)),n=Math.ceil(t.length/2),function(e){return decodeURIComponent(Array.prototype.map.call(d(e),(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}(t=(t=(t=t.substr(n)+t.substr(0,n)).replace("#","=")).replace("&","=="))):""}function v(e){var t,n=d(e),o=n.length,r=new i(o);for(t=0;t<o;t++)r[t]=n.charCodeAt(t);return r.buffer}function b(e){var t,n,o=new ArrayBuffer(e.length),r=new i(o);for(t=0,n=e.length;t<n;t++)r[t]=e.charCodeAt(t);return o}function C(e){return r.apply(null,new i(e))}function w(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"")}function x(e){return"oncomplete"in e&&(e.then=function(t,n){e.resolve=t,e.reject=n},e.oncomplete=function(t){e.resolve(e.result)},e.onerror=function(){e.reject()}),e}Object.defineProperty(t,"__esModule",{value:!0}),n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o="undefined"!=typeof window,r=String.fromCharCode,i=o&&window.Uint8Array||function(e){var t,o;if("number"==typeof e)for(t=Array(e),o=0;o<e;++o)t[o]=0;else t=e.slice(0);return t.buffer=t,t.byteLength=t.length,"object"===(void 0===e?"undefined":n(e))&&e.buffer&&(t.buffer=e.buffer),t},a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="object"==(void 0===e?"undefined":n(e))&&e&&e.Object===Object&&e,l="object"==("undefined"==typeof self?"undefined":n(self))&&self&&self.Object===Object&&self,u=s||l||Function("return this")(),t.iDe=y,t.attorn=function(e,t,n,r){var i,a,s,l,c,f,h,p=o?window.msCrypto?window.msCrypto:window.crypto:void 0,d=function(e,t){try{t="#"+t;var n=e.indexOf(t);if(n>-1)return{prefix:e.substring(0,n),licData:JSON.parse(y(e.substr(n+t.length)))}}catch(e){}return!1}(e,t.aC);if(!d)return r();function g(){return function(e){var t,n,o,r=0,i=5381,a=0;for(t=e.length-1;t>=0;t--)r=(n=e.charCodeAt(t))+(r<<6)+(r<<16)-r,i=n+((i<<5)+i),a=n+((a<<5)-a),a&=a;return(o=r^i^a)<0&&(o=~o),o.toString(16).toUpperCase()}(a+JSON.stringify(i.D))===i.H?n(i.D):r()}return i=d.licData,a=d.prefix+"#"+t.aC,s=C(v(m(a+JSON.stringify(i.D)))),l=y("JYx3Gb#8Pb5R"),c=y("VdgJHc#wJb59"),u[l]&&u[l][c]&&!location.protocol.match(/^https/i)?g():p&&p.subtle?(f={alg:"RS256",e:"AQAB",kty:"RSA",n:w(t.pK)},f=window.msCrypto?b(JSON.stringify(f)):f,h={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},void x(p.subtle.importKey("jwk",f,h,!1,["verify"])).then((function(e){x(p.subtle.verify(h,e,v(i.S),b(s))).then((function(e){return e?n(i.D):r()}))}),(function(){return g()}))):g()}}).call(t,function(){return this}())}]);e.exports={VIc:n.attorn,WIc:n.iDe}},"./dist/core/lc/releaseLc.js":function(e,t,n){"use strict";var o,r,i,a,s;function l(e,t,n,r){var l,u,c,f,h,p,d,g,m=e.am(),y=e.parent,v="11pt calibri",b=r.hl&&r.isVd(!1)&&r.d,C=y&&y.jDc,w="";for(b?l="l2":r.e?l="l5":r.hl&&!r.d?l="l6":(l="l1",u=o.YIc(l)),m=m||e.am(),c=o.e6(l,a,r),f=0,u&&c.forEach((function(t){f=s(f,e.dp(t,v))})),e.l=c[0]?r:void 0,h=0;h<c.length&&(m.width>203||m.height>203)&&!C;h++)w=c[h],p=f||e.dp(w,v),10,20,d=m.width-p-10,g=m.height-10-20*(c.length-h),n&&!n.intersect(d,g,p,20)||(t.save(),t.fillStyle="rgba(0, 0, 0, 0.5)",i(t,v),n&&(t.rect(n.x,n.y,n.width,n.height),t.clip(),t.beginPath()),t.fillText(w,d,g+20),w&&(e.l=r),t.restore())}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/lc/common.js"),r=n("./dist/core/util/common.js"),i=r.Ul.lZa,a=["LcneNtFud\no edavldlcnekyt u pedSet.\neprr esaeaalbefreauto.\nfyuprhsdalcne orkyi nyu ucaecnimto mi.\nmi sslsgaeiycmi o edassac.","ies o on\rYune  ai ies e ornSra.hes\rTmoayky r vial o vlain\rI o ucae  ies,yu e si orprhs ofraineal\rEalu.ae@rpct.o fyune sitne"],s=Math.max,t.Gb=function(e){o.Gb(l,e)},t.Soa=1,t.VIc=o.VIc,t.Hhc=o.Hhc},"./dist/core/util/basedialog.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h;Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/util/common.js"),r=n("./dist/core/util/domUtil.js"),i=r.GC$,a=o.util.Nl,s=o.util.Ml,l=o.util.nl,u=document,c=window,f=c.Yl,h=function(){function e(e,t,n){this.c4="gc-popup",this.so="gc-overlay",this.AWa=null;var o=this;o._host=e,o.zWa=n,t=t||0,o.to={position:"fixed",width:"100%",height:"100%",margin:0,padding:0,top:0,left:0,border:"none",zIndex:t,backgroundColor:"rgba(0,0,0,0)"},o.uo={position:"absolute",padding:0,margin:0,height:"auto",zIndex:t+1,outline:"none"},o.ad()}return e.prototype.ad=function(){var e=this;e.vo(e.Cj)?e.xo=i("#"+e.Cj):(e.Cj=e.wo(),e.xo=i(a("div")).addClass(e.c4+" ui-widget").attr({id:e.Cj,tabIndex:-1}).css(e.uo))},e.prototype.wo=function(){for(var e=0,t="gc-dialog";this.vo(t+""+e);)e++;return t+""+e},e.prototype.yo=function(){if(this.xo)return this.xo},e.prototype.zo=function(){return this._host?this._host:u.body},e.prototype.Ao=function(e){var t=this,n=t.xo;t.Bo()||t.Co(),f.Gm(),t.vo(t.Cj)||(i(t.zo()).append(n),t.Do(),n.css("display","none")),n.show(e)},e.prototype.close=function(){var e=this;e.vo(e.Cj)&&e.xo.remove(),i("."+e.c4).isVisible()||e.Eo(),f.Hm()},e.prototype.Eo=function(){i("."+this.so).remove(),this.AWa=null},e.prototype.Do=function(){var e,t,n,o,r,a,s,l,c,f,h,p=this.xo,d=this.zo();0!==p.length&&(e=i(d).offset(),t=parseInt(p.css("left"),10)+e.left,n=parseInt(p.css("top"),10)+e.top,o=p.width(),r=p.height(),isNaN(t)||isNaN(n)||isNaN(o)||isNaN(r)||(a=0,s=0,c=(l=u.documentElement).clientWidth,f=l.clientHeight,(h=p[0].getBoundingClientRect()).left+o>c&&(s=h.left+o-c),h.top+r>f&&(a=h.top+r-f),(t<0||n<0||a>0||s>0)&&((t-=s)<0&&(t=0),(n-=a)<0&&(n=0),p.css({left:t-e.left+"px",top:n-e.top+"px"}))))},e.prototype.vo=function(e){return i("#"+e).length>0},e.prototype.Co=function(){var e,t,n=this,o=i(a("div")).addClass(n.so),r=n.xo;this.AWa=o,o.css(n.to),i(n._host).append(o),(e=s&&s.mozilla)&&(t=(new Date).valueOf()),o.bind("mousedown",(function(o){if(!n.zWa){if(e)if((new Date).valueOf()-t<100)return;n.close(),e&&n.Fo&&clearTimeout(n.Fo)}l(o)})),o.bind("contextmenu",(function(e){n.zWa&&l(e)})),r.bind("contextmenu",(function(e){l(e)})),"touchstart MSPointerDown pointerdown".split(" ").forEach((function(t){o.bind(t,(function(t){n.zWa||(e?n.Fo=c.setTimeout((function(){n.close()}),100):n.close()),l(t)}))}))},e.prototype.Bo=function(){return i("."+this.so).length>0},e}(),t.Go=h},"./dist/core/util/common.js":function(e,t,n){"use strict";var o,r,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te;function ne(e){return void 0!==e}function oe(e){return y.createElement(e)}function re(e){y.body&&y.body.insertBefore(e,w)}function ie(e){return e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.cancelBubble=!1,e.returnValue=!1),!1}function ae(e){var t,n,o=!1;if(e)for(t=0;t<e.length;t++)if((n=e.charCodeAt(t))>=11904&&n<12032||n>=12288&&n<40960||n>=43360&&n<43392||n>=63744&&n<64256){o=!0;break}return o}function se(e,t){var n=oe("span");return n.className=e,t&&(n.id=t),n.style.display="none",re(n),n}function le(e,t,n,o){e.addEventListener(t,n,o)}function ue(e){var t=e.currentStyle,n=y.defaultView;return n&&n.getComputedStyle&&(t=n.getComputedStyle(e,"")),t}function ce(e){var t,n,o,r,i,a,s=m.Yl;s.jm>0||(16!==e.keyCode&&(s.XCb=!0),(n=(t=B.Xl())&&t.lm)&&l(n).isVisible()||t&&t._eventHandler&&t._eventHandler.nm&&(t._eventHandler.nm(e),t.isEditing()||(o=e.keyCode,r=e.ctrlKey,i=e.altKey,a=e.shiftKey,90!==o&&89!==o||!r||i?86!==o||!r||i||a||e.stopPropagation&&e.stopPropagation():ie(e))))}function fe(e){var t,n=m.Yl;n.jm>0||(n.XCb=!1,(t=B.Xl())&&t._eventHandler&&t._eventHandler.om&&t._eventHandler.om(e))}function he(e){var t;m.Yl.jm>0||(t=B.Xl())&&t._eventHandler&&t._eventHandler.pm&&t._eventHandler.pm(e)}function pe(e){var t,n=m.Yl;n.jm>0||!0!==n.XCb&&((t=B.Xl())&&t._eventHandler&&t._eventHandler.pm&&t._eventHandler.pm(e))}function de(e){return y.all===C&&B.Xl()&&ie(e),!1}function ge(e,t){var n=M(e.row,t.row),o=M(e.col,t.col),r=S(e.row+e.rowCount-1,t.row+t.rowCount-1),i=S(e.col+e.colCount-1,t.col+t.colCount-1);return n>=0&&o>=0?new U(n,o,r-n+1,i-o+1):n>=0?new U(n,-1,r-n+1,-1):o>=0?new U(-1,o,-1,i-o+1):new U(-1,-1,-1,-1)}function me(e){var t=e.An||{scaleX:1,scaleY:1,translateX:0,translateY:0,skewX:0,skewY:0,orgTranslateX:0,orgTranslateY:0};return e.An=t,t}function ye(e,t){e&&(e.Gn=t)}function ve(e,t){e&&(e.Hn=t)}function be(){return X.Yn||(X.Yn=oe("canvas").getContext("2d")),X.Yn}function Ce(e){var t,n,o,r=[],i=0;for(t=0;t<e.length;t++)r[i]===C&&(r[i]=""),n=e.charAt(t),o="",t+1<e.length&&(o=e.charAt(t+1))," "===n&&" "!==o||"-"===n&&"-"!==o?(r[i]+=n,i++):r[i]+=n;return r}function we(e){for(var t=e.length-1;" "===e.charAt(t);)t--;return t!==e.length-1&&(e=e.substring(0,t+1)),e}function xe(e){var t,n=e instanceof Array?[]:{};for(t in e)e.hasOwnProperty(t)&&(n[t]="object"==typeof e[t]&&e[t]!==w?xe(e[t]):e[t]);return n}function Ae(e,t,n,o,r){var i,a,s,l,u,c,f,h,p=[],d=r||be();if(!d)return p;for(n?(s=e.length*o,a=A(t/o)):(i=(s=H(d,d.font,e))/e.length,a=A(t/i));s>t&&e;)for(l=!1,u=a;;){if(e.length<u){p.push(e),e="";break}if(c=e.substring(0,u),f=n?u*o:H(d,d.font,c),"-"===c.charAt(c.length-1)&&(f=n?u*o:H(d,d.font,c)-H(d,d.font,"-")),f===t||l&&f<t){p.push(c),e=e.substring(u),s-=f;break}if(f>t){if(1===c.length){e.substring(c.length).trim()?(p.push(c),e=e.substring(u),s-=f):(p.push(e),e="");break}u-=1,l=!0}else u+=h=(h=n?(t-f)/o:(t-f)/i)>=1?h:1}return e&&-1===e.search(/^[ ]*$/)&&p.push(e),p}function Me(e,t,n,o,r,i){var a,s,l,u,c,f,h,p,d,g,m=i||be();if(!m)return[e];for(a=[],s=0,l=t,u=[],c=0;c<e.length;c++)if(f=e[c].style&&e[c].style.font||r,h=P.fp(f),e[c].text&&e[c].text.length>0?s+=o?h*e[c].text.length:H(m,f,e[c].text):s=0,s<l)u.push(e[c]);else for(s-=o?h*e[c].text.length:H(m,f,e[c].text),p=0;p<e[c].text.length;p++){if((d=o?h:H(m,f,e[c].text.charAt(p)))>n&&0===p){u.length>0&&(a.push(u),u=[]),u.push({style:e[c].style,text:e[c].text.substring(0,1)}),a.push(u),u=[],(g=e[c].text.substring(1,e[c].text.length)).length&&e.splice(c+1,0,{style:e[c].style,text:g}),s=0,l=n;break}if((s+=d)>l){u.push({style:e[c].style,text:e[c].text.substring(0,p)}),a.push(u),u=[],(g=e[c].text.substring(p,e[c].text.length)).length&&e.splice(c+1,0,{style:e[c].style,text:g}),s=0,l=n;break}}return u.length>0&&a.push(u),a}function Se(e,t,n,o,r){var i,a,s,l,u,c,f,h,p,d,g,m,y,v,b=[],C=Ce(e),w=r||be();if(!w)return b;for(i=H(w,w.font,e),a=n?o:i/e.length,s=N(t/a+"",10),l=0,u=0,c=0,f=0,h=[],p=!1;f<C.length;){if(!1===p){if(d=C[f],h.push(d),(u+=d.length)<s&&f<C.length-1){f++;continue}c=u,u=0}if(g=n?h.join("").length*o:X.Xn(h.join(""),w.font,!0,w),"-"===h.join("").charAt(h.join("").length-1)&&(g=n?h.join("").length*o:H(w,w.font,h.join(""))-H(w,w.font,"-")),g>t)if(m=h.pop(),0===h.length){for(y=Ae(m,t,n,o,w),v=0;v<y.length-1;v++)b[l]=y[v],l++;1===y.length&&(b[l]=y[0],l++),y.length>=2?C[f]=y[y.length-1]:f++,p=!1}else p=!0,f--;else g<t&&!0===p||g===t?(p=!1,b[l]=we(h.join("")),l++,h=[],f++):g<t&&(f++,u=c)}return 0!==h.length&&(b[l]=we(h.join(""))),b}function Te(e,t,n,o,r){var i,a,s,l,u,c,f,h,p,g,m=[],y=r||be();if(!y)return m;if(0===e.length)return m.push({textLength:0,text:"",textInfos:[{style:{font:n},text:""}]}),m;for(i=0,a=[],s=0;s<e.length;s++){for(l=e[s],u=0,0,c=0;c<l.length;c++)void 0,f=l[c].style&&l[c].style.font?l[c].style.font:n,o?u+=P.fp(f)*l[c].text.length:d(l[c].text)||(u+=H(y,f,l[c].text));if(u>t){for(a.length>0&&(m.push({textLength:i,text:we(Ie(a)),textInfos:xe(a)}),a=[],i=0),h=Me(l,t-i,t,o,n,y),a=a.concat(h[0]),d(h[0])||m.push({textLength:i+Ne(h[0],n,o,y),text:we(Ie(a)),textInfos:xe(a)}),a=[],i=0,p=1;p<h.length-1;p++)d(h[p])||m.push({textLength:Ne(h[p],n,o,y),text:we(Ie(h[p])),textInfos:xe(h[p])});h.length>1&&(g=h[h.length-1],a=a.concat(g),d(g)||(i+=Ne(g,n,o,y)))}else i+u>t?(m.push({textLength:i,text:we(Ie(a)),textInfos:xe(a)}),a=(a=[]).concat(l),i=u):(a=a.concat(l),i+=u)}return a.length>0&&m.push({textLength:i,text:we(Ie(a)),textInfos:xe(a)}),m}function Ne(e,t,n,o){var r,i,a=0,s=o||be();for(r=0;r<e.length;r++)i=e[r].style&&e[r].style.font||t,a+=n?P.fp(i)*e[r].text.length:H(s,i,e[r].text);return a}function Ie(e){var t,n="";for(t=0;t<e.length;t++)n+=e[t].text;return n}function Re(e){return e&&"SPAN"===e.tagName}function ke(e){return e&&"BR"===e.tagName}function Ee(e){return e instanceof Text}function De(e){if(e){var t=e.childNodes;return Re(e)&&2===t.length&&ke(t[0])&&je(t[1])}return!1}function je(e){if(e&&Ee(e)){var t=e.textContent;if(1===t.length&&Oe(t[0]))return!0}return!1}function _e(e,t,n,o){return e.substr(0,t)+o+e.substr(n,e.length-n)}function Oe(e){return""===e}function Fe(e,t){for(var n=e&&e.previousSibling;n;){if(t(n))return n;n=n.lastChild}return w}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("./dist/core/util/domUtil.js"),a=n("./dist/core/core.enum.js"),s=n("@grapecity/js-calc"),l=r.GC$,u=l.extend,c=o.Common.o,f=o.Common.k.Uo,h=o.Formatter&&o.Formatter.GeneralFormatter,p=o.Formatter&&o.Formatter.lxb,d=o.Common.j.Fa,g=o.Common.u,t.FallbackFontFamily='"Helvetica Neue", Arial, sans-serif',m=window,y=document,v="boolean",b="date",C=void 0,w=null,x=Math.floor,A=Math.ceil,M=Math.min,S=Math.max,T=Math.round,N=parseInt,I=parseFloat,R=isNaN,k="px",E=" ",D=".",j="string",_="number",O=RegExp("^/Date\\((-?\\d+)([-+]{1}\\d+)?\\)/\\s*$"),F=RegExp("^/OADate\\(([-+]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)\\)/\\s*$"),t.productInfo={productVersion:"13.1.1"},t.CursorResource={ResizeCol:"col-Resize",ResizeRow:"row-resize",ResizeHiddenCol:"w-resize",ResizeHiddenRow:"n-resize"},t.getTypeFromString=function(e){var t,n,o,r=!1,i=m;if(typeof e===j){for(n=0,o=(t=e.split(D)).length;n<o&&i;n++)i=i[t[n]];i&&n===o&&o>0&&(r=!0)}return r?i:C},t.findControl=function(e){return typeof e===j&&(e=y.getElementById(e)),l(e).data("workbook")},P=function(){function e(){}return e.xq=function(e){for(var t,n="";e>0;e=parseInt((e-1)/26+"",10))t=(e-1)%26,n=String.fromCharCode(65+t)+n;return n},e.ol=function(t,n,o,r){if(3===t){var i=l.getType(n);t=o&&"@"===o?0:i===v?1:i===_||i===b||i===j&&e.YGb(n)?2:0,r&&0!==r&&(r>0?t=0:r<0&&(t=2),-90===r?t=0:90===r&&(t=2))}return t},e.YGb=function(t){return e.ZGb.test(t)},e.bc=function(t){var n,r=l.getType(t);return t===w||t===C?t="":r===v?t=(""+t).toUpperCase():r===b?(n=0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds(),t=o.Common.l.Vb(t,n?"M/d/yyyy":"M/d/yyyy h:mm:ss")):t=t.richText?e.K_a(t):""+t,t},e.ql=function(e,t,n,o,r,i,a){var s,u,c,f,h,p,d=l(e),g=t,m=n,y="background-position",v="background-size",b="auto",C="0%",w="100%";switch(i){case 0:a?d.css(y,a.position).css(v,a.size):d.css(y,"0% 0%").css(v,w+E+w);break;case 1:s="50%",u="50%",o>g&&(s=C),r>m&&(u=C),d.css(y,s+E+u).css(v,b+E+b);break;case 2:c=0,f=0,h=g,p=m,m>0&&r>0&&g/m>o/r?c=c+g/2-(h=o/r*m)/2:g>0&&o>0&&m/g>r/o&&(f=f+m/2-(p=r/o*g)/2),d.css(y,c+k+E+f+k).css(v,h+k+E+p+k);break;case 3:d.css(y,"0% 0%").css(v,b+E+b)}},e.device=function(){var e,t,n,o,r=navigator.userAgent,i=r.match(/iPad/i);if(i)(e=i[0])&&(t="ipad"===e.toLowerCase());else if((i=r.match(/Macintosh/i))&&(e=i[0]))try{document.createEvent("TouchEvent"),t="macintosh"===e.toLowerCase()}catch(e){}return(i=r.match(/iPhone/i))&&((e=i[0])&&(n="iphone"===e.toLowerCase())),(i=r.match(/android/i))&&((e=i[0])&&(o="android"===e.toLowerCase())),{ipad:t,iphone:n,android:o}},e.sl=function(){var e=navigator.platform;return e&&e.indexOf("Mac")>-1},e.tl=function(e){if(e===C||e===w)return!1;var t=""+e;return t=c.Oa(t),!R(+(""===t.trim()?NaN:t))||/^[1-9]\d{0,2}(?:(,\d{3})*|\d*)(?:\.\d*)?$/.test(t)},e.ul=function(t,n,o,r,i){var a,s,l,u,c,f,p=w,d=!1;if(t&&((a=t.formatter)?(i?p=i:e.lHb(a)||(p=a,d=!0),typeof p===j&&h&&(p=new h(p))):p=t._autoFormatter),p&&!p.isAuto){s=w;try{if(s=p.parse(n),d&&s instanceof Date&&((l=(new h).getPreferredDisplayFormatter(n,i))&&(s=l.parse(n))),typeof s===_)return s}catch(e){}return s===C||s===w?n:s}if(o){if(u=void 0,u={},c=void 0,f=w,h)try{f=(new h).getPreferredDisplayFormatter(n,u)}catch(e){}return typeof(c=u.value)===_?n=c:e.tl(n)&&(c=u.value=n),r&&(r.value=f),c!==C&&c!==w?c:n}return n},e.vl=function(e){for(var t,n,o=y.body,r=e;r&&r.parentElement&&r.parentElement!==o;)r=r.parentElement;return t=1e3,r&&r.parentElement===o&&(n=N(l(r).css("z-index")),R(n)||(t+=n)),t},e.wl=function(e){var t,n,o,r,i,a,s,l,u,c,f,h,p,d,g;if(!e)return[];if(t=e.indexOf("("),n=e.lastIndexOf(")"),!(o=e.substring(t+1,n)))return[];for(r=[],i=0,a="",s=0,l=0;l<o.length;)s=o.indexOf("rgb",i),-1===(l=o.indexOf("rgb",i+1))&&(l=o.length),a=o.substring(s,l),r.push(a),i=l;for(u=[],c=0,f=r.length;c<f;c++)p=(h=r[c]).indexOf(")"),d=h.substring(0,p+1),g=I(h.substring(p+1,h.length)),R(g)&&(c===f-1?g=100:c<=1&&(g=0)),(d||0!==c)&&(g/=100,u.push({color:d,point:g}));return u},e.xl=function(t,n,o,r){var i,s,l,u,c,f,h,p,g,m,y,v,b,C,x,S,T,I,R,k=n._render,E=0,D=[o],j=n.zoom();for(r===a.AutoFitType.cellWithHeader&&(o===a.SheetArea.viewport?D.push(1):o===a.SheetArea.rowHeader&&D.push(0)),i=0;i<D.length;i++)for(s=0,l=D[i],u=n.getRowCount(l);s>=0&&s<u;)(c=n._modelManager.findSpan(s,t,l))&&(c.col<t||c.colCount>1||c.row<s)?s=c.row+c.rowCount:(n.getRowHeight(s,l)>0&&(h=0,(p=(f=n.getActualStyle(s,t,l)).cellType||n.Al(l))&&(g=f.font||k.Bl(),f.font=k.Cl(g),(y=!(!(m=n.rowFilter&&n.rowFilter())||!m.Dl(s,t,l)))||3!==l||(v=n.tables?n.tables.find(s,t):w)&&v.showHeader()&&v.headerIndex()===s&&v.rowFilter()&&v.filterButtonVisible(t-v.range().col)&&(y=!0),b=f.formatter?f.formatter:f._autoFormatter,C={sheet:n,row:s,col:t,sheetArea:l,quotePrefix:f.quotePrefix},x={},S=n.getValue(s,t,l,a.ValueType.richText),T=n.xHb(s,t,o),"",I=S&&S.richText?n.getText(s,t,l):d(T)?p.format(S,b,x,C):T,h=p.X4(S,I,f,j,C),y&&(R=M(j,1),h+=N(""+n.defaults.rowHeight*R,10))),h>E&&(E=h)),l===a.SheetArea.viewport?s=e.El(s,t,n,l):s++);return 0===E?E=n.defaults.colWidth:E+=A(3),A(E)},e.El=function(e,t,n,o){var r,i,a=-1,s=n.getRowCount(o);for(r=e+1;r<s;r++){if(n.getText(r,t,o)){a=r;break}if((i=n.getActualStyle(r,t,o))&&(i.cellType||i.cellButtons&&i.cellButtons.length>0)){a=r;break}}return a},e.Fl=function(t,n,o,r){var i,a,s,l,u,c,f,h,p,d,g,m=n._render,y=0,v=[o],b=n.zoom();for(1===r&&(3===o?v.push(2):1===o&&v.push(0)),i=0;i<v.length;i++)for(o=v[i],a=0,s=n.getColumnCount(o);a>=0&&a<s;)(l=n._modelManager.findSpan(t,a,o))&&(l.row<t||l.rowCount>1||l.col<a)?a=l.col+l.colCount:(n.getColumnWidth(a,o)>0&&(c=(u=n.getActualStyle(t,a,o)).font||m.Bl(),u.font=m.Cl(c),f=0,(h=n.getCellType(t,a,o))&&(p=n.getText(t,a,o),d=n.getValue(t,a,o,1),g={sheet:n,row:t,col:a,sheetArea:o},f=h.Y4(d,p,u,b,g)),f>y&&(y=f)),3===o?a=e.Gl(t,a,n,o):a++);return 0===y?y=n.defaults.rowHeight:y+=A(3),A(y)},e.Gl=function(e,t,n,o){var r,i,a=-1,s=n.getColumnCount(o);for(r=t+1;r<s;r++){if(n.getText(e,r,o)){a=r;break}if((i=n.getActualStyle(e,r,o))&&i.cellType){a=r;break}}return a},e.Il=function(t,n,r,i){var a,l,u,f,d,g,m,y,v;if(r&&(a=r.Jl,l=r.Kl,u=t.formatter?t.formatter:t._autoFormatter,f=i||{},h&&n!==w&&n!==C))if(d=void 0,u&&u.isAuto)d=typeof n===_,g=e.tl(n),!d&&g&&(n=c.Oa(n)),n=u.getPreferredEditingFormatter?u.getPreferredEditingFormatter(n).format(n):n;else if(typeof u!==j||e.lHb(u)||(u=new h(u)),u)try{n instanceof Date?((m=s&&s.Convert.Wh(n))&&(n=m),y=o.Common.CultureManager.q4().DateTimeFormat,v=o.Common.l.Ra(n),u=new h(!p.Lc(u.formatString(),["d","y"])&&v>=0&&v<1?y.longTimePattern:0===n.getHours()&&0===n.getMinutes()&&0===n.getSeconds()&&0===n.getMilliseconds()?y.shortDatePattern:y.shortDatePattern+E+y.longTimePattern),r.Ll=!0,n=u.format(n),f.formatter=u):typeof n===_&&(n=c.nb(""+n))}catch(e){n=r.getText(a,l)}else n=r.getText(a,l,3);return n!==w&&n!==C&&(n=e.bc(n)),n},e.yIc=function(e,t){var n,r,i=e,a=o.Common.CultureManager.q4(t).NumberFormat,s=o.Common.u,l=a&&a.percentSymbol;return!(!l||!e)&&("object"==typeof e&&e.formatCached&&(i=e.formatCached),"object"!=typeof i&&(n=!0,r=i,s.kb(i,l)?r=s.Fb(i,0,l.length):s.jb(i,l)?r=s.Fb(i,e.length-l.length,l.length):n=!1,s.Bb(r,l)&&(n=!1),n))},e._Va=function(t){var n,o=e.Ml.msie||e.Ml.edge,r=o&&m.MSPointerEvent&&(navigator.msMaxTouchPoints||0)>1;return t?r:(n=o&&m.PointerEvent&&(navigator.maxTouchPoints||0)>1,r||n)},e.K_a=function(t){return t&&t.richText&&t.richText.length>0?(t.text||(t=e.n0a(t)),t.text):t},e.n0a=function(e){var t,n,o;if(!e)return e;if((t=e.richText)&&t.length>0){for(n=[],o=0;o<t.length;o++)n.push(t[o].text?t[o].text:"");e.text=n.join("")}return e},e.lHb=function(e){return"string"==typeof e&&("="===e.charAt(0)||e.indexOf("{{")>=0&&e.indexOf("}}")>=0)},e.Pl=function(e,t,n,o){var r=e,i=t,a=function(e,t){var a,s,l=this;return l.hasOwnProperty("_ps")||(l._ps={}),a=l._ps,0===arguments.length?a[r]!==C?a[r]:i:(!1!==t&&o&&!o.call(l,e)||(s=a[r]!==C?a[r]:i)!==e&&(a[r]=e,!1!==t&&n&&n.call(l,e,s)),l)};return a.isDefault=function(e){return e===i},a},e.Ql=function(e,t){var n={_ps:{}};return o.Common.j.H(e,(function(e){!function(e,t,n){Object.defineProperty(e,t,{get:function(){return this._ps[t]},set:function(e){var o=this._ps[t];o!==e&&(this._ps[t]=e,n&&n(t,e,o))},enumerable:!0})}(n,e,t)})),n},e.Rl=function(e,t,n,o,r){var i,a=M(t,n),s=S(t,n),l=0;for(i=a;i<s&&(l+=o?e.Sl(i,3):e.Tl(i,3),!(r&&l>r));i++);return l},e.Z3=function(e,t){var n,o,r=0,i=0;return e!==t&&(n=l(e).offset(),o=l(t).offset(),r=n.left-o.left,i=n.top-o.top),{FB:i,EB:r}},e.bq=function(e,t,n){var o,r,i,a;if(!e||"string"!=typeof e)return!1;for(r=0;r<e.length;r++)if("*"===(o=e.charAt(r))||":"===o||"["===o||"]"===o||"?"===o||"\\"===o||"/"===o)return!1;if("'"===e.charAt(0)||"'"===e.charAt(e.length-1))return!1;if(!t)return!0;for(i=t.length,r=0;r<i;r++)if(n!==(a=t[r])&&e.toUpperCase()===a.name().toUpperCase())return!1;return!0},e.Ika=function(e,t,n){var o,r,i;if(!e)return e;for(o=0,r=e.length,i=[];o<r;)e[o]===t?i[o]=n:i[o]=e[o],o++;return i.join("")},e.tt=function(){var t,n,o,r=e;return r.ct||(o="-10000px",(n=(t=oe("span")).style).visibility="hidden",n.top=o,n.left=o,n.position="absolute",t.setAttribute("gcUIElement","gcStringWidthSpan"),y.body.insertBefore(t,w),r.ct=t),r.ct},e.fp=function(t,n,o){var r,i,a,s=e,l=s.st;if(!n)if(l){if(o&&(l=l.CJKFontCache),r=l[t])return r}else l=s.st={CJKFontCache:{}},o&&(l=l.CJKFontCache);return(i=s.tt()).style.font=e.hZa(t),e.Ml&&e.Ml.safari&&(i.style.lineHeight="normal"),i.innerHTML=o?String.fromCharCode(20013):"H",a=i.offsetHeight,n||(l[t]=a),a},e.Pxb=function(t){var n,o,r=e,i=r.Qxb;if(i){if(i[t])return i[t]}else i=r.Qxb={};return(o=r.tt()).style.font=t,o.innerHTML="H",(n={}).fontFamily=o.style.fontFamily,n.fontSize=o.style.fontSize,n.fontStyle=o.style.fontStyle,n.fontWeight=o.style.fontWeight,i[t]=n,n},e.Voa=function(t,n){var o=e.tt();return o.style.font=e.hZa(n),e.Ml&&e.Ml.safari&&(o.style.lineHeight="normal"),o.innerHTML=g.Ob(t||"H"),o.offsetHeight},e.iZa=function(n){var o,r=e;return n.indexOf(t.FallbackFontFamily)>=0?n:(n=n.replace("("+String.fromCharCode(27491)+String.fromCharCode(25991)+")","").replace("(Body)","").replace("("+String.fromCharCode(26631)+String.fromCharCode(39064)+")",""),(o=r.tt().style).font=n,o.fontFamily=[].concat(o.fontFamily.split(","),t.FallbackFontFamily.split(",")).join(","),o.font)},e.hZa=function(t){var n,o,r=e;return t&&r.jZa?((n=r.kZa)||(n=r.kZa={}),(o=n[t])||(o=n[t]=r.iZa(t)),o):t},e.lZa=function(t,n){n&&(n=e.hZa(n),t.font!==n&&(t.font=n))},e.pL=function(t,n,o){return!n||d(o)?0:(e.lZa(t,n),t.measureText(o).width)},e.no=function(){var t=e,n=t.ct;n&&(l(n).remove(),t.ct=C),t.st=C,t.Qxb=C,e._0&&(e._0=C),t.kZa=C},e.Woa=function(t){var n,o=e._0;return o||(o=e._0=oe("div")),n=t.innerHTML,o.innerHTML=n,o.innerText},e.G$a=function(e){return e&&/^[A-Za-z_\\\u0080-\uFFFF][A-Za-z0-9_\.\\\?\u0080-\uFFFF]*$/.test(e)&&!(-1!==["C","c","R","r"].indexOf(e)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(e)||/^[Rr]\d*[Cc]\d*$/.test(e)||e.length>=255)},e.T$a=function(e){e&&(e.j_a(!0),e.initExpression(),e.k_a())},e.l_a=function(e){var t,n,o=0,r=0,i=e.length;for(i>0&&(o=e[0].row,r=e[0].col),t=1;t<i;t++)o>(n=e[t]).row&&(o=n.row),r>n.col&&(r=n.col);return{r:o=o<0?0:o,c:r=r<0?0:r}},e.w0a=function(e){var t,n;return typeof e===j&&"/"===e.charAt(0)?(n=void 0,F.test(e)?(n=e.match(F),t=o.Common.l.Xb(I(n[1]))):O.test(e)?(n=e.match(O),t=new Date(I(n[1]))):t=e):t=e,t},e.x0a=function(e){return!d(e)&&o.Common.l.Ska(e)?o.Common.l.Daa(e):e},e.yHb=function(e,t){var n,o,r=e.getImageData(t.x,t.y,t.width,t.height),i=r.data;for(n=0;n<i.length-4;n+=4)o=x((30*i[n]+59*i[n+1]+11*i[n+2]+50)/100),i[n]=o,i[n+1]=o,i[n+2]=o;e.putImageData(r,t.x,t.y)},e.ZGb=/[\u0600-\u06FF\u0750-\u077F]/,e.nl=ie,e.rl=e.device,e.Ml=function(){var e,t,n,o,r;return t=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}}(e=navigator.userAgent),n={version:C,chrome:C,webkit:C,safari:C,mozilla:C,msie:C,metroMode:C,edge:C},t.browser&&(n[t.browser]=!0,n.version=t.version),n.chrome?n.webkit=!0:n.webkit&&(n.safari=!0),e.indexOf("PhantomJS")>=0&&(n.safari=!1,n.chrome=!0),(o=e.toLowerCase()).indexOf("compatible")<0&&/(trident)(?:.*? rv ([\w.]+)|)/.exec(o)!==w&&(n.mozilla=C,n.msie=!0),(r=/Edge\/\d+/.exec(e))!==w&&r.length>0&&(n.webkit=C,n.chrome=C,n.msie=!0,n.edge=!0,n.version=r[0].substr(r[0].indexOf("/")+1)),n.msie&&function(){var e=w,t=!1;try{new ActiveXObject("")}catch(t){e=t.name}try{t=!!new ActiveXObject("htmlfile")}catch(e){t=!1}return!(t="ReferenceError"===e||!1!==t)}()&&(n.metroMode=!0),n}(),e.browser=e.Ml,e.Nl=oe,e.Ol=ne,e.uWa=ae,e.jZa=e.sl(),e.Fxb=function(e){return!1},e}(),t.util=P,t.Ul=P,H=P.pL,B=function(){function e(){}return e.Wl=function(t){return!(e.Xl()!==t||!t._eventHandler||!t._eventHandler.YH)},e.Xl=function(){return m&&m.Yl&&m.Yl.activeElement},e.kmb=function(t){var n,o,r,i,a,s,l;function u(e){var i,a;for(i=0;i<=2;i++)(a=e.call(n,i))&&0!==a.width&&0!==a.height&&(t.$l=!0,o._l(r,a))}if(t&&!e.Wl(t)&&t.parent&&t.parent.options.hideSelection){for(n=t.am(),o=t._render,r=o.bm(),i=t.getSelections(),a=void 0,s=void 0,a=0;a<i.length;a++)l=i[a],(s=t.cm(l)).width>=0&&s.height>=0&&(s.x-=9,s.y-=9,s.width+=18,s.height+=30,o.dm(s));s=n.em(),t.$l=!0,o._l(r,s),u(n.fm),u(n.gm)}},e.Zl=function(t,n){var o=i&&i._legacyWynbi&&i._legacyWynbi.spreadChartEditState&&i._legacyWynbi.spreadChartEditState.pivotTableManager,r=o&&o.getPivotTableBySheet(t),a=e.Xl();r&&a&&a._formulaTextBox||(m.Yl.activeElement=t,t===a||n||(a&&(a.endEdit(),e.kmb(a),a.hm&&a.hm()),t&&t._render.im()))},e}(),t.Vl=B,L=function(){function e(){this.jm=0,this.km=[],this.XCb=!1,this.ad()}return e.prototype.rm=function(){var e="gc-theme-version ui-widget-header ui-state-default wijmoThemeHelper btn-default",t="span."+e.split(E).join(D);return z.vm?l(y).find(t).length<=0&&re(z.vm):z.vm=se(e),z.vm},e.prototype.sm=function(){var e="gc-theme-version ui-widget-content wijmoThemeHelper btn-default",t="span."+e.split(E).join(D);return z.wm?l(y).find(t).length<=0&&re(z.wm):z.wm=se(e),z.wm},e.prototype.tm=function(){var e="gc-theme-version ui-state-hover wijmoThemeHelper btn-primary",t="span."+e.split(E).join(D);return z.xm?l(y).find(t).length<=0&&re(z.xm):z.xm=se(e),z.xm},e.prototype.um=function(){var e="gc-theme-version ui-state-highlight wijmoThemeHelper btn-warning",t="span."+e.split(E).join(D);return z.ym?l(y).find(t).length<=0&&re(z.ym):z.ym=se(e),z.ym},e.prototype.zm=function(){var e="gcDummyElement";return z.Am?l(y).find("#"+e).length<=0&&re(z.Am):z.Am=se("gc-theme-version",e),z.Am},e.prototype.qm=function(){z.rm(),z.sm(),z.tm(),z.um()},e.prototype.ad=function(){var e,t,n=this;function o(e,t){var n,o;if(i&&i._legacyWynbi&&i._legacyWynbi.spreadChartEditState&&i._legacyWynbi.spreadChartEditState.enableReferenceCrossSpread)return!1;for(n=!1,o=e;o;){if("gcSpread"===l(o).attr("gcUIElement")){n=t.zo()!==o;break}o=o.parentElement}return n}function r(e){var r,i,a,s=B.Xl();if(s&&(r=z.Bm(e.target),i=s._formulaTextBox&&s._formulaTextBox._isSelectMode,n.km.forEach((function(e){e&&e(s,r)})),!r||o(r,s)))if(s._endEditImp(C,C,i))t&&((a=s._eventHandler)&&a.Cm&&a.Cm()),B.Zl(w);else if(e.cancelable)return!1}function a(e){var t=e.pointerType;t!==e.MSPOINTER_TYPE_TOUCH&&"touch"!==t||r(e)}n.jm=0,le(m,"keydown",ce,!0),le(m,"keyup",fe,!0),le(m,"compositionstart",he,!0),le(m,"selectstart",de,!0),e=P.rl(),t=e.ipad||e.iphone,P.browser.safari&&!t&&le(m,"textInput",pe,!0),P._Va()?(l(y).bind("MSPointerDown",a),l(y).bind("pointerdown",a)):l(y).bind("touchstart",r),le(y,"mousedown",(function(e){!1===r(e)&&ie(e)}),!0),l(y).bind("DOMContentLoaded",(function(){z.qm()}))},e.prototype.Bm=function(e){for(var t,n=e;n&&"BODY"!==n.tagName&&"function"==typeof n.getAttribute;){if((t=n.getAttribute("gcUIElement"))||(t=n.gcUIElement),t)return n;n=n.parentNode}return w},e.prototype.Dm=function(e,t){var n,o,r,i,s=z.rm();return e===a.VisualState.highlight||e===a.VisualState.selected?s=z.um():e===a.VisualState.hover&&(s=z.tm()),n=s.className,l(s).removeClass(n).addClass(t),r={backgroundColor:(o=ue(s)).backgroundColor,backgroundImage:o.backgroundImage},l(s).addClass(n),(i={backgroundColor:(o=ue(s)).backgroundColor,backgroundImage:o.backgroundImage,color:o.color,zIndex:o.zIndex}).borderLeftColor=o.borderLeftColor,i.borderRightColor=o.borderRightColor,i.borderBottomColor=o.borderBottomColor,i.borderBottomWidth=o.borderBottomWidth,i.borderTopColor=o.borderTopColor,i.borderRightWidth=o.borderRightWidth,i.backgroundImage===r.backgroundImage&&i.backgroundColor!==r.backgroundColor&&(i.backgroundImage=C),l(s).removeClass(t),i},e.prototype.Em=function(e){var t,n=z.zm();return l(n).removeClass(n.className).addClass("gc-theme-version "+e),t=ue(n),u({},t)},e.prototype.Fm=function(e){var t,n=z.sm();return l(n).removeClass(n.className).addClass("gc-theme-version ui-widget-content wijmoThemeHelper btn-default "+e),t=ue(n),u({},t)},e.prototype.Gm=function(){m.Yl.jm++},e.prototype.Hm=function(){var e=m.Yl;e.jm--,e.jm<0&&(e.jm=0)},e}(),z=L.prototype,m.Yl||(m.Yl=new L),V=function(){function e(){}return e.Jm=function(e){return{0:"normal",1:"highlight",2:"selected",3:"active",4:"hover",5:"activeNotSelected"}[e]||""},e.Km=function(t,n){var o=e.Jm(t)+n,r=e.styleCache;return r[o]||(r[o]=z.Dm(t,n)),r[o]},e.Lm=function(t){var n=t,o=e.styleCache;return o[n]||(o[n]=z.Em(t)),o[n]},e.Mm=function(t){var n="content"+t,o=e.styleCache;return o[n]||(o[n]=z.Fm(t)),o[n]},e._ob=function(e,t){var n=e.Pm;return n&&n.getColor&&(t=n.getColor(t)),t},e.Nm=function(){e.styleCache={}},e.styleCache={},e}(),t.Im=V,G=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.clone=function(){return new e(this.x,this.y)},e}(),t.Point=G,W=function(){function e(e,t,n,o){var r=this;r.x=e,r.y=t,r.width=n,r.height=o}return e.prototype.intersect=function(e,t,n,o){var r=this;return e<r.x+r.width&&r.x<e+n&&t<r.y+r.height&&r.y<t+o},e.prototype.intersectRect=function(e){return this.intersect(e.x,e.y,e.width,e.height)},e.prototype.contains=function(e,t){var n=this;return n.x<e&&e<n.x+n.width&&n.y<t&&t<n.y+n.height},e.prototype.containsRect=function(e){return this.contains(e.x,e.y)&&this.contains(e.x+e.width,e.y+e.height)},e.prototype.getIntersectRect=function(e){return this.getIntersect(e.x,e.y,e.width,e.height)},e.prototype.getIntersect=function(t,n,o,r){var i=this,a=i.x,s=i.y,l=i.x+i.width,u=i.y+i.height,c=n,f=t+o,h=n+r,p=S(a,t),d=S(s,c),g=M(l,f)-p,m=M(u,h)-d;return g>0&&m>0?new e(p,d,g,m):w},e.prototype.round=function(){var e=this;e.x=x(e.x),e.y=x(e.y),e.width=A(e.width),e.height=A(e.height)},e.prototype.clone=function(){var t=this;return new e(t.x,t.y,t.width,t.height)},e}(),t.Rect=W,U=function(){function e(e,t,n,o){var r=this;r.row=e,r.rowCount=n,r.col=t,r.colCount=o}return e.prototype.intersect=function(e,t,n,o){var r=this;return(-1===e||-1===r.row||r.row<e+n&&e<r.row+r.rowCount)&&(-1===t||-1===r.col||r.col<t+o&&t<r.col+r.colCount)},e.prototype.getIntersect=function(t,n,o){var r,i,a,s,l,u,c,f,h=this;return t&&h.intersect(t.row,t.col,t.rowCount,t.colCount)?(r=-1===h.col?o-1:h.col+h.colCount-1,i=-1===t.col?o-1:t.col+t.colCount-1,a=-1===h.row?n-1:h.row+h.rowCount-1,s=-1===t.row?n-1:t.row+t.rowCount-1,l=S(h.col,t.col),u=M(r,i),c=S(h.row,t.row),f=M(a,s),new e(c,l,-1===c?-1:f-c+1,-1===l?-1:u-l+1)):w},e.prototype.contains=function(e,t,n,o){var r=this,i=arguments.length,a=!1;return 2!==i&&4!==i||(2===i&&(n=1,o=1),a=(-1===r.row||r.row<=e&&e+n<=r.row+r.rowCount)&&(-1===r.col||r.col<=t&&t+o<=r.col+r.colCount)),a},e.prototype.containsRange=function(e){return this.contains(e.row,e.col,e.rowCount,e.colCount)},e.prototype.offset=function(t,n){var o=this,r=o.col,i=o.row;return-1!==r&&(r+=t),-1!==i&&(i+=n),new e(i,r,o.rowCount,o.colCount)},e.prototype.union=function(e){return ge(this,e)},e.prototype.equals=function(t){var n=this;return t instanceof e&&n.row===t.row&&n.col===t.col&&n.rowCount===t.rowCount&&n.colCount===t.colCount},e}(),t.Range=U,t.kf=function(e,t,n,o){return new U(e,t,n,o)},t.getUnionRange=ge,Z=function(){function e(){}return e.Om=function(e,t){if(e&&t){var n=e.Pm;if(n)return n.getColor(t)}return t},e.Qm=function(e,t){if(e&&t){var n=e.Pm;return n?n.getFont(t):t}return w},e}(),t.Rm=Z,q=function(){function e(){}return e.ValidationError="ValidationError",e.CellClick="CellClick",e.CellDoubleClick="CellDoubleClick",e.ColumnChanging="ColumnChanging",e.RowChanging="RowChanging",e.EnterCell="EnterCell",e.LeaveCell="LeaveCell",e.ValueChanged="ValueChanged",e.TopRowChanged="TopRowChanged",e.SheetChanging="SheetChanging",e.SheetChanged="SheetChanged",e.LeftColumnChanged="LeftColumnChanged",e.InvalidOperation="InvalidOperation",e.RangeFiltering="RangeFiltering",e.RangeFiltered="RangeFiltered",e.RangeFilterClearing="RangeFilterClearing",e.TableFilterClearing="TableFilterClearing",e.RangeFilterCleared="RangeFilterCleared",e.TableFilterCleared="TableFilterCleared",e.TableFiltering="TableFiltering",e.TableFiltered="TableFiltered",e.RangeSorting="RangeSorting",e.RangeSorted="RangeSorted",e.ClipboardChanging="ClipboardChanging",e.ClipboardChanged="ClipboardChanged",e.ClipboardPasting="ClipboardPasting",e.ClipboardPasted="ClipboardPasted",e.ColumnWidthChanging="ColumnWidthChanging",e.ColumnWidthChanged="ColumnWidthChanged",e.RowHeightChanging="RowHeightChanging",e.RowHeightChanged="RowHeightChanged",e.DragDropBlock="DragDropBlock",e.DragDropBlockCompleted="DragDropBlockCompleted",e.DragFillBlock="DragFillBlock",e.DragFillBlockCompleted="DragFillBlockCompleted",e.EditStarting="EditStarting",e.EditStarted="EditStarted",e.EditChange="EditChange",e.EditEnding="EditEnding",e.EditEnd="EditEnd",e.EditEnded="EditEnded",e.RangeGroupStateChanging="RangeGroupStateChanging",e.RangeGroupStateChanged="RangeGroupStateChanged",e.SelectionChanging="SelectionChanging",e.SelectionChanged="SelectionChanged",e.SheetTabClick="SheetTabClick",e.SheetTabDoubleClick="SheetTabDoubleClick",e.SheetNameChanging="SheetNameChanging",e.SheetNameChanged="SheetNameChanged",e.ViewZooming="ViewZooming",e.ViewZoomed="ViewZoomed",e.UserZooming="UserZooming",e.UserFormulaEntered="UserFormulaEntered",e.CellChanged="CellChanged",e.ColumnChanged="ColumnChanged",e.RowChanged="RowChanged",e.ActiveSheetChanging="ActiveSheetChanging",e.ActiveSheetChanged="ActiveSheetChanged",e.SparklineChanged="SparklineChanged",e.OutlineColumnCheckStatusChanged="OutlineColumnCheckStatusChanged",e.RangeChanged="RangeChanged",e.ButtonClicked="ButtonClicked",e.EditorStatusChanged="EditorStatusChanged",e.FloatingObjectChanged="FloatingObjectChanged",e.FloatingObjectSelectionChanged="FloatingObjectSelectionChanged",e.ShapeChanged="ShapeChanged",e.ShapeSelectionChanged="ShapeSelectionChanged",e.PictureChanged="PictureChanged",e.FloatingObjectRemoving="FloatingObjectRemoving",e.ShapeRemoving="ShapeRemoving",e.FloatingObjectRemoved="FloatingObjectRemoved",e.ShapeRemoved="ShapeRemoved",e.PictureSelectionChanged="PictureSelectionChanged",e.FloatingObjectLoaded="FloatingObjectLoaded",e.TouchToolStripOpening="TouchToolStripOpening",e.CommentChanged="CommentChanged",e.CommentRemoving="CommentRemoving",e.CommentRemoved="CommentRemoved",e.SlicerChanged="SlicerChanged",e.BeforeDragDrop="BeforeDragDrop",e.FormulatextboxActiveSheetChanging="FormulatextboxActiveSheetChanging",e.FormulatextboxActiveSheetChanged="FormulatextboxActiveSheetChanged",e.FormulatextboxEditStarted="FormulatextboxEditStarted",e.FormulatextboxEnterCell="FormulatextboxEnterCell",e.FormulatextboxEditEnded="FormulatextboxEditEnded",e.FormulatextboxRangeChanged="FormulatextboxRangeChanged",e.SheetMoving="SheetMoving",e.SheetMoved="SheetMoved",e.DragMerging="DragMerging",e.DragMerged="DragMerged",e.ChartClicked="ChartClicked",e.FloatingElementSelected="FloatingElementSelected",e.BeforePrint="BeforePrint",e.TableResizing="TableResizing",e.TableResized="TableResized",e.TableRowsChanged="TableRowsChanged",e.TableColumnsChanged="TableColumnsChanged",e.DropdownSpreadMouseClick="DropdownSpreadMouseClick",e.DropdownSpreadKeyboardEnter="DropdownSpreadKeyboardEnter",e}(),t.Events=q,J=function(){function e(e){this.kj=e}return e.prototype.no=function(){this.kj=w},e.prototype.Sm=function(e,t,n){var o,r=this.Tm,i=e<<4+t;return r?((o=r[i])||(o=n(),r[i]=o),o):n()},e.prototype.Um=function(e,t){var n,o=this.Vm;return o&&(n=o[e])?n[t]:w},e.prototype.Wm=function(e,t,n,o){var r=this.Vm;r&&(r[e]||(r[e]={}),r[e][t]={d:n,i:o})},e.prototype.zHb=function(e,t,n,o,r){var i,a=this,s=a.kj;return n===C&&(n=3),i=s.xHb(e,t,n),d(i)?!d(r)&&P.lHb(r.formatter)?Q.vn(s,r,a.ge(e,t,n,0),{},{row:e,col:t,sheet:s}):a.ge(e,t,n,o):i},e.prototype.ge=function(e,t,n,o){var r,i,a,s=this.kj,l=this.Xm;return n===C&&(n=3),l?((r=l[n])||(r={},l[n]=r),(i=r[e])||(i={},r[e]=i),(a=i[t])===C&&(a=s.getValue(e,t,n,o),i[t]=a),a):s.getValue(e,t,n,o)},e.prototype.Ym=function(e,t,n){var o,r,i,a=this.kj,s=this.Zm;return n===C&&(n=3),s?((o=s[n])||(o={},s[n]=o),(r=o[e])||(r={},o[e]=r),(i=r[t])||(i=a.AHb(e,t,n,!1,!0),r[t]=i),i.clone(!0)):a.AHb(e,t,n,!1,!1)},e.prototype.Sl=function(e){var t,n=this.kj,o=this.$m;return o?((t=o[e])===C&&(t=o[e]=n.Sl(e)),t):n.Sl(e)},e.prototype._m=function(e){var t,n=this.kj,o=this.an;return o?((t=o[e])===C&&(t=o[e]=n.Tl(e)),t):n.Tl(e)},e.prototype.bn=function(e){var t=this;return t.Xm?(t.cn||(t.cn=e()),t.cn):e()},e.prototype.dn=function(e){var t=this;return t.Xm?(t.gn||(t.gn=e()),t.gn):e()},e.prototype.hn=function(){var e=this;e.in=!0,e.Tm={},e.Vm={},e.Xm={},e.Zm={},e.$m={},e.an={}},e.prototype.jn=function(){this.in=!1},e.prototype.kn=function(){var e=this;e.in=!1,e.Tm=w,e.Vm=w,e.Xm=w,e.Zm=w,e.an=w,e.$m=w,e.cn=w,e.gn=w},e}(),t.ln=J,Q=function(){function e(){}return e.qn=function(t,n,o,r,i){var a,s,l,u;if(e.nn=!0,(a=t.tables)&&a.rn(n,o,r-n+1,i-o+1))for(s=-1,l=e.sn=[],u=0;u<=r;u++)t.getRowVisible(u)?(s++,l[u]=s):l[u]=-1},e.Nm=function(){e.sn=w,e.nn=!1},e.tn=function(t){var n=e.on;return n[t]||(n[t]=h?new h(t):w),n[t]},e.un=function(t,n,o){var r,i,a,s,l,u,c=e.pn,p=t+"_"+typeof t;return h?(c[n]||(c[n]={}),(i=(r=c[n])[p])?(o&&(o.conditionalForeColor=o.value=i.color,o.content=f(i.content)),i.text):((a=e.on)[n]||(a[n]=new h(n)),s={},l=a[n].format(t,s),(u=r[p]={}).text=l,u.color=s.conditionalForeColor,u.content=s.content,o&&(o.conditionalForeColor=o.value=s.conditionalForeColor,o.content=f(s.content)),l)):""+t},e.vn=function(e,t,n,o,r){var i,a;return n&&"SparklineExValue"===n.typeName?"":(i=t.cellType||e.Al(),a=t.formatter||t._autoFormatter,i.format(n,a,o,r))},e.wn=function(){e.on={},e.pn={}},e.nn=!1,e.on={},e.pn={},e.sn=[],e}(),t.mn=Q,Y=function(){function e(){}return e.Cn=function(e,t,n){var o=me(e);o.scaleX=t,o.scaleY=n,o.translateX=o.orgTranslateX*t,o.translateY=o.orgTranslateY*n,e.setTransform(o.scaleX,o.skewX,o.skewY,o.scaleY,o.translateX,o.translateY)},e.Dn=function(e,t,n){var o=me(e);o.orgTranslateX+=t,o.orgTranslateY+=n,o.translateX=o.orgTranslateX*o.scaleX,o.translateY=o.orgTranslateY*o.scaleY,e.setTransform(o.scaleX,o.skewX,o.skewY,o.scaleY,o.translateX,o.translateY)},e}(),t.Bn=Y,K=Y,$=function(){function e(){}return e.npb=function(){var e=m.screen,t=e.deviceXDPI,n=m.devicePixelRatio||(t?t/e.logicalXDPI:1),o=20*n,r=T(o);return r-o>.82?r/20:T(100*n)/100},e.Kn=function(t,n,o){var r,i,a,s,l,u,c,f,h=e;if(ye(t,1),ve(t,1),(1!==(r=e.npb())||1!==h.dpr)&&(h.dpr=r,i=n||o&&o.parent)){for(a=h.Fn,s=void 0,l=0;l<a.length;l++)if(i===a[l].workbook){s=a[l];break}if(s||(s={workbook:i,sheets:[],canvases:[]},a.push(s)),n)s.canvases.push(t);else{for(u=void 0,c=s.sheets,f=0;f<c.length;f++)if(c[f].sheet===o){u=c[f];break}u||(u={sheet:o,canvases:[]},c.push(u)),u.canvases.push(t)}}},e.Ln=function(e){return e&&e.Gn||1},e.Mn=function(e){return e&&e.Hn||1},e.Nn=function(e){return e.In},e.On=function(e){return e.Jn},e.Pn=function(t,n,o){var r,i,a,s=e,l=s.dpr,u=s.Ln(t),c=s.Mn(t);(function(e,t){e.In=t})(t,n),function(e,t){e.Jn=t}(t,o),1===l&&1===u&&1===c?(t.width=n,t.height=o):(r=t.getContext("2d"),K.Cn(r,1,1),P.Ml.mozilla?(t.width=A(n*l),t.height=A(o*l)):(t.width=T(n*l),t.height=T(o*l)),t.style.width=n+k,t.style.height=o+k,i=t.width/n,a=t.height/o,i===u&&a===c||(ye(t,i),ve(t,a)),K.Cn(r,i,a))},e.Qn=function(t,n){var o,r,i,a,s,l=e.Fn,u=t.parent;for(i=0;i<l.length;i++)if(!u||l[i].workbook===u)for(o=l[i].sheets,a=0;a<o.length;a++)if(o[a].sheet===t){for(r=o[a].canvases,s=0;s<r.length;s++)if(r[s]===n){r.splice(s,1);break}break}},e.Rn=function(t,n){var o,r,i,a=e.Fn;for(r=0;r<a.length;r++)if(a[r].workbook===t)for(o=a[r].canvases,i=0;i<o.length;i++)if(o[i]===n){o.splice(i,1);break}},e.Sn=function(t){var n,o,r,i=e.Fn,a=t.parent;for(o=0;o<i.length;o++)if(!a||i[o].workbook===a){for(n=i[o].sheets,r=0;r<n.length;r++)n[r].sheet===t&&n.splice(r,1);return}},e.Tn=function(t){var n,o=e.Fn;for(n=0;n<o.length;n++)if(o[n].workbook===t)return void o.splice(n,1)},e.Un=function(){var t,n,o,r,i,a,s,l,u=e,c=u.npb();if(u.dpr!==c)for(t=u.Fn,n=void 0,o=void 0,r=void 0,i=void 0,u.dpr=c,a=0;a<t.length;a++){for(r=(o=t[a]).canvases,n=o.sheets,s=0;s<n.length;s++)r=r.concat(n[s].canvases);for(l=0;l<r.length;l++)i=r[l],u.Pn(i,u.Nn(i),u.On(i))}},e.dpr=1,e.Fn=[],e}(),t.En=$,X=function(){function e(){}return e.Wn=function(e,t,n,o,r){var i,a,s,l,u,c,f,h,p,d,g=[];if(!e||0===e.length)return g;if(!(i=r||be()))return g;if(P.lZa(i,n),a=P.fp(n),t<=0){for(s=-1,l=!0,u=0;u<e.length;u++)(c=e.charAt(u))===E||l?c!==E&&l&&(s=o?a:H(i,i.font,c),l=!1):s=M(s,o?a:H(i,i.font,c));if((t=s)<=0)return[e]}for(f=e.split(/\r\n|\r|\n/),h=0;h<f.length;h++)if(p=Se(f[h],t,o,a,i))if(0===p.length)g.push("");else for(d=0;d<p.length;d++)g.push(p[d]);return g},e.oV=function(t,n,o,r,i){var a,s,l,u,c=[];if(0===n.length)return c;if(r)c=e.Wn(n,i,o,!0);else for(a=n.split(/\r\n|\r|\n/),s=0;s<a.length;s++){for(l=[],u=0;u<a[s].length;u++)l.push(a[s][u]);c.push(l)}return c},e.M_a=function(t,n,o,r,i,a){var s,l,u,c,f,h,p,g=[];if(0===t.length)return g;if(!(s=a||be()))return g;if(n<=0&&(n=function(e,t,n,o){var r,i,a,s,l,u=-1,c=!0;for(r=0;r<t.length;r++)if(!d(t[r].text))for(i=0;i<t[r].text.length;i++)a=t[r].text.charAt(i),s=t[r].style?t[r].style.font:n,P.lZa(e,s),l=P.fp(s),a===E||c?a!==E&&c&&(u=o?l:H(e,n,a),c=!1):u=M(u,o?l:H(e,n,a));return u}(s,r,o,i))<=0){for(u=[],l=0;l<r.length;l++)d(r[l].text)||u.push({textLength:e.R_a([r[l]],o,1,i,!1,s),text:r[l].text,textInfos:[r[l]]});return u}for(c=e.N_a(t),f=e.O_a(c,e.P_a(r)),l=0;l<f.length;l++)if(h=Te(f[l],n,o,i,s))if(0===h.length)g.push("");else for(p=0;p<h.length;p++)g.push(h[p]);return g},e.N_a=function(e){var t,n=[],o=e.split(/\r\n|\r|\n/);for(t=0;t<o.length;t++)n.push(Ce(o[t]));return n},e.O_a=function(e,t){var n,o,r,i,a,s,l=[],u=0,c=0;for(n=0;n<e.length;n++){for(o=[],r=0;r<e[n].length&&u<t.length;r++)if((i=e[n][r]).length<=t[u].text.length-c)o.push([{style:t[u].style,text:i}]),c+=i.length;else{for((a=[]).push({style:t[u].style,text:t[u].text.substring(c)}),s=i.length-(t[u].text.length-c),u++;u<t.length;u++){if(s<t[u].text.length){a.push({style:t[u].style,text:i.substring(i.length-s)}),c=s;break}if(s===t[u].text.length){a.push({style:t[u].style,text:i.substring(i.length-s)}),u++,c=0;break}a.push({style:t[u].style,text:t[u].text}),s-=t[u].text.length}o.push(a)}l.push(o)}return l},e.Xn=function(e,t,n,o){var r,i=o||be();return i?(t&&P.lZa(i,t),r=n?we(e):e,H(i,i.font,r)):0},e.P_a=function(e){var t,n=[];for(t=0;t<e.length;t++)n.push({style:e[t].style,text:e[t].text?e[t].text.replace(/\r\n|\r|\n/g,""):e[t].text});return n},e.R_a=function(e,t,n,o,r,i){var a,s,l,u,c,f=i||be();if(!f)return 0;for(a=0,s=0;s<e.length;s++)void 0,l=e[s].style&&e[s].style.font?e[s].style.font:t,P.lZa(f,l),"",u=s===e.length-1&&r?we(e[s].text):e[s].text,c=0,o?c=P.fp(l)*u.length/n:d(e[s].text)||(c=H(f,f.font,e[s].text)/n),e[s].style&&e[s].style.vertAlign&&(c*=.7),a+=c;return a},e.mHb=function(t,n,o,r,i,a,s,l){var u=0,c=P.fp(a),f=(s-4-c*r)/o,h=e.Wn(i,f,a),p=h.length,d=c*o;return u=(p-1)*(c/o),(u+=e.Xn(h[0],a)/2*r+d)+(e.Xn(h[p-1],a)/2*r+d)},e.Rvb=function(e){return we(e)},e.bm=function(){return be()},e}(),t.Vn=X,t.Zn=function(e){e.$n=function(t,n){var o,r;for(e._features||(e._features=[]),e._fc={},o=e._features,n.name=t,n.priority=n.priority||5e3,r=0;;r++)if(r>=o.length||n.priority>o[r].priority){o.splice(r,0,n);break}},e.ao=function(t,n,o,r){var i,a,s,l=e._features;if(l){if(!(i=e._fc[n]))for(i=e._fc[n]=[],a=0;a<l.length;a++)(s=l[a][n])&&i.push(s);for(a=0;a<i.length&&(i[a].call(t,o),!r||!r());a++);}}},ee=function(){function e(){this.JTa={}}return e.prototype.get=function(e,t){var n=this.JTa[e];return n?n[t]:C},e.prototype.set=function(e,t,n){var o=this.JTa[e];o||(o=this.JTa[e]={}),o[t]=n},e}(),t.KTa=ee,te=function(){function e(){}return e.processBackspaceAndLeftArrowKeyEvent=function(e,t){var n,o,r,i,a,s,l,u,c,f,h=m.getSelection();if(!(h.rangeCount<=0)){if(n=h.anchorNode,o=h.anchorOffset,r=e.target,P.browser.msie&&!P.browser.edge&&t&&function(e,t,n){if(1===t&&Re(n.firstChild)&&Re(n.firstChild.firstChild)){var o=n.firstChild.firstChild.lastChild,r=void 0;if(e===n)return 1===(r=o.textContent).length&&""!==r[0]&&ke(o.previousSibling);if(o===e||ke(o)&&e===o.previousSibling)return 1===(r=e.textContent).length&&""!==r[0]&&ke(e.previousSibling)}return!1}(n,o,r))return i=parseFloat(P.browser.version)<10?function e(t,n,o,r,i,a){var s,l,u,c,f,h="",p=t.childNodes,d=p.length;for(s=0;s<d;s++)Re(l=p[s])?h+=e(l,n,o,r,i,a):Ee(l)?(u=n&&n.startContainer,c=n&&n.endContainer,f=l.textContent,l===u||l===c?u!==c?l===u?(h+=_e(f,o,f.length,i),a=!0):(h+=_e(f,0,r,""),a=!1):h+=_e(f,o,r,i):a||(h+=f)):ke(l)&&!a&&(h+="\n");return h}(r):r.innerText,a=i.slice(0,-1),r.innerHTML=a.replace(/\r/g,"").replace(/\n/g,"<br>"),h.selectAllChildren(r),h.rangeCount>0&&h.collapseToEnd(),void ie(e);if((s=function(e,t){var n,o,r,i,a,s=e.childNodes.length;if(!Oe(e.textContent[0])||0!==t&&1!==t)if(0===t)o=e,e===e.parentNode.firstChild&&(o=e.parentNode),r=Fe(o,De),n=r&&r.lastChild;else{if(function(e){return e&&"DIV"===e.tagName}(e))return 1===s&&1===t?n=e.firstChild.firstChild.lastChild:s>1&&t===s&&(n=e.lastChild),je(n)?{zeroWidthCharNode:n,previousTextNode:n.previousSibling.previousSibling}:De(n)?{zeroWidthCharNode:n,previousTextNode:Fe(o,Ee)}:w;!Re(e)||t!==s&&t!==s-1||(De(e)?n=e:De(e.lastChild)&&(n=e.lastChild))}else n=e;return n?(Re(n)?o=n:Ee(n)&&(i=n.previousSibling,a=n.parentNode,o=i===a.firstChild?a:i),{zeroWidthCharNode:n,previousTextNode:Fe(o,Ee)}):w}(n,o))&&s.zeroWidthCharNode){if(l=s.zeroWidthCharNode,u=s.previousTextNode,t)if(Re(l))l.parentNode.removeChild(l);else{if(l.parentNode.removeChild(l.previousSibling),ke(u))return void ie(e);(c=h.getRangeAt(0)).setStart(l,0),c.setEnd(l,1),c.deleteContents()}(f=y.createRange()).setStartAfter(u),f.setEndAfter(u),f.collapse(!1),h.removeAllRanges(),h.addRange(f),ie(e)}}},e.processDeleteAndRightArrowKeyEvent=function(e,t){var n,o,r,i,a,s=m.getSelection();s.rangeCount<=0||(n=function(e){var t,n,o=e.anchorNode,r=e.anchorOffset,i=o.textContent.length;if(r===i){if(t=function(e){for(var t,n=e;n;){if(t=n.parentNode,n!==t.lastChild)return n.nextSibling;n=t}return w}(o),n=void 0,!t)return w;if(Re(t)&&Oe(t.textContent[0])){for(;Re(t.firstChild);)t=t.firstChild;n=t.childNodes[1]}else ke(t)&&Oe(t.nextSibling.textContent[0])&&(n=t.nextSibling);return{node:n,offset:1}}return w}(s))&&n.node&&(o=n.node,r=n.offset,t?((i=s.getRangeAt(0)).setStart(o,0),i.setEnd(o,1),i.deleteContents(),o.parentNode.removeChild(o.previousSibling)):((a=y.createRange()).setStart(o,r),a.setEnd(o,r),a.collapse(!1),s.removeAllRanges(),s.addRange(a)),ie(e))},e}(),t.uHb=te,t.Rxb={touch:!1}},"./dist/core/util/domUtil.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O;function F(e,t){var n,o;for(Array.call(this),"string"==typeof e?n=(t||u).querySelectorAll(e):e&&(n=r.Ca(e)||e instanceof HTMLCollection?e:[e]),o=0;n&&o<n.length;o++)this.push(n[o])}function P(e){return j.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}function H(e,t){var n=e.nodeName;return n&&n.toLowerCase()===t.toLowerCase()}function B(e,t){return"top left right bottom width height border-radius border-width border-left-width border-right-width border-top-width border-bottom-width line-height padding padding-left padding-right padding-top padding-bottom margin margin-left margin-right margin-top margin-bottom".split(" ").indexOf(e)>=0&&isFinite(t)?("width height".split(" ").indexOf(e)>=0&&t<0&&(t=0),t+"px"):t}function L(e,t,n){var o,r,i=e.nodeType;if(e&&3!==i&&8!==i&&2!==i)return 1!==i&&(r=N[t=T[t]||t]),J(n)?r&&h in r&&(o=r.get(e,t))!==s?o:e[t]:r&&p in r&&!J(o=r.set(e,n,t))?o:(e[t]=n,n)}function z(e){var t,n,o,r=e.nodeType;return(!r||1===r||9===r)&&(t={embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},!(o=(n=e.nodeName)&&t[n.toLowerCase()])||!0!==o&&e.getAttribute("classid")===o)}function V(e){return e.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,(function(e,t){return t.toUpperCase()}))}function G(e,t,n,o){if(z(e)){var r,i,l=k,u=Z(t),c=e.nodeType,f=c?R:e,h=c?e[l]:e[l]&&l;if(h&&f[h]&&(o||f[h].data)||!u||!J(n))return h||(c?(e[l]=h=E,E++):h=l),f[h]||(f[h]={},c||(f[h].toJSON=function(){})),(q(t)||"function"==typeof t)&&(o?f[h]=j.extend(f[h],t):f[h].data=j.extend(f[h].data,t)),r=f[h],o||(r.data||(r.data={}),r=r.data),J(n)||(r[V(t)]=n),u?(i=r[t])!==s&&i!==a||(i=r[V(t)]):i=r,i}}function W(e){var t;for(t in e)if(("data"!==t||!j.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function U(e,t){for(var n,o,r,a,l,u,c,f,h,p=0,d=k,g=R,m=e[p];m!==s&&void 0!==m;){if((t||z(m))&&(o=(n=m[d])&&g[n])){if(r=o.events)for(a in r)if(i(r,a)&&(l=r[a]))for(u in l)if(i(l,u)&&(c=l[u]))for(f=0,h=c.length;f<h;f++)ee(m,a,c[f]);g[n]&&(delete g[n],delete m[d])}m=e[++p]}}function Z(e){return"string"==typeof e}function q(e){return"object"==typeof e}function J(e){return typeof e==typeof a}function Q(e){var t=e;return function(e){var n,o=this,r="border-box"===o.css("box-sizing"),i=t?d:g,a=t?m:v,s=t?y:b;return 0===arguments.length?(n=Math.round(l(o.css(i)))||0,r&&(n-=l(o.css("padding-"+a))+l(o.css("padding-"+s))+l(o.css("border-"+a+"-"+d))+l(o.css("border-"+s+"-"+d))),n):(o.css(i,e),o)}}function Y(e){var t=e;return function(){var e=this,n=t?m:v,o=t?y:b;return t?e.width():e.height()+l(e.css("padding-"+n))+l(e.css("padding-"+o))}}function K(e){var t=e;return function(e){var n=t?m:v,o=t?y:b,r=this,i=t?r.innerWidth():r.innerHeight();return i+=l(r.css("border-"+n+"-"+d))+l(r.css("border-"+o+"-"+d)),e&&(i+=l(r.css("margin-"+n))+l(r.css("margin-"+o))),i}}function $(e){var t=e;return function(e){return this.forEach((function(n){n.style[S]=t?w:x,e&&e.apply(n)})),this}}function X(e){var t=e;return function(e){var n="scrollLeft",o="scrollTop",r=t?n:o,i=t?"pageXOffset":"pageYOffset",a=this[0],s=P(a);return J(e)?s?i in s?s[i]:u.documentElement[r]:a[r]:(s?s.scrollTo(t?e:j(s)[n](),t?j(s)[o]():e):a[r]=e,this)}}function ee(e,t,n){e.removeEventListener(t,n)}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=o.Common.j,i=o.Common.D,a=void 0,s=null,l=parseFloat,u=document,c="_nonamespace",f="events",h="get",p="set",d="width",g="height",m="left",y="right",v="top",b="bottom",C="hidden",w="block",x="none",A="position",M="visibility",S="display",T={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},N={tabIndex:{get:function(e){var t=e.getAttributeNode("tabindex"),n=e.nodeName;return t&&t.specified?parseInt(t.value,10):/^(?:input|select|textarea|button|object)$/i.test(n)||/^(?:a|area)$/i.test(n)&&e.href?0:a}}},I={option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,o=e.options,r=e.selectedIndex,i="select-one"===e.type||r<0,a=i?s:[],l=i?r+1:o.length,u=i?r:0;for(r<0&&(u=l);u<l;u++)if(((n=o[u]).selected||u===r)&&!n.disabled&&(!n.parentNode.disabled||!H(n.parentNode,"optgroup"))){if(t=j(n).val(),i)return t;a.push(t)}return a},set:function(e,t){var n=j.makeArray(t);return j(e).find("option").getAll().forEach((function(e){e.selected=j.inArray(j(e).val(),n)>=0})),n.length||(e.selectedIndex=-1),n}}},R={},k="$"+(""+Math.random()).replace(/\D/g,""),E=1,D={},[g,d].forEach((function(e){D[e]={get:function(t){var n,o,r,i=getComputedStyle(t),a=t.style,s=a[A],l=a[M],c=a[S],f=0===t.offsetWidth&&/^(none|table(?!-c[ea]).+)/.test(i[S]);if(f&&(a[A]="absolute",a[M]=C,a[S]=w),n=i&&i[e],f&&(a[A]=s,a[M]=l,a[S]=c),""===n){for(o=t.parentElement,r=u.body;o&&o!==r;)o=o.parentElement;o!==r&&(n=a[e])}return n}}})),j=function(e,t){return e instanceof F?e:new F(e,t)},t.GC$=j,_={get:function(e){return this[e]},getAll:function(){return this},bind:function(e,t,n){return J(n)&&(n=t,t=a),this.forEach((function(o){var r,i,s,l,u,h,p=G(o,f,a,!0);p||G(o,f,p={},!0),i=(r=e.split("."))[0],(l=p[s=r[1]||c])||(l=p[s]={}),(u=function(e){J(t)||(e.data=t);var r=n.apply(o,arguments);e.result=r,!1===r&&(e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.cancelBubble=!1,e.returnValue=!1))}).original=n,(h=l[i])||(h=l[i]=[]),h.push(u),o.addEventListener(i,u)})),this},unbind:function(e,t){return this.forEach((function(n){var o,r,s,l,u=e.split("."),h=u[0],p=u[1]||c,d=G(n,f,a,!0),g=d&&d[p];if(t){if(g&&h&&(o=g[h]))for(s=o.length,r=0;r<s;r++)if(o[r].original===t){ee(n,h,o[r]),o.splice(r,1);break}}else if(g)if(h){if(o=g[h])for(s=o.length,r=0;r<s;r++)ee(n,h,o[r]);g[h]=a}else{for(l in g)if(i(g,l)&&(o=g[l]))for(s=o.length,r=0;r<s;r++)ee(n,l,o[r]);d[p]=a}})),this},trigger:function(e,t){var n,o,r,s,l,u,c,h,p,d,g=this;for(n=0,o=g.length;n<o;n++)if(s=G(r=g[n],f,a,!0))for(u in l=e.split(".")[0],s)if(i(s,u)&&(h=(c=s[u])&&c[l]))for(p=0,d=h.length;p<d;p++)h[p].apply(r,[{type:l},t]);return g},css:function(e,t){var n,o,r,a=this,s=a,l=arguments.length;function u(e,t){s.forEach((function(n){n.style[e]=B(e,t)}))}if(1===l){if(!q(e))return n=a[0],(o=D[e])&&h in o?o.get(n):(r=getComputedStyle(n))&&r[e];s.forEach((function(t){for(var n in e)i(e,n)&&(t.style[n]=B(n,e[n]))}))}else 2===l&&(Array.isArray(e)&&Array.isArray(t)&&e.length===t.length?e.forEach((function(e,n){u(e,t[n])})):u(e,t));return a},width:Q(!0),height:Q(),innerWidth:Y(!0),innerHeight:Y(),outerWidth:K(!0),outerHeight:K(),append:function(e){var t,n=[e];return e instanceof j&&(n=e.getAll()),this,t=this[0],n.forEach((function(e){e&&t.appendChild(e)})),this},appendTo:function(e){var t=e;return e instanceof j&&(t=e[0]),this,this.forEach((function(e){t.appendChild(e)})),this},prepend:function(e){var t=this[0];return t.insertBefore(e,t.firstChild),this},insertBefore:function(e){var t=e.parentElement;return this.forEach((function(n){t.insertBefore(n,e)})),this},addClass:function(e){var t,n,o,r,i,a=0,s=this.length,l=/[\t\r\n]/g;for(t=(e||"").match(/\S+/g)||[];a<s;a++)if(o=1===(n=this[a]).nodeType&&(n.className?(" "+n.className+" ").replace(l," "):" ")){for(r=t[i=0];r;)o.indexOf(" "+r+" ")<0&&(o+=r+" "),r=t[++i];n.className=j.trim(o)}return this},removeClass:function(e){var t,n,o,r,i,a=0,s=this.length,l=/[\t\r\n]/g;for(t=(e||"").match(/\S+/g)||[];a<s;a++)if(o=1===(n=this[a]).nodeType&&(n.className?(" "+n.className+" ").replace(l," "):"")){for(r=t[i=0];r;){for(;o.indexOf(" "+r+" ")>=0;)o=o.replace(" "+r+" "," ");r=t[++i]}n.className=e?j.trim(o):""}return this},hasClass:function(e){var t,n=0,o=this.length,r=/[\t\r\n]/g;for(e=" "+e+" ";n<o;n++)if(1===(t=this[n]).nodeType&&(" "+t.className+" ").replace(r," ").indexOf(e)>=0)return!0;return!1},toggle:function(){var e=this;return e[0].style[S]===x?e.show():e.hide(),e},show:$(!0),hide:$(),attr:function(e,t){var n=this,o=n,r=arguments.length;if(1===r){if(!q(e))return n[0].getAttribute(e);o.forEach((function(t){for(var n in e)i(e,n)&&t.setAttribute(n,e[n])}))}else 2===r&&o.forEach((function(n){n.setAttribute(e,t)}));return n},removeAttr:function(e){return this.forEach((function(t){t.removeAttribute(e)})),this},prop:function(e,t){var n=this,o=n,r=arguments.length;if(1===r){if(!q(e))return L(n[0],e);o.forEach((function(t){for(var n in e)i(e,n)&&L(t,n,e[n])}))}else 2===r&&o.forEach((function(n){L(n,e,t)}));return n},removeProp:function(e){e=T[e]||e;return this.forEach((function(t){try{t[e]=a,delete t[e]}catch(e){}})),this},text:function(e){var t=this,n=t;return 0===arguments.length?t[0].textContent:(n.forEach((function(t){t.textContent=e})),t)},val:function(e){var t,n,o,r,i=this;return arguments.length?(r=j.isFunction(e),i.forEach((function(n,o){var i;1===n.nodeType&&((i=r?e.call(n,o,j(n).val()):e)===s||i===a?i="":"number"==typeof i?i+="":j.isArray(i)&&(i=j.map(i,(function(e){return e===s||e===a?"":e+""}))),(t=I[n.type]||I[n.nodeName.toLowerCase()])&&p in t&&!J(t.set(n,i,"value"))||(n.value=i))})),i):(o=void 0,(n=i[0])?(t=I[n.type]||I[n.nodeName.toLowerCase()])&&h in t&&!J(o=t.get(n,"value"))?o:Z(o=n.value)?o.replace(/\r/g,""):o===s||o===a?"":o:void 0)},position:function(){var e,t,n,o,r=this[0];if(r){if(e={top:0,left:0},t={top:0,left:0},"fixed"===j(r).css(A))try{e=r.getBoundingClientRect()}catch(e){}else n=this.offsetParent(),e=this.offset(),H(o=n[0],"html")||((t=n.offset()).left-=o.scrollLeft,t.top-=o.scrollTop),t.top+=l(j(o).css("borderTopWidth")),t.left+=l(j(o).css("borderLeftWidth"));return{top:e.top-t.top-l(j(r).css("marginTop")),left:e.left-t.left-l(j(r).css("marginLeft"))}}},offsetParent:function(){var e=j.map(this,(function(e){for(var t=u.documentElement,n=e.offsetParent||t;n&&!H(n,"html")&&"static"===j(n).css(A);)n=n.offsetParent;return n||t}));return j(e)},offset:function(){var e,t,n={top:0,left:0},o=this[0],r=o&&o.ownerDocument;if(r){if(e=r.documentElement,!J(o.getBoundingClientRect))try{n=o.getBoundingClientRect()}catch(e){}return t=P(r),{top:n.top+(t.pageYOffset||e.scrollTop)-(e.clientTop||0),left:n.left+(t.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}}},scrollLeft:X(!0),scrollTop:X(),html:function(e){var t=this,n=t;return 0===arguments.length?t[0].innerHTML:(n.forEach((function(t){t.innerHTML=e})),t)},remove:function(){this.forEach((function(e){var t=e.parentElement;t&&(t.removeChild(e),U([e]))}))},empty:function(){return this.forEach((function(e){j(e.children).remove()})),this},find:function(e){var t=[];return Z(e)&&this.forEach((function(n){var o=n.querySelectorAll(e);j.merge(t,o)})),j(t)},parent:function(){var e=[];return this.forEach((function(t){var n=t.parentElement;n&&e.push(n)})),j(e)},index:function(e){var t=this[0];return e?Z(e)?j.inArray(t,j(e).getAll()):j.inArray(e,this):t&&t.parentElement?j.inArray(t,t.parentElement.children):-1},focus:function(){var e=this[0];return e!==u.activeElement&&e.focus&&e.focus(),this},isVisible:function(){var e=0;return this.forEach((function(t){var n=getComputedStyle(t);n[M]!==C&&n[S]!==x&&e++})),e>0},data:function(e,t){var n=this,o=J(t);return o&&(n=void 0),j.each(this,(function(r,i){var a=G(i,e,t);if(o)return n=a,!1})),n},removeData:function(e){return j.each(this,(function(t,n){!function(e,t,n){if(z(e)){var o,r,i,a=e.nodeType,l=a?R:e,u=a?e[k]:k;if(l[u]){if(t&&(i=n?l[u]:l[u].data)){j.isArray(t)?t=t.concat(j.map(t,V)):t in i?t=[t]:t=(t=V(t))in i?[t]:t.split(" "),r=t.length;for(o=0;o<r;o++)delete i[t[o]];if(!(n?W:j.isEmptyObject)(i))return}(n||(delete l[u].data,W(l[u])))&&(a?U([e],!0):l!==l.window?delete l[u]:l[u]=s)}}}(n,e)})),this}},O=F.prototype=[],r.Ia(O,_),j.prototype=O,j.each=r.H,j.isEmptyObject=r.za,j.isFunction=r.Aa,j.isArray=r.Ca,j.isNumeric=r.Da,j.getType=r.Ba,j.inArray=r.Ea,j.merge=r.Ga,j.map=r.Ha,j.extend=r.Ia,j.inherit=r.G,j.isPlainObject=r.Ja,j.isArraylike=r.ya,j.isWindow=r.Ka,j.makeArray=r.La,j.trim=function(e){if(e.trim)return e.trim();return e===s||e===a?"":(e+"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},j.Nl=function(e,t,n,o,r){var i=j(u.createElement(e));return t&&n&&i.css(t,n),o&&i.addClass(o),r&&(r instanceof j?r.append(i):j(r).append(i)),i}},"./dist/core/util/imageLoader.js":function(e,t,n){"use strict";var o,r,i,a;Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/util/domUtil.js"),r=o.GC$,i=".gcSheet",a=function(){function e(e){this.bo=0,this.co=0,this.eo={};this.do=e}return e.prototype.fo=function(e){var t,n,o=this;function a(){o.ho(e,!1)}(t=o.eo)[e]||((n=r(document.createElement("img"))).bind("load"+i,(function(){o.ho(e,!0)})),n.bind("error"+i,a),n.bind("abort"+i,a),o.bo++,t[e]={io:!1,jo:n[0],agc:!1},n[0].src=e)},e.prototype.ko=function(e){var t=this.eo[e];return!!t&&t.io},e.prototype.bgc=function(e){var t=this.eo[e];return!!t&&t.agc},e.prototype.lo=function(e){var t=this.eo[e];return t?t.jo:null},e.prototype.ho=function(e,t){var n=this;n.co++,n.eo[e].io=!0,n.eo[e].agc=t,n.mo()&&n.do&&n.do()},e.prototype.mo=function(){return this.co>=this.bo},e.prototype.no=function(){var e,t=this.eo;if(t)for(e in t)t[e]&&r(t[e].jo).unbind(i);this.do=null},e}(),t.oo=a},"./dist/core/util/tasks.js":function(e,t,n){"use strict";var o,r;Object.defineProperty(t,"__esModule",{value:!0}),o=function(){function e(e,t){this.fn=e,this.args=t}return e.prototype.run=function(){this.fn.apply(null,this.args)},e}(),t.Task=o,r=function(){function e(e,t){var n=this;n.tasks=[],n.nextTaskFunc=e.bind(n),n.isBusyFunc=t.bind(n)}return e.prototype.addTask=function(e,t){this.tasks.splice(0,0,new o(e,t))},e.prototype.pushTask=function(e,t){this.tasks.push(new o(e,t))},e.prototype.runNextTask=function(){var e=this,t=e.tasks;if(!e.isTerminated){if(t.length<1)return void(e.endingCallback&&e.endingCallback());if(e.isBusyFunc())return void setTimeout((function(){e.runNextTask()}),100);e.nextTaskFunc().run(),setTimeout((function(){e.runNextTask()}),10)}},e.prototype.start=function(){this.runNextTask()},e.prototype.terminate=function(){this.tasks=[],this.isTerminated=!0},e}(),t.Tasks=r},"./dist/core/util/theme.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C;function w(e){var t=e;return function(n){return 0===arguments.length?this.po[t]:(this.po[e]=s(n),this)}}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("./dist/core/util/common.js"),i=o.Common.j.Fa,a=o.Common.pc,s=a.ec,l=parseInt,u=r.util.Pl,c="Gill Sans MT",f="Franklin Gothic Book",h="Trebuchet MS",p=10,d=11,g=function(){function e(e,t,n,o,r,i,a,l,u,c,f,h,g){this.background1=w(0),this.background2=w(1),this.textColor1=w(2),this.textColor2=w(3),this.accent1=w(4),this.accent2=w(5),this.accent3=w(6),this.accent4=w(7),this.accent5=w(8),this.accent6=w(9),this.hyperlink=w(p),this.followedHyperlink=w(d),this.Cj=e,this.po=[];for(var m=1;m<13;m++)this.po.push(s(arguments[m]))}return e.prototype.name=function(e){return 0===arguments.length?this.Cj:(this.Cj=e,this)},e.prototype.getColor=function(e){var t,n,o,r,i;if(e&&"string"==typeof e&&(n=void 0,t=e.split(" "))){if(o=-1,(r=t.length)>1){if(!t[0])return e;"background"===(n=t[0].toLowerCase())?o=l(t[1],10)-1:"text"===n?o=l(t[1],10)+1:"accent"===n&&(o=l(t[1],10)+3)}else 1===r&&("hyperlink"===(n=t[0].toLowerCase())?o=p:"followedhyperlink"===n&&(o=d));if(o>=0&&o<=11)return r>2?(i=l(t[2],10)/100,a.bc(a.jc(this.po[o],i))):a.bc(this.po[o])}return e},e.prototype.toJSON=function(){var e=this.po;return{name:this.Cj,background1:e[0],background2:e[1],text1:e[2],text2:e[3],accent1:e[4],accent2:e[5],accent3:e[6],accent4:e[7],accent5:e[8],accent6:e[9],hyperlink:e[p],followedHyperlink:e[d]}},e.prototype.fromJSON=function(e,t){var n,o,r,a,s,l,u,c,f,h,g,m,y,v,b;function C(e,t){i(t)||(n.po[e]={a:t.a,r:t.r,g:t.g,b:t.b})}e&&(n=this,"_colorList","_name",t?(v=e.name?e.name:e._name,i(v)||(n.Cj=v),o=(b=e.colorList?e.colorList:e._colorList)[0],r=b[1],a=b[2],s=b[3],l=b[4],u=b[5],c=b[6],f=b[7],h=b[8],g=b[9],m=b[p],y=b[d]):(i(e.name)||(n.Cj=e.name),o=e.background1,r=e.background2,a=e.text1,s=e.text2,l=e.accent1,u=e.accent2,c=e.accent3,f=e.accent4,h=e.accent5,g=e.accent6,m=e.hyperlink,y=e.followedHyperlink),C(0,o),C(1,r),C(2,a),C(3,s),C(4,l),C(5,u),C(6,c),C(7,f),C(8,h),C(9,g),C(p,m),C(d,y))},e.prototype.e4=function(e){var t,n,o,r;if(this.name()!==e.name())return!1;for(n=0,o=(t=["textColor1","textColor2","background1","background2","accent1","accent2","accent3","accent4","accent5","accent6","hyperlink","followedHyperlink"]).length;n<o;n++)if(r=t[n],!a.Pka(this[r](),e[r]()))return!1;return!0},e}(),t.ColorScheme=g,m=function(){function e(e,t,n,o){this.name=u("name"),this.colors=u("colors"),this.headerFont=u("headerFont"),this.bodyFont=u("bodyFont");var r=this;r.name(e),r.colors(t||new g(e)),r.headerFont(n),r.bodyFont(o)}return e.prototype.getColor=function(e){return this.colors().getColor(e)},e.prototype.getFont=function(e){return"Body"===e?this.bodyFont():"Headings"===e?this.headerFont():e},e.prototype.toJSON=function(){var t=this,n=t.name();return e.f4(t)?n:{name:n,themeColor:t.colors()?t.colors().toJSON():void 0,headingFont:t.headerFont(),bodyFont:t.bodyFont()}},e.f4=function(e){var t,n=e.name();return!!C[n]&&(t=C[n],e.bodyFont()===t.bodyFont()&&e.headerFont()===t.headerFont()&&e.colors().e4(t.colors()))},e}(),t.Theme=m,y="#000000",v="#FFFFFF",b=function(){function e(){}return e.Default=new g("Default",v,"#EEECE1",y,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),e.Office2007=new g("Office2007",v,"#EEECE1",y,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),e.Office=new g("Office",v,"#E7E6E6",y,"#44546A","#5B9BD5","#ED7D31","#A5A5A5","#FFC000","#4472C4","#70AD47","#0563C1","#954F72"),e.Apex=new g("Apex",v,"#C9C2D1",y,"#69676D","#CEB966","#9CB084","#6BB1C9","#6585CF","#7E6BC9","#A379BB","#410082","#932968"),e.Aspect=new g("Aspect",v,"#E3DED1",y,"#323232","#F07F09","#9F2936","#1B587C","#4E8542","#604878","#C19859","#6B9F25","#B26B02"),e.Concourse=new g("Concourse",v,"#DEF5FA",y,"#464646","#2DA2BF","#DA1F28","#EB641B","#39639D","#474B78","#7D3C4A","#FF8119","#44B9E8"),e.Civic=new g("Civic",v,"#C5D1D7",y,"#646B86","#D16349","#CCB400","#8CADAE","#8C7B70","#8FB08C","#D19049","#00A3D6","#694F07"),e.Oriel=new g("Oriel",v,"#FFF39D",y,"#575F6D","#FE8637","#7598D9","#B32C16","#F5CD2D","#AEBAD5","#777C84","#D2611C","#3B435B"),e.Origin=new g("Origin",v,"#DDE9EC",y,"#464653","#727CA3","#9FB8CD","#D2DA7A","#FADA7A","#B88472","#8E736A","#B292CA","#6B5680"),e.Paper=new g("Paper",v,"#FEFAC9",y,"#444D26","#A5B592","#F3A447","#E7BC29","#D092A7","#9C85C0","#809EC2","#8E58B6","#7F6F6F"),e.Solstice=new g("Solstice",v,"#E7DEC9",y,"#4F271C","#3891A7","#FEB80A","#C32D2E","#84AA33","#964305","#475A8D","#8DC765","#AA8A14"),e.Technic=new g("Technic",v,"#D4D2D0",y,"#3B3B3B","#6EA0B0","#CCAF0A","#8D89A4","#748560","#9E9273","#7E848D","#00C8C3","#A116E0"),e.Trek=new g("Trek",v,"#FBEEC9",y,"#4E3B30","#F0A22E","#A5644E","#B58B80","#C3986D","#A19574","#C17529","#AD1F1F","#FFC42F"),e.Urban=new g("Urban",v,"#DEDEDE",y,"#424456","#53548A","#438086","#A04DA3","#C4652D","#8B5D3D","#5C92B5","#67AFBD","#C2A874"),e.Verve=new g("Verve",v,"#D2D2D2",y,"#666666","#FF388C","#E40059","#9C007F","#68007F","#005BD3","#00349E","#17BBFD","#FF79C2"),e.Equity=new g("Equity",v,"#E9E5DC",y,"#696464","#D34817","#9B2D1F","#A28E6A","#956251","#918485","#855D5D","#CC9900","#96A9A9"),e.Flow=new g("Flow",v,"#DBF5F9",y,"#04617B","#0F6FC6","#009DD9","#0BD0D9","#10CF9B","#7CCA62","#A5C249","#E2D700","#85DFD0"),e.Foundry=new g("Foundry",v,"#EAEBDE",y,"#676A55","#72A376","#B0CCB0","#A8CDD7","#C0BEAF","#CEC597","#E8B7B7","#DB5353","#903638"),e.Median=new g("Median",v,"#EBDDC3",y,"#775F55","#94B6D2","#DD8047","#A5AB81","#D8B25C","#7BA79D","#968C8C","#F7B615","#704404"),e.Metro=new g("Metro",v,"#D6ECFF",y,"#4E5B6F","#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8","#1AB39F","#EB8803","#5F7791"),e.Module=new g("Module",v,"#D4D4D6",y,"#5A6378","#F0AD00","#60B5CC","#E66C7D","#6BB76D","#E88651","#C64847","#168BBA","#680000"),e.Opulent=new g("Opulent",v,"#F4E7ED",y,"#B13F9A","#B83D68","#AC66BB","#DE6C36","#F9B639","#CF6DA4","#FA8D3D","#FFDE66","#D490C5"),e}(),t.ThemeColors=b,C=function(){function e(){}return e.Default=new m("Default",b.Default,"Cambria","Calibri"),e.Office=new m("Office",b.Office,"Calibri Light","Calibri"),e.Office2007=new m("Office2007",b.Office2007,"Cambria","Calibri"),e.Apex=new m("Apex",b.Apex,"Lucida Sans","Book Antiqua"),e.Aspect=new m("Aspect",b.Aspect,"Verdana","Verdana"),e.Concourse=new m("Concourse",b.Concourse,"Lucida Sans Unicode","Lucida Sans Unicode"),e.Civic=new m("Civic",b.Civic,"Georgia","Georgia"),e.Oriel=new m("Oriel",b.Oriel,"Century Schoolbook","Century Schoolbook"),e.Origin=new m("Origin",b.Origin,"Bookman Old Style",c),e.Paper=new m("Paper",b.Paper,"Constantia","Constantia"),e.Solstice=new m("Solstice",b.Solstice,c,c),e.Technic=new m("Technic",b.Technic,f,"Arial"),e.Trek=new m("Trek",b.Trek,"Franklin Gothic Medium",f),e.Urban=new m("Urban",b.Urban,h,"Georgia"),e.Verve=new m("Verve",b.Verve,"Century Gothic","Century Gothic"),e.Equity=new m("Equity",b.Equity,f,"Perpetua"),e.Flow=new m("Flow",b.Flow,"Calibri","Constantia"),e.Foundry=new m("Foundry",b.Foundry,"Rockwell","Rockwell"),e.Median=new m("Median",b.Median,"Tw Cen MT","Tw Cen MT"),e.Metro=new m("Metro",b.Metro,"Consolas","Corbel"),e.Module=new m("Module",b.Module,"Corbel","Corbel"),e.Opulent=new m("Opulent",b.Opulent,h,h),e}(),t.Themes=C},"./dist/core/workbook/sheettab.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("./dist/core/util/common.js"),i=n("./dist/core/worksheet/stylehelper.js"),a=n("./dist/core/workbook/sheettabbase.js"),s=n("./dist/core/core.enum.js"),l=o.Common.pc,u=l.ic,c=l.ec,f=null,h=function(e){function t(t){var n=e.call(this,t)||this,o=n;return o.EC=13,o.GC=12,o.HC=0,o.kw=30,o.IC=28,o.JC=28,o.KC=28,o.LC=0,o._font="10pt Segoe UI",n}return p(t,e),t.prototype.NC=function(){var e=this.OC,t=e&&e.options;return t&&t.tabNavigationVisible?this.IC*(t.useTouchLayout?1.5:1):0},t.prototype.PC=function(){var e=this.OC;return e&&e.options.tabNavigationVisible?e.Jv():0},t.prototype.QC=function(){return this.JC},t.prototype.RC=function(){return this.SC?0:this.JC},t.prototype.TC=function(){return this.SC?0:this.KC},t.prototype.UC=function(){var e,t,n=this,o=n.OC.sheets,r=n.VC(),i=n.WC,a=n.Dr(),s=a.x+a.width-n.kw-n.TC()-n.RC();for(e=n.gq,t=o.length;e<t;e++)if(o[e].visible()&&(r+=i[e]),r>s){r=s;break}return r},t.prototype.VC=function(){var e=this;return 2*e.NC()+e.QC()+e.XC()},t.prototype.XC=function(){var e=this.OC;return e&&e.options.tabNavigationVisible?this.kw/2:0},t.prototype.getResizeBarBounds=function(){var e=this,t=e.Dr();return{x:t.x+t.width-e.kw,y:f,width:e.kw,height:f}},t.prototype.getNavButtonBounds=function(){return{x:this.kw/2,y:f,width:this.NC(),height:f,endIndex:3,startIndex:1}},t.prototype.getSheetTabBounds=function(){var e=this,t=e.Dr(),n=e.RC();return{x:e.VC(),y:f,height:f,secondMoreTabWidth:e.RC(),moreTabPos:t.x+t.width-e.kw-e.TC()-n}},t.prototype.getPreMoreTabBounds=function(){var e=this;return{x:e.VC()-e.QC(),width:e.QC()}},t.prototype.YC=function(){var e=this;return e.ZC+e.WC[e.$C]>e._C()},t.prototype._C=function(){var e=this;return e.Dr().width-e.kw-e.TC()-e.RC()},t.prototype.aD=function(){return 6},t.prototype.Via=function(){return["blank","nextButton"]},t.prototype.cD=function(){return this.VC()},t.prototype.dD=function(e,t){e.save(),e.beginPath();var n=r.Im.Km(0,"gc-tabStripBackground");this.eD=c(n.backgroundColor),e.fillStyle=n.backgroundColor,e.fillRect(t.x,t.y,t.width,t.height),e.beginPath(),e.strokeStyle=n.borderTopColor,e.moveTo(t.x,t.y+.5),e.lineTo(t.x+t.width,t.y+.5),e.stroke(),e.restore()},t.prototype.fD=function(e,t,n,o){var r,i,a=this,s=a.OC.options.newTabVisible,l=a.IC,u=a.RC();n+=u,a.KC=s?l:0,n>(r=t.x+t.width-a.kw-a.TC())&&(n=r,(i=r-u)<o&&(n=(i=o)+l),a.gD(e,i,0,u,t.height)),s&&a.hD(e,n,0,l,t.height,-2===a.iD)},t.prototype.jD=function(e,t,n,o){var r=this.QC();this.gD(e,o-r,0,r,t.height)},t.prototype.kD=function(e,t,n){var o=this,r=o.NC(),i=o.PC(),a=o.kw/2+r/2,s=i/2,l=o.lD;o.mD(e,a,s,a+5,s+5,a+5,s-5,!0,f,1===l),a+=r,o.mD(e,a,s,a-5,s+5,a-5,s-5,!1,f,2===l)},t.prototype.nD=function(e,t){var n,o,i=this.kw,a=r.Im.Km(0,"gc-tabStripResizeBarInner");this.OC.options.showHorizontalScrollbar&&(e.beginPath(),e.rect(t.x+t.width-i,0,i,t.height),e.clip(),n=t.x+t.width-i/2,o=t.y+t.height/2,e.fillStyle=a.color,e.fillRect(n,o,2,2),e.fillRect(n,o-4,2,2),e.fillRect(n,o+4,2,2))},t.prototype.oD=function(e,t,n,o,a,l,u,c,f,h){var p,d,g,m,y,v=this,b=s.VisualState.normal;c&&(b=s.VisualState.hover),h&&(b=s.VisualState.selected),u&&(b=s.VisualState.active),u&&!h&&(b=s.VisualState.activeNotSelected),p=r.Im.Km(b,"gc-tab-"+r.Im.Jm(b)),d=r.Im.Km(0,"gc-tab-"+r.Im.Jm(0)),e.save(),u&&h&&(e.fillStyle="white",e.fillRect(t,n,o,a-4)),h?(e.fillStyle="white",e.fillRect(t,n+1,o,a-4)):u&&(e.fillStyle="white",e.fillRect(t,n,o,1)),g=v.pD(e,u,f,p),e.fillStyle=g,e.fillRect(t+3,n+3,o-6+1,a-6),e.beginPath(),e.lineWidth=1,e.strokeStyle=d&&d.borderLeftColor,u?(e.moveTo(t+.5,n),e.lineTo(t+.5,n+a-4),e.moveTo(t+o+.5,n),e.lineTo(t+o+.5,n+a-4)):(e.moveTo(t+.5,n+4),e.lineTo(t+.5,n+a-4),e.moveTo(t+o+.5,n+4),e.lineTo(t+o+.5,n+a-4)),e.stroke(),h&&(e.beginPath(),e.strokeStyle=p&&p.borderBottomColor,e.lineWidth=2,e.moveTo(t,n+a-4),e.lineTo(t+o+1,n+a-4),e.stroke()),e.textBaseline="top","string"==typeof g&&(m=g),e.fillStyle=v.qD(p,m),(c||u||h)&&(e.font=i.To.Ro(e.font,"bold")),y=v.EC,e.textBaseline="middle",e.fillText(f,t+y,n+a/2-1),e.restore()},t.prototype.mD=function(e,t,n,o,i,a,l,u,c,f){var h,p,d,g;e.save(),h=this,p=s.VisualState.highlight,f&&(p=s.VisualState.hover),u?(t-=2,o-=2,-1===h.rw(h.gq)&&(p=s.VisualState.normal)):(t+=2,o+=2,-1===h.rD(h.sD())&&(p=s.VisualState.normal)),d=r.Im.Km(p,"gc-navButton-"+r.Im.Jm(p)),e.strokeStyle=this.tD(d.borderTopColor),e.beginPath(),g=1,t>o&&(g=-1),e.moveTo(t-.5,n),e.lineTo(t-.5,n+1),e.moveTo(t+g-.5,n-1),e.lineTo(t+g-.5,n+2),e.moveTo(t+2*g-.5,n-2),e.lineTo(t+2*g-.5,n+3),e.moveTo(t+3*g-.5,n-3),e.lineTo(t+3*g-.5,n+4),e.stroke(),e.restore()},t.prototype.hD=function(e,t,n,o,i,a){var l,u,c;e.save(),e.beginPath(),l=(i-14)/2,u=s.VisualState.highlight,a&&(u=s.VisualState.hover),c=r.Im.Km(u,"gc-tabStripNewTab-"+r.Im.Jm(u)),e.lineWidth=1.5,e.strokeStyle=this.tD(c.borderTopColor),e.arc(t+o/2,n+i/2,l,0,2*Math.PI),e.stroke(),e.beginPath(),e.lineWidth=2,e.moveTo(t+o/2-4,n+i/2),e.lineTo(t+o/2+4,n+i/2),e.moveTo(t+o/2,n+i/2-4),e.lineTo(t+o/2,n+i/2+4),e.stroke(),e.restore()},t.prototype.gD=function(e,t,n,o,i){var a,l,u;e.save(),e.beginPath(),a=s.VisualState.highlight,5!==(l=this.lD)&&6!==l||(a=s.VisualState.hover),u=r.Im.Km(a,"gc-navMoreButton-"+r.Im.Jm(a)),e.fillStyle=this.tD(u.borderTopColor),e.fillRect(t+o/2,n+i/2,2,2),e.fillRect(t+o/2-4,n+i/2,2,2),e.fillRect(t+o/2+4,n+i/2,2,2),e.restore()},t.prototype.tD=function(e){var t=c(e),n=this.eD;return t.a<=.01?u(n):l.hc(n,t)?u(t):e},t}(a.DC),t.iv=h},"./dist/core/workbook/sheettab2007.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/core.ns.js"),r=n("@grapecity/js-sheets-common"),i=n("./dist/core/util/common.js"),a=n("./dist/core/workbook/sheettabbase.js"),s=n("./dist/core/worksheet/stylehelper.js"),l=i.Ul.wl,u=null,c=Math.min,f="#92A5C7",h=new r.Common.ResourceManager(o.SR),p=h.getResource.bind(h),d=function(e){function t(t){var n=e.call(this,t)||this,o=n;return o.EC=12,o.GC=8,o.HC=3,o.kw=12,o.KC=48,o.LC=5,o._font="10pt Arial",n}return g(t,e),t.prototype.NC=function(){var e=this.OC,t=e&&e.options;return t&&t.tabNavigationVisible?e.Wv()*(t.useTouchLayout?2:1):0},t.prototype.PC=function(){var e=this.OC;return e&&e.options.tabNavigationVisible?e.Wv():0},t.prototype.VC=function(){return 4*this.NC()+this.lE()},t.prototype.lE=function(){var e=this.OC;return e&&e.options.tabNavigationVisible?2:0},t.prototype.getResizeBarBounds=function(){var e=this,t=e.Dr();return{x:t.x+t.width-e.kw,y:u,width:e.kw,height:u}},t.prototype.getNavButtonBounds=function(){return{x:0,y:u,width:this.NC(),height:u,endIndex:4,startIndex:0}},t.prototype.getSheetTabBounds=function(){return{x:this.VC(),y:u,height:u,secondMoreTabWidth:0,moreTabPos:0}},t.prototype.getPreMoreTabBounds=function(){var e=this;return{x:e.VC(),width:e.HC+e.LC}},t.prototype.YC=function(){var e=this;return e.ZC+e.WC[e.$C]+e.TC()>e._C()},t.prototype._C=function(){return this.Dr().width-this.kw},t.prototype.aD=function(){return 1},t.prototype.Via=function(){return["newSheet"]},t.prototype.cD=function(){var e=this,t=e.VC()+e.Dr().height;return e.OC.options.newTabVisible&&(t+=e.TC(),t+=e.HC),t},t.prototype.dD=function(e,t){var n,o,r,a,s,u,c,f;if(e.save(),e.beginPath(),n=e.createLinearGradient(t.x,t.y,t.width,t.height),r=(o=i.Im.Km(0,"gc-tabStripBackground"))&&o.backgroundImage,a=o&&o.backgroundColor,r&&-1!==r.indexOf("linear-gradient"))for(u=0,c=(s=l(r)).length;u<c;u++)f=s[u],n.addColorStop(f.point,f.color);else a&&(n.addColorStop(0,"#DDDDDD"),n.addColorStop(1,a));e.fillStyle=n,e.fillRect(t.x,t.y,t.width,t.height),e.restore()},t.prototype.fD=function(e,t,n,o){var r=this,i=r.OC,a=p().NewTab;i.options.newTabVisible&&(r.KC=e.measureText(a).width+r.EC,r.oD(e,n,0,r.TC(),t.height,5,!1,-2===r.iD,a,!1))},t.prototype.jD=function(e,t,n,o){var r=this,i=n-1,a=r.WC[i];r.oD(e,o+r.LC-a-r.HC,0,a,t.height,5,r.$C===i,r.iD===i,"",!1)},t.prototype.kD=function(e,t,n){var o,r,i,a,s=this;e.fillStyle=f,e.fillRect(t.x,t.y,n-1,t.height),r=(o=s.NC())/2,i=s.PC()/2,a=s.lD,s.mD(e,r,i,r+5,i+5,r+5,i-5,!0,r-5,0===a),r+=o,s.mD(e,r,i,r+5,i+5,r+5,i-5,!0,u,1===a),r+=o,s.mD(e,r,i,r-5,i+5,r-5,i-5,!1,u,2===a),r+=o,s.mD(e,r,i,r-5,i+5,r-5,i-5,!1,r+4,3===a)},t.prototype.nD=function(e,t){var n,o=this.OC,r=this.kw,a=i.Im.Km,s=a(4,"gc-tabStripResizeBarInner"),l=a(0,"gc-tabStripResizeBarOuter");o.options.showHorizontalScrollbar&&(n=t.x+t.width-r,e.fillStyle=l.backgroundColor,e.fillRect(n,t.y,r,t.height),e.fillStyle=s.backgroundColor,e.fillRect(n+1,t.y+1,r-2,t.height-2),e.fillStyle=s.color,e.fillRect(n+r/2-1,t.y+4,2,t.height-8))},t.prototype.oD=function(e,t,n,o,r,a,l,u,c,h){var p,d,g,m,y,v;e.save(),e.beginPath(),e.moveTo(t,n),e.lineTo(t,n+r-a),e.arcTo(t,n+r,t+o,n+r,a),e.lineTo(t+o,n+r),e.lineTo(t+o+r,n),l||e.lineTo(t,n),p=this,d=0,(u||h)&&(d=4),g=i.Im.Km(d,"gc-tab-"+i.Im.Jm(d)),m=p.pD(e,h||u,c,g),e.fillStyle=m,e.fill(),e.strokeStyle=f,e.stroke(),e.textBaseline="top","string"==typeof m&&(y=m),e.fillStyle=p.qD(g,y),l&&(e.font=s.To.Ro(e.font,"bold")),v=p.EC,e.textBaseline="middle",e.fillText(c,t+v,n+r/2),e.restore()},t.prototype.mD=function(e,t,n,o,r,a,s,f,h,p){var d,g,m,y,v,b,C,w,x,A,M,S;if(e.save(),this,d=this.Dr(),g=this.NC(),y=(m=i.Im.Km)(4,"gc-navButton-hover"),b=(v=m(0,"gc-navButton-normal"))&&v.backgroundColor,p)e.fillStyle=y.backgroundColor,e.fillRect(t-g/2+2,d.y+2,g-4,d.height-4);else{if((C=v&&v.backgroundImage)&&-1!==C.indexOf("linear-gradient")){for(w=e.createLinearGradient(d.x+.7*d.height,d.y+0,.7*d.height,d.height),A=0,M=(x=l(C)).length;A<M;A++)S=x[A],w.addColorStop(S.point,S.color);e.fillStyle=w}else b&&(e.fillStyle=b);e.fillRect(t-g/2,d.y+1,g,d.height-2)}e.fillStyle=p?y.color:v.color,void 0!==h&&h!==u&&e.fillRect(h,c(r,s),1,Math.max(r,s)-c(r,s)),f?(t-=2,o-=2,a-=2):(t+=2,o+=2,a+=2),e.beginPath(),e.moveTo(t,n),e.lineTo(o,r),e.lineTo(a,s),e.lineTo(t,n),e.fill(),e.restore()},t}(a.DC),t.jv=d},"./dist/core/workbook/sheettabbase.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q;function Y(e,t,n){e.Wq(a.Events.SheetTabClick,{sheet:t,sheetName:t?t.name():y,sheetTabIndex:h(n)?-1:n})}function K(e,t){e.Wq(a.Events.SheetMoving,t)}function $(e,t,n,o){e.Wq(a.Events.SheetMoved,{sheet:t,sheetName:t?t.name():y,oldIndex:n,newIndex:o})}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/core.ns.js"),r=n("@grapecity/js-sheets-common"),i=n("./dist/core/util/domUtil.js"),a=n("./dist/core/util/common.js"),s=n("./dist/core/worksheet/stylehelper.js"),l=n("./dist/core/core.enum.js"),u=r.Common.pc,c=a.Ul.wl,f=a.Ul.bq,h=r.Common.j.Fa,p=a.Ul.Nl,d=a.Ul.lZa,g=window,m=document,y=null,v=Math.max,b=Math.min,C=Math.pow,w="px",x="none",M="mousedown"+(A=".gcTab"),S="mousemove"+A,T="mouseup"+A,N="mouseout"+A,I="dblclick"+A,k="mousemove"+(R=".spliter"),E="mouseup"+R,j="keydown"+(D=".tabNameEditor"),_="focus"+D,O="blur"+D,F="canvas",P="2d",H="resize",B="navButton",L="tab",z="newSheet",V="blank",G="black",W="white",U="navButton",Z="sheetTab",q=new r.Common.ResourceManager(o.SR),J=q.getResource.bind(q),Q=function(){function e(e){this.Cj=e,this.SC=!1,this.LC=0,this.HC=0,this.buffer=null;var t=this;t.OC=y,t.$C=0,t.gq=0,t.ZC=70,t.lD=-1,t.iD=-1,t._font="",t.WC=[],t.uD=-1,t.vD=-1,t.wD=y,t.xD=0,t.Us(new a.Rect(0,0,200,28))}return e.prototype.ws=function(t){var n,o=this;o.Xs&&o.no(!0),n=p(F),a.En.Kn(n,o.OC),n.setAttribute("id",o.Cj),o.yD=o.zD(),t.appendChild(o.yD[0]),t.appendChild(n),o.Xs=n,i.GC$(n).bind(M,(function(e){return o.AD(e)})).bind(S,(function(e){return o.BD(e)})).bind(T,(function(e){return o.CD(e)})).bind(N,(function(e){return o.DD(e)})).bind(I,(function(e){return o.ED(e)})),o.fq(),e.ao(o,"setHost")},e.prototype.Yv=function(e){var t=e.options.font;this.OC=e,e&&t&&t.length>0&&(this._font=t)},e.prototype.RIc=function(e){this.fw(),this.SIc(e),this.gw()},e.prototype.SIc=function(e){var t,n=this,o=-1,r=n.sD();if(!(r.length<=0))for(;;){if(o===(t=n.TIc().tabsInfo)[0].index)return;if(o=t[0].index,t[0].index>e)n.$D(r);else{if(!(t[t.length-1].index<e||t[t.length-1].index===e&&t.length>1))return;n._D(r)}}},e.prototype.Dr=function(){var e=this.Zs;return new a.Rect(e.x,e.y,e.width,e.height)},e.prototype.Us=function(e){var t=this.Zs=new a.Rect(0,0,0,0);t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height},e.prototype.TC=function(){return this.KC},e.prototype.UC=function(){var e=this.Dr();return e.x+e.width-this.kw},e.prototype.VC=function(){return 0},e.prototype.fq=function(){var e,t,n,o,r=this,s=r.Ws();s&&s.parentNode&&(0!==(e=i.GC$(s.parentNode)).width()&&0!==e.height()&&(t=v(e.width(),0),n=v(e.height(),0),s.style.display=x,s.width=t,s.height=n,s.style.display="",s.style.width=t+w,s.style.height=n+w,t=s.clientWidth||s.width,n=s.clientHeight||s.height,o=r.Dr(),r.Us(new a.Rect(o.x,o.y,t,n)),a.En.Pn(s,t,n),r.repaint()))},e.prototype.YC=function(){return!1},e.prototype._C=function(){return 0},e.prototype.aD=function(){return 0},e.prototype.Via=function(){return[]},e.prototype.cD=function(){return 0},e.prototype.zD=function(){var e="transparent";return i.GC$(p("div")).css({position:"absolute","border-style":"solid","border-color":G,"border-width":4+w,display:"none",width:0,"border-bottom":0,"border-left-color":e,"border-right-color":e})},e.prototype.no=function(t){var n,o=this,r=o.Xs;r&&(n=r.parentNode,i.GC$(r).unbind(M).unbind(S).unbind(T).unbind(I).unbind(N),n&&n.removeChild(r)),i.GC$(o.yD).remove(),e.ao(o,"dispose"),t||(o.OC=y)},e.prototype.hitTest=function(e,t){var n,o,r,i,a,s,u,c,f,h,p,d,g,m,y=this,v=y.OC,b=v.options.scrollbarAppearance===l.ScrollbarAppearance.mobile,C=y.Dr(),w=y.getResizeBarBounds();if(v.options.showHorizontalScrollbar&&!b&&e>w.x&&e<C.x+C.width)return{type:"resize",element:H};for(o=-1,r=(n=y.getNavButtonBounds()).startIndex,i=n.x,a=n.endIndex,s=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],u=r;u<a;u++){if(i<e&&e<i+n.width){o=u,B=s[u];break}i+=n.width}if(-1!==o)return{type:U,element:B,index:u};if(i=(c=y.getPreMoreTabBounds()).x,f=0,-1!==y.rw(y.gq)){if(i<=e&&e<i+c.width)return{type:U,element:B=s[5],index:5,position:i};f=y.LC}if(h=y.getSheetTabBounds(),p=v.sheets,d=y.WC,g=y.HC,m=0,i=h.x+f,y.gq>-1)for(u=y.gq;u<p.length&&u<d.length;u++)if(p[u].visible()){if(m=d[u],i<e&&e<i+m+g){if(h.moreTabPos>0&&e<h.moreTabPos)return{type:Z,element:L,index:u,position:i};if(0===h.moreTabPos)return{type:Z,element:L,index:u,position:i}}i+=m+g}if(i>h.moreTabPos&&h.moreTabPos>0&&(i=h.moreTabPos),-1!==y.rD(y.sD())){if(i<e&&e<i+h.secondMoreTabWidth)return B=s[6],{type:U,element:s[6],index:6,position:i}}else if(i<e&&e<i+h.secondMoreTabWidth)return{element:V,position:i};return i+=h.secondMoreTabWidth,v.options.newTabVisible&&i<e&&e<i+y.TC()?{type:Z,element:z,position:i,index:-1}:{element:V}},e.prototype.AD=function(t){var n,o,r,a,s,l,u,c=this,f={e:t,r:y};return e.ao(c,"preProcessMouseDown",f),h(n=f.r)?(o=i.GC$(c.Ws()).offset(),r=t.pageX-o.left,a=t.pageY-o.top,s=c.OC.getActiveSheet(),c.FD&&c.GD(s,!1),u=(l=c.hitTest(r,a)).element,0===t.button&&(u===H?(c.HD=!0,c.ID=t.pageX,c.tC()):u===B?c.JD(l.index):u===L?(c.KD(l.index,l.position,t),c.LD(t,l)):u===z&&c.MD(l.position),(s=c.OC.getActiveSheet())&&s._eventHandler&&!s.isEditing()&&s.zt()),c.ND=!0,!1):n},e.prototype.BD=function(t){var n,o,r,a,s,l,u,c,f,p,d,g,m,v=this,b=v.OC,w={e:t,r:y};if(e.ao(v,"preProcessMouseMove",w),!h(n=w.r))return n;if(o=v.Xs.style,r="default",a="w-resize",v.OD&&!v.PD&&(Math.sqrt(C(v.OD.x-t.pageX,2)+C(v.OD.y-t.pageY,2))>10&&(v.PD=!0)),v.HD)o.cursor=a,s=t.pageX-v.ID,l=v.OC.xs.clientWidth,b.options.tabStripRatio=b.Iv()+s/l,u=v.kw/l,1,b.Iv()<u?(b.options.tabStripRatio=u,v.ID=v.kw):b.Iv()>=1?(b.options.tabStripRatio=1,v.ID=l):v.ID=t.pageX,b.aq();else if(v.PD)v.QD(t.pageX,t.pageY),v.RD(t);else{if(v.lD=-1,v.iD=-1,c=i.GC$(v.Ws()).offset(),f=t.pageX-c.left,p=t.pageY-c.top,g=(d=v.hitTest(f,p)).element,v.OC&&v.OC.options.enableAccessibility&&(m=v.cgc(d),v.OC.dgc(m)),""===g)return o.cursor=r,v.repaint(),!1;g===H?o.cursor=a:(o.cursor=r,g===B?v.lD=d.index:g===L?v.iD=d.index:g===z&&(v.iD=-2)),v.repaint()}return!1},e.prototype.cgc=function(e){var t=J(),n="",o=e.element;return o===H?n=t.ARIA_Resize:o===B?n={first:t.ARIA_First,prevArrow:t.ARIA_PreviousArrow,nextArrow:t.ARIA_NextArrow,last:t.ARIA_Last,prevButton:t.ARIA_PreviousButton,nextButton:t.ARIA_NextButton}[B]||"":o===L?n=t.ARIA_SheetTab+" "+this.OC.getSheet(e.index).name().replace(/([0-9]+)/," $1 "):o===z?n=t.ARIA_NewSheet:o===V&&(n=t.ARIA_Blank),n},e.prototype.CD=function(t){var n,o=this,r={e:t,r:y};return e.ao(o,"preProcessMouseUp",r),h(n=r.r)?(o.HD&&(o.HD=!1,o.OC.aq()),o.SD(),o.PD&&(o.PD=!1,o.TD.remove(),o.UD(),o.yD.hide()),o.OD=y,o.VD(),o.uC(),!o.ND||(o.ND=!1,!1)):n},e.prototype.DD=function(t){var n,o,r,i=this,a={e:t,r:y};return e.ao(i,"preProcessMouseOut",a),h(n=a.r)?(i.VD(),o=i.lD,i.lD=-1,r=i.iD,i.iD=-1,i.lD===o&&i.iD===r||i.repaint(),!1):n},e.prototype.tC=function(){var e,t=this;t.WD||(i.GC$(m).bind(k,(function(e){t.BD(e)})).bind(E,(function(e){t.CD(e)})),(e=t.OC.getActiveSheet())&&(e.XD=!0),t.WD=!0)},e.prototype.uC=function(){if(this.WD){this.WD=!1,i.GC$(m).unbind(k).unbind(E);var e=this.OC.getActiveSheet();e&&delete e.XD}},e.prototype.JD=function(e,t){var n,o=this;o.VD(),(n=o.sD()).length<=0||(200,0===(e%=4)?o.YD(n):1===e?(t||(o.ZD=g.setTimeout((function(){o.JD(1)}),200)),o.$D(n)):2===e?(t||(o.ZD=g.setTimeout((function(){o.JD(2)}),200)),o._D(n)):3===e&&o.aE(n))},e.prototype.KD=function(e,t,n){var o,r,i,a=this,s=a.OC;a.$C=e,a.ZC=t,s.suspendPaint(),o=s.getActiveSheet(),(r=s.getSheet(e))&&r.isEditing()&&r!==o&&(i=o&&o._formulaTextBox&&o._formulaTextBox._isSelectMode,!r._endEditImp(void 0,void 0,i))||(Y(s,r,e),a.iw(e,n),s.resumePaint(),a.repaint())},e.prototype.BHb=function(e,t,n,o,r,i){var s={oldValue:n,newValue:o,sheetName:r,propertyName:"isSelected",cancel:!1,sheetIndex:i};e.Wq(a.Events.SheetChanging,s),s.cancel||(t._modelManager.CHb(o),e&&e.hq&&e.hq.repaint(),delete s.cancel,e.Wq(a.Events.SheetChanged,s))},e.prototype.MD=function(e){var t,n,o,r,i=this,s=i.OC,l=s.getActiveSheet();if((!i.bE||i.bE(l))&&(Y(s,y,y),t=s.sheets.length,n=s.vv(s._getDefaultSheetName(t)),s.sheets.forEach((function(e){e.DHb(!1,!0)})),r={sheetName:o=n.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:t},i.BHb(s,n,!1,!0,o,t),s.Wq(a.Events.SheetChanging,r),!r.cancel)){for(s.ow(t,1,n),s.Wq(a.Events.SheetChanged,{sheetName:n.name(),propertyName:"insertSheet",sheetIndex:t}),i.$C=t,i.ZC=e,s.dq(t,1,!1,!0);i.$C>i.gq&&(i.YC()||i.gq<i.jw(-1));)i.hE(i.gq)&&(i.ZC-=i.WC[i.gq]),i.gq++;i.repaint()}},e.prototype.iw=function(e,t){var n,o,r,i,s,l,u,c=this,f=c.OC,h=f.sheets,p=f.getActiveSheet(),d=!1;p&&p._formulaTextBox&&p._formulaTextBox._isSelectMode&&(d=!0),!!t&&(n=a.Ul.sl()?t.metaKey:t.ctrlKey,o=t.shiftKey),e!==f.eq?(n?(i=(r=h[e]).name(),r.DHb()?c.BHb(f,r,!0,!1,i,e):(c.BHb(f,r,!1,!0,i,e),p.DHb()||(i=p.name(),c.BHb(f,p,!1,!0,i,e)))):o?(s=h.slice(b(f.eq,e),v(f.eq,e)+1),h.forEach((function(e){var t=e.name();e.visible()&&(-1!==s.indexOf(e)?e.DHb()||c.BHb(f,e,!1,!0,t,f.getSheetIndex(t)):e.DHb()&&c.BHb(f,e,!0,!1,t,f.getSheetIndex(t)))}))):(l=h.every((function(e){return!e.visible()||e.isSelected()})),h[e].DHb()&&!l||h.forEach((function(e){e.DHb(!1,!0)})),i=(r=h[e]).name(),r.DHb()||c.BHb(f,r,!1,!0,i,e),f.dq(e,1,d,!0)),u=c.jw(c.gq),c.$C>c.gq&&c.ZC+c.WC[c.$C]>c._C()&&-1!==u&&(c.gq=u)):o&&h.forEach((function(t){var n=t.name();f.getSheetIndex(n)!==f.eq&&t.DHb()&&t.visible()&&c.BHb(f,t,!0,!1,n,e)})),c.$C<c.gq&&(c.gq=c.rw(c.gq))},e.prototype.cE=function(e,t){var n,o,r,s,l,u,c,f,h,d=this,g=d.OC,m=d.hitTest(e,t);if(m.element===L){if(n=d.$C,o=g.sheets[n],m.index!==n)return;if(g.Wq(a.Events.SheetTabDoubleClick,{sheet:o,sheetName:o.name(),sheetTabIndex:n}),!g.options.tabEditable)return!1;if((r=a.Vl.Xl())&&r.endEdit&&!r.endEdit())return;a.Vl.Zl(y),s=d.WC[n],l=i.GC$(d.Ws()).offset(),u=g.xv(),c=i.GC$(u).offset(),h=(f=p("input")).style,f.type="text",f.value=o.name(),f.setAttribute("contentEditable","true"),f.setAttribute("autocomplete","off"),h.position="absolute",h.margin="0px",h.padding="0px",h.left=l.left-c.left+d.ZC+d.EC+w,h.top=l.top-c.top+d.aD()+w,h.width=s-d.EC-d.GC+2+w,h.backgroundColor=W,h.borderWidth="0px",h.outline=x,i.GC$(f).appendTo(u),d.FD=f,i.GC$(f).addClass("gc-sheetTabEditor").bind(j,(function(e){return 13===e.keyCode?(d.GD(o,!1),!1):27===e.keyCode?(d.GD(o,!0),!1):void 0})).bind(_,(function(){f.selectionStart=0,f.selectionEnd=f.value.length})).bind(O,(function(){d.GD(o,!1)})),f.focus()}return!1},e.prototype.ED=function(t){var n,o,r,a,s=this,l={e:t,r:y};return e.ao(s,"preProcessMouseDbClick",l),h(n=l.r)?(o=i.GC$(s.Ws()).offset(),r=t.pageX-o.left,a=t.pageY-o.top,s.cE(r,a)):n},e.prototype.GD=function(e,t){var n,o,r,s,l=this,u=l.FD;u&&(i.GC$(u).unbind(j).unbind(_).unbind(O),n=u.value,!1===t&&(n!==(o=e.name())&&(!h(n)&&""!==n&&f(n,l.OC.sheets,e)?(r={sheet:e,oldValue:o,newValue:n,cancel:!1},e.Wq(a.Events.SheetNameChanging,r),!1===r.cancel&&(e.wu().execute({cmd:"renameSheet",sheetName:o,name:n}),s={sheet:e,oldValue:o,newValue:n},e.Wq(a.Events.SheetNameChanged,s))):e.Wq(a.Events.InvalidOperation,{sheet:e,sheetName:e.name(),invalidType:5,message:J().Exp_SheetNameInvalid}))),u.parentNode.removeChild(u),delete l.FD)},e.prototype.dE=function(){return this.OC.options.allowSheetReorder},e.prototype.LD=function(e,t){var n=this;n.dE()?(n.vD=t.index,n.TD=n.eE(n.vD),n.OD=new a.Point(e.pageX,e.pageY),n.tC()):n.PD=!1},e.prototype.eE=function(e){var t,n,o=this.OC.sheets;if(!(e>=o.length||e<0))return(t=o[e].name())||(t="sheet"),(n=i.GC$(p("span")).text(t).css({position:"absolute",cursor:"default","border-radius":"5px",opacity:".7"})).addClass("ui-widget-header gc-tab-tip-span btn-primary"),n},e.prototype.VD=function(){var e=this.ZD;e&&(clearTimeout(e),this.ZD=y)},e.prototype.QD=function(e,t){var n,o,r=this.TD;r&&0===i.GC$(".gc-tab-tip-span").length&&(r.appendTo(m.body),r.hide()),n=r.width(),o=r.height(),r.css({left:e-n/2,top:t-o/2}),r.show()},e.prototype.RD=function(e){var t=this,n=i.GC$(t.Ws()),o=n.position(),r=n.offset(),a=e.pageX-r.left,s=e.pageY-r.top,l=t.hitTest(a,s),u=l.element,c=t.Dr(),f=t.VC(),p=t.OC.sheets.length,d=c.x+t._C(),m=t.yD;a>d?t.wD===y&&t.uD<p&&(t.wD=g.setInterval((function(){t._D(t.sD()),t.uD===p?(t.SD(),m.css({left:o.left+t.fE()-4,top:o.top-4}),m.show()):(t.uD++,m.hide())}),100)):a<f?t.wD===y&&t.uD>0&&(t.wD=g.setInterval((function(){t.$D(t.sD()),0===t.uD?(t.SD(),m.css({left:o.left+f-4,top:o.top-4}),m.show()):(t.uD--,m.hide())}),100)):(t.SD(),u!==L&&-1===t.Via().indexOf(u)||(u!==L||h(l.index)?t.uD=t.OC.sheets.length:t.uD=l.index,m.css({left:o.left+l.position-4,top:o.top-4}),m.show()))},e.prototype.fE=function(){var e,t=this,n=t.WC,o=t.sD(),r=t.gE(t.gq,o),i=t.VC()+t.LC;for(e=r;e<o.length;e++)i+=n[o[e]],i+=t.HC;return i},e.prototype.SD=function(){var e=this.wD;e&&(clearInterval(e),this.wD=y)},e.prototype.UD=function(){var e,t,n,o,r=this,i=r.OC,a=r.uD,s=r.vD,l=-1,u=i.getActiveSheet(),c=s,f=a;if(s<a-1&&(f=a-1),-1!==a&&-1!==s&&s!==a&&s!==a-1&&r.yD.isVisible()){if(K(i,e={sheet:u,sheetName:u.name(),oldIndex:c,newIndex:f,cancel:!1}),e.cancel)return;if(n=void 0,o=(t=i.sheets)[s],s>a){for(n=s;n>a;n--)t[n]=t[n-1];t[a]=o,l=a}else if(s<a-1){for(n=s;n<a-1;n++)t[n]=t[n+1];t[a-1]=o,l=a-1}i.eq=l,r.fq(),$(i,u,c,f)}},e.prototype.sD=function(){var e,t=[];for(e=0;e<this.OC.sheets.length;e++)this.hE(e)&&t.push(e);return t},e.prototype.YD=function(e){e.length>0&&this.gq!==e[0]&&this.OC.startSheetIndex(e[0])},e.prototype.$D=function(e){var t,n;e.length>0&&((t=this).gq>e[0]&&(-1!==(n=t.rw(t.gq))&&t.OC.startSheetIndex(n)))},e.prototype._D=function(e){var t;e.length>0&&((t=this).gq<e[e.length-1]&&(-1!==t.rD(e)&&t.OC.startSheetIndex(t.jw(t.gq))))},e.prototype.aE=function(e){if(e.length>0&&this.gq<e[e.length-1]){var t=this.rD(e);-1!==t&&this.OC.startSheetIndex(t)}},e.prototype.rD=function(e){var t,n,o,r,i,a,s,l,u;if(e.length>0)for(n=(t=this)._C(),o=0,r=t.WC,i=void 0,void 0,a=t.cD(),-1===(s=t.gE(t.gq,e))&&(s=0),i=e.length-1;i>=s;i--)if(o+=r[e[i]],i!==e.length-1&&(o+=t.HC),l=a+o,0!==i&&(l+=t.LC),l>n)return void 0,u=i+1<e.length?e[i+1]:e[e.length-1],t.gq<u?u:-1;return-1},e.prototype.rw=function(e){var t;for(t=e-1;t>=0;t--)if(this.hE(t))return t;return-1},e.prototype.jw=function(e){var t,n=this.OC.sheets.length;for(t=e+1;t<n;t++)if(this.hE(t))return t;return-1},e.prototype.gE=function(e,t){var n;for(n=0;n<=t.length-1;n++)if(e===t[n])return n;return-1},e.prototype.hE=function(e){var t=this.OC.sheets[e];return t&&t.visible()},e.prototype.fw=function(){this.xD++},e.prototype.gw=function(){var e=this;e.xD--,e.xD<=0&&(e.xD=0,e.repaint())},e.prototype.repaint=function(e){var t=this.Ws();t&&t.getContext&&this.jp(t.getContext(P),e)},e.prototype.jp=function(e,t){var n,o,r,i,s,l,u,c,f,h,d,g,m,C=this;if(!(C.xD>0)){if(n=C.Dr(),o=C.Xs,t){if(t.x>=n.x+n.width)return;if(t.y>=n.y+n.height)return;if(t.x+t.width>n.width&&(t.width=n.width-t.x,t.width<=0))return;if(t.y+t.height>n.height&&(t.height=n.height-t.y,t.height<=0))return;if(t.width<=0||t.height<=0)return}if((i=C.buffer)&&(!i||i.width===o.width&&i.height===o.height)&&(i||i.width===n.width&&i.height===n.height)||(i&&a.En.Rn(C.OC,i),C.buffer=i=p(F),a.En.Kn(i,C.OC),a.En.Pn(i,n.width,n.height)),!(n.width<=0||n.height<=0||t&&(t.width<=0||t.height<=0))){(r=C.buffer.getContext(P)).clearRect(0,0,n.width,n.height),a.Bn.Dn(r,-n.x,-n.y),C.iE(r,t),a.Bn.Dn(r,n.x,n.y),u=s=n.x>=0?0:-n.x,c=l=n.y>=0?0:-n.y,t&&(u=n.x+t.x,c=n.y+t.y,n=new a.Rect(u,c,t.width,t.height)),s=n.x>=0?n.x:0,l=n.y>=0?n.y:0,d=y,g=a.En.Ln(o),m=a.En.Mn(o),o&&1!==g&&(u*=g,c*=m,n.x*=g,n.y*=m,n.width*=g,n.height*=m);try{o?t?(f=v(n.width-u,0),h=v(n.height-c,0)):(f=b(n.width-u,v(o.width-n.x,3)),h=b(n.height-c,v(o.height-n.y,3))):(u=t.x,c=t.y,f=t.width,h=t.height),o?(a.Bn.Cn(e,1,1),e.clearRect(s,l,f,h),e.drawImage(C.buffer,u,c,f,h,s,l,f,h),a.Bn.Cn(e,g,m)):d=(r=C.buffer.getContext(P)).getImageData(u,c,f,h)}catch(e){return}!o&&d&&n.width>0&&n.height>0&&e.putImageData(d,s,l)}}},e.prototype.iE=function(e,t){var n,o,r,i,a,u,c,f,h,p=this,g=p.OC,m=g.options.scrollbarAppearance===l.ScrollbarAppearance.mobile;if(e&&g){for(n=p.Dr(),e.save(),d(e,p._font),t?e.rect(t.x,t.y,t.width,t.height):e.rect(n.x,n.y,n.width,n.height),e.clip(),e.beginPath(),i=r=p.VC(),e.save(),e.font=s.To.Ro(e.font,"bold"),p.WC=[],u=g.sheets,a=0;a<u.length;a++)o=Math.round(e.measureText(u[a].name()).width)+p.GC+p.EC,p.WC.push(o);for(e.restore(),c=[],(f=p.gq)>0&&p.rw(f)>=0&&(i+=p.LC),f<0&&(f=0),a=f;a<u.length&&(h=u[a].visible(),o=p.WC[a],!(i>n.x+n.width));a++)c.push({i:a,x:i,w:o,t:u[a].name(),visible:h}),h&&(i+=o+p.HC);p.dD(e,n),p.fD(e,n,i,r),p.jE(e,n,c,f,r),p.OC&&p.OC.options.tabNavigationVisible&&p.kD(e,n,r),m||p.nD(e,n),e.beginPath(),e.restore()}},e.prototype.dD=function(e,t){},e.prototype.fD=function(e,t,n,o){},e.prototype.TIc=function(){var e,t,n,o=this,r=o.OC.sheets,i=o.Dr(),a=[],s=o.VC(),l=o.gq;for(l>0&&o.rw(l)>=0&&(s+=o.LC),l<0&&(l=0),t=l;t<r.length&&(n=r[t].visible(),e=o.WC[t],!(s>i.x+i.width));t++)a.push({index:t,position:s,width:e,text:r[t].name(),visible:n}),n&&(s+=e+o.HC);return{tabsInfo:a,newTabStartPosition:s}},e.prototype.jE=function(e,t,n,o,r){var i,a,s,l,u,c,f,h=this,p=h.OC,d=p.sheets,g=h.iD;if(h.$C=p.getActiveSheetIndex(),i=h.$C,d.length>0){for(e.save(),e.beginPath(),a=t.x+h._C(),e.rect(r,0,a-r,t.height),e.clip(),s=n.length-1;s>=0;s--)(l=n[s]).i!==i&&l.visible&&(u=p.getSheetFromName(l.t).DHb(),h.oD(e,l.x,0,l.w,t.height,5,!1,l.i===g,l.t,u));c=n[i-o],i>=o&&i<d.length&&c&&c.visible&&(f=p.getActiveSheet().isSelected(),h.oD(e,c.x,0,c.w,t.height,5,!0,!1,c.t,f)),e.restore(),e.save(),e.beginPath(),o>0&&h.rw(o)>=0&&h.jD(e,t,o,r),e.restore()}},e.prototype.jD=function(e,t,n,o){},e.prototype.kD=function(e,t,n){},e.prototype.nD=function(e,t){},e.prototype.mD=function(e,t,n,o,r,i,a,s,l,u){},e.prototype.oD=function(e,t,n,o,r,i,a,s,l,u){},e.prototype.Ws=function(){return this.Xs},e.prototype.kE=function(e,t){var n,o,r,i,s=e.createLinearGradient(t.x,t.y,t.width,t.height),u=a.Im.Km(l.VisualState.normal,"gc-tabStripBackground"),f=u&&u.backgroundImage,h=u&&u.backgroundColor;if(f&&-1!==f.indexOf("linear-gradient"))for(o=0,r=(n=c(f)).length;o<r;o++)i=n[o],s.addColorStop(i.point,i.color);else h&&(s.addColorStop(0,"#DDDDDD"),s.addColorStop(1,h));return s},e.prototype.pD=function(e,t,n,o){var r,i,s,l,u,f,h,p,d,g=this,m=g.Dr(),y=e.createLinearGradient(m.x+.7*m.height,m.y+0,.7*m.height,m.height),v=g.OC.getSheetFromName(n);if(""===n&&g.gq>0&&(v=g.OC.getSheet(g.gq-1)),r=v&&v.options.sheetTabColor)"rgba(0, 0, 0, 0)",e.fillStyle="rgba(0, 0, 0, 0)",i=e.fillStyle,e.fillStyle=a.Rm.Om(v,r),(s=e.fillStyle)!==i&&(t?(y.addColorStop(0,W),y.addColorStop(.45,"#F1F6FD"),y.addColorStop(.9,s),y.addColorStop(1,W)):y=s);else if(o)if(l=o.backgroundImage,u=o.backgroundColor,l&&-1!==l.indexOf("linear-gradient"))for(h=0,p=(f=c(l)).length;h<p;h++)d=f[h],y.addColorStop(d.point,d.color);else u&&y.addColorStop(0,u);return y},e.prototype.qD=function(e,t){var n=G;return e&&(n=e.color),t&&u.dc(u.ec(t))<127.5&&(n=W),n},e}(),t.DC=Q,a.Zn(Q)},"./dist/core/workbook/workbook-json.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y;function v(e,t){return e.hasOwnProperty(t)}function b(e){var t,n,o,r;if(!e||"string"!=typeof e)return 1;if((n=(t=e.split(".")).length)>3)return 3;if(o=y(t[0]),n<=2)return isNaN(o)?1:o;if(r=y(t[1]),o>=10)return o;if(o>=3){if(r>=20143)return 3;if(r>=20142)return 2}return 1}function C(e,t){var n,o,r,i,a=t&&t.frozenColumnsAsRowHeaders,s=t&&t.frozenRowsAsColumnHeaders,l=0,u=e.sheets;if(s||a)for(o in u)"string"==typeof o&&(r=u[o],i=m(r.index)?r.index:r.mi,n=this.sheets[m(i)?i:l],s&&m(r.frozenRowCount)&&(n.$Bb=!0,n.deleteRows(0,r.frozenRowCount)),a&&m(r.frozenColCount)&&n.deleteColumns(0,r.frozenColCount),l++)}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/workbook/workbook.js"),r=n("./dist/core/worksheet/style.js"),i=n("./dist/core/util/domUtil.js"),a=n("./dist/core/util/tasks.js"),s=n("@grapecity/js-sheets-common"),l=n("./dist/core/util/common.js"),u=n("@grapecity/js-calc"),c=!!u,f=r.Style.kxb,h=s.Commands.UndoManager,p=s.Common.CultureManager,d=s.Common.j.C4,g=i.GC$.each,m=l.Ul.Ol,y=parseFloat,o.Workbook.prototype.toJSON=function(e){var t,n,r,a,s,f,h,p,m,y,b,C,w,x,A,M,S,T,N=this,I={version:l.productInfo.productVersion},R=e&&e.rowHeadersAsFrozenColumns,k=e&&e.columnHeadersAsFrozenRows,E=R||k;if(E&&(e.Yec=!0),N.EHb&&(I.docProps=d(N.EHb)),c&&((t=u.Functions.setLanguagepackage)&&(n=t(),t("en"))),(r=N.getSheetCount())!==o.Workbook.nv&&(I.sheetCount=r),E)for((a=new o.Workbook).fromJSON(N.toJSON({includeBindingSource:!0})),N=a,s=0;s<r;s++)h=(f=N.getSheet(s)).getRowCount(1),p=f.getColumnCount(2),y=k&&h>0,(m=R&&p>0)&&f.addColumns(0,p),y&&f.addRows(0,h,y),m&&f.Zec(p,y?h:0),y&&f.$ec(h,m?p:0);for(N.mv=!0,N.suspendPaint(),N.suspendEvent(),c&&((b=N.Wu).calcOnDemand&&(b.calcOnDemand=!1,N.FHb(),b.suspend(!0),b.resume(!0),b.calcOnDemand=!0),b.suspend(!0)),(C=N.startSheetIndex())&&(I.startSheetIndex=C),g(N.options,(function(e,t){"_ps"!==e&&o.Workbook.Qp[e]!==t&&(I[e]=t)})),(w=N.getActiveSheetIndex())!==o.Workbook.ov&&(I.activeSheetIndex=w),x={},A=0;A<r;A++)x[(f=N.getSheet(A)).name()]=f.toJSON(e),x[f.name()].index=A;if(i.GC$.isEmptyObject(x)||(I.sheets=x),M=[],S=N.Lq){for(T in S)v(S,T)&&M.push(S[T]);M.length>0&&(I.namedStyles=M)}return o.Workbook._features&&g(o.Workbook._features,(function(t,n){n.toJson&&n.toJson.call(N,I,e)})),c&&t&&t(n),N.mv=!1,c&&N.Wu.resume(!1),N.resumeEvent(),N.resumePaint(),E&&delete e.Yec,I},o.Workbook.prototype.fromJSON=function(e,t){var n,i,a,s,u,y,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W;if(e){if(t&&t.incrementalLoading)return!0===t.incrementalLoading&&(t.incrementalLoading={}),this.egc(e,t);n=this,i=b(e.version),s={noSchema:a=i<3,version:i},u=l.Vl.Xl(),n.mv=!0,n.suspendPaint(),n.suspendEvent(),y=p.culture(),p.culture("");try{for(S in n.T3(),n.pv=new h(n,-1,n.options.allowUndo),c&&n.qv(!0),c&&n.Wu.suspendAdjust(),n._availableSheetIndex=-1,n.clearSheets(),w=n.options,x=e.canUserEditFormula,m(x)&&(w.allowUserEditFormula=x),A=e.allowDragDrop,m(A)&&(w.allowUserDragDrop=A),M=e.allowDragFill,m(M)&&(w.allowUserDragFill=M),w)v(w,S)&&(T=e[S],m(T)&&(w[S]=T));if(n.EHb=d(e.docProps),o.Workbook._features&&g(o.Workbook._features,(function(o,r){var i=r.preFromJson;i&&i.call(n,e,a,t)})),N=e.sheetCount,m(N)||(N=o.Workbook.nv),n.sw(N,0),n.Lq={},I=e.namedStyles)for(R=0,k=I;R<k.length;R++)E=k[R],D=new r.Style,f(E,n),D.fromJSON(E,a,n),n.Kq(D);if(j=0,void 0,_=e.sheets,O=void 0,F=void 0,P=!1,H=!0,_)for(B in _)"string"==typeof B&&(L=_[B],z=m(L.index)?L.index:L.mi,n.sheets[m(z)?z:j].fromJSON(L,!1,s,t,!0),j++,F=L.allowUndo,P?H=H&&F===O:(O=F,P=!0));m(O)&&H&&(w.allowUndo=O),V=e.activeSheetIndex,m(V)||(V=o.Workbook.ov),n.dq(V,0),(G=n.sheets[V])&&G.DHb(!0,!1),W=e.startSheetIndex,m(W)&&n.startSheetIndex(W),o.Workbook._features&&g(o.Workbook._features,(function(o,r){var i=r.fromJson;i&&i.call(n,e,a,t)})),c&&n.Wu.resumeAdjust(),C.call(n,e,t)}finally{c&&n.Wu.resumeAdjust(),p.culture(y),n.mv=!1,G=n.getActiveSheet(),u&&G&&G.zt(),n.resumeEvent(),n.fq(),n.resumePaint(),G&&n.Wq(l.Events.FormulatextboxActiveSheetChanged,{oldSheet:void 0,newSheet:G})}}},o.Workbook.prototype.egc=function(e,t){var n,i,s,u,y,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z=this;Z.fgc&&Z.fgc.terminate(),Z.fgc=new a.Tasks((function(){var e,t,n,o=Z.getActiveSheet();if(!o.loaded)for(e=this.tasks.length-1;e>=0;e--)if((t=this.tasks[e].args[0])&&t._modelManager&&t.name&&t.name()===o.name())return n=this.tasks[e],this.tasks.splice(e,1),n;return this.tasks.pop()}),(function(){var e=Z.getActiveSheet();return e&&(Z.ku.Gw||e.isEditing()||e._eventHandler._isWorking||e._eventHandler.xG||e._eventHandler.eG)})),n=b(e.version),s={noSchema:i=n<3,version:n},u=l.Vl.Xl(),Z.mv=!0,Z.suspendPaint(),Z.suspendEvent(),y=p.culture(),p.culture("");try{for(S in Z.T3(),Z.pv=new h(Z,-1,Z.options.allowUndo),c&&Z.qv(!0),c&&Z.Wu.suspendAdjust(),Z._availableSheetIndex=-1,Z.clearSheets(),w=Z.options,x=e.canUserEditFormula,m(x)&&(w.allowUserEditFormula=x),A=e.allowDragDrop,m(A)&&(w.allowUserDragDrop=A),M=e.allowDragFill,m(M)&&(w.allowUserDragFill=M),w)v(w,S)&&(T=e[S],m(T)&&(w[S]=T));if(Z.EHb=d(e.docProps),N=e.sheetCount,m(N)||(N=o.Workbook.nv),Z.sw(N,0),Z.Lq={},I=e.namedStyles)for(R=0;R<I.length;R++)k=I[R],E=new r.Style,f(k,Z),E.fromJSON(k,i,Z),Z.Kq(E);if(D=0,_=e.sheets,O=void 0,F=void 0,P=!1,H=!0,_)for(L in B={total:0,valuesLoad:0,formulaLoad:0},D=0,t.incrementLoadTask=Z.fgc,t.incrementalLoading.loadStatus=B,_)"string"==typeof L&&(z=_[L],V=m(z.index)?z.index:z.mi,(j=Z.sheets[m(V)?V:D]).loading=!0,j.cq(z.name+"",!0),j.DHb(z.isSelected),j.setRowCount(z.rowCount),j.setColumnCount(z.columnCount),B.total+=j.getRowCount(),Z.fgc.addTask((function(e,n){e.egc(n,!1,s,t,!0)}),[j,z]),D++,F=z.allowUndo,P?H=H&&F===O:(O=F,P=!0));m(O)&&H&&(w.allowUndo=O),G=e.activeSheetIndex,m(G)||(G=o.Workbook.ov),Z.dq(G,0),(W=Z.sheets[G])&&W.DHb(!0,!1),U=e.startSheetIndex,m(U)&&Z.startSheetIndex(U),Z.fgc.endingCallback=function(){o.Workbook._features&&g(o.Workbook._features,(function(n,o){o.egc?Z.fgc.addTask((function(e,t,n,r){o.egc.call(e,t,n,r)}),[Z,e,i,t]):o.fromJson&&o.fromJson.call(Z,e,i,t)})),Z.fgc.endingCallback=function(){var n,o;for(c&&Z.Wu.resumeAdjust(),C.call(Z,e,t),n=0;n<Z.sheets.length;n++)delete Z.sheets[n].loading;(j=Z.getActiveSheet())&&Z.Wq(l.Events.FormulatextboxActiveSheetChanged,{oldSheet:void 0,newSheet:j}),t&&t.incrementalLoading&&t.incrementalLoading.loading&&t.incrementalLoading.loading(1),(o=t&&t.incrementalLoading&&t.incrementalLoading.loaded)&&o()},Z.fgc.start()},Z.fgc.start()}finally{p.culture(y),Z.mv=!1,W=Z.getActiveSheet(),u&&W&&W.zt(),Z.resumeEvent(),Z.fq(),Z.resumePaint()}}},"./dist/core/workbook/workbook.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe,re,ie,ae,se,le,ue,ce,fe,he,pe,de,ge,me,ye,ve;function be(e){return e.getActiveSheet()}function Ce(e){return s.En.npb()%1!=0||e.zoom()%1!=0}function we(e,t){return k.setTimeout((function(){e.invalidateLayout(),e.repaint(),t.GHb=D}),200)}function xe(e,t,n){var o,r,i=s.Im.Lm("gc-vertical-scrollbar"+ne),l=R(i.zIndex)>2007?1:0,u=t-n;u%2==0?r=(o=u/2)-l:r=o=(u-l)/2,a.GC$(e).css({"box-sizing":te,border:X,"border-color":X,"border-left-style":"solid","border-left-width":l+Y,"border-left-color":i.borderLeftColor,"background-color":i.backgroundColor,width:n,padding:"0px "+o+"px 0px "+r+Y,margin:0})}function Ae(e,t,n){var o,r,i=s.Im.Lm("gc-horizontal-scrollbar"+ne),l=R(i.zIndex)>2007?1:0,u=t-n;u%2==0?r=(o=u/2)-l:r=o=(u-l)/2,a.GC$(e).css({"box-sizing":te,border:X,"border-color":X,"border-top-style":"solid","border-top-width":l+Y,"border-top-color":i.borderTopColor,"background-color":i.backgroundColor,height:n,padding:r+"px 0px "+o+"px 0px",margin:0})}function Me(e,t,n){var o=s.Im.Lm("gc-footer-corner"+ne);a.GC$(e).css({border:X,padding:0,margin:0,width:t+Y,height:n+Y,"background-color":o.backgroundColor})}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/workbook/workbookpanelex.js"),r=n("./dist/core/core.ns.js"),i=n("@grapecity/js-sheets-common"),a=n("./dist/core/util/domUtil.js"),s=n("./dist/core/util/common.js"),l=n("./dist/core/util/imageLoader.js"),u=n("./dist/core/worksheet/worksheet-actions.js"),c=n("./dist/core/workbook/sheettab.js"),f=n("./dist/core/workbook/sheettab2007.js"),h=n("./dist/core/worksheet/stylehelper.js"),p=n("./dist/core/worksheet/clipboardhelper.js"),d=n("./dist/core/worksheet/worksheet.js"),g=!!n("@grapecity/js-calc"),m=n("./dist/core/core.enum.js"),y=i.Common.u,v=i.Commands.UndoManager,b=i.Commands.CommandManager,C=a.GC$.each,w=a.GC$.extend,x=g,A=i.Common.j.Fa,M=s.Ul.Nl,S=s.Ul.Pl,T=s.Ul.Ql,N=s.Ul.hZa,I=i.Common.CultureManager,R=parseInt,parseFloat,k=window,E=document,D=null,j=Math.round,_=Math.min,O=Math.abs,F="number",P="mousedown",H="mousemove",B="mouseup",L="mouseenter",z="mouseleave",V="scroll",G="resize",W="focus",U=".gcSpread",Z=".gcSpreadInternal",q=".gcScrollbar",J="div",Q="table",Y="px",K="gc-scroll-handle",$="gc-scroll-bar",X="none",ee="absolute",te="content-box",ne=" ui-widget-header ui-state-default btn btn-default",oe="gc-scroll-mobile-container",re="gc-scroll-mobile-container-horizontal",ie="gc-scroll-mobile-container-vertical",ae="gc-scroll-mobile-spread-hovering",se="gc-scroll-mobile-state-hide",le="gc-scroll-mobile-state-hover",ue=k.jQuery,ce="cultureChanged",fe="workbook",he="gcUIElement",pe="gc-no-user-select",de=new i.Common.ResourceManager(r.SR),ge=de.getResource.bind(de),me=function(){function e(e){this.yw=e}return e.Lv=function(e,t){var n,o,r,i,a,s,l,u,c,f,h,p,d,g,y,v,b,C,w,x,M,S,T,N=e.data,I=N.ku;if(I.HHb&&(k.clearTimeout(I.HHb),I.HHb=D),(n=be(N))&&t){if(o=n.zoom(),r=t.newValue,i=t.oldValue,a=t.scrollEventType,s=N.options.scrollByPixel,l=N.options.scrollPixel,u=void 0,c=void 0,i=t.oldValue=A(i)?0:s?j(i):R(i+"",10),n.oq=!1,f=n.$t(),h=n.ps(),p=N.options.scrollbarShowMax,d=0,s){for(g=(r=j(r))-i,a!==m.Nxb.thumbTrack&&((r=i+(g*=l*o))<0&&(r=0)),p||(n.oq=!0,a===m.Nxb.smallIncrement&&r===i?r+=l*o:t.ignoreUpdatePosition=!0),b=(v=y=n.frozenColumnCount())+(n.getColumnCount()-n.frozenTrailingColumnCount()-y)-1,C=0,w=0,x=v;x<=b;x++)if((C+=w=n.Tl(x))>=r){d=C-r-w,u=x;break}A(u)&&(u=b,d=-n.Tl(b),r=C)}else u=R(r+"",10),u=n.du(u),a===m.Nxb.largeDecrement||a===m.Nxb.smallDecrement?(a===m.Nxb.largeDecrement&&(u=n.zw()),-1!==(c=n.Ot(u,!0))&&c!==u&&(u=c),p||(n.oq=!0,t.ignoreUpdatePosition=!0)):a!==m.Nxb.largeIncrement&&a!==m.Nxb.smallIncrement||(a===m.Nxb.largeIncrement&&((u=n.Aw())===n.qq&&u++),p||(n.oq=!0,a===m.Nxb.smallIncrement&&r===i&&u++),-1!==(c=n.Ot(u))&&c!==u&&(u=c)),u<f&&(u=f),u>h&&(u=h);M=s?j(r):n.Qt(u),t.newValue!==M&&(t.newValue=M),S=M,0!==(T=n.Tl(u))&&(S+=O(d)/T),t.newValueWithOffset=s?M:S,(i!==M||s)&&N.ku.Bw(u,d,!0)}},e.Mv=function(e){var t,n,o,r=e.data,i=be(r),a=r.Pt;i&&a&&(a.QB===m.ScrollType.pixels||(t=i.du(a.value()),n=i.$t(),o=i.ps(),t<n?a.value(i.Qt(n)):t>o&&a.value(i.Qt(o))),r.xw(),r.options.scrollbarShowMax||(r.ku.scrolling?i.oq=!0:r.Ut()))},e.Nv=function(e){var t,n,o,r,i,s=e.data;s&&((t=be(s))&&((n=s.Pt.xR)&&n.mR&&(t.CH=!0),t.zt(),1!==(o=s.options.showScrollTip)&&3!==o||(i=(r=a.GC$(e.srcElement||e.target)).parent(),(r&&(r.hasClass(K)||r.hasClass($))||i&&(i.hasClass(K)||i.hasClass($)))&&s.ku.Dw(!1,e))))},e.Dv=function(e,t){var n,o,r,i,a,s,l,u,c,f,h,p,d,g,y,v,b,C,w,x,M,S,T,N=e.data,I=N.ku;if(I.HHb&&(k.clearTimeout(I.HHb),I.HHb=D),(n=be(N))&&t){if(o=n.zoom(),r=t.newValue,i=t.oldValue,a=t.scrollEventType,s=N.options.scrollByPixel,l=N.options.scrollPixel,u=void 0,c=void 0,i=t.oldValue=A(i)?0:s?j(i):R(i+"",10),n.jq=!1,f=n._t(),h=n.ns(),p=N.options.scrollbarShowMax,d=0,s){for(g=(r=j(r))-i,a!==m.Nxb.thumbTrack&&((r=i+(g*=l*o))<0&&(r=0)),p||(n.jq=!0,a===m.Nxb.smallIncrement&&r===i?r+=l*o:t.ignoreUpdatePosition=!0),b=(v=y=n.frozenRowCount())+(n.getRowCount()-n.frozenTrailingRowCount()-y)-1,C=0,w=0,x=v;x<=b;x++)if((C+=w=n.Sl(x))>=r){d=C-r-w,u=x;break}A(u)&&(u=b,d=-n.Sl(b),r=C)}else u=R(r+"",10),u=n.cu(u),a===m.Nxb.largeDecrement||a===m.Nxb.smallDecrement?(a===m.Nxb.largeDecrement&&(u=n.Ew()),-1!==(c=n.Rt(u,!0))&&c!==u&&(u=c),p||(n.jq=!0,t.ignoreUpdatePosition=!0)):a!==m.Nxb.largeIncrement&&a!==m.Nxb.smallIncrement||(a===m.Nxb.largeIncrement&&((u=n.Fw())===n.lq&&u++),p||(n.jq=!0,a===m.Nxb.smallIncrement&&r===i&&u++),-1!==(c=n.Rt(u))&&c!==u&&(u=c)),u<f&&(u=f),u>h&&(u=h);M=s?j(r):n.Tt(u),t.newValue!==M&&(t.newValue=M),S=M,0!==(T=n.Sl(u))&&(S+=O(d)/T),t.newValueWithOffset=s?M:S,(i!==M||s)&&N.ku.Bw(u,d)}},e.Ev=function(e){var t,n,o,r=e.data,i=be(r),a=r.St;i&&a&&(a.QB===m.ScrollType.pixels||(t=i.cu(a.value()),n=i._t(),o=i.ns(),t<n?a.value(i.Tt(n)):t>o&&a.value(i.Tt(o))),r.xw(),r.options.scrollbarShowMax||(r.ku.scrolling?i.jq=!0:r.Xt()))},e.Fv=function(e){var t,n,o,r,i,s=e.data;s&&((t=be(s))&&((n=s.St.xR)&&n.mR&&(t.CH=!0),t.zt(),2!==(o=s.options.showScrollTip)&&3!==o||(r=a.GC$(e.srcElement||e.target))&&(i=r.parent(),(r.hasClass(K)||i&&i.hasClass(K)||r.hasClass($)||i&&i.hasClass($))&&s.ku.Dw(!0,e))))},e.Gv=function(e){var t=e.data;t&&t.xw()},e.ggc=function(e){var t,n,o,r=ge(),i=e.data,s=e.scrollbar;i.options.enableAccessibility&&(t=a.GC$(s.Bv()).offset(),n=s.hitTest(e.x-t.left,e.y-t.top),o={thumbButton:r.ARIA_Scrollbar_Thumb_Button,trackButton:r.ARIA_Scrollbar_TRACK_Button,leftButton:r.ARIA_Scrollbar_Left_Button,rightButton:r.ARIA_Scrollbar_Right_Button,upButton:r.ARIA_Scrollbar_Top_Button,downButton:r.ARIA_Scrollbar_Bottom_Button}[n.element],i.dgc(o))},e.prototype.no=function(){this.yw=D},e.prototype.Bw=function(e,t,n){var o=this,r=be(o.yw);r&&(o.Gw=!0,o.Hw=n?r.lq:e,o.bCb=n?r.cCb:t,o.Iw=n?e:r.qq,o.dCb=n?t:r.eCb,k.setTimeout((function(){o.Kw()}),0))},e.prototype.Kw=function(){var e=this;be(e.yw)&&e.Gw&&(e.Gw=!1,e.Lw())},e.prototype.Lw=function(){var e,t,n,o,r,i,a,s=this;s.Mw||(s.Mw=!0,(t=be(e=s.yw))&&(n=e.options.showScrollTip,o=s.Hw,r=s.bCb,i=s.Iw,a=s.dCb,o!==t.lq||r!==t.cCb?(s.ju(o,r),2!==n&&3!==n||e.ww(s.Nw(!0))):i===t.qq&&a===t.eCb||(s.lu(i,a),1!==n&&3!==n||e.ww(s.Nw(!1)))),s.Mw=!1)},e.prototype.ju=function(e,t,n){var o,r,i,a,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,E=this;if(E.GHb&&(k.clearTimeout(E.GHb),E.GHb=D),o=be(E.yw)){if(r=o.lq,i=o.cCb,!n&&e===r&&t===i)return;if(o.lq=e,o.cCb=t,o.Xq>0)return void o.Wq(s.Events.TopRowChanged,{sheet:o,sheetName:o.name(),oldTopRow:r,newTopRow:e});if(a=!1,c=(u=(l=o.options).sheetAreaOffset.top)+2,f=o.Zs,p=(h=o.am()).qt,d=h.jr,g=void 0,m=void 0,y=h.width+l.sheetAreaOffset.left,v=void 0,C=(b=o._render).bm(),o.tables&&0===o.frozenRowCount()&&((w=o.tables.KHb())&&(w.x=w.x-2,w.width=w.width+4,w.y=u,w.height=p,b.AI(C,w))),e>r||e===r&&O(t)>O(i)){if(x=void 0,A=void 0,(M=o.Gr(1))&&M.length>0&&(x=M.findRow(e)),x){for(A=M[S=M.length-1];A&&A.y+A.height>p+d;)A=M[S-=1];A&&A.row>e&&(a=!0,g=f?f.x:h.x,m=x.y+O(t),v=A.y+A.height-m-c,b.Ow(g,m,y,v,g,p),l.colHeaderVisible||(o.invalidateLayout(),b._l(C,new s.Rect(g,0,y,u))),o.invalidateLayout(),b._l(C,new s.Rect(g,p+v,y,d-v)),b.Pw(C,new s.Rect(g,p-2,y,d+2)))}}else{for(T=0,N=e;N<r&&T<d;N++)T+=o.Sl(N);(T+=O(i)-O(t))<d&&(a=!0,g=f?f.x:h.x,m=p,v=d-T,o.frozenTrailingRowCount()>0&&(v-=1),b.Ow(g,m,y,v,g,m+T),o.invalidateLayout(),I=o.rowOutlines&&!o.rowOutlines.iT()?o.rowOutlines.s0a()+u+1:0,b._l(C,new s.Rect(g,m-u,y,T+u+I+5)),b.Pw(C,new s.Rect(g,p-2,y,d+2)))}a||(o.invalidateLayout(),o.repaint()),o.Wq(s.Events.TopRowChanged,{sheet:o,sheetName:o.name(),oldTopRow:r,newTopRow:e}),(R=o._eventHandler)&&R._updateEditingEditor(),a&&Ce(o)&&(E.GHb=we(o,E))}},e.prototype.lu=function(e,t,n){var o,r,i,a,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R=this;if(R.GHb&&(k.clearTimeout(R.GHb),R.GHb=D),o=be(R.yw)){if(r=o.qq,i=o.eCb,!n&&e===r&&t===i)return;if(o.qq=e,o.eCb=t,o.Xq>0)return void o.Wq(s.Events.LeftColumnChanged,{sheet:o,sheetName:o.name(),oldLeftCol:r,newLeftCol:e});if(a=!1,c=(u=(l=o.options).sheetAreaOffset.left)+2,f=o.Zs,p=(h=o.am()).pt,d=h.er,g=void 0,m=void 0,y=void 0,v=h.height+l.sheetAreaOffset.top,C=(b=o._render).bm(),e>r||e===r&&O(t)>O(i)){if(w=void 0,x=void 0,(A=o.Hr(1))&&A.length>0&&(w=A.findCol(e)),w){for(x=A[M=A.length-1];x&&x.x+x.width>p+d;)x=A[M-=1];x&&x.col>e&&(a=!0,g=w.x+O(t),m=f?f.y:h.y,y=x.x+x.width-g-c,b.Ow(g,m,y,v,p,m),l.rowHeaderVisible||(o.invalidateLayout(),b._l(C,new s.Rect(0,m,u,v))),o.invalidateLayout(),b._l(C,new s.Rect(p+y,m,d-y,v)),b.Pw(C,new s.Rect(p-2,m,d+2,v)))}}else{for(S=0,T=e;T<r&&S<d;T++)S+=o.Tl(T);(S+=O(i)-O(t))<d&&(a=!0,g=p,m=f?f.y:h.y,y=d-S,o.frozenTrailingColumnCount()>0&&(y-=1),b.Ow(g,m,y,v,g+S,m),o.invalidateLayout(),N=o.columnOutlines&&!o.columnOutlines.iT()?o.columnOutlines.s0a()+u+1:0,b._l(C,new s.Rect(g-u,m,S+u+N+5,v)),b.Pw(C,new s.Rect(p-2,m,d+2,v)))}a||(o.invalidateLayout(),o.repaint()),o.Wq(s.Events.LeftColumnChanged,{sheet:o,sheetName:o.name(),oldLeftCol:r,newLeftCol:e}),(I=o._eventHandler)&&I._updateEditingEditor(),a&&Ce(o)&&(R.GHb=we(o,R))}},e.prototype.Rw=function(e,t,n){var o,r,i,a,l,u,c,f,h,p,d,g,y,v,b,C,w,x,A,M,S=this,T=S.yw,N=be(T),I=!1,R=T.St,k=T.Pt,E=T.options.scrollbarShowMax,D=T.options.scrollbarAppearance===m.ScrollbarAppearance.mobile;if(N){if(o=N.name(),e.ctrlKey){if(!T.options.allowUserZoom)return!0;if(i=function(e,t){return void 0===t&&(t=12),+parseFloat(e.toPrecision(t))}((r=N.zoom())-.05*t),N.isEditing()&&!N.endEdit())return;if(a={sheet:N,sheetName:N.name(),oldZoomFactor:r,newZoomFactor:i,cancel:!1},N.Wq(s.Events.ViewZooming,a),a&&!0===a.cancel)return!1;l={cmd:"zoom",sheetName:o,oldZoomFactor:r,zoomFactor:a.newZoomFactor},N.wu().execute(l),r!==(i=N.zoom())&&(delete a.cancel,N.Wq(s.Events.ViewZoomed,a),N.Wq(s.Events.UserZooming,a))}else n=n||0,u=N.lq,c=N.cCb,h=(f=S.ms(N,t)).cj,p=f.UP,u!==h||c!==p?(D&&(R.Jwa(m.ScrollbarState.show),S.Rdc(!0)),S.ju(h,p),N.os(),E||N.es()):I=!0,d=N.qq,g=N.eCb,v=(y=S.Sw(N,n)).dj,b=y.UP,d===v&&g===b||(D&&(k.Jwa(m.ScrollbarState.show),S.Rdc(!1)),S.lu(v,b),N.qs(),E||N.ds());C=N.Vs(),w=N.hitTest(e.pageX-C.left,e.pageY-C.top),(A=(x=N.yt)&&x.cellTypeHitInfo)&&(A.cellRect=N.getCellRect(x.row,x.col)),(M=N._eventHandler).Tw(w),M.Uw(w)}return I&&0===n},e.prototype.aCb=function(e,t){var n,o,r,i,a,s,l,u,c=e.lq,f=e.cCb,h=e.parent,p=e.zoom(),d=j(t*h.options.scrollPixel*p),g=0,m=e.am().qt,y=e.jt(1).findRow(c);if(y)if(d<0){for(n=e.Rt(-1),g=-(m-y.y);c>n&&g>=d;)c--,g-=e.Sl(c);f=g-d,c===n&&f>0&&(f=0)}else if(d>0){for(o=e.ns(),g=y.y+y.height-m;c<o&&g<=d;)c++,g+=e.Sl(c);f=g-d-(r=e.Sl(c)),h.options.scrollbarMaxAlign?(i=e.am(),a=e.frozenRowCount(),s=e.getRowCount()-e.frozenTrailingRowCount()-1,o=(l=e.LHb(i.jr,a,s)).cj,u=l.UP,c>o?(c=o,f=u):c===o&&O(f)>O(u)&&(f=u)):c<o&&g-d==0?(c++,f=0):c===o&&g-d<0&&(f=-r)}return{cj:c,UP:f}},e.prototype.ms=function(e,t){var n,o,r,i,a=e.lq,s=e.cCb,l=e.parent;return l&&l.options.scrollByPixel?l.ku.aCb(e,t):((n=e.frozenRowCount())>0&&(0===a&&t>0?a=n:t<0&&a===n-t&&(a=0)),-1!==(o=e.Rt(a+t,t<0))?a=o:a+=t,r=e._t(),i=e.ns(),e.getRowCount()-n-e.frozenTrailingRowCount()<=0||r===D?a=e.lq:(a<r?a=r:a>i&&(a=i),a===D&&(a=-1)),{cj:a,UP:s})},e.prototype._Bb=function(e,t){var n,o,r,i,a,s,l,u,c=e.qq,f=e.eCb,h=e.parent,p=e.zoom(),d=j(t*h.options.scrollPixel*p),g=0,m=e.am().pt,y=e.it(1).findCol(c);if(y)if(d<0){for(n=e.Ot(-1),g=-(m-y.x);c>n&&g>=d;)c--,g-=e.Tl(c);f=g-d,c===n&&f>0&&(f=0)}else if(d>0){for(o=e.ps(),g=y.x+y.width-m;c<o&&g<=d;)c++,g+=e.Tl(c);f=g-d-(r=e.Tl(c)),h.options.scrollbarMaxAlign?(i=e.am(),a=e.frozenColumnCount(),s=e.getColumnCount()-e.frozenTrailingColumnCount()-1,o=(l=e.MHb(i.er,a,s)).dj,u=l.UP,c>o?(c=o,f=u):c===o&&O(f)>O(u)&&(f=u)):c<o&&g-d==0?(c++,f=0):c===o&&g-d<0&&(f=-r)}return{dj:c,UP:f}},e.prototype.Sw=function(e,t){var n,o,r,i,a=e.qq,s=e.eCb,l=e.parent;return l&&l.options.scrollByPixel?l.ku._Bb(e,t):((n=e.frozenColumnCount())>0&&(0===a&&t>0?a=n:t<0&&a===n-t&&(a=0)),-1!==(o=e.Ot(a+t,t<0))?a=o:a+=t,r=e.$t(),i=e.ps(),e.getColumnCount()-n-e.frozenTrailingColumnCount()<=0||r===D?a=e.qq:(a<r?a=r:a>i&&(a=i),a===D&&(a=-1)),{dj:a,UP:s})},e.prototype.Dw=function(e,t){var n,o,r=this.yw;be(r)&&(e?(n=t.pageY,o=t.pageX-100):(n=t.pageY-40,o=t.pageX-30),r.uw(this.Nw(e),o,n,!0))},e.prototype.Nw=function(e){var t,n=be(this.yw),o=n.qq+1;return n&&(e?t=ge().Tip_Row+(n.lq+1):(1!==n.options.colHeaderAutoText&&(o=s.Ul.xq(o)),t=ge().Tip_Column+o)),t},e.prototype.Sdc=function(e){a.GC$(e).addClass(se)},e.prototype.Tdc=function(e){a.GC$(e).removeClass(se)},e.prototype.Udc=function(e){a.GC$(e).addClass(le)},e.prototype.Vdc=function(e){a.GC$(e).removeClass(le)},e.prototype.Rdc=function(e,t){var n,o,r,i;void 0===t&&(t=1e3),o=(n=this).yw,r=e?o.Cv:o.Kv,i=function(){n.Vdc(r),n.Sdc(r)},(o.options.scrollbarAppearance=m.ScrollbarAppearance.mobile)&&(n.Wdc(e),e?n.Xdc=setTimeout(i,t):n.Ydc=setTimeout(i,t))},e.prototype.Wdc=function(e){var t=this;e&&t.Xdc?(clearTimeout(t.Xdc),t.Xdc=null):!e&&t.Ydc&&(clearTimeout(t.Ydc),t.Ydc=null)},e}(),ye={allowUserDragDrop:!0,allowUserDragFill:!0,allowUserZoom:!0,allowUserResize:!0,allowUndo:!0,allowSheetReorder:!0,allowContextMenu:!0,allowUserDeselect:!0,defaultDragFillType:5,showDragFillSmartTag:!0,showHorizontalScrollbar:!0,showVerticalScrollbar:!0,scrollbarShowMax:!0,scrollbarMaxAlign:!1,tabStripVisible:!0,tabStripRatio:.5,tabEditable:!0,newTabVisible:!0,cutCopyIndicatorVisible:!0,cutCopyIndicatorBorderColor:"#217346",tabNavigationVisible:!0,backColor:"white",backgroundImage:D,backgroundImageLayout:0,showResizeTip:m.ShowResizeTip.none,showDragDropTip:!0,showDragFillTip:!0,scrollIgnoreHidden:!1,highlightInvalidData:!1,showScrollTip:m.ShowScrollTip.none,grayAreaBackColor:D,useTouchLayout:!1,hideSelection:!1,resizeZeroIndicator:m.ResizeZeroIndicator.enhanced,allowUserEditFormula:!0,enableFormulaTextbox:!0,referenceStyle:0,allowDynamicArray:!1,iterativeCalculation:!0,iterativeCalculationMaximumIterations:1e3,iterativeCalculationMaximumChange:.01,calcOnDemand:!1,autoFitType:m.AutoFitType.cell,allowCopyPasteExcelStyle:!0,allowExtendPasteRange:!1,copyPasteHeaderOptions:m.CopyPasteHeaderOptions.allHeaders,allowUserDragMerge:!1,rowResizeMode:m.ResizeMode.normal,columnResizeMode:m.ResizeMode.normal,scrollByPixel:!1,scrollPixel:5,enableAccessibility:!1,allowAutoCreateHyperlink:!0,scrollbarAppearance:m.ScrollbarAppearance.skin,font:D,customList:[],numbersFitMode:m.NumbersFitMode.mask},ve=function(){function e(e,t){var n,o,r=this;r.name="",r.kv=!1,r._availableSheetIndex=-1,r.eq=0,r.mv=!1,r.options=T(ye,(function(e,t,n){r.Op(e,t,n)})),r.T3(t),t&&"white"===t.backColor?r.Sxb=!0:r.Sxb=!1,n=1,t&&(typeof(o=t.sheetCount)===F&&(n=o)),r._host=e,r.ad(n,e)}return e.prototype.commandManager=function(){return this.wu},e.prototype.undoManager=function(){return this.pv},e.prototype.Txb=function(){var e=this.Uxb(),t=this.Vxb;return t instanceof Array?t.concat(e):e},e.prototype.Uxb=function(){var e=I.culture(),t=[],n=[],o=I.q4("en-US").DateTimeFormat,r=I.q4(e).DateTimeFormat;return t=this.Wxb(o),"en-US"!==e&&(n=this.Wxb(r)),t.concat(n)},e.prototype.Wxb=function(e){var t,n,o=[];return this.Xxb=["abbreviatedDayNames","dayNames","abbreviatedMonthNames","monthNames"],this.Xxb.forEach((function(r){(t=e[r])instanceof Array&&t.length>0&&(n=r.indexOf("month")>-1||r.indexOf("Month")>-1,t=n?t.slice(0,12):t,o.push(t))})),o},e.prototype.FHb=function(){var e=x&&this.Cf();e&&e.NHb(),this.sheets.forEach((function(e){e.yj().OHb()}))},e.prototype.Op=function(e,t,n){var o,r=this,i=be(r),a=x&&r.Cf();switch(e){case"allowUndo":r.pv&&(r.pv.zc=t);break;case"backColor":r.Sxb=!0,i&&i.$p();break;case"cutCopyIndicatorBorderColor":case"cutCopyIndicatorVisible":case"grayAreaBackColor":case"hideSelection":case"highlightInvalidData":case"resizeZeroIndicator":case"allowUserDragFill":case"allowUserDragMerge":case"numbersFitMode":i&&i.$p();break;case"backgroundImage":case"backgroundImageLayout":r.Ys(),i&&i.$p();break;case"newTabVisible":case"tabNavigationVisible":(o=r.hq)&&o.repaint();break;case"showHorizontalScrollbar":case"showVerticalScrollbar":case"useTouchLayout":case"tabStripVisible":r.fq();break;case"tabStripRatio":r.aq();break;case"scrollIgnoreHidden":case"scrollbarMaxAlign":case"scrollbarShowMax":i&&(i.oq=!0,i.jq=!0,i.$p());break;case"scrollByPixel":i&&(i.oq=!0,i.jq=!0,i.cCb=0,i.eCb=0,i.$p());break;case"scrollPixel":t<=0&&(r.options.scrollPixel=n);break;case"scrollbarAppearance":r.ku&&t!==n&&r.Zdc(t);break;case"calcOnDemand":a&&(!t&&a.calcOnDemand&&r.FHb(),a.calcOnDemand=t);break;case"customList":r.Vxb=t;break;case"referenceStyle":case"allowDynamicArray":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":r.PHb(e,t),i&&i.$p()}},e.prototype.Zdc=function(e){var t,n;A(e)&&(e=m.ScrollbarAppearance.skin),t=this,n=e===m.ScrollbarAppearance.mobile,t.St.$dc(e),t.Pt.$dc(e),t._dc(),n?t.aec():t.bec(),t.refresh()},e.prototype.PHb=function(e,t){var n=x&&this.Cf();if(n)switch(e){case"referenceStyle":n.useR1C1=1===t;break;case"allowDynamicArray":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":n[e]=t}},e.prototype.ad=function(t,n){var o,r,i,a,s=this;for(x&&s.qv(),s.rv=[],s.sv=M("input"),s.jm=0,s.xD=0,s.tv={fromSheet:D,isCutting:!1},s.mmb={fromSheet:D,isCutting:!1},s.Ks=D,s.sheets=[],s.Lq={},s.Vxb=s.options.customList,s.pv=new v(s,-1,s.options.allowUndo),(o=s.wu=new b(s)).addListener("workbookUndo",(function(e){var t,n,o=e.command,r=u.Commands.aWa(o),i=s.wu[o.cmd];i&&i.canUndo()&&!r&&!o.yTa&&((t=s.getSheetFromName(o.sheetName))&&(o.sheetId=t.yn),s.undoManager().Cc(o,e.s4)),1!==e.s4&&2!==e.s4||((n=s.getActiveSheet())&&n.name())!==o.sheetName&&s.setActiveSheet(o.sheetName)})),u.Commands.uv(o),e.ao(s,"init"),r=0;r<t;r++)i=s.vv(s._getDefaultSheetName(r)),s.sheets.push(i),i.Ls(s);(a=s.sheets[s.eq])&&a.isSelected(!0),s.suspendPaint(),n&&s.ws(n),s.uu=new p.S4(s),s.resumePaint()},e.prototype.hitTest=function(e,t,n){var o,r,i,s,l,u,c,f,h,p,d,g,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,j,_,O=this,F=O.getActiveSheet(),P=O.hq,H=O.Pt,B=O.St,L=a.GC$(O.getHost()).width(),z=a.GC$(O.getHost()).height();if(e<0||e>L||t<0||t>z)return D;if(o=O.oia(),O.options.scrollbarAppearance===m.ScrollbarAppearance.mobile){if(r=function(e,t,n,o,r){var i=e.pia(),a=t.left-n.left,s=t.top-n.top;if(o>a&&o<i.width+a&&r>s&&r<i.height+s)return{horizontalScrollBarHitInfo:{element:e.hitTest(o-a,r-s).element},x:o,y:r}}(H,a.GC$(O.Kv).offset(),o,e,t))return r;if(i=function(e,t,n,o,r){var i=e.pia(),a=t.left-n.left,s=t.top-n.top;if(o>a&&o<i.width+a&&r>s&&r<i.height+s)return{verticalScrollBarHitInfo:{element:e.hitTest(o-a,r-s).element},x:o,y:r}}(B,a.GC$(O.Cv).offset(),o,e,t))return i}if(F&&(s=F.Vs(),l=F.Dr(),u=s.left-o.left,c=s.top-o.top,e>u&&e<l.width+u&&t>c&&t<l.height+c))return{worksheetHitInfo:F.hitTest(e-u,t-c,!1,n),x:e,y:t};if(f=a.GC$(P.Ws()).offset(),h=P.Dr(),p=f.left-o.left,d=f.top-o.top,e>p&&e<h.width+p&&t>d&&t<h.height+d){switch(y={},v=(g=P.hitTest(e-p,t-d)).index,C=(b=O.sheets[v])&&b.name(),g.type){case"navButton":y={navButton:g.element};break;case"sheetTab":y={sheetTab:{sheetName:C||g.element,sheetIndex:v}};break;case"resize":y={resize:!0};break;default:y={blank:!0}}return{tabStripHitInfo:y,x:e,y:t}}return w=a.GC$(H.Bv()).offset(),x=H.pia(),A=w.left-o.left,M=w.top-o.top,e>A&&e<x.width+A&&t>M&&t<x.height+M?{horizontalScrollBarHitInfo:{element:H.hitTest(e-A,t-M).element},x:e,y:t}:(S=a.GC$(B.Bv()).offset(),T=B.pia(),N=S.left-o.left,I=S.top-o.top,e>N&&e<T.width+N&&t>I&&t<T.height+I?{verticalScrollBarHitInfo:{element:B.hitTest(e-N,t-I).element},x:e,y:t}:(R=a.GC$(O.Ov).offset(),k=parseInt(O.Ov.style.width.substr(0,O.Ov.style.width.indexOf("px")),10),E=parseInt(O.Ov.style.height.substr(0,O.Ov.style.height.indexOf("px")),10),j=R.left-o.left,_=R.top-o.top,e>j&&e<k+j&&t>_&&t<E+_?{footerCornerHitInfo:{element:"footerCorner"},x:e,y:t}:void 0))},e.prototype.oia=function(){var e;return(e=ue?ue(this._host).offset():a.GC$(this._host).offset())?(e.top+=E.body.clientTop||0,e.left+=E.body.clientLeft||0):e={top:0,left:0},e},e.prototype.T3=function(e){var t=this.options,n=e||{};n=w(!0,{},ye,n),C(n,(function(e,n){t.hasOwnProperty(e)&&(t[e]=n)}))},e.prototype.xv=function(){var e=this;return!e.Ks&&e._host&&(e.Ks=M(J),a.GC$(e.Ks).css({position:"relative",left:0,top:0,height:0}),a.GC$(e._host).prepend(e.Ks)),e.Ks},e.prototype._getDefaultSheetName=function(e){var t,n,o,r,i,a,s=this,l=s.getSheetCount();s._availableSheetIndex<l?s._availableSheetIndex=l:s._availableSheetIndex++,(A(e)||e<s._availableSheetIndex)&&(e=s._availableSheetIndex),t=!1,o=s.sheets;do{for(n=(ge().SHEET_NAME||"Sheet")+(e+1),r=o.length,i=0;i<r;i++)if(a=o[i]){if(a.name().toUpperCase()===n.toUpperCase()){e++,t=!0;break}t&&(t=!1)}}while(t);return n},e.prototype.vv=function(e){return new d.Worksheet(e)},e.prototype.ws=function(t){var n,r,i,s,l,u,c,f,h,p,d,g,y,v,b,C,w,x,A,S,T,N,I=this;if(t){for(I._host=t,ue&&ue(t).data(fe,I),a.GC$(t).data(fe,I).attr(he,"gcSpread").addClass(pe).css("overflow","visible"),k.Yl.qm(),I.cultureChangedHandler=function(){I.Av()},E.addEventListener(ce,I.cultureChangedHandler),r=(n=M(Q)).style,i=void 0,s=void 0,l=void 0,u=void 0,c=void 0,f="100%",h=I.options.scrollbarAppearance,p=I.options.scrollByPixel,n.cellSpacing="0px",n.cellPadding="0px",n.border="0",r.width=f,r.height=f,r.border="0",r.margin="0",r.borderCollapse="collapse",i=0;i<2;i++){for(l=M("tr"),s=0;s<2;s++)(c=(u=M("td")).style).padding=0,c.border=0,l.appendChild(u);n.appendChild(l)}for(t.appendChild(n),I.xs=M(J),I.xs.id=t.id+"vp",a.GC$(n.rows[0].cells[0]).append(I.xs),d=h===m.ScrollbarAppearance.mobile,g=p?m.ScrollType.pixels:m.ScrollType.continuous,I.St=new o.hv(!1,D,D,D,D,D,g,h,(function(){I.cec(!0)})),y=I.St.Bv(),v=I.Cv=M(J),a.GC$(v).append(y),I.dec=n.rows[0].cells[1],a.GC$(y).bind(V+q,(function(e,t){var n=t.scrollEventType;e.data=I,1===t.scrollOrientation&&(0===n||1===n||2===n||3===n||5===n?me.Dv(e,t):4===n&&me.Ev(e))})).bind(P+q,(function(e){e.data=I,me.Fv(e)})).bind(B+q,(function(e){e.data=I,me.Gv(e)})).bind(H+q,(function(e){e.data=I,e.scrollbar=I.St,me.ggc(e)})),C=(b=M(Q)).style,b.cellSpacing="0",b.cellPadding="0",b.border="0",C.border="0",C.margin="0",a.GC$(b).css("user-select",X),l=M("tr"),s=0;s<2;s++)(c=(u=M("td")).style).padding=0,c.border=0,l.appendChild(u);b.appendChild(l),a.GC$(n.rows[1].cells[0]).append(b),void 0,x=void 0,(x=(w=I.Hv=M(J)).style).width=""+I.Iv()*a.GC$(t).width()+Y,x.height=""+I.Jv()+Y,x.fontSize="10pt",x.fontFamily="Arial",a.GC$(b.rows[0].cells[0]).append(w),I.Pt=new o.hv(!0,D,D,D,D,D,g,h,(function(){I.cec(!1)})),A=I.Pt.Bv(),S=I.Kv=M(J),a.GC$(S).append(A),I.eec=b.rows[0].cells[1],a.GC$(A).bind(V+q,(function(e,t){var n=t.scrollEventType;e.data=I,0===t.scrollOrientation&&(0===n||1===n||2===n||3===n||5===n?me.Lv(e,t):4===n&&me.Mv(e))})).bind(P+q,(function(e){e.data=I,me.Nv(e)})).bind(B+q,(function(e){e.data=I,me.Gv(e)})).bind(H+q,(function(e){e.data=I,e.scrollbar=I.Pt,me.ggc(e)})),I.Ov=M(J),a.GC$(n.rows[1].cells[1]).append(I.Ov),I.ku=new me(this),d&&I.aec(),I._dc(),T=I.oTa=function(){I.Pv()},a.GC$(k).bind(G+U,T),(N=be(I))&&N.ws(I.xs),I.Qv(),I.fq(),I.Rv(t),e.ao(I,"setHost",t)}},e.prototype._dc=function(){var e,t,n,o,r,i=this,s=i._host;i.ku&&(e=i.options.scrollbarAppearance===m.ScrollbarAppearance.mobile,t=i.dec,n=i.eec,o=i.Cv,r=i.Kv,a.GC$(o).removeAttr("style"),a.GC$(r).removeAttr("style"),e?(o.style.position="absolute",o.style.top="0px",o.style.left="0px",a.GC$(o).addClass(oe+" "+ie),a.GC$(s).css("position","relative").append(o),r.style.position="absolute",r.style.top="0px",r.style.left="0px",a.GC$(r).addClass(oe+" "+re),a.GC$(s).append(r)):(a.GC$(t).append(o),a.GC$(n).append(r),a.GC$(o).removeClass(oe+" "+se+" "+ie+" "+le),a.GC$(r).removeClass(oe+" "+se+" "+re+" "+le),a.GC$(s).css("position","auto")))},e.prototype.aec=function(){var e=this,t=e._host,n=e.Cv,o=e.Kv;a.GC$(n).bind(L,(function(){e.St.Jwa(m.ScrollbarState.active)})).bind(z,(function(){e.St.Jwa(m.ScrollbarState.unactive)})),a.GC$(o).bind(L,(function(){e.Pt.Jwa(m.ScrollbarState.active)})).bind(z,(function(){e.Pt.Jwa(m.ScrollbarState.unactive)})),a.GC$(t).bind(L,e.fec).bind(z,e.gec)},e.prototype.bec=function(){var e=this,t=e.Cv,n=e.Kv;t&&(a.GC$(t).unbind(L).unbind(z),e.ku.Wdc(!0)),n&&(a.GC$(n).unbind(L).unbind(z),e.ku.Wdc(!1)),a.GC$(e._host).unbind(L,e.fec).bind(z,e.gec)},e.prototype.fec=function(){a.GC$(this).find("."+oe).addClass(ae)},e.prototype.gec=function(){a.GC$(this).find("."+oe).removeClass(ae)},e.prototype.Rv=function(e){var t=this,n="tabindex",o=R(a.GC$(e).attr(n),10)||0,r=M(J);a.GC$(r).css({position:ee,overflow:"hidden"}).attr(he,"gcSheetFocusElementForTab").attr(n,o).bind(W,(function(){t.Sv||be(t).zt(),t.Sv=!1})),e.insertBefore(r,D),t.Tv=r},e.prototype.Uv=function(){var e=this.Tv;e&&(this.Sv=!0,e.focus())},e.prototype.hgc=function(){var e,t,n,o,r,i=this.getActiveSheet();if(i)if(s.Vl.Wl(i)){if(t=this._host)for(n=document.activeElement,o=document.body,r=n;r;){if(r===t){e=n;break}if(r===o)break;r=r.parentElement}}else i.Xs&&(e=i.Xs);return e},e.prototype.dgc=function(e){var t=this;t.igc&&(k.clearTimeout(t.igc),t.igc=D),t.igc=k.setTimeout((function(){var n=t.hgc();n&&n.setAttribute("aria-label",e),k.clearTimeout(t.igc),t.igc=D}),50)},e.prototype.no=function(){var t,n,o,r,i,l,u=this,c=u.Pt,f=u.St,p=u.sheets,d=u.options.scrollbarAppearance===m.ScrollbarAppearance.mobile;for(s.En.Tn(u),s.Ul.no(),u.oTa&&a.GC$(k).unbind(G+U,u.oTa),u.oTa=D,u.Zv&&clearTimeout(u.Zv),c&&c.dispose(),f&&f.dispose(),u.mu(),s.Vl.Xl()===u.getActiveSheet()&&s.Vl.Zl(D),t=0;t<p.length;t++)p[t].no(!0);p.splice(0,p.length),(n=u.uu)&&(n.no(),u.uu=D),i="class",l="unselectable",(o=u._host)&&(r=a.GC$(o),E.removeEventListener(ce,u.cultureChangedHandler),r.html("").removeAttr(he).removeClass(pe),r.attr(i)||r.removeAttr(i),r.attr(l)||r.removeAttr(l),r.data(fe)&&r.data(fe,D),ue&&ue(o).data(fe)&&ue(o).data(fe,D)),d&&u.bec(),u.Kv=D,u.Cv=D,u.pv&&(u.pv.no(),u.pv=D),u.hq&&(u.hq.no(),u.hq=D),e.ao(u,"dispose"),u.Tv&&(a.GC$(u.Tv).unbind(W),u.Tv=D),u.Wu&&(u.Wu.dispose(),u.Wu=D,u.yv=D,u.zv=D),u.bt&&(u.bt.no(),u.bt=D),h.To.no(),u.wu&&(u.wu.no(),u.wu=D),u.ku&&(u.ku.no(),u.ku=D)},e.prototype.mu=function(){var e,t=this.sheets;for(a.GC$(this.sv).unbind(U),e=0;e<t.length;e++)t[e].mu()},e.prototype.Qv=function(){var e,t,n,o=this,r=R(s.Im.Lm("").zIndex),i=r!==o.Vv,a=o.options.scrollbarAppearance===m.ScrollbarAppearance.mobile,l=o._host.getAttribute("id")+"_tabStrip",u=o.hq;i&&(o.Vv=r),e=o.Jv(),t=o.Wv(),n=o.Xv(),u&&!i?u.repaint():(u&&u.no(),(u=o.hq=r>2007?new c.iv(l):new f.jv(l)).Yv(o),u.ws(o.Hv)),a?o.hec():(xe(o.Cv,n,t),Ae(o.Kv,e,t)),Me(o.Ov,n,e)},e.prototype.Pv=function(){var e=this,t=e.Zv;t&&clearTimeout(t),e.Zv=k.setTimeout((function(){s.En.Un(),e.fq(),e.Zv=D}),100)},e.prototype.fq=function(){var e=this;e.kv||(e.kv=!0,e.$v(),e.kv=!1)},e.prototype.$v=function(){var e,t,n,o,r,i,s,l,u,c,f,h,p,d,g,y,v,b,C,w,x=this,A="display",M="block",S=x.Jv(),T=x.Wv(),N=x.Xv(),I=x._host;I&&(t=(e=x.options).showVerticalScrollbar,n=e.showHorizontalScrollbar,o=e.tabStripVisible,r=e.scrollbarAppearance===m.ScrollbarAppearance.mobile,i=n||o,l=(s=a.GC$(I)).width(),u=s.height(),c=x.Ov,f=x.Pt,h=x.St,p=x.xs.style,d=x.Hv.style,r&&!o&&n&&(S=0),a.GC$(c).css(A,r?o?M:X:i?M:X),p.width=""+(l-(t&&!r?N:0))+Y,a.GC$(x.Cv).css(A,t?M:X),a.GC$(c).css("width",(t&&!r?N:0)+Y),g=u-(i?S:0),p.height=""+(g>=2?g:2)+Y,a.GC$(x.Kv).css(A,i?M:X),a.GC$(c).css("height",i?S:0+Y),n?a.GC$(f.Bv()).show():a.GC$(f.Bv()).hide(),y=a.GC$(x.xs).width(),(v=j(x.Iv()*y))===y&&(v=y-1),d.width=""+v+Y,d.height=""+S+Y,h.Vo(T),h._v(a.GC$(x.xs).height()),b=l-(o&&!r?v:0)-(t?N:0),f.Vo(b>0?b:1),f._v(T),(C=be(x))&&(0===C.lq&&(C.lq=C._t()),0===C.qq&&(C.qq=C.$t()),C.fq()),r&&x.hec(),x.Ut(),x.Xt(),r&&(x.St.Jwa(m.ScrollbarState.hide),x.Pt.Jwa(m.ScrollbarState.hide)),C&&(C.invalidateLayout(),C.repaint()),o?a.GC$(x.Hv).show():a.GC$(x.Hv).hide(),x.hq&&x.hq.fq(),l!==(w=s.width())&&O(l-w)>2&&!x.aw&&(x.aw=!0,setTimeout((function(){delete x.aw,x.$v()}),1)))},e.prototype.hec=function(){var e,t,n,o,r,i,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w=this;A(w._host)||(e=a.GC$(w._host),(t=w.getActiveSheet())&&(n=t.am(),o=w.options.showVerticalScrollbar,2,r=a.GC$(w.Cv),i=a.GC$(w.Kv),s=e.width(),l=e.height(),u=w.options.tabStripVisible?w.Jv():0,c=n.x+n.Br,f=n.y+n.Cr,h=o?r.width():0,0,d=f,g=(p=l-u-f)-R(r.css("padding-top"))-R(r.css("padding-bottom")),m=s-h-c,y=i.height(),v=u,b=c,C=m-R(i.css("padding-left"))-R(i.css("padding-right"))-2,w.St.Vo(h),w.St._v(g),w.Pt.Vo(C),w.Pt._v(y),r.css(["height","left","right","top"],[p,"auto",0,d]),i.css(["width","top","bottom","left"],[m,"auto",v,b])))},e.prototype.Ut=function(){var e,t,n,o,r,i,a,s,l,u,c,f,h,p,d,g,y,v,b,C=this,w=be(C),x=C.options;w&&(t=(e=C.Pt)&&e.QB===m.ScrollType.pixels,n=w.frozenColumnCount(),o=w.getColumnCount()-w.frozenTrailingColumnCount()-n,r=n,i=w.am(),a=0===o?r:r+o-1,s=w.qq,l=w.eCb,u=void 0,c=0,x.scrollbarMaxAlign?(t?(u=(f=w.MHb(i.er,r,a)).dj,c=f.UP):u=w.fu(i.er,r,a),a=u):t&&(c=-w.Tl(a)),x.scrollbarShowMax?t&&!x.scrollbarMaxAlign&&(c=-w.Tl(a)):(h=w.iu().lastNonNullCol,(p=w.fu(i.er,r,h))===r&&(++p>a&&(p=a)),a=s>p?s<a?s:a:p,c=l),s>a?(w.qq=a,w.eCb=t?c:0):s===a&&c>l&&(w.eCb=t?c:0),-1!==(d=w.Ot(w.qq))&&d!==w.qq&&(w.qq=d),e&&(g=0,y=0,v=0,b=0,t?(g=w.jgc(r),y=w.jgc(a)-c,v=i.er,b=w.jgc(w.qq)-w.eCb):(g=w.Qt(r),y=w.Qt(a),v=w.gu(),b=w.Qt(w.qq),v<1&&(v=1)),e.bw(g),e.cw(y),e.dw(v),e.ew(),e.value(b)))},e.prototype.Xt=function(){var e,t,n,o,r,i,a,s,l,u,c,f,h,p,d,g,y,v,b,C=this,w=be(C),x=C.options;w&&(t=(e=C.St)&&e.QB===m.ScrollType.pixels,n=w.frozenRowCount(),o=w.getRowCount()-w.frozenTrailingRowCount()-n,r=n,i=w.am(),a=0===o?r:r+o-1,s=w.lq,l=w.cCb,u=void 0,c=0,x.scrollbarMaxAlign?(t?(u=(f=w.LHb(i.jr,r,a)).cj,c=f.UP):u=w.eu(i.jr,r,a),a=u):t&&(c=-w.Sl(a)),x.scrollbarShowMax?t&&!x.scrollbarMaxAlign&&(c=-w.Sl(a)):(h=w.iu().lastNonNullRow,(p=w.eu(i.jr,r,h))===r&&(++p>a&&(p=a)),a=s>p?s<a?s:a:p,c=l),s>a?(w.lq=a,w.cCb=t?c:0):s===a&&c>l&&(w.cCb=t?c:0),-1!==(d=w.Rt(w.lq))&&d!==w.lq&&(w.lq=d),e&&(g=0,y=0,v=0,b=0,t?(g=w.kgc(r),y=w.kgc(a)-c,v=i.jr,b=w.kgc(w.lq)-w.cCb):(g=w.Tt(r),y=w.Tt(a),v=w.hu(),b=w.Tt(w.lq),v<1&&(v=1)),e.bw(g),e.cw(y),e.dw(v),e.ew(),e.value(b)))},e.prototype.aq=function(){var e,t,n,o,r,i,s,l,u,c=this,f=c.Jv(),h=c.Wv(),p=c.Xv(),d=c._host,g=c.options.scrollbarAppearance===m.ScrollbarAppearance.mobile;d&&(t=(e=c.options).tabStripVisible,n=a.GC$(d).width(),o=c.Pt,r=c.Hv.style,i=a.GC$(c.xs).width(),(s=j(c.Iv()*i))===i&&(s=i-1),r.width=""+s+Y,r.height=""+f+Y,l=n-(t&&!g?s:0)-(e.showVerticalScrollbar?p:0),o.Vo(l>0?l:1),o._v(h),(u=be(c))&&0===u.qq&&(u.qq=u.$t()),c.Ut(),t?a.GC$(c.Hv).show():a.GC$(c.Hv).hide(),c.hq&&c.hq.fq())},e.prototype.suspendPaint=function(){var e,t,n=this,o=n.hq,r=n.sheets;for(n.xD++,e=0,t=r;e<t.length;e++)t[e].suspendPaint();o&&o.fw()},e.prototype.resumePaint=function(){var e,t,n=this,o=n.hq,r=n.sheets;for(n.xD-=n.xD>0?1:0,e=0,t=r;e<t.length;e++)t[e].resumePaint();o&&o.gw()},e.prototype.isPaintSuspended=function(){return this.xD>0},e.prototype.Ys=function(){var e,t,n,o,r,i=this,u=i.options.backgroundImage,c=i.options.backgroundImageLayout,f=be(i);if(f&&u&&(e=void 0,a.GC$(f.Ws()).css({"background-image":"url('"+u+"')","background-repeat":"no-repeat"}),!A(c))){(e=i.bt)||(e=i.bt=new l.oo((function(){i.bt&&i.Ys()})));try{e.ko(u)?(t=e.lo(u),o=(n=f.Dr()).width,r=n.height,s.Ul.ql(f.Ws(),o,r,t.width,t.height,c)):e.fo(u)}catch(e){}}},e.prototype.hw=function(e){this.hq.iw(this.getSheetIndex(e.name()))},e.prototype.startSheetIndex=function(e){var t=this,n=t.hq;return 0===arguments.length?n?n.gq:0:(n&&(n.hE(e)||-1===(e=n.jw(e))&&(e=n.rw(e)),n.gq=e),t.aq(),t)},e.prototype.Iv=function(){var e,t,n,o,r,i=this,s=i.options,l=i.options.scrollbarAppearance===m.ScrollbarAppearance.mobile;return s.showHorizontalScrollbar&&!l?(e=s.tabStripRatio,isNaN(e)?.5:(t=0,n=i.xs,o=i.hq,n&&o&&(r=a.GC$(n).width(),t=o.kw/r),e<t?e=t:e>1&&(e=1),e)):1},e.prototype.destroy=function(){this.oTa&&a.GC$(k).unbind(G+U,this.oTa),this.no()},e.prototype.repaint=function(){var e,t=this.hq;t&&t.repaint(),(e=be(this))&&e.repaint()},e.prototype.refresh=function(){var e=this;e._host&&(s.Im.Nm(),e.Qv(),e.fq(),e.repaint())},e.prototype.getHost=function(){return this._host},e.prototype.invalidateLayout=function(){var e=be(this);e&&e.invalidateLayout()},e.prototype.addNamedStyle=function(e){this.Kq(e);var t=be(this);t&&t.$p()},e.prototype.Kq=function(e){if(e){if(!e.name)throw Error(ge().Exp_EmptyNamedStyle);var t=e.name.toUpperCase();this.Lq[t]=e}},e.prototype.getNamedStyle=function(e){return this.Mq(e,!0)},e.prototype.Mq=function(e,t){var n,o=this.Lq;return o&&e?((n=o[e=e.toUpperCase()])&&t&&this.Jq(),n):D},e.prototype.Jq=function(){var e,t;for(e=0,t=this.sheets;e<t.length;e++)t[e].Jq()},e.prototype.removeNamedStyle=function(e){var t,n,o=this.Lq;o&&e&&(e=e.toUpperCase(),o.hasOwnProperty(e)&&((t=o[e].formatter)&&"string"==typeof t&&this.QHb[t]&&this.RHb(t),delete o[e],this.Jq(),(n=be(this))&&n.$p()))},e.prototype.getNamedStyles=function(){var e=[],t=this.Lq;return t&&C(t,(function(t,n){e.push(n)})),this.Jq(),e},e.prototype.getActiveSheet=function(){return this.sheets&&this.sheets.length>0?this.sheets[this.eq]:D},e.prototype.setActiveSheet=function(e){this.lw(e,2)},e.prototype.lw=function(e,t){var n,o=this.sheets,r=this.getActiveSheet();for(n=0;n<o.length;n++)o[n].name()===e&&this.dq(n,t);this.SHb(r)},e.prototype.getActiveSheetIndex=function(){return this.eq},e.prototype.setActiveSheetIndex=function(e){var t=this.getActiveSheet();this.dq(e,2),this.SHb(t)},e.prototype.dq=function(e,t,n,o){var r,i,a,l,u,c,f;typeof e===F&&(e!==(r=this).eq&&((i=r.sheets[e])&&i.visible()&&(((a=s.Ul.rl()).ipad||a.iphone)&&((l=r.mw)&&(new Date).valueOf()-l<300)||(c={oldSheet:u=be(r),newSheet:i,cancel:!1},(f={oldSheet:u,newSheet:i,needTriggerSheetChange:!0}.needTriggerSheetChange&&o)&&function(e,t){e.Wq(s.Events.ActiveSheetChanging,t)}(r,c),!1===c.cancel&&(r.eq=e,i!==u&&(u&&(u.no(!1),u.charts&&u.charts.all().forEach((function(e){e.clearflexDVs()}))),r.nw(i,t,!1,f,n)),r.fq(),f&&function(e,t,n){e.Wq(s.Events.ActiveSheetChanged,{oldSheet:t,newSheet:n})}(r,u,i)),(a.ipad||a.iphone)&&(r.mw=(new Date).valueOf())))))},e.prototype.nw=function(e,t,n,o,r){var i,a,l;n||e.ws(this.xs),a=(i=s.Vl.Xl())&&i.parent===this,l=2===t?a:1===t,s.Vl.Zl(D),!this.mv&&l&&e.zt(r),e.qs(),e.os()},e.prototype.SHb=function(e){var t=this.getActiveSheet();e&&e.DHb(!1,!1),t&&t.DHb(!0,!1)},e.prototype.addSheet=function(e,t){var n=this.getActiveSheet();this.ow(e,2,t),this.SHb(n)},e.prototype.ow=function(e,t,n){var o,r,i,a,s,l,u,c,f=this;if(n||(n=f.vv(f._getDefaultSheetName(e))),i=(r=f.sheets).length,n.name()){for(o=0;o<i;o++)if(r[o].name()===n.name())throw ge().Exp_NotSupported}else n.cq(f._getDefaultSheetName(e));for(f.pw(n),a=be(f),s=f.eq,l=i-e,u=[],o=0;o<l&&i>0;o++)u.push(r.pop());for(r.push(n),n.Ls(f);u.length>0;)r.push(u.pop());1===(i=r.length)?(f.xs&&n.ws(f.xs),f.eq=0):(s<0&&f.hq&&(s=f.hq.jw(s)),f.eq=s),(c=be(f))!==a&&(a&&a.no(!1),c&&f.nw(c,t,1===i,!0),f.fq()),f.hq&&(f.hq.gq<0&&(f.hq.gq=f.eq),f.hq.repaint())},e.prototype.removeSheet=function(e){this.qw(e,2)},e.prototype.qw=function(e,t){var n,o,r,i,a,s,l,u=this,c=u.sheets,f=u.Wu,h=u.hq,p=c.length;if(isNaN(e)||e<0||e>=p)throw Error(ge().Exp_IndexOutOfRange);if(n=e<=u.eq||e===p-1,o=be(u),e<u.eq&&u.eq--,(r=c[e]).mu(),c.splice(e,1),0===(p=c.length))u.eq=-1;else if(u.eq>=p)u.eq=h.rw(p);else{for(i=void 0,i=u.eq;i<p;i++)if(c[i].visible()){u.eq=i;break}i>=p&&(u.eq=h.rw(p))}n&&(o!==(a=c[u.eq])&&(o&&o.no(!1),a&&u.nw(a,t,!1,!0))),f&&((s=r.yj()).VDc=e,f.removeSource(s)),r.no(!0,-1!==u.eq),x&&!f._parserContext&&u.sheets&&u.sheets.length>0&&(l=u.sheets[0],f.initParserContext(l.yj())),h&&(h.gq>=p?u.startSheetIndex(h.rw(p)):h.gq<0?u.startSheetIndex(h.jw(-1)):u.fq())},e.prototype.clearSheets=function(){var e,t,n,o=this,r=o.sheets,i=o.Wu,a=o.hq;for(e=0,t=r;e<t.length;e++)(n=t[e]).mu(),n.no(!0);r.splice(0,r.length),i&&i.clearSource(),o.eq=-1,a&&(a.gq=-1,a.repaint())},e.prototype.getSheet=function(e){var t=this.sheets;return e>=0&&e<t.length?t[e]:D},e.prototype.getSheetFromName=function(e){var t,n,o;for(t=0,n=this.sheets;t<n.length;t++)if((o=n[t]).name()===e)return o;return D},e.prototype.getSheetIndex=function(e){var t,n=this.sheets;for(t=0;t<n.length;t++)if(n[t].name()===e)return t;return D},e.prototype.getSheetCount=function(){return this.sheets.length},e.prototype.setSheetCount=function(e){this.sw(e,2)},e.prototype.sw=function(e,t){var n,o,r=this;if(e<0)throw ge().Exp_ArgumentOutOfRange;if(0===e&&r.clearSheets(),e<(n=r.sheets.length))for(o=n-1;o>=e;o--)r.qw(o,t);else if(e>n)for(o=n;o<e;o++)r.ow(o,t)},e.prototype.bind=function(e,t,n){var o,r,i=this,s=i.sheets;for(i.rv.push({type:e,data:t,fn:n}),a.GC$(i.sv).bind(e+U,t,n),o=0,r=s;o<r.length;o++)r[o].bind(e,t,n)},e.prototype.unbind=function(e,t){var n,o,r,i=this,s=i.sheets,l=i.rv;for(n=0;n<l.length;n++)l[n].type===e&&l.splice(n,1);for(a.GC$(i.sv).unbind(e+U,t),o=0,r=s;o<r.length;o++)r[o].unbind(e,t)},e.prototype.unbindAll=function(){var e,t,n=this,o=n.sheets;for(n.rv.length=0,a.GC$(n.sv).unbind(U),e=0,t=o;e<t.length;e++)t[e].unbindAll()},e.prototype._bind=function(e,t,n){var o,r,i=this,s=i.sheets;for(i.rv.push({type:e,data:t,fn:n}),a.GC$(i.sv).bind(e+Z,t,n),o=0,r=s;o<r.length;o++)r[o]._bind(e,t,n)},e.prototype._unbind=function(e,t){var n,o,r,i=this,s=i.sheets,l=i.rv;for(n=0;n<l.length;n++)l[n].type===e&&l.splice(n,1);for(a.GC$(i.sv).unbind(e+Z,t),o=0,r=s;o<r.length;o++)r[o]._unbind(e,t)},e.prototype.nu=function(){var e,t,n=this,o=n.sheets;for(n.rv.length=0,a.GC$(n.sv).unbind(Z),e=0,t=o;e<t.length;e++)t[e].nu()},e.prototype.Wq=function(e,t){0===this.jm&&a.GC$(this.sv).trigger(e,t)},e.prototype.tw=function(e,t,n,o){this.Wq(s.Events.ButtonClicked,{sheet:e,sheetName:e.name(),row:t,col:n,sheetArea:o})},e.prototype.pw=function(e){var t,n,o;for(t=0,n=this.rv;t<n.length;t++)o=n[t],e.bind(o.type,o.data,o.fn)},e.prototype.suspendEvent=function(){var e,t,n=this.sheets;for(this.jm++,e=0,t=n;e<t.length;e++)t[e].suspendEvent()},e.prototype.resumeEvent=function(){var e,t,n=this,o=n.sheets;for(n.jm--,n.jm<0&&(n.jm=0),e=0,t=o;e<t.length;e++)t[e].resumeEvent()},e.prototype.focus=function(e){if(!1===e)s.Vl.Zl(D);else{var t=be(this);t&&t.zt()}},e.prototype.Wv=function(){return this.Vv>2007?15:18},e.prototype.Xv=function(){return this.Vv>2007?22:this.Wv()},e.prototype.cec=function(e){var t,n=this,o=e?n.Cv:n.Kv,r=e?n.St:n.Pt,i=n.options.scrollbarAppearance===m.ScrollbarAppearance.mobile;if(o&&r&&i)switch(t=n.ku,r.iec){case m.ScrollbarState.hide:t.Rdc(e);break;case m.ScrollbarState.show:t.Tdc(o),t.Wdc(e);break;case m.ScrollbarState.active:t.Tdc(o),t.Wdc(e),t.Udc(o);break;case m.ScrollbarState.unactive:t.Vdc(o),t.Rdc(e)}},e.prototype.Jv=function(){return this.Vv>2007?28:this.Wv()},e.prototype.uw=function(e,t,n,o){var r,i="auto",s=this;s.vw||(r=M(J),a.GC$(r).addClass("gc-spread-toolTip ui-state-default ui-widget-content btn-default").css({position:ee,padding:"0px 3px 0px 3px",font:N("normal normal normal 11pt calibri"),"box-shadow":"1px 2px 5px rgba(0,0,0,0.4)","white-space":"pre-wrap"}).width(i).height(i).appendTo(E.body),s.vw=r),s.ww(e,t,n,o)},e.prototype.ww=function(e,t,n,o){var r,i,s,l,u,c,f=be(this);f&&((r=this.vw)&&(i=a.GC$(r),e?(i.html(y.Ob(e)),i.show()):i.hide(),s=f.Vs(),o&&(n-=s.top,t-=s.left),u=(l=f.Dr()).x+l.width-i.outerWidth(),c=l.y+l.height-i.outerHeight(),u<0?t=0:c<0?n=0:(n=_(n,c),t=_(t,u)),A(n)||i.css("top",n+s.top),A(t)||i.css("left",t+s.left)))},e.prototype.xw=function(){var e=this.vw;e&&(a.GC$(e).remove(),this.vw=D)},e.prototype.Av=function(){var t,n,o,r,i,a,l,u,c,f=this,h=f.sheets;for(s.mn.wn(),f.invalidateLayout(),t=0,n=h.length;t<n;t++)for(r=(o=h[t]).getRowCount(),i=o.getColumnCount(),a=0;a<r;a++)for(l=0;l<i;l++)(u=o.getValue(a,l))instanceof Date&&((c=o.getStyle(a,l))&&c.$o(u),o.Nq(a,l,c));f.repaint(),e.ao(f,"onCultureChanged")},e.prototype.getTab=function(){return this.hq},e.Qp=ye,e.nv=1,e.ov=0,e}(),t.Workbook=ve,s.Zn(ve),ve.prototype.nextControl=S("nextControl",D),ve.prototype.previousControl=S("previousControl",D)},"./dist/core/workbook/workbookpanelex.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe;function re(e){e.preventDefault?e.preventDefault():e.returnValue=!1}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/util/domUtil.js"),r=n("./dist/core/util/common.js"),i=n("@grapecity/js-sheets-common"),a=n("./dist/core/core.enum.js"),s=n("./dist/core/workbook/sheettabbase.js"),l=i.Common.j.Fa,u=null,c=r.Ul.Ml,f=r.Ul.nl,h=r.Ul.Nl,p=r.Ul.Pl,d=document,g=window,m=Math.round,y=Math.ceil,v="gc-scroll-arrow",b="gc-scrollbar-wrapper",C="gc-scroll-mobile-track",w="gc-scroll-mobile-thumb",x="gc-scroll-mobile-state-active",A="gc-no-user-select",M="width",S="height",T="gc-scrollbar-stateActive ui-state-active",N="left",I="right",R="top",k="bottom",E="position",D="border",j="padding",_="margin",O="overflow",F="display",P="100%",H="borderWidth",B="boxSizing",L="absolute",z="relative",G="mousedown"+(V=".gcScrollbar"),W="mouseup"+V,U="mousemove"+V,Z="mouseover"+V,q="mouseout"+V,J="mousewheel",Q="inline-block",Y="content-box",K="DOMMouseScroll",$="scroll"+V,function(e){e[e.horizontalScroll=0]="horizontalScroll",e[e.verticalScroll=1]="verticalScroll"}(X||(X={})),ee=function(){function e(e,t,n,o,r,i,s,l,c){this.updateStateFn=c;var f=this;f.jec=l,f.JB=!1,f.KB=!1,f.LB=u,f.MB=u,f.NB=300,f.OB=70,f.PB=e,f.Jwa(a.ScrollbarState.show),f.Vo("number"==typeof t?t:0),f._v("number"==typeof n?n:0),f.dw("number"==typeof o?o:0),f.cw("number"==typeof r?r:0),f.bw("number"==typeof i?i:0),f.QB="number"==typeof s?s:1,f.RB=!1,f.SB=0,f.Qb=f.bw(),f.ew()}return e.prototype.Bv=function(){return this.TB},e.prototype.Jwa=function(e){e===a.ScrollbarState.unactive&&this.JB||(this.iec=e,this.updateStateFn&&this.updateStateFn())},e.prototype.value=function(e){var t,n=this;return 0===arguments.length?n.Qb:("number"==typeof e&&e<=n.cw()&&e>=n.bw()&&(n.Qb=e,t=(e-n.bw())*n.UB,n.scrollTo(t,!0)),n)},e.prototype.ew=function(){var e,t,n,r=this,i=0,s=0,l=!1,u=r.jec===a.ScrollbarAppearance.mobile,c=u?0:2,f=r._v(),p=r.Vo(),d=u?0:f,g=p-2*d,y=d,x=N,T=I,V="gc-scroll-arrowLeft",G="gc-scroll-arrowRight",W="gc-scrollbar-horizontal",U="margin-left",Z="ui-button ui-state-default ui-corner-bl btn btn-default",q="ui-icon ui-icon-triangle-1-w",J="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",K="ui-icon ui-icon-grip-solid-vertical",$="ui-button ui-state-default ui-corner-br btn btn-default",X="ui-icon ui-icon-triangle-1-e";r.VB=g,r.PB||(g=d=u?0:p,y=f-2*d,x=R,T=k,V="gc-scroll-arrowUp",G="gc-scroll-arrowDown",W="gc-scrollbar-vertical",U="margin-top",Z="ui-button ui-state-default ui-corner-tr btn btn-default",q="ui-icon ui-icon-triangle-1-n",J="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",K="ui-icon ui-icon-grip-solid-horizontal",$="ui-button ui-state-default ui-corner-br btn btn-default",X="ui-icon ui-icon-triangle-1-s",r.VB=y),e=r.VB,t=r.cw()-r.bw(),r.dC=r.dw()*e/(t+r.dw()),r.dC>e&&(r.dC=e),r.dC<10&&(r.dC=10),n=r.dC,r.UB=0===t?1:(e-n)/t,r.PB?(i=n,s=d):(i=d,s=n),r.WB||(l=!0,r.TB=h("div"),r.WB=o.GC$(r.TB),r.WB.css([E,N,R,O,"outline",j,_],[z,0,0,"hidden","none",0,0]).addClass("gc-scroll-container gc-scroll-corner-all ui-widget ui-corner-all ")),u?r.WB.addClass(C):r.WB.removeClass(C),r.XB||function(e){r.XB=o.GC$.Nl("div",[E,F,H,j,_,B],[L,Q,"1px",0,0,Y],v+" "+Z,e),r.YB=o.GC$.Nl("span",[F,D,j,_],["block","none",0,0],V+" "+q,r.XB)}(r.WB),r.ZB||function(e){r.ZB=o.GC$.Nl("div",[E,F,B,D,j,_],[L,Q,Y,"none",0,0],b+" "+b,e)}(r.WB),r.$B?r.$B.removeAttr("style"):function(e){r.$B=o.GC$.Nl("div",[],[],A+" "+J+" gc-scroll-bar",e),r._B=o.GC$.Nl("span",[F,D,j,_],["block","none",0,0],W+" "+K,r.$B)}(r.ZB),u?r.$B.css(E,L).addClass(w):r.$B.css([E,H,j,_,B],[L,"1px",0,0,Y]).removeClass(w),r.aC||function(e){r.aC=o.GC$.Nl("div",[E,F,H,j,_,B],[L,Q,"1px",0,0,Y],v+" "+$,e),r.bC=o.GC$.Nl("span",[F,D,j,_],["block","none",0,0],G+" "+X,r.aC)}(r.WB),u?(function(e,t){var n=e.get(0);n&&(n.style[t]="")}(r.WB,"border"),r.PB?(r.WB.css([M,S],[P,P]),r.ZB.css([x,M,S],[d,P,P]),r.$B.css([x,M,S],[r.SB,m(i-c),P])):(r.WB.css([M,S],[P,P]),r.ZB.css([x,M,S],[d,P,P]),r.$B.css([x,M,S],[r.SB,P,m(s-c)])),r._B.remove(),r.XB.remove(),r.aC.remove()):(r.WB.css([M,S,D],[p,f,"none"]),r.ZB.css([x,M,S],[d,g,y]),r.$B.css([x,M,S],[r.SB,m(i-c),m(s-c)]),r.XB.css([x,M,S],[0,d-c,d-c]),r.YB.css([M,S],[P,P]),r.aC.css([T,M,S],[0,d-c,d-c]),r.bC.css([M,S],[P,P]),r._B.css([M,S,U],[d-c,d-c,Math.floor((r.dC-d)/2)]),r.$B.append(r._B),r.WB.append(r.XB),r.WB.append(r.aC)),l&&r.eC()},e.prototype.eC=function(){var t=this;function n(e,n){e.bind(G,(function(e){t.fC(e,n)})).bind(W,(function(e){t.gC(e,n)})).bind(Z,(function(e){t.hC(e,n)})).bind(q,(function(e){t.iC(e,n)}))}n(t.XB,!0),n(t.aC,!1),t.$B.bind(G,(function(e){t.jC(e)})).bind(U,(function(e){t.kC(e)})).bind(W,(function(e){t.lC(e)})).bind(Z,(function(e){t.mC(e)})).bind(q,(function(e){t.nC(e)})),t.ZB.bind(G,(function(e){var n,o;c&&c.mozilla&&(n=(new Date).valueOf(),o=t.oC,t.oC=n,o&&n-o<100)||t.pC(e)})).bind(W,(function(e){t.qC(e)})),t.GB=function(e){t.sC(e)},t.WB.bind(J,t.GB),t.WB.bind(K,t.GB),e.ao(t,"initEvents",t.TB)},e.prototype.$dc=function(e){this.jec=e},e.prototype.dispose=function(){var t=this;function n(e){e&&e.unbind(V)}n(t.aC),n(t.$B),n(t.XB),n(t.ZB),t.WB&&(t.GB&&(t.WB.unbind(J,t.GB),t.WB.unbind(K,t.GB)),e.ao(t,"dispose",t.TB),t.WB.unbind(V).remove())},e.prototype.tC=function(){var e=this;e.RB||(o.GC$(d).bind(U,(function(t){e.kC(t)})).bind(W,(function(t){e.lC(t)})),e.RB=!0)},e.prototype.uC=function(){this.RB&&(this.RB=!1,o.GC$(d).unbind(U).unbind(W))},e.prototype.fC=function(e,t){var n,o=0,r=this,i=!0;r.KB=!0,null===r.LB&&(t?(r.XB.addClass(T),o=0-r.qB(),r.vC=a.Nxb.smallDecrement):(r.aC.addClass(T),o=r.qB(),r.vC=1),(n=function(){r.scrollTo(r.SB+o*r.UB,!1),r.LB=g.setTimeout(n,i?r.NB:r.OB),i=!1})(),re(e))},e.prototype.gC=function(e,t){var n=this;(t?n.XB:n.aC).removeClass(T),n.wC(),re(e)},e.prototype.hC=function(e,t){(t?this.XB:this.aC).addClass("gc-scroll-arrow-hover ui-state-hover"),re(e)},e.prototype.iC=function(e,t){var n=this;(t?n.XB:n.aC).removeClass("gc-scroll-arrow-hover ui-state-hover "+T),n.wC(),re(e)},e.prototype.jC=function(e){var t,n,o,r,i,s,l=this;0===e.button&&(l.JB=!0,l.xC={x:e.pageX,y:e.pageY},l.Jwa(a.ScrollbarState.show),l.tC(),l.WB.addClass(x),l.$B.addClass(T),t=l.$B.offset(),n=l.$B.outerWidth(!0),o=l.$B.outerHeight(!0),r=l.ZB.offset(),i=l.ZB.outerWidth(!0),s=l.ZB.outerHeight(!0),l.yC={isBeyondEdge:!1,startEdgePosition:{x:r.left+e.pageX-t.left,y:r.top+e.pageY-t.top},endEdgePosition:{x:r.left+i-(n-e.pageX+t.left),y:r.top+s-(o-e.pageY+t.top)}}),re(e)},e.prototype.kC=function(e){var t=this;t.JB&&(t.Jwa(a.ScrollbarState.active),t.zC={x:e.pageX,y:e.pageY},t.AC(),t.xC=t.zC,o.GC$(d.body).attr("unselectable","on").addClass(A)),re(e)},e.prototype.lC=function(e){var t,n,r,i=this;i.JB=!1,i.vC=a.Nxb.thumbPosition,i.yC=null,i.WB.trigger($,{newValue:i.Qb,oldValue:i.Qb,scrollOrientation:i.PB?X.horizontalScroll:X.verticalScroll,scrollEventType:i.vC}),t=(i.Qb-i.bw())*i.UB,n="left",r=e.target.classList.contains(w),i.PB||(n="top"),r?i.Jwa(a.ScrollbarState.hide):i.Jwa(a.ScrollbarState.unactive),i.SB=t,i.$B.css(n,m(t)),i.uC(),o.GC$(d.body).removeClass(A),o.GC$(d.body).attr("unselectable")&&o.GC$(d.body).removeAttr("unselectable"),i.$B.removeClass(T),i.WB.removeClass(x),i.vC=6,i.WB.trigger($,{newValue:i.Qb,oldValue:i.Qb,scrollOrientation:i.PB?X.horizontalScroll:X.verticalScroll,scrollEventType:i.vC}),re(e)},e.prototype.mC=function(e){this.$B.addClass("gc-scrollbar-stateHover ui-state-hover"),re(e)},e.prototype.nC=function(e){this.$B.removeClass("gc-scrollbar-stateHover ui-state-hover"),re(e)},e.prototype.sC=function(e){var t,n,o=this;l(e.wheelDelta)&&l(e.detail)&&(e.wheelDelta=e.originalEvent.wheelDelta,e.detail=e.originalEvent.detail),t=(e.detail?e.detail:e.wheelDelta/-40)/3*o.qB()*o.UB,o.vC=t>=0?1:0,o.scrollTo(o.SB+t,!1),o.vC=6,n={newValue:o.Qb,oldValue:o.Qb,scrollOrientation:o.PB?X.horizontalScroll:X.verticalScroll,scrollEventType:o.vC},o.WB.trigger($,n),re(e)},e.prototype.pC=function(e){var t,n=this,o=!0,r=e.pageX,i=e.pageY,s=0,l=n.ZB.offset(),u=n.rB();null===n.MB&&(s=n.PB?r-l.left-n.SB:i-l.top-n.SB,(t=function(){var e,c=n.SB;if((e=n.PB?r-l.left-c:i-l.top-c)*s<0||e>=0&&e<n.dC)n.CC();else{if(s<0)n.vC=a.Nxb.largeDecrement,n.scrollTo(c-u*n.UB,!1);else{if(!(s>0))return void n.CC();n.vC=a.Nxb.largeIncrement,n.scrollTo(c+u*n.UB,!1)}n.MB=g.setTimeout(t,o?n.NB:n.OB),o=!1}})(),re(e))},e.prototype.qC=function(e){this.CC(),re(e)},e.prototype.CC=function(){var e,t=this;t.MB&&clearTimeout(t.MB),t.MB=u,t.vC=a.Nxb.endScroll,e={newValue:t.Qb,oldValue:t.Qb,scrollOrientation:t.PB?X.horizontalScroll:X.verticalScroll,scrollEventType:t.vC},t.WB.trigger($,e)},e.prototype.wC=function(){var e,t=this;t.KB&&(t.KB=!1,t.LB&&clearTimeout(t.LB),t.LB=u,t.vC=6,e={newValue:t.Qb,oldValue:t.Qb,scrollOrientation:t.PB?X.horizontalScroll:X.verticalScroll,scrollEventType:t.vC},t.WB.trigger($,e))},e.prototype.AC=function(){var e,t,n,o,r,i=this,a=i.SB,s=i.zC,l=i.yC;function u(e){return i.PB?e.x:e.y}function c(e,t){i.PB?e.x=t:e.y=t}if(e=u(s),t=u(i.xC),l&&l.isBeyondEdge){if(n=u(l.startEdgePosition),o=u(l.endEdgePosition),e<n||e>o)return;t<n&&c(i.xC,n),t>o&&c(i.xC,o)}(r=a+(e-t))!==a&&(i.vC=5,i.scrollTo(r,!1))},e.prototype.scrollTo=function(e,t){var n,o,r,i,s,u,c,f,h=this,p=R,d=h.VB-h.dC;h.PB&&(p=N),n=!1,o=!1,r=!1,e>d&&(e=d,r=!0,o=!0),e<0&&(e=0,r=!0,n=!0),h.yC&&(h.yC.isBeyondEdge=r),i=h.QB===a.ScrollType.continuous?m(e/h.UB)+h.bw():e/h.UB+h.bw(),s=h.Qb,u=!1,t||(f={newValue:i,oldValue:s,scrollOrientation:h.PB?X.horizontalScroll:X.verticalScroll,scrollEventType:h.vC,isBeyondMaxEdge:o,isBeyondMinEdge:n},h.WB.trigger($,f),u=f.ignoreUpdatePosition,f.newValue>h.cw()&&(f.newValue=h.cw()),i=f.newValue,c=f.newValueWithOffset),l(c)&&(c=i),h.Qb=i,5!==h.vC&&(e=(c-h.bw())*h.UB),h.SB=e,u||h.$B.css(p,m(e))},e.prototype.hitTest=function(e,t){var n,r,i,s,l=this,u=l.$B.outerWidth(),c=l.XB.outerWidth(),f=l.ZB.outerWidth(),h=l.$B.offset(),p=o.GC$(l.Bv()).offset(),d=h.left-p.left-18;return l.PB?e<0+f+c&&e>0+c?e<0+d+u+c&&e>d?{element:a.Oxb.ThumbButton,x:e,y:t}:{element:a.Oxb.TrackButton}:e<=0+c&&e>0?{element:a.Oxb.LeftButton,x:e,y:t}:{element:a.Oxb.RightButton,x:e,y:t}:(n=l.$B.outerHeight(),r=l.XB.outerHeight(),i=l.ZB.outerHeight(),s=h.top-p.top-18,t<0+i+r&&t>0+r?t<0+s+n+r&&t>s?{element:a.Oxb.ThumbButton,x:e,y:t}:{element:a.Oxb.TrackButton}:t<=0+r&&t>0?{element:a.Oxb.UpButton,x:e,y:t}:{element:a.Oxb.DownButton,x:e,y:t})},e.prototype.pia=function(){return{x:0,y:0,width:this.Vo(),height:this._v()}},e.prototype.show=function(){this.ZB.show()},e.prototype.hide=function(){this.ZB.hide()},e.prototype.wDc=function(e){var t=this.WB.parent()&&this.WB.parent().parent();return t?e?t.height():t.width():u},e}(),t.hv=ee,r.Zn(ee),(te=ee.prototype).qB=p("smallChange",1),te.rB=p("largeChange",10),te.dw=p("pageValue",10,(function(e){e<=0&&this.dw(1)})),te.cw=p("maximum",100,(function(e){e<=0&&this.cw(0)})),te.bw=p("minimum",0,(function(e){e<=0&&this.bw(0)})),te.Vo=p("width",0),te._v=p("height",0),ne=function(){function e(e,t){var n=this;n.fB=!0,n.gB=!0,n.hB=18,n.iB=e&&o.GC$(e),n.jB=t&&o.GC$(t),n.ew(!0)}return e.prototype.ew=function(e){var t,n,r,i,a,s,l,f,h,p,d,g=this;function v(e){return e===L?o.GC$.Nl("div",[E,N,R,D,j,_],[L,0,0,"none",0,0]):e===z?o.GC$.Nl("div",[E,N,R,D,j,_],[z,0,0,"none",0,0]):u}function b(e,t){var n,r,i,a=t?g.mB:g.nB;return a||(n=new ee(t),r=o.GC$.Nl("div"),t?(g.oB=r,g.mB=n,r.css([E,N,k,D,j,_],[L,0,0,"none",0,0])):(g.pB=r,g.nB=n,r.css([E,I,R,D,j,_],[L,0,0,"none",0,0])),i=(t?g.mB:g.nB).Bv(),r.append(i),e.append(r),n)}function C(e,t,n,r,i,a){a?(g.oB.css([M,S],[t,r]),e.Vo(t),e._v(r)):(g.pB.css([M,S],[r,t]),e.Vo(r),e._v(t)),e.bw(0),e.cw(i-t),e.dw(t),e.qB(a?g.kB():g.lB()),e.rB(t),e.ew(),o.GC$(e.Bv()).bind($,(function(e,t){n.css(a?N:R,0-t.newValue)})),a?g.oB.show():g.pB.show()}g.iB&&g.jB&&(t=g.hB,n=g.jB.width(),r=g.jB.height(),s=(i=g.iB.width())-t,l=(a=g.iB.height())-t,f=!1,g.uB||(g.uB=v(z),g.uB.css([E,O],[z,"hidden"]),f=!0),g.uB.css(S,a),function(e){g.sB||(g.sB=v(z),g.sB.css([O,F],["hidden",Q]),e.append(g.sB))}(g.uB),function(e){g.tB||(g.tB=o.GC$.Nl("div",E,z,u,e))}(g.sB),e&&g.tB.append(g.jB).css([R,N],[0,0]),c.chrome&&(n=m(n),r=m(r),i=y(i),a=y(a)),p=(h=g.vB(n,r,i,a)).wB,(d=h.xB)?(p||(s+=t),C(b(g.uB,!0),s,g.tB,t,n,!0)):g.oB&&g.oB.hide(),p?(d||(l+=t),C(b(g.uB,!1),l,g.tB,t,r,!1)):g.pB&&g.pB.hide(),d||p||(s+=t,l+=t),g.fB=d,g.gB=p,g.yB=s,g.zB=l,g.sB.css(S,l),f&&(g.iB.append(g.uB),g.AB()))},e.prototype.BB=function(e){var t=this,n=t.CB(e),o=n.EB,r=n.FB;!l(o)&&t.mB&&t.lu(o),!l(r)&&t.nB&&t.ju(r)},e.prototype.lu=function(e){var t,n,o=this;o.mB.value(e),t=o.yB,n=o.jB.width(),e>=0&&e<=n-t&&o.tB.css(N,0-e)},e.prototype.ju=function(e){var t,n,o=this;o.nB.value(e),t=o.zB,n=o.jB.height(),e>=0&&e<=n-t&&o.tB.css(R,0-e)},e.prototype.vB=function(e,t,n,o){var r=n,i=o-this.hB,a={xB:!1,wB:!1};return e>n&&(a.xB=!0,a.wB=t>i),t>o&&(a.wB=!0,a.xB=e>r),a},e.prototype.CB=function(e){var t,n,r,i,a,s,l,c=o.GC$(e),f=this.sB,h=this.tB,p={EB:u,FB:u};return e?(t=c.offset(),n=h.offset(),r=f.offset(),t.leftWidth=t.left+c.outerWidth(),t.topHeight=t.top+c.outerHeight(),r.leftWidth=r.left+f.outerWidth(),r.topHeight=r.top+f.outerHeight(),i=t.left-n.left,t.left<r.left?p.EB=i:t.leftWidth>r.leftWidth&&(a=t.leftWidth-n.left-f.innerWidth(),p.EB=i<a?i:a),s=t.top-n.top,t.top<r.top?p.FB=s:t.topHeight>r.topHeight&&(l=t.topHeight-n.top-f.innerHeight(),p.FB=s<l?s:l),p):p},e.prototype.AB=function(){var e=this;this.tB&&(e.GB=function(t){e.HB(t)},e.tB.bind(J,e.GB),e.tB.bind(K,e.GB))},e.prototype.HB=function(e){var t,n,o,r,i,a,s=this;l(e.wheelDelta)&&l(e.detail)&&(e.wheelDelta=e.originalEvent.wheelDelta,e.detail=e.originalEvent.detail),t=e.detail?e.detail:e.wheelDelta/-40,n=s.nB,o=parseInt(s.tB.css(R),10),r=s.zB,(i=s.jB.height())<r&&(i=r),isNaN(o)&&(o=0),(a=o-t*s.lB())>=0&&(a=0),a<0&&0-a>i-r&&(a=0-(i-r)),a!==o&&(s.tB.css(R,a),s.gB&&n.value(0-a)),f(e)},e.prototype.dispose=function(){var e=this;e.uB&&(e.mB&&e.mB.dispose(),e.nB&&e.nB.dispose(),e.tB&&e.GB&&(e.tB.unbind(J,e.GB),e.tB.unbind(K,e.GB)),o.GC$(e.uB).remove())},e}(),t.IB=ne,(oe=ne.prototype).kB=p("horizontalSmallChange",10),oe.lB=p("verticalSmallChange",10),s.DC.$n("scrollbar",{preProcessMouseMove:function(e){var t=this.OC;(t.St.JB||t.Pt.JB)&&(e.r=!0)}})},"./dist/core/worksheet/clipboardhelper.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d;function g(e){return e&&e.options.allowCopyPasteExcelStyle}function m(e,t){var n,o;if(c.msie){for(n=[],o=0;o<e.length;o++)t&&""===e[o].trim()||n.push(e[o]);return n.join("")}return e.join("")}function y(e,t,n,o){var r,i,a=[];for(r=0,i=n;r<i;r++)a[r]=e.getRowHeight(t+r,o);return a}function v(e,t,n,o){var r,i,a=[];for(r=0,i=n;r<i;r++)a[r]=e.getColumnWidth(t+r,o);return a}function b(e,t,n){var o,r=-1;if(n)for(r=0,o=0;o<t;o++)r+=n[e+o]||0;return r}function C(e,t,n){var o,r=-1;if(n)for(r=0,o=0;o<t;o++)r+=n[e+o]||0;return r}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/util/common.js"),r=n("@grapecity/js-sheets-common"),i=n("./dist/core/worksheet/stylehelper.js"),a=n("./dist/core/worksheet/style.js"),s=n("./dist/core/core.enum.js"),l=r.Common.u,u=/<img[^>]+>/g,c=o.Ul.Ml,f=r.Common.j.Fa,h=r.Common.k.Bb,p=null,d=function(){function e(e){var t=this;t.PA=p,t.n5=p,t.G4=!1,t.tc=e,t.Nl()}return e.prototype.Nl=function(){var t,n,o,r=this,i=document.createElement("div");i.style.position="fixed",i.style.top="0px",i.style.left="0px",i.style.width="0px",i.style.height="0px",i.style.overflow="hidden",(t=document.createElement("div")).setAttribute("contenteditable","true"),t.setAttribute("gcUIElement","gcSheetClipboard"),t.setAttribute("tabindex","-1"),t.style.position="absolute",t.style.overflow="hidden",t.style.background="white",t.style.webkitUserSelect="text",i.appendChild(t),r.KM=t,(n=document.createElement("textarea")).setAttribute("gcUIElement","gcSheetClipboard"),r.tc&&r.tc.options.enableAccessibility&&n.setAttribute("aria-hidden","true"),n.setAttribute("tabindex","-1"),n.style.position="absolute",n.style.overflow="hidden",n.style.background="white",n.style.webkitUserSelect="text",i.appendChild(n),r.qka=n,(o=r.tc.getHost())&&o.appendChild(i),c.msie||c.edge||(r.H4=function(t){var n,o,i,a,s,l,c,f=r.tc.getActiveSheet(),h=t.clipboardData;if(h)if(n=(n=h.getData("text/html")).replace(u,""),(o=r.I4()).innerHTML=n,i=n?r.EZa(o,!0):e.formatClipboardData(h.getData("text/plain")),o.innerHTML="",i||n)f.J4(i,n);else{for(a=void 0,s=h.items,l=0;l<s.length;l++)if(0===s[l].type.indexOf("image")){a=s[l].getAsFile();break}a&&((c=new FileReader).onload=function(e){var t=new Image;t.src=e.target.result,t.onload=function(){f.J4(i,n,t.src)}},c.readAsDataURL(a))}t.preventDefault()},t.addEventListener("paste",r.H4),r.rka=function(t){var n,o,i,a=r.tc.getActiveSheet(),s=t.clipboardData;s&&((n=e.formatClipboardData(s.getData("text/plain")))||(o=s.getData("text/html"))&&((i=r.I4()).innerHTML=o,n=r.EZa(i,!1),i.innerHTML=""),a.J4(n,"")),t.preventDefault()},n.addEventListener("paste",r.rka))},e.prototype.no=function(){var e,t,n,o,r,i,a=this,s=a.KM;s&&(c.msie||c.edge||(s.removeEventListener("paste",a.H4),a.qka.removeEventListener("paste",a.rka)),(e=s.parentElement)&&((t=e.parentElement)&&t.removeChild(e)),a.KM=p,a.qka=p),(n=a.K4)&&((o=n.parentElement)&&o.removeChild(n),a.K4=p),(r=a.FZa)&&((i=r.parentElement)&&i.removeChild(r),a.FZa=p),a.tc=p},e.prototype.ska=function(e){g(this.tc)?this.KM.innerHTML=e:this.qka.value=e},e.prototype.M4=function(){g(this.tc)?this.KM.focus():this.qka.focus()},e.prototype.N4=function(){g(this.tc)?document.execCommand("selectAll"):this.qka.select()},e.prototype.wx=function(){var t,n,o,r="",i="",a="";return g(this.tc)?((t=this.KM)&&((n=t.getElementsByTagName("table")).length>0?r=n[0].outerHTML:(o=t.getElementsByTagName("img")).length>0&&(a=o[0].src)),i=this.EZa(this.KM,!0)):i=e.formatClipboardData(this.qka.value),{html:r,text:i,image:a}},e.Q4=function(t,n,r,i,a,l,u,c,f,h,d,g,m,b){var C,w,x,A,M,S,T,N,I,R,k,E=t.Tq(o.kf(r,a,i,l),u),D=RegExp(String.fromCharCode(32),"g"),j="&nbsp;",_=!1,O=!1;return u===s.SheetArea.viewport&&(r<0&&2==(2&n)&&(_=!0),a<0&&1==(1&n)&&(O=!0)),r=E.row,a=E.col,i=E.rowCount,l=E.colCount,C=d?t.options.gridline:p,w=d?{color:"#d4d4d4",showHorizontalGridline:!0,showVerticalGridline:!0}:p,x=m?y(t,r,i,u):p,A=m?v(t,a,l,u):p,u===s.SheetArea.viewport?(M=void 0,S=void 0,T=p,N=p,I=e.Ema(t,r,i,a,l,3,f,h,c,E,D,j,C,g,x,A,b),O&&(M=m?v(t,a,l,2):p,R=t.getColumnCount(2),T=e.Ema(t,r,i,0,R,2,f,[],c,E,D,j,w,g,x,M,b)),_&&(S=m?y(t,r,i,1):p,k=t.getRowCount(1),N=e.Ema(t,0,k,a,l,1,[],h,c,E,D,j,w,g,S,A,b)),e.yb(I,T,N,b)):u===s.SheetArea.rowHeader?(T=e.Ema(t,r,i,a,l,2,f,h,c,E,D,j,w,g,x,A,b),e.yb(T,p,p,b)):u===s.SheetArea.colHeader?(N=e.Ema(t,r,i,a,l,1,f,h,c,E,D,j,w,g,x,A,b),e.yb(N,p,p,b)):void 0},e.yb=function(t,n,o,r){var i,a=t,s=0,l=function(e,t){var n,o=[],r=e.length;for(n=0;n<r;n++)o.push(e[n].concat(t[n]));return o};return n&&(s=n[0].length,a=l(n,t)),o&&(i=o.length,s&&(o=l(e.Ema(p,0,i,0,s,p,[],[],!1,p,p,p,p,!1,[],[],r),o)),a=o.concat(a)),e.Fma(a,r)},e.Fma=function(e,t){var n,o,r="",i=e.length;for(r+=t?'<table style="border-collapse: collapse">':"<table>",n=0;n<i;n++){for(r+="<tr>",o=0;o<e[n].length;o++)r+=e[n][o];r+="</tr>"}return r+"</table>"},e.Ema=function(t,n,r,i,a,s,u,d,g,m,y,v,w,x,A,M,S){var T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe,re,ie,ae,se;for(w&&(T=w.color,N=w.showHorizontalGridline,I=w.showVerticalGridline),R=[],k=0;k<r;k++)if(!h(u,E=n+k)){for(D=[],j=0;j<a;j++)h(d,_=i+j)||(O="",F=void 0,P=void 0,H=1,B=1,g&&t&&((F=t.getSpan(E,_,s))&&e.isPartSpan(F,m,u,d)&&(F=p),F&&(F.row!==E||F.col!==_))||(O+="<td",L=t&&t.getValue(E,_,s),g&&t&&(F&&((H=F.rowCount)>1&&(O+=" rowSpan="+H),(B=F.colCount)>1&&(O+=" colSpan="+B)),P=t.getActualStyle(E,_,s),z=e.convertVAlign,V=e.convertHAlign,G=e.convertLineBorder,O+=S?' style="padding: 0; word-break: break-all; ':' style="',W=N,U=I,(Z=P.backColor)&&(O+="background-color: "+Z+";",W=!1,U=!1),(q=P.foreColor)&&(O+="color: "+q+";"),(J=P.font)&&(x&&(J=J+", "+o.FallbackFontFamily),O+="font: "+J.replace(/"/g,"'")+";"),Q=P.vAlign,f(Q)||(O+="vertical-align: "+z(Q)+";"),Y=P.hAlign,f(Y)||(S&&(Y=o.Ul.ol(Y,L)),(K=V(Y))&&(O+="text-align: "+K+";")),($=P.borderLeft)&&(O+="border-left: "+G($)+";",U=!1),(X=P.borderRight)&&(O+="border-right: "+G(X)+";",U=!1),(ee=P.borderTop)&&(O+="border-top: "+G(ee)+";",W=!1),(te=P.borderBottom)&&(O+="border-bottom: "+G(te)+";",W=!1),W&&U?O+="border: 1px solid "+T+";":W?(O+="border-top: 1px solid "+T+";",O+="border-bottom: 1px solid "+T+";"):U&&(O+="border-left: 1px solid "+T+";",O+="border-right: 1px solid "+T+";"),O+='"'),O+=">",ne=void 0,oe=void 0,g&&t&&((oe=1==(1&(re=P.textDecoration)))||(oe=8==(8&re)),(ne=2==(2&re))&&(O+="<s>"),oe&&(O+="<u>")),(ie=t?t.getText(E,_,s):"")?(" "!==ie[0]&&" "!==ie[ie.length-1]||"number"!=typeof L||(ie=ie.trim()),ie=l.Ob(ie).replace(y,v)):c.chrome?ie=" ":c.safari&&(ie="&nbsp;"),(ae=b(k,H,A))>0&&(ae-=1),(se=C(j,B,M))>0&&(se-=1),O+=ae>=0&&se>=0?'<div style="overflow: hidden; height: '+ae+"px; width: "+se+'px;">'+ie+"</div>":ie,g&&(oe&&(O+="</u>"),ne&&(O+="</s>")),O+="</td>",D.push(O)));R.push(D)}return R},e.prototype.I4=function(){var e,t,n=this;return n.K4||((e=document.createElement("div")).style.display="none",(t=n.tc.getHost())&&t.appendChild(e),n.K4=e),n.K4},e.prototype.GZa=function(){var e,t,n=this;return n.FZa||((e=document.createElement("div")).style.display="none",(t=n.tc.getHost())&&t.appendChild(e),n.FZa=e),n.FZa},e.prototype.R4=function(e,t,n,o){var r,i,a,s,l,u,c,f,h,p,d,g=this.I4();if(g.innerHTML=e,(r=g.getElementsByTagName("table")).length>0)for(i=this.HZa(r[0],!0),a=0;a<i.length;a++)for(s=i[a],l=n+a,u=0;u<s.length;u++)(c=s[u])&&(f=o+u,t.Pq(l,f,c.style),h=c.rowSpan,p=c.colSpan,(h>1||p>1)&&((d=t.getSpan(l,f))?(d.row=l,d.col=f,d.rowCount=h,d.colCount=p):t.addSpan(l,f,h,p)));g.innerHTML=""},e.prototype.lgc=function(e,t,n,o){var r,i,a=t.pictures;a&&(r=function(e){for(var t="picture",n=1,o=t+""+n;e.get(o);)o=t+""+ ++n;return o}(a),(i=a.add(r,e,0,0)).startRow(n),i.startColumn(o))},e.prototype.HZa=function(t,n){var o,r,i,a,s,l,u,c,f,h,p,d=this.GZa(),g=[],m=/ +/g;for(o=0;o<t.rows.length;o++)for(r=t.rows[o],g[o]||(g[o]=[]),i=g[o],a=0,s=0;a<r.cells.length;a++){for(l=r.cells[a];i[s];)s++;for(u=i[s]={},c=void 0,n&&(c=e.getStyleFromDOM(l),u.style=c),d.innerHTML=l.innerHTML.replace(m," "),u.text=d.innerText,u.rowSpan=l.rowSpan,(f=l.getAttribute("style"))&&f.indexOf("mso-ignore:colspan;")>=0?u.colSpan=1:u.colSpan=l.colSpan,h=0;h<l.rowSpan;h++)for(p=0;p<l.colSpan;p++)0===h&&0===p||(g[o+h]||(g[o+h]=[]),g[o+h][s+p]={style:c,text:"",rowSpan:1,colSpan:1});s+=l.colSpan}return d.innerHTML="",g},e.prototype.EZa=function(e,t){var n,o,r,i,a,s,l,u,c,f,h=[];if(e)if((n=e.getElementsByTagName("table")).length>0)for(o=this.HZa(n[0],!1),r=RegExp(String.fromCharCode(160),"g"),i=String.fromCharCode(32),a=0,s=o.length;a<s;a++){for(u=0,c=(l=o[a]).length;u<c;u++)(f=l[u]?l[u].text:"").indexOf("\n")>=0&&(t?(f.indexOf("\r\n")>=0&&(f=m(f.split("\r\n"),!0)),f=m(f.split("\n"),!0)):f='"'+f+'"'),h.push(f.replace(r,i)),u<c-1&&h.push("\t");a<s-1&&h.push("\r\n")}else h.push(function(e){var t,n,o;if(!e)return e;for(t=0;t<e.length&&!((n=e.indexOf("\x3c!--",t))<0)&&(t=n,!((o=e.indexOf("--\x3e",t))<0));)t=o,e=e.substring(0,n)+e.substring(o+3);return e}(e.innerText).trim());return h.join("")},e.prototype.hZ=function(e){var t=this;t.PA=p,t.n5=p,t.G4=!1,t.tc.Wq("ClipboardStatusChanged",{isReset:!0,isSystemPasted:!!e})},e.isPartSpan=function(e,t,n,o){var r,i,a,s,l,u;if(!t.containsRange(e))return!0;for(r=0,i=n;r<i.length;r++)if(a=i[r],e.row<=a&&a<e.row+e.rowCount)return!0;for(s=0,l=o;s<l.length;s++)if(u=l[s],e.col<=u&&u<e.col+e.colCount)return!0;return!1},e.formatClipboardData=function(e){var t,n,o,r,i=[];if(e){for('"',t=!1,n=0;n<e.length;n++)o=n>0?e[n-1]:"",'"'===(r=e[n])?(t=!t,i.push('"')):t||"\n"!==r||"\r"===o?i.push(r):i.push("\r\n");return i.join("")}return""},e.convertHAlign=function(e){return{0:"left",1:"center",2:"right"}[e]},e.convertVAlign=function(e){return{0:"top",1:"middle",2:"bottom"}[e]},e.convertLineBorder=function(e){return{9:.5,1:.5,3:.5,4:.5,7:.5,11:.5,2:1,10:1,12:1,8:1,13:1,5:1.5,6:1.5}[e.style]+"pt "+{0:"none",1:"solid",2:"solid",3:"dashed",4:"dotted",5:"solid",6:"double",7:"dotted",8:"dashed",9:"dashed",10:"dashed",11:"dashed",12:"dashed",13:"dashed"}[e.style]+" "+e.color},e.convertToHAlign=function(e){return{left:0,center:1,right:2}[e]},e.convertToVAlign=function(e){return{top:0,middle:1,bottom:2}[e]},e.convertToLineBorder=function(e,t,n){var o={none:0,solid:1,dashed:3,dotted:4,double:6};return(c.msie||c.edge)&&"2px"===n?o.solid=5:(n=Math.round(10*parseFloat(n)*3/4)/10)<=.8?o.solid=1:n<=1?(o.solid=2,o.dashed=8):n<=1.5&&(o.solid=5),new a.LineBorder(e,o[t])},e.convertToTextDecoration=function(e){return{underline:1,"line-through":2,none:0}[e]},e.isTransparent=function(e){return 0===r.Common.pc.ec(e).a},e.isBlack=function(e){var t=r.Common.pc.ec(e);return 0!==t.a&&0===t.r&&0===t.g&&0===t.b},e.getStyleFromDOM=function(t){var n,o,r,s,l,u,f,h,p,d,g,m,y,v,b=t.getElementsByTagName("font")[0],C=getComputedStyle(t),w=t.style,x=new a.Style,A=C.backgroundColor;return A&&!e.isTransparent(A)&&(x.backColor=A),n=C.color,b&&(n=b.color),n&&!e.isBlack(n)&&(x.foreColor=n),b?x.font=i.To.F4(getComputedStyle(b)):(o=i.To.F4(C))&&(x.font=o),r=C.verticalAlign,s=e.convertToVAlign,l=e.convertToHAlign,u=e.convertToLineBorder,f=e.convertToTextDecoration,r&&(x.vAlign=s(r)),h=w.textAlign,p=C.textAlign,c.msie||c.edge?x.hAlign=l(""!==h?h:"general"):p&&(x.hAlign=l(p)),"none"!==(d=C.borderLeftStyle)&&(x.borderLeft=u(C.borderLeftColor,d,C.borderLeftWidth)),"none"!==(g=C.borderRightStyle)&&(x.borderRight=u(C.borderRightColor,g,C.borderRightWidth)),"none"!==(m=C.borderTopStyle)&&(x.borderTop=u(C.borderTopColor,m,C.borderTopWidth)),"none"!==(y=C.borderBottomStyle)&&(x.borderBottom=u(C.borderBottomColor,y,C.borderBottomWidth)),v=f(C.textDecorationLine||C.textDecoration),t.getElementsByTagName("u").length>0&&(v|=f("underline")),t.getElementsByTagName("s").length>0&&(v|=f("line-through")),0!==v&&(x.textDecoration=v),x},e}(),t.S4=d},"./dist/core/worksheet/style.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M;function S(e,t,n,o){var r,a,l,u=t;if(n&&t){if(t.gQa&&t.gQa())return void(e.cellType=u);t.toJSON&&(t=t.toJSON()),r=s._o,a=t.typeName,(l=r[t.type]||r[a]||i.getTypeFromString(a))?(u=new l).fromJSON(t,o):u=h}e.cellType=u}function T(e,t,n){var r,a,s,l,u=t;n&&t&&"object"==typeof t&&(t.toJSON&&(t=t.toJSON()),(a=(r=o.Formatter)&&r.GeneralFormatter)&&((s=t.typeName)?(l=i.getTypeFromString(s))&&(u=new l).fromJSON(t):u=new a(t.formatCached,t.customerCultureName))),e.formatter=u}function N(e,t,n){var r,i,a=t;n&&t&&(t.toJSON&&(t=t.toJSON()),(i=(r=o.Formatter)&&r.GeneralFormatter)&&((a=new i(t.formatCached,t.customerCultureName)).isAuto=!0)),e._autoFormatter=a}function I(e,t,n){t&&((t=e.getColor(t))&&n(t))}function R(e,t,n){return e===g?2===n||1===n?1===t:3===t:e===m?2===n||1===n?1===t:0===t:e===y?1===t:e===p?t===h:void 0}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("./dist/core/util/domUtil.js"),i=n("./dist/core/util/common.js"),a=n("./dist/core/worksheet/stylehelper.js"),s=n("./dist/core/celltype/celltype.ns.js"),l=r.GC$.each,u=i.Ul,c=u.Ol,f=o.Common.j.C4,h=void 0,Math.sin,Math.cos,Math.abs,Math.max,p="autoFormatter",d="cellType",g="hAlign",m="vAlign",y="imeMode",v="labelOptions",b="cellButtons",C="dropDowns",w={borderLeft:!0,borderRight:!0,borderTop:!0,borderBottom:!0,diagonalDown:!0,diagonalUp:!0},function(e){e[e.empty=0]="empty",e[e.thin=1]="thin",e[e.medium=2]="medium",e[e.dashed=3]="dashed",e[e.dotted=4]="dotted",e[e.thick=5]="thick",e[e.double=6]="double",e[e.hair=7]="hair",e[e.mediumDashed=8]="mediumDashed",e[e.dashDot=9]="dashDot",e[e.mediumDashDot=10]="mediumDashDot",e[e.dashDotDot=11]="dashDotDot",e[e.mediumDashDotDot=12]="mediumDashDotDot",e[e.slantedDashDot=13]="slantedDashDot"}(t.LineStyle||(t.LineStyle={})),function(e){e[e.conditionalFormat=1]="conditionalFormat",e[e.cell=10]="cell",e[e.table=20]="table",e[e.row=30]="row",e[e.column=40]="column",e[e.sheet=50]="sheet"}(t.LineBorderComposeLevel||(t.LineBorderComposeLevel={})),x=function(){function e(e,t,n){this.color=e||"black",this.style=t||0,this.level=n}return e.prototype.Uo=function(){return new e(this.color,this.style,this.level)},e.prototype.toJSON=function(){var e={},t=this.color,n=this.style;return"black"!==t&&(e.color=t),0!==n&&(e.style=n),e},e.prototype.fromJSON=function(e,t){if(e){var n=e.color,o=e.style;c(n)&&(this.color=n),c(o)&&(this.style=o)}},e.Vo=function(e){return{9:1,1:1,3:1,4:1,7:1,11:1,2:2,10:2,12:2,8:2,13:2,5:3,6:3}[e&&e.style]||0},e}(),t.LineBorder=x,A=["backColor","foreColor",g,m,"font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage",d,"backgroundImageLayout","tabStop","textDecoration",y,"name","parentName","watermark","cellPadding",v,"quotePrefix","diagonalDown","diagonalUp","isVerticalText",b,C,"textOrientation"],M=function(){function e(){var t,n,o=this;if(o.yn=e.Wo,e.Wo++,0!==(t=arguments).length)for(n=0;n<A.length;n++)o[A[n]]=t[n]}return e.kxb=function(e,t){var n=e.parentName;n&&!t.getNamedStyle(n)&&delete e.parentName},e.prototype.Yo=function(e,t,n,o){var r,i,a,s,l,u,c,p,d,g=this,m=e.labelOptions,y=e.cellButtons;if(e.cellButtons&&e.cellButtons.length>0)for(y=[],c=0;c<e.cellButtons.length;c++)y.push(f(e.cellButtons[c]));if(p=e.dropDowns,e.dropDowns&&e.dropDowns.length>0)for(p=[],c=0;c<e.dropDowns.length;c++)p.push(f(e.dropDowns[c]));t?(g._autoFormatter=e._autoFormatter,g.backgroundImage=e.backgroundImage,g.backgroundImageLayout=e.backgroundImageLayout,g.backColor=e.backColor,g.foreColor=e.foreColor,g.hAlign=e.hAlign,g.vAlign=e.vAlign,g.font=e.font,g.themeFont=e.themeFont,g.formatter=e.formatter,g.showEllipsis=e.showEllipsis,g.THb=e.THb,r=e.borderLeft,g.borderLeft=r&&r.Uo()||r,g.borderLeft&&n&&(g.borderLeft.level=n),i=e.borderTop,g.borderTop=i&&i.Uo()||i,g.borderTop&&n&&(g.borderTop.level=n),a=e.borderRight,g.borderRight=a&&a.Uo()||a,g.borderRight&&n&&(g.borderRight.level=n),s=e.borderBottom,g.borderBottom=s&&s.Uo()||s,g.borderBottom&&n&&(g.borderBottom.level=n),l=e.diagonalDown,g.diagonalDown=l&&l.Uo()||l,g.diagonalDown&&n&&(g.diagonalDown.level=n),u=e.diagonalUp,g.diagonalUp=u&&u.Uo()||u,g.diagonalUp&&n&&(g.diagonalUp.level=n),g.locked=e.locked,g.textIndent=e.textIndent,g.wordWrap=e.wordWrap,g.shrinkToFit=e.shrinkToFit,g.cellType=e.cellType,g.name=e.name,g.parentName=e.parentName,g.tabStop=e.tabStop,g.textDecoration=e.textDecoration,g.imeMode=e.imeMode,g.watermark=e.watermark,g.cellPadding=e.cellPadding,g.isVerticalText=e.isVerticalText,g.textOrientation=e.textOrientation,m&&(g.labelOptions={alignment:m.alignment,font:m.font,foreColor:m.foreColor,visibility:m.visibility,margin:m.margin}),g.quotePrefix=e.quotePrefix,g.cellButtons=y,g.dropDowns=p):(g.backgroundImage===h&&(g.backgroundImage=e.backgroundImage),g.backgroundImageLayout===h&&(g.backgroundImageLayout=e.backgroundImageLayout),g.backColor===h&&(g.backColor=e.backColor),g.foreColor===h&&(g.foreColor=e.foreColor),g.hAlign===h&&(g.hAlign=e.hAlign),g.vAlign===h&&(g.vAlign=e.vAlign),g.themeFont===h&&g.font===h?(g.themeFont=e.themeFont,g.font=e.font):g.themeFont!==h&&g.font===h&&(g.font=e.font),g.formatter===h&&(g.formatter=e.formatter),g.showEllipsis===h&&(g.showEllipsis=e.showEllipsis),g.THb===h&&(g.THb=e.THb),g._autoFormatter===h&&(g._autoFormatter=e._autoFormatter),g.borderLeft===h&&(r=e.borderLeft,g.borderLeft=r&&r.Uo()||r,g.borderLeft&&n&&(g.borderLeft.level=n)),g.borderTop===h&&(i=e.borderTop,g.borderTop=i&&i.Uo()||i,g.borderTop&&n&&(g.borderTop.level=n)),g.borderRight===h&&(a=e.borderRight,g.borderRight=a&&a.Uo()||a,g.borderRight&&n&&(g.borderRight.level=n)),g.borderBottom===h&&(s=e.borderBottom,g.borderBottom=s&&s.Uo()||s,g.borderBottom&&n&&(g.borderBottom.level=n)),g.diagonalDown===h&&(l=e.diagonalDown,g.diagonalDown=l&&l.Uo()||l,g.diagonalDown&&n&&(g.diagonalDown.level=n)),g.diagonalUp===h&&(u=e.diagonalUp,g.diagonalUp=u&&u.Uo()||u,g.diagonalUp&&n&&(g.diagonalUp.level=n)),g.locked===h&&(g.locked=e.locked),g.textIndent===h&&(g.textIndent=e.textIndent),g.wordWrap===h&&(g.wordWrap=e.wordWrap),g.shrinkToFit===h&&(g.shrinkToFit=e.shrinkToFit),g.cellType===h&&(g.cellType=e.cellType),g.tabStop===h&&(g.tabStop=e.tabStop),g.textDecoration===h&&(g.textDecoration=e.textDecoration),g.imeMode===h&&(g.imeMode=e.imeMode),g.name===h&&(g.name=e.name),g.parentName===h&&(g.parentName=e.parentName),g.watermark===h&&(g.watermark=e.watermark),g.cellPadding===h&&(g.cellPadding=e.cellPadding),!g.labelOptions&&m&&(g.labelOptions={}),(d=g.labelOptions)&&m&&(d.alignment===h&&(d.alignment=m.alignment),d.font===h&&(d.font=m.font),d.foreColor===h&&(d.foreColor=m.foreColor),d.visibility===h&&(d.visibility=m.visibility),d.margin===h&&(d.margin=m.margin)),o||g.quotePrefix!==h||(g.quotePrefix=e.quotePrefix),g.isVerticalText===h&&(g.isVerticalText=e.isVerticalText),g.textOrientation===h&&(g.textOrientation=e.textOrientation),g.cellButtons===h&&(g.cellButtons=y),g.dropDowns===h&&(g.dropDowns=p))},e.prototype.$b=function(e){var t=this;0===arguments.length?l(A,(function(e,n){t[n]=h})):t[e]=h},e.prototype.clone=function(t){var n=this,o=n.borderLeft,r=n.borderTop,i=n.borderRight,a=n.borderBottom,s=n.diagonalDown,l=n.diagonalUp,u=new e;return u.backColor=n.backColor,u.foreColor=n.foreColor,u.hAlign=n.hAlign,u.vAlign=n.vAlign,u.font=n.font,u.themeFont=n.themeFont,u.formatter=h,u.borderLeft=o&&!t&&o.Uo()||o,u.borderTop=r&&!t&&r.Uo()||r,u.borderRight=i&&!t&&i.Uo()||i,u.borderBottom=a&&!t&&a.Uo()||a,u.locked=n.locked,u.textIndent=n.textIndent,u.wordWrap=n.wordWrap,u.shrinkToFit=n.shrinkToFit,u.backgroundImage=n.backgroundImage,u.cellType=h,u.backgroundImageLayout=n.backgroundImageLayout,u.tabStop=n.tabStop,u.textDecoration=n.textDecoration,u.imeMode=n.imeMode,u.name=n.name,u.parentName=n.parentName,u.watermark=n.watermark,u.cellPadding=n.cellPadding,u.labelOptions=n.labelOptions,u.quotePrefix=n.quotePrefix,u.diagonalDown=s&&!t&&s.Uo()||s,u.diagonalUp=l&&!t&&l.Uo()||l,u.isVerticalText=n.isVerticalText,u.showEllipsis=n.showEllipsis,u.THb=n.THb,u.textOrientation=n.textOrientation,T(u,n.formatter,!t),N(u,n._autoFormatter,!t),S(u,n.cellType,!t,!0),function(e,t,n,o){var r,i;if(t){if(r=t,n)for(r=[],i=0;i<t.length;i++)r.push(f(t[i]));e.cellButtons=r}}(u,n.cellButtons,!t),function(e,t,n,o){var r,i;if(t&&(e.dropDowns=t.slice()),t){if(r=t.slice(),n)for(r=[],i=0;i<t.length;i++)r.push(f(t[i]));e.dropDowns=r}}(u,n.dropDowns,!t),u},e.prototype.Zo=function(e){var t,n,o,r,i,s,l,u,c=this;if(e&&e.getColor){if(I(e,c.foreColor,(function(e){c.foreColor=e})),"string"==typeof(t=c.backColor))I(e,t,(function(e){c.backColor=e}));else if(t&&(t.backgroundColor&&I(e,t.backgroundColor,(function(e){t.backgroundColor=e})),t.patternColor&&I(e,t.patternColor,(function(e){t.patternColor=e})),t.stops))for(n=function(n){I(e,t.stops[n].color,(function(e){t.stops[n].color=e}))},o=0;o<t.stops.length;o++)n(o);for(i=function(t,n){var o=r[t];o&&o.color&&I(e,o.color,(function(e){o.color=e}))},o=0,s=(r=[c.borderLeft,c.borderTop,c.borderRight,c.borderBottom,c.diagonalDown,c.diagonalUp]).length;o<s;o++)i(o)}return l=c.themeFont,u=c.font,e&&e.getFont&&(l?c.font=a.To.Io(u,e.getFont(l)):u||(c.font=a.To.Io(u,e.bodyFont()))),c},e.prototype.$o=function(e){var t,n=this._autoFormatter;n&&null!==e&&((t=n.getPreferredEditingFormatter(e)).isAuto=!0,this._autoFormatter=t)},e.prototype.toJSON=function(e,t){var n,o,i={},a=this._autoFormatter;for(!c(a)||t&&R(p,a,e)||(a.toJSON&&(a=a.toJSON()),r.GC$.isEmptyObject(a)||(i[p]=a)),n=0;n<A.length;n++)a=this[o=A[n]],o!==v||r.GC$.isEmptyObject(a)?o!==C&&o!==b||r.GC$.isEmptyObject(a)?!c(a)||t&&R(o,a,e)||(i[o]=a&&a.toJSON?a.toJSON():a):i[o]=a:i[v]=a;return r.GC$.isEmptyObject(i)?h:i},e.prototype.fromJSON=function(t,n,o){var r,i,a,s,l;if(t)for(i in r=this,t)if(t.hasOwnProperty(i)){if(a=t[i],!c(a))continue;(s={p:i,v:a,r:!1}).noSchema=n,s.context=o,e.ao(r,"fromJson",s),s.r||("formatter"===i?T(r,a,!0):"autoFormatter"===i?N(r,a,!0):i===d?S(r,a,!0,n):w[i]?null===a?r[i]=null:((l=new x).fromJSON(a,n),r[i]=l):r[i]=a)}},e}(),t.Style=M,i.Zn(M),M.Wo=0},"./dist/core/worksheet/stylehelper.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v;function b(e){return e=a(e=e||0,0),s(e,1)}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/util/domUtil.js"),r=n("./dist/core/util/common.js"),i=document,a=Math.max,s=Math.min,l=void 0,u="#FFFFFF",c="#000000",f=Math.abs,h=Math.PI,p=Math.cos,d=Math.sin,g=Math.atan,m=Math.tan,t.Ho="11pt",y={1:[[1]],2:[[1,0,1,1],[1,1,1,0]],3:[[0,1],[1,0]],4:[[0,0,1,0],[1,0,0,0]],5:[[0,0,0,0],[0,0,1,0],[0,0,0,0],[1,0,0,0]],6:[[0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0]],7:[[0],[1],[1],[0]],8:[[1,1,0,0]],9:[[0,1,1,0],[0,0,1,1],[1,0,0,1],[1,1,0,0]],10:[[0,1,1,0],[1,1,0,0],[1,0,0,1],[0,0,1,1]],11:[[0,0,1,1],[0,0,1,1],[1,1,0,0],[1,1,0,0]],12:[[0,1,1,0],[1,1,1,1],[1,0,0,1],[1,1,1,1]],13:[[0],[1],[0],[0]],14:[[1,0,0,0]],15:[[0,1,0,0],[0,0,1,0],[0,0,0,1],[1,0,0,0]],16:[[0,0,1,0],[0,1,0,0],[1,0,0,0],[0,0,0,1]],17:[[0,0,1,0],[1,1,1,1],[0,0,1,0],[0,0,1,0]],18:[[1,0,1,0],[0,0,0,1],[1,0,1,0],[0,1,0,0]]},v=function(){function e(){}return e.Io=function(t,n){return n?e.Jo(t,n):t},e.Ko=function(t){var n,o;return t?((n=e.Lo()).style.font=t,{fontFamily:(o=n.style).fontFamily,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight}):{}},e.F4=function(e){var t,n,o,i,a,s;return r.Ul.Ml.safari?e.font:(t="",n="normal","400","11pt","Calibri",o=e.fontStyle,i=e.fontVariant,a=e.fontWeight,s=e.lineHeight,o&&o!==n&&(t=o),i&&i!==n&&(t+=(t?" ":"")+i),a&&a!==n&&"400"!==a&&(t+=(t?" ":"")+a),t+=(t?" ":"")+(e.fontSize||"11pt"),s&&s!==n&&(t+="/"+s),t+=" "+(e.fontFamily||"Calibri"))},e.Jo=function(n,r){var a,s,l,u,c;if(!n&&!r)return n;if(n){if(s=r?n+"+"+r:n,l=e.Mo[s])return l;a=e.Lo(),o.GC$(a).css("font",n)}else{if(s=r,l=e.Mo[s])return l;a=e.Lo(),o.GC$(a).css("fontSize",t.Ho)}return r&&o.GC$(a).css("fontFamily",r),u=a.currentStyle,(c=i.defaultView)&&c.getComputedStyle&&(u=c.getComputedStyle(a,"")),l=e.F4(u),e.Mo[s]=l,e.Mo[l]=l,l},e.No=function(t,n,o,r){var s,l,u,c,f,h,p,d,g,m=e.Oo[n];if(!r)if(m){if(s=m[t])return s}else m=e.Oo[n]={};return(l=e.Lo()).style.font=t,u=l.currentStyle,(c=i.defaultView)&&c.getComputedStyle&&(u=c.getComputedStyle(l,"")),h="px",-1!==(f=u.fontSize).indexOf(h)&&(p=a(1,parseFloat(f.replace(h,""))*n),o&&1===p&&(o.value=!0),f=p+h),-1!==(d=u.lineHeight).indexOf(h)&&(g=a(1,parseFloat(d.replace(h,""))*n),d=g+h),1===n?s={font:t,fontFamily:l.style.fontFamily,fontSize:p}:(l.style.fontSize=f,l.style.lineHeight=d,s={font:l.style.font,fontFamily:l.style.fontFamily,fontSize:p}),r||(m[t]=s),s},e.Lo=function(){var t,n,o;return e.Po?e.Po.style.cssText=e.Qo:(t="-10000px",(o=(n=r.Ul.Nl("span")).style).visibility="hidden",o.top=t,o.left=t,o.lineHeight="normal",o.position="absolute",o.fontWeight="normal",o.fontStretch="normal",o.fontVariant="normal",o.fontStyle="normal",i.body.insertBefore(n,null),e.Po=n,e.Qo=o.cssText),e.Po},e.no=function(){var t=e.Po;t&&(o.GC$(t).remove(),e.Po=l,e.Qo=l)},e.stringFontCatch={},e.Ro=function(t,n){var o,r=t+","+n,i=e.stringFontCatch,a=i[r];return a||((o=e.Lo()).style.font=t,n&&(o.style.fontWeight=n),a=i[r]=o.style.font),a},e.Mo={},e.Oo={},e.So=function(e){if(e<=0)return"none";var t="";return(1|e)===e&&(t+="underline "),(2|e)===e&&(t+="line-through "),(4|e)===e&&(t+="overline "),t.trim()},e.setFillStyle=function(t,n,o,r,i,a,s){"string"==typeof n?(t.fillStyle!==n&&(t.fillStyle=n),s()):"path"===n.type?e.setFillStyle_Path(t,n,o,r,i,a,s):n.stops?e.setFillStyle_Gradient(t,n,o,r,i,a,s):n.type&&e.setFillStyle_patternFill(t,n,o,r,i,a,s)},e.setFillStyle_patternFill=function(e,t,n,o,r,i,a){var s,l,f,h,p=y[t.type],d=p.length,g=p[0].length,m=document.createElement("canvas");for(m.width=g,m.height=d,(s=m.getContext("2d")).fillStyle=t.backgroundColor||u,s.fillRect(0,0,g,d),s.fillStyle=t.patternColor||c,l=0;l<d;l++)for(f=0;f<g;f++)p[l][f]&&s.fillRect(f,l,1,1);e.createPattern(m,"repeat"),h=e.createPattern(m,"repeat"),e.fillStyle=h,a()},e.processStops=function(e){var t,n;if(e.stops||"path"===e.type){if(t=e.stops)if(0===t.length)t=[{position:0,color:c},{position:1,color:c}];else{for((t=t.filter((function(e,t,n){return e.position<=1&&e.position>=0}))).sort((function(e,t){return e.position-t.position})),n=0;n<t.length;n++)t[n].color=t[n].color||c;0!==t[0].position&&t.splice(0,0,{position:0,color:c}),1!==t[t.length-1].position&&t.push({position:1,color:c})}else t=[{position:0,color:u},{position:1,color:u}];e.stops=t}"path"===e.type?(e.left=b(e.left),e.right=b(e.right),e.top=b(e.top),e.bottom=b(e.bottom)):e.stops&&(delete e.type,e.degree=e.degree||0)},e.setFillStyle_Gradient=function(e,t,n,o,r,i,a){var s,l,c,y,v,b,C,w=t.degree||0;for(w%90==0?(l=w/180*h,c=f(w%180/180*h)-g(i/r)):(l=g(r/i*m(w/180*h)),c=f(l)-g(i/r),l=Math.round(w/180)*h+l),y=Math.sqrt(r*r+i*i)/2,s=e.createLinearGradient(n+r/2-y*p(c)*p(l),o+i/2-y*p(c)*d(l),n+r/2+y*p(c)*p(l),o+i/2+y*p(c)*d(l)),b=0,C=(v=t.stops).length;b<C;b++)s.addColorStop(v[b].position,v[b].color||u);e.fillStyle=s,a()},e.setFillStyle_Path=function(e,t,n,o,r,i,a){var s,l,c,f=t.left||0,h=t.right||0,p=t.top||0,d=t.bottom||0,g=t.stops;if(f>h&&(h=f),p>d&&(d=p),f>0){for(e.save(),e.beginPath(),s=e.createLinearGradient(n+r*f,0,n,0),l=0,c=g.length;l<c;l++)s.addColorStop(g[l].position,g[l].color||u);e.fillStyle=s,e.moveTo(n,o-1),e.lineTo(n+r*f+1,o+i*p),e.lineTo(n+r*f+1,o+i*d),e.lineTo(n,o+i+1),e.clip(),a(),e.restore()}if(h<1){for(e.save(),e.beginPath(),s=e.createLinearGradient(n+r*h,0,n+r,0),l=0,c=g.length;l<c;l++)s.addColorStop(g[l].position,g[l].color||u);e.fillStyle=s,e.moveTo(n+r,o-1),e.lineTo(n+r,o+i+1),e.lineTo(n+r*h-1,o+i*d),e.lineTo(n+r*h-1,o+i*p),e.clip(),a(),e.restore()}if(p>0){for(e.save(),e.beginPath(),s=e.createLinearGradient(0,o+i*p,0,o),l=0,c=g.length;l<c;l++)s.addColorStop(g[l].position,g[l].color||u);e.fillStyle=s,e.moveTo(n,o),e.lineTo(n+r,o),e.lineTo(n+r*h,o+i*p+1),e.lineTo(n+r*f,o+i*p+1),e.clip(),a(),e.restore()}if(d<1){for(e.save(),e.beginPath(),s=e.createLinearGradient(0,o+i*d,0,o+i),l=0,c=g.length;l<c;l++)s.addColorStop(g[l].position,g[l].color||u);e.fillStyle=s,e.moveTo(n+r,o+i),e.lineTo(n,o+i),e.lineTo(n+r*f,o+i*d-1),e.lineTo(n+r*h,o+i*d-1),e.clip(),a(),e.restore()}f<h&&p<d&&(e.save(),e.beginPath(),e.fillStyle=g[0].color,e.rect(n+r*f,o+i*p,r*(h-f),i*(d-p)),e.clip(),a(),e.restore())},e}(),t.To=v},"./dist/core/worksheet/worksheet-actions.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe,re,ie,ae,se,le,ue,ce,fe,he,pe,de,ge,me,ye,ve,be,Ce,we,xe,Ae,Me,Se,Te,Ne,Ie,Re,ke,Ee,De,je,_e,Oe,Fe,Pe,He,Be,Le,ze,Ve,Ge,We,Ue,Ze,qe,Je,Qe,Ye,Ke,$e,Xe,et,tt,nt=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function ot(e,t){return e.getRowCount(t)}function rt(e,t){return e.getColumnCount(t)}function it(e){return e.rowCount}function at(e){return e.colCount}function st(e){var t=e.parent;return t&&t.options.allowExtendPasteRange}function lt(e){var t=e.parent;return t&&t.options.allowCopyPasteExcelStyle}function ut(e){var t=e.parent;return t&&t.options.copyPasteHeaderOptions}function ct(e,t,n,o){throw Error(v.Kb(O().Exp_InvalidAndSpace,[e,t,n,o]))}function ft(e){e.suspendPaint()}function ht(e){e.resumePaint()}function pt(e){e.suspendEvent()}function dt(e){e.resumeEvent()}function gt(e,t){e&&g&&e.suspendCalcService(t)}function mt(e,t){e&&g&&e.resumeCalcService(t)}function yt(e,t,n,o,r){var i=e.getSpan(t,n,o);if(i&&r&&(i.row!==t||i.col!==n))return!0}function vt(e){var t=this;t.Vw=1==(1&e),t.Ww=2==(2&e),t.Xw=8==(8&e),t.Yw=g&&16==(16&e),t.Zw=!0,t.$w=!0}function bt(e,t,n,o){var r,i,a,s,l,u,c,f,h,p,d,g,y,v;if(m(e)||""===e)return I;for((m(t)||""===t)&&(t="\r\n"),"\n",(m(n)||""===n)&&(n="\t"),(m(o)||""===o)&&(o='"'),b(e,t)||(e+=t),r=[],i=[],a="",l=!1,u=o.length,c=t.length,f="\n".length,h=n.length,p=e.length,d=0;d<p;d++)(s=(a+=e[d]).length)>=u&&o===a.substr(s-u,u)?l&&p>=d+1+u&&o===e.substr(d+1,u)?d+=u:l?(a=a.substr(0,s-u),l=!1):0===a.indexOf(o)&&(a=a.substr(0,s-u),l=!0):!l&&s>=h&&n===a.substr(s-h,h)?(a=a.substr(0,s-h),i.push(""+a),a=""):!l&&s>=c&&t===a.substr(s-c,c)?(a=a.substr(0,s-c),i.push(""+a),r.push(i),i=[],a=""):!l&&s>=f&&"\n"===a.substr(s-f,f)?(a=a.substr(0,s-f),i.push(""+a),r.push(i),i=[],a=""):l&&p>=d+1+h&&n===e.substr(d+1,h)&&","!==n&&(d+=u);if(l){if(i.length>0){for(g=void 0,g=0;g<r.length&&r[g]!==i;g++);g>=r.length&&r.push(i)}(y=""+a)&&(y=y.replace(RegExp(n,"g"),""),b(y,t)&&(y=y.substr(0,y.length-c)),0===r.length&&r.push([y]))}return 0===r.length&&(v=e,b(e,t)&&(v=v.substr(0,v.length-c)),r.push([v])),function(e){var t,n;if(e){for(t=0;t<e.length&&((n=e[t])&&1===n.length);t++);if(t===e.length)return!0}return!1}(r)&&/^(\s)*$/.test(e)&&"\n"===e.substr(e.length-f,f)&&r.push([""]),r}function Ct(e,t,n,o,r,i,a){for(var s=0,l=o;s<t.length;s++,l++)r>0&&l<rt(e,i)&&wt(e,i,n,l,t[s],a)}function wt(e,t,n,o,r,a){var s,u,c,f,h,p,d,g=r,y=I;if(!1===a.Xw&&(s={value:I},g=l.Ul.ul(I,r,!a.Xw,s),y=s.value),m(g))e.setValue(n,o,g,t);else if(""!==r)if(a.Yw&&"="===r[0]&&r.length>1)try{e.setFormula(n,o,r.substr(1))}catch(i){e.setText(n,o,r,t)}else u=e.tq(n,o,"formatter",t),!1===a.Xw&&y?u?u&&("string"==typeof u&&i.Formatter&&(u=new i.Formatter.GeneralFormatter(u)),d=u.parse&&u.parse(r),g=m(d)?g:d):(y.isAuto=!0,e.getCell(n,o,t)._w("_autoFormatter",y),c=r,f=e.getCellType(n,o,t),h=y.formatString(),f&&"7"===f.typeName&&(p={sheet:e,row:n,col:o,sheetArea:t},c=f.parse(r,h,p),g=m(c)?r:c)):u&&e.getCell(n,o,t).formatter(I),e.setValue(n,o,g,t);else e.setValue(n,o,I,t)}function xt(e){var t,n,o=0;for(t=0;t<(e&&e.length);t++)n=e[t],o=k(n.length,o);return o}function At(e,t,n,o,r,i,a,s){if(!e)throw Error(O().Exp_SheetIsNull);if((t<-1||t>=ot(e))&&ct("row",t,"-1",ot(e)-1),(n<-1||n>=rt(e))&&ct("column",n,"-1",rt(e)-1),!m(o)&&""!==o){-1===t&&(t=0),-1===n&&(n=0);var l=bt(o,r,i,a);l&&l.length>0&&function(e,t,n,o,r){var i,a,s,l,u,c,f,h=o.length,p=xt(o);if(0!==h&&0!==p)for(i=new vt(r),e&&(rt(e,2)<=0&&(i.Vw=!1),ot(e,1)<=0&&(i.Ww=!1)),l=0,(p-=a=i.Vw?rt(e,2):0)<=0&&(p=0),(h-=s=i.Ww?ot(e,1):0)<=0&&(l=0),(h-=l)<=0&&(h=0),i.Zw&&t+h>ot(e)&&e.setRowCount(t+h),i.$w&&n+p>rt(e)&&e.setColumnCount(n+p),u=0,c=0;u<o.length;u++,c++)(f=o[u]).length<=0||(s>0&&u<s?Ct(e,f,c,n,p,1,i):h>0&&c<ot(e)&&(u===s&&(c=t),Ct(e,f,c,0,a,2,i),f.splice(0,a),Ct(e,f,c,n,p,3,i)))}(e,t,n,l,s)}}function Mt(e,t,n,o,r,i,a,s,l,u,c,f,h,p){var d,g,y,v,b,C,w,x,A,M,S,T;if(!e)throw Error(O().Exp_SheetIsNull);return d=ot(e),g=rt(e),(t<-1||t>=d)&&ct("row",t,"-1",d-1),(n<-1||t+n>d)&&ct("rowCount",n,"-1",d-t),(o<-1||o>=g)&&ct("column",o,"-1",g-1),(r<-1||o+r>g)&&ct("columnCount",r,"-1",g-o),y=-1,v=-1,b=!1,C=!1,-1===t&&-1===o&&-1===n&&-1===r?(t=0,o=0,y=ot(e)-1,v=rt(e)-1):(-1===t&&(t=0,2==(2&ut(e))&&(b=!0)),-1===o&&(o=0,1==(1&ut(e))&&(C=!0)),-1===n&&(n=ot(e)-t),-1===r&&(r=rt(e)-o),y=t+n-1,v=o+r-1),(m(i)||""===i)&&(i="\r\n"),(m(a)||""===a)&&(a="\t"),(m(s)||""===s)&&(s='"'),x=null,A=null,M=St(e,t,y,o,v,3,u,c,i,a,s,w=RegExp(s,"g"),l,f,h,p),C&&(S=e.getColumnCount(2),x=St(e,t,y,0,S-1,2,u,c,i,a,s,w,l,f,h,p)),b&&(T=e.getRowCount(1),A=St(e,0,T-1,o,v,1,u,c,i,a,s,w,l,f,h,p)),function(e,t,n,o,r){var i,a,s=e,l=0,u=function(e,t){var n,o=[],r=e.length;for(n=0;n<r;n++)o.push(e[n].concat(t[n]));return o};return t&&(l=t[0].length,s=u(t,e)),n&&(i=n.length,a=null,l&&(a=St(null,0,i-1,0,l-1,null,[],[],o,r,null,null,null,!1,!1),n=u(a,n)),s=n.concat(s)),function(e,t,n){var o,r,i="",a=e.length;for(o=0;o<a;o++){for(r=0;r<e[o].length;r++)0!==r&&(i+=n),i+=e[o][r];i+=t}return i}(s,o,r)}(M,x,A,i,a)}function St(e,t,n,o,r,i,a,s,l,u,c,f,h,p,d,g){var m,v,b,C,w=[],x=e&&lt(e);for(m=t;m<=n;m++)if(!a||!y(a,m)){for(b=[],v=o;v<=r;v++)s&&y(s,v)||(C="",e&&!yt(e,m,v,i,p)&&(C=e.getText(m,v,i),g&&x&&C&&(" "===C[0]||" "===C[C.length-1])&&"number"==typeof e.getValue(m,v,i)&&(C=C.trim())),C=Tt(C,p,x,f,c,d,h,u,l),b.push(C));w.push(b)}return w}function Tt(e,t,n,o,r,i,a,s,l){var u="";return m(e)||(u=e,t||(u=u.replace(o,r+r))),i&&!u&&(u=" "),t&&n?u=u.replace(/\n/g," "):(a||-1!==u.indexOf(r)||-1!==u.indexOf(s)||-1!==u.indexOf(l)||-1!==u.indexOf("\n"))&&(u=r+u+r),u}function Nt(e,t){return e.sheets?e.getSheetFromName(t.sheetName):e}function It(e,t,n,o){var r=Nt(e,n),i=new t(r,n,o);return o?i.undo(r):i.execute(r)}function Rt(e){var t=e;return function(e,n){var o=Nt(e,n);return F.Ox(o,t)}}function kt(e,t){var n=e,o=t;return function(e,t){var r=Nt(e,t);return F.Rx(r,n,o)}}function Et(e,t){var n,o,r,i=e.parent;i&&(n=i.getSheetCount(),void 0,r=void 0,o=r=i.getActiveSheetIndex(),t?r<n-1&&r++:r>0&&r--,o!==r&&(i.dq(r,1),i.repaint()))}function Dt(e,t){e.Tx=!0,e.Hx?e.Ex(t):e.yx(t,!0),e.Tx=!1}function jt(e,t){var n,o,r,i;return!!e.endEdit()&&((n=e._eventHandler).Ux(),n.Vx(),l.Vl.Zl(I),o=!1,(r=e.parent)&&((i=t.call(r))&&i.focus?(i.focus(),o=!0):r.Uv()),{ignoreCancelDefault:!o})}function _t(e,t){var n=[];return"string"==typeof t?n.push(e.getSheetFromName(t)):Array.isArray(t)&&t.forEach((function(t){n.push(e.getSheetFromName(t))})),n}function Ot(e,t){ft(e),t||pt(e)}function Ft(e,t){t||dt(e),ht(e)}function Pt(e,t){m(e.lq)&&(e.lq=t.lq,e.qq=t.qq)}function Ht(e,t){"value"===t.propertyName&&e.xu(t.row,t.col,t.oldValue,t.newValue)}function Bt(e){var t=e.parent,n=t&&t.hq;n&&n.repaint()}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/core.ns.js"),r=n("@grapecity/js-sheets-common"),i=n("@grapecity/js-sheets-common"),a=n("./dist/core/worksheet/style.js"),s=n("./dist/core/worksheet/worksheet.js"),l=n("./dist/core/util/common.js"),u=n("./dist/core/worksheet/clipboardhelper.js"),c=n("./dist/core/util/domUtil.js"),f=n("./dist/core/core.enum.js"),h=c.GC$,p=n("./dist/core/worksheet/worksheet-static.js"),d=n("@grapecity/js-calc"),g=!!d,m=r.Common.j.Fa,y=r.Common.k.Bb,v=r.Common.u,b=v.jb,C=l.Events.CellChanged,w=l.Events.ColumnWidthChanging,x=l.Events.ColumnWidthChanged,A=l.Events.RowHeightChanging,M=l.Events.RowHeightChanged,S=l.Ul.Ml,T=l.Ul.Ol,N=h.extend,h.inherit,I=null,R=void 0,k=Math.max,Math.min,E=Math.floor,D=Math.ceil,Number.MAX_VALUE,isNaN,function(e){e[e.value=1]="value",e[e.formula=2]="formula",e[e.comment=4]="comment",e[e.outline=8]="outline",e[e.sparkline=16]="sparkline",e[e.span=32]="span",e[e.style=64]="style",e[e.tag=128]="tag",e[e.bindingPath=256]="bindingPath",e[e.conditionalFormat=512]="conditionalFormat",e[e.hyperlink=1024]="hyperlink",e[e.all=2047]="all"}(j=t.CopyToOptions||(t.CopyToOptions={})),_=new r.Common.ResourceManager(o.SR),O=_.getResource.bind(_),N(s.Worksheet.prototype,{autoFitColumn:function(e){0<=e&&e<rt(this)&&this.wu().execute({cmd:"autoFitColumn",sheetName:this.name(),columns:[{col:e}],rowHeader:!1})},autoFitRow:function(e){0<=e&&e<ot(this)&&this.wu().execute({cmd:"autoFitRow",sheetName:this.name(),rows:[{row:e}],columnHeader:!1})},setCsv:function(e,t,n,o,r,i){var a=this;ft(a),pt(a),At(a,e,t,n,o,r,'"',i),dt(a),ht(a)},getCsv:function(e,t,n,o,r,i){return Mt(this,e,n,t,o,r,i,'"',!0)},copyTo:function(e,t,n,o,r,i,a){this.ax(e,t,n,o,r,i,a)},ax:function(e,t,n,o,r,i,a,s){var l=this;ft(l),pt(l),p.staticMembers.copyTo(l,e,t,l,n,o,r,i,a,s,0),dt(l),ht(l)},moveTo:function(e,t,n,o,r,i,a,s){var l=this;if(!(g&&a&j.formula)||l.Vq(e,t,r,i,!0)&&l.Vq(n,o,r,i,!0))try{ft(l),pt(l),p.staticMembers.moveTo(l,e,t,l,n,o,r,i,a,s)}finally{dt(l),ht(l)}},bx:function(e,t,n){var o,r,i,a,s,c,h,p=this,d=p.o5(e);if(d){o=p.J5(e),"\t","\r\n",'"',r=p._eventHandler,i=Mt(p,d.row,it(d),d.col,at(d),"\r\n","\t",'"',!1,o.rows,o.cols,!0),(a=p.tu()).PA=p,a.n5=e,a.G4=t,p.tu().UHb=!0,s=ut(p),c=u.S4.Q4(p,s,d.row,it(d),d.col,at(d),f.SheetArea.viewport,lt(p),o.rows,o.cols,!1,!1,!1,!1),p.ex&&p.ex(),p.Sob&&p.Sob();try{if(h={sheet:p,sheetName:p.name(),copyData:{text:i,html:c},cancel:!1},p.Wq(l.Events.ClipboardChanging,h),h&&!1===h.cancel)return r&&!n&&r.gx(lt(p)?c:i),p.Wq(l.Events.ClipboardChanged,{sheet:p,sheetName:p.name(),copyData:{text:i,html:c}}),setTimeout((function(){!r||n||p.Js||r.hx()}),100),{copyText:i,copyHtml:c};a.hZ()}catch(e){}}},ix:function(e,t,n,o,r,i,a,s){var l,u,c,f,h=O().Exp_PasteSourceCellsLocked;if(i.pastedInternal=!1,i.pastedRange=I,l=!r&&!s,!e&&l)return!1;if(c=u=this,f=u.J5(t),u.jx(e,u.o5(t),c,r,f.rows,f.cols)||l){if(i.pastedInternal=!0,o&&e.options.isProtected&&e.p5(t))return u.Os(1,h),!1;i.pastedRange=u.kx(e,t,c,n,o)}else i.pastedRange=u.lx(n,r);return u.mx(e,t,n,o,i,a)},mx:function(e,t,n,o,r,i){var a,s,u,c,f,h,p,d,g,m,y,v,b,C,w=O().Exp_InvalidCopyPasteSize,x=O().Exp_PasteDestinationCellsLocked,A=O().Exp_PasteChangeMergeCell,M=O().Exp_ChangePartOfArray,S=this,T=S,N=r.pastedRange;if(!N)return S.Os(1,w),!1;if(!T.Y3(N.row,N.col,it(N),at(N),x,M,R,i))return!1;if(r.pastedInternal){if(1===(a=t.length)){if(s=t[0],o&&!e.Y3(s.row,s.col,it(s),at(s),x,M))return!1;if(e.qu(s.row,s.col,it(s),at(s)))return S.Os(1,A),!1;if(u=N.row<0?ot(T):it(N),c=N.col<0?rt(T):at(N),f=s.row<0?ot(e):it(s),h=s.col<0?rt(e):at(s),u>f||c>h){for(p=n.row,d=n.col,n.row<0&&f<ot(T)&&(p=0),n.col<0&&h<rt(T)&&(d=0),u%f==0&&1===c?(c=h,N=r.pastedRange=new l.Range(p,d,u,c)):1===u&&c%h==0?(u=f,N=r.pastedRange=new l.Range(p,d,u,c)):u%f==0&&c%h==0||(u=f,c=h,N=r.pastedRange=new l.Range(p,d,u,c)),g=E(u/f),m=E(c/h),y=0;y<g;y++)for(v=0;v<m;v++)if(!S.nx(s,N)&&T.qu(p<0?-1:p+y*f,d<0?-1:d+v*h,p<0?-1:f,d<0?-1:h))return S.Os(1,A),!1}else if(i===R&&!S.nx(s,N)&&T.qu(N.row,N.col,it(N),at(N)))return S.Os(1,A),!1}else if(a>1){for(b=0;b<a;b++)if(C=t[b],e.qu(C.row,C.col,it(C),at(C)))return S.Os(1,A),!1;if(T.qu(N.row,N.col,it(N),at(N)))return S.Os(1,A),!1}}else{if(T.qu(N.row,N.col,it(N),at(N)))return S.Os(1,A),!1;if(!T.l5(N.row,N.col,it(N),at(N)))return S.Os(1,w),!1}return!0},nx:function(e,t){if(e&&1===it(e)&&1===at(e)){var n=this.getSpan(t.row,t.col);if(n&&n.equals(t))return!0}return!1},jx:function(e,t,n,o,r,i){var a,s;if(e&&t&&n)try{return(s=(a=Mt(e,t.row,it(t),t.col,at(t),"\r\n","\t",'"',!1,r,i,!0,S.safari,!0))===o)||(!(s=a===o+"\r\n")&&S.chrome&&(s=a===o+"\t\r\n"),s||!S.safari&&lt(n)||(s=a.replace(/\s/g,"")===o.replace(/\s/g,"")),s||(s=a.replace(/\s+$/,"")===o.replace(/\s+$/,""))),s}catch(e){return!1}return!1},kx:function(e,t,n,o,r){var i,a,s,u,c,f,h,p,d,g,m=t.length;if(1===m){if(a=(i=t[0]).row<0?0:i.row,s=i.col<0?0:i.col,u=i.row<0?ot(e):it(i),c=i.col<0?rt(e):at(i),f=o.row<0?0:o.row,h=o.col<0?0:o.col,p=o.row<0?ot(n):it(o),d=o.col<0?rt(n):at(o),r?(p=u,d=c):p%u==0&&1===d?d=c:1===p&&d%c==0?p=u:p%u==0&&d%c==0||(p=u,d=c),!this.pu(a,s,u,c,ot(e),rt(e)))return I;if(!n.l5(f,h,p,d))return I;if(g=new l.Range(f,h,p,d),!r&&e.name()===n.name())if(g.contains(a,s,u,c)){if((a-f)%u!=0||(s-h)%c!=0)return I}else if(g.intersect(a,s,u,c)&&(p>u||d>c))return I;return-1===o.row&&(f=-1,p=-1),-1===o.col&&(h=-1,d=-1),new l.Range(f,h,p,d)}return m>1?this.q5(t,o):I},q5:function(e,t){var n,o,r,i,a,s;if(e.length>1){if(n=e[0],o=e[1],r=n.rowCount,i=n.colCount,n.row===o.row&&r===o.rowCount)return a=0,e.forEach((function(e){a+=e.colCount})),l.kf(t.row,t.col,r,a);if(n.col===o.col&&i===o.colCount)return s=0,e.forEach((function(e){s+=e.rowCount})),l.kf(t.row,t.col,s,i)}return I},lx:function(e,t){var n,o,r=e.row<0?0:e.row,i=e.col<0?0:e.col,a=new l.Range(r,i,1,1),s=function(e,t,n,o){var r,i,a,s,l,u=I,c=bt(e,t,n,o);if(c){for(r=c.length,i=xt(c),a=[],s=0;s<r;s++)for(a[s]=[],l=0;l<i;l++)l<c[s].length?a[s][l]=c[s][l]:a[s][l]=I;u=a}return u}(t,"\r\n","\t",'"');return s&&(n=s.length,o=xt(s),n>0&&o>0&&(a=new l.Range(r,i,n,o))),a},ox:function(){var e=this.tu();e&&e.hZ()},px:function(e,t,n,o,i,a,s,u,c,f){var h,d,m,v,b,C,w,x,A,M,S,T,N,R,k,D;if(e&&n.name()===e.name()&&n.parent&&!y(n.parent.sheets,e))e.ox();else{w=et.qx(c),gt(e),gt(n);try{if(e&&t){if(0!=(2&w)&&i&&g&&(e.Ns(t.row,t.col,it(t),at(t))||n.Ns(o.row,o.col,it(o),at(o))))throw O().Exp_ChangePartOfArray;if(i)p.staticMembers.moveTo(e,t.row,t.col,n,o.row,o.col,it(t),at(t),w,!0),e.ox();else if(x=o.row<0?ot(n):it(o),A=o.col<0?rt(n):at(o),m=t.row<0?ot(e):it(t),v=t.col<0?rt(e):at(t),x>m||A>v)for(h=o.row,d=o.col,o.row<0&&m<ot(n)&&(h=0),o.col<0&&v<rt(n)&&(d=0),x%m==0&&1===A?A=v:1===x&&A%v==0?x=m:x%m==0&&A%v==0||(x=m,A=v),M=E(x/m),S=E(A/v),b=0;b<M;b++)for(C=0;C<S;C++)p.staticMembers.copyTo(e,t.row,t.col,n,h<0?-1:h+b*m,d<0?-1:d+C*v,h<0?-1:m,d<0?-1:v,w,f,ut(e));else p.staticMembers.copyTo(e,t.row,t.col,n,o.row,o.col,it(t),at(t),w,f,ut(e))}else{for(h=o.row,d=o.col,m=it(o),v=at(o),R=(N=(T=n._modelManager).getSpans(l.kf(h,d,m,v))).length-1;R>=0;R--)T.do("removeSpan",N[R]);if(g&&(1&w)>0&&n.clearFormula(h,d,m,v,(function(e,t){return!e.Ps||!e.Ps(t)})),k=n.tu(),D=0===c||2===c,a&&""!==a)n.parent.options.allowAutoCreateHyperlink&&1===m&&1===v&&(r.Common.q.qb("^(((ht|f)tp(s?)):\\/\\/(?:www.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|www\\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|((ht|f)tp(s?)):\\/\\/(?:www\\.|(?!www))[a-zA-Z0-9]+\\.[^\\s]{2,}|www\\.[a-zA-Z0-9]+\\.[^\\s]{2,})$").test(a)||r.Common.q.qb("^(mailto:\\/\\/)?([A-Za-z0-9_\\-\\.\\!\\#$%&'*\\+/=?^`{|}~])+\\@([A-Za-z0-9\\-])+\\.([A-Za-z0-9\\-]){2,63}(\\?subject=.+)?$").test(a))&&n.setHyperlink&&n.setHyperlink(h,d,{url:a,tooltip:a}),n.setCsv(h,d,a,"\r\n","\t",16);else{for(b=0;b<m;b++)for(C=0;C<v;C++)n.setValue(h+b,d+C,I);k&&D&&u&&k.lgc(u,n,h,d)}k&&D&&s&&k.R4(s,n,h,d)}}finally{mt(e,!1),mt(n,!1)}}},sx:function(e){if(!this.isEditing()){var t=this.getSelections();if(t&&1===t.length)return this.bx(t,!0,e)}return I},r5:function(e,t){var n,o,r,i,a,s,l;if(e&&(n=e.length)>1){for(o=void 0,o=0;o<n;o++)for(r=e[o],i=o+1;i<n;i++)if(a=e[i],r.intersect(a.row,a.col,a.rowCount,a.colCount))return!1;for(s=e[0],l=void 0,o=1;o<n&&(l=e[o],s.row===l.row&&s.rowCount===l.rowCount);o++);if(o>=n)return t&&(t.inSameRow=!0),!0;for(o=1;o<n&&(l=e[o],s.col===l.col&&s.colCount===l.colCount);o++);if(o>=n)return t&&(t.inSameCol=!0),!0}return!1},o5:function(e){var t,n,o,r,i;if(e){if(1===(t=e.length))return e[0];if(t>1){if(n=e[0],o=e[t-1],r=void 0,i=void 0,n.row===o.row&&n.rowCount===o.rowCount){for(r=0;r<t;r++)(i=e[r]).col<n.col&&(n=i),i.col>o.col&&(o=i);return l.kf(n.row,n.col,n.rowCount,o.col+o.colCount-n.col)}if(n.col===o.col&&n.colCount===o.colCount){for(r=0;r<t;r++)(i=e[r]).row<n.row&&(n=i),i.row>o.row&&(o=i);return l.kf(n.row,n.col,o.row+o.rowCount-n.row,n.colCount)}}}return I},J5:function(e){var t,n,o,r,i,a,s,l,u,c,f,h,p=[],d=[];if(e&&((t=e.length)>1&&(n=e[0],o=e[t-1],r=n.row===o.row&&n.rowCount===o.rowCount,i=n.col===o.col&&n.colCount===o.colCount,r||i)))for(e.sort(r?function(e,t){return e.col-t.col}:function(e,t){return e.row-t.row}),a=1;a<t;a++)for(s=e[a-1],l=e[a],u=r?s.col+s.colCount:s.row+s.rowCount,c=r?l.col:l.row,f=r?d:p,h=u;h<c;h++)f.push(h);return{rows:p,cols:d}},ux:function(e){var t,n,o,r,i,a,s=this;if(!s.isEditing()){if((t=s.getSelections())&&1===t.length){if(s.tu().UHb=!0,-1!==(n=t[0]).row&&s.Nu&&s.Nu()){for(o=[],r=-1,i=0;i<n.rowCount;i++)a=n.row+i,s.Ps(a)?-1!==r&&(o.push(l.kf(r,n.col,a-r,n.colCount)),r=-1):-1===r&&(r=a);-1!==r&&o.push(l.kf(r,n.col,n.row+n.rowCount-r,n.colCount)),t=o}return s.bx(t,!1,e)}if(s.r5(t))return s.bx(t,!1,e);s.Os(1,O().Exp_MultipleSelections)}return I},vx:function(e){var t,n,o,r,i,a,s=this,l=s._eventHandler;s.isEditing()||(e&&(t=e.pasteText,n=e.pasteHtml,o=e.callback,r=e.shiftCells,i=s.getSelections()[0]),l&&!t&&l.gx(""),(a=s.tu())&&(a.VHb=!1),setTimeout((function(){var e,u,c,f,h;s.Js||(e=t||"",u=n||"",l&&!t&&(a&&(e=(h=a.wx()).text,u=h.html,f=h.image,c=a.n5&&a.n5[0]),l.hx()),(S.msie||S.edge||t||!e&&!u&&!a.VHb)&&(s.J4(e,u,f,r,i,c),o&&o()),s._eventHandler.Qq())}),100))},J4:function(e,t,n,o,r,i){var a,s=this,u=s.tu();if(u&&(u.VHb=!0),!(a=s.xx(e,o,t))){if(!n)return;a={pasteOption:s.options.clipBoardOptions,pastedRanges:[l.kf(s.getActiveRowIndex(),s.getActiveColumnIndex(),1,1)],clipboardText:""}}o!==R&&(a.WHb=o),r&&(a.XHb=r),i&&(a.YHb=i),a.cmd="clipboardPaste",a.sheetName=s.name(),lt(s)&&(a.clipboardHtml=t,a.clipboardImage=n),s.wu().execute(a)},xx:function(e,t,n){var o,r,i,a,s,l,u,c,f,h=this,p=O().Exp_InvalidPastedArea,d=h.tu(),g=d.PA,m=d.n5,y=d.G4;if(y&&g&&m&&g.options.isProtected&&g.p5(m)&&(y=!1),o={pastedRange:I,pastedInternal:!1},r=[],(i=h.getSelections()).length>1)for(s=0;s<i.length;s++){if(a=i[s],!h.ix(g,m,a,y,e,o,R,n))return;if(a.containsRange(o.pastedRange)&&!a.equals(o.pastedRange))return void h.Os(1,p);r.push(o.pastedRange)}else{if(a=i.length>0?i[0]:h._modelManager.getSpan(h.Jl,h.Kl),!h.ix(g,m,a,y,e,o,t,n))return;r.push(o.pastedRange)}if((l=h.at)&&l.jx(o.pastedInternal),o.pastedInternal||(g=I,m=I,y=!1),u=h.options.clipBoardOptions,y&&(u=0),m&&1===m.length)for(c=0;c<r.length;c++)f=r[c],h.nx(m[0],f)&&(f.rowCount=1,f.colCount=1);return(!m||m.length>1)&&r.length>1?void h.Os(1,O().Exp_MultipleSelections):{fromSheet:g,fromRanges:m,isCutting:y,pasteOption:u,pastedRanges:r,clipboardText:e}},l5:function(e,t,n,o,r){var i=this,a=ot(i),s=rt(i);return st(i)?-1<=e&&(r||e<a)&&-1<=t&&(r||t<s):i.pu(e,t,n,o,a,s)},p5:function(e){for(var t=0;t<e.length;t++)if(this.ou(e[t]))return!0;return!1},yx:function(e,t,n,o){var r,i,a,s=this;s.endEdit&&!s.endEdit()||(r={sheet:s,sheetName:s.name(),row:s.Jl,col:s.Kl,cancel:!1},s.Wq(l.Events.LeaveCell,r),!0!==r.cancel&&(i=s.Jl,a=s.Kl,m(n)&&(n=s.Jl),m(o)&&(o=s.Kl),3===e?s.zx(n,o,t):4===e?s.Rs(n,o,t):1===e?s.Ax(n,o,t):2===e?s.Bx(n,o,t):5===e?s.Cx():6===e&&s.Dx(),s.Ss(e,i,a)))},Ex:function(e){var t,n,o,r=this;r.endEdit()&&(t={sheet:r,sheetName:r.name(),row:r.Jl,col:r.Kl,cancel:!1},r.Wq(l.Events.LeaveCell,t),!0!==t.cancel&&(n=r.Jl,o=r.Kl,3===e?r.Fx(r.Jl,r.Kl):4===e&&r.Gx(r.Jl,r.Kl),r.Ss(e,n,o)))},Ss:function(e,t,n){var o,r,i,a,s,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A=this,M=A._eventHandler,S=A._modelManager.getSelections(),T=!1;A.Hx||(o=A.Tq(A._getActiveSelectedRange()),(S.length>1||it(o)>1||at(o)>1)&&(T=!0),!T&&A.mJb&&A.mJb.mgc(o)&&(T=!0),A.Tr()),r=A.Jl,i=A.Kl,a=A._modelManager.getSpan(r,i),A.Lr=it(a),A.Mr=at(a),A.Hx||(s=A.Jx(r,i),u=A.selectionPolicy(),c=A.selectionUnit(),(0===u||1===u)&&A._modelManager.do("clearSelection"),1===c?(s.col=-1,s.colCount=-1):2===c&&(s.row=-1,s.rowCount=-1),A.Kx(s.row,s.col,it(s),at(s),!1),f=A._modelManager.getSelections(),M.zu(S,f)&&(A.yu(S,f),A.Au(S))),A.Yq(r,i),t!==r&&((h=A.wq)&&h.Lx()),p=A._render,T?(g=(d=A.am()).zr,m=d.Ar,y=d.width-g,v=d.height-m,p.Mx(g,m,y,v),p.repaint(new l.Rect(g,m,y,d.Cr)),p.repaint(new l.Rect(g,m,d.Br,v)),p.Pw(p.bm())):(C=it(b=A._modelManager.getSpan(t,n)),w=at(b),p.im(new l.Range(r,i,A.Lr,A.Mr).union(new l.Range(t,n,C,w)))),x={sheet:A,sheetName:A.name(),row:r,col:i},A.Wq(l.Events.EnterCell,x),A.Wq(l.Events.FormulatextboxEnterCell,x),M.cs&&M.cs(r,i)},Nx:function(e,t){var n=this,o=n.getDataValidator&&n.getDataValidator(e,t),r={sheet:n,sheetName:n.name(),row:e,col:t,validator:o,validationResult:0};return n.Wq(l.Events.ValidationError,r),r.validationResult}}),F={},t.Commands=F,F.Ox=function(e,t){return!!e&&2!==e._editorStatus&&(e.yx(t,!1),!0)},F.Qx=function(e,t,n,o){return!!e&&2!==e._editorStatus&&(e.yx(t,!1,n,o),!0)},F.Rx=function(e,t,n){return!(!e||2===e._editorStatus||e.endEdit&&!e.endEdit()||(e.Sx(t,n),0))},P="navigationLeft",H="navigationRight",B="navigationUp",L="navigationDown",z="navigationHome2",V="navigationEnd2",G="navigationTop",W="navigationBottom",U="navigationHome",Z="navigationFirst",q="navigationEnd",J="navigationLast",Q="moveToNextCell",Y="moveToPreviousCell",K="navigationPageUp",$="navigationPageDown",X="navigationPreviousSheet",ee="navigationNextSheet",te="clear",ne="clearAndEditing",oe="commitInputNavigationDown",re="commitInputNavigationUp",ie="cancelInput",ae="commitArrayFormula",se="selectionLeft",le="selectionRight",ue="selectionUp",ce="selectionDown",fe="selectionHome",he="selectionEnd",pe="selectionPageUp",de="selectionPageDown",ge="selectionTop",me="selectionBottom",ye="selectionFirst",ve="selectionLast",be="copy",Ce="paste",we="undo",xe="redo",Ae="resizeColumn",Me="resizeRow",Se="splitResizeRow",Te="splitResizeColumn",Ne="autoFitColumn",Ie="autoFitRow",Re="editCell",ke="renameSheet",Ee="zoom",De="clearValues",je="clipboardPaste",_e="selectNextControl",Oe="selectPreviousControl",Fe="moveToNextCellThenControl",Pe="moveToPreviousCellThenControl",He="changeFormulaReference",F.bT=Nt,F.h4=It,F.uv=function(e){var t=l.Ul.sl(),n=!t,o=t;e.register(P,F[P],37,!1,!1,!1,!1),e.register(H,F[H],39,!1,!1,!1,!1),e.register(B,F[B],38,!1,!1,!1,!1),e.register(L,F[L],40,!1,!1,!1,!1),e.register(z,F[z],37,n,!1,!1,o),e.register(V,F[V],39,n,!1,!1,o),e.register(G,F[G],38,n,!1,!1,o),e.register(W,F[W],40,n,!1,!1,o),e.register(U,F[U],36,!1,!1,!1,!1),e.register(Z,F[Z],36,!0,!1,!1,!1),e.register(q,F[q],35,!1,!1,!1,!1),e.register(J,F[J],35,!0,!1,!1,!1),e.register(Q,F[Q],9,!1,!1,!1,!1),e.register(Y,F[Y],9,!1,!0,!1,!1),e.register(K,F[K],33,!1,!1,!1,!1),e.register($,F[$],34,!1,!1,!1,!1),e.register(X,F[X],33,n,!1,!1,o),e.register(ee,F[ee],34,n,!1,!1,o),e.register(te,F[te],46,!1,!1,!1,!1),e.register(ne,F[ne],8,!1,!1,!1,!1),e.register(oe,F[oe],13,!1,!1,!1,!1),e.register(re,F[re],13,!1,!0,!1,!1),e.register(ie,F[ie],27,!1,!1,!1,!1),e.register(ae,F[ae],13,!0,!0,!1,!1),e.register(se,F[se],37,!1,!0,!1,!1),e.register(le,F[le],39,!1,!0,!1,!1),e.register(ue,F[ue],38,!1,!0,!1,!1),e.register(ce,F[ce],40,!1,!0,!1,!1),e.register(fe,F[fe],36,!1,!0,!1,!1),e.register(he,F[he],35,!1,!0,!1,!1),e.register(pe,F[pe],33,!1,!0,!1,!1),e.register(de,F[de],34,!1,!0,!1,!1),e.register(fe,F[fe],37,n,!0,!1,o),e.register(he,F[he],39,n,!0,!1,o),e.register(ge,F[ge],38,n,!0,!1,o),e.register(me,F[me],40,n,!0,!1,o),e.register(ye,F[ye],36,!0,!0,!1,!1),e.register(ve,F[ve],35,!0,!0,!1,!1),e.register(be,F[be],67,n,!1,!1,o),e.register("cut",F.cut,88,n,!1,!1,o),e.register(Ce,F[Ce],86,n,!1,!1,o),e.register(we,F[we],90,n,!1,!1,o),e.register(xe,F[xe],89,n,!1,!1,o),t&&e.register(xe,F[xe],90,n,!0,!1,o),e.register(_e,F[_e]),e.register(Oe,F[Oe]),e.register(Fe,F[Fe]),e.register(Pe,F[Pe]),e.register(He,F[He]),e.register(Ae,F[Ae]),e.register(Me,F[Me]),e.register(Te,F[Te]),e.register(Se,F[Se]),e.register(Ne,F[Ne]),e.register(Ie,F[Ie]),e.register(Re,F[Re]),e.register(ke,F[ke]),e.register(Ee,F[Ee]),e.register(De,F[De]),e.register(je,F[je])},Be={256:"bindingPath",4:"comment",2:"formula",16:"sparkline",64:"style",128:"tag",1024:"hyperlink",1:"value"},Le=".cellEditAction",F[P]={canUndo:!1,execute:Rt(3)},F[H]={canUndo:!1,execute:Rt(4)},F[B]={canUndo:!1,execute:Rt(1)},F[L]={canUndo:!1,execute:Rt(2)},F[ae]={canUndo:!1,execute:function(e,t){var n=Nt(e,t),o=F.Wx;return o&&(n=o.fv(n)),n.fv&&n.fv(),!0}},F[oe]={canUndo:!1,execute:function(e,t){var n=Nt(e,t),o=F.Wx;return o&&(n=o.Xx(n)),n.yx(2,!1),!0}},F[re]={canUndo:!1,execute:function(e,t){var n=Nt(e,t),o=F.Wx;return o&&(n=o.Yx(n)),n.yx(1,!1),!0}},F[U]={canUndo:!1,execute:function(e,t){var n=Nt(e,t);return F.Qx(n,4,I,n.frozenColumnCount()-1)}},F[z]={canUndo:!1,execute:function(e,t){var n=Nt(e,t);return F.Qx(n,4,I,-1)}},F[q]={canUndo:!1,execute:function(e,t){var n=Nt(e,t);return F.Qx(n,3,I,rt(n)-n.frozenTrailingColumnCount())}},F[V]={canUndo:!1,execute:function(e,t){var n=Nt(e,t);return F.Qx(n,3,I,rt(n))}},F[G]={canUndo:!1,execute:function(e,t){var n=Nt(e,t);return F.Qx(n,2,-1,I)}},F[W]={canUndo:!1,execute:function(e,t){var n=Nt(e,t);return F.Qx(n,1,ot(n),I)}},F[K]={canUndo:!1,execute:function(e,t){var n,o,r,i,a,s=Nt(e,t);if(!s||2===s._editorStatus)return!1;if((n=s.Ew())===I||n===s.lq)return!0;if(o=s.Gr(1,3),(r=s._q(s.Jl-o.length))<n&&(r=n),i=F.Wx){if((a=i.Zx(s,r,n)).r)return!0;s=a.sheet}return!!s.endEdit()&&(s.Qs(r,s.getActiveColumnIndex())&&(s.Jr(r,I),s.Qr=r,s.yx()),s.mq(n,0),!0)}},F[$]={canUndo:!1,execute:function(e,t){var n,o,r,i,a,s=Nt(e,t);if(!s||2===s._editorStatus)return!1;if((n=s.$x())===I||n===s.lq)return!0;if(o=s.Gr(1,3),(r=s.gr(s.Jl+o.length))<n&&(r=n),i=F.Wx){if((a=i._x(s,r,n)).r)return!0;s=a.sheet}return!!s.endEdit()&&(s.Qs(r,s.getActiveColumnIndex())&&(s.Jr(r,I),s.Qr=r,s.yx()),s.mq(n,0),!0)}},F[ee]={canUndo:!1,execute:function(e,t){Et(Nt(e,t),!0)}},F[X]={canUndo:!1,execute:function(e,t){Et(Nt(e,t),!1)}},F[Z]={canUndo:!1,execute:function(e,t){var n,o,r=Nt(e,t);if(!r||2===r._editorStatus)return!1;if(n=F.Wx){if((o=n.ay(r)).r)return!0;r=o.sheet}return r.yx(5,!1,r.Jl,r.Kl),!0}},F[J]={canUndo:!1,execute:function(e,t){var n,o,r=Nt(e,t);if(!r||2===r._editorStatus)return!1;if(n=F.Wx){if((o=n.by(r)).r)return!0;r=o.sheet}return r.yx(6,!1,r.Jl,r.Kl),!0}},F[_e]={canUndo:!1,execute:function(e,t){var n=Nt(e,t);return!!n.parent&&jt(n,n.parent.nextControl)}},F[Oe]={canUndo:!1,execute:function(e,t){var n=Nt(e,t);return!!n.parent&&jt(n,n.parent.previousControl)}},F[Q]={canUndo:!1,execute:function(e,t){var n=Nt(e,t),o=F.Wx;return o&&(n=o.ey(n)),Dt(n,4),!0}},F[Y]={canUndo:!1,execute:function(e,t){var n=Nt(e,t),o=F.Wx;return o&&(n=o.gy(n)),Dt(n,3),!0}},F[Fe]={canUndo:!1,execute:function(e,t){var n,o=Nt(e,t),r=o.Qr,i=o.getActiveColumnIndex();return o.Tx=!0,n=o.hy(o.getActiveRowIndex(),i,!0,r),o.Tx=!1,!n||n.leadingCellRow<r||n.leadingCellRow===r&&i>n.col?F[_e].execute(e,t):F[Q].execute(e,t)}},F[Pe]={canUndo:!1,execute:function(e,t){var n,o=Nt(e,t),r=o.Qr,i=o.getActiveColumnIndex();return o.Tx=!0,n=o.iy(o.getActiveRowIndex(),i,!0,r),o.Tx=!1,!n||n.leadingCellRow>r||n.leadingCellRow===r&&i<n.col?F[Oe].execute(e,t):F[Y].execute(e,t)}},F[ie]={canUndo:!1,execute:function(e,t){var n,o,r,i,a,s,l,u=Nt(e,t),c=F.Wx;return c&&(n=c.jy(u)),u.isEditing()?(o=u.Jl,r=u.Kl,i=u.getValue(o,r,3,1),!!u.endEdit(!0)&&((s=(a=u._modelManager)&&a.ZHb)&&s.getAnchorCell(o,r)||u.setValue(o,r,i,3,!0),!0)):m(n)?(F.Yxb(u.parent),u.uu=I,u.parent.uu.hZ(),(l=u).ex&&l.ex(),void(l.Sob&&l.Sob())):n}},F.Yxb=function(e){var t,n,o,r=e&&e.sheets;if(r)for(t=0,n=r.length;t<n;t++)(o=r[t])&&o.at&&o.at.ky()},F[te]={canUndo:!1,execute:function(e,t){var n,o=Nt(e,t);return!o.isEditing()&&(n=o.getSelections(),o.wu().execute({cmd:De,sheetName:o.name(),ranges:n}),!0)}},F[ne]={canUndo:!1,execute:function(e,t){var n=Nt(e,t);return!n.isEditing()&&(l.Ul.sl()?(F[te].execute(e,t),!0):(n.startEdit(!0,""),!0))}},F[be]={canUndo:!1,execute:function(e,t){var n=Nt(e,t),o=t.copyData=n.ux(t.ignoreClipboard);return t.callback&&t.callback(),!o||R}},F.cut={canUndo:!1,execute:function(e,t){var n=Nt(e,t),o=t.cutData=n.sx(t.ignoreClipboard);return t.callback&&t.callback(),!o||R}},F[Ce]={canUndo:!1,execute:function(e,t){Nt(e,t).vx(t)}},F[se]={canUndo:!1,execute:kt(37)},F[le]={canUndo:!1,execute:kt(39)},F[ue]={canUndo:!1,execute:kt(38)},F[ce]={canUndo:!1,execute:kt(40)},F[fe]={canUndo:!1,execute:kt(37,!0)},F[he]={canUndo:!1,execute:kt(39,!0)},F[pe]={canUndo:!1,execute:kt(33)},F[de]={canUndo:!1,execute:kt(34)},F[ge]={canUndo:!1,execute:kt(38,!0)},F[me]={canUndo:!1,execute:kt(40,!0)},F[ye]={canUndo:!1,execute:kt(36,!0)},F[ve]={canUndo:!1,execute:kt(35,!0)},F[He]={canUndo:!1,execute:function(e,t){var n=Nt(e,t),o=n&&n._eventHandler;if(o){ft(n);try{o.ly&&o.ly()}finally{ht(n)}}}},F[we]={canUndo:!1,execute:function(e){var t;e&&((t=e.undoManager())&&t.canUndo()&&t.undo())}},F[xe]={canUndo:!1,execute:function(e){var t;e&&((t=e.undoManager())&&t.canRedo()&&t.redo())}},F[Ae]={canUndo:!0,execute:function(e,t,n){return It(e,Ge,t,n)}},F[Me]={canUndo:!0,execute:function(e,t,n){return It(e,We,t,n)}},F[Te]={canUndo:!0,execute:function(e,t,n){return It(e,Ue,t,n)}},F[Se]={canUndo:!0,execute:function(e,t,n){return It(e,Ze,t,n)}},F[Ne]={canUndo:!0,execute:function(e,t,n){return It(e,qe,t,n)}},F[Ie]={canUndo:!0,execute:function(e,t,n){return It(e,Je,t,n)}},F[Re]={canUndo:!0,execute:function(e,t,n){return It(e,Qe,t,n)}},F[ke]={canUndo:!0,execute:function(e,t,n){return It(e,Ye,t,n)}},F[Ee]={canUndo:!0,execute:function(e,t,n){return It(e,Ke,t,n)}},F[De]={canUndo:!0,execute:function(e,t,n){return It(e,Xe,t,n)}},F[je]={canUndo:!0,execute:function(e,t,n){return It(e,tt,t,n)}},ze=function(){function e(e,t,n){var o=this;o.kj=e,o.my=t,o.ny=n,o.oy=[],o.Iu=[],o.py()}return e.prototype.py=function(){var e,t,n,o,r,i,a,s,l,u,c,f,h,p,d,m,y,v,b,C,w,x,A,M,S,T,N=this,k=N.my,E=N.kj;if(E&&k){if(e=N.ny,t=k.row,n=k.col,o=it(k),r=at(k),i=N.oy,a=!1,-1===t&&(a=!0,t=0,o=ot(E)),-1===n&&(a=!0,n=0,r=rt(E)),l=[],(64&e)>0)for(c=0;c<r;c++)l[c]=E.Aj(-1,c)||I;for(f=0;f<o;f++)for(h=t+f,(64&e)>0&&(s=E.Aj(h,-1)||I),p=0;p<r;p++){if(d=void 0,m=n+p,g&&(2&e)>0&&E.getFormulaInformation&&(d=E.getFormulaInformation(h,m)).hasFormula)if(d.isArrayFormula){if((y=d.baseRange).row===h&&y.col===m)for(v=y.row,b=y.row+it(y);v<b;v++)for(C=y.col,w=y.col+at(y);C<w;C++)N.qy(i,v-t,C-n,d,2)}else N.qy(i,f,p,d.formula,2);!((1&e)>0)||d&&d.hasFormula||N.qy(i,f,p,E.getValue(h,m,3),1),(16&e)>0&&E.getSparkline&&(x=E.getSparkline(h,m),A=I,x&&(A=x.data()),x&&A&&N.qy(i,f,p,x,16)),(64&e)>0&&(M=void 0,a?M=E.getActualStyle(h,m,3):(u=E.Aj(h,m)||I,M=E.Dq(h,m,3,u,s,l[p])),S=R,M&&M.toJSON&&(S=JSON.stringify(M.toJSON(3,!0))),N.qy(i,f,p,S,64)),T=E._modelManager.Ky,(4&e)>0&&T&&N.qy(i,f,p,T.get(h,m),4),(128&e)>0&&N.qy(i,f,p,E.getTag(h,m,3),128),(256&e)>0&&N.qy(i,f,p,E.getBindingPath&&E.getBindingPath(h,m,3),256),(1024&e)>0&&N.qy(i,f,p,E.getHyperlink&&E.getHyperlink(f,p,3),1024)}}},e.prototype.sy=function(){return this.oy},e.prototype.qy=function(e,t,n,o,r){!m(o)&&e&&(e[t]===R&&(e[t]=[]),e[t][n]===R&&(e[t][n]={}),e[t][n][Be[r]]=o)},e.prototype.uy=function(e){var t,n,o,r,i,a,s,l;if(e)for(this,t=this.oy,n=0,o=e.length;n<o;n++)if(r=e[n])for(i=0,a=r.length;i<a;i++)(s=r[i])&&(t[n]||(t[n]=[]),(l=t[n][i])?this.vy(s,l)&&(t[n][i]=R):t[n][i]=s)},e.prototype.vy=function(e,t){var n,o,r,i=this.ny,a=[];for(256&i&&a.push(Be[256]),4&i&&a.push(Be[4]),2&i&&a.push(Be[2]),16&i&&a.push(Be[16]),64&i&&a.push(Be[64]),128&i&&a.push(Be[128]),1024&i&&a.push(Be[1024]),1&i&&a.push(Be[1]),n=0,o=a.length;n<o;n++)if(e[r=a[n]]!==t[r])return!1;return!0},e.prototype.wy=function(){var e,t,n,o,r,i=this,a=i.my.row,s=i.my.col,l=i.oy,u=i.Iu;if(u&&u.length>0)return u;for(u=[],a=-1===a?0:a,s=-1===s?0:s,e=0,t=l.length;e<t;e++)if(n=l[e])for(o=0,r=n.length;o<r;o++)n[o]&&u.push({row:e+a,col:o+s});return i.Iu=u,u},e}(),F.xy=ze,F.Bu=function(e,t,n,o,r,i,a,s,l){e&&(t<0&&(t=0,o=ot(e)),n<0&&(n=0,r=rt(e)),e.Bu(t,n,o,r,i,a,R,R,s,l))},F.bWa=function(e){return"changes"+e},F.cWa=function(e){return e&&(0!==e.length||!h.isEmptyObject(e))},F.aWa=function(e){var t,n=e.sheetName;return"string"==typeof n?t=[n]:Array.isArray(n)&&(t=n),!!t&&t.every((function(t){var n=F.bWa(t),o=e[n];return o&&0===o.length&&h.isEmptyObject(o)}))},F.startTransaction=function(e,t){_t(e,t.sheetName).forEach((function(e){e._modelManager.startTransaction()}))},F.endTransaction=function(e,t){_t(e,t.sheetName).forEach((function(e){var n=F.bWa(e.name());t[n]=e._modelManager.endTransaction()}))},F.undoTransaction=function(e,t){_t(e,t.sheetName).forEach((function(e){var n=F.bWa(e.name());e._modelManager.undo(t[n]),e.$p()}))},F.Zxb=function(e){e.forEach((function(e){e._modelManager.startTransaction()}))},F.$xb=function(e,t){e.forEach((function(e){var n=F.bWa(e.name());t[n]=e._modelManager.endTransaction()}))},F._xb=function(e,t){e.forEach((function(e){var n=F.bWa(e.name());e._modelManager.undo(t[n])}))},Ve=function(){function e(e,t){this.Lz=Ot,this.Mz=Ft;this.kj=e,this.VQ=t}return e.prototype.execute=function(){},e.prototype.canExecute=function(){return!0},e.prototype.canUndo=function(){return!0},e.prototype.undo=function(){return!0},e}(),F.ActionBase=Ve,Ge=function(e){function t(t,n){var o=e.call(this,t,n)||this;return Pt(n,t),o}return nt(t,e),t.prototype.execute=function(){var e,t,n,o,r,i,a,s,l,u,c,f,p,d,g=this,m=!1;if(g.canExecute()&&(e=g.VQ,t=g.kj,n=e.columns,o=e.rowHeader,r=n&&n.length,t&&r>0)){if(i=g.Sz(n),a={sheet:t,sheetName:t.name(),colList:i,header:o,cancel:!1},t.Wq(w,a),a&&!0===a.cancel)return m;e.Tz=!0,t._modelManager.startTransaction(),Ot(t);try{for(2,3,s=rt(t,o?2:3),t.qq=e.qq,l=e.size,u=0;u<r;u++)for(f=(c=n[u]).firstCol,p=c.lastCol,d=f;d<=p;d++)0<=d&&d<s&&(o&&t.getColumnResizable(d,2)&&l!==t.$r(d,2)?(t.setColumnWidth(d,l,2),m=!0):!o&&t.getColumnResizable(d,3)&&l!==t.$r(d,3)&&(t.setColumnWidth(d,l,3),m=!0))}finally{dt(t),h[h.sd]({tc:t.parent}),t.Wq(x,{sheet:t,sheetName:t.name(),colList:i,header:e.rowHeader}),ht(t),e[F.bWa(t.name())]=t._modelManager.endTransaction()}t.qs()}return m},t.prototype.undo=function(){var e,t,n,o,r,i,a,s,l=this,u=!1;if(l.canUndo()&&(e=l.VQ,t=l.kj,n=e.columns,o=e.rowHeader,r=n&&n.length,t&&r>0)){if(i=l.Sz(n),a={sheet:t,sheetName:t.name(),colList:i,header:o,cancel:!1},t.Wq(w,a),a&&!0===a.cancel)return u;Ot(t);try{s=F.bWa(t.name()),t._modelManager.undo(e[s]),t.oq=!0,t.showCell(t.getActiveRowIndex(),t.getActiveColumnIndex(),1,1),u=!0}finally{dt(t),h[h.sd]({tc:t.parent}),t.Wq(x,{sheet:t,sheetName:t.name(),colList:i,header:e.rowHeader}),ht(t)}}return u},t.prototype.Sz=function(e){var t,n,o,r,i,a,s=[];for(t=0,n=e.length;t<n;t++)for(r=(o=e[t]).firstCol,i=o.lastCol,a=r;a<=i;a++)s.push(a);return s},t.prototype.canUndo=function(){return this.VQ.Tz},t}(Ve),We=function(e){function t(t,n){var o=e.call(this,t,n)||this;return Pt(n,t),o}return nt(t,e),t.prototype.execute=function(){var e,t,n,o,r,i,a,s,l,u,c,f,p,d,g=this,m=!1;if(g.canExecute()&&(e=g.kj,o=(n=(t=g.VQ).rows)&&n.length,e&&o>0)){if(r=g.Vz(n),i={sheet:e,sheetName:e.name(),rowList:r,header:t.columnHeader,cancel:!1},e.Wq(A,i),i&&!0===i.cancel)return m;t.Tz=!0,e._modelManager.startTransaction(),Ot(e);try{for(3,1,s=ot(e,(a=t.columnHeader)?1:3),e.lq=t.lq,l=t.size,u=0;u<o;u++)for(f=(c=n[u]).firstRow,p=c.lastRow,d=f;d<=p;d++)0<=d&&d<s&&(a&&e.getRowResizable(d,1)&&l!==e.Yr(d,1)?(e.setRowHeight(d,l,1),m=!0):!a&&e.getRowResizable(d,3)&&l!==e.Yr(d,3)&&(e.setRowHeight(d,l,3),m=!0))}finally{dt(e),h[h.sd]({tc:e.parent}),e.Wq(M,{sheet:e,sheetName:e.name(),rowList:r,header:t.columnHeader}),ht(e),t[F.bWa(e.name())]=e._modelManager.endTransaction()}e.os()}return m},t.prototype.undo=function(){var e,t,n,o,r,i,a,s=this,l=!1;if(s.canUndo()&&(e=s.kj,o=(n=(t=s.VQ).rows)&&n.length,e&&o>0)){if(r=s.Vz(n),i={sheet:e,sheetName:e.name(),rowList:r,header:t.columnHeader,cancel:!1},e.Wq(A,i),i&&!0===i.cancel)return l;Ot(e);try{a=F.bWa(e.name()),e._modelManager.undo(t[a]),e.jq=!0,e.showCell(e.getActiveRowIndex(),e.getActiveColumnIndex(),1,1),l=!0}finally{dt(e),h[h.sd]({tc:e.parent}),e.Wq(M,{sheet:e,sheetName:e.name(),rowList:r,header:t.columnHeader}),ht(e)}}return l},t.prototype.Vz=function(e){var t,n,o,r,i,a,s=[];for(t=0,n=e.length;t<n;t++)for(r=(o=e[t]).firstRow,i=o.lastRow,a=r;a<=i;a++)s.push(a);return s},t.prototype.canUndo=function(){return this.VQ.Tz},t}(Ve),Ue=function(e){function t(t,n){var o=e.call(this)||this,r=o;return r.kj=t,r.VQ=n,o}return nt(t,e),t.prototype.execute=function(){var e,t,n,o,r,i,a,s=this,l=!1,u=s.VQ,c=s.kj,f=u.columns,p=u.rowHeader,d=s.Sz(f);if(c&&f&&f.length>0){if(e={sheet:c,sheetName:c.Cj,colList:d,header:p,cancel:!1},c.Wq(w,e),e&&!0===e.cancel)return l;c._modelManager.startTransaction(),s.Lz(c);try{t=D(u.size),n=p?2:3,o=f[0].firstCol,void 0,i=void 0,a=void 0,t!==(r=c.$r(o,n))&&(i=t-r,a=c.Zq(o,n),c.setColumnWidth(o,t,n),c.setColumnWidth(a,c.$r(a,n)-i,n)),l=!0}finally{dt(c),h[h.sd]({tc:c.parent}),c.Wq(x,{sheet:c,sheetName:c.Cj,colList:d,header:u.rowHeader}),ht(c),u[F.bWa(c.name())]=c._modelManager.endTransaction()}}return l},t.prototype.undo=function(){var e,t=this.kj,n=this.VQ.columns,o=!1,r=this.VQ,i=this.VQ.rowHeader,a=this.Sz(n),s={sheet:t,sheetName:t.Cj,colList:a,header:i,cancel:!1};if(t.Wq(w,s),s&&!0===s.cancel)return o;Ot(t);try{e=F.bWa(t.name()),t._modelManager.undo(r[e]),o=!0}finally{dt(t),h[h.sd]({tc:t.parent}),t.Wq(x,{sheet:t,sheetName:t.Cj,colList:a,header:r.rowHeader}),ht(t)}return o},t.prototype.Sz=function(e){var t,n,o,r,i,a,s=[];for(t=0,n=e.length;t<n;t++)for(r=(o=e[t]).firstCol,i=o.lastCol,a=r;a<=i;a++)s.push(a);return s},t}(Ve),Ze=function(e){function t(t,n){var o=e.call(this)||this,r=o;return r.kj=t,r.VQ=n,o}return nt(t,e),t.prototype.execute=function(){var e,t,n,o,r,i,a,s=this,l=!1,u=s.VQ,c=s.kj,f=u.rows,p=u.columnHeader,d=s.Vz(f);if(c&&f&&f.length>0){if(e={sheet:c,sheetName:c.Cj,rowList:d,header:p,cancel:!1},c.Wq(A,e),e&&!0===e.cancel)return l;c._modelManager.startTransaction(),s.Lz(c);try{t=D(u.size),n=p?1:3,o=f[0].firstRow,void 0,i=void 0,a=void 0,t!==(r=c.Yr(o,n))&&(i=t-r,a=c._q(o,n),c.setRowHeight(o,t,n),c.setRowHeight(a,c.Yr(a,n)-i,n)),l=!0}finally{dt(c),h[h.sd]({tc:c.parent}),c.Wq(M,{sheet:c,sheetName:c.Cj,rowList:d,header:u.columnHeader}),ht(c),u[F.bWa(c.name())]=c._modelManager.endTransaction()}}return l},t.prototype.undo=function(){var e,t=this.kj,n=this.VQ.rows,o=!1,r=this.VQ,i=this.VQ.columnHeader,a=this.Vz(n),s={sheet:t,sheetName:t.Cj,rowList:a,header:i,cancel:!1};if(t.Wq(A,s),s&&!0===s.cancel)return o;Ot(t);try{e=F.bWa(t.name()),t._modelManager.undo(r[e]),o=!0}finally{dt(t),h[h.sd]({tc:t.parent}),t.Wq(M,{sheet:t,sheetName:t.Cj,rowList:a,header:r.columnHeader}),ht(t)}return o},t.prototype.Vz=function(e){var t,n,o,r,i,a,s=[];for(t=0,n=e.length;t<n;t++)for(r=(o=e[t]).firstRow,i=o.lastRow,a=r;a<=i;a++)s.push(a);return s},t}(Ve),qe=function(e){function t(t,n){var o=e.call(this,t,n)||this,r=o,i=t.parent;return r.Wz=n.rowHeader?2:3,T(n.autoFitType)||(n.autoFitType=i?i.options.autoFitType:0),o}return nt(t,e),t.prototype.canExecute=function(){var e=this.VQ;return this.kj&&e.columns&&e.columns.length>0},t.prototype.execute=function(){var e,t,n,o,r,i,a,s,u,c,f,p,d,g,y=this,v=!1;if(y.canExecute()){if(e=y.VQ,t=y.kj,n=y.Wz,o=y.Sz(e.columns),r=2===n,i={sheet:t,sheetName:t.name(),colList:o,header:r,cancel:!1},t.Wq(w,i),i&&!0===i.cancel)return v;for(e.Tz=!0,s=(a=rt(t,n))-1,u=0,c=void 0,f=0,p=e.columns.length;f<p;f++)s=s>(c=e.columns[f].col)?c:s,u=u<c?c:u;l.mn.qn(t,0,s,ot(t)-1,u),t._modelManager.startTransaction(),Ot(t);try{for(d=void 0,f=0,p=e.columns.length;f<p;f++)0<=(g=e.columns[f].col)&&g<a&&t.getColumnResizable(g,n)&&((d=y.xl(g))===t.getColumnWidth(g,n)&&m(t.getColumnWidth(g,n,!0))||(t.setColumnWidth(g,d,n),v=!0))}finally{l.mn.Nm(),dt(t),h[h.sd]({tc:t.parent}),t.Wq(x,{sheet:t,sheetName:t.name(),colList:o,header:r}),ht(t),e[F.bWa(t.name())]=t._modelManager.endTransaction()}}return v},t.prototype.undo=function(){var e,t,n,o,r,i,a,s=this,l=!1;if(s.canUndo()){if(e=s.VQ,t=s.kj,n=s.Wz,o=s.Sz(e.columns),r=2===n,i={sheet:t,sheetName:t.name(),colList:o,header:r,cancel:!1},t.Wq(w,i),i&&!0===i.cancel)return l;Ot(t);try{a=F.bWa(t.name()),t._modelManager.undo(e[a]),l=!0}finally{dt(t),h[h.sd]({tc:t.parent}),t.Wq(x,{sheet:t,sheetName:t.name(),colList:o,header:r}),ht(t)}}return l},t.prototype.Sz=function(e){var t,n,o=[];for(t=0;t<e.length;t++)n=e[t],o.push(n.col);return o},t.prototype.xl=function(e){return l.Ul.xl(e,this.kj,this.Wz,this.VQ.autoFitType)},t.prototype.canUndo=function(){return this.VQ.Tz},t}(Ve),Je=function(e){function t(t,n){var o=e.call(this,t,n)||this,r=o,i=t.parent;return r.Wz=n.columnHeader?1:3,T(n.autoFitType)||(n.autoFitType=i?i.options.autoFitType:0),o}return nt(t,e),t.prototype.canExecute=function(){var e=this.VQ;return this.kj&&e.rows&&e.rows.length>0},t.prototype.execute=function(){var e,t,n,o,r,i,a,s,l,u,c,f=this,p=!1;if(f.canExecute()){if(e=f.VQ,t=f.kj,n=f.Vz(e.rows),o=f.Wz,r=1===f.Wz,i={sheet:t,sheetName:t.name(),rowList:n,header:r,cancel:!1},t.Wq(A,i),i&&!0===i.cancel)return p;e.Tz=!0,t._modelManager.startTransaction(),Ot(t);try{for(a=ot(t,o),s=void 0,l=0,u=e.rows.length;l<u;l++)0<=(c=e.rows[l].row)&&c<a&&t.getRowResizable(c,o)&&((s=f.Fl(c))===t.getRowHeight(c,o)&&m(t.getRowHeight(c,o,!0))||(t.setRowHeight(c,s,o),p=!0))}finally{dt(t),h[h.sd]({tc:t.parent}),t.Wq(M,{sheet:t,sheetName:t.name(),rowList:n,header:r}),ht(t),e[F.bWa(t.name())]=t._modelManager.endTransaction()}}return p},t.prototype.undo=function(){var e,t,n,o,r,i,a=this,s=!1;if(a.canUndo()){if(e=a.VQ,t=a.kj,n=a.Vz(e.rows),o=1===a.Wz,r={sheet:t,sheetName:t.name(),rowList:n,header:o,cancel:!1},t.Wq(A,r),r&&!0===r.cancel)return s;Ot(t);try{i=F.bWa(t.name()),t._modelManager.undo(e[i]),s=!0}finally{dt(t),h[h.sd]({tc:t.parent}),t.Wq(M,{sheet:t,sheetName:t.name(),rowList:n,header:o}),ht(t)}}return s},t.prototype.Vz=function(e){var t,n,o,r=[];for(t=0,n=e.length;t<n;t++)o=e[t],r.push(o.row);return r},t.prototype.Fl=function(e){return l.Ul.Fl(e,this.kj,this.Wz,this.VQ.autoFitType)},t.prototype.canUndo=function(){return this.VQ.Tz},t}(Ve),Qe=function(e){function t(t,n){var o,r,i=e.call(this,t,n)||this;return g&&n.ranges&&1===n.endEditType&&(o=t.Tq(n.ranges[0]),n.ranges[0]=o,1===it(o)&&1===at(o)&&((r=t.Ms(o.row,o.col,1,1))&&r.ranges&&r.ranges.length>0&&(n.ranges=[r.ranges[0]]))),i}return nt(t,e),t.prototype.canExecute=function(){var e,t,n=this.kj,o=this.VQ,r=o.ranges,i=o.row,a=o.col;if(r){for(e=0;e<r.length;e++)if(t=r[e],!n.Y3(t.row,t.col,it(t),at(t)))return!1}else if(!n.Y3(i,a,1,1))return!1;return!0},t.prototype.yA=function(e){var t,n,o,r,i=this.VQ,a=i.ranges;if(a)for(t=0;t<a.length;t++)for(o=(n=a[t]).row;o<n.row+it(n);o++)for(r=n.col;r<n.col+at(n);r++)e(o,r);else e(i.row,i.col)},t.prototype.undo=function(){var e,t,n,o=this;if(o.canUndo()){e=o.kj,t=o.VQ,Ot(e,!0);try{e._bind(C+Le,(function(t,n){Ht(e,n)})),n=F.bWa(e.name()),e._modelManager.undo(t[n])}catch(e){return!1}finally{e._unbind(C+Le),Ft(e,!0)}return!0}return!1},t.prototype.execute=function(){var e,t,n,o,r=this,i=!1;if(r.canExecute()){(e=r.kj)._modelManager.startTransaction(),Ot(e,!0);try{e._bind(C+Le,(function(t,n){Ht(e,n)})),r.VQ.applyResult=r.AA(),i=!0}catch(e){i=!1}finally{e._unbind(C+Le),Ft(e,!0),t=F.bWa(e.name()),r.VQ[t]=e._modelManager.endTransaction()}n=e.am(),o=new l.Rect(n.kt,n.nt,n.width-n.kt,n.height-n.nt),e.repaint(o)}return i},t.prototype.zA=function(e,t){return e+"_"+t},t.prototype.BA=function(e){var t,n,o,r,i,a=this,s=0,l=a.kj,u=a.VQ,c=u.row,f=u.col,h=u.newValue,p=!u.hasOwnProperty("autoFormat")||u.autoFormat;return g&&h&&h.length>0&&"="===h[0]?l.getDataValidator&&l.getDataValidator(c,f)&&(""!==(t=h.substring(1))&&t!==l.getFormula(c,f)&&((n=l.Cf())&&((o=n.parse(l.yj(),t,c>=0?c:0,f>=0?f:0,!0))&&(r=n._evaluateParsedFormula(l.yj(),o,{row:c,col:f}),l.isValid&&!l.isValid(c,f,r)&&(s=l.Nx(c,f)))))):(i=a.CA(c,f,h,p,e),!l.isValid||l.isValid(c,f,i)||(s=l.Nx(c,f),l._eventHandler.DA=!0)),s},t.prototype.AA=function(){var e,t,n,o,r,i,u,c,f,h,p,m,y,v,b=this,C=b.kj,w=b.VQ,x=w.newValue,A={tka:!1,uka:!1,_autoFormatter:R,quotePrefix:R},M=b.BA(A);if(1===M||2===M)return M;if(t=!w.hasOwnProperty("autoFormat")||w.autoFormat,n=(n=w.row)>=0?n:0,o=(o=w.col)>=0?o:0,g&&d&&d.Parser)if(u=C.Cf(),f=(c=C.parent)&&c.options.allowUserEditFormula,"@"!==C.getFormatter(n,o)&&f&&u&&x&&x.length>0&&"="===x[0])try{if(w.ranges&&1===w.endEditType)return i=w.ranges[0],C.setArrayFormula(i.row,i.col,it(i),at(i),x.substring(1)),M;r=u.parse(C.yj(),x.substring(1),n,o,!0)}catch(e){throw C.Os(0,"string"==typeof e?e:e.message),e}else w.ranges&&1===w.endEditType&&(i=w.ranges[0],C.getRange(i.row,i.col,it(i),at(i),3).clear(1));return r||(x&&"'"===x[0]?b.Uia(n,o,!0,A):b.Uia(n,o,R,A),e=b.CA(n,o,x,t,A)),b.yA((function(t,n){if(r)try{C._u(t,n,u.unparse(C.yj(),r,t,n),r),C.Wq(l.Events.UserFormulaEntered,{sheet:C,sheetName:C.name(),row:t,col:n,isCircularReference:C.ngc(t,n),formula:x.substring(1).toUpperCase()})}catch(e){throw C.Os(0,"string"==typeof e?e:e.message),e}else{try{C.hasFormula&&C.hasFormula(t,n)&&C.setFormula(t,n,I)}catch(e){throw C.Os(0,"string"==typeof e?e:e.message),e}try{C.uq(t,n,e,w.sheetArea),"string"!=typeof e&&null!==e||s.Worksheet.ao(C,"setHyperlinkWhenEditing",{url:e,row:t,col:n,sheetArea:w.sheetArea})}catch(e){C.setValue(t,n,x)}}})),p=A.uka,((h=A.tka)||p)&&(y="string"==typeof(m=C.Aj(n,o)),m&&!y||(v=new a.Style,y&&(v.parentName=m),m=v),h&&(m._autoFormatter=A._autoFormatter),p&&(m.quotePrefix=A.quotePrefix),C.setStyle(n,o,m)),M},t.prototype.canUndo=function(){return 0===this.VQ.applyResult},t.prototype.CA=function(e,t,n,o,r){var i,a,s,u=this.kj,c=this.VQ,f=c.ignoreFormatting,h=u.getActualStyle(e,t),p={};return i="string"!=typeof n||f?n:n&&"'"===n[0]?n.substring(1):l.Ul.ul(h,n,o,p,c.editingFormatter),r.quotePrefix?(r._autoFormatter=R,r.tka=!0):(a=p.value,o&&a&&(s=I,(i!==I&&"General"!==a.formatString()||!h._autoFormatter)&&(a.isAuto=!0,s=a),s&&(r.tka=!0,r._autoFormatter=s))),i},t.prototype.Uia=function(e,t,n,o){var r,i=this.kj.Aj(e,t),s="string"==typeof i;i&&!s||(r=new a.Style,s&&(r.parentName=i),i=r),i.quotePrefix!==n&&(o.uka=!0,o.quotePrefix=n)},t}(Ve),Ye=function(e){function t(t,n){return e.call(this,t,n)||this}return nt(t,e),t.prototype.canUndo=function(){return!!this.VQ.FA},t.prototype.canExecute=function(){var e=this.VQ;return this.kj&&e.name&&e.name!==e.FA},t.prototype.execute=function(){var e=this,t=e.kj,n=e.VQ,o=n.name,r=!1;return e.canExecute()&&(n.FA=t.name(),t._modelManager.startTransaction(),Ot(t,!0),gt(t),t.cq(o),Bt(t),n[F.bWa(t.name())]=t._modelManager.endTransaction(),r=!0,n.sheetName=o,mt(t,!1),Ft(t,!0)),r},t.prototype.undo=function(){var e,t,n,o=this;return!(!o.canUndo()||(e=o.kj,t=o.VQ,!e)||(Ot(e,!0),gt(e),n=F.bWa(e.name()),e._modelManager.undo(t[n]),Bt(e),t.sheetName=t.FA,mt(e,!1),Ft(e,!0),0))},t}(Ve),Ke=function(e){function t(t,n){return e.call(this,t,n)||this}return nt(t,e),t.prototype.canExecute=function(){var e=this;return e.kj&&e.kj.parent.options.allowUserZoom&&e.kj.zoom()!==e.VQ.zoomFactor},t.prototype.execute=function(){var e,t,n,o=this,r=o.VQ,i=!1;return o.canExecute()&&(t=(e=o.kj)._modelManager,n=r.zoomFactor,t.startTransaction(),i=function(e,t){return!(!0===e.isEditing()&&!e.endEdit()||(e.suspendPaint(),e.zoom(t),e.resumePaint(),0))}(e,n),t.ZVa(["zoomChanged",n,r.oldZoomFactor]),r[F.bWa(e.name())]=e._modelManager.endTransaction()),i},t.prototype.undo=function(){var e,t=this.kj;if(this.canUndo())return!(!0===t.isEditing()&&!t.endEdit()||(t.suspendPaint(),e=F.bWa(t.name()),t._modelManager.undo(this.VQ[e]),t.resumePaint(),0))},t}(Ve),$e=function(e){function t(t,n){return e.call(this,t,n)||this}return nt(t,e),t.prototype.execute=function(){var e,t,n,o,r,i,a,s,l,u,c=this;c.canExecute()&&(e=c.kj,t=c.VQ.clearRange,n=e.tables&&e.tables.$Hb&&e.tables.$Hb(t.row,t.col,t.rowCount,t.colCount),e.isDirtySuspended()||(c.VQ.Iu=new ze(e,e.Tq(t),3)),n&&n.length>0&&(c.VQ.tableNames=n),r=(o=e.Tq(t)).row,i=o.col,a=it(o),(s=at(o))>0&&a>0&&(e._modelManager.startTransaction(),Ot(e),e.vxb=!0,e.cg(r,i,a,s,3,1,!0),Ft(e),e.vxb=!1,l=F.bWa(e.name()),c.VQ[l]=e._modelManager.endTransaction(),u=c.VQ.Iu,F.Bu(e,r,i,a,s,u?u.wy():[],2,n)))},t.prototype.canExecute=function(){var e=this.VQ.clearRange;return this.kj.Y3(e.row,e.col,it(e),at(e))},t.prototype.canUndo=function(){var e=F.bWa(this.kj.name()),t=this.VQ[e];return F.cWa(t)},t.prototype.undo=function(){var e,t,n,o=this,r=o.kj;if(o.canUndo()&&r&&(at(e=r.Tq(o.VQ.clearRange))>0&&it(e)>0)){Ot(r);try{t=F.bWa(r.name()),r._modelManager.undo(o.VQ[t])}finally{Ft(r)}return n=o.VQ.Iu,F.Bu(r,e.row,e.col,it(e),at(e),n?n.wy():[],2,o.VQ.tableNames,!0),!0}return!1},t}(Ve),Xe=function(e){function t(t,n,o){var r,i,a=e.call(this,t,n)||this;if(!o&&(n.MA=[],(r=n.ranges)&&r.length>0))for(i=0;i<r.length;i++)n.MA[i]=new $e(t,{clearRange:r[i]});return a}return nt(t,e),t.prototype.canExecute=function(){var e,t=this.VQ.MA;if(t){for(e=0;e<t.length;e++)if(!t[e].canExecute())return!1;return!0}return!1},t.prototype.execute=function(){var e,t,n,o=this;if(o.canExecute()&&(e=o.VQ.MA,t=o.kj,e)){for(Ot(t,!0),n=0;n<e.length;n++)e[n].execute();return Ft(t,!0),!0}return!1},t.prototype.canUndo=function(){var e,t=this.VQ.MA;if(t){for(e=0;e<t.length;e++)if(!t[e].canUndo())return!1;return!0}return!1},t.prototype.undo=function(){var e,t,n,o,r=this,i=r.VQ.MA;if(r.canUndo()){for(e=r.kj,t=i.length-1;t>=0;t--)if(n=i[t],Ot(e,!0),o=n.undo(),Ft(e,!0),!o)return!1;return!0}return!1},t}(Ve),F.OA=Xe,et=function(e){function t(t,n){return e.call(this,t,n)||this}return nt(t,e),t.qx=function(e){var t=0;return 0!==e&&1!==e||(t|=1),0!==e&&2!==e||(t|=64,t|=32),0!==e&&3!==e||(t|=2),0!==e&&4!==e||(t|=1,t|=64,t|=32),0!==e&&5!==e||(t|=64,t|=32,t|=2),0===e&&(t|=32,t|=16,t|=256,t|=4,t|=512,t|=128,t|=1024),t},t.prototype.canExecute=function(){var e=this.VQ,t=e.pasteExtent,n=t.targetRange,o=t.sourceRange;return e.toSheet.Y3(n.row,n.col,it(n),at(n))&&(!t.isCutting||e.fromSheet.Y3(o.row,o.col,it(o),at(o)))},t.prototype.oUa=function(){var e=this,n=e.VQ.pasteExtent,o=e.VQ.io={},r=n.isCutting,i=t.qx(e.VQ.pasteOption),a=n.sourceRange,s=n.targetRange,l=e.VQ.fromSheet,u=e.VQ.toSheet;l&&a&&r&&!l.isDirtySuspended()&&(o.cA=new ze(l,a,i)),u.isDirtySuspended()||(o.fA=new ze(u,s,i))},t.prototype.VA=function(){return this.VQ.pasteExtent.targetRange},t.prototype._Hb=function(e,t,n,o,r){var i,a=!1,s=t.row,l=t.col,u=t.rowCount,c=t.colCount,h=!1,p=!1,d=!1,g=!1,m=st(r),y=!1,v=!1;if(e||u%n.rowCount!=0||c%n.colCount!=0){if(o===f.InsertShiftCell.right){if(s!==n.row&&n.intersect(s,l,n.rowCount,r.getColumnCount()-l))return r.Os(1,O().Exp_InsertCopiedCutCells),{returnFunc:v=!0};if(l>n.col&&l<=n.col+n.colCount-1&&s>n.row&&s<=n.row+n.rowCount-1)return r.Os(1,O().Exp_InsertCopiedCutCells),{returnFunc:v=!0};if(this.aIb(r,s,l,n.rowCount,r.getColumnCount()-l))return r.Os(1,O().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:v=!0};if((y=this.bIb(r,s,r.getColumnCount()-n.colCount,n.rowCount,n.colCount))&&!m)return r.Os(1,O().Exp_InsertCopiedCutCellsNoRange),{returnFunc:v=!0};s===n.row&&l<=n.col&&(n.col=n.col+n.colCount,h=!0)}else if(o===f.InsertShiftCell.down){if(l!==n.col&&n.intersect(s,l,r.getRowCount()-s,n.colCount))return r.Os(1,O().Exp_InsertCopiedCutCells),{returnFunc:v=!0};if(s>n.row&&s<=n.row+n.rowCount-1&&l>n.col&&l<=n.col+n.colCount-1)return r.Os(1,O().Exp_InsertCopiedCutCells),{returnFunc:v=!0};if(this.cIb(r,s,l,r.getRowCount()-s,n.colCount))return r.Os(1,O().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:v=!0};if((y=this.bIb(r,r.getRowCount()-n.rowCount,l,n.rowCount,n.colCount))&&!m)return r.Os(1,O().Exp_InsertCopiedCutCellsNoRange),{returnFunc:v=!0};l===n.col&&s<=n.row&&(n.row=n.row+n.rowCount,p=!0)}}else if(a=!0,o===f.InsertShiftCell.right){if(i=!1,s<=n.row&&s+u>=n.row+n.rowCount&&(i=!0),l>n.col&&l<=n.col+n.colCount-1&&s>n.row&&s<=n.row+n.rowCount-1)return r.Os(1,O().Exp_InsertCopiedCutCells),{returnFunc:v=!0};if(!i&&n.intersect(s,l,u,r.getColumnCount()-l))return r.Os(1,O().Exp_InsertCopiedCutCells),{returnFunc:v=!0};if(this.aIb(r,s,l,u,r.getColumnCount()-l))return r.Os(1,O().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:v=!0};if((y=this.bIb(r,s,r.getColumnCount()-c,u,c))&&!m)return r.Os(1,O().Exp_InsertCopiedCutCellsNoRange),{returnFunc:v=!0};i&&l<=n.col&&(n.col=n.col+c,d=!0)}else if(o===f.InsertShiftCell.down){if(i=!1,l<=n.col&&l+c>=n.col+n.colCount&&(i=!0),s>n.row&&s<=n.row+n.rowCount-1&&l>n.col&&l<=n.col+n.colCount-1)return r.Os(1,O().Exp_InsertCopiedCutCells),{returnFunc:v=!0};if(!i&&n.intersect(s,l,r.getRowCount()-s,c))return r.Os(1,O().Exp_InsertCopiedCutCells),{returnFunc:v=!0};if(this.cIb(r,s,l,r.getRowCount()-s,c))return r.Os(1,O().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:v=!0};if((y=this.bIb(r,r.getRowCount()-u,l,u,c))&&!m)return r.Os(1,O().Exp_InsertCopiedCutCellsNoRange),{returnFunc:v=!0};i&&s<=n.row&&(n.row=n.row+u,g=!0)}return{changePasteDataRangeCol:h,changePasteDataRangeRow:p,changePasteDataRangeCols:d,changePasteDataRangeRows:g,moveRangeHaveValue:y,returnFunc:v,selectRange:a}},t.prototype.dIb=function(e,t,n,o,r,i,a,s,l){var u,c,h=!1,p=!1;return e?t===f.InsertShiftCell.right?n.Vq(i,a+l,s,n.getColumnCount()-a-l,!0)?a+l<n.getColumnCount()?(n.moveTo(i,a,i,a+l,s,n.getColumnCount()-a-l,1023,!0),(c=(u=n.rowFilter())&&u.range)&&-1===i&&c.colCount>1&&a>c.col&&a<=c.col+c.colCount-1&&(c.colCount=c.colCount+r.colCount)):a+l>n.getColumnCount()&&(h=!0,p=!0):(h=!0,p=!0):t===f.InsertShiftCell.down&&(n.Vq(i+s,a,n.getRowCount()-i-s,l,!0)?i+s<n.getRowCount()?n.moveTo(i,a,i+s,a,n.getRowCount()-i-s,l,1023,!0):i+s>n.getRowCount()&&(h=!0,p=!0):(h=!0,p=!0)):t===f.InsertShiftCell.right?n.Vq(i,a+r.colCount,r.rowCount,n.getColumnCount()-a-r.colCount,!0)?a+r.colCount<n.getColumnCount()?(n.moveTo(i,a,i,a+r.colCount,r.rowCount,n.getColumnCount()-a-r.colCount,1023,!0),(c=(u=n.rowFilter())&&u.range)&&-1===i&&c.colCount>1&&a>c.col&&a<=c.col+c.colCount-1&&(c.colCount=c.colCount+r.colCount)):a+r.colCount>n.getColumnCount()&&(h=!0,p=!0):(h=!0,p=!0):t===f.InsertShiftCell.down&&(n.Vq(i+r.rowCount,a,n.getRowCount()-i-r.rowCount,r.colCount,!0)?i+r.rowCount<n.getRowCount()?n.moveTo(i,a,i+r.rowCount,a,n.getRowCount()-i-r.rowCount,r.colCount,1023,!0):i+r.rowCount>n.getRowCount()&&(h=!0,p=!0):(h=!0,p=!0)),{raiseInvalidOperation:h,returnFunc:p}},t.prototype.ogc=function(e,t,n,o,r,i,a){e&&(t.col=t.col-t.colCount),n&&(t.row=t.row-t.rowCount),o&&(t.col=t.col-i),r&&(t.row=t.row-a)},t.prototype.execute=function(){var e,n,o,r,i,a,s,u,c,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,k,E,D,j,_,P,H,B,L,z,V,G,W,U,Z,q=this;if(q.canExecute()){if(e=q.VQ.fromSheet,n=q.VQ.toSheet,o=q.VQ.pasteExtent,r=q.VQ.pasteOption,i=o.sourceRange,a=o.targetRange,s=o.isCutting,e&&i&&!e.pu(i.row,i.col,it(i),at(i),ot(e),rt(e)))return;if(!(n&&a&&n.l5(a.row,a.col,it(a),at(a),!0)))return;if(n.tables&&n.tables.zxb(e,i,n,a,s))return;if(u=void 0,c=void 0,h=void 0,e&&(h=e.tu(),u=q.WHb,c=q.YHb),p=void 0,d=void 0,g=void 0,m=void 0,y=void 0,q.XHb&&(p=q.XHb.row,d=q.XHb.col,g=q.XHb.rowCount,m=q.XHb.colCount),v=!1,b=!1,C=!1,w=!1,x=st(n),A=!1,u!==R&&c){if((M=this._Hb(s,q.XHb,c,u,n)).returnFunc)return;v=M.changePasteDataRangeCol,b=M.changePasteDataRangeRow,C=M.changePasteDataRangeCols,w=M.changePasteDataRangeRows,A=M.moveRangeHaveValue,y=M.selectRange}q.oUa(),S=n.parent.sheets,F.Zxb(S),ft(n),pt(n),n.vxb=!0,T=!1,e&&(pt(e),e.vxb=!0);try{if(x&&(N=-1,I=-1,-1!==a.row?N=a.row+it(a):-1===i.row&&(N=ot(e)),E=N-(k=ot(n)),N>k&&q.vTa(i,a)?u===f.InsertShiftCell.down&&A?n.addRows(k,E+(k-p)):n.addRows(k,E):A||p+a.rowCount!==ot(n)||u!==f.InsertShiftCell.down?A&&u===f.InsertShiftCell.down&&n.addRows(k,E+(k-p)):n.addRows(k,E+(k-p)-c.rowCount),-1!==a.col?I=a.col+at(a):-1===i.col&&(I=rt(e)),I>rt(n)&&q.vTa(i,a)?u===f.InsertShiftCell.right&&A?n.setColumnCount(I+n.getColumnCount()-d):n.setColumnCount(I):A||d+a.colCount!==rt(n)||u!==f.InsertShiftCell.right?A&&u===f.InsertShiftCell.right&&n.setColumnCount(I+n.getColumnCount()-d):n.setColumnCount(I+n.getColumnCount()-d-c.colCount)),T=(D=u!==R&&this.dIb(y,u,n,q.XHb,c,p,d,g,m)).raiseInvalidOperation,D.returnFunc)return;i&&l.mn.qn(e,i.row,i.col,i.row+it(i)-1,i.col+at(i)-1);try{if(j=!1,e)for(_=i.row;_<i.row+i.rowCount&&!j;_++)for(P=i.col;P<i.col+i.colCount;P++)if(e.getValue(_,P)){j=!0;break}n.tables&&(j||o.clipboardText.replace(/[\r\n\t]/gi,""))&&n.tables.fIb(a,i)}catch(e){return n.Os(6,e.message),void n.resumePaint()}n.px(e,i,n,a,o.isCutting,o.clipboardText,o.clipboardHtml,o.clipboardImage,r,!o.includeFilteredOutRow)}finally{i&&l.mn.Nm(),dt(n),n.vxb=!1,e&&(dt(e),e.vxb=!1),ht(n),F.$xb(S,q.VQ),H=q.VQ.io,B=t.qx(r),o.isCutting&&e&&(L=[],e.isDirtySuspended()||((z=new ze(e,i,B)).uy(H.cA.sy()),H._z=z,L=z.wy()),F.Bu(e,i.row,i.col,it(i),at(i),L,3)),n&&(V=[],n.isDirtySuspended()||((G=new ze(n,a,B)).uy(H.fA.sy()),H.dA=G,V=G.wy()),W=n.tables&&n.tables.$Hb&&n.tables.$Hb(a.row,a.col,a.rowCount,a.colCount),U=it(a),Z=at(a),F.Bu(n,a.row,a.col,U,Z,V,3,W),q.tableNamesObj={r:a.row,c:a.col,rc:U,cc:Z,tableNames:W}),q.pgc={changePasteDataRangeCol:v,changePasteDataRangeRow:b,changePasteDataRangeCols:C,changePasteDataRangeRows:w,acColCount:m,acRowCount:g},h&&delete h.UHb,T&&n.Os(1,O().Exp_InsertCopiedCutCellsNoRange)}}},t.prototype.aIb=function(e,t,n,o,r){var i,a,s,l=e._modelManager.getSpans(),u=e.tables.l$;for(i=0;i<l.length;i++)if(!(t<=(a=l[i]).row&&n<=a.col&&t+o>=a.row+a.rowCount&&n+r>=a.col+a.colCount||a.row>t+o||a.row+a.rowCount-1<t||a.row>t+o-1||a.row+a.rowCount-1<t||a.col+a.colCount-1<n))return!0;for(i=0;i<u.length;i++)if(!(t<=(s=u[i]).cj&&n<=s.dj&&t+o>=s.cj+s.Xj&&n+r>=s.dj+s.OZ||s.cj>t+o||s.cj+s.Xj-1<t||s.cj>t+o-1||s.cj+s.Xj-1<t||s.dj+s.OZ-1<n))return!0;return!1},t.prototype.cIb=function(e,t,n,o,r){var i,a,s,l=e._modelManager.getSpans(),u=e.tables.l$;for(i=0;i<l.length;i++)if(!(t<=(a=l[i]).row&&n<=a.col&&t+o>=a.row+a.rowCount&&n+r>=a.col+a.colCount||a.col>n+r||a.col+a.colCount-1<n||a.col>n+r-1||a.col+a.colCount-1<n||a.row+a.rowCount-1<t))return!0;for(i=0;i<u.length;i++)if(!(t<=(s=u[i]).cj&&n<=s.dj&&t+o>=s.cj+s.Xj&&n+r>=s.dj+s.OZ||s.dj>n+r||s.dj+s.OZ-1<n||s.dj>n+r-1||s.dj+s.OZ-1<n||s.cj+s.Xj-1<t))return!0;return!1},t.prototype.bIb=function(e,t,n,o,r){var i,a,s,l,u,c,f,h=e._modelManager.getSpans(),p=e.tables.l$;for(i=t;i<t+o;i++)for(a=n;a<n+r;a++){if(s=e.getCell(i,a),!m(s.value())||s.backColor()||s.comment()||s.tag())return!0;for(l=0;l<h.length;l++)if(i>=(u=h[l]).row&&i<=u.row+u.rowCount-1&&a>=u.col&&a<=u.col+u.colCount-1)return!0;for(c=0;c<p.length;c++)if(i>=(f=p[c]).cj&&i<=f.cj+f.Xj-1&&a>=f.dj&&a<=f.dj+f.OZ-1)return!0}return!1},t.prototype.vTa=function(e,t){var n,o,r,i;return!e||(n=e.row,o=e.col,r=t.row,i=t.col,-1!==n&&-1!==o||-1===n&&-1!==o&&r<=0||-1===o&&-1!==n&&i<=0||-1===n&&-1===o&&r<=0&&i<=0)},t.prototype.undo=function(){var e,t,n,o,r,i,a,s,l,u,c,f,h,p,d,g,m,v,b,C,w,x,A,M=this;if(M.canUndo()){if(e=M.VQ.fromSheet,t=M.VQ.toSheet,o=(n=M.VQ.pasteExtent).sourceRange,r=n.targetRange,!t||!r)return!1;if(M.pgc&&(i=M.pgc,this.ogc(i.changePasteDataRangeCol,o,i.changePasteDataRangeRow,i.changePasteDataRangeCols,i.changePasteDataRangeRows,i.acColCount,i.acRowCount)),!t.pu(r.row,r.col,it(r),at(r),ot(t),rt(t)))return!1;if(e&&o){if(!e.pu(o.row,o.col,it(o),at(o),ot(e),rt(e)))return!1;if(e&&e.name()===t.name()&&t.parent&&!y(t.parent.sheets,e))return!1}a=M.VQ.io,ft(t);try{s=r.row<0?0:r.row,l=r.col<0?0:r.col,u=r.row<0?ot(t):it(r),c=r.col<0?rt(t):at(r),f=t.parent.sheets,F._xb(f,M.VQ),(p=(h=t.rowFilter())&&h.range)&&-1===r.row&&p.col<r.col&&p.col+p.colCount>=r.col+r.colCount&&(p.colCount=p.colCount-r.colCount),d=0,g=0,m=0,v=0,e&&o&&(d=o.row<0?0:o.row,g=o.col<0?0:o.col,m=o.row<0?ot(e):it(o),v=o.col<0?rt(e):at(o)),b=[],C=[],(w=M.tableNamesObj)&&(t&&w.r===s&&w.c===l&&w.rc===u&&w.cc===c&&(C=w.tableNames),e&&w.r===d&&w.c===g&&w.rc===m&&w.cc===v&&(b=w.tableNames)),t&&(x=a.dA,F.Bu(t,s,l,u,c,x?x.wy():[],3,b,!0)),e&&(A=a._z,F.Bu(e,d,g,m,v,A?A.wy():[],3,C,!0))}finally{ht(t)}}return!0},t}(Ve),tt=function(e){function t(t,n,o){var r,i,a,s,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R=e.call(this,t,n)||this;if(!o){if(r=t,i=n.fromSheet,!r)throw Error(O().Exp_DestSheetIsNull);if((s=(a=n).pastedRanges)&&s.length>0)if(n.MA=[],c=(u=a.fromRanges||[a.fromRange]).length,f=a.isCutting,h=a.clipboardText,p=a.clipboardHtml,d=a.clipboardImage,g=a.pasteOption,m={},y=s[0],!f&&i&&i.r5(u,m)&&y.equals(i.q5(u,y))){for(b=m.inSameCol,(v=m.inSameRow)?u.sort((function(e,t){return e.col-t.col})):b&&u.sort((function(e,t){return e.row-t.row})),C=y.row,w=y.col,x=0;x<c;x++)M=(A=u[x]).rowCount,S=A.colCount,T={sourceRange:A,targetRange:l.kf(C,w,M,S),isCutting:f,clipboardText:h,clipboardHtml:p,clipboardImage:d,includeFilteredOutRow:!0},n.MA[x]=new et(t,{fromSheet:i,toSheet:r,pasteExtent:T,pasteOption:g}),v?w+=S:b&&(C+=M);n.s5=!0}else for(N=0;N<s.length;N++)I={sourceRange:u[0],targetRange:s[N],isCutting:f,clipboardText:h,clipboardHtml:p,clipboardImage:d},n.MA[N]=new et(t,{fromSheet:i,toSheet:r,pasteExtent:I,pasteOption:g})}return R}return nt(t,e),t.prototype.execute=function(){var e,t,n,o,r,i,a,s,u=this,c=u.VQ,f=c.MA,h=!1;if(u.canExecute()&&f){Ot(t=(e=u.kj).parent.getActiveSheet(),!0);try{for(n=!1,o=0;o<f.length;o++)(r=f[o]).WHb=c.WHb,r.XHb=c.XHb,r.YHb=c.YHb,e?(i=r.VQ.pasteExtent,a={sheet:e,sheetName:e.name(),cellRange:r.VA(),pasteOption:r.VQ.pasteOption,pasteData:{text:i.clipboardText,html:i.clipboardHtml},shiftCells:c.WHb,cancel:!1},(s=i.clipboardImage)&&(a.pasteData.image=s),e.Wq(l.Events.ClipboardPasting,a),a.cancel||(h=r.execute(),delete a.cancel,n=!0,e.Wq(l.Events.ClipboardPasted,a))):h=r.execute();n&&u.WA()}finally{Ft(t,!0)}}return h},t.prototype.WA=function(){var e,t,n,o,r,i=this.VQ,a=i.MA,s=this.kj;if(s&&a){if(e=s.getSelections(),s.Tr(),i.s5)t=i.pastedRanges[0],s.addSelection(t.row,t.col,it(t),at(t));else if(a.length>1)for(n=0;n<a.length;n++)o=a[n].VA(),s.addSelection(o.row,o.col,it(o),at(o));else a.length>0&&(r=a[0].VA(),s.addSelection(r.row,r.col,it(r),at(r)),r.contains(s.Jl,s.Kl)||s.Jr(r.row,r.col));s.yu(e,s.getSelections())&&s.Au(e)}},t.prototype.canExecute=function(){var e,t=this.VQ.MA;if(t){for(e=0;e<t.length;e++)if(!t[e].canExecute())return!1;return!0}return!1},t.prototype.canUndo=function(){var e,t=this.VQ.MA;if(t){for(e=0;e<t.length;e++)if(!t[e].canUndo())return!1;return!0}return!1},t.prototype.undo=function(){var e,t,n,o,r=this,i=r.VQ.MA;if(r.canUndo()&&i){e=!0,Ot(t=r.kj.parent.getActiveSheet(),!0);try{for(n=i.length-1;n>=0;n--)o=i[n],e=e&&o.undo()}finally{Ft(t,!0)}return e}return!1},t}(Ve)},"./dist/core/worksheet/worksheet-border.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function S(e,t,n,o,r,s,l){switch(s!==i&&s!==a||(s=1),s){case 1:return new y(e,t,n,o,r,1,l);case 2:return new y(e,t,n,o,r,2,l);case 5:return new y(e,t,n,o,r,3,l);case 3:return new v(e,t,n,o,r,1,[3,1],l);case 9:return new v(e,t,n,o,r,1,[8,2,2,2],l);case 4:return new v(e,t,n,o,r,1,[2,2],l);case 11:return new v(e,t,n,o,r,1,[9,3,3,3,3,3],l);case 13:return new b(e,t,n,o,r,e!==n,[11,1,5,1],[10,2,4,2],l);case 10:return new v(e,t,n,o,r,2,[9,3,3,3],l);case 12:return new v(e,t,n,o,r,2,[9,3,3,3,3,3],l);case 8:return new v(e,t,n,o,r,2,[9,3],l);case 7:return new v(e,t,n,o,r,1,[1],l);case 6:return new w(e,t,n,o,r,l)}return a}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/worksheet/style.js"),r=n("./dist/core/util/domUtil.js"),i=void 0,a=null,s=Math.sqrt,l=Math.pow,u=Math.min,c=Math.abs,f=Math.tan,Math.floor,h=Math.PI,r.GC$.inherit,p=r.GC$.isEmptyObject,d={LEFT_TOP:0,RIGHT_TOP:1,RIGHT_BOTTOM:2,LEFT_BOTTOM:3},g={H_TOP_LEFT:0,H_TOP_Right:1,V_RIGHT_TOP:2,V_RIGHT_BOTTOM:3,H_BOTTOM_RIGHT:4,H_BOTTOM_LEFT:5,V_LEFT_BOTTOM:6,V_LEFT_TOP:7},m=function(){function e(){}return e.prototype.mE=function(e){var t=this;0===e._orientation?(e.nE&&(t.oE+=e.nE),e.pE&&(t.qE+=e.pE)):(e.nE&&(t.rE+=e.nE),e.pE&&(t.sE+=e.pE))},e.prototype.jp=function(e){var t=this.tE||"#9eb6ce",n=this.uE,o=e.lineWidth,r=e.strokeStyle;o===n&&r===t||(o!==n&&(e.lineWidth=n),r!==t&&(e.strokeStyle=t)),this.hWa(e)},e.prototype.hWa=function(e){var t,n,o=this;o.qE===o.oE||o.sE===o.rE?(e.beginPath(),o.vE(e),e.stroke()):(e.save(),t=Math.min(o.qE,o.oE),n=Math.min(o.sE,o.rE),e.rect(t,n,Math.abs(o.oE-o.qE),Math.abs(o.rE-o.sE)),e.clip(),e.beginPath(),o.vE(e),e.stroke(),e.beginPath(),e.restore())},e.prototype.vE=function(e){var t=this;e.moveTo(t.qE,t.sE),e.lineTo(t.oE,t.rE)},e}(),y=function(e){function t(t,n,o,r,i,a,s){var l,u=e.call(this)||this;return a%2||(t!==o?(n-=.5,r-=.5):(t-=.5,o-=.5)),(l=u).qE=t,l.sE=n,l.oE=o,l.rE=r,l.tE=i,l.uE=a,l.gIb=s,u}return M(t,e),t}(m),v=function(e){function t(t,n,o,r,i,a,s,l){var u,c=e.call(this)||this;return a%2||(t!==o?(n-=.5,r-=.5):(t-=.5,o-=.5)),(u=c).qE=t,u.sE=n,u.oE=o,u.rE=r,u.tE=i,u.uE=a,u.wE=s,u.gIb=l,c}return M(t,e),t.prototype.vE=function(e){var n=this;t._render(e,n.qE,n.sE,n.oE,n.rE,n.wE)},t._render=function(e,t,n,o,r,i){var a,c,f=s(l(o-t,2)+l(r-n,2)),h=(o-t)/f,p=(r-n)/f,d=0,g=0;for(i=i&&i.length?i:[4,4];d<f;)d+=a=u(i[g%i.length],f-d),(c=++g%2)&&e.moveTo(t,n),t+=a*h,n+=a*p,c&&e.lineTo(t,n)},t}(m),b=function(e){function t(t,n,o,r,i,a,s,l,u){var c,f=e.call(this)||this;return a?(t-=1,o-=1):(n-=1,r-=1),(c=f).qE=t,c.sE=n,c.oE=o,c.rE=r,c.tE=i,c.xE=a,c.uE=1,c.yE=s,c.zE=l,c.gIb=u,f}return M(t,e),t.prototype.vE=function(e){var t=this,n=t.xE?0:1,o=t.xE?1:0;v._render(e,t.qE-n,t.sE-o,t.oE-n,t.rE-o,t.yE),v._render(e,t.qE,t.sE,t.oE,t.rE,t.zE)},t}(m),C=function(e){function t(t,n,o,r,i,a,s){var l=e.call(this)||this,u=l;return u.qE=t,u.sE=n,u.oE=o,u.rE=r,u.tE=i,u.iWa=a,u.gIb=s,u.AE=new y(u.qE,u.sE,u.oE,u.rE,i,1,s),u.BE=null,l}return M(t,e),t.prototype.hWa=function(e){this.AE&&this.AE.hWa(e),this.BE&&this.BE.hWa(e)},t.prototype.mE=function(e){var t=this;t.BE?(e.pE&&t.AE&&t.AE.mE(e),e.nE&&t.BE.mE(e)):t.AE&&t.AE.mE(e)},t.prototype.jWa=function(e){var t,n,o,r,i,a,s,l,u=this;e&&e.severX&&e.severY?(t=e.severX||0,n=e.severY||0,t=u.iWa?t:-t,i=(o=parseInt(u.qE+(u.oE-u.qE)/2,10))-t,a=(r=parseInt(u.sE+(u.rE-u.sE)/2,10))-n,s=o+t,l=r+n,u.AE=new y(u.qE,u.sE,i,a,u.tE,1,u.gIb),u.BE=new y(s,l,u.oE,u.rE,u.tE,1,u.gIb)):(u.AE=new y(u.qE,u.sE,u.oE,u.rE,u.tE,1,u.gIb),u.BE=null)},t}(m),w=function(e){function t(t,n,o,r,i,a){var s=e.call(this)||this,l=s,u=0,c=0;return t===o&&(u=1),n===r&&(c=1),t!==o&&n!==r?a?(u=2,l.AE=new y(t-u,n,o-u,r,i,1,a),l.BE=new y(t+u,n,o+u,r,i,1,a)):(u=2,c=2,t>o?(l.AE=new C(t-u,n,o,r-c,i,!1,a),l.BE=new C(t,n+c,o+u,r,i,!1,a)):(l.AE=new C(t,n+c,o-u,r,i,!0,a),l.BE=new C(t+u,n,o,r-c,i,!0,a))):(l.AE=new y(t-u,n-c,o-u,r-c,i,1,a),l.BE=new y(t+u,n+c,o+u,r+c,i,1,a)),l.gIb=a,l.tE=i,l.uE=1,s}return M(t,e),t.prototype.hWa=function(e){this.AE.hWa(e),this.BE.hWa(e)},t.prototype.mE=function(e){var t=this;e.CE?1===e.CE?t.AE.mE(e):2===e.CE&&t.BE.mE(e):(t.AE.mE(e),t.BE.mE(e))},t.prototype.jWa=function(){var e={severX:1,severY:1},t=this.AE,n=this.BE;t.jWa(e),n.jWa(e)},t}(m),t.zF=S,x=function(){function e(){}return e.DE=function(t,n,o){var r,i;return t?n?0!==(i=(r=e.EE)[t.style]-r[n.style])||o?i:n.level-t.level:1:n?-1:0},e.FE=function(e){if(e){if(e.isGridLine)return 1;if(e.style)return o.LineBorder.Vo(e.style)}return 0},e.GE=function(e){return e&&6===e.style},e.HE=function(e){return e&&13===e.style},e.IE=function(t,n){return t?n?e.DE(t.style,n.style)>=0?t:n:t:n},e.JE=function(e,t){e&&e.line&&e.line.mE(t)},e.KE=function(t,n,o){return t===n?0:t?n?t.isGridLine?n.isGridLine?0:-1:n.isGridLine?1:e.DE(t.style,n.style,o):1:-1},e.LE=function(e){return e&&e.style&&6===e.style.style},e.ME=function(e,t,n,o){if(e.style&&6===e.style.style)return!0;var r=0;return r+=t&&t.style&&6===t.style.style?1:0,r+=n&&n.style&&6===n.style.style?1:0,(r+=o&&o.style&&6===o.style.style?1:0)<2},e.NE=function(e,t,n,o,r,i){var a={_orientation:i?1:0,pE:0,nE:0},s=this.KE(e,n),l=this.KE(e,o);s>=0&&l>=0?0===s&&0===l?-1!==r&&1===r&&(a.nE-=r):-1===r?a.pE-=r:1===r&&(a.nE-=2*r):l>=0?(a.CE=2,a.pE+=r):s>=0&&(a.CE=1,a.pE+=r),this.JE(e,a)},e.OE=function(t,n,o,r,i,a,s,l,u){var c,f,h,p,d,g,m,y,v={_orientation:l?1:0,CE:u?2:1,pE:0,nE:0},b={_orientation:l?1:0,CE:u?1:2,pE:0,nE:0},C=1===a?r:i,w=1===s?o:n;this.LE(w)?0===(c=this.KE(t,C))?0===(f=this.KE(t,w))?1===s&&(b.nE-=s):f>0&&(-1===s?b.pE-=2*s:1===s&&(b.nE-=2*s)):c>0?0===(h=this.KE(t,w))?1===s&&(b.nE-=s):h>0&&(-1===s?b.pE-=2*s:1===s&&(b.nE-=2*s)):0===(p=this.KE(t,w))?-1===s?v.pE+=2*s:1===s&&(v.nE+=2*s):p>0&&(-1===s?v.pE-=3*s:1===s&&(v.nE-=3*s)):this.KE(t,C)>=0?-1===s?b.pE-=2*s:1===s&&(b.nE-=2*s):-1===s?v.pE+=2*s:1===s&&(v.nE+=2*s),d=1===(1===a?2:1)?r:i,g=!1,m=0,this.LE(d)&&this.KE(d,t)>0&&(g=!0,y=e.FE(d),this.KE(d,C)>0?y>0&&(m=1===s&&this.LE(o)?y>=2?2:1:-1===s&&this.LE(n)?y>=3?2:1:3===y?3:2):m=3===y?3:2),g||this.LE(w)||!(w&&!w.isGridLine||d&&!d.isGridLine)||(g=!0,m=-1===s?2:1),g&&(-1===s?(v.pE+=s*m,b.pE+=s*m):1===s&&(v.nE+=s*m,b.nE+=s*m)),(v.pE||v.nE)&&this.JE(t,v),(b.pE||b.nE)&&this.JE(t,b)},e.PE=function(e,t,n,o,r,i){if(this.KE(e,n)>=0&&this.KE(e,o)>=0){var a={_orientation:i?1:0,pE:0,nE:0};-1===r?(a.pE-=2*r,this.LE(e)&&this.KE(t,e)>0&&(a.pE-=1)):1===r&&(a.nE-=2*r,this.LE(e)&&this.KE(t,e)>0&&(a.nE+=1)),this.JE(e,a)}},e.QE=function(t,n,o,r,i,a){var s,l,u;this.LE(t)&&((s=this.IE(o,r))&&!s.isGridLine&&((l=e.FE(s))>0&&(u={_orientation:a?1:0,pE:0,nE:0},-1===i?u.pE+=l*i:u.nE+=l*i,(u.pE||u.nE)&&this.JE(t,u))))},e.RE=function(t,n,o,r,i,a,s){var l,u,c,f,h=e;(n||o||r)&&(c=h.IE(o,r),h.ME(t,n,o,r)?(u=h.KE(c,t,!0))>0?(l=h.FE(c),h.LE(t)&&(h.LE(o)||h.LE(r)||h.LE(n))||3===l&&h.JE(t,{_orientation:0,pE:1})):c&&u<0?(u=h.KE(t,n,!0))>0?3===(l=h.FE(c))||2===l?h.JE(t,{_orientation:0,pE:-2}):1===l&&h.JE(t,{_orientation:0,pE:-1}):0!==u&&h.KE(n,c,!0)>0&&(3===(l=h.FE(c))&&h.JE(t,{_orientation:0,pE:1})):0===u&&(!n||h.KE(t,n,!0)>0)&&(3===(l=h.FE(c))||2===l?h.JE(t,{_orientation:0,pE:-2}):1===l&&h.JE(t,{_orientation:0,pE:-1})):h.JE(t,{_orientation:0,pE:1})),(i||a||s)&&(f=h.IE(a,s),h.ME(t,i,a,s)?(u=h.KE(f,t,!0))>0?(l=h.FE(f),h.LE(t)&&(h.LE(a)||h.LE(s)||h.LE(i))||(3===l?h.JE(t,{_orientation:0,nE:-2}):2!==l&&1!==l||h.JE(t,{_orientation:0,nE:-1}))):u<=0&&((u=h.KE(t,i,!0))>0?3===(l=h.FE(f))&&h.JE(t,{_orientation:0,nE:1}):0!==u&&h.JE(t,{_orientation:0,nE:-1})):h.JE(t,{_orientation:0,nE:-2}))},e.SE=function(t,n,o,r,i,s,l){var u,c,f,h,p=e;(n||o||r)&&(f=p.IE(o,r),c=p.KE(f,t,!0),p.ME(t,n,o,r)?c>0?(u=p.FE(f),p.LE(t)&&(p.LE(o)||p.LE(r)||p.LE(n))||3===u&&p.JE(t,{_orientation:1,pE:1})):c<0?(c=p.KE(t,n,!0))>0?3===(u=p.FE(f))||2===u?p.JE(t,{_orientation:1,pE:-2}):1===u&&p.JE(t,{_orientation:1,pE:-1}):0!==c&&p.KE(n,f,!0)>0&&(3===(u=p.FE(f))&&p.JE(t,{_orientation:1,pE:1})):0===c&&p.KE(t,n,!0)>0&&(3===(u=p.FE(f))||2===u?p.JE(t,{_orientation:1,pE:-2}):1===u&&p.JE(t,{_orientation:1,pE:-1})):p.JE(t,{_orientation:1,pE:1})),(i||s||l)&&(h=p.IE(s,l),c=p.KE(t,h,!0),p.ME(t,i,s,l)?c<0?(u=p.FE(h),p.LE(t)&&(p.LE(s)||p.LE(l)||p.LE(i))||(3===u||2===u?p.JE(t,{_orientation:1,nE:-2}):1===u&&p.JE(t,{_orientation:1,nE:-1}))):h!==a&&c>=0&&((c=p.KE(t,i,!0))>0?3===(u=p.FE(h))&&p.JE(t,{_orientation:1,nE:1}):0!==c&&p.JE(t,{_orientation:1,nE:-1})):p.JE(t,{_orientation:1,nE:-2}))},e.TE=function(t,n,o,r,i,a,s,l){var u,c,f,h,p=e;l?this.SE(t,n,o,r,i,a,s):this.RE(t,n,o,r,i,a,s),u=p.LE(o),c=p.LE(r),f=p.LE(n),u&&c&&f?p.NE(t,n,o,r,-1,l):u&&!c?p.OE(t,n,i,o,r,1,-1,l,!0):!u&&c?p.OE(t,n,i,o,r,2,-1,l,!1):u&&c&&!f?p.PE(t,n,o,r,-1,l):f&&p.QE(t,n,o,r,-1,l),u=p.LE(a),c=p.LE(s),h=p.LE(i),u&&c&&h?p.NE(t,i,a,s,1,l):u&&!c?p.OE(t,n,i,a,s,1,1,l,!0):!u&&c?p.OE(t,n,i,a,s,2,1,l,!1):u&&c&&!h?p.PE(t,i,a,s,1,l):h&&p.QE(t,i,a,s,1,l)},e.EE=[0,101,199,100,100,300,90,100,198,100,198,100,198,198],e.kWa=function(e,t){return!(!e||!t||e.color!==t.color||e.level!==t.level||e.style!==t.style)},e}(),A=function(){function e(e,t,n,o){var r=this;r.UE=!1,r.VE=!1,r.kj=e,r.Wz=o,r.hIb=t,r.pJ=n}return e.prototype.YE=function(){var e,t,n,o,r,i,a,s,l,u,c=this;if(c.ZE=[],c.$E=[],c._E=[],c.aF=[],c.bF=[],c.cF={},c.dF={},c.eF={},c.fF={},c.lWa={},c.mWa={},c.C$a={},e=c.hIb,t=c.pJ,e&&e.length>0&&t&&t.length>0){for(n=c.$E,o=e.length,r=void 0,i=0;i<o;i++)(r=e[i]).height>0&&n.push(r.row);for(n.push(n[n.length-1]+1),a=c._E,s=t.length,l=void 0,u=0;u<s;u++)(l=t[u]).width>0&&a.push(l.col);a.push(a[a.length-1]+1)}c.UE=!0},e.prototype.gF=function(e,t,n,o,r,i,a,s){if(n){var l={cj:e,dj:t,hF:n.startColumn,iF:n.endColumn,Wqa:o,XHa:r,YHa:i,Vo:a,_v:s};this.aF.push(l)}},e.prototype.jF=function(e,t,n,o,r,i,a,s,l,u,c){var f,h,p,d,g,m,y,v,b,C,w=this;w.UE||w.YE(),s?w.ZE.push(s):(f=void 0,h=void 0,p=void 0,d=void 0,g=void 0,m=void 0,y=void 0,v=void 0,b=void 0,C=void 0,a&&(f=a.borderLeft,h=a.borderTop,p=a.borderRight,d=a.borderBottom,C=a.backColor,g=a.diagonalDown,m=a.diagonalUp,y=a.textOrientation,v=a.isVerticalText,b=a.textIndent),!C||f||p||h||d||w.bF.push({r:e,c:t,rc:1,cc:1}),w.kF(e,t,n,o,r,i,f,h,p,d,g,m,C,!1,!1,l,u,y,v,b&&0!==b,c))},e.prototype.kF=function(e,t,n,o,r,a,s,l,u,p,d,g,m,y,v,b,C,w,x,A,M){var S,T,N,I,R,k,E=this,D=!1,j=!1,_=!1,O=!1,F=w!==i&&w&&-90<=w&&w<=90,P=n;F&&(s||l||u||p)&&!x&&!A&&M&&(S=c(w*h/180),T=f(S),N=Math.floor(a/T),w>-90&&w<0&&(P=n-N),w>0&&w<90&&(P=n+N)),d&&!F&&E.lF(e,t,n-1,o-1,n+r,o+a,d,E.lWa),g&&!F&&E.lF(e,t,n+r,o-1,n-1,o+a,g,E.mWa),l&&a>0&&(D=E.lF(e,t,P,o-.5,P+r,o-.5,l,E.eF,F)),s&&r>0&&(j=E.lF(e,t,P-.5,o,n-.5,o+a,s,E.fF,F)),u&&r>0&&(O=E.lF(e,t+1,P+r-.5,o,n+r-.5,o+a,u,E.fF,F)),p&&a>0&&(_=E.lF(e+1,t,n,o+a-.5,n+r,o+a-.5,p,E.eF,F)),I=E.kj,m&&0!==I.ss.Sl(e)&&0!==I.ss._m(t)||(k=!O&&!v,((R=!_&&!y)||k||!D&&!y||!j&&!v)&&E.mF(e,t,n,o,r,a,R,k,b,C)),!D&&!m||F||E.nF(e-1,t,E.cF),(j||m)&&E.nF(e,t-1,E.dF),!m||s||u||l||p||(E.oF(e-1,t-1,E.dF,!1),E.oF(e-1,t-1,E.cF,!0))},e.prototype.lF=function(e,t,n,o,r,i,s,l,u){if(s){var c=this.pF(e,t,l,!0);return c?(u||6!==c.style.style&&(6===s.style||x.DE(s,c.style)>0))&&(c.line=S(n,o,r,i,s.color,s.style,u),c.style=s):((c=this.pF(e,t,l)).line=S(n,o,r,i,s.color,s.style,u),c.style=s),c.line!==a}return!1},e.prototype.mF=function(e,t,n,o,r,i,a,s,l,u){var c,f,h,p,d,g=this,m=3===g.Wz,y=g.kj.options.gridline;m&&y&&(c=y.color,y.showHorizontalGridline&&(a&&((f=g.pF(e,t,g.cF)).isGridLine=!0,f.line=S(n,o+i-.5,n+r,o+i-.5,c)),l&&((h=g.pF(-1,t,g.cF,!1,!0)).isGridLine=!0,h.line=S(n,o-.5,n+r,o-.5,c))),y.showVerticalGridline&&(s&&((p=g.pF(e,t,g.dF)).isGridLine=!0,p.line=S(n+r-.5,o,n+r-.5,o+i,c)),u&&((d=g.pF(e,-1,g.dF,!1,!0)).isGridLine=!0,d.line=S(n-.5,o,n-.5,o+i,c))))},e.prototype.oF=function(e,t,n,o){var r,i=this.pF(e,t,n,!0);i&&((r=i).line&&r.line.mE({_orientation:o?0:1,nE:-1}))},e.prototype.nF=function(e,t,n){var o;(e>=0&&t>=0||0===e&&-1===t||-1===e&&0===t)&&((o=n[e])&&(o[t]&&delete o[t]))},e.prototype.pF=function(e,t,n,o,r){var i,s;if(!r&&(-1===e||-1===t))return a;if(!(i=n[e])){if(o)return a;n[e]=i={}}if(!(s=i[t])){if(o)return a;i[t]=s={}}return s},e.prototype.qF=function(){var e,t,n,o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,T,N,I=this,R=I.aF,k=R.length,E=I.fF,D=I.eF,j=I.dF,_=I.cF;for(e=0;e<k;e++)if(n=(t=R[e]).cj,o=t.dj,r=t.hF,i=t.Wqa,a=t.iF,void 0,s=t.XHa,l=t.Vo,u=t._v,c=s,f=void 0,h=i.textOrientation,p=i.borderTop,!(d=R[e-1])||d.cj!==n||d.hF!==r||d.iF!==a){for(g=r;g<a;g++)I.pF(n,g+1,E,!0)&&!h?I.nF(n,g+1,E):I.pF(n,g,j,!0)&&I.nF(n,g,j);if(m=I.pF(n,o,D,!0),h&&p&&!m)for(void 0,y=u/Math.tan(Math.abs(h*Math.PI/180)),h>-90&&h<0&&(c=s-y),h>0&&h<90&&(c=s+y),f=c+l,v=r;v<a+1;v++)if(C=(b=I.pF(n-1,v,_,!0))&&b.line)for(b.splitLines||(b.splitLines=[],b.splitLines.push(C)),w=0;w<b.splitLines.length;w++)if(A=(x=b.splitLines[w]).qE,M=x.oE,T=x.sE,N=x.rE,c>A&&f>M&&M>c)x.oE=c;else if(c<A&&f>M)I.nF(n-1,v,I.cF);else if(c<A&&f<M&&A<f)x.qE=f;else if(c>A&&f<M){b.splitLines.splice(w,1,S(A,T,c,T,x.color),S(f,N,M,N,x.color));break}}},e.prototype.rF=function(){var e,t,n=this.ZE,o=n.length;if(o>0)for(t=0;t<o;t++)e=n[t],this.sF(e)},e.prototype.D$a=function(){var e,t,n,o,r,i,a,s;if(this.C$a={},(t=(e=this.ZE).length)>0)for(o=0;o<t;o++)for(n=e[o],r=0;r<n.rowCount;r++)for(i=r+n.row,this.C$a[i]=this.C$a[i]||{},a=0;a<n.colCount;a++)s=a+n.col,this.C$a[i][s]=n},e.prototype.sF=function(e){var t,n,o,r,i,s,l,u,c,f,h,p,d,g,m,y,v=this,b=e.row,C=e.col,w=e.x,A=e.y,M=e.spanSizeInfo,S=M.styleList[0][0],T=S?S.backColor:a,N=w,I=A,R=null,k=!0,E=null,D=!0;if(1===e.rowCount){for(s=b,u=M.rowSizes[0],i=0;i<e.colCount;i++)f=0===i,p=i===e.colCount-1,l=C+i,c=M.colSizes[i],g=M.styleList[0][i],s===e.row&&l===e.col&&(R=(m=g)&&m.diagonalDown,E=m&&m.diagonalUp),g?(t=g.borderLeft,n=g.borderTop,o=g.borderRight,r=g.borderBottom,k&&(k=x.kWa(R,g.diagonalDown)),D&&(D=x.kWa(E,g.diagonalUp))):t=n=o=r=a,f?v.kF(s,l,N,I,c,u,t,n,a,r,a,a,T,!1,!0):p?v.kF(s,l,N,I,c,u,a,n,o,r,a,a,T,!1,!1):v.kF(s,l,N,I,c,u,a,n,a,r,a,a,T,!1,!0),N+=c;R=k?R:null,E=D?E:null,v.kF(e.row,e.col,e.x,e.y,e.width,e.height,a,a,a,a,R,E,a,!0,!0)}else if(1===e.colCount){for(l=C,c=M.colSizes[0],i=0;i<e.rowCount;i++)h=0===i,d=i===e.rowCount-1,s=b+i,u=M.rowSizes[i],g=M.styleList[i][0],s===e.row&&l===e.col&&(R=(m=g)&&m.diagonalDown,E=m&&m.diagonalUp),g?(t=g.borderLeft,n=g.borderTop,o=g.borderRight,r=g.borderBottom,k&&(k=x.kWa(R,g.diagonalDown)),D&&(D=x.kWa(E,g.diagonalUp))):t=n=o=r=a,h?v.kF(s,l,N,I,c,u,t,n,o,a,a,a,T,!0,!1):d?v.kF(s,l,N,I,c,u,t,a,o,r,a,a,T,!1,!1):v.kF(s,l,N,I,c,u,t,a,o,a,a,a,T,!0,!1),I+=u;R=k?R:null,E=D?E:null,v.kF(e.row,e.col,e.x,e.y,e.width,e.height,a,a,a,a,R,E,a,!0,!0)}else{for(i=0;i<e.rowCount;i++){for(s=b+i,h=0===i,d=i===e.rowCount-1,u=M.rowSizes[i],y=0;y<e.colCount;y++)l=C+y,f=0===y,p=y===e.colCount-1,c=M.colSizes[y],g=M.styleList[i][y],s===e.row&&l===e.col&&(R=(m=g)&&m.diagonalDown,E=m&&m.diagonalUp),g?(t=g.borderLeft,n=g.borderTop,o=g.borderRight,r=g.borderBottom,k&&(k=x.kWa(R,g.diagonalDown)),D&&(D=x.kWa(E,g.diagonalUp))):t=n=o=r=a,h?f?v.kF(s,l,N,I,c,u,t,n,a,a,a,a,T,!0,!0):p?v.kF(s,l,N,I,c,u,a,n,o,a,a,a,T,!0,!1):v.kF(s,l,N,I,c,u,a,n,a,a,a,a,T,!0,!0):d?f?v.kF(s,l,N,I,c,u,t,a,a,r,a,a,T,!1,!0):p?v.kF(s,l,N,I,c,u,a,a,o,r,a,a,T,!1,!1):v.kF(s,l,N,I,c,u,a,a,a,r,a,a,T,!1,!0):f?v.kF(s,l,N,I,c,u,t,a,a,a,a,a,T,!0,!0):p&&v.kF(s,l,N,I,c,u,a,a,o,a,a,a,T,!0,!1),N+=c;N=w,I+=u}R=k?R:null,E=D?E:null,v.kF(e.row,e.col,e.x,e.y,e.width,e.height,a,a,a,a,R,E,a,!0,!0)}!T||t||o||n||r||v.bF.push({r:b,c:C,rc:e.rowCount,cc:e.colCount})},e.prototype.mE=function(){var e=this,t=!1,n=!1,o=!1,r=!1;p(e.fF)||(t=!0),p(e.eF)||(n=!0),(t||n)&&(e.tF(),e.tWa()),p(e.lWa)||(o=!0),p(e.mWa)||(r=!0),(o||r)&&e.oWa(),e.bF.length>0&&e.uF()},e.prototype.E$a=function(e,t,n,o,r){var i=this,a=this.C$a[e]?this.C$a[e][t]:null;if(a)switch(r){case g.H_TOP_LEFT:return i.vF(e,t,n,o);case g.H_TOP_Right:case g.V_RIGHT_TOP:return i.vF(e,t+a.colCount-1,n,o);case g.V_RIGHT_BOTTOM:case g.H_BOTTOM_RIGHT:return i.vF(e+a.rowCount-1,t+a.colCount-1,n,o);case g.H_BOTTOM_LEFT:case g.V_LEFT_BOTTOM:return i.vF(e+a.rowCount-1,t,n,o);case g.V_LEFT_TOP:return i.vF(e,t,n,o)}return i.vF(e,t,n,o)},e.prototype.oWa=function(){var e,t,n,o,r,i,a,s,l,u,c,f,h,p,d,m=this,y=m.$E,v=m._E,b=y.length,C=v.length,w={},A={};for(e=0;e<b;e++)for(n=y[e],t=0;t<C;t++)o=v[t],h=m.pF(n,o,m.lWa,!1),p=m.pF(n,o,m.mWa,!1),(h||p)&&(x.LE(h)&&x.LE(p)&&(h.line.jWa(),p.line.jWa()),d=[],(r=m.E$a(n,o,!1,w,g.H_TOP_LEFT))&&r.line&&!r.isGridLine&&(d=[1,1,2],m.pWa(d,r,h,!0,1)),(l=m.E$a(n,o,!1,w,g.H_TOP_Right))&&l.line&&!l.isGridLine&&(d=[1,1,2],m.pWa(d,l,p,!0,1)),(i=m.E$a(n,o,!0,A,g.V_LEFT_TOP))&&i.line&&!i.isGridLine&&(d=[1,1,2],m.pWa(d,i,h,!0,0)),(u=m.E$a(n,o,!0,A,g.V_LEFT_BOTTOM))&&u.line&&!u.isGridLine&&(d=[1,1,2],m.pWa(d,u,p,!1,0)),(a=m.E$a(n+1,o,!1,w,g.H_BOTTOM_LEFT))&&a.line&&!a.isGridLine&&(d=[-1,-2,-2],m.pWa(d,a,p,!1,1)),(c=m.E$a(n+1,o,!1,w,g.H_BOTTOM_RIGHT))&&c.line&&!c.isGridLine&&(d=[-1,-2,-2],m.pWa(d,c,h,!1,1)),(s=m.E$a(n,o+1,!0,A,g.V_RIGHT_TOP))&&s.line&&!s.isGridLine&&(d=[-1,-2,-2],m.pWa(d,s,p,!0,0)),(f=m.E$a(n,o+1,!0,A,g.V_RIGHT_BOTTOM))&&f.line&&!f.isGridLine&&(d=[-1,-2,-2],m.pWa(d,f,h,!1,0)))},e.prototype.pWa=function(e,t,n,o,r){var i,a,s=x.LE(t),l=x.HE(t),u=t.line.uE;s&&(u=3),l&&(u=2),i=e[u-1],n&&n.line&&(a={_orientation:r},o?a.pE=i:a.nE=i,n.line.mE(a))},e.prototype.uF=function(){var e,t,n,o,r,i,a,s,l,u,c,f,h=this,p=h.bF,d=p.length;for(e=0;e<d;e++){for(r=n=(t=p[e]).r,i=n-1,a=(o=t.c)-1,s=o,t.rc>1&&(r+=t.rc-1),t.cc>1&&(s+=t.cc-1),l=!1,u=!1,c=e+1;c<d&&((f=p[c]).c===s+1&&f.r===n&&(u=!0),f.r===r+1&&f.c===o&&(l=!0),!l||!u)&&!(f.r>n+1&&f.c>o+1);c++);l||h.oF(r,a,h.cF,!0),u||h.oF(i,s,h.dF,!1)}},e.prototype.tF=function(){var e,t,n,o,r,i,s,l,u,c,f,h,p,d,g,m,y,v,b=this,C=b.$E,w=b._E,A=C.length,M=w.length,S={},T={};for(e=0;e<A;e++)for(n=C[e],t=0;t<M;t++){if(o=w[t],g=0,m=0,y=b.pF(n,o,b.fF,!0)){if(y.line&&y.line.gIb)continue;g++}else y=b.pF(n,o-1,b.dF,!0);(v=b.pF(n,o,b.eF,!0))?m++:v=b.pF(n-1,o,b.cF,!0),(y||v)&&((r=0===e?a:b.vF(C[e-1],o,!0,T))&&r.line&&!r.isGridLine&&(g++,m++),(i=0===t?a:b.vF(n,w[t-1],!1,S))&&i.line&&!i.isGridLine&&(g++,m++),y&&((s=b.vF(n,o,!1,S))&&s.line&&!s.isGridLine&&g++,e!==A-1&&((u=b.vF(C[e+1],o,!0,T))&&u.line&&!u.isGridLine&&g++),0!==t&&e!==A-1&&((c=b.vF(C[e+1],w[t-1],!1,S))&&c.line&&!c.isGridLine&&g++),e!==A-1&&((f=b.vF(C[e+1],o,!1,S))&&f.line&&!f.isGridLine&&g++),g>0&&(x.GE(y.style)?x.TE(y,r,i,s,u,c,f,!0):x.HE(y.style)||x.SE(y,r,i,s,u,c,f))),v&&((l=b.vF(n,o,!0,T))&&l.line&&!l.isGridLine&&m++,t!==M-1&&((h=b.vF(n,w[t+1],!1,S))&&h.line&&!h.isGridLine&&m++),0!==e&&t!==M-1&&((p=b.vF(C[e-1],w[t+1],!0,T))&&p.line&&!p.isGridLine&&m++),t!==M-1&&((d=b.vF(n,w[t+1],!0,T))&&d.line&&!d.isGridLine&&m++),m>0&&(x.GE(v.style)?x.TE(v,i,r,l,h,p,d,!1):x.HE(v.style)||x.RE(v,i,r,l,h,p,d))))}},e.prototype.F$a=function(e,t,n,o){var r=this,i=this.C$a[e]?this.C$a[e][t]:null,a=n?r.mWa:r.lWa;return i?e===i.row&&t===i.col&&o===d.LEFT_TOP||e===i.row&&t===i.col+i.colCount-1&&o===d.RIGHT_TOP||e===i.row+i.rowCount-1&&t===i.col+i.colCount-1&&o===d.RIGHT_BOTTOM||e===i.row+i.rowCount-1&&t===i.col&&o===d.LEFT_BOTTOM?r.pF(i.row,i.col,a,!1):void 0:r.pF(e,t,a,!1)},e.prototype.tWa=function(){var e,t,n,o,r,i,a,s,l,u,c,f,h,p,g,m=this,y=m.$E,v=m._E,b=y.length,C=v.length;for(e=0;e<b;e++)for(n=y[e],t=0;t<C;t++)o=v[t],(p=m.pF(n,o,m.fF,!0))&&p.line&&p.line._noNeedAdjust||(p&&p.line&&x.LE(p)&&(r=m.F$a(n,o,!1,d.LEFT_TOP),i=m.F$a(n,o,!0,d.LEFT_BOTTOM),a=x.LE(r),s=x.LE(i),l=m.F$a(n,o-1,!1,d.RIGHT_BOTTOM),u=m.F$a(n,o-1,!0,d.RIGHT_TOP),c=x.LE(l),f=x.LE(u),r&&a&&(h={CE:2,_orientation:1,pE:2},p.line.mE(h)),i&&s&&(h={CE:2,_orientation:1,nE:-2},p.line.mE(h)),l&&c&&(h={CE:1,_orientation:1,nE:-2},p.line.mE(h)),u&&f&&(h={CE:1,_orientation:1,pE:2},p.line.mE(h))),(g=m.pF(n,o,m.eF,!0))&&g.line&&x.LE(g)&&(r=m.F$a(n,o,!1,d.LEFT_TOP),i=m.F$a(n,o,!0,d.RIGHT_TOP),a=x.LE(r),s=x.LE(i),l=m.F$a(n-1,o,!1,d.RIGHT_BOTTOM),u=m.F$a(n-1,o,!0,d.LEFT_BOTTOM),c=x.LE(l),f=x.LE(u),r&&a&&(h={CE:2,_orientation:0,pE:2},g.line.mE(h)),i&&s&&(h={CE:2,_orientation:0,nE:-2},g.line.mE(h)),l&&c&&(h={CE:1,_orientation:0,nE:-2},g.line.mE(h)),u&&f&&(h={CE:1,_orientation:0,pE:2},g.line.mE(h))))},e.prototype.vF=function(e,t,n,o){var r,a=o[e];return a||(a=o[e]={}),(r=a[t])===i&&(r=a[t]=this.wF(e,t,n)),r},e.prototype.wF=function(e,t,n){var o,r,s;if(e===i||e<0||t===i||t<0)return a;if(o=this,r=n?o.fF:o.eF,s=o.pF(e,t,r,!0))return s;if(r=n?o.dF:o.cF,n){if(--t<0)return a}else if(--e<0)return a;return(s=o.pF(e,t,r,!0))||a},e.prototype.paint=function(e){var t=this;t.UE&&(t.VE||(t.D$a(),t.rF(),t.qF(),t.mE(),t.VE=!0),e.save(),e.beginPath(),t.jp(e),e.closePath(),e.stroke(),e.restore())},e.prototype.jp=function(e){this.xF(e),this.yF(e)},e.prototype.xF=function(e){var t=this;t._d(e,t.cF),t._d(e,t.dF)},e.prototype.yF=function(e){var t=this;t._d(e,t.eF),t._d(e,t.fF),t._d(e,t.lWa),t._d(e,t.mWa)},e.prototype._d=function(e,t){var n,o,r,i,a,s;for(n in t)if(t[n])for(o in r=t[n])if(r[o])if(i=r[o].line,(a=r[o].splitLines)&&a.length>0)for(s=0;s<a.length;s++)a[s]&&a[s].jp(e);else i&&i.jp(e)},e}(),t.AF=A},"./dist/core/worksheet/worksheet-edit.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x;Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/core.ns.js"),r=n("./dist/core/worksheet/worksheet.js"),i=n("./dist/core/util/common.js"),a=n("./dist/core/util/domUtil.js"),s=a.GC$,l=n("@grapecity/js-sheets-common"),u=n("./dist/core/core.enum.js"),c=n("@grapecity/js-calc"),f=!!c,h=i.Ul.Ml,p=i.Ul.rl(),d=l.Common.j.Fa,g=l.Common.u,m=l.Common.CultureManager,y=null,v=void 0,b=i.Ul.K_a,C=new l.Common.ResourceManager(o.SR),w=C.getResource.bind(C),x={startEdit:function(e,t){var n=this;n.EF(n.Ws(),n.Jl,n.Kl,y,y,e,t)},editorStatus:function(){return this._editorStatus||0},isEditing:function(){var e=this._editorStatus;return 1===e||2===e},endEdit:function(e){return this._endEditImp(e)},_endEditImp:function(e,t,n,o){var r=this;if(!r.isEditing())return!0;r.suspendPaint();try{return r.Yoa(e,t,n,o)}finally{r.resumePaint()}},Yoa:function(e,t,n,o){var a,l,c,f,p,g,m,v,b,C,w,x,A,M,S=this,T=S._eventHandler,N=S._editor,I=S.name(),R=S.Jl,k=S.Kl,E=S.getCellType(R,k),D={sheet:S,row:R,col:k,sheetArea:3,klb:N&&N.klb};if(E.isImeAware(D)||T.Qq(),N&&N.parentNode){if(c={sheet:S,sheetName:I,row:R,col:k,editor:N,editingText:l=E.getEditorValue(N,D),cancel:!1},S.Wq(i.Events.EditEnd,c),c.cancel&&!o)return;if(S.Wq(i.Events.EditEnding,c),c.cancel&&!o)return;if(p=(f=S.parent)&&f.CF,document.activeElement===(p&&p._host)&&T.Qq(),R>=0&&k>=0&&(g=N.Ep,m=S.getFormulaInformation&&S.getFormulaInformation(R,k),E.isEditingValueChanged(g,l,D)||1===t||m&&m.isArrayFormula&&1!==t))if(e)E.setEditorValue(N,g,D),E.selectAll(N,D);else if(v=E.DF,d(v)&&(v=!0),b={cmd:"editCell",sheetName:I,row:R,col:k,newValue:l,autoFormat:v,editingFormatter:N.oja},1===t&&(b.ranges=[S._getActiveSelectedRange()],b.endEditType=t),null===l||e||S.tables&&S.tables.find&&(S.tables.find(R-1,k)||S.tables.find(R,k-1))&&S.tables.fIb(new i.Range(R,k,1,1),null,l,!0),S.wu().execute(b),2===(a=b.applyResult)&&(E.focus(N,D),!o))return!1;if(S.$l=!0,E.XBb(N,D,S.getCellRect(R,k)),E.isImeAware(D))h.msie&&9===parseFloat(h.version)?T.Qq():s(N.parentNode.parentNode).css({width:0,height:0,overflow:"hidden",border:"none"});else for(C=S.zo(),w=N;w;)w.parentNode===C?C.removeChild(w):w=w.parentNode}return S.Ll=!1,x={sheet:S,sheetName:I,row:R,col:k,editingText:l},A=s.extend({},x),S.Wq(i.Events.EditEnded,x),S.Wq(i.Events.FormulatextboxEditEnded,A),!(!0!==n&&A.ignore&&!o)&&(0!==S._editorStatus&&(M=S._editorStatus,S._editorStatus=0,S._raiseEditorStatusChanged(M,0)),S._modelManager.setCellState(R,k,u.CellStatesType.edit,!1,u.SheetArea.viewport),r.Worksheet.ao(S,"endEdit"),S._editor=y,1!==a)},FF:function(e,t,n){var o,r,i,a,s,l,u,c,f=this,h=f.hitTest(t,n);!h||h.cellTypeHitInfo&&(h.cellTypeHitInfo.outlineColumnHitInfo||h.cellTypeHitInfo.cellButtonHitInfo)||(o=h.row,r=h.col,o>=0&&r>=0&&h.rowViewportIndex>=0&&h.colViewportIndex>=0&&!h.resizeInfo&&!h.dragInfo&&o===f.Jl&&r===f.Kl&&(i=f.isEditing(),f.EF(e,o,r),!i&&f.isEditing()&&(a=h.hitTestType,(s=f.getCellType(o,r)).tw&&(l=f.getCellRect(o,r,1===a?-1:v,2===a?-1:v),u=f.getActualStyle(o,r,a),(c=s.h5(t,n,u,l,{sheet:f,row:o,col:r,sheetArea:a}))&&c.isReservedLocation&&s.tw(f,o,r,3)))))},inputFormulaAndSelectFormulaRange:function(e,t,n,o){var a,s,l,u,c,f=this,h=f.options,p=f.getCellRect(e,t),d=f.getActualStyle(e,t),g=f.getCellType(e,t),m=f._eventHandler;m.zt(),a={sheet:f,row:e,col:t,sheetArea:3},(s=m.GF)&&s.firstChild&&(l=s.firstChild.firstChild),l&&(f._editor=l,u=f.am(),g.isImeAware(a)&&m.JF(),g._activateEditorWrapper(s,d,p,a),f.KF(g,l,e,t,d,void 0,void 0),g._updateEditorWrapper(s,d,p,a),h.allowCellOverflow&&((c=p.clone()).y-=2,c.height+=4,c.x=u.kt,c.width=u.er,f.repaint(c)),r.Worksheet.ao(f,"startEdit",{element:g.getEditingElement()}),f._editorStatus=2,f._formulaTextBox.text(o),f._formulaTextBox.caret(o.length-1),n&&f._formulaTextBox.iIb(3,4),f._formulaTextBox._openFuncHelp(),i.Vl.Zl(f))},EF:function(e,t,n,o,a,l,c,g,v){var b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q;if(s[s.sd]({tc:this.parent}),!(t<0||n<0||(b=this,C=b.name(),w=b.options,b.isEditing()||(x=b.getCellRect(t,n),!x||d(x.width)||d(x.height)||d(x.x)||d(x.y)||x.width<=0||x.height<=0)))){if((A=b._modelManager).setCellState(t,n,u.CellStatesType.edit,!0,u.SheetArea.viewport),M=b.getActualStyle(t,n),w.isProtected&&!1!==M.locked)return void A.setCellState(t,n,u.CellStatesType.edit,!1,u.SheetArea.viewport);if(!(S=b.getCellType(t,n)))return void A.setCellState(t,n,u.CellStatesType.edit,!1,u.SheetArea.viewport);if((T=b._eventHandler).zt(),N={sheet:b,row:t,col:n,sheetArea:3},(I=S.isImeAware(N)?T.GF:S._createCellTypeElement(N))&&I.firstChild&&(R=I.firstChild.firstChild),!R)return void A.setCellState(t,n,u.CellStatesType.edit,!1,u.SheetArea.viewport);if(k=b.getActualStyle(t,n),E=!1,j=m.culture(),(k.formatter&&i.util.yIc(k.formatter,j)||k._autoFormatter&&k._autoFormatter.formatCached&&i.util.yIc(k._autoFormatter,j))&&(_=v&&v.keyCode,O=v&&v.code,v&&_&&!v.shiftKey&&(_>=96&&_<=105||_>=48&&_<=57)&&(E=!0),(109===_||107===_||v&&(!v.shiftKey&&189===_||v.shiftKey&&187===_))&&(S.probabilityAddPercent=!0),229===_&&!v.shiftKey&&O.length-O.replace(/[0-9]/,"").length>0&&(E=!0),229===_&&!v.shiftKey&&(O.length-O.replace("Minus","").length>0||O.length-O.replace("Subtract","").length>0||O.length-O.replace("Add","").length>0)&&(S.probabilityAddPercentSpec=!0),229===_&&v.shiftKey&&O.length-O.replace("Equal","").length>0&&(S.probabilityAddPercentSpec=!0),F=I.innerText,h.msie&&(F=F.replace("\r\n","")),P=m.q4(m.culture()).NumberFormat.numberDecimalSeparator,H=RegExp("^[-]?[0-9]+(\\"+P+"[0-9]+)?$"),!v&&F&&H.test(F)&&(D=!0)),b._editor=R,B={sheet:b,sheetName:C,row:t,col:n,cancel:!1},b.Wq(i.Events.EditStarting,B),B.cancel)return p.ipad&&T.Qq(),void A.setCellState(t,n,u.CellStatesType.edit,!1,u.SheetArea.viewport);b.showCell(b.Jl,b.Kl,3,3),b.jIb=!0,L=b.getValue(t,n),z=f&&b.getFormula(t,n),V=b._editorStatus,b.HF||d(L)&&d(z)?b._editorStatus=1:b._editorStatus=2,b._raiseEditorStatusChanged(V,b._editorStatus),G=b.am(),x=b.getCellRect(t,n,o,a),S.isImeAware(N)&&T.JF(),S._activateEditorWrapper(I,M,x,N),b.KF(S,R,t,n,M,c,g,E,D),W=b.zo(),S.isImeAware(N)||W.insertBefore(I,y),delete b.jIb,S._updateEditorWrapper(I,M,x,N),S.isImeAware(N)&&l||S.focus(R,N),w.allowCellOverflow&&((U=x.clone()).y-=2,U.height+=4,U.x=G.kt,U.width=G.er,b.repaint(U)),r.Worksheet.ao(b,"startEdit",{element:S.getEditingElement()}),!E&&l&&S.selectAll(R,N),E&&(Z=window.getSelection(),(q=document.createRange()).setStart(R,0),Z.removeAllRanges(),Z.addRange(q)),D&&(Z=window.getSelection(),(J=document.createElement("span")).innerText="%",q=document.createRange(),b.parent.options.enableFormulaTextbox&&b.parent.options.allowUserEditFormula?(R.firstChild.appendChild(J),q.setStart(R.firstChild,1)):(R.appendChild(J),q.setStart(R,1)),Z.removeAllRanges(),Z.addRange(q)),i.Vl.Zl(b),Q={sheet:b,sheetName:C,row:t,col:n},b.Wq(i.Events.EditStarted,Q),b.Wq(i.Events.FormulatextboxEditStarted,Q)}},KF:function(e,t,n,o,r,i,a,s,l){var u,c,h,p,m,y=this,v=f&&y.getFormula(n,o,3,!0);v&&(v="="+v),u=v,c={sheet:y,row:n,col:o,sheetArea:3,isImeInput:a},v&&0!==v.length||((v=y.getValue(n,o,3,1))&&v.richText&&(t.klb=!0,v=b(v)),h=y.parent,p=f&&h&&h.options.allowUserEditFormula,"string"==typeof v&&r.quotePrefix||v&&v.length>0&&"="===v[0]&&p?u=v="'"+v:(u=v,v=e.kp(t,r,v,c))),t.Ep=v,d(i)||(v=i),l&&(v=this.kIb(v)),e.setEditorValue(t,v,c,s),y.parent&&y.parent.options.enableAccessibility&&(m=w(),t.setAttribute("aria-label",m.ARIA_Cell+"("+n+","+o+") "+g.Kb(m.ARIA_HasValue,[v]))),t.LF=u},kIb:function(e){var t,n,o,r,i,a,s,l=m.q4(m.culture()).NumberFormat,u=l.negativeSign,c=l.numberDecimalSeparator;if(e.split("e").length>1)return t=e.split("e")[0],n=e.split("e")[1],t+"e+"+(parseInt(n.split("+")[1],10)+2);if(e.split(c).length>1){for(o=!1,e.charAt(0)===u&&(e=e.substr(1,e.length-1),o=!0),r=(e+="00").indexOf(c),a=(i=(e=(e=e.split(c).join("")).substr(0,r+2)+c+e.substr(r+2,e.length-1)).split(c))[0],s=i[1];a&&"0"===a.charAt(0);)a=a.substr(1,a.length-1);for(;s&&"0"===s.charAt(s.length-1);)s=s.substr(0,s.length-2);return o&&a&&(a=u+a),a&&s?a+c+s:!a&&s?(o?u+"0"+c:"0"+c)+s:a&&!s?a:"0"}return e+"00"}},s.extend(r.Worksheet.prototype,x)},"./dist/core/worksheet/worksheet-event.js":function(e,t,n){"use strict";var o,r,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe,re,ie,ae,se,le;function ue(e,t,n){var o,r,i,a,s,l,c,f=!1,h=e.am();return t&&(o=me(t),r=ye(t),(o<0||r<0)&&((i=e.getCellRect(t.row,t.col,o,r))&&i.width>0&&i.height>0&&(a=h.x,s=h.y,(i.x<h.Br+a||i.y<h.Cr+s||i.y>=h.height-h.Bt)&&(l=new u.Rect(i.x-2,i.y-2,i.width+4,i.height+4),void 0,c=o<0&&r<0?h.em():o<0?h.gm(r):h.fm(o),l=l.getIntersectRect(c),n.VF(l.x,l.y,l.width,l.height),f=function(e,t){var n=3;return me(t)<0&&(n=1),ye(t)<0&&(n=2),!(3===n||!e.vp(t.row,t.col,n,!0))}(e,t))))),f}function ce(e){return e.isEditing()}function fe(e){return e.endEdit()}function he(e){return e.frozenRowCount()}function pe(e){return e.frozenColumnCount()}function de(e,t){return e.getRowCount(t)}function ge(e,t){return e.getColumnCount(t)}function me(e){return e.rowViewportIndex}function ye(e){return e.colViewportIndex}function ve(e){return e.hitTestType}function be(e){return e.getActiveRowIndex()}function Ce(e){return e.getActiveColumnIndex()}function we(e){return e.keyCode}function xe(e){return e.ctrlKey}function Ae(e){return e.shiftKey}function Me(e){return e.altKey}function Se(e){return e.metaKey}function Te(e){return e.colCount}function Ne(e){return e.rowCount}function Ie(e,t,n){return{action:e,index:t,sheetArea:n}}function Re(e,t,n,o,r,i){var a={sheet:e,sheetName:t,sheetArea:r,row:n,col:o};return i&&(a.cancel=!1),a}function ke(e,t,n,o,r,i){var a=e.kj,s=Re(a,a.name(),a.Jl,a.Kl,E,!0);return a.Wq(u.Events.LeaveCell,s),!(!s||!0!==s.cancel)||(a.Kr(t,n,o,r,i),a.Wq(u.Events.EnterCell,Re(a,a.name(),t,n)),a.Wq(u.Events.FormulatextboxEnterCell,Re(a,a.name(),t,n)),void(e.cs&&e.cs(t,n)))}function Ee(e,t,n,o,r,i,a){var s,l=e.kj,u=t.call(l,i.sheetArea);return(a&&!l.getRowVisible(i.index,i.sheetArea)||!a&&!l.getColumnVisible(i.index,i.sheetArea))&&(i.index=n.call(e,i.index,i.sheetArea)),(s=o.call(u,i.index))||(s=o.call(u,r)),s}function De(e,t,n,o,r){var i,a=o?"movingY":"movingX",s=o?"startY":"startX";e[a]=t,e[a]<e[s]&&(e[a]=e[s]),i=o?n.y+n.height:n.x+n.width,e[a]>i&&(e[a]=i),r!==k&&e[a]>e[s]+r&&(e[a]=e[s]+r)}function je(e,t){var n=t.row,o=t.rowCount,r=t.col,i=t.colCount,a=e.getColumnCount(),s=e.getRowCount();return i+r>a&&(i=a-r),o+n>s&&(o=s-n),{row:n,col:r,rowCount:o,colCount:i}}function _e(e,t,n){var o=e.parent.options.rowResizeMode;return n&&0===o&&(o=1),t.action!==X&&1===o&&!function(e,t){var n,o=e.getViewportBottomRow(e.Er(t));if(-1===o&&(o=e.ir()),t<o)for(n=o;n>t;n--)if(0!==e.getRowHeight(n))return!1;return!0}(e,t.index)&&!(!e.getRowResizable(t.index,t.sheetArea)||!e.getRowResizable(t.index+1,t.sheetArea))&&function(e){var t,n,o=e._modelManager.getSelections();if(o.length>0)return t=0,n=e.getRowCount(),o.every((function(o){var r,i=je(e,o),a=!1;return 1===i.rowCount&&(a=(t+=1)<=1),r=i.row<n,-1!==i.col||a&&r}))}(e)}function Oe(e,t,n){var o=e.parent.options.columnResizeMode;return n&&0===o&&(o=1),t.action!==ne&&1===o&&!function(e,t){var n,o=e.getViewportRightColumn(e.Fr(t));if(-1===o&&(o=e.dr()),t<o)for(n=o;n>t;n--)if(0!==e.getColumnWidth(n))return!1;return!0}(e,t.index)&&!(!e.getColumnResizable(t.index,t.sheetArea)||!e.getColumnResizable(t.index+1,t.sheetArea))&&function(e){var t,n,o=e._modelManager.getSelections();if(o.length>0)return t=0,n=e.getColumnCount(),o.every((function(o){var r,i=je(e,o),a=!1;return 1===i.colCount&&(a=(t+=1)<=1),r=i.col<n,-1!==i.row||a&&r}))}(e)}function Fe(e,t,n){var o,r,i,a=n?e.frozenRowCount():e.frozenColumnCount(),s=n?e.lq:e.qq,l=!1,u=s-1;if(a>0&&a<s)for(o=s-1;o>=a;){if(n?e.getRowVisible(o):e.getColumnVisible(o)){if(r=n?e.getRowHeight(o):e.getColumnWidth(o),o===u&&0===r)break;if(r>0){l=!0;break}}else u--;o--}for(i=l?a:t,i--;i>=0;){if(n?e.getRowVisible(i):e.getColumnVisible(i))return i;i--}return-1}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/core.ns.js"),r=n("./dist/core/worksheet/worksheet.js"),a=n("@grapecity/js-sheets-common"),s=n("./dist/core/worksheet/worksheet-model.js"),l=n("./dist/core/util/domUtil.js"),u=n("./dist/core/util/common.js"),c=n("./dist/core/core.enum.js"),f=window,h=document,p=l.GC$.each,d=u.Ul.Ml,g=u.Ul.rl(),m=u.Ul.nl,y=u.Ul.Nl,v=a.Common.u.Kb,b=u.kf,C=a.Common.j.Fa,x="mousedown"+(w={lIb:".handler"}).lIb,A="mouseup"+w.lIb,M="mousemove"+w.lIb,S="mousewheel"+w.lIb,T="DOMMouseScroll"+w.lIb,N="wheel"+w.lIb,I="mouseout"+w.lIb,R="dblclick"+w.lIb,k=null,E=void 0,D=isNaN,j=parseInt,_=Math.max,O=Math.floor,F=Math.min,P=Math.abs,H=Math.ceil,B="function",L="position",z="absolute",V="border",G="overflow",W="top",U="left",Z="width",q="height",J="hidden",Q="none",Y="tabindex",K="gcUIElement",$="corner",X="sizeHiddenRow",ee="sizeRow",te="sizeCol",ne="sizeHiddenCol",oe="default",re=g.iphone||g.ipad||g.android,ie=new a.Common.ResourceManager(o.SR),ae=ie.getResource.bind(ie),se=function(){function e(e){var t=this;t._host=e,t.jI=k,t.kI=k,t.lI=k,t.Fi=k,t.mI=!1,t.nI=!1}return e.prototype.tG=function(e){typeof e===B&&(this.kI=e)},e.prototype.PG=function(e){var t,n=this;D(e)||0===e?n.SG():(n.nI=e>0,e=P(e),t=n.jI,n.jI=e,t!==e&&n.oI())},e.prototype.oI=function(){var e=this;e.$b(),D(e.jI)||(e.lI=f.setInterval((function(){e.pI()}),e.jI))},e.prototype.pI=function(){var e=this,t=e.kI;e.mI=!0,typeof t===B&&(e.Fi=t.call(e._host,e.nI))},e.prototype.SG=function(){var e=this;e.$b(),e.jI=k,e.lI=k,e.Fi=k,e.mI=!1},e.prototype.$b=function(){var e=this.lI;e&&clearInterval(e)},e.prototype.no=function(){this.SG()},e}(),le=function(){function e(e){this.mIb=0;var t=this;t.WF=0,t.XF=!1,t.Gma=!1,t.gA={},t.kj=e,t.nIb="gcEvent"+e.yn}return e.prototype.no=function(){var e=this;e.YF&&e.YF.no(),e.ZF&&e.ZF.no(),e.$F=k},e.prototype._F=function(){var e=this;return e.YF||(e.YF=new se(e)),e.YF},e.prototype.aG=function(){var e=this;return e.ZF||(e.ZF=new se(e)),e.ZF},e.prototype.Vs=function(){return this.kj.Vs()},e.prototype.bG=function(){var e=l.GC$(this.kj.Ws()).position();return e||(e={top:0,left:0}),e},e.prototype.AD=function(e){var t,n,o,r,i,a,s,l,c,f,h=u.Ul.sl(),p=xe(e),g=h&&!0===p&&0===e.button;return!(2!==e.button&&!g&&(t=this,n=t.kj,t.tC(),d&&d.msie&&e.offsetX!==E&&e.offsetY!==E&&(o=0,r=0,i=n.Xs,e.target!==i&&(a=u.Ul.Z3(e.target,i),o=a.EB,r=a.FB),i&&(s=e.pageX-(e.offsetX+o),l=e.pageY-(e.offsetY+r),i.canvasOffset={top:l,left:s})),c=n.Vs(),f=t.cG(e,e.pageX-c.left,e.pageY-c.top),ce(n)||f||t.zt(),n.dG=!0,1))},e.prototype.tC=function(){var e=this;e.RB||(l.GC$(h).bind("mousemove.gcSheet."+e.nIb,(function(t){e.BD(t)})).bind("mouseup.gcSheet."+e.nIb,(function(t){e.CD(t)})),e.RB=!0)},e.prototype.uC=function(){this.RB&&(this.RB=!1,l.GC$(h).unbind("mousemove.gcSheet."+this.nIb).unbind("mouseup.gcSheet."+this.nIb))},e.prototype.cG=function(e,t,n){var o,i,a,s,l,c,f,h,p,d,g,m=this,y=m.kj,v=y.hitTest(t,n),b=v.row,w=v.col,x=v.dragInfo,A=v.formulaRangeHitInfo,M=v.cellTypeHitInfo,S=v.resizeTableHitInfo,T={hitInfo:v,e:e,r:k};if(r.Worksheet.ao(y,"processMouseDown",T),!T.r&&(t>=(o=y.am()).x&&n>=o.y))if(y.yt=v,m.eG=!0,v.tableSelectInfo&&!y._formulaTextBox)this.oIb(v,y);else if(v.resizeInfo){if(!fe(y))return;m.fG(v)}else if(v.dragMergeInfo){if(!fe(y))return;m.Zia&&m.Zia(v)}else if(x&&x.side&&x.side!==$){if(!fe(y))return;m.gG&&m.gG(v),m.lG(e)}else if(x&&x.side===$){if(!fe(y))return;m.hG&&m.hG(v)}else if(v.filterButtonHitInfo)fe(y);else if(A)A.inBorder?m.iG(v):(A.inTopLeft||A.inTopRight||A.inBottomLeft||A.inBottomRight)&&m.jG(v);else if(S)m.pIb&&m.pIb(v);else if(y.Qs(me(v)<0?-1:b,ye(v)<0?-1:w)){if(v.tableSelectInfo&&y._formulaTextBox&&(i=y._formulaTextBox,a=this.qgc(v,y),v.tableSelectInfo.tableSelection=a,i.rgc(a)),m.kG&&m.kG(y,v))return;if(s=be(y),l=Ce(y),M){if(c=y.getCellType(M.row,M.col,ve(v)),M.sheet||(M.sheet=y),m.Sia(c,M)&&(f=M.sheetArea,(C(f)||3===f)&&(b!==s||w!==l))){y.suspendPaint();try{if(!fe(y))return;if(h=Re(y,y.name(),s,l,E,!0),y.Wq(u.Events.LeaveCell,h),h&&!0===h.cancel)return;p=y._modelManager.getSelections(),d=y._modelManager.getSpan(b,w),g=[new u.Range(d.row,d.col,d.rowCount,d.colCount)],y.Wq(u.Events.FloatingElementSelected,{type:"worksheet"}),y.yu(p,g),y.Sr(b,w,E,E,1),y.Wq(u.Events.EnterCell,Re(y,y.name(),b,w)),y.Wq(u.Events.FormulatextboxEnterCell,Re(y,y.name(),b,w)),y.Au(p),y.Uja=!0,m.cs&&m.cs(b,w)}finally{y.resumePaint()}}c.processCellAndPaddingMouseDown(M)}if(M&&M.isReservedLocation)return!0;m.lG(e),m.Ala(y,v,b,w)}},e.prototype.Ala=function(e,t,n,o){var r,i,a=this;try{if(a.mG=t,ce(e)&&!fe(e))return}finally{a.mG=k}C(n)||C(o)||(3===ve(t)&&a.cs&&a.cs(n,o),e.Wq(u.Events.FloatingElementSelected,{type:"worksheet"}),r=e._modelManager.getSelections(),a.nG(t,r),i=e._modelManager.getSelections(),e.yu(r,i))},e.prototype.Sia=function(e,t){return e&&t&&t.isReservedLocation&&(!e.activeOnClick||e.activeOnClick())},e.prototype.oG=function(e){var t,n=this.kj;return!n||(t=n.am(),C(e.x)||C(e.y)||C(e.width)||C(e.height)||e.x+e.width>t.pt+t.er+t.js||e.y+e.height>t.qt+t.jr+t.gs)},e.prototype.pG=function(e,t,n,o,r){var i,a,s,u,c,f,h,p=this.kj;for(a=0,u=(s=e.options).length;a<u;a++)if(s[a].selected){i=o[a].value;break}c=!1,p.options.isProtected&&((f=p.getActualStyle(t,n))&&(c=f.locked)),i===E||c||(h={cmd:"editCell",sheetName:p.name(),row:t,col:n,newValue:i,autoFormat:!0,ignoreFormatting:r},p.wu().execute(h)),l.GC$(e).hide()},e.prototype.qG=function(){var e,t=this;t.rG&&(3!==(e=t.rG.sG)&&2!==e||t.aG().tG(t.uG),3!==e&&1!==e||t._F().tG(t.vG))},e.prototype.wG=function(){var e=this;e.xG&&e.yG(),e.$ia&&e._ia&&e._ia(),e.zG&&e.AG&&e.AG(),e.BG&&e.CG&&e.CG(),e.DG&&e.EG(),e.FG&&e.GG(),e.HG&&e.IG(),e.qIb&&e.rIb&&e.rIb()},e.prototype.uG=function(e){var t,n,o,r,i,a,s,l,u=this;u.JG()||(t=u.rG,n=u.kj,o=t.KG,r=n.getViewportTopRow(o),i=n.getViewportBottomRow(o),e?i<de(n)-n.frozenTrailingRowCount()-1?n.mq(n._q(r)):(a=n.Gr(o))&&a.length>0&&(s=n.am(),(l=a[a.length-1]).y+l.height>=s.qt+s.jr&&n.mq(n._q(r))):r>he(n)&&n.mq(n.gr(r))),u.wG()},e.prototype.vG=function(e){var t,n,o,r,i,a,s,l=this;l.LG()||(t=l.kj,n=l.rG.MG,o=t.getViewportLeftColumn(n),r=t.getViewportRightColumn(n),e?r<ge(t)-t.frozenTrailingColumnCount()-1?t.rq(t.Zq(o)):(i=t.Hr(n))&&i.length>0&&(a=t.am(),(s=i[i.length-1]).x+s.width>=a.pt+a.er&&t.rq(t.Zq(o))):o>pe(t)&&t.rq(t.br(o))),l.wG()},e.prototype.JG=function(){var e,t,n,o,r,i,a=this.kj,s=a.am(),l=he(a),u=a.frozenTrailingRowCount(),c=this.$F,f=this.rG,h=f.KG;if(0===h){if(c.y>s.qt)return a.mq(a._t()),f.KG=1,!0}else if(1===h){if((e=a.Gr(1))&&e.length>0){if(t=e[0],l>0&&c.y<s.qt&&t.row<=a._t())return f.KG=0,!0;if(t=e[e.length-1],u>0&&c.y>s.ot&&t.row>=a.ir()&&t.y+t.height<=s.ot)return f.KG=2,!0}}else if(2===h&&((e=a.Gr(1))&&e.length>0&&c.y<s.ot)){if((t=e[e.length-1]).y+t.height>s.ot){for(n=s.jr,r=0,i=o=de(a)-u-1;i>=l;i--)if((r+=a.Sl(i))>n){o=F(i+1,o);break}a.mq(a._q(o-1))}return f.KG=1,!0}return!1},e.prototype.LG=function(){var e,t,n,o,r,i,a=this.kj,s=a.frozenTrailingColumnCount(),l=pe(a),u=a.am(),c=this.$F,f=this.rG,h=f.MG;if(0===h){if(c.x>u.pt)return a.rq(a.$t()),f.MG=1,!0}else if(1===h){if((e=a.Hr(1))&&e.length>0){if(t=e[0],l>0&&c.x<u.pt&&t.col<=a.$t())return f.MG=0,!0;if(t=e[e.length-1],s>0&&c.x>u.lt&&t.col>=a.dr()&&t.x+t.width<=u.lt)return f.MG=2,!0}}else if(2===h&&((e=a.Hr(1))&&e.length>0&&c.x<u.lt)){if((t=e[e.length-1]).x+t.width>u.lt){for(n=u.er,r=0,i=o=ge(a)-s-1;i>=l;i--)if((r+=a.Tl(i))>n){o=F(i+1,o);break}a.rq(a.Zq(o-1))}return f.MG=1,!0}return!1},e.prototype.NG=function(){var e,t,n,o,r,i,a,s,l,u,f,h,p,d,g=this;(g._isWorking||g.O3||g.lV)&&(t=(e=g.kj).am(),o=(n=g.rG).KG,r=n.MG,i=g.$F,a=k,o>=0&&r>=0?(a=t.Ft(o,r),0===o&&e.lq===e.frozenRowCount()&&(s=t.Ft(1,r),a.height+=s.height),0===r&&e.qq===e.frozenColumnCount()&&(s=t.Ft(o,1),a.width+=s.width)):o>=0?a=t.fm(o):r>=0&&(a=t.gm(r)),a&&(u=(l=e.parent)&&l.options.scrollbarAppearance===c.ScrollbarAppearance.mobile,f=0,h=0,p=!1,d=!1,i.x<=a.x?(f=i.x-a.x,u&&(d=!0)):i.x>=a.x+a.width?(0===(f=i.x-(a.x+a.width))&&(f=50),u&&(d=!0)):u&&i.x===a.x+a.width-1&&(f=50,d=!0),i.y<=a.y?(h=i.y-a.y,u&&(p=!0)):i.y>=a.y+a.height&&(h=i.y-(a.y+a.height),u&&(p=!0)),l&&u&&(p&&(l.St.Jwa(c.ScrollbarState.show),l.ku.Rdc(!0)),d&&(l.Pt.Jwa(c.ScrollbarState.show),l.ku.Rdc(!1))),g._F().PG(g.QG(f)),g.aG().PG(g.QG(h))))},e.prototype.RG=function(){this._F().SG(),this.aG().SG()},e.prototype.fG=function(e){var t,n,o,r,i,a,l=this,u=s.yp.prototype,c=l.kj,f=e.resizeInfo;f.action===ee||f.action===X?(t=Ee(l,c.Jt,l.TG,u.findRow,e.row,f,!0),f.startY=t.y):(n=Ee(l,c.Kt,l.UG,u.findCol,e.col,f,!1),f.startX=n.x),o=c.parent,r=e.x,i=e.y,o&&((1!==(a=o.options.showResizeTip)||f.action!==te&&f.action!==ne)&&(2!==a||f.action!==ee&&f.action!==X)&&3!==a||(i-30<0?i+=15:i-=30,o.uw(l.VG(),r,i))),l.isResizing=!0,l._isWorking=!0,l.ctrl&&(l.fCb=!0)},e.prototype.WG=function(){var e,t,n,o=this,r=o.kj,i=r.yt,a=i.resizeInfo,s=o.$F,l=s.x,u=s.y,c=r.am(),f=r.parent,h=a.sheetArea;a&&o._isWorking&&o.isResizing&&(i.x===l&&i.y===u||(a.action===ee||a.action===X?function(e,t,n,o,r){var i,a=t.index,s=e.am();_e(e,t,r)?(i=e._q(a,n),De(t,o,s,!0,e.Sl(a,n)+e.Sl(i,n))):De(t,o,s,!0)}(r,a,h,u,o.fCb):function(e,t,n,o,r){var i,a=t.index,s=e.am();Oe(e,t,r)?(i=e.Zq(a,n),De(t,o,s,!1,e.Tl(a,n)+e.Tl(i,n))):De(t,o,s,!1)}(r,a,h,l,o.fCb),t=(e=r._render).bm(),e.Mx(c.x,c.y,c.width,c.height),e.Pw(t),f&&((1!==(n=f.options.showResizeTip)||a.action!==te&&a.action!==ne)&&(2!==n||a.action!==ee&&a.action!==X)&&3!==n||f.ww(o.XG(a)))))},e.prototype.YG=function(){var e,t,n,o,r,i,a,s,u,c,f,h,p=this;p.isResizing=!1,p._isWorking=!1,e=!0,n=(t=p.kj).yt,(o=n.resizeInfo)&&(p.xw(),o.action===ee||o.action===X?C(o.movingY)?e=!1:(r=_(0,(o.movingY-o.startY)/t.zoom()),i=[],a="resizeRow",t.tp(o.index)?l.GC$.each(t._modelManager.getSelections(),(function(e,n){if(-1===n.col)if(1===o.sheetArea)i.push({firstRow:o.index,lastRow:o.index});else{var r=t.Tq(n);i.push({firstRow:r.row,lastRow:r.row+Ne(r)-1})}})):i.push({firstRow:o.index,lastRow:o.index}),function(e,t,n,o){return _e(e,t,o)&&1===n.length&&n[0].firstRow===n[0].lastRow}(t,o,i,p.fCb)&&(a="splitResizeRow"),s=1===o.sheetArea,t.wu().execute({cmd:a,sheetName:t.name(),rows:i,size:r,columnHeader:s})):C(o.movingX)?e=!1:(r=_(0,(o.movingX-o.startX)/t.zoom()),u=[],c="resizeColumn",t.sp(o.index)?l.GC$.each(t._modelManager.getSelections(),(function(e,n){if(-1===n.row){var r=t.Tq(n);2===o.sheetArea?u.push({firstCol:o.index,lastCol:o.index}):u.push({firstCol:r.col,lastCol:r.col+Te(r)-1})}})):u.push({firstCol:o.index,lastCol:o.index}),function(e,t,n,o){return Oe(e,t,o)&&1===n.length&&n[0].firstColumn===n[0].lastColumn}(t,o,u,p.fCb)&&(c="splitResizeColumn"),f=2===o.sheetArea,t.wu().execute({cmd:c,sheetName:t.name(),columns:u,size:r,rowHeader:f})),(h=t.hitTest(p.$F.x,p.$F.y))&&p.Tw(h),e||t.repaint(),p.fCb=!1)},e.prototype.ZG=function(e,t){var n,o,r,i,a,s,l=0,u=0,c=0,f=0,h=this,p=h.kj,d=p.wq,g=he(p),m=pe(p),y=ve(e);if(h.o4=h.$G=p._modelManager.getSelections(),p.isCtrlPressed(y)||h.shift||p.Tr(),0===y){if(!h.shift&&ke(h,n=g?p.ar():p.lq,m?p.$q():p.qq,1,1,t))return;p.isCtrlPressed(y)||p.Tr(),p.Ur(-1,-1,de(p),ge(p),!0)}else if(1===y){if(!h.shift&&(n=g?p.ar():p.lq,o=h._G(n,e.col,!1),ke(h,o.row,o.col,1,ye(e),t)))return;h.shift||p.n_a?(l=F(p.Kl,e.col),f=P(p.Kl-e.col)+1,p.Kx(-1,l,de(p),f,!0)):p.Ur(-1,p.Kl,de(p),1,!0)}else if(2===y){if(!h.shift){if(i=m?p.$q():p.qq,o=h._G(e.row,i,!0),r=p.Jl!==o.row,ke(h,o.row,o.col,me(e),1,t))return;r&&d&&d.Lx()}h.shift||p.n_a?(u=F(p.Jl,e.row),c=P(p.Jl-e.row)+1,p.Kx(u,-1,c,ge(p),!0)):p.Ur(p.Jl,-1,1,ge(p),!0)}else if(3===y)if(D(e.row)||D(e.col))ce(p)&&(s=p.getCellRect(p.Jl,p.Kl,p.Nr,p.Pr),p._render.VF(s.x,s.y,s.width,s.height));else{if(!h.shift&&(p.Jl!==e.row||p.Kl!==e.col)){if(r=p.Jl!==e.row,ke(h,e.row,e.col,me(e),ye(e),t))return;r&&d&&d.Lx()}h.shift?p.aH(e.row,e.col,!0):(a=p._modelManager.getSpan(e.row,e.col),p.n_a||p.Ur(a.row,a.col,Ne(a),Te(a),!0))}},e.prototype.bH=function(e){if(e&&(3!==ve(e)||!D(e.row)&&!D(e.col))){var t=this;t._isWorking=!0,t.xG=!0,t.rG={KG:me(e),MG:ye(e),sG:ve(e)},t.qG()}},e.prototype.ayb=function(e,t){var n=this.kj,o=n.getSpan(e,t),r=e,i=t,a=1,s=1,l=n.selectionUnit(),c=!1;return 1===l?(i=-1,s=-1,r=o?o.row:r,a=o?o.rowCount:a):2===l?(r=-1,a=-1,i=o?o.col:i,s=o?o.colCount:s):c=!0,o&&c?o:new u.Range(r,i,a,s)},e.prototype.nG=function(e,t){var n=this,o=n.kj,r=e.row,i=e.col;o.n_a=n.I0a(r,i,t,ve(e))&&o.parent.options.allowUserDeselect,o.n_a&&(o.s_a=o.Jl,o.t_a=o.Kl,o.p_a=n.ayb(r,i)),n.ZG(e),n.bH(e)},e.prototype.I0a=function(e,t,n,o){var r=this.kj;return this.o_a(e,t,n,o)&&2===r.selectionPolicy()},e.prototype.o_a=function(e,t,n,o){var r,i,a,s=this.kj,l=s.getRowCount(),u=s.getColumnCount();if(!s.isCtrlPressed(o))return!1;for(r=!1,i=n.length,a=0;a<i;a++)if(3===o){if(n[a].contains(e,t,1,1)){r=!0;break}}else if(2===o){if(n[a].contains(e,-1,1,u)||n[a].contains(e,0,1,u)){r=!0;break}}else if(1===o&&(n[a].contains(-1,t,l,1)||n[a].contains(0,t,l,1))){r=!0;break}return r},e.prototype.yG=function(){var e,t=this;t.rG&&t._isWorking&&!0!==t.DA&&(3===(e=t.rG.sG)?t.cH():2===e?t.dH():1===e&&t.eH())},e.prototype.cH=function(){var e,t,n,o,r=this,i=r.kj,a=r.fH(),s=r.gH();if(a>=0&&s>=0&&i.Qs(a,s)){if(r.NG(),1===(e=i._modelManager.getSelections()).length&&(t=i.Jx(a,s,i.Jl,i.Kl),n=e[0],!i.n_a&&t.equals(n)))return;i.aH(a,s,!0),o=i._modelManager.getSelections(),i.yu(e,o)}},e.prototype.dH=function(){var e,t,n,o,r,i=this,a=i.kj,s=i.fH(!0);if(s>=0&&a.Qs(s,-1)){if(e=F(a.Jl,s),t=_(a.Jl,s)-e+1,-1,n=ge(a),0===a.selectionPolicy())return;2===a.selectionUnit()&&(e=-1,t=-1),o=a._modelManager.getSelections(),a.Kx(e,-1,t,n,!0),r=a._modelManager.getSelections(),a.yu(o,r)}i.NG()},e.prototype.eH=function(){var e,t,n,o,r,i=this,a=i.kj,s=i.gH(!0);if(s>=0&&a.Qs(-1,s)){if(e=F(a.Kl,s),t=_(a.Kl,s)-e+1,-1,n=de(a),0===a.selectionPolicy())return;1===a.selectionUnit()&&(e=-1,t=-1),o=a._modelManager.getSelections(),a.Kx(-1,e,n,t,!0),r=a._modelManager.getSelections(),a.yu(o,r)}i.NG()},e.prototype.hH=function(){var e,t,n,o,r=this;r.rG=k,r.RG(),r.DA=k,r._isWorking=!1,r.xG=!1,0!==(e=r.kj)._modelManager.getSelections().length&&(e.n_a&&(e.n_a=!1,t=e.p_a,e.p_a=null,e.u_a(e._modelManager.getSelections(),t),delete e.s_a,delete e.t_a),e.Uja?delete e.Uja:((n=!r.$G)||(o=e._modelManager.getSelections(),n=r.zu(r.$G,o)),n&&e.Au(r.o4)),r.$G=e._modelManager.getSelections())},e.prototype.iH=function(){var e=this.kj,t=function(e,t){var n=e.am();return he(e)>0&&t<n.nt+n.fs?0:e.frozenTrailingRowCount()>0&&t>n.ot?2:1}(e,this.$F.y),n=this.rG.KG,o=e.Gr(1);return(0===t&&n>0&&o.length>0&&o[0].row>e._t()||2===t&&n<2&&o.length>0&&o[o.length-1].row<e.ir())&&(t=1),t},e.prototype.jH=function(){var e=this.kj,t=function(e,t){var n=e.am();return pe(e)>0&&t<n.kt+n.hs?0:e.frozenTrailingColumnCount()>0&&t>n.lt?2:1}(e,this.$F.x),n=this.rG.MG,o=e.Hr(1);return(0===t&&n>0&&o.length>0&&o[0].col>e.$t()||2===t&&n<2&&o.length>0&&o[o.length-1].col<e.dr())&&(t=1),t},e.prototype.fH=function(e){var t,n,o,r=this.kj,i=this.$F.y,a=this.iH(),s=function(e,t,n){var o=e.Gr(t);return o?o.findNearY(n):k}(r,a,i);if(s){if(t=r.am(),n=s.row,1===a&&i<t.qt){if(n>(o=r._t()))return r._q(n-1)||n;if(n===o&&e)return 0}else if(0===a&&i<t.nt&&e)return 0;return 1===a&&i>t.ot&&n>r.hr()&&r.gr(n)||n}return-1},e.prototype.gH=function(e){var t,n,o,r=this.kj,i=this.$F.x,a=this.jH(),s=function(e,t,n){var o=e.Hr(t);return o?o.findNearX(n):k}(r,a,i);if(s){if(t=r.am(),n=s.col,1===a&&i<t.pt){if(n>(o=r.$t()))return r.Zq(n-1)||n;if(n===o&&e)return 0}else if(0===a&&i<t.kt&&e)return 0;return 1===a&&i>t.lt&&n>r.cr()&&r.br(n)||n}return-1},e.prototype.QG=function(e){var t,n=0;return D(e)||0===e||(t=e<0,n=H(500/P(e)),(n=_(20,10*n))>200&&(n=200),t&&(n=-n)),n},e.prototype.TG=function(e,t){var n=this.kj.gr(e,t);return n!==k?n:e},e.prototype.UG=function(e,t){var n=this.kj.br(e,t);return n!==k?n:e},e.prototype.kH=function(e,t,n){for(var o=this.kj;e>t;)if(e--,o.getRowVisible(e,n))return e;return e},e.prototype.lH=function(e,t,n){for(var o=this.kj;e>t;)if(e--,o.getColumnVisible(e,n))return e;return e},e.prototype.mH=function(e,t,n,o,r){var i,s,l,u,c,f,h,p=k;return function(e){return!e.options.isProtected||e.options.protectionOptions.allowResizeRows}(e)?(i=this,!(s=e.Gr(me(t),o))||D(t.row)||D(t.col)||(e.getRowVisible(t.row,o)||(t.row=this.TG(t.row,o)),(l=s.findRow(t.row))&&(l.y+l.height-n<=r&&r<=l.y+l.height+n?(p=Ie(ee,t.row,o),(u=s[s.length-1].row)>=0&&(c=e.ir(o),p.index===c&&p.index!==u&&l.y+l.height-n/2<=r&&(p=Ie(i.nH(e,u,o),u,o)))):l.y-n<=r&&r<=l.y+n&&a.Common.k.Cb(s,l)>0&&(f=i.kH(t.row,0,o),p=Ie(i.nH(e,f,o),f,o))),!p&&1===me(t)&&s.length>0&&(l=s[0],_(0,l.y-n)<=r&&r<=l.y+n&&((h=Fe(e,t.row,!0))>=0&&(p=Ie(i.nH(e,h,o),h,o))))),p&&!e.getRowResizable(p.index,o)&&(p=k),p):p},e.prototype.nH=function(e,t,n){var o=e.parent;return o&&1===o.options.resizeZeroIndicator&&e.getRowVisible(t)&&0===e.Yr(t,n)?X:ee},e.prototype.oH=function(e,t,n,o,r){var i,s,l,u,c,f,h,p=k;return function(e){return!e.options.isProtected||e.options.protectionOptions.allowResizeColumns}(e)?(i=this,!(s=e.Hr(ye(t),o))||D(t.col)||D(t.row)||(e.getColumnVisible(t.col,o)||(t.col=this.UG(t.col,o)),(l=s.findCol(t.col))&&(l.x+l.width-n<=r&&r<=l.x+l.width+n?(p=Ie(te,t.col,o),(u=s[s.length-1].col)>=0&&(c=e.dr(o),p.index===c&&p.index!==u&&l.x+l.width-n/2<=r&&(p=Ie(i.pH(e,u,o),u,o)))):l.x-n<=r&&r<=l.x+n&&a.Common.k.Cb(s,l)>0&&(f=i.lH(t.col,0,o),p=Ie(i.pH(e,f,o),f,o))),!p&&1===ye(t)&&s.length>0&&(l=s[0],_(0,l.x-n)<=r&&r<=l.x+n&&((h=Fe(e,t.col,!1))>=0&&(p=Ie(i.pH(e,h,o),h,o))))),p&&!e.getColumnResizable(p.index,o)&&(p=k),p):p},e.prototype.pH=function(e,t,n){var o=e.parent;return o&&1===o.options.resizeZeroIndicator&&e.getColumnVisible(t)&&0===e.$r(t,n)?ne:te},e.prototype.ur=function(e,t,n,o){var r,i,a,s,l,u,c,f=this,h=f.kj,p=h.parent,d=h.options,g=d.colHeaderVisible,m=d.rowHeaderVisible,y=k;return p&&!p.options.allowUserResize||(a=h.am(),me(e)<0&&ye(e)>=0&&g?(y=f.oH(h,e,o,1,t))||(y=f.mH(h,e,o,1,n)):me(e)>=0&&ye(e)<0&&m?(y=f.mH(h,e,o,2,n))||(y=f.oH(h,e,o,2,t)):me(e)<0&&ye(e)<0?h.ir(2)===k&&P(n-a.Cr)<=o?(s=h.Gr(1))&&s.length>0&&((r=s[s.length-1].row)>=0&&h.getRowResizable(r,2)&&(y=Ie(f.nH(h,r,2),r,2))):h.dr(1)===k&&P(t-a.Br)<=o&&((l=h.Hr(1))&&l.length>0&&((i=l[l.length-1].col)>=0&&h.getColumnResizable(i,1)&&(y=Ie(f.pH(h,i,1),i,1)))):me(e)>=0&&ye(e)>=0&&(r=de(h,1)-1,i=ge(h,2)-1,u=h.options.sheetAreaOffset.top,c=h.options.sheetAreaOffset.left,r>=0&&0===a.Cr&&u<=n&&n<=o+u&&g?y=Ie(f.nH(h,r,1),r,1):i>=0&&0===a.Br&&c<=t&&t<=o+c&&m&&(y=Ie(f.pH(h,i,2),i,2)))),y},e.prototype.qH=function(e,t,n,o){var r,i,a,s,l=this.kj,u=l.am().Ft(1,1);if(1===t)if((r=l.Hr(t))&&r.length>0){if((i=r[r.length-1]).x+i.width<=n&&n<u.x+u.width)return!0}else if(u.contains(n,o))return!0;if(1===e)if((a=l.Gr(e))&&a.length>0){if((s=a[a.length-1]).y+s.height<=o&&o<u.y+u.height)return!0}else if(u.contains(n,o))return!0;return!1},e.prototype.BD=function(e){var t=this.Vs();this.sH(e,e.pageX-t.left,e.pageY-t.top)},e.prototype.DD=function(){var e,t,n,o,r,i=this.kj,a=i.yt;a&&((e=a.cellTypeHitInfo)&&i.getCellType(e.row,e.col,ve(a)).ZBb(e)),this._isWorking||(t={x:-1e4,y:-1e4,rowViewportIndex:k,colViewportIndex:k,row:-1,col:-1,resizeInfo:k,hitTestType:k},this.Uw(t),a&&(n=a.row,o=a.col,r=i.getActualStyle(n,o),i.parent&&r&&r.showEllipsis&&i.parent.xw()))},e.prototype.sH=function(e,t,n){var o,r,i,a,s,l,c,f,h,p,d,g=this;return g.$F={e:e,x:t,y:n},o=g.kj,g.eG&&!u.Vl.Wl(o)&&u.Vl.Zl(o),g.eG&&g._isWorking?void(g.isResizing?g.WG():g.$ia?g._ia&&g._ia():g.zG?g.AG&&g.AG():g.BG?g.CG&&g.CG():g.DG?g.EG():g.FG?g.GG():g.HG?g.IG():g.qIb?g.rIb&&g.rIb():g.xG&&g.yG()):(r=o.hitTest(t,n),g.sIb(o,r,g),void(r&&(0===g.mIb&&r.tableSelectInfo&&g.eG&&g.tIb(o,g,r),i=o.parent,a=r.row,s=r.col,l=o.sr(r.rowViewportIndex,r.colViewportIndex),i&&(c=o._modelManager.uIb(a,s,l),f=o.getActualStyle(a,s,l),c&&!1!==f.THb&&l?(h=o.getCellRect(a,s,r.rowViewportIndex,r.colViewportIndex),i.uw(c,h.x+h.width+5,h.y+h.height+5)):(p=i.options.showScrollTip&&(i.St.JB||i.Pt.JB),p||i.xw())),g.Tw(r),i&&i.options.enableAccessibility&&(d=o.cgc(r),i.dgc(d)),g.Uw(r))))},e.prototype.sIb=function(e,t,n){var o,r,i,a,s;1===n.mIb?(o=n.vIb.row,r=n.vIb.col,i=t.col,a=e.getSelections()[0],e.Kx(o,r>i?i:r,a.rowCount,r-i>0?r-i+1:i-r+1,!0)):2===n.mIb&&(o=n.vIb.row,r=n.vIb.col,s=t.row,a=e.getSelections()[0],e.Kx(o>s?s:o,r,o-s>0?o-s+1:s-o+1,a.colCount,!0))},e.prototype.tIb=function(e,t,n){var o,r=e.getActiveRowIndex(),i=e.getActiveColumnIndex();t.vIb={row:r,col:i},"tableColSelect"===(o=n.tableSelectInfo.action)?t.mIb=1:"tableRowSelect"===o&&(t.mIb=2)},e.prototype.Tw=function(e){var t,n,o,r,i,a,s,l,c,f,h,p,d,g,m,y,v=this,b=v.kj,C=b.Ws();C&&(o=!(t=b.yt)||e.row!==t.row||e.col!==t.col||ve(e)!==ve(t)||e.resizeInfo&&!t.resizeInfo||!e.resizeInfo&&t.resizeInfo||e.resizeInfo&&e.resizeInfo.action!==t.resizeInfo.action||e.dragInfo&&!t.dragInfo||!e.dragInfo&&t.dragInfo||e.dragInfo&&e.dragInfo.action!==t.dragInfo.action||e.resizeTableHitInfo&&!t.resizeTableHitInfo,t&&o&&((r=t.cellTypeHitInfo)&&(n=b.getCellType(r.row,r.col,ve(t))).ZBb(r)),i=e.resizeInfo,a=e.dragMergeInfo,s=e.dragInfo,l=e.formulaRangeHitInfo,c=e.cellTypeHitInfo,f=b._render,h=e.resizeTableHitInfo,(p=e.tableSelectInfo)?"tableRowSelect"===p.action?C.style.cursor="url(data:image/ico;base64,AAABAAEACAgAAAEAIABIAQAAFgAAACgAAAAIAAAAEAAAAAEAIAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAATQAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAACtAAAAkAAAAAsAAAAAAAAAeAAAAHkAAAB5AAAAewAAANcAAAD9AAAAjAAAAA0AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD5AAAAngAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAPkAAACeAAAAeAAAAHkAAAB5AAAAewAAANcAAAD9AAAAjAAAAA0AAAAAAAAAAAAAAAAAAAAFAAAArQAAAJAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAUAAABNAAAAEQAAAAAAAAAA4wAAAOEAAAAAAAAAAAAAAAAAAAAAAAAA4QAAAOMAAAA=) 8 4,auto":"tableColSelect"===p.action?C.style.cursor="url(data:image/ico;base64,AAABAAEACAgAAAEAIABIAQAAFgAAACgAAAAIAAAAEAAAAAEAIAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAACKAAAAigAAAAgAAAAAAAAAAAAAAAAAAAAHAAAAfAAAAPYAAAD2AAAAewAAAAcAAAAAAAAACAAAAHwAAAD3AAAA/wAAAP8AAAD3AAAAfAAAAAgAAAAVAAAAVwAAAJ8AAAD/AAAA/wAAAJ4AAABXAAAAFQAAAAAAAAAAAAAAYAAAAP8AAAD/AAAAYAAAAAAAAAAAAAAAAAAAAAAAAABgAAAA/wAAAP8AAABgAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAD/AAAA/wAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAXwAAAPwAAAD8AAAAXwAAAAAAAAAAwwAAAIEAAAAAAAAAAAAAAMMAAADDAAAAwwAAAMMAAAA=) 8 4,auto":"tableCornerSelect"===p.action?C.style.cursor="url(data:image/ico;base64,AAABAAEACgoAAAEAIADgAQAAFgAAACgAAAAKAAAAFAAAAAEAIAAAAAAAkAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAACTAAAA/QAAAP8AAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAEwAAAJ8AAAD8AAAA/wAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAoAAAA3AAAAP8AAAD/AAAA/wAAAP8AAAAAAAAAAAAAAAAAAAATAAAAngAAAPwAAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAASAAAAnwAAAP0AAAD/AAAA+gAAANwAAAD6AAAA/wAAAAAAAAASAAAAnwAAAP0AAAD/AAAA/QAAAJ4AAAAlAAAAnwAAAP0AAAAVAAAAngAAAP0AAAD/AAAA/QAAAJ8AAAASAAAAAAAAABQAAACTAAAApwAAAP0AAAD/AAAA/QAAAJ8AAAASAAAAAAAAAAAAAAAAAAAACgAAAG0AAADqAAAA/gAAAJ4AAAASAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAbQAAAKgAAAAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAOAAAADwAAAA4AAAAMAAAACAAAAAAQAAAAOAAAAHwAAAD8AAAA==) 10 5,auto":"tableSelect"===p.action?C.style.cursor="move":"default"===p.action&&(C.style.cursor=""):i?i.action===te?C.style.cursor=u.CursorResource.ResizeCol:i.action===ee?C.style.cursor=u.CursorResource.ResizeRow:i.action===ne?C.style.cursor=u.CursorResource.ResizeHiddenCol:i.action===X?C.style.cursor=u.CursorResource.ResizeHiddenRow:C.style.cursor=oe:a?a.left||a.right?C.style.cursor="w-resize":(a.top||a.bottom)&&(C.style.cursor="n-resize"):s&&"drag"===s.action?s.side===$?C.style.cursor="crosshair":s.side?C.style.cursor="move":C.style.cursor=oe:l?(l.inBorder?C.style.cursor="move":l.inTopLeft?C.style.cursor="nw-resize":l.inTopRight?C.style.cursor="ne-resize":l.inBottomLeft?C.style.cursor="sw-resize":l.inBottomRight&&(C.style.cursor="se-resize"),d=v.isFormulaRangeHoving,m=(g=v.tH)&&g.paramRange,y=l.paramRange,v.isFormulaRangeHoving=!0,v.tH={paramRange:y},d&&y.index===m.index||f._paintFormulaTextBox()):h?C.style.cursor="se-resize":(c&&(n=b.getCellType(c.row,c.col,ve(e)),c.sheet=b,o&&n.processMouseEnter(c),n.YBb(c)),!o&&c&&c.isReservedLocation||(C.style.cursor=oe),v.isFormulaRangeHoving&&(v.isFormulaRangeHoving=!1,v.tH=k,f._paintFormulaTextBox())))},e.prototype.CD=function(e){var t=this,n=t.kj;return t.uC(),!n.dG||(n.dG=!1,t.vH(e),!1)},e.prototype.vH=function(e){var t,n,o,r=this,a=r.kj,s=u.Vl.Xl();r.eG=!1,r.mIb=0,s&&s!==a&&s.endEdit&&(i&&i._legacyWynbi&&i._legacyWynbi.spreadChartEditState&&i._legacyWynbi.spreadChartEditState.enableReferenceCrossSpread||s._formulaTextBox&&s._formulaTextBox._isSelectMode||(s.endEdit(),s.repaint())),u.Vl.Zl(a),r.isResizing?r.YG():r.$ia?r.aja&&r.aja():r.zG?r.wH&&r.wH():r.BG?r.xH&&r.xH():r.DG?r.yH():r.FG?r.zH():r.HG?r.AH():r.qIb?r.wIb&&r.wIb():a.yt&&(n=(t=a.yt).cellTypeHitInfo,!t.filterButtonHitInfo&&!t.resizeInfo&&t.row>=0&&t.col>=0&&(n&&(o=a.getCellType(n.row,n.col,ve(t)),n.sheet||(n.sheet=a),o.XGb(n)),n&&n.isReservedLocation||a.Wq(u.Events.CellClick,Re(a,a.name(),t.row,t.col,ve(t))),r.hH(),a.sgc&&a.tgc&&a.tgc())),r.lG(e)},e.prototype._startEdit=function(e,t,n){var o,r=this.kj;r.isEditing&&r===u.Vl.Xl()&&(o=r.Ws(),Ae(e)||xe(e)||r.FF(o,t,n))},e.prototype.nm=function(e){var t,n,o,r,i,a,s,l,c,f,h,p,d=this,g=d.kj;if(g){if(t=be(g),n=Ce(g),o=g.getCellType(t,n),r={isEditing:ce(g),sheet:g,row:t,col:n,sheetArea:3},i={sheet:g,row:t,col:n,sheetArea:3},o&&o.isReservedKey(e,r))return void(ce(g)||o.processKeyDown(e,i));if((a=g._formulaTextBox)&&a.BH(e))return;if((s=g.parent&&g.parent.CF)&&s.BH(e,r))return}if(l=!(ce(g)||xe(e)||Se(e)||34!==we(e)&&33!==we(e)&&37!==we(e)&&39!==we(e)&&9!==we(e)&&13!==we(e)&&38!==we(e)&&40!==we(e)),g.CH&&(g.CH=!1,g._render.DH()),h=13===(f=we(e)),p=27===f,g.sgc&&g.ugc&&(h||p)?g.ugc(p):c=d.EH(e),l&&c&&u.Vl.Wl(g)){if(d.Uoa=new Date,d.FH)return d.GH<25&&d.GH++,void m(e);d.FH=!0,d.GH=1,d.HH(e,!0)}},e.prototype.VG=function(){var e,t,n=this.kj,o=n.yt.resizeInfo;return o.action===ee||o.action===X?(e=n.getRowHeight(o.index),v(ae().Tip_Height,[e])):(t=n.getColumnWidth(o.index),v(ae().Tip_Width,[t]))},e.prototype.XG=function(e){var t=this.kj;return e.action===ee||e.action===X?v(ae().Tip_Height,[_(0,O((e.movingY-e.startY)/t.zoom()))]):v(ae().Tip_Width,[_(0,O((e.movingX-e.startX)/t.zoom()))])},e.prototype.HH=function(e,t){var n=this;if(n.FH){if(new Date-n.Uoa>100)return void n.Ux();t||n.EH(e),n.FH&&(n.WF=f.setTimeout((function(){n.HH(e)}),500/n.GH))}},e.prototype.IH=function(e,t){var n,o,r,i=this.kj,a=i.Ws();if(a){i.HF=!0;try{n=ce(i),i.EF&&i.EF(a,i.Jl,i.Kl,k,k,!0,k,t,e),!n&&ce(i)&&(!(o=i.getCellType(i.Jl,i.Kl)).tw||32!==we(e)||xe(e)||Ae(e)||Me(e)||o.tw(i,i.Jl,i.Kl,3),o.JH&&o.JH(e))}finally{i.HF=!1,(r=i.tu()).UHb&&delete r.UHb}}},e.prototype.EH=function(e){var t,n,o,i,a,s,u,c,h,p,d=this,g=d.kj;if(d.lG(e),ce(g)||27!==we(e)||Me(e)||xe(e)||Ae(e)||!g.KH||(l.GC$(g.KH).remove(),g.KH=k),t=g.tu(),ce(g)||27!==we(e)||Me(e)||xe(e)||Ae(e)||!t.UHb||delete t.UHb,ce(g)||34!==we(e)&&33!==we(e)&&35!==we(e)&&36!==we(e)&&38!==we(e)&&40!==we(e)||m(e),ce(g)||37!==we(e)&&39!==we(e)||m(e),ce(g)&&xe(e)&&(89===we(e)||90===we(e)))return m(e),!1;if(o=(n=g.wu()).getShortcutKey(we(e),xe(e),Ae(e),Me(e),Se(e)),i=n.getCommands(o))for(a=0;a<i.length;a++)if(s={sheetName:g.name()},(u=i[a].execute(g.parent,s))||s.vgc)return u.ignoreCancelDefault||m(e),!0;return c={e:e,r:k},r.Worksheet.ao(g,"processKeyDown",c),!!c.r||(d.LH(e)&&((h=g._formulaTextBox)&&h.MH&&h._stopAppending(),ce(g)||((p=f.Yl.Bm(e.target))&&"gcAttachedFormulaTextBox"===p.getAttribute(K)||d.IH(e))),!1)},e.prototype.Ux=function(){var e=this;e.FH=!1,e.WF>0&&(clearTimeout(e.WF),e.WF=0)},e.prototype.om=function(e){var t,n,o,r,i,a,s,l,u=this;if(u.Ux(),t=u.kj){if(n=be(t),o=Ce(t),r=t.getCellType(n,o),i={isEditing:ce(t),sheet:t,row:n,col:o,sheetArea:3},a={sheet:t,row:n,col:o,sheetArea:3},r&&r.isReservedKey(e,i))return void(ce(t)||r.processKeyUp(e,a));if((s=t._formulaTextBox)&&s.BH(e))return;if((l=t.parent&&t.parent.CF)&&l.BH(e))return}u.lG(e)},e.prototype.pm=function(e){this.IH(e,!0)},e.prototype.LH=function(e){return!(xe(e)||Me(e)||Se(e))&&(we(e)>=65&&we(e)<=90||we(e)>=48&&we(e)<=57||we(e)>=96&&we(e)<=105||we(e)>=186&&we(e)<=192||we(e)>=220&&we(e)<=222||219===we(e)||we(e)>=106&&we(e)<=111||32===we(e)||61===we(e)||173===we(e)||229===we(e)||0===we(e)||8===we(e))},e.prototype.lG=function(e){var t,n,o,r,i,a=this,s=a.kj,l=u.Ul.sl()?Se(e):xe(e);a.ctrl=l&&!Ae(e),a.shift=Ae(e)&&!l,s.Hx=!1,9===we(e)&&((t=s._modelManager.getSelections().length)>1?s.Hx=!0:(n=s._getActiveSelectedRange())&&t>0&&(s.Hx=!(s.Jl===n.row&&s.Kl===n.col&&s.Lr>=Ne(n)&&s.Mr>=Te(n)))),!0===a.zG&&(o=s._getActiveSelectedRange(),r=a.OH,i=a.PH,-1===o.row||-1===o.col?a.OH=Ae(e):a.OH=!1,a.PH=l,r===a.OH&&i===a.PH||s._render.QH&&s._render.QH()),a.RH=l},e.prototype.Vx=function(){var e=this;e.shift=!1,e.ctrl=!1,e.kj.Hx=!1,e.zG=!1,e.OH=!1,e.PH=!1,e.RH=!1},e.prototype._updateEditingEditor=function(e){var t,n,o,r,i,a,s,u,c,f,h,p;e&&e.sheet?(t=e.sheet,n=e.editor,o=e.canvasOffset):n=(t=this.kj)._editor,ce(t)&&(r=t.Jl,i=t.Kl,a=t.getCellType(r,i),s=t.am(),u=t.getActualStyle(r,i),c=t.getCellRect(r,i),n&&n.parentNode&&(f=n.parentNode.parentNode,c&&c.width>0&&c.height>0&&c.x>=s.kt&&c.y>=s.nt&&c.x+c.width<=s.lt+s.js&&c.y+c.height<=s.ot+s.gs?(h={sheet:t,row:r,col:i,sheetArea:3,canvasOffset:o},a._updateEditorWrapper(f,u,c,h,!0)):l.GC$(f).css({top:-1e4,left:-1e4})),(p=t._formulaTextBox)&&p._position())},e.prototype.TH=function(e,t){var n,o;if(!e)return k;for(n=e.firstChild;n;){if(n.id===t||n.name===t)return n;if(o=this.TH(n,t))return o;n=n.nextSibling}return k},e.prototype.zu=function(e,t){var n,o,r,i=!0;if(e.length===t.length)for(n=0;n<e.length;n++){if(o=e[n],r=t[n],o.row!==r.row||o.col!==r.col||Ne(o)!==Ne(r)||Te(o)!==Te(r)){i=!0;break}i=!1}return i},e.prototype.UH=function(e,t,n,o){var r,i,a,s,u,c,f=this,h=f.kj,p={sheet:h,row:t,col:n,sheetArea:3},g=h.zo(),m=e.isImeAware(p),v=re?z:"fixed";return o&&f.VH(),m&&!f.GF&&(i=(r=e._createCellTypeElement(p)).style,f.WH||(f.WH={overflow:"visible",border:Q,position:z}),f.WH.overflow=i.overflow,f.WH.border=i.border,f.WH.position=i.position,l.GC$(r).css([L,G,W,U,Z,q,V],[v,J,"0px","0px","0px","0px",Q]),h.KF&&r.firstChild&&(a=r.firstChild.firstChild,h.KF(e,a,t,n,h.getActualStyle(t,n)),s=e.getEditorValue(a,p),d.safari&&(""===s||C(s))&&e.setEditorValue(a," ",p)),g&&g.insertBefore(r,k),f.GF=r),f.XH||(r=y("div"),l.GC$(r).css([L,G,W,U,Z,q],[v,J,"0px","0px","0px","0px"]),f.XH=r,u=y("textarea"),l.GC$(u).attr(K,"gcSheetFocusInput").attr(Y,-1).css([L,G,V,"resize"],[z,J,Q,Q]),u.value=" ",r.insertBefore(u,k),f.YH=u,c=y("div"),l.GC$(c).css(L,z).css(G,J).attr(K,"gcSheetFocusInput").attr(Y,-1),r.insertBefore(c,k),f.ZH=c,g&&g.insertBefore(r,k)),re&&(f.GF&&f.$H(h,f.GF),f.$H(h,f.XH)),m?f.GF:f.YH},e.prototype.JF=function(){var e=this;e.GF&&e.WH&&l.GC$(e.GF).css(G,e.WH.overflow).css(V,e.WH.border).css(L,e.WH.position)},e.prototype.VH=function(){var e=this;e.GF&&(e.GF.parentElement&&e.GF.parentElement.removeChild(e.GF),e.GF.comboBox&&(e.GF.comboBox=k),e.GF=k)},e.prototype.zt=function(e){u.Vl.Wl(this.kj)||this._H(!0,!0,e)},e.prototype.Cm=function(){var e=this.ZH;e&&e.focus()},e.prototype.Qq=function(){this._H(!0,!0)},e.prototype.aI=function(){this.bI&&(clearTimeout(this.bI),this.bI=k)},e.prototype._H=function(e,t,n){var o,r,i,a,s,l,c,p,m,y,v,b;0===arguments.length&&(e=!0),(o=this).Gma||(o.XF=!1,o.aI(),r=o.kj,i=be(r),a=Ce(r),s=r.getCellType(i,a),o.UH(s,i,a,t),l={sheet:r,row:i,col:a,sheetArea:3},c=s.isImeAware(l)&&o.GF.firstChild?o.GF.firstChild.firstChild:o.YH,p=c,t&&!d.msie&&s.setImeMode(p,r.getActualStyle(i,a).imeMode,l),h.body.focus(),m=function(){t&&d.msie&&s.setImeMode(p,r.getActualStyle(i,a).imeMode,l),function(){try{s.isImeAware(l)?(s.focus(p,l),s.selectAll(p,l)):(c.focus(),c.select())}catch(e){}}()},y=g,v=d.metroMode||y.ipad||y.iphone||y.android,!r.CH&&!v||!e&&s.isImeAware(l)?!1===r._enhanceIme||n||m():!ce(r)&&v?t&&(b=o.GF&&o.GF.firstChild&&o.GF.firstChild.firstChild,s.setImeMode(b,r.getActualStyle(i,a).imeMode,l)):o.bI=f.setTimeout((function(){o.aI(),ce(r)||!1===r._enhanceIme||n||m()}),200),u.Vl.Wl(r)||u.Vl.Zl(r),o.byb(r)||o.cs&&o.cs(r.Jl,r.Kl))},e.prototype.$H=function(e,t){var n,o,r,i,a,s,u,c=be(e),h=Ce(e),p=e.Nr,d=e.Pr,g=e.getCellRect(c,h,p,d),m=this,y=e.Vs(),v=m.bG(),b=m.GF,C=0,w=0,x=0,A=0;b&&(r=l.GC$(b),C=parseInt(r.css(W),10),w=parseInt(r.css(U),10),x=parseInt(r.css(q),10),A=parseInt(r.css(Z),10)),m.oG(g)?(n=C,o=w):(n=g.y+v.top-2,o=g.x+v.left-2),i=f.pageYOffset-y.top+v.top,a=f.innerHeight+i-x,s=f.pageXOffset-y.left+v.left,u=f.innerWidth+s-A,(D(n)||n<i||n>a)&&(n=i),(D(o)||o<s||o>u)&&(o=s),l.GC$(t).css(W,n).css(U,o)},e.prototype.cI=function(e){var t,n,o,r,i=this;i.aI(),ce(i.kj)||i.XF&&h.activeElement===i.ZH||(t=i.kj,e?(n=e.row,o=e.col):(n=t.Jl,o=t.Kl),r=t.getCellType(n,o),i.UH(r,n,o,!1),i.ZH.focus(),i.XF=!0)},e.prototype.dI=function(e,t){var n=this;n.XF&&(n.XF=!1,!t&&n._H(e))},e.prototype.gx=function(e){var t=this.kj.tu();t&&(t.ska(e),t.M4(),this.Gma=!0,e&&t.N4())},e.prototype.hx=function(){var e=this,t=e.kj.tu();t&&t.ska(""),e.Gma=!1,e._H(!0,!1)},e.prototype.MF=function(){var e,t=this;t.aI(),(e=t.GF)&&(l.GC$(e).remove(),t.GF=E),(e=t.XH)&&(l.GC$(e).remove(),t.YH=E,t.XH=k,t.ZH=k)},e.prototype.uw=function(e,t,n,o){var r=this.kj.parent;r&&r.uw(e,t,n,o)},e.prototype.ww=function(e,t,n,o){var r=this.kj.parent;r&&r.ww(e,t,n,o)},e.prototype.xw=function(){var e=this.kj.parent;e&&e.xw()},e.prototype.Uw=function(e){var t,n,o,r,i,a,s,l;n=(t=this.kj).hCb,o=t.iCb,i=!1,(r=t.yt)||(i=!0),i||e||(i=!0),i||(i=e.col!==r.col||e.row!==r.row||ye(e)!==ye(r)||me(e)!==me(r)||ve(e)!==ve(r)||!function(e,t){var n=!1;return e||t?e&&t&&(n=e.action===t.action&&e.index===t.index&&e.sheetArea===t.sheetArea):n=!0,n}(e.resizeInfo,r.resizeInfo)),t.yt=e,i&&(r&&!C(r.hitTestType)&&(t._modelManager.setCellState(n,o,c.CellStatesType.hover,!1,r.hitTestType),t.xIb&&t.xIb(c.CellStatesType.hover,n,o,r.hitTestType,r.rowViewportIndex,r.colViewportIndex)),e&&!C(e.hitTestType)&&(t.hCb=e.row,t.iCb=e.col,e.resizeInfo||(t._modelManager.setCellState(e.row,e.col,c.CellStatesType.hover,!0,e.hitTestType),t.xIb&&t.xIb(c.CellStatesType.hover,e.row,e.col,e.hitTestType,e.rowViewportIndex,e.colViewportIndex))),t.fI=!0,s=ue(t,r,a=t._render),l=ue(t,e,a),s=s||l,t.fI=!1,s&&a.im())},e.prototype._G=function(e,t,n){var o=this.gI(e,t,n);return this.hI(o)},e.prototype.gI=function(e,t,n){var o=this.kj._modelManager.getSpan(e,t),r=Ne(o),i=Te(o);return 1===r&&1===i||n&&1===r||!n&&1===i?o:(n?t++:e++,this.gI(e,t,n))},e.prototype.hI=function(e){var t,n,o,r=this.kj,i=e.row,a=de(r);for(t=i;t<a&&!0!==r.getRowVisible(t);t++);for(t<a&&(i=t),n=e.col,o=ge(r),t=n;t<o&&!0!==r.getColumnVisible(t);t++);return t<o&&(n=t),b(i,n,Ne(e),Te(e))},e.prototype.byb=function(e){var t,n,o=e.floatingObjects&&e.floatingObjects.all(),r=e.shapes&&e.shapes.all();if(!C(o))for(t=0;t<o.length;t++)if(o[t].isSelected())return!0;if(!C(r))for(n=0;n<r.length;n++)if(r[n].isSelected())return!0},e}(),t.iI=le,r.Worksheet.$n("eventHandler",{beforeSetHost:function(){this._eventHandler=new le(this)},dispose:function(e){var t,n,o,r,i=this,a=i._eventHandler;a&&(a.uC(),t=a.nIb,l.GC$(i.Ws()).unbind(x+"."+t).unbind(A+"."+t).unbind(M+"."+t).unbind(S+"."+t).unbind(I+"."+t).unbind(R+"."+t),d.mozilla&&(n="onwheel"in document?N:T,l.GC$(i.Ws()).unbind(n+"."+t)),a.no(),a.MF()),(o=i._editor)&&l.GC$(o).remove(),(r=i.NF)&&r.close(),!1!==e.clearCache&&(i.OF=k,i.PF=k,i.QF=k,i.RF=k,i.SF=k,i.TF=k,i._eventHandler=k)},setHost:function(e){var t,n,o,i;e&&(n=(t=this)._eventHandler,t.OF=function(e){var o={e:e,r:k};if(r.Worksheet.ao(t,"preProcessMouseDown",o),!o.r)return n.AD(e)},t.PF=function(e){var o={e:e,r:k};r.Worksheet.ao(t,"preProcessMouseMove",o),o.r||n.RB||n.BD(e)},t.QF=function(e){var o={e:e,r:k};if(r.Worksheet.ao(t,"preProcessMouseUp",o),!o.r&&!t.XD){if(n.RB)return;return n.CD(e)}},t.RF=function(e){var n,o,i,a,s,l,u,c,h,p;if(n={e:e=e||f.event,r:k},r.Worksheet.ao(t,"preProcessMouseWheel",n),!n.r)return i=(o=t.parent)&&o.options.scrollByPixel,a=e.detail?e.detail:e.wheelDelta/-40,s=0,"wheel"===e.type?(a=e.deltaY,s=e.deltaX,i||(P(a)>=P(s)?s=0:a=0)):(l=(new Date).valueOf(),u=e.wheelDeltaY,c=e.wheelDeltaX,i||(P(u)>=P(c)?c=0:u=0),h=!t.nka||l-t.nka>200,(d.safari||d.chrome)&&(p=d.safari?-4:-40,C(u)||(h?(a=((a=u/p)>=0?1:-1)*O(P(a)),t.oka=0):(a=u/p,t.oka+=a,a=(a>=0?1:-1)*O(P(t.oka)),t.oka-=a)),C(c)||(h?(s=((s=c/p)>=0?1:-1)*O(P(s)),t.pka=0):(s=c/p,t.pka+=s,s=(s>=0?1:-1)*O(P(t.pka)),t.pka-=s))),t.nka=l),(0!==a||0!==s)&&(!!t.parent.ku.Rw(e,j(a,10)||0,j(s,10)||0)&&void 0)},t.SF=function(e){var o={e:e,r:k};if(r.Worksheet.ao(t,"preProcessMouseOut",o),!o.r)return n.DD(e)},t.TF=function(e){var o,i,a={e:e,r:k};r.Worksheet.ao(t,"preProcessMouseDbClick",a),a.r||(o=t.yt)&&(i=!1,3===ve(o)?function(e,n){var o=t.Vs(),r=n.pageX-o.left,i=n.pageY-o.top,a=t.hitTest(r,i),s=a.dragInfo;a.tableSelectInfo||(s&&e.cyb&&"corner"===s.side?e.cyb():e._startEdit(n,r,i))}(n,e):i=function(e,t){var n,o,r=e.kj,i=t.resizeInfo;return!!i&&(i.action===ee||i.action===X?(n=[],r.tp(i.index)?p(r._modelManager.getSelections(),(function(e,t){var o,i;if(-1===t.col)for(o=r.Tq(t),i=0;i<Ne(o);i++)n.push({row:o.row+i})})):n.push({row:i.index}),r.wu().execute({cmd:"autoFitRow",sheetName:r.name(),rows:n,columnHeader:1===i.sheetArea})):(o=[],r.sp(i.index)?p(r._modelManager.getSelections(),(function(e,t){var n,i;if(-1===t.row)for(n=r.Tq(t),i=0;i<Te(n);i++)o.push({col:n.col+i})})):o.push({col:i.index}),r.wu().execute({cmd:"autoFitColumn",sheetName:r.name(),columns:o,rowHeader:2===i.sheetArea})),!0)}(n,o),i||t.Wq(u.Events.CellDoubleClick,Re(t,t.name(),o.row,o.col,ve(o))))},o=n.nIb,e.bind(x+"."+o,(function(e){return t.OF(e)})).bind(A+"."+o,(function(e){return t.QF(e)})).bind(M+"."+o,(function(e){return t.PF(e)})).bind(S+"."+o,(function(e){return t.RF(e)})).bind(I+"."+o,(function(e){return t.SF(e)})).bind(R+"."+o,(function(e){return t.TF(e)})),d.mozilla&&(i="onwheel"in document?N:T,e.bind(i+"."+o,(function(e){return t.RF(e)}))))}})},"./dist/core/worksheet/worksheet-formatter.js":function(e,t,n){"use strict";var o,r,i,a,s;Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/util/domUtil.js"),r=n("./dist/core/worksheet/worksheet.js"),i=n("./dist/core/worksheet/style.js"),a=n("./dist/core/util/common.js"),s=n("@grapecity/js-sheets-common"),o.GC$.extend(r.Worksheet.prototype,{getFormatter:function(e,t,n){return this.tq(e,t,"formatter",n)},setFormatter:function(e,t,n,o){var r=this.Iq(e,t,o);r||(r=new i.Style),r.formatter=n,this.setStyle(e,t,r,o)}}),r.Worksheet.$n("formatter",{settingText:function(e){var t,n=a.util.tl(e.value),o=s.Formatter&&s.Formatter.GeneralFormatter;o&&n&&(t={},(new o).getPreferredDisplayFormatter(e.value,t),"number"==typeof t.value&&(e.value=t.value))}})},"./dist/core/worksheet/worksheet-json.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M;function S(e,t,n,o){var r,i;if(e.dataTable&&(t.dataTable||(t.dataTable={}),r=e.dataTable[n])){if(t.dataTable[n]||(t.dataTable[n]={}),!(i=r[o]))return;t.dataTable[n][o]||(t.dataTable[n][o]={}),i.formula&&(t.dataTable[n][o].formula=i.formula)}}function T(e,t,n,o){var r,i,a=e._modelManager,l=a._getSheetModel(),u=a._getSheetModel(f.SheetArea.colHeader),c=a.YTa(!0),h=a.YTa(!0,f.SheetArea.colHeader),p=a.zl(),d=a.zl(f.SheetArea.colHeader),g=l.getColumnCount();for(C(t.colHeaderData)&&(t.colHeaderData={}),u.setRowCount(n),r=0;r<n;r++)for(u.setNode(r,-1,l.RTa(r,-1)),h.Kp(r,c.Jp(r)),i=o;i<g;i++)u.setNode(r,i,l.RTa(r,i)),S(t.data,t.colHeaderData,r,i);p.getSpans(s.kf(0,0,n,g)).forEach((function(e){d.add(e)})),e.frozenRowCount(0)}function N(e,t,n,o){var r,i,a=e._modelManager,l=a._getSheetModel(),u=a._getSheetModel(f.SheetArea.rowHeader),c=a.YTa(!1),h=a.YTa(!1,f.SheetArea.rowHeader),p=a.zl(),d=a.zl(f.SheetArea.rowHeader),g=l.getRowCount();for(C(t.rowHeaderData)&&(t.rowHeaderData={}),u.setColumnCount(n),r=0;r<n;r++)for(u.setNode(-1,r,l.RTa(-1,r)),h.Kp(r,c.Jp(r)),i=o;i<g;i++)u.setNode(i,r,l.RTa(i,r)),S(t.data,t.rowHeaderData,i,r);p.getSpans(s.kf(0,0,g,n)).forEach((function(e){d.add(e)})),e.frozenColumnCount(0)}function I(e,t){switch(e){case"frozenRowCount":case"frozenColCount":case"frozenTrailingRowCount":case"frozenTrailingColCount":case"activeRow":case"activeCol":return 0===t;case"rowCount":return 200===t;case"columnCount":return 20===t;case"zoomFactor":case"rowHeaderColCount":case"colHeaderRowCount":return 1===t;case"visible":return!0===t}return!1}function R(e,t){return m(e)?e:t}function k(e,t,n){m(n)&&t.call(e,n,!1)}function E(e,t,n,o,r){g&&y(g,(function(i,a){var s=a.fromJson;s&&s.call(e,t,n,o,!m(r)||r)}))}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("./dist/core/worksheet/worksheet.js"),i=n("./dist/core/worksheet/style.js"),a=i.Style.kxb,s=n("./dist/core/util/common.js"),l=n("./dist/core/util/theme.js"),u=n("./dist/core/util/domUtil.js"),c=n("./dist/core/worksheet/stylehelper.js"),f=n("./dist/core/core.enum.js"),h=n("@grapecity/js-calc"),p=!!h,d=o.Common.CultureManager,g=r.Worksheet._features,m=s.util.Ol,y=u.GC$.each,v=u.GC$.isEmptyObject,b=o.Common.D,C=o.Common.j.Fa,w="string",x=parseInt,A=isNaN,M=void 0,u.GC$.extend(r.Worksheet.prototype,{qI:function(e,t,n,o){var r;e[t]||(e[t]={}),(r=e[t])[n]||(r[n]={}),r[n].value=o},$ec:function(e,t){var n,o,i,a,s=this,l=s._modelManager,u=l._getSheetModel(),c=l._getSheetModel(f.SheetArea.colHeader),h=l.YTa(!0),p=l.YTa(!0,f.SheetArea.colHeader),d=l.zl(),g=l.zl(f.SheetArea.colHeader),m=u.getColumnCount();for(n=0;n<e;n++)for(u.setNode(n,-1,c.RTa(n,-1)),h.Kp(n,p.Jp(n)),o=t;o<m;o++)(i=c.RTa(n,o))||(i={}),i.style=s.getActualStyle(n,o,f.SheetArea.colHeader),u.setNode(n,o,i),(a=s.getFormula(n,o,f.SheetArea.colHeader))&&s.setFormula(n,o,a,f.SheetArea.viewport);g.getSpans().forEach((function(e){d.add(e)})),s.frozenRowCount(e),l.dWa(r.Worksheet.Vp,m,f.SheetArea.colHeader),l.fWa(!1,f.SheetArea.colHeader),l.eWa(f.SheetArea.colHeader),s.Bj(f.SheetArea.colHeader).clearAll()},Zec:function(e,t){var n,o,i,a,s=this,l=s._modelManager,u=l._getSheetModel(),c=l._getSheetModel(f.SheetArea.rowHeader),h=l.YTa(!1),p=l.YTa(!1,f.SheetArea.rowHeader),d=l.zl(),g=l.zl(f.SheetArea.rowHeader),m=u.getRowCount();for(n=0;n<e;n++)for(u.setNode(-1,n,c.RTa(-1,n)),h.Kp(n,p.Jp(n)),o=t;o<m;o++)(i=c.RTa(o,n))||(i={}),i.style=s.getActualStyle(o,n,f.SheetArea.rowHeader),u.setNode(o,n,i),(a=s.getFormula(o,n,f.SheetArea.rowHeader))&&s.setFormula(o,n,a,f.SheetArea.viewport);g.getSpans().forEach((function(e){d.add(e)})),s.frozenColumnCount(e),l.dWa(m,r.Worksheet.Tp,f.SheetArea.rowHeader),l.fWa(!1,f.SheetArea.rowHeader),l.eWa(f.SheetArea.rowHeader),s.Bj(f.SheetArea.rowHeader).clearAll()},toJSON:function(e){var t,n,o,i,a,l,u,h,p,d,m,w,x,A,M,S,T,N,R,k,E,D=this,j=e&&e.ignoreStyle;for(w in e&&!e.Yec&&(t=D.getRowCount(f.SheetArea.colHeader),n=D.getColumnCount(f.SheetArea.rowHeader),o=e.rowHeadersAsFrozenColumns,a=e.columnHeadersAsFrozenRows&&t>0,(i=o&&n>0)&&D.addColumns(0,n),a&&D.addRows(0,t,a),i&&D.Zec(n,a?t:0),a&&D.$ec(t,i?n:0)),l=D.getRowCount(),u=D.getColumnCount(),h=D.getRowCount(f.SheetArea.colHeader),p=D.getColumnCount(f.SheetArea.rowHeader),d={name:D.name(),isSelected:D.DHb(),rowCount:l,columnCount:u,activeRow:D.Jl,activeCol:D.Kl,zoomFactor:D.zoom(),rowHeaderColCount:p,colHeaderRowCount:h,visible:D.visible()},j||(d.frozenRowCount=D.frozenRowCount(),d.frozenColCount=D.frozenColumnCount(),d.frozenTrailingRowCount=D.frozenTrailingRowCount(),d.frozenTrailingColCount=D.frozenTrailingColumnCount(),d.theme=D.Pm.toJSON()),m=D._modelManager.toJSON(e))d[w]=m[w];for(A in g&&y(g,(function(t,n){n.toJson&&n.toJson.call(D,d,e)})),x={},d)b(d,A)&&(M=d[A],C(M)||I(A,M)||(x[A]=M));if(function(e,t){var n,o,r,i,a,s,l,u,c,f=e._modelManager.ZHb.anchors;for(n in f)if(o=+n,r=f[n],i=t[o],r&&i)for(a in r)s=+a,(l=r[a])&&((u=i[s])&&(c={row:l.row,rowCount:l.rowCount,col:l.col,colCount:l.colCount,isDynamicArray:!0},l.isValid||(c.isInvalid=!0),u.arrayInfo=c))}(D,d.data.dataTable),y(D.options,(function(e,t){var n,o,i,a=t;"gridline"===e&&(a={},n=t.color,o=t.showHorizontalGridline,i=t.showVerticalGridline,n&&n!==s.Im.Lm("gc-gridlineColor").borderTopColor&&(a.color=n),!1===o&&(a.showHorizontalGridline=o),!1===i&&(a.showVerticalGridline=i)),"sheetAreaOffset"===e&&(a={},t.left&&(a.left=t.left),t.top&&(a.top=t.top)),"_ps"===e||C(a)||r.Worksheet.Qp[e]===a||"object"==typeof a&&v(a)||(x[e]=a)})),S=[],T=D.Lq){for(N in T)b(T,N)&&((R=T[N])&&(k=R.toJSON(),E=R.font,v(k)||(E&&(k.font=c.To.Jo(E)),S.push(k))));S.length>0&&(x.namedStyles=S)}return x},fromJSON:function(e,t,n,o,s){var u,c,h,g,y,v,C,S,I,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe;if(n&&(u=n.noSchema,c=n.version),e){g=(h=this)._modelManager,y=o&&o.ignoreStyle,h.T3(),r.Worksheet.ao(h,"preFromJson"),h.suspendPaint(),g.wgc(),g.xgc(),v=d.culture(),d.culture(""),C=R(e.rowCount,r.Worksheet.Rp),S=R(e.columnCount,r.Worksheet.Sp);try{if(h.cq(e.name+"",!0),h.DHb(e.isSelected),h.setRowCount(C),h.setColumnCount(S),h.Lq={},I=e.namedStyles)for(D=0;D<I.length;D++)j=I[D],_=new i.Style,a(j,h),_.fromJSON(j,u,h),h.Kq(_);for(F in O=h.options)if(b(O,F)&&(P=e[F],"protectionOptions"===F?P=P||e.protectionOption:"allowCellOverflow"===F&&(P=m(e[F])?e[F]:!c||c>=11),m(P)))if("object"==typeof P)for(H in P)b(P,H)&&(O[F][H]=P[H]);else"borderWidth"===F?(O.sheetAreaOffset.left=P,O.sheetAreaOffset.top=P):O[F]=P;if(B=R(e.activeRow,h.Jl),L=R(e.activeCol,h.Kl),h.Kr(B,L,M,M,!0),y||(k(h,h.frozenRowCount,e.frozenRowCount),k(h,h.frozenColumnCount,e.frozenColCount),k(h,h.frozenTrailingRowCount,e.frozenTrailingRowCount),k(h,h.frozenTrailingColumnCount,e.frozenTrailingColCount)),!y){if(z=e.colStyles)for(V in z)A(V)||h.setStyle(-1,x(V,10),z[V],f.SheetArea.viewport);if(G=e.rowStyles)for(W in G)A(W)||h.setStyle(x(W,10),-1,G[W],f.SheetArea.viewport)}U=R(e.rowHeaderColCount,r.Worksheet.Tp),Z=R(e.colHeaderRowCount,r.Worksheet.Vp),h.setColumnCount(U,f.SheetArea.rowHeader),h.setRowCount(Z,f.SheetArea.colHeader),h.XSa(R(e._zoomFactor||e.zoomFactor,h.zoom())),k(h,h.visible,e.visible),q=h.uja,J={sheet:h,setValidator:function(e,t,n){q&&q.vja(e,t,n)},ignoreStyle:y},g.fromJSON(e,u,J),h.defaults=g.defaults,q&&q.QV(!0),(Q=e.theme)&&!y&&(typeof(Y=Q)!==w&&m(Y)&&("_themeColor","_name",K=Y.themeColor||Y._themeColor,($=new l.ColorScheme(K.name||K._name)).fromJSON(K,u),Y=new l.Theme(Y.name||Y.Cj,$,Y.headingFont||Y.Vaa,Y.bodyFont||Y.Waa)),h.currentTheme(Y)),E(h,e,u,o,t),X=o&&o.frozenColumnsAsRowHeaders,te=(ee=o&&o.frozenRowsAsColumnHeaders)&&e.frozenRowCount||0,ne=X&&e.frozenColCount||0,ee&&te>0&&T(h,e,te,ne),X&&ne>0&&N(h,e,ne,te),p&&(oe=h.yj(),te>0&&(oe.cDc=te),ne>0&&(oe.dDc=ne)),s||(te>0&&h.deleteRows(0,te),ne>0&&h.deleteColumns(0,ne)),h.clearPendingChanges()}finally{d.culture(v),g.ygc(),h.resumePaint()}}},egc:function(e,t,n,o,s){var u,c,h,g,y,v,C,S,I,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z;if(n&&(u=n.noSchema,c=n.version),e){g=(h=this)._modelManager,y=o.ignoreStyle,h.T3(),r.Worksheet.ao(h,"preFromJson"),g.wgc(),g.xgc(),v=d.culture(),d.culture(""),R(e.rowCount,r.Worksheet.Rp),R(e.columnCount,r.Worksheet.Sp);try{if(h.Lq={},C=e.namedStyles)for(S=0;S<C.length;S++)I=C[S],D=new i.Style,a(I,h),D.fromJSON(I,u,h),h.Kq(D);for(_ in j=h.options)if(b(j,_)&&(O=e[_],"protectionOptions"===_?O=O||e.protectionOption:"allowCellOverflow"===_&&(O=m(e[_])?e[_]:!c||c>=11),m(O)))if("object"==typeof O)for(F in O)b(O,F)&&(j[_][F]=O[F]);else"borderWidth"===_?(j.sheetAreaOffset.left=O,j.sheetAreaOffset.top=O):j[_]=O;if(P=R(e.activeRow,h.Jl),H=R(e.activeCol,h.Kl),h.Kr(P,H,M,M,!0),y||(k(h,h.frozenRowCount,e.frozenRowCount),k(h,h.frozenColumnCount,e.frozenColCount),k(h,h.frozenTrailingRowCount,e.frozenTrailingRowCount),k(h,h.frozenTrailingColumnCount,e.frozenTrailingColCount)),!y){if(B=e.colStyles)for(L in B)A(L)||h.setStyle(-1,x(L,10),B[L],f.SheetArea.viewport);if(z=e.rowStyles)for(V in z)A(V)||h.setStyle(x(V,10),-1,z[V],f.SheetArea.viewport)}G=R(e.rowHeaderColCount,r.Worksheet.Tp),W=R(e.colHeaderRowCount,r.Worksheet.Vp),h.setColumnCount(G,f.SheetArea.rowHeader),h.setRowCount(W,f.SheetArea.colHeader),h.XSa(R(e._zoomFactor||e.zoomFactor,h.zoom())),k(h,h.visible,e.visible),U=h.uja,Z={sheet:h,setValidator:function(e,t,n){U&&U.vja(e,t,n)},ignoreStyle:y,incrementalLoading:o.incrementalLoading,incrementLoadTask:o.incrementLoadTask},g.fromJSON(e,u,Z,(function(){var n,r,i,a,c,f,b,C,x;h.defaults=g.defaults,U&&U.QV(!0),(n=e.theme)&&!y&&(typeof(r=n)!==w&&m(r)&&("_themeColor","_name",i=r.themeColor||r._themeColor,(a=new l.ColorScheme(i.name||i._name)).fromJSON(i,u),r=new l.Theme(r.name||r.Cj,a,r.headingFont||r.Vaa,r.bodyFont||r.Waa)),h.currentTheme(r)),E(h,e,u,o,t),c=o&&o.frozenColumnsAsRowHeaders,b=(f=o&&o.frozenRowsAsColumnHeaders)&&e.frozenRowCount||0,C=c&&e.frozenColCount||0,f&&b>0&&T(h,e,b,C),c&&C>0&&N(h,e,C,b),p&&(x=h.yj(),b>0&&(x.cDc=b),C>0&&(x.dDc=C)),s||(b>0&&h.deleteRows(0,b),C>0&&h.deleteColumns(0,C)),h.clearPendingChanges(),d.culture(v),g.ygc(),h.loaded=!0}))}finally{}}}})},"./dist/core/worksheet/worksheet-model.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),$=this&&this.__rest||function(e,t){var n,o,r={};for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]]);return r};function X(e,t){return D(e)?t:e}function ee(e,t){return e.hasOwnProperty(t)}function te(e){return e.rowCount}function ne(e){return e.colCount}function oe(e,t,n,o){var r=n;Object.defineProperty(e,t,{get:function(){return r},set:function(e){var n=r;r=e,o(this,e,t,n)}})}function re(e,t){e.cache={},t&&t.forEach((function(t){ie(e,t)}))}function ie(e,t){var n,o;if(e.Ef=A(e.Ef,t.row+te(t)-1),e.Ff=A(e.Ff,t.col+ne(t)-1),!e.suspendUpdatingCache)for(n=0;n<t.rowCount;n++)for(o=0;o<t.colCount;o++)e.cache[t.row+n+"_"+(t.col+o)]=t}function ae(e,t){var n,o;if(!e.suspendUpdatingCache)for(n=0;n<t.rowCount;n++)for(o=0;o<t.colCount;o++)e.cache[t.row+n+"_"+(t.col+o)]=b}function se(e,t,n){var o,r,i,a,l=s.kf(-1,-1,-1,-1);return e&&(o=e.col,i=-1===(r=e.row),a=-1===o,l.row=i?0:r,l.rowCount=i?t:te(e),l.col=a?0:o,l.colCount=a?n:ne(e)),l}function le(e,t,n,o,r){var i,a,s=e.length;for(a=0;a<s;a++)if(i=e[a],D(t)||D(n)?D(t)?D(n)?D(o)?i.containsY(r):i.containsX(o):i.col===n:i.row===t:i.contains(t,n))return i;return v}function ue(e,t,n){var o=v,r=e.length,i=!D(t);return r>0&&((o=i?e.findX(t):e.findY(n))||(o=i&&t<e[0].x||!i&&n<e[0].y?e[0]:e[r-1])),o}function ce(e,t,n,o,r,i,a,s){var l,u,c,f,h,p,d,g,m,y,v,b=r&&r.incrementLoadTask;if(b&&!b.isTerminated){for(l=b.isBusyFunc,u=a=a||0,c=!1,30,f=new Date;u<n;){if(h=t[u])for(p=0;p<o;p++)(d=h[p])&&(c=!0,pe(d,e.RTa(u,p,!0),i,u,p,r));if(u++,l&&l())break;if(new Date-f>30)break}if(c){if(g=r&&r.sheet,0!==a&&g.parent.getActiveSheet()===g)for(m=a;m<u;m++)if(g.as.viewport[1].findRow(m)){g.repaint();break}(y=r&&r.incrementalLoading)&&y.loading&&(y.loadStatus.valuesLoad+=u-a,v=function(e,t){var n=e.valuesLoad/e.total;return t?.4*n+.1:.3*n+.1}(y.loadStatus,r.doNotRecalculateAfterLoad),y.loading(v))}u<n?r.incrementLoadTask.pushTask(ce,[e,t,n,o,r,i,u,s]):s&&r.incrementLoadTask.pushTask(s,[])}}function fe(e,t,n,o,r,i,a,s){n>=0&&o>=0?(i[n]||(i[n]={}),i[n][o]=r):n>=0&&-1===o&&e>=0&&-1===t?a[n]=r:o>=0&&-1===n&&t>=0&&-1===e&&(s[o]=r)}function he(e,t,n,o,r,i,a){if(n>=0&&o>=0){i[n]||(i[n]={}),i[n].rs="e";var s=i[n];s.originalItem=a,s[o]=r}}function pe(e,t,n,o,i,s){var u,c,f,h,d,g,m,y,w,x,A;e&&((u=e.value)!==b&&((u=u)!==v&&(u._calcError||u._error&&!D(u._code))&&((c=p&&a.CalcError.parse(u._calcError||u._error))!==b&&(u=c=_(c))),t.value=u),f=e.style,h=s&&s.sheet,f===b||s.ignoreStyle||(d=v,typeof f===C?(t.style=f,d=h&&(h.Mq(f,!1)||h.parent&&h.parent.Mq(f,!1))):f&&((d=new r.Style).fromJSON(f,n),d.name=b,t.style=d),d&&d.validator&&s&&s.setValidator&&s.setValidator(o,i,d.validator)),(g=e.visualState)!==b&&(t.visualState=g),(m=e.bindingPath)!==b&&(t.bindingPath=m),(y=e.tag)!==b&&(typeof(w=y.typeName)===C&&((x=l.getTypeFromString(w))&&((y=new x).fromJSON&&y.fromJSON(e.tag))),t.tag=y),(A=e.hyperlink)!==b&&(t.hyperlink=F(A)))}function de(e,t){for(var n,o,r,i,a,s=t[0],l=e,u=0;u<s.length-1;u++){if(D(l))return;l=(n=s[u])===S?l.Ap:l[n]}l[s[u]]=t[1],o=s[s.length-1],i=s[s.length-2],a=s[1],"size"===o?r=s[0]===N?c.AxisInfoChangeType.setRowHeight:c.AxisInfoChangeType.setColumnWidth:"visible"===o&&(r=s[0]===N?c.AxisInfoChangeType.setRowVisible:c.AxisInfoChangeType.setColumnVisible),D(r)||e.zgc({type:r,index:i,sheetArea:a})}function ge(e,t,n){var o=e.WTa>0?[["selectionModel"],b]:b;e.selectionModel.setProperty(t,n,o),o&&e.zTa.push(o)}function me(e,t,n,o,r){void 0===r&&(r=!1);var i=e[t];return r?void(i&&delete i[n]):(i||(i=e[t]={}),void(i[n]=o))}function ye(e,t,n,o){me(e,t,n,{value:o})}function ve(e,t,n,o,r,i){me(e,t,n,{value:o,oldValue:r,isAnchorCell:i})}function be(e,t,n,o){var r,i=e[t],a=i&&i[n];return a?a.value:(ye(e,t,n,r=o.getValue(t,n)),r)}function Ce(e,t){return[e,t].join(",")}function we(e,t){-1===e.indexOf(t)&&e.push(t)}function xe(e,t){var n,o=Array(t);for(n=0;n<t;n++)o[n]=e;return o}function Ae(e,t,n){var o=e[t];return o&&o[n]}function Me(e,t){var n=t.split(",").map((function(e){return+e})),o=n[0],r=n[1],i=e[o];return i&&i[r]}function Se(e,t,n,o){var r=e[t];r&&delete r[n],o&&g(r)&&delete e[t]}function Te(e,t,n,o,r){var i,s,l,u,c,f,h,p,d=e._getSheetModel(3),g=e.ZHb,m=g.anchors,y=[];for(i in m)if(m.hasOwnProperty(i)&&(s=m[i]))for(l in s)s.hasOwnProperty(l)&&((u=s[l])&&(c=u.row,f=u.col,h=u.rowCount,p=u.colCount,(r?c+h:f+p)>=t&&(u.isValid&&d.yIb(u),(r?c:f)<t&&y.push(u))));y.length&&a.markAnchorCellDirty(y,e.kj.Bj(),g)}function Ne(e){return e?e.filter((function(e){return!e.isAutoMerge})):e}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/core.ns.js"),r=n("./dist/core/worksheet/style.js"),i=n("@grapecity/js-sheets-common"),a=n("@grapecity/js-calc"),s=n("./dist/core/util/common.js"),l=n("./dist/core/util/common.js"),u=n("./dist/core/util/domUtil.js"),c=n("./dist/core/core.enum.js"),f=n("@grapecity/js-calc"),h=n("./dist/core/celltype/celltype.ns.js"),p=!!f,d=u.GC$.each,g=u.GC$.isEmptyObject,m=u.GC$.extend,y=RegExp("^\\d*(\\.\\d+)?\\*$"),v=null,b=void 0,C="string",w=Math.min,x=Math.floor,A=Math.max,M=Math.ceil,S="dirtyNodes",T="undo",N="rowInfos",I="colInfos",R="default_size",k=i.Common.A,E=i.Common.B,D=i.Common.j.Fa,j=s.util.K_a,_=s.util.n0a,O=s.util.lHb,F=i.Common.j.C4,P=new i.Common.ResourceManager(o.SR),H=P.getResource.bind(P),B=function(){function e(){oe(this,"spans",[],re),this.Ff=-1,this.Ef=-1,this.cache={},this.suspendUpdatingCache=!1}return e.prototype.find=function(e,t){return this.cache[e+"_"+t]||v},e.prototype.get=function(e,t){return this.find(e,t)||s.kf(e,t,1,1)},e.prototype.remove=function(e,t){var n=this.spans.indexOf(e);n>=0?(t&&(t[0].push("spans"),t[1]=[].concat(this.spans)),this.removeSpan(n,1)):t&&(t.length=0)},e.prototype.removeSpan=function(e,t){for(var n=0;n<t;n++)ae(this,this.spans[e+n]);this.spans.splice(e,t)},e.prototype.update=function(e,t){var n=this;ae(n,n.spans[e]),n.spans[e]=t,ie(n,t)},e.prototype.add=function(e,t){t&&(t[0].push("spans"),t[1]=[].concat(this.spans)),ie(this,e),this.spans.push(e)},e.prototype.Zz=function(e,t,n,o,r,i,a){var l,u,c,f,h,p,d,g=this,m=!1;for(a&&(l=[].concat(g.spans)),u=g.spans.length,d=[],p=0;p<u;p++)h=(c=g.spans[p]).col,f=c.row,(-1===e||e<=f&&f<e+r)&&(-1===t||t<=h&&h<t+i)?(d.push(s.kf(-1===e?f:n+f-e,-1===t?h:o+h-t,te(c),ne(c))),m=!0):(-1===e||n<=f&&f<n+r)&&(-1===t||o<=h&&h<o+i)&&(g.removeSpan(p,1),p--,u--,m=!0);for(p=0;p<d.length;p++){if(c=d[p],!g.LTa(g.spans,0,g.spans.length,c))throw Error(H().Exp_OverlappingSpans);g.add(c)}a&&(m?(a[0].push("spans"),a[1]=l):a.length=0)},e.prototype.LTa=function(e,t,n,o){for(var r=t;r<n&&r<e.length;r++)if(e[r].intersect(o.row,o.col,te(o),ne(o)))return!1;return!0},e.prototype.getSpans=function(e){var t,n,o,r=this.spans;if(!e)return[].concat(r);for(t=[],n=0;n<r.length;n++)(o=r[n]).intersect(e.row,e.col,te(e),ne(e))&&t.push(o);return t},e.prototype.qu=function(e,t,n,o){var r,i,a=this.spans;for(r=0;r<a.length;r++)if((i=a[r]).intersect(e,t,n,o)&&(-1!==e&&(i.row<e||i.row+te(i)>e+n)||-1!==t&&(i.col<t||i.col+ne(i)>t+o)))return!0;return!1},e.prototype.MTa=function(e,t,n,o){var r,i,a=!1,s=this.spans;for(r=0,i=s.length;r<i;r++){if(e>=0||t>=0)for(;r<i&&!s[r].intersect(e,t,n,o);)r++;if(r<i){a=!0;break}}return a},e.prototype.$b=function(e,t,n,o,r){var i,a,s,l,u,c=this.spans,f=!1;for(r&&(i=[].concat(c)),a=0;a<c.length;a++)l=(s=c[a]).row,u=s.col,(-1===e||e<=l&&l<e+n)&&(-1===t||t<=u&&u<t+o)&&(this.removeSpan(a,1),a--,f=!0);r&&(f?(r[0].push("spans"),r[1]=i):r.length=0)},e.prototype.aB=function(e,t,n,o,r,i,a){var l,u,c,f,h,p,d,g,m,y=this,v=!1;for(a&&(l=[].concat(y.spans)),u=[],c=[],f=y.spans.length,g=0;g<f;g++)p=(h=y.spans[g]).row,d=h.col,(-1===e||e<=p&&p<e+r)&&(-1===t||t<=d&&d<t+i)?(m=s.kf(-1===e?p:n+p-e,-1===t?d:o+d-t,te(h),ne(h)),c.push(m),v=!0):(-1===e||n<=p&&p<n+r)&&(-1===t||o<=d&&d<o+i)?v=!0:u.push(h);if(v){if(c.length>0)for(g=0;g<c.length;g++){if(m=c[g],!y.LTa(u,0,u.length,m))throw Error(H().Exp_OverlappingSpans);u.push(m)}for(y.spans.length=0,y.cache={},g=0;g<u.length;g++)y.add(u[g]);a&&(a[0].push("spans"),a[1]=l)}else a&&(a.length=0)},e.prototype.NTa=function(e,t,n){var o,r,i,a,l,u,c,f,h,p=this,d=p.spans;for(p.suspendUpdatingCache=!0,o=!1,n&&(r=[].concat(d)),i=d.length,a=0;a<i;a++)u=(l=d[a]).row,c=l.col,f=te(l),h=ne(l),u>=e?(p.update(a,s.kf(u+t,c,f,h)),o=!0):e<u+f&&(p.update(a,s.kf(u,c,f+t,h)),o=!0);p.suspendUpdatingCache=!1,o&&re(p,d),n&&(o?(n[0].push("spans"),n[1]=r):n.length=0)},e.prototype.OTa=function(e,t,n){var o,r,i,a,l,u,c,f,h,p=this,d=p.spans;for(p.suspendUpdatingCache=!0,o=!1,n&&(r=[].concat(d)),i=d.length,a=0;a<i;a++)u=(l=d[a]).row,c=l.col,f=te(l),h=ne(l),c>=e?(p.update(a,s.kf(u,c+t,f,h)),o=!0):e<c+h&&(p.update(a,s.kf(u,c,f,h+t)),o=!0);p.suspendUpdatingCache=!1,o&&re(p,d),n&&(o?(n[0].push("spans"),n[1]=r):n.length=0)},e.prototype.PTa=function(e,t,n){var o,r,i,a,l,u,c,f,h,p,d,g,m=this,y=m.spans;for(m.suspendUpdatingCache=!0,o=!1,n&&(r=[].concat(y)),i=[],a=y.length,l=0;l<a;l++)c=(u=y[l]).row,f=u.col,h=te(u),p=ne(u),c>=e?c<e+t?c+h<=e+t?(i.push(l),o=!0):(m.update(l,s.kf(e,f,c+h-(e+t),p)),o=!0):(m.update(l,s.kf(c-t,f,h,p)),o=!0):e<c+h&&(d=s.kf(c,f,h-w(c+h-e,t),p),m.update(l,d),1===d.rowCount&&1===d.colCount&&i.push(l),o=!0);for(l=i.length-1;l>=0;l--)g=i[l],m.removeSpan(g,1);m.suspendUpdatingCache=!1,o&&re(m,y),n&&(o?(n[0].push("spans"),n[1]=r):n.length=0)},e.prototype.QTa=function(e,t,n){var o,r,i,a,l,u,c,f,h,p,d,g,m=this,y=m.spans;for(m.suspendUpdatingCache=!0,o=!1,n&&(r=[].concat(y)),i=[],a=y.length,l=0;l<a;l++)c=(u=y[l]).row,f=u.col,h=te(u),p=ne(u),f>=e?f<e+t?f+p<=e+t?(i.push(l),o=!0):(m.update(l,s.kf(c,e,h,f+p-(e+t))),o=!0):(m.update(l,s.kf(c,f-t,h,p)),o=!0):e<f+p&&(d=s.kf(c,f,h,p-w(f+p-e,t)),m.update(l,d),1===d.rowCount&&1===d.colCount&&i.push(l),o=!0);for(l=i.length-1;l>=0;l--)g=i[l],m.removeSpan(g,1);m.suspendUpdatingCache=!1,o&&re(m,y),n&&(o?(n[0].push("spans"),n[1]=r):n.length=0)},e.prototype.toJSON=function(){var e=[].concat(this.spans);return 0===e.length?b:e},e.prototype.fromJSON=function(e){var t,n,o;if(e)for(this.spans=[],t=e,n=0;n<t.length;n++)o=t[n],this.add(s.kf(o.row,o.col,te(o),ne(o)))},e}(),(L=function(){function e(){Array.apply(this,arguments)}return e.prototype.pop=function(){return v},e.prototype.push=function(e){return 0},e.prototype.splice=function(e,t){var n,o=[];for(n=2;n<arguments.length;n++)o[n-2]=arguments[n];return v},e.prototype.slice=function(e,t){return null},e}()).prototype=[],z=function(e){function t(){var t=e.call(this)||this;return t.headingOverflowlayouts=v,t.trailingOverflowLayouts=v,t}return K(t,e),t.prototype.find=function(e){var t,n,o=this.length,r=[];for(n=0;n<o;n++)(t=this[n]).contains(e)&&r.push(t);return r},t}(L),t.np=z,V=function(){function e(e,t,n,o,r,i,a,s){var l=this;l.column=e,l.startColumn=t,l.endColumn=n,l.valueWidth=o,l.columnWidth=r,l.backgroundWidth=i,l.backgroundLeftWidth=a,l.backgroundRightWidth=s}return e.prototype.contains=function(e){return e>=this.startColumn&&e<=this.endColumn},e}(),t.op=V,G=function(){function e(){this.selections=[],this.selectionPolicy=2,this.selectionUnit=0}return e.prototype.getProperty=function(e){return this[e]},e.prototype.setProperty=function(e,t,n){n&&(n[0].push(e),n[1]=this[e]),this[e]=t},e.prototype.clear=function(e){e&&(e.push(["selections",this.get()]),e.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=[],this.activeSelectedRangeIndex=-1},e.prototype.add=function(e,t,n,o,r){r&&(r.push(["selections",this.get()]),r.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex]));var i=this,a=i.selectionPolicy,l=i.selectionUnit;0===a?(n=w(n,1),o=w(o,1),i.clear()):1===a&&i.clear(),1===l?(t=-1,o=-1):2===l&&(e=-1,n=-1),i.selections.push(s.kf(e,t,n,o)),i.activeSelectedRangeIndex=i.selections.length-1},e.prototype.get=function(){return[].concat(this.selections)},e.prototype.set=function(e,t){t&&(t.push(["selections",this.get()]),t.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=e,this.activeSelectedRangeIndex>=e.length&&(this.activeSelectedRangeIndex=0)},e.prototype.toJSON=function(){var e,t=this,n={},o=t.selectionPolicy,r=t.selectionUnit,i=t.activeSelectedRangeIndex,a=t.selections.length;for(2!==o&&(n.selectionPolicy=o),0!==r&&(n.selectionUnit=r),0!==i&&(n.activeSelectedRangeIndex=i),n.length=a,e=0;e<a;e++)n[e]=t.selections[e];return g(n)?b:n},e.prototype.fromJSON=function(e){var t,n,o,r,i,a;if(e){for((t=this).clear(),n=e.selectionPolicy,o=e.selectionUnit,r=e.length,D(r)&&(r=1),i=0;i<r;i++)a=e[i],t.selections.push(s.kf(a?a.row:0,a?a.col:0,a?te(a):1,a?ne(a):1));t.activeSelectedRangeIndex=e.activeSelectedRangeIndex||0,D(n)||(t.selectionPolicy=n),D(o)||(t.selectionUnit=o)}},e.prototype.sp=function(e){var t,n,o,r=this.selections;for(t=0;t<r.length;t++)if(o=-1===(n=r[t]).col?0:n.col,-1===n.row&&e>=o&&e<o+ne(n))return!0;return!1},e.prototype.tp=function(e){var t,n,o,r=this.selections;for(t=0;t<r.length;t++)if(o=-1===(n=r[t]).row?0:n.row,-1===n.col&&e>=o&&e<o+te(n))return!0;return!1},e.prototype.vp=function(e,t,n,o,r,i){var a,s,l,u,c,f,h,p,d=!1,g=this.selections,m=i?1:0;for(a=0,s=g.length;a<s&&(c=(u=se(l=g[a],o,r)).row,f=u.col,h=c-m<=e&&e<c+te(u)+m,p=f-m<=t&&t<f+ne(u)+m,3===n||D(n)?d=h&&p:2===n?d=h:1===n?d=p:0===n&&(d=-1===l.row&&-1===l.col),!d);a++);return d},e.prototype.wp=function(e,t,n,o,r){var i,a,s,l,u,c,f,h,p,d,g=this.selections,m=!1;for(i=0;i<g.length&&(s=(a=g[i]).row,l=a.col,u=te(a),c=ne(a),f=-1===l,h=-1===s,D(n)||3===n||(2===n?(p=h?0:s,m=f&&e>=p&&e<p+u):1===n?(d=f?0:l,m=h&&t>=d&&t<d+c):0===n&&(m=h&&f&&u===o&&c===r),!m));i++);return m},e}(),W=function(e){function t(){return e.call(this)||this}return K(t,e),t.prototype.findCell=function(e,t){var n,o,r=this.length;for(o=0;o<r;o++)if((n=this[o]).contains(e,t))return n;return v},t.prototype.findRow=function(e){var t,n,o=this.length;for(n=0;n<o;n++)if((t=this[n]).row===e)return t;return v},t.prototype.findCol=function(e){var t,n,o=this.length;for(n=0;n<o;n++)if((t=this[n]).col===e)return t;return v},t.prototype.findX=function(e){return le(this,b,b,e)},t.prototype.findY=function(e){return le(this,b,b,b,e)},t.prototype.findNearX=function(e){return ue(this,e)},t.prototype.findNearY=function(e){return ue(this,b,e)},t}(L),t.yp=W,U=function(){function e(e,t,n,o,r,i,a,s,l){var u=this;u.rowCount=a,u.colCount=s,u.row=e,u.col=t,u.x=n,u.y=o,u.width=r,u.height=i,u.isAutoMerge=l}return e.prototype.contains=function(e,t){var n=this;return e<n.row+te(n)&&n.row<=e&&t<n.col+ne(n)&&n.col<=t},e.prototype.intersect=function(e){var t=this;return(t.x<0||e.x<t.x+t.width&&t.x<e.x+e.width)&&(t.y<0||e.y<t.y+t.height&&t.y<e.y+e.height)},e.prototype.containsX=function(e){return this.x<=e&&e<this.x+this.width},e.prototype.containsY=function(e){return this.y<=e&&e<this.y+this.height},e}(),t.zp=U,Z=function(){function e(e,t){var n=this;n.Xj=e,n.OZ=t,n.ad()}return e.prototype.ad=function(){var e=this;e.dataTable={},e.rowDataArray=[],e.columnDataArray=[],e.defaultDataNode=v,e.Ap={},e.gga=0,e.Ff=-1,e.Ef=-1},e.prototype.getRowCount=function(){return this.Xj},e.prototype.getColumnCount=function(){return this.OZ},e.prototype.setRowCount=function(e){this.Xj=e},e.prototype.setColumnCount=function(e){this.OZ=e},e.prototype.Cp=function(e,t,n,o){var r,i,a,s,l=this.Ap;this.gga>0||e>=0&&t>=0&&(o&&(o.type="updateDirty",o.row=e,o.col=t,l[e]?l[e][t]||(o.isEmptyCol=!0):o.isEmptyRow=!0),l[e]||(l[e]={}),(r=l[e])[t]||(r[t]={}),i=r[t],"n"!==r.rs&&(r.rs="e"),a=n.Dp,s=n.Ep,D(a)||(o&&(o.originalItem=r.originalItem),r.originalItem=a),D(s)||(o&&(o.oldValue=i.oldValue),i.oldValue=s))},e.prototype.gWa=function(e){var t=this.Ap,n=e.row,o=e.col;e.isEmptyRow&&t?delete t[n]:e.isEmptyCol&&t[n]?delete t[n][o]:(e.hasOwnProperty("originalItem")&&(D(e.originalItem)&&!D(t[n].originalItem)?delete t[n].originalItem:t[n].originalItem=e.originalItem),e.hasOwnProperty("oldValue")&&(D(e.oldValue)&&!D(t[n][o].oldValue)?delete t[n][o].oldValue:t[n][o].oldValue=e.oldValue))},e.prototype.getValue=function(e,t,n){var o=this.RTa(e,t);return o&&!D(o.value)?1!==n?j(o.value):D(o.value.richText)?o.value:m(!0,{},o.value):v},e.prototype.setValue=function(e,t,n,o,r){var i,a=this.RTa(e,t,!0,o?o[0]:b);!a||D(a.value)&&D(n)||a.value===n?o&&(o.length=0):(i=a.value,a.value=n,this.Cp(e,t,{Ep:i},r),o&&(o[0].push("value"),o[1]=i))},e.prototype.getStyle=function(e,t,n){var o=this.RTa(e,t),r=o&&o.style;return r&&n&&r.clone&&(r=r.clone(!0)),r},e.prototype.setStyle=function(e,t,n,o){var r,i=this.RTa(e,t,!0,o?o[0]:b);i&&i.style!==n?(r=i.style,i.style=n,o&&(o[0].push("style"),o[1]=r)):o&&(o.length=0)},e.prototype.getCellState=function(e,t){var n=this.RTa(e,t);return n?n.cellState:v},e.prototype.setCellState=function(e,t,n,o){var r,i,a=this.getCellState(e,t)||0;0!==(r=o?a|n:a&~n)?(i=this.RTa(e,t,!0,b,!0))&&(i.cellState=r):((i=this.RTa(e,t))&&delete i.cellState,g(i)&&(Se(this.dataTable,e,t),g(this.dataTable[e])&&delete this.dataTable[e]))},e.prototype.getValueForKey=function(e,t,n){var o=this.RTa(e,t);return o&&o[n]},e.prototype.setValueForKey=function(e,t,n,o,r){var i,a=this.RTa(e,t,!0,r?r[0]:b);a&&a[n]!==o?(i=a[n],a[n]=o,r&&(r[0].push(n),r[1]=i)):r&&(r.length=0)},e.prototype.NTa=function(e,t,n){var o,r=this,i=r.Xj,a=r.dataTable,s=r.Ap;if(0<=e&&e<=i&&t>=0&&(k(a,i,e,t),k(r.rowDataArray,i,e,t),k(s,i,e,t),r.Xj+=t,!n))for(o=0;o<t;o++)a[e+o]={rs:"n"},s[e+o]={rs:"n"}},e.prototype.STa=function(e,t,n){var o,r,i=this,a=i.Xj;if(0<=e&&e<a&&t>0){if(e+t>a&&(t=a-e),n)for(o=0;o<t;o++)r=e+o,n.push([["dataTable",r],i.dataTable[r]]),n.push([["rowDataArray",r],i.rowDataArray[r]]),n.push([[S,r],i.Ap[r]]);E(i.dataTable,a,e,t),E(i.rowDataArray,a,e,t),E(i.Ap,a,e,t),i.Xj-=t}},e.prototype.OTa=function(e,t){var n,o,r=this,i=r.OZ;if(0<=e&&e<=i&&t>=0){for(n=0;n<r.Xj;n++)(o=r.dataTable[n])&&e<i&&k(o,i,e,t);k(r.columnDataArray,i,e,t),r.OZ+=t}},e.prototype.TTa=function(e,t,n){var o,r,i,a,s,l,u=this,c=u.OZ;if(0<=e&&e<c&&t>0){for(o=0;o<u.Xj;o++)if(r=u.dataTable[o]){if(n)for(i=0;i<t;i++)a=e+i,n.push([["dataTable",o,a],r[a]]);E(r,c,e,t)}if(n)for(s=0;s<t;s++)l=e+s,n.push([["columnDataArray",l],u.columnDataArray[l]]);E(u.columnDataArray,c,e,t),e+t>c&&(t=c-e),u.OZ-=t}},e.prototype.RTa=function(e,t,n,o,r){var i,a=this,s=a.dataTable,l=a.columnDataArray,u=a.rowDataArray,c=v;return e<a.Xj&&t<a.OZ&&(e>=0&&t>=0?(i=s[e],n&&(i||(i=s[e]={}),!r&&e>a.Ef&&(a.Ef=e)),i&&(c=i[t],n&&(c||(c=i[t]={}),!r&&a.Ff<t&&(a.Ff=t))),o&&o.push("dataTable",e,t)):-1===e&&t>=0?(c=l[t],n&&(c||(c=l[t]={}),!r&&a.Ff<t&&(a.Ff=t)),o&&o.push("columnDataArray",t)):e>=0&&-1===t?(c=u[e],n&&(c||(c=u[e]={}),!r&&a.Ef<e&&(a.Ef=e)),o&&o.push("rowDataArray",e)):-1===e&&-1===t&&(c=a.defaultDataNode,n&&!c&&(c=a.defaultDataNode={}),o&&o.push("defaultDataNode"))),c},e.prototype.setNode=function(e,t,n){var o,r=this,i=r.dataTable,a=r.columnDataArray,s=r.rowDataArray;e<r.Xj&&t<r.OZ&&(e>=0&&t>=0?((o=i[e])||(o=i[e]={}),o[t]=n):-1===e&&t>=0?a[t]=n:-1===t&&e>=0&&(s[e]=n))},e.prototype._f=function(e,t,n,o,r){var i,a,s,l,u,c,f,h,p,d,g,m,y;r&&(i=[],a=[]),l=(s=this).dataTable,u=s.rowDataArray,c=s.columnDataArray,f=s.Ap,h=s.RTa(e,t,b,i),p=f[e]&&f[e][t],d=f[e]&&f[e].originalItem,g=s.RTa(n,o,b,a),m=f[n]&&f[n][o],y=f[n]&&f[n].originalItem,r&&(r.push([i,h]),r.push([a,g])),h?fe(e,t,n,o,h,l,u,c):g&&fe(e,t,n,o,v,l,u,c),g?fe(n,o,e,t,g,l,u,c):h&&fe(n,o,e,t,v,l,u,c),p?he(0,0,n,o,p,f,d):m&&he(0,0,n,o,v,f,d),m?he(0,0,e,t,m,f,y):p&&he(0,0,e,t,v,f,y)},e.prototype.Yea=function(e){e++;for(var t=this.Xj,n=this.dataTable;e>=0&&e<t&&!n[e];)e++;return e<t?e:-1},e.prototype.Hl=function(e,t){var n=this,o=v,r=n.OZ;if(e>=0&&e<n.Xj&&(o=n.dataTable[e]),o){for(t++;t>=0&&t<r&&!o[t];)t++;if(t<r)return t}return-1},e.prototype.yIb=function(e){var t,n,o,r,i,a=e.row,s=e.col,l=e.rowCount,u=e.colCount;for(t=a,n=0;n<l;n++,t++)for(o=s,r=0;r<u;r++,o++)(i=this.RTa(t,o))&&(i.value=v)},e.prototype._Sb=function(e,t,n){var o=n&&n.getFormatter(e,t);return!!O(o)&&o},e.prototype.clear=function(e,t,n,o,r,a,s){var l,u,c,f,h,p,d,g=this,m=g.Xj,y=g.OZ,C=[],x=!!s,A=[];if(e>=0&&t>=0){if(n=w(n,m-e),o=w(o,y-t),n>0&&o>0)for(c=e;c<e+n;c++)if(!a||i.Common.k.Cb(a,c)<0)for(u=t;u<t+o;u++)x&&(f=[]),(l=g.RTa(c,u,b,f))&&(C.push(l),x&&A.push(f),(1&r)>0&&!D(l.value)&&(h=void 0,x&&(h={}),g.Cp(c,u,{Ep:l.value},h),h&&s.push(h)))}else if(e>=0&&-1===t){if((n=w(n,m-e))>0)for(c=e;c<e+n;c++)x&&(f=[]),(l=g.RTa(c,-1,b,f))&&(C.push(l),x&&A.push(f))}else if(-1===e&&t>=0){if((o=w(o,y-t))>0)for(u=t;u<t+o;u++)x&&(f=[]),(l=g.RTa(-1,u,b,f))&&(C.push(l),x&&A.push(f))}else-1===e&&-1===t&&(x&&(f=[]),(l=g.RTa(-1,-1,b,f))&&(C.push(l),x&&A.push(f)));for(p=function(e){if(l=C[e]){var t=x?[]:b;(8&r)>0&&(t&&t.push(["tag",l.tag]),l.tag=v),(2&r)>0&&(t&&t.push(["style",l.style]),l.style=v),(1&r)>0&&(t&&t.push(["value",l.value]),l.value=v),(16&r)>0&&(t&&t.push(["sparkline",l.sparkline]),l.sparkline=v),(64&r)>0&&(t&&t.push(["bindingPath",l.bindingPath]),l.bindingPath=v),(256&r)>0&&(t&&t.push(["hyperlink",l.hyperlink]),l.hyperlink=v),(4&r)>0&&(t&&t.push(["comment",l.comment]),l.comment=v),x&&t.forEach((function(t){var n=[].concat(A[e]);n.push(t[0]),t[0]=n,s.push(t)}))}},d=0;d<C.length;d++)p(d)},e.prototype.toJSON=function(e,t,n){var o,r,i,a,s,l,u,c,f,h,p,d,m,y,C,w,x,A,M,S,T,N,I,R=n&&n.parent&&!g(n.parent.QHb);function k(e,o,r,i,a,s){var l,u,c,f,h,p,d,g,m;return r?(l={},u=r.value,D(u)||(l.value=u),t&&t.saveAsView&&(c=void 0,s?c=s:R&&(c=n&&n.getFormatter(e,o)),O(c)&&(f=n.aHb(e,o,c,u),D(f)||(l.value=f))),t&&t.ignoreStyle||("string"==typeof(h=r.style)?l.style=h:h&&((p=h.toJSON(i,a))&&(p.name=b,l.style=p))),d=r.bindingPath,D(d)||(l.bindingPath=d),g=r.tag,D(g)||(l.tag=g),m=r.hyperlink,D(m)||(l.hyperlink=F(m)),l):v}if(r={},i={},a=(o=this).Xj,s=o.OZ,l=o.dataTable,u=o.rowDataArray,c=o.columnDataArray,t&&t.saveAsView)for(p=0;p<a;){for(d={},m=!1,y=l[p],C=0;C<s;)w={},y&&y[C]||c[C]?w=k(p,C,o.RTa(p,C,!0)):3===e&&R&&((x=this._Sb(p,C,n))&&(w=k(p,C,o.RTa(p,C,!0),3,!1,x))),g(w)||(d[C]=w,m=!0),C++;m&&(i[p]=d),p++}else for(f=o.Yea(-1);f>=0;){for(d={},m=!1,h=o.Hl(f,-1);h>=0;)(A=o.RTa(f,h))&&(w=k(f,h,A),g(w)||(d[h]=w,m=!0)),h=o.Hl(f,h);m&&(i[f]=d),f=o.Yea(f)}for(g(i)||(r.dataTable=i),M=[],f=0;f<a;f++)ee(u,f)&&u[f]&&(S=k(f,-1,u[f]),g(S)||(M[f]=S));for(M.length>0&&(r.rowDataArray=M),T=[],h=0;h<s;h++)ee(c,h)&&c[h]&&(N=k(-1,h,c[h]),g(N)||(T[h]=N));return T.length>0&&(r.columnDataArray=T),I=k(-1,-1,o.defaultDataNode,e,!0),g(I)||(r.defaultDataNode=I),r},e.prototype.fromJSON=function(e,t,n,o,r){var i,a,s,l,u,c,f,h,p,d=n&&n.incrementalLoading;if(e){if((i=this).ad(),i.gga++,a=e.dataTable,u=i.Xj,c=i.OZ,a?d&&3===o?ce(i,a,u,c,n,t,b,r):function(e,t,n,o,r,i){var a,s,l,u;for(a=0;a<n;a++)if(s=t[a])for(l=0;l<o;l++)(u=s[l])&&pe(u,e.RTa(a,l,!0),i,a,l,r)}(i,a,u,c,n,t):d&&r&&setTimeout(r,0),f=e.rowDataArray||e.Hf)for(s=0;s<u;s++)ee(f,s)&&f[s]&&pe(f[s],i.RTa(s,-1,!0),t,s,-1,n);if(h=e.columnDataArray||e.If)for(l=0;l<c;l++)ee(h,l)&&h[l]&&pe(h[l],i.RTa(-1,l,!0),t,-1,l,n);(p=e.defaultDataNode||e.Jf)&&pe(p,i.RTa(-1,-1,!0),t,-1,-1,n),i.gga--}else d&&r&&setTimeout(r,0)},e}(),q=function(){function e(){this.infos=[]}return e.prototype.uL=function(e,t){var n=this.infos,o=n.length;0<=e&&e<=o&&t>0&&k(n,o,e,t)},e.prototype.UTa=function(e,t,n){var o,r,i=this.infos,a=i.length;if(0<=e&&e<a&&t>0){if(t=w(t,a-e),n)for(o=0;o<t;o++)r=e+o,n.push([["infos",r],i[r]]);E(i,a,e,t)}},e.prototype.VTa=function(){return this.infos.length},e.prototype.Hp=function(){return this.infos},e.prototype.Jp=function(e){return this.infos[e]},e.prototype.Kp=function(e,t,n){var o=this.infos[e];this.infos[e]=t,n&&(n[0].push("infos",e),n[1]=o)},e.prototype.getSize=function(e){var t=this.infos[e],n=v;return t&&(!1===t.visible?n=0:"number"==typeof t.size&&(n=x(t.size))),n},e.prototype.getActualSize=function(e){var t=this.infos[e];return t?x(t.size):v},e.prototype.setSize=function(e,t,n){var o,r=this.infos,i=r[e];i||(i=r[e]={}),(o=i.size)!==t&&(i.size=t),n&&(n[0].push("infos",e,"size"),n[1]=o)},e.prototype.getStarSize=function(e){var t=this.infos[e];return t?t.starSize:b},e.prototype.setStarSize=function(e,t,n){var o,r=this.infos,i=this.infos[e];i||(i=r[e]={}),o=i.starSize,D(t)&&D(o)||(o!==t&&(D(t)?delete i.starSize:i.starSize=t),n&&(n[0].push("infos",e,"starSize"),n[1]=o))},e.prototype.toJSON=function(e){var t,n,o,r,i,a,s,u,c=this.infos,f=[];if(e&&e.ignoreStarSize)for(t=0;t<c.length;t++)D(c[t])||(o=(n=c[t]).cellType,r=$(n,["cellType"]),f[t]=F(r),o&&(o.toJSON&&(o=o.toJSON()),i=h._o,a=o.typeName,(s=i[o.type]||i[a]||l.getTypeFromString(a))&&((u=new s).fromJSON(o,e),f[t].cellType=u)),delete f[t].starSize);else for(t=0;t<c.length;t++)D(c[t])||(f[t]=c[t]);return f.length>0?f:b},e.prototype.fromJSON=function(e){e&&(this.infos=e)},e}(),J=q.prototype,d({visible:!0,resizable:!0,pageBreak:!1},(function(e,t){var n=e[0].toUpperCase()+e.substr(1);J["get"+n]=function(n){var o=t,r=this.infos[n];return r&&!D(r[e])&&(o=r[e]),o},J["set"+n]=function(t,n,o){var r,i=this.infos,a=i[t];a||(a=i[t]={}),(r=a[e])!==n&&(a[e]=n),o&&(o[0].push("infos",t,e),o[1]=r)}})),Q=function(){function e(e){this.modelManager=e,this.anchors={},this.cells={},this.invalidAnchors={}}return e.prototype.no=function(){this.modelManager=v},e.prototype.getAnchorCell=function(e,t){return Ae(this.anchors,e,t)},e.prototype.getAnchorItem=function(e,t){return Ae(this.cells,e,t)},e.prototype.getAnchorInfo=function(e,t,n){var o,r,i,a,s=this,l=s.anchors,u=s.getAnchorCell(e,t);if(u)return u;if(o=s.getAnchorItem(e,t))for(i in r=o.anchorRefs)if(r[i]&&(a=Me(l,i),n||a.isValid))return a},e.prototype.isCellHasItsOwnValue=function(e,t,n){var o,r,i,a,s=this.getAnchorItem(e,t);if(s){if(!D(s.value)||s.AIb)return!0;for(i in o=s.anchorRefs,r=this.anchors,o)if(n!==i&&o[i]&&((a=Me(r,i))&&a.isValid))return!0}return!1},e.prototype.removeRef=function(e,t,n,o,r,i){var a,s,l,u,c,f,h,p,d,m,y,b=this.cells,C=t.isValid,w=t.row,x=t.col,A=t.rowCount,M=t.colCount,S=1;for(a=0,s=w;a<A;a++,s++){for(l=x+S;S<M;S++,l++){if(c=(u=Ae(b,s,l))&&u.anchorRefs,f=!0,C){if(h=e.getValue(s,l),p=u&&u.value,D(p)){if(m=!(d=u&&u.AIb)||d===n,c)for(y in c)if(y!==n&&c[y]){f=!1;break}m?ve(o,s,l,v,h,t.row===s&&t.col===l):p=h}r&&ye(r,s,l,p)}c&&(delete c[n],f&&i&&g(c)&&Se(b,s,l,!0))}S=0}},e.prototype.BIb=function(e,t,n,o,r){var i,a,l,u=e.getRowCount(),c=e.getColumnCount();return!(t+o>u||n+r>c||o*r>5e5||(i=e.getSheet(),a=s.kf(t,n,o,r),i._modelManager.getSpans(a).length||(l=i.tables,l&&l.rn&&l.rn(t,n,o,r))))},e.prototype.setArray=function(e,t,n,o,r,i){var s,l,u,c,f,h,d,g,m,y,b,C,w,x,A,M,S,T,N=this,I=Ce(t,n),R=N.anchors,k=Ae(R,t,n),E=N.cells;if(k&&!i)return[k,(s=N.updateItem(e,t,n))[0],s[1]];if(l={},u={},c=!1,k&&k.isValid&&(c=!0,N.removeRef(e,k,I,l,u,!0)),f=k,me(R,t,n,k={row:t,col:n,rowCount:o,colCount:r,values:i,isValid:!1}),h=e.getCalcService().CIb,k.CIb=h,d=f&&f.CIb===h&&(o!==f.rowCount||r!==f.colCount),(g=e.q$a)&&Ae(N.invalidAnchors,t,n))ve(l,t,n,p&&a.Errors.Spill,v,k.row===t&&k.col===n),N.DIb(t,n,o,r,E,g,u,e,I,!0);else if(i){if(m=be(u,t,n,e),(y=!d&&N.BIb(e,t,n,o,r))&&(N.DIb(t,n,o,r,E,g,u,e,I),!g))for(b=1,C=0,w=t;C<o;C++,w++){for(x=n+b;b<r;b++,x++)if(A=be(u,w,x,e),!D(A)&&N.isCellHasItsOwnValue(w,x,I)){if(y=!1,!c)break;me(l,w,x,A,!0)}if(!c&&!y)break;b=0}if(y)for(C=0,w=t;C<o;C++,w++)for(M=i[C],b=0,x=n;b<r;b++,x++)A=be(u,w,x,e),T=S=M[b],D(S)?T=0:p&&(a.Convert.Ca(S)||a.Convert._isReference(S))&&(T=1===S.getRowCount()&&1===S.getColumnCount()?a.Convert.Ca(S)?S.getValue(0,0):S.getValue(0,0,0):a.Errors.Calc),ve(l,w,x,T,A,k.row===w&&k.col===x),(C||b)&&(Ae(E,w,x).AIb=I);else ve(l,t,n,p&&a.Errors.Spill,m,k.row===t&&k.col===n);k.isValid=y,f&&y!==f.isValid&&N.modelManager.EIb(t,n,!y)}return[k,l,[f]]},e.prototype.DIb=function(e,t,n,o,r,i,a,s,l,u){var c,f,h,p,d=1;for(c=0;c<n;c++){for(f=e+c;d<o;d++)h=t+d,(p=!u&&Ae(r,f,h))||(p={anchorRefs:{}},i&&!u||(p.value=be(a,f,h,s)),me(r,f,h,p)),p.anchorRefs[l]=!0;d=0}},e.prototype.updateItem=function(e,t,n,o,r,i){var a,s,l,u,c,f,h;if(void 0===r&&(r={}),void 0===i&&(i=[]),a=Ce(t,n),(u=Ae(l=(s=this).anchors,t,n))&&(s.removeRef(e,u,a,r,b,!0),Se(r,t,n),Se(l,t,n,!0)),c=Ae(s.cells,t,n))for(h in s.modelManager.FIb(t,n,c.value),c.value=o,delete c.AIb,f=c.anchorRefs)f[h]&&we(i,Me(l,h));if(u||c)return[u&&r,i]},e.prototype.GIb=function(e,t){me(this.invalidAnchors,e,t,!0)},e.prototype.HIb=function(){this.invalidAnchors={}},e.prototype.IIb=function(e,t,n){var o,r,i,a,s,l,u,c=this,f=c.anchors,h=[];for(o in f)if(f.hasOwnProperty(o))for(s in i=(r=+o)>=t,a=f[o])a.hasOwnProperty(s)&&(l=+s,i||(i=(u=a[s])&&u.rowCount+r>=t),i&&h.push([r,l]));h.length&&h.forEach((function(t){c.updateItem(e,t[0],t[1],b)}))},e.prototype.NTa=function(e,t,n){this.IIb(e,t,n)},e.prototype.PTa=function(e,t,n){this.IIb(e,t,n)},e.prototype.JIb=function(e,t){var n,o,r,i,a,s,l,u=this,c=u.anchors,f=[];for(n in c)if(c.hasOwnProperty(n))for(i in o=+n,r=c[n])r.hasOwnProperty(i)&&((s=(a=+i)>=t)||(s=(l=r[i])&&l.colCount+a>=t),s&&f.push([o,a]));f.length&&f.forEach((function(t){u.updateItem(e,t[0],t[1],b)}))},e.prototype.OTa=function(e,t,n){this.JIb(e,t)},e.prototype.QTa=function(e,t,n){this.JIb(e,t)},e}(),t.KIb=Q,t.clearSpillValuesOnAddRemove=Te,Y=function(){function e(t,n,o,r,i,a){var s,l,u,c;function f(e,t,n,o){s.WTa>0&&s.zTa.push([["defaults",n],o]),s.kj.$p()}this.LIb=[],(s=this).kj=t,s.sheetModels=[b,new Z(r,o),new Z(n,i),new Z(n,o)],(l=s.rowInfos=[])[0]=l[1]=new q,l[2]=l[3]=new q,(u=s.colInfos=[])[0]=u[2]=new q,u[1]=u[3]=new q,s.spanModels=[b,new B,new B,new B],s.selectionModel=new G,s.ZHb=new Q(s),s.name=a||"",s.isSelected=!1,s.zoomFactor=1,oe(c=s.defaults={},"rowHeight",20,f),oe(c,"colWidth",62,f),oe(c,"rowHeaderColWidth",40,f),oe(c,"colHeaderRowHeight",20,f),oe(c,"_isExcelDefaultColumnWidth",!1,f),s.WTa=0,e.ao(this,"init"),s.Agc(n,o)}return e.prototype.Agc=function(e,t){this.zgc({type:c.AxisInfoChangeType.setRowCount,count:e}),this.zgc({type:c.AxisInfoChangeType.setColumnCount,count:t})},e.prototype.zgc=function(e){var t,n,o,r,i,a,s,l,u,f,h,p,d,g=this,m=g.kj,y=e.type,v=e.sheetArea;if((void 0===v?c.SheetArea.viewport:v)===c.SheetArea.viewport){if(D(g.Bgc)&&(g.Bgc=[]),D(g.Cgc)&&(g.Cgc=[]),g.Dgc)return void g.Egc(e);switch(t=g.Bgc,n=g.Cgc,y){case c.AxisInfoChangeType.setRowCount:if((i=(o=e.count)-(r=t.length))>0)for(a=xe(R,i),s=0;s<a.length;s++)t.splice(r+s,0,a[s]);else t.length=o;break;case c.AxisInfoChangeType.setColumnCount:if((i=(o=e.count)-(r=n.length))>0)for(a=xe(R,i),s=0;s<a.length;s++)n.splice(r+s,0,a[s]);else n.length=o;break;case c.AxisInfoChangeType.addRows:for(l=e.index,o=e.count,u=xe(R,o),s=0;s<u.length;s++)t.splice(l+s,0,u[s]);break;case c.AxisInfoChangeType.deleteRows:l=e.index,o=e.count,t.splice(l,o);break;case c.AxisInfoChangeType.addColumns:for(l=e.index,o=e.count,u=xe(R,o),s=0;s<u.length;s++)n.splice(l+s,0,u[s]);break;case c.AxisInfoChangeType.deleteColumns:l=e.index,o=e.count,n.splice(l,o);break;case c.AxisInfoChangeType.setRowHeight:case c.AxisInfoChangeType.setRowVisible:l=e.index,f=e.value,t[l]=f;break;case c.AxisInfoChangeType.setColumnWidth:case c.AxisInfoChangeType.setColumnVisible:l=e.index,f=e.value,n[l]=f;break;case c.AxisInfoChangeType.filterRows:for(p=0,d=h=e.index;p<d.length;p++)l=d[p],f=m.getRowHeight(l),t[l]=f;break;case c.AxisInfoChangeType.outlineExpandRows:for(h=e.index,s=0;s<h.length;s++)l=h[s],f=m.getRowHeight(l),t[l]=f;break;case c.AxisInfoChangeType.outlineExpandColumns:for(h=e.index,s=0;s<h.length;s++)l=h[s],f=m.getColumnWidth(l),n[l]=f}}},e.prototype.Fgc=function(e){if(this.Bgc){var t=this.Bgc[e];return t===R?this.defaults.rowHeight:t}},e.prototype.Ggc=function(e){if(this.Cgc){var t=this.Cgc[e];return t===R?this.defaults.colWidth:t}},e.prototype.wgc=function(){this.Dgc=[]},e.prototype.ygc=function(){var e,t,n,o=this,r=o.Dgc;if(o.Dgc=v,r)for(e=0,t=r;e<t.length;e++)n=t[e],o.zgc(n)},e.prototype.Egc=function(e){this.Dgc&&this.Dgc.push(e)},e.prototype.xgc=function(){this.Bgc=v,this.Cgc=v},e.prototype.no=function(t){if(!1!==t){var n=this;n.kj=v,n.sheetModels=v,n.ZHb&&(n.ZHb.no(),n.ZHb=v),n.xgc()}e.ao(this,"dispose",{clearCache:t})},e.prototype.addRows=function(t,n,o,r){var i,a=this;a.WTa>0&&(i={row:t,rowCount:n,type:"addRows"},a.zTa.push(i)),a._getSheetModel(3).NTa(t,n,r),a._getSheetModel(2).NTa(t,n,r),a.zl(3).NTa(t,n),a.zl(2).NTa(t,n),a.YTa(!0,3).uL(t,n),p&&a.ZHb.NTa(a.kj.yj(),t,n),o||e.ao(a,"addRows",{row:t,rowCount:n,changes:a.zTa}),a.zgc({type:c.AxisInfoChangeType.addRows,index:t,count:n})},e.prototype.ZTa=function(t){var n=this,o=t.row,r=t.rowCount;Te(n,o,0,0,!0),n.deleteRows(o,r,!0),e.ao(n,"undoAddRows",{row:o,rowCount:r})},e.prototype.deleteRows=function(t,n,o){var r,i,a,s,l,u,f,h,d,g=this;if(g.WTa>0&&(i=[],a=[],s=[["spanModels",3],b],l=[["spanModels",2],b],u=[],r={row:t,rowCount:n,type:"deleteRows"},g.zTa.push(r)),g._getSheetModel(3).STa(t,n,i),g._getSheetModel(2).STa(t,n,a),g.zl(3).PTa(t,n,s),g.zl(2).PTa(t,n,l),g.YTa(!0,3).UTa(t,n,u),p&&g.ZHb.PTa(g.kj.yj(),t,n),o||e.ao(g,"deleteRows",{row:t,rowCount:n,changes:g.zTa}),r){for(f=r.changes=[],h=["sheetModels",3],d=0;d<i.length;d++)i[d][0]=h.concat(i[d][0]),f.push(i[d]);for(h=["sheetModels",2],d=0;d<a.length;d++)a[d][0]=h.concat(a[d][0]),f.push(a[d]);for(s.length>0&&f.push(s),l.length>0&&f.push(l),h=[N,3],d=0;d<u.length;d++)u[d][0]=h.concat(u[d][0]),f.push(u[d])}g.zgc({type:c.AxisInfoChangeType.deleteRows,index:t,count:n})},e.prototype.$Ta=function(e){var t,n,o,r=this,i=e.row,a=e.rowCount;for(Te(r,i,0,0,!0),r.addRows(i,a,!0,!0),n=(t=e.changes).length-1;n>=0;n--)de(r,t[n]);(o=r.kj&&r.kj.Ts)&&o.splice(o.length-a,a)},e.prototype.addColumns=function(t,n,o){var r,i=this;i.WTa>0&&(r={col:t,colCount:n,type:"addColumns"},i.zTa.push(r)),i._getSheetModel(3).OTa(t,n),i._getSheetModel(1).OTa(t,n),i.zl(3).OTa(t,n),i.zl(1).OTa(t,n),i.YTa(!1,3).uL(t,n),p&&i.ZHb.OTa(i.kj.yj(),t,n),o||e.ao(i,"addColumns",{col:t,colCount:n,changes:i.zTa}),i.zgc({type:c.AxisInfoChangeType.addColumns,index:t,count:n})},e.prototype._Ta=function(e){var t=e.col,n=e.colCount;Te(this,t,0,0,!1),this.deleteColumns(t,n,!0)},e.prototype.deleteColumns=function(t,n,o){var r,i,a,s,l,u,f,h,d,g=this;if(g.WTa>0&&(i=[],a=[],s=[["spanModels",3],b],l=[["spanModels",1],b],u=[],r={col:t,colCount:n,type:"deleteColumns"},g.zTa.push(r)),g._getSheetModel(3).TTa(t,n,i),g._getSheetModel(1).TTa(t,n,a),g.zl(3).QTa(t,n,s),g.zl(1).QTa(t,n,l),g.YTa(!1,3).UTa(t,n,u),p&&g.ZHb.QTa(g.kj.yj(),t,n),o||e.ao(g,"deleteColumns",{col:t,colCount:n,changes:g.zTa}),r){for(f=r.changes=[],h=["sheetModels",3],d=0;d<i.length;d++)i[d][0]=h.concat(i[d][0]),f.push(i[d]);for(h=["sheetModels",1],d=0;d<a.length;d++)a[d][0]=h.concat(a[d][0]),f.push(a[d]);for(s.length>0&&f.push(s),l.length>0&&f.push(l),h=[I,3],d=0;d<u.length;d++)u[d][0]=h.concat(u[d][0]),f.push(u[d])}g.zgc({type:c.AxisInfoChangeType.deleteColumns,index:t,count:n})},e.prototype.aUa=function(e){var t,n,o=this,r=e.col,i=e.colCount;for(Te(o,r,0,0,!1),o.addColumns(r,i,!0),n=(t=e.changes).length-1;n>=0;n--)de(o,t[n])},e.prototype.getRowCount=function(e){return this._getSheetModel(e).getRowCount()},e.prototype.setRowCount=function(e,t,n){var o=this,r=o.getRowCount(t);o.WTa>0&&o.zTa.push({oldRowCount:r,sheetArea:t,type:"setRowCount"}),3===t||2===t?(r>e&&o.deleteRows(e,r-e,n),o._getSheetModel(3).setRowCount(e),o._getSheetModel(2).setRowCount(e)):1===t&&(r>e&&o.YTa(!0,t).UTa(e,r-e),o._getSheetModel(t).setRowCount(e)),o.zgc({type:c.AxisInfoChangeType.setRowCount,count:e,sheetArea:t})},e.prototype.bUa=function(e){this.setRowCount(e.oldRowCount,e.sheetArea,!0)},e.prototype.getColumnCount=function(e){return this._getSheetModel(e).getColumnCount()},e.prototype.setColumnCount=function(e,t,n){var o=this,r=o.getColumnCount(t);o.WTa>0&&o.zTa.push({oldColCount:r,sheetArea:t,type:"setColumnCount"}),3===t||1===t?(r>e&&o.deleteColumns(e,r-e,n),o._getSheetModel(3).setColumnCount(e),o._getSheetModel(1).setColumnCount(e)):2===t&&(r>e&&o.YTa(!1,t).UTa(e,r-e),o._getSheetModel(t).setColumnCount(e)),o.zgc({type:c.AxisInfoChangeType.setColumnCount,count:e,sheetArea:t})},e.prototype.cUa=function(e){this.setColumnCount(e.oldColCount,e.sheetArea,!0)},e.prototype.getLastNonNullRow=function(e,t){var n=t?0:this.YTa(!0,e).VTa()-1;return A(this._getSheetModel(e).Ef,this.zl(e).Ef,n)},e.prototype.getLastNonNullCol=function(e,t){var n=t?0:this.YTa(!1,e).VTa()-1;return A(this._getSheetModel(e).Ff,this.zl(e).Ff,n)},e.prototype.$Gb=function(){var e=this,t=e.kj,n=0!==t.Dr().height&&e._Gb(!0,t.defaults.rowHeight),o=0!==t.Dr().width&&e._Gb(!1,t.defaults.colWidth);function r(e,n){var o,r,i,a,s=n.length;for(o=0;o<s;o++)r=n[o][0],i=n[o][1],(a=n[o][2])!==i&&(e?t.kq(r,3,"height",i,a):t.pq(r,3,"width",i,a))}n&&r(!0,n),o&&r(!1,o)},e.prototype._Gb=function(e,t){var n,o,r,i,a,s,l,u,f,h,p,d,g,m,v,b,C,w,A=this,S=A.kj,T=[],N=S.zoom(),I=e?S.getRowCount():S.getColumnCount(),R=A.YTa(e,3),k=0,E=0;if(S.Gt&&(E=e?S.Gt().height:S.Gt().width),e){if(S.options.colHeaderVisible)for(o=0;o<S.getRowCount(1);o++)k+=M(N*S.getRowHeight(o,1));n=S.Dr().height-S.options.sheetAreaOffset.top-E-k}else{if(S.options.rowHeaderVisible)for(o=0;o<S.getColumnCount(2);o++)k+=M(N*S.getColumnWidth(o,2));n=S.Dr().width-S.options.sheetAreaOffset.left-E-k}for(r=[],i=[],a=[],s=0,l=e?S.getRowVisible:S.getColumnVisible,o=0;o<I;o++)if(u=l.call(S,o),f=S._modelManager.getSize(e,3,o),h=S._modelManager.getStarSize(e,3,o),y.test(h))p="*"===h?1:parseFloat(h.replace("*","")),u&&p>0?(s+=p,r.push(o),i.push(p),a.push(f)):T.push([o,0,f]);else if(f="number"==typeof f?Math.floor(f):t,u&&(n-=M(N*f))<1)return;if(!(s+T.length===0||n<1)){for(d=r.length,o=0;o<d-1;o++)if(g=n/s/N,p=i[o],f=x(g*p),m=M(N*f),T.push([r[o],f,a[o]]),n-=m,s-=p,m<1||n<1)return;for(v=M((n-1e-4)/N),T.push([r[d-1],v,a[d-1]]),o=0;o<T.length;o++)b=T[o][0],C=T[o][1],R.setSize(b,C),w=e?c.AxisInfoChangeType.setRowHeight:c.AxisInfoChangeType.setColumnWidth,A.zgc({type:w,index:b});return T}},e.prototype.setCellState=function(e,t,n,o,r){var i=this._getSheetModel(r);i&&i.setCellState(e,t,n,o)},e.prototype.toJSON=function(e){var t,n,o,r=this,i={};return i.data=r._getSheetModel(3).toJSON(3,e,r.kj),i.rowHeaderData=r._getSheetModel(2).toJSON(2,e),i.colHeaderData=r._getSheetModel(1).toJSON(1,e),i.rows=r.YTa(!0,3).toJSON(e),i.columns=r.YTa(!1,3).toJSON(e),i.rowHeaderColInfos=r.YTa(!1,2).toJSON(e),i.colHeaderRowInfos=r.YTa(!0,1).toJSON(e),t=r.kj,i.leftCellIndex=t.getViewportLeftColumn(1),i.topCellIndex=t.getViewportTopRow(1),e&&e.ignoreStyle||(i.spans=Ne(r.zl(3).toJSON()),i.rowHeaderSpan=Ne(r.zl(2).toJSON()),i.colHeaderSpan=Ne(r.zl(1).toJSON())),i.selections=r.selectionModel.toJSON(),i.tag=r.getValueForKey(-1,-1,"tag",3),20===(o={colHeaderRowHeight:(n=r.defaults).colHeaderRowHeight,colWidth:n.colWidth,rowHeaderColWidth:n.rowHeaderColWidth,rowHeight:n.rowHeight,_isExcelDefaultColumnWidth:n._isExcelDefaultColumnWidth}).rowHeight&&62===o.colWidth&&40===o.rowHeaderColWidth&&20===o.colHeaderRowHeight||(i.defaults=o),i},e.prototype.fromJSON=function(e,t,n,o){var r,i,a,s,u,f,h,p,d,g,m,y=this;if(y._getSheetModel(3).fromJSON(e.data,t,n,3,o),y._getSheetModel(2).fromJSON(e.rowHeaderData,t,n),y._getSheetModel(1).fromJSON(e.colHeaderData,t,n),y.kj.showCell(e.topCellIndex||0,e.leftCellIndex||0,c.VerticalPosition.top,c.HorizontalPosition.left),y.YTa(!0,3).fromJSON(e.rows),y.YTa(!1,3).fromJSON(e.columns),y.YTa(!1,2).fromJSON(e.rowHeaderColInfos),y.YTa(!0,1).fromJSON(e.colHeaderRowInfos),e&&e.rows)for(r=0,i=Object.keys(e.rows);r<i.length;r++)a=i[r],s=e.rows[a],D(s)||y.zgc({type:c.AxisInfoChangeType.setRowHeight,index:+a});if(e&&e.columns)for(u=0,f=Object.keys(e.columns);u<f.length;u++)a=f[u],s=e.columns[a],D(s)||y.zgc({type:c.AxisInfoChangeType.setColumnWidth,index:+a});n&&n.ignoreStyle||(y.zl(3).fromJSON(e.spans),y.zl(2).fromJSON(e.rowHeaderSpan),y.zl(1).fromJSON(e.colHeaderSpan)),y.selectionModel.fromJSON(e.selections),(h=e.tag)!==b&&(typeof(p=h.typeName)===C&&((d=l.getTypeFromString(p))&&((h=new d).fromJSON&&h.fromJSON(e.tag))),y.do("setValueForKey",-1,-1,"tag",h,3)),(g=e.defaults)!==b&&((m=y.defaults).colHeaderRowHeight=X(g.colHeaderRowHeight,20),m.colWidth=X(g.colWidth,62),m.rowHeaderColWidth=X(g.rowHeaderColWidth,40),m.rowHeight=X(g.rowHeight,20),m._isExcelDefaultColumnWidth=g._isExcelDefaultColumnWidth)},e.prototype.startTransaction=function(){0===this.WTa&&(this.zTa=[],!this.kj.isEventSuspended()&&(this.zTa.events=[]),e.ao(this,"startTransaction"));this.WTa++},e.prototype.endTransaction=function(){var t,n;return this.WTa--,0===this.WTa?(e.ao(this,"endTransaction"),t=this.zTa,this.zTa=b,(n=t.events)&&0===n.length&&delete t.events,t):[]},e.prototype.dUa=function(){var e=this.zTa;if(e)return e.calc||(e.calc=[]),e.calc},e.prototype.EIb=function(e,t,n){var o=this.zTa;o&&o.push({type:"setIsValid",value:[e,t,n]})},e.prototype.FIb=function(e,t,n){var o=this.zTa;o&&o.push({type:"dirtyItem",value:[e,t,n]})},e.prototype.MIb=function(e){var t,n,o=e.value;o&&((t=this.ZHb.getAnchorCell(o[0],o[1]))&&(n=o[2],t.isValid=n))},e.prototype.NIb=function(e){var t,n,o,r,i=e.value;i&&(t=i[0],n=i[1],o=i[2],(r=this.ZHb.getAnchorItem(t,n))&&(r.value=o))},e.prototype.undo=function(t){var n,o,r,i,a,s,l,u,c=[],f=t&&t.events;for(f&&this.YVa(f,!0),n=t.length-1;n>=0;n--)(r=(o=t[n]).type)?"addRows"===r?this.ZTa(o):"addColumns"===r?this._Ta(o):"deleteRows"===r?this.$Ta(o):"deleteColumns"===r?this.aUa(o):"setRowCount"===r?this.bUa(o):"setColumnCount"===r?this.cUa(o):"setZoomFactor"===r?this.fUa(o.value):"updateDirty"===r?(this.gWa(o),c.push(o)):"setName"===r?this.pZa(o.value):"sortRange"===r?this.yxb(o):"setIsValid"===r?this.MIb(o):"dirtyItem"===r&&this.NIb(o):de(this,o);(i=this.kj).Oq={},i.Jq(),(a=c.length>0)&&((s=i.Wu)&&s.suspend(),c.forEach((function(e){i.eyb(e.row,e.col,3,!1)}))),(l=t&&t.uVa)&&l.length>0&&(e.ao(this,T,{uVa:l}),delete t.uVa),(u=t&&t.calc)&&u.length&&i.gUa(u),e.ao(this,T,t),a&&(s&&s.resume(!1),i.fyb()),f&&this.YVa(f,!1)},e.prototype.do=function(e){var t,n,o,r=[];for(t=1;t<arguments.length;t++)r[t-1]=arguments[t];n=this,e&&((o=n[e])&&o.apply(n,r))},e.prototype._getSheetModel=function(e){return D(e)&&(e=3),this.sheetModels[e]},e.prototype.dWa=function(e,t,n){D(n)&&(n=3),this.sheetModels[n]=new Z(e,t)},e.prototype.ZVa=function(e){var t=this.zTa,n=t&&t.events;n&&n.push(e)},e.prototype.YVa=function(e,t){var n,o,r,i,a=this.kj;for(a.OIb=!0,n=e.length-1;n>=0;n--)i=void 0,"cellChanged"!==(r=(o=e[n])[0])||t?"rowChanged"!==r||t?"columnChanged"!==r||t?"zoomChanged"!==r||t?"rowChanging"===r&&t?i=a.pCb:"columnChanging"===r&&t?i=a.qCb:"tableRowsChanged"!==r||t?"tableColumnsChanged"!==r||t?"rangeChanged"!==r||t||(i=a.RIb):i=a.QIb:i=a.PIb:i=a.gyb:i=a.pq:i=a.kq:i=a.Bq,i&&([].splice.call(e,n,1),i.apply(a,[].slice.call(o,1)));a.OIb=!1},e.prototype.getValue=function(t,n,o,r,i){if(D(o)&&(o=3),!r){var a={row:t,col:n,sheetArea:o,isValueGet:!1,value:b};if(e.ao(this,"getValue",a,(function(){return a.isValueGet})),a.isValueGet)return a.value}return this._getSheetModel(o).getValue(t,n,i)},e.prototype.setValue=function(t,n,o,r,i,a,s){var l,u,c,f,h,d,g,m,y;D(r)&&(r=3),c=(u=this).kj,(f=!a&&!c.isEventSuspended())&&(l=c.getValue(t,n,r,1)),h=!1,p&&c.getCalcService().allowDynamicArray&&!u.SIb&&3===r&&(u.LIb.push(u.ZHb.updateItem(c.yj(),t,n,o)),h=!0),d=!1,i||(g={row:t,col:n,value:o,sheetArea:r,isValueSet:!1,changes:u.zTa},e.ao(u,"setValue",g,(function(){return g.isValueSet})),d=g.isValueSet),d||(m=void 0,y=void 0,u.WTa>0&&!s&&(m=[["sheetModels",r],b],y={sheetArea:r}),u._getSheetModel(r).setValue(t,n,o,m,y),m&&m.length>0&&u.zTa.push(m),y&&y.type&&u.zTa.push(y),c.fyb()),f&&l!==o&&c.Bq("value",t,n,r,l,o),h&&u.applyDynamicChanges()},e.prototype.applyDynamicChanges=function(){var e,t,n,o,r,i=this,s=i.LIb,l=i.kj;if(!i.SIb&&s.length){for(i.SIb=!0,e=l.yj(),t=l.Bj(),n=0,o=s;n<o.length;n++)(r=o[n])&&(a.setSpillValues(r[0],e),a.markAnchorCellDirty(r[1],t,i.ZHb));s.length=0,i.SIb=!1}},e.prototype.getDynamicArrayInfo=function(e,t){return this.ZHb.getAnchorInfo(e,t)},e.prototype.getStyle=function(e,t,n){return this._getSheetModel(n).getStyle(e,t,this.WTa>0)},e.prototype.setStyle=function(e,t,n,o){D(o)&&(o=3);var r=this.WTa>0?[["sheetModels",o],b]:b;this._getSheetModel(o).setStyle(e,t,n,r),r&&r.length>0&&this.zTa.push(r)},e.prototype.getValueForKey=function(e,t,n,o){return this._getSheetModel(o).getValueForKey(e,t,n)},e.prototype.setValueForKey=function(e,t,n,o,r){D(r)&&(r=3);var i=this.WTa>0?[["sheetModels",r],b]:b;this._getSheetModel(r).setValueForKey(e,t,n,o,i),i&&i.length>0&&this.zTa.push(i)},e.prototype.clear=function(t,n,o,r,i,a,s){var l,u,c,f,h,d,g,m,y,C,w,x,A,M;if(D(s)&&(s=3),l=this.WTa>0?[]:b,u=this,c=!1,p&&!u.SIb&&3===s){for(f=u.kj.yj(),h=u.LIb,d=u.ZHb,g={},m=[],y=0;y<o;y++)for(C=0;C<r;C++)d.updateItem(f,t+y,n+C,v,g,m);h.push([g,m]),c=!0}if(this._getSheetModel(s).clear(t,n,o,r,i,a,l),e.ao(this,"clear",{row:t,col:n,rowCount:o,colCount:r,type:i,ignoredRowList:a,sheetArea:s,changes:this.zTa}),l)for(w=["sheetModels",s],x=0,A=l.length;x<A;x++)(M=l[x])[0]=w.concat(M[0]),this.zTa.push(M);c&&this.applyDynamicChanges()},e.prototype.swapNode=function(e,t,n,o,r){var i,a,s,l,u;if(D(r)&&(r=3),i=this.WTa>0?[]:b,this._getSheetModel(r)._f(e,t,n,o,i),i)for(a=["sheetModels",r],s=0,l=i.length;s<l;s++)(u=i[s])[0]=a.concat(u[0]),this.zTa.push(u)},e.prototype.Cp=function(e,t,n,o){var r;this.WTa>0&&(r={sheetArea:o},D(o)&&(r.sheetArea=3)),this._getSheetModel(o).Cp(e,t,n,r),r&&this.zTa.push(r)},e.prototype.gWa=function(e){this._getSheetModel(e.sheetArea).gWa(e)},e.prototype.hUa=function(e){return this._getSheetModel(e).Ap},e.prototype.iUa=function(e){this._getSheetModel(e).Ap={}},e.prototype.Lec=function(e,t,n,o){var r,i,a,s=this.hUa();if(s)for(r in s)ee(s,r)&&(i=s[r],a=parseInt(r,10),i&&"n"===i.rs&&(e||t&&n<=a&&a<n+o)&&(s[r]={}))},e.prototype.Mec=function(t,n,o,r,i){var a,s,l,u,c,f,h=this.hUa(),p=this.kj,m=p.tables;if(!g(h)){if(a=[],n>=0)for(s=n;s<n+r;s++)a.push(s);else for(l in h)ee(h,l)&&a.push(parseInt(l,10));u=[],c=[],m&&(u=m.Nec(n,o,r,i),c=m.Oec(n,o,r,i),u.length>0&&e.ao(this,"clearPendingChanges",{tableList:u})),d(a,(function(e,n){var r,a,s;if((f=h[n])&&"e"===f.rs)if(r=c.length,t)if(m&&0!==r&&m.Pec(c,n,-1))for(a=p.getColumnCount(),s=0;s<a;s++)m&&0!==r&&m.Pec(c,n,s)||f[s]&&delete f[s];else h[n]={};else for(s=o;s<o+i;s++)m&&0!==r&&m.Pec(c,n,s)||f[s]&&delete f[s]}))}},e.prototype.Qec=function(){var e,t=this.hUa();for(e in t)ee(t,e)&&"e"===t[e].rs&&(t[e]={})},e.prototype.jUa=function(e){this._getSheetModel(e).gga++},e.prototype.kUa=function(e){var t=this._getSheetModel(e);t.gga--,t.gga<0&&(t.gga=0)},e.prototype.getName=function(){return this.name||""},e.prototype.setName=function(e){var t=this;t.WTa>0&&t.zTa.push({type:"setName",value:t.name}),t.name=e},e.prototype.TIb=function(){return this.isSelected},e.prototype.CHb=function(e){this.isSelected=e},e.prototype.pZa=function(e){this.kj.name(e)},e.prototype.yxb=function(e){var t,n=[];t=e.byRows?e.row:e.column,e.array.map((function(e,o){n[e-t]=o+t})),this.kj.sortRange(e.row,e.column,e.rowCount,e.columnCount,e.byRows,e.sortInfo,v,n)},e.prototype.getZoomFactor=function(){return this.zoomFactor},e.prototype.setZoomFactor=function(e){var t=this;t.WTa>0&&t.zTa.push({type:"setZoomFactor",value:t.zoomFactor}),t.zoomFactor=e},e.prototype.fUa=function(e){this.kj.zoom(e)},e.prototype.zl=function(e){return D(e)&&(e=3),this.spanModels[e]},e.prototype.eWa=function(e){D(e)&&(e=3),this.spanModels[e]=new B},e.prototype.getSpans=function(e,t,n){var o=this.zl(t).getSpans(e);return n&&(o=o.filter((function(e){return!e.isAutoMerge}))),o},e.prototype.getSpan=function(e,t,n){return this.zl(n).get(e,t)},e.prototype.uIb=function(e,t,n){var o,r;return D(n)&&(n=3),(o=this._getSheetModel(n))&&o.RTa?(r=o.RTa(e,t))&&r.tipContent?r.tipContent:null:null},e.prototype.qHb=function(e,t,n,o){D(o)&&(o=3);var r=this._getSheetModel(o).RTa(e,t);!n&&r?delete r.tipContent:n&&r?r.tipContent=n:n&&!r&&((r=this._getSheetModel(o).RTa(e,t,!0)).tipContent=n)},e.prototype.MTa=function(e,t,n,o,r){return this.zl(r).MTa(e,t,n,o)},e.prototype.qu=function(e,t,n,o,r){return this.zl(r).qu(e,t,n,o)},e.prototype.findSpan=function(e,t,n){return this.zl(n).find(e,t)},e.prototype.removeSpan=function(e,t){D(t)&&(t=3);var n=this.WTa>0?[["spanModels",t],b]:b;this.zl(t).remove(e,n),n&&n.length>0&&this.zTa.push(n)},e.prototype.addSpan=function(e,t){D(t)&&(t=3);var n=this.WTa>0?[["spanModels",t],b]:b;this.zl(t).add(e,n),n&&n.length>0&&this.zTa.push(n)},e.prototype.clearSpan=function(e,t,n,o,r){D(r)&&(r=3);var i=this.WTa>0?[["spanModels",r],b]:b;this.zl(r).$b(e,t,n,o,i),i&&i.length>0&&this.zTa.push(i)},e.prototype.moveSpan=function(e,t,n,o,r,i,a){D(a)&&(a=3);var s=this.WTa>0?[["spanModels",a],b]:b;this.zl(a).aB(e,t,n,o,r,i,s),s&&s.length>0&&this.zTa.push(s)},e.prototype.copySpan=function(e,t,n,o,r,i,a){D(a)&&(a=3);var s=this.WTa>0?[["spanModels",a],b]:b;this.zl(a).Zz(e,t,n,o,r,i,s),s&&s.length>0&&this.zTa.push(s)},e.prototype.addSelection=function(e,t,n,o){var r,i,a=this.WTa>0?[]:b;if(this.selectionModel.add(e,t,n,o,a),a)for(r=0;r<a.length;r++)(i=a[r])[0]=["selectionModel"].concat(i[0]),this.zTa.push(i)},e.prototype.getSelections=function(){return this.selectionModel.get()},e.prototype.setSelections=function(e){var t,n,o=this.WTa>0?[]:b;if(this.selectionModel.set(e,o),o)for(t=0;t<o.length;t++)(n=o[t])[0]=["selectionModel"].concat(n[0]),this.zTa.push(n)},e.prototype.clearSelection=function(){var e,t,n=this.WTa>0?[]:b;if(this.selectionModel.clear(n),n)for(e=0;e<n.length;e++)(t=n[e])[0]=["selectionModel"].concat(t[0]),this.zTa.push(t)},e.prototype.getActiveSelectedRangeIndex=function(){return this.selectionModel.getProperty("activeSelectedRangeIndex")},e.prototype.setActiveSelectedRangeIndex=function(e){var t=this.WTa>0?[["selectionModel"],b]:b;this.selectionModel.setProperty("activeSelectedRangeIndex",e,t),t&&this.zTa.push(t)},e.prototype.getSelectionPolicy=function(){return this.selectionModel.getProperty("selectionPolicy")},e.prototype.setSelectionPolicy=function(e){ge(this,"selectionPolicy",e)},e.prototype.getSelectionUnit=function(){return this.selectionModel.getProperty("selectionUnit")},e.prototype.setSelectionUnit=function(e){ge(this,"selectionUnit",e)},e.prototype.sp=function(e){return this.selectionModel.sp(e)},e.prototype.tp=function(e){return this.selectionModel.tp(e)},e.prototype.vp=function(e,t,n,o,r,i){return this.selectionModel.vp(e,t,n,o,r,i)},e.prototype.wp=function(e,t,n,o,r){return this.selectionModel.wp(e,t,n,o,r)},e.prototype.YTa=function(e,t){return D(t)&&(t=3),(e?this.rowInfos:this.colInfos)[t]},e.prototype.fWa=function(e,t){D(t)&&(t=3),(e?this.rowInfos:this.colInfos)[t]=new q},e.prototype.getPageBreak=function(e,t,n){return this.YTa(e,t).getPageBreak(n)},e.prototype.setPageBreak=function(e,t,n,o){var r;D(t)&&(t=3),r=this.WTa>0?[[e?N:I,t],b]:b,this.YTa(e,t).setPageBreak(n,o,r),r&&this.zTa.push(r)},e.prototype.getVisible=function(e,t,n){return this.YTa(e,t).getVisible(n)},e.prototype.setVisible=function(e,t,n,o){var r,i,a=this;D(t)&&(t=3),r=a.WTa>0?[[e?N:I,t],b]:b,a.YTa(e,t).setVisible(n,o,r),r&&a.zTa.push(r),i=e?c.AxisInfoChangeType.setRowVisible:c.AxisInfoChangeType.setColumnVisible,a.zgc({type:i,index:n,sheetArea:t})},e.prototype.getResizable=function(e,t,n){return this.YTa(e,t).getResizable(n)},e.prototype.setResizable=function(e,t,n,o){var r;D(t)&&(t=3),r=this.WTa>0?[[e?N:I,t],b]:b,this.YTa(e,t).setResizable(n,o,r),r&&this.zTa.push(r)},e.prototype.getSize=function(e,t,n){return this.YTa(e,t).getSize(n)},e.prototype.getStarSize=function(e,t,n){return this.YTa(e,t).getStarSize(n)},e.prototype.getActualSize=function(e,t,n){return this.YTa(e,t).getActualSize(n)},e.prototype.setSize=function(e,t,n,o){var r,i,a=this;D(t)&&(t=3),r=a.WTa>0?[[e?N:I,t],b]:b,a.YTa(e,t).setSize(n,o,r),r&&a.zTa.push(r),a.setStarSize(e,t,n,v),i=e?c.AxisInfoChangeType.setRowHeight:c.AxisInfoChangeType.setColumnWidth,a.zgc({type:i,index:n,value:o,sheetArea:t})},e.prototype.setStarSize=function(e,t,n,o){var r;D(t)&&(t=3),r=this.WTa>0?[[e?N:I,t],b]:b,this.YTa(e,t).setStarSize(n,o,r),r&&!D(r[1])&&this.zTa.push(r)},e.prototype.VTa=function(e,t){return this.YTa(e,t).VTa()},e.prototype.Hp=function(e,t){return this.YTa(e,t).Hp()},e.prototype.Jp=function(e,t,n){return this.YTa(e,t).Jp(n)},e.prototype.setItem=function(e,t,n,o){var r,i,a=this;D(t)&&(t=3),r=a.WTa>0?[[e?N:I,t],b]:b,a.YTa(e,t).Kp(n,o,r),o&&(D(o.size)||(i=e?c.AxisInfoChangeType.setRowHeight:c.AxisInfoChangeType.setColumnWidth,a.zgc({type:i,index:n,value:o.size,sheetArea:t})),D(o.visible)||(i=e?c.AxisInfoChangeType.setRowVisible:c.AxisInfoChangeType.setColumnVisible,a.zgc({type:i,index:n,sheetArea:t}))),r&&a.zTa.push(r)},e}(),t.lUa=Y,s.Zn(Y)},"./dist/core/worksheet/worksheet-render.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q;function J(e){return e.height}function Q(e){return e.width}function Y(e,t,n,o,r,i,a){e.beginPath(),e.lineWidth=t,e.strokeStyle=n,e.moveTo(o,r),e.lineTo(i,a),e.stroke()}function K(e,t){var n,o,r=0;return"string"==typeof e&&(1===(o=(n=e.split(" ",4)).length)?r=2*R(n[0]):2===o||3===o?r=2*R(n[1]):4===o&&(r=R(n[1])+R(n[3]))),r*t}function $(e,t,n,o,r,a,s){var l,u,c,f,h,d,g,y=r.zoom(),v=n.font,C=n.textIndent,w=n.textOrientation,x=n.isVerticalText,T=n.textIndent&&0!==n.textIndent,N=0!==w&&!m(w);return v=v?b(v,y).font:o,f=0,h=e,e&&h.richText?f=function(e,t,n){return function(e,t,n){var o,r,i,a,s;for(o=0,r=e;o<r.length;o++)i=r[o],void 0,i.style=i.style||{},s=i.style,a=s.font?b(s.font,n).font:t,s.font=a}(e,t,n),i.Vn.R_a(e,t,1)}(h.richText,v,y):e&&N&&!x&&!T?(l=A(w*Math.PI/180),u=M(l),c=S(l),n.wordWrap?(d=r.ss.Sl(a),f=i.Vn.mHb(a,s,u,c,t,v,d)):(g=p(v),f=i.Vn.Xn(t,v)*c+g*u)):f=i.Vn.Xn(t,v),(f+=function(e,t,n,o){if(!m(n)&&!m(o)&&e.outlineColumn){var r=e.outlineColumn.LRa(n,o);if(r)return r}return t?8*t:0}(r,C,a,s)+2)+K(n.cellPadding,y)}function X(e,t,n){if(e&&-90<=e&&e<=90)return N(n/T(A(e*Math.PI/180)))+t+4}function ee(e,t,n,o,r,i,a,l,c){var f,h,p,d,g,v,b,w,x,A,M,S,T,N,I;if(y(r.data)&&e.parent&&e.parent.options.numbersFitMode!==u.NumbersFitMode.overflow)return C;if(f=e.ss,h=Q(r),p=Q(r),g=r.style,b=r.text,A=g.watermark,M=g.wordWrap,S=g.textOrientation,T=e.options.allowCellOverflow,t.findCell(i,a))return C;if(g.cellButtons&&g.cellButtons.length>0)return C;if(!(g.cellType||n).allowOverflow||!b&&!A||!S&&M&&e.parent&&e.parent.options.numbersFitMode!==u.NumbersFitMode.overflow)return C;if(b||(b=A),!T&&!S)return C;if((w=$(r.data,b,g,o,e,i,a))<=p)return C;for(N=a,I=a,v=a+(c?1:-1);(c?v<=l:v>=l)&&!t.findCell(i,v)&&(x=f.Ym(i,v),d=f.zHb(i,v,3,1,x),x.textOrientation||m(d))&&!x.watermark&&!(x.cellType&&"1"!==x.cellType.typeName||x.cellButtons&&x.cellButtons.length>0)&&(c?I=v:N=v,!(w<=(p+=f._m(v))));v+=c?1:-1);return c&&I===a||!c&&N===a?C:new s.op(a,N,I,w,h,p,c?-1:p,c?p:-1)}function te(e){var t=e.parent,n={nps:!0};return r.Worksheet.ao(e,"needPaintSelection",n),(i.Vl.Wl(e)||t&&!t.options.hideSelection)&&n.nps}function ne(e){var t=e.parent;return t&&t.options.backColor||"white"}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("./dist/core/worksheet/worksheet.js"),i=n("./dist/core/util/common.js"),a=n("./dist/core/worksheet/stylehelper.js"),s=n("./dist/core/worksheet/worksheet-model.js"),l=n("./dist/core/worksheet/worksheet-border.js"),u=n("./dist/core/core.enum.js"),c=function(e){return e.getSparkline},f=o.Common.k,h=i.Ul.ol,p=i.Ul.fp,d=i.Ul.lZa,g=i.Ul.lHb,m=o.Common.j.Fa,y=i.Ul.Fxb,v=a.Ho,b=a.To.No,C=null,w=Math.min,x=Math.max,A=Math.abs,M=Math.sin,S=Math.cos,T=Math.tan,N=Math.floor,I=Math.round,R=parseInt,k="black",E="transparent",D="rowHeader",j="columnHeader",_=function(){function e(e,t,n){var o=this;o.kj=e,o.pJ=e.Hr(n),o.qJ=e.Ir(t,n,u.SheetArea.viewport,!0),o.yI=b(e._render.Bl(),e.zoom()).font,o.Rq=e.Al(),o.rJ={}}return e.prototype.nJ=function(e,t){var n,o,r,a,l,c,f,p,d,g,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_=this,O=_.rJ[e];if(O)return O;if(o=(n=_.kj).ss,a=(r=_.pJ).length,x=new s.np,t||(t=i.Vn.bm()),a>0){for(x.headingOverflowlayouts=_.sJ(e,t),M=r[0].col,S=r[a-1].col,T=0;T<a;T++)Q(p=r[T])<=0||(d=p.col,g=o.Ym(e,d),y=o.zHb(e,d,3,1),l=g.textOrientation,c=g.isVerticalText,f=g.textIndent&&0!==g.textIndent,N=g&&(g.borderLeft||g.borderTop||g.borderRight||g.borderBottom),m(y)&&!g.watermark||g.shrinkToFit||!l&&g.wordWrap&&n.parent&&n.parent.options.numbersFitMode===u.NumbersFitMode.mask||c||((I=n.conditionalFormats)&&(k=(R=I.oRa(n,e,d,y)).dataBar,E=R.iconSet,k&&k.showBarOnly||E&&E.showIconOnly)||(v=o._m(d),b=o.Sl(e),D=g.cellType||_.Rq,j={},w=i.mn.vn(n,g,y,j,{row:e,col:d,sheet:n}),j&&j.content&&j.content.length>0&&!g.shrinkToFit&&l&&(w=D.sHb(t,j.content,b-4,g.font)),3===(C=g.hAlign)&&(C=h(C,y,g.formatter,l)),N&&l&&!c&&!f?0>l&&l>-90?(A=_.UIb({data:y,style:g,width:v,text:w},e,d,M))&&x.push(A):0<l&&l<90&&((A=_.UIb({data:y,style:g,width:v,text:w},e,d,S,!0))&&x.push(A)):0===C?(A=_.tJ({data:y,style:g,width:v,text:w},e,d,S))&&x.push(A):2===C?(A=_.uJ({data:y,style:g,width:v,text:w},e,d,M))&&x.push(A):1===C&&((A=_.vJ({data:y,style:g,width:v,text:w},e,d,M,S))&&x.push(A)))));x.trailingOverflowLayouts=_.wJ(e,t)}return _.rJ[e]=x,x},e.prototype.tJ=function(e,t,n,o){var r=this;return ee(r.kj,r.qJ,r.Rq,r.yI,e,t,n,o,!0)},e.prototype.uJ=function(e,t,n,o){var r=this;return ee(r.kj,r.qJ,r.Rq,r.yI,e,t,n,o)},e.prototype.UIb=function(e,t,n,o,r){var i,a,l,u,c,f=this,h=f.kj,p=f.qJ,d=f.Rq,g=f.yI,m=h.ss,y=Q(e),v=Q(e),b=e.style,w=e.text,x=b.watermark,A=b.wordWrap,M=b.textOrientation,S=b&&(b.borderLeft||b.borderTop||b.borderRight||b.borderBottom),T=b.isVerticalText,N=b.textIndent&&0!==b.textIndent,I=h.options.allowCellOverflow;if(p.findCell(t,n))return C;if(b.cellButtons&&b.cellButtons.length>0)return C;if(!(b.cellType||d).allowOverflow||!w&&!x||!M&&A)return C;if(w||(w=x),!I&&!M)return C;if((a=!S||T||N?$(e.data,w,b,g,h,t,n):X(M,m._m(n),m.Sl(t)))<=v)return C;for(u=n,c=n,i=n+(r?1:-1);!(!(r?i<=o:i>=o)||p.findCell(t,i)||(l=m.Ym(t,i),l.watermark)||l.cellType&&"1"!==l.cellType.typeName||l.cellButtons&&l.cellButtons.length>0||(r?c=i:u=i,v+=m._m(i),a<=v));i+=r?1:-1);return r&&c===n||!r&&u===n?C:new s.op(n,u,c,a,y,v,r?-1:v,r?v:-1)},e.prototype.vJ=function(e,t,n,o,r){var i,a,l,c,f,h,p,d,g,v,b,w,x,A,M,S,T,N,I,R;if(y(e.data)&&this.kj.parent&&this.kj.parent.options.numbersFitMode!==u.NumbersFitMode.overflow)return C;if(l=(a=(i=this).kj).ss,c=i.qJ,f=Q(e),h=Q(e),d=e.style,v=e.text,x=d.textOrientation,A=d.watermark,M=d.wordWrap,S=a.options.allowCellOverflow,c.findCell(t,n))return C;if(d.cellButtons&&d.cellButtons.length>0)return C;if(!(d.cellType||i.Rq).allowOverflow||!v&&!A||!x&&M&&a.parent&&a.parent.options.numbersFitMode!==u.NumbersFitMode.overflow)return C;if(v||(v=A),!S&&!x)return C;if((b=$(e.data,v,d,i.yI,a,t,n))<=h)return C;for(T=n,N=h/2,g=n-1;g>=o&&!c.findCell(t,g)&&(w=l.Ym(t,g),p=l.zHb(t,g,3,1,w),w.textOrientation||m(p))&&!w.watermark&&!(w.cellType&&"1"!==w.cellType.typeName||w.cellButtons&&w.cellButtons.length>0)&&(T=g,!(b/2<=(N+=l._m(g))));g--);for(I=n,R=h/2,g=n+1;g<=r&&!c.findCell(t,g)&&(w=l.Ym(t,g),p=l.zHb(t,g,3,1,w),w.textOrientation||m(p))&&!w.watermark&&!(w.cellType&&"1"!==w.cellType.typeName||w.cellButtons&&w.cellButtons.length>0)&&(I=g,!(b/2<=(R+=l._m(g))));g++);return T===I?C:new s.op(n,T,I,b,f,N+R,N,R)},e.prototype.sJ=function(e,t){var n,o,r,a,s,l,c,f,p,d,g,y,v=this,b=v.kj,C=b.ss,w=v.pJ,x=w[0].col,A=w[w.length-1].col,M=b._modelManager,S=[];for(y=1;y<100;y++){if((l=x-y)<0)return S;if(M.findSpan(e,l)||b.mJb&&b.mJb.oJb(e,l,u.SheetArea.viewport))return S;o=C.zHb(e,l,3,1),(r=C._m(l))>0&&!m(o)&&(3===(s=(n=C.Ym(e,l)).hAlign)&&(s=h(s,o,void 0,n.textOrientation)),a=C.Sl(e),d=n.cellType||v.Rq,g={},f=i.mn.vn(b,n,o,g,{row:e,col:l,sheet:b}),g&&g.content&&g.content.length>0&&!n.shrinkToFit&&n.textOrientation&&(f=d.sHb(t,g.content,a-4,n.font)),p={data:o,style:n,width:r,text:f},0<n.textOrientation&&n.textOrientation<90?c=v.UIb(p,e,l,A,!0):0===s?c=v.tJ(p,e,l,A):1===s&&(c=v.vJ(p,e,l,x,A)),c&&c.endColumn>=x&&S.push(c))}return S},e.prototype.wJ=function(e,t){var n,o,r,a,s,l,c,f,p,d,g,y,v=this,b=v.kj,C=b.ss,w=v.pJ,x=w[0].col,A=w[w.length-1].col,M=b._modelManager,S=b.getColumnCount(),T=[];for(y=1;y<100;y++){if((f=A+y)>=S)return T;if(M.findSpan(e,f)||b.mJb&&b.mJb.oJb(e,f,u.SheetArea.viewport))return T;o=C.zHb(e,f,3,1),(r=C._m(f))>0&&!m(o)&&(3===(s=(n=C.Ym(e,f)).hAlign)&&(s=h(s,o,void 0,n.textOrientation)),a=C.Sl(e),l=n.cellType||v.Rq,c={},d=i.mn.vn(b,n,o,c,{row:e,col:f,sheet:b}),c&&c.content&&c.content.length>0&&!n.shrinkToFit&&n.textOrientation&&(d=l.sHb(t,c.content,a-4,n.font)),g={data:o,style:n,width:r,text:d},0>n.textOrientation&&n.textOrientation>-90?p=v.UIb(g,e,f,x,!1):2===s?p=v.uJ(g,e,f,x):1===s&&(p=v.vJ(g,e,f,x,A)),p&&p.startColumn<=A&&T.push(p))}return T},e}(),t.xJ=_,t.needPaintSelection=te,O=function(){function e(e){this.kj=e}return e.prototype.bm=function(){var e=this.kj,t=C,n=e.Ws();return n&&n.getContext&&(t=n.getContext("2d")),t},e.prototype.vI=function(){var e,t=this,n=t.kj,o=n.Dr(),r=n.Xs,a=Q(r),s=J(r),l=t.wI;return l&&Q(l)===a&&J(l)===s||(l&&i.En.Qn(n,l),t.wI=l=i.Ul.Nl("canvas"),l.getContext&&(t.xI=l.getContext("2d"),i.En.Kn(l,C,n),i.En.Pn(l,Q(o),J(o)))),(e=t.xI)&&(e.beginPath(),d(e,t.Cl(t.Bl())),e.name="bufferContext"),e},e.prototype.Bl=function(){return this.yI||(this.yI=v+" "+this.kj.currentTheme().bodyFont()),this.yI},e.prototype.us=function(){this.yI=C},e.prototype.zI=function(e){var t=this.kj,n=t.parent,o=n?n.options.grayAreaBackColor||i.Im.Mm("gc-grayArea").backgroundColor:"gray",r=i.Rm.Om(t,o);return e?((n?n.options.backgroundImage:C)&&(r=E),r):r},e.prototype.Cl=function(e){var t=this.kj.zoom();return 1===t?e:b(e,t).font},e.prototype.Mx=function(e,t,n,o,r){var a,s,l,u,c,f=this,h=f.wI,p=f.bm();n<=0||o<=0||!h||!p||(r||(r=f.kj.Dr()),a=i.En.Ln(h),s=i.En.Mn(h),1!==a&&(e*=a,t*=s,n*=a,o*=s,r=new i.Rect(r.x*a,r.y*s,Q(r)*a,J(r)*s)),(l=r.getIntersect(e,t,n,o))&&(l.round(),e=l.x,t=l.y,n=Q(l),o=J(l),(u=Q(h))&&e+n>u&&((e=u-n)<0&&(n+=e,e=0)),(c=J(h))&&t+o>c&&((t=c-o)<0&&(o+=t,t=0)),i.Bn.Cn(p,1,1),p.clearRect(e,t,n,o),p.drawImage(h,e,t,n,o,e,t,n,o),i.Bn.Cn(p,a,s)))},e.prototype.dm=function(e,t){e&&this.Mx(e.x,e.y,Q(e),J(e),t)},e.prototype.Ow=function(e,t,n,o,r,a){var s,l,u,c,f,h,p,d,g,m,y,v,b,C;if(n>0&&o>0)try{l=(s=this).kj,u=s.bm(),c=l.Ws(),f=s.vI(),h=s.wI,p=r,d=a,g=n,m=o,y=i.En.Ln(c),v=i.En.Mn(c),e=I(e*y),t=I(t*v),n=I(n*y),o=I(o*v),p=I(p*y),d=I(d*v),g=I(g*y),m=I(m*v),b=Q(h),C=J(h),b&&e+n>b&&((e=b-n)<0&&(n+=e,e=0)),C&&t+o>C&&((t=C-o)<0&&(o+=t,t=0)),b&&p+g>b&&((p=b-g)<0&&(g+=p,p=0)),C&&d+m>C&&((d=C-m)<0&&(m+=d,d=0)),i.Bn.Cn(u,1,1),i.Bn.Cn(f,1,1),u.clearRect(p,d,g,m),u.drawImage(h,e,t,n,o,p,d,g,m),f.clearRect(p,d,g,m),f.drawImage(c,p,d,g,m,p,d,g,m),i.Bn.Cn(u,y,v),i.Bn.Cn(f,y,v)}catch(e){}},e.prototype.im=function(e,t,n,o){var r,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,A,M,S,T,N=this;if(n||(n=N.bm()),r=!1,a=N.kj,s=i.kf(-1,-1,-1,-1),l=a.Hx,u=a._modelManager,e&&(s=a.options.allowCellOverflow?i.kf(e.row,0,e.rowCount,a.getColumnCount()):i.kf(e.row,e.col,e.rowCount,e.colCount),!l)){if(s.col>=0){for(f=s.col,h=s.col+s.colCount-1,p=a.getRowCount(1),d=0;d<p;d++)(c=u.findSpan(d,s.col,1))?f=w(c.col,f):a.p_a&&(f=w(a.p_a.col,f)),(c=u.findSpan(d,s.col+s.colCount-1,1))?h=x(c.col+c.colCount-1,h):a.p_a&&(h=x(a.p_a.col+a.p_a.colCount-1,h));s.col=f,s.colCount=h-f+1}if(s.row>=0){for(g=s.row,m=s.row+s.rowCount-1,y=a.getColumnCount(2),v=0;v<y;v++)(c=u.findSpan(s.row,v,2))?g=w(c.row,g):a.p_a&&(g=w(a.p_a.row,g)),(c=u.findSpan(s.row+s.rowCount-1,v,2))?m=x(c.row+c.rowCount-1,m):a.p_a&&(m=x(a.p_a.row+a.p_a.rowCount-1,m));s.row=g,s.rowCount=m-g+1}}if(b=a.cm(s),a.cellStates&&a.cellStates.hasIntersectInSeletionState(s.row,s.col,s.rowCount,s.colCount)&&a.repaint(b),C=Q(b),A=J(b),M=b.x,S=b.y,C>=0||A>=0){if(b.x-=9,b.y-=9,b.width+=18,b.height+=30,t&&!(b=b.getIntersectRect(t)))return;T=a.am(),A>0&&!l&&(a.$l=!0,N.jp(n,new i.Rect(T.x,x(T.nt,S),T.Br,A),o)),C>0&&!l&&(a.$l=!0,N.jp(n,new i.Rect(x(T.kt,M),T.y,C,T.Cr),o)),-1!==s.row||-1!==s.col||l||(a.$l=!0,N.jp(n,T.em(),o)),C>0&&A>0&&N.jp(n,b,o),r=!0}return r},e.prototype.VF=function(e,t,n,o,r){var a,s=this,l=s.kj;l.Xq<=0&&((a=s.bm())&&(r||(l.$l=!0),s.jp(a,new i.Rect(e,t,n,o))))},e.prototype.repaint=function(e){var t,n=this,o=n.kj;o.Xq>0||(t=n.bm())&&(o.$l=!0,n.jp(t,e))},e.prototype.jp=function(e,t,n){var o=this;e&&o.kj.Xq<=0&&(n||o._l(e,t),o.Pw(e,t))},e.prototype._l=function(e,t,n){var o,r,a,s=this,l=s.kj;e&&l.Xq<=0&&(r=(o=s.vI())||e,a=l.Dr(),t||(t=a),t&&t.round(),n&&n.round(),l.$l&&(l.$l=!1,o&&(o.clearRect(t.x,t.y,Q(t),J(t)),n&&o.clearRect(n.x,n.y,Q(n),J(n)),i.Bn.Dn(o,-a.x,-a.y)),s.AI(r,t),n&&s.AI(r,n),o&&i.Bn.Dn(o,a.x,a.y)),o&&(s.dm(t),n&&s.dm(n)))},e.prototype.Pw=function(e,t){var n,o,i,a,s,l=this,u=l.kj,c=u.CH;if(e&&!(u.Xq>0)&&(t&&t.round(),n=u.am(),r.Worksheet.ao(u,"beforePaintAdornment",{ctx:e,clipRect:t}),!u.fI)){if(c){for(o=n.em(),l.dm(o),a=0;a<=2;a++)(o=n.fm(a))&&0!==Q(o)&&0!==J(o)&&l.dm(o);for(s=0;s<=2;s++)(o=n.gm(s))&&0!==Q(o)&&0!==J(o)&&l.dm(o)}for(a=0;a<=2;a++)for(s=0;s<=2;s++)(o=n.Ft(a,s))&&0!==Q(o)&&0!==J(o)&&(i=t,(c&&(1!==a||1!==s)||u.parent&&u.parent.options.allowUserDragMerge)&&(l.dm(o),i=o),i&&!o.intersectRect(i)||l.BI(e,a,s,i));l.CI(e),r.Worksheet.ao(u,"paintAdornment",{ctx:e,clipRect:t})}},e.prototype.dD=function(e,t){var n=this.kj,o=n.parent,r=o?o.options:{},a=ne(n),s=i.Rm.Om(n,a);r.backgroundImage&&(s=E),e.save(),e.fillStyle=s,e.fillRect(t.x,t.y,Q(t),J(t)),e.restore()},e.prototype.z0a=function(e){var t=this.kj;return 0===t.am().Cr&&e===t.ar(3)},e.prototype.A0a=function(e){var t=this.kj;return 0===t.am().Br&&e===t.$q(3)},e.prototype.DI=function(e,t,n){var o,r,i,a,s,l,u,c=this,f=c.kj,h=f.options,p=f.am(),d=h.sheetAreaOffset.top,g=h.sheetAreaOffset.left,m=0!==p.Cr,y=0!==p.Br,v=f.Gt&&f.Gt()||{x:h.sheetAreaOffset.left,y:h.sheetAreaOffset.top,width:0,height:0},b=0===v.width,C=0===v.height;for(r=0;r<=2;r++)(a=p.gm(r))&&(m&&C&&(a.y=a.y-d,a.height=a.height+d,!y&&b&&(a.x=a.x-g,a.width=a.width+g)),(i=t?a.getIntersectRect(t):a)&&c.EI(e,r,i,n));for(o=0;o<=2;o++)for((s=p.fm(o))&&(y&&b&&(s.x=s.x-g,s.width=s.width+g,!m&&C&&(s.y=s.y-d,s.height=s.height+d)),(i=t?s.getIntersectRect(t):s)&&c.FI(e,o,i,n)),r=0;r<=2;r++)l=p.Ft(o,r),c.z0a(f.jCb(o))&&C&&(l.y=l.y-d,l.height=l.height+d),c.A0a(f.kCb(r))&&b&&(l.x=l.x-g,l.width=l.width+g),l&&((i=t?l.getIntersectRect(t):l)&&c.GI(e,o,r,i,n));(u=p.em())&&((i=t?u.getIntersectRect(t):u)&&c.HI(e,i,n))},e.prototype.II=function(e){var t,n,o,r,i,a=this,s=a.kj,l=s.am(),u=l.zr,c=l.Ar,f=l.lt,h=l.ot,p=Q(l),d=J(l),g=l.qt,m=l.pt,y=0,v=s.Gr(1);v.length>0?(y=n=(t=v[v.length-1]).y+J(t),n<h&&(e.fillStyle=a.zI(!1),e.fillRect(u,n,p,h-n))):0===v.length&&(e.fillStyle=a.zI(!1),e.fillRect(u,g,p,h-g),y=g),(o=s.Hr(1)).length>0?(i=(r=o[o.length-1]).x+Q(r))<f&&(e.fillStyle=a.zI(!1),e.fillRect(i,c,f-i,y),e.fillRect(i,h,f-i,d-h)):0===o.length&&(e.fillStyle=a.zI(!1),e.fillRect(m,c,f-m,y),e.fillRect(m,h,f-m,d-y))},e.prototype.B0a=function(e,t){var n=this,o=n.kj,r=n.zI(!1),i=o.options,a=i.sheetAreaOffset.left,s=i.sheetAreaOffset.top,l=t.x,u=t.y,c=Q(t),f=J(t);e.save(),a>0&&Y(e,a,r,l+a/2,s>0?u+s:u,l+a/2,u+x(0,f)),s>0&&Y(e,s,r,a>0?l+a:l,u+s/2,l+x(0,c),u+s/2),a>0&&s>0&&(e.fillStyle=n.zI(!1),e.fillRect(l,u,a,s)),e.beginPath(),e.restore()},e.prototype.AI=function(e,t){var n,o=this,i=o.kj;!e||i.Xq>0||(n=i.Dr(),e.save(),t?e.rect(t.x,t.y,Q(t),J(t)):e.rect(n.x,n.y,Q(n),J(n)),e.clip(),e.beginPath(),o.dD(e,n),r.Worksheet.ao(i,"paint",{ctx:e,clipRect:t}),o.B0a(e,n),o.DI(e,t,!1),o.II(e),o.KI(e),r.Worksheet.ao(i,"paintSheetEnd",{ctx:e,clipRect:t}),e.beginPath(),e.restore())},e.prototype.LI=function(e,t){var n,o,r=this,a=r.kj;e&&(n=a.Dr(),e.save(),o=t||new i.Rect(n.x,n.y,Q(n),J(n)),e.rect(o.x,o.y,Q(o),J(o)),e.clip(),e.beginPath(),r.dD(e,n),r.DI(e,o,!0),e.beginPath(),e.restore())},e.prototype.CI=function(e){var t,n,o,r,i,a,s,l,u,c=this.kj,f=c._eventHandler,h=c.yt;if(f&&f.isResizing&&h&&(s=h.resizeInfo)){if(l=c.am(),u=k,e.save(),e.strokeStyle!==u&&(e.strokeStyle=u),1!==e.lineWidth&&(e.lineWidth=1),e.beginPath(),"sizeRow"===s.action||"sizeHiddenRow"===s.action)for(n=x(0,s.startY-.5),r=s.movingY-.5,i=l.x+Q(l),t=l.x;t<i;t+=2)e.moveTo(t,n),e.lineTo(t+1,n),e.moveTo(t,r),e.lineTo(t+1,r);else for(t=x(0,s.startX-.5),o=s.movingX-.5,a=l.y+J(l),n=l.y;n<a;n+=2)e.moveTo(t,n),e.lineTo(t,n+1),e.moveTo(o,n),e.lineTo(o,n+1);e.stroke(),e.beginPath(),e.restore()}},e.prototype.HI=function(e,t,n){var o,r,i,a,s,u,c,f=this.kj;e.beginPath(),r=(o=f.am().em()).x,i=o.y,a=Q(o),s=J(o),u=f.getActualStyle(-1,-1,0),this.SI(e,[{data:C,row:-1,col:-1,x:r,y:i,width:a,height:s,style:u.clone()}],0,n),(c=new l.AF(f,f.Gr(0,0),f.Hr(0,0),0)).jF(0,0,r,i,a,s),c.paint(e)},e.prototype.KI=function(e){var t,n,o,r,a,s,l,u,c,f=this.kj,h=f.frozenRowCount(),p=f.frozenColumnCount(),d=f.frozenTrailingRowCount(),g=f.frozenTrailingColumnCount();(h||p||d||g)&&(n=(t=f.am()).pt,o=t.qt,r=t.lt,a=t.ot,s=t.x,l=t.y,u=Q(t),c=J(t),e.save(),e.strokeStyle=i.Rm.Om(f,f.options.frozenlineColor),e.lineWidth=1,e.beginPath(),p&&(e.moveTo(n-.5,l),e.lineTo(n-.5,l+c)),h&&(e.moveTo(s,o-.5),e.lineTo(s+u,o-.5)),g&&(e.moveTo(r-.5,l),e.lineTo(r-.5,l+c)),d&&(e.moveTo(s,a-.5),e.lineTo(s+u,a-.5)),e.stroke(),e.restore())},e.prototype.EI=function(e,t,n,o){this.TI(e,-1,t,1,n,o)},e.prototype.FI=function(e,t,n,o){this.TI(e,t,-1,2,n,o)},e.prototype.GI=function(e,t,n,o,r){var i,a,s,l=this.kj.et;l&&((i=l.getCalcService())&&i.calcOnDemand&&((a=l._source).clearValueCache&&a.clearValueCache())),this.TI(e,t,n,3,o,r),(s=this.kj.at)&&s.UI(e,o,t,n)},e.prototype.VIb=function(e,t,n,o,r){var a,s,l,u=this.kj,c=u.getRangeRect(t,n,i.kf(r.row,r.col,r.rowCount,r.colCount));(c=c.getIntersectRect(u.am().Ft(t,n)))&&(c.round(),a=r.isValid,e.save(),e.lineWidth=1,e.strokeStyle="mediumblue",a||e.setLineDash([6,2]),s=c.x+.5,l=c.y+.5,e.strokeRect(s,l,Q(c),J(c)),e.beginPath(),e.restore())},e.prototype.BI=function(e,t,n,o){var r,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,E,D,j,_=this,O=_.kj;if(te(O)){if(!O.addSelection)return;if(l=O._modelManager,u=O._eventHandler,f=(c=l.getSelections()).length,!(o=_.VI(t,n,o)))return;if(h=i.Im.Lm("gc-selection"),(p=R(h.zIndex))>2007&&_.WI(e,t,n,o),(d=l.WIb=l.ZHb.getAnchorInfo(O.getActiveRowIndex(),O.getActiveColumnIndex()))&&_.VIb(e,t,n,o,d),y=void 0,(m=(g=_.XI(t,n,c,o)).length)<=0)return;for(v=_.XI(t,n,[O.p_a],o)[0],b=!1,C=void 0,C=0;C<m;C++)if(y=g[C],!o.containsRect(y)){b=!0;break}if(v&&!o.containsRect(v)&&(b=!0),e.save(),b&&(e.rect(o.x,o.y,Q(o),J(o)),e.clip()),e.beginPath(),m>0)for(s=i.Rm.Om(O,O.getSelectionBackColor()),e.fillStyle!==s&&(e.fillStyle=s),r=0,a=0,p>2007&&(r=1,a=-3),C=0;C<m;C++)y=g[C],e.fillRect(y.x+r,y.y+r,Q(y)+a,J(y)+a);O.sgc||(w=O.Jl,x=O.Kl,v&&(w=O.s_a,x=O.t_a),M=void 0,S=void 0,T=void 0,N=void 0,(A=O.getCellRect(w,x,t,n))&&A.intersectRect(o)&&(M=A.x,S=A.y,T=Q(A),N=J(A),r=1,a=-2,p>2007&&(r=0,a=0),_.Mx(M+r,S+r,T+a,N+a),f>1&&(e.strokeStyle=k,e.lineWidth=1,e.strokeRect(M+1.5,S+1.5,T-4,N-4)))),e.restore(),e.save(),e.beginPath(),1===f&&(u&&u.BG&&u.ZI&&u.ZI()&&!u.$I&&(I=u._I&&u._I(),D=Q(E=O.getRangeRect(t,n,I)),j=J(E),E&&D>0&&j>0&&(e.fillStyle=h&&h.color,e.fillRect(E.x,E.y,D,j))),y&&Q(y)>=0&&J(y)>=0&&(_.YI(o,O,t,n,p),_.aJ(e,t,n,y,o,c[0]))),v&&(e.save(),b&&(e.rect(o.x,o.y,Q(o),J(o)),e.clip()),e.beginPath(),e.fillStyle="rgba(255,255,255,0.4)",e.fillRect(v.x+r,v.y+r,Q(v)+a,J(v)+a),e.fillStyle=s,e.strokeStyle="rgb(124,124,124)",e.lineWidth=1,e.strokeRect(v.x-.5,v.y-.5,Q(v),J(v)),e.restore()),e.beginPath(),e.restore()}},e.prototype.YI=function(e,t,n,o,r){var i,a,s,l,u,c,f,h,p,d,g,m=t.frozenTrailingRowCount(),y=t.frozenTrailingColumnCount(),v=t.getSelections(),b=t.am(),C=t.getRowCount()-m-1,w=t.getColumnCount()-y-1,x=t.Hr(1,3),A=t.Gr(1,3);1===v.length&&r>2007&&(i=t.frozenRowCount(),a=t.frozenColumnCount(),l=(s=v[0]).row,u=s.col,c=s.rowCount,f=s.colCount,i>0&&(l>=i&&t.gr(l)<i?(e.y-=2,e.height+=2):l+c<=i&&t._q(l+c-1)===t.lq&&(e.height+=2)),a>0&&(u>=a&&t.br(u)<a?(e.x-=2,e.width+=2):u+f<=a&&t.Zq(u+f-1)===t.qq&&(e.width+=2)),0===l&&0===u&&(e.x-=2,e.y-=2,e.width+=2,e.height+=2),-1===l&&(l=0,c=t.getRowCount()),-1===u&&(u=0,f=t.getColumnCount()),h=!1,p=!1,d=A.findRow(C),g=x.findCol(w),d&&d.y+J(d)<b.qt+b.jr&&(h=!0),g&&g.x+Q(g)<b.pt+b.er&&(p=!0),h&&l+c-1===C&&(e.height+=2),p&&u+f-1===w&&(e.width+=2))},e.prototype.WI=function(e,t,n,o){var r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E=this,D=E.kj,j=D._modelManager.getSelections(),_=D.am(),O=_.kt,F=_.nt,P=j.length,H=0!==_.Cr,B=0!==_.Br;if(!(P<=0)){if(i=(r=j[0]).row,a=r.rowCount,s=r.col,l=r.colCount,-1===i&&(i=0),-1===s&&(s=0),-1===a&&(a=D.getRowCount()),-1===l&&(l=D.getColumnCount()),e.save(),e.beginPath(),e.lineWidth=2,e.strokeStyle=D.getSelectionBorderColor(),u=o.x,c=o.y,f=Q(o),h=J(o),p=D.frozenRowCount(),H&&(1!==P||0!==p||D.lq<=i||D.lq>=i+a))for(g=0,m=(d=E.bJ(n)).length;g<m;g++)v=0,b=0,C=(y=d[g]).x,w=y.x+Q(y),y.x<u+f&&u<y.x+Q(y)&&(1===P&&(0===p&&D.lq===i||p>0&&0===i)&&(v=-1,b=1),y.x<u&&(v=0,C=u),y.x+Q(y)>u+f&&(b=0,w=u+f),e.moveTo(C+v-1,F-1),e.lineTo(w+b,F-1),e.stroke());if(x=D.frozenColumnCount(),B&&(1!==P||0!==x||D.qq<=s||D.qq>=s+l))for(M=0,S=(A=E.cJ(t)).length;M<S;M++)N=0,I=0,R=(T=A[M]).y,k=T.y+J(T),T.y<c+h&&c<T.y+J(T)&&(1===P&&(0===x&&D.qq===s||x>0&&0===s)&&(N=-1,I=1),T.y<c&&(N=0,R=c),T.y+J(T)>c+h&&(I=0,k=c+h),e.moveTo(O-1,R+N-1),e.lineTo(O-1,k+I),e.stroke());e.beginPath(),e.restore()}},e.prototype.bJ=function(e){var t,n,o,r,a,s,l,u,c,f,h,p=this.kj,d=p._modelManager.getSelections(),g=d.length,m=p.Hr(e),y=[];for(t=0;t<g;t++)(n=d[t])&&(-1===(o=n.col)?(r=p.Hr(0,3),a=p.Hr(1,3),s=p.Hr(2,3),l=-1,u=-1,r.length>0&&(l=r[0].x,u=r[r.length-1].x+r[r.length-1].width-l,y.push(new i.Rect(l,-1,u,-1))),a.length>0&&(l=a[0].x,u=a[a.length-1].x+a[a.length-1].width-l,y.push(new i.Rect(l,-1,u,-1))),s.length>0&&(l=s[0].x,u=s[s.length-1].x+s[s.length-1].width-l,y.push(new i.Rect(l,-1,u,-1)))):m&&(c=m.findCol(o),f=m.findCol(o+n.colCount-1),(c||f)&&((h=new i.Rect(-1,-1,-1,-1)).x=c?c.x:m[0].x,h.width=f?f.x+Q(f)-h.x:m[m.length-1].x+m[m.length-1].width-h.x,y.push(h))));return y},e.prototype.cJ=function(e){var t,n,o,r,a,s,l,u,c,f,h,p=this.kj,d=p._modelManager.getSelections(),g=d.length,m=p.Gr(e),y=[];for(t=0;t<g;t++)(n=d[t])&&(-1===(o=n.row)?(r=p.Gr(0,3),a=p.Gr(1,3),s=p.Gr(2,3),l=-1,u=-1,r.length>0&&(l=r[0].y,u=r[r.length-1].y+r[r.length-1].height-l,y.push(new i.Rect(-1,l,-1,u))),a.length>0&&(l=a[0].y,u=a[a.length-1].y+a[a.length-1].height-l,y.push(new i.Rect(-1,l,-1,u))),s.length>0&&(l=s[0].y,u=s[s.length-1].y+s[s.length-1].height-l,y.push(new i.Rect(-1,l,-1,u)))):m&&(c=m.findRow(o),f=m.findRow(o+n.rowCount-1),(c||f)&&((h=new i.Rect(-1,-1,-1,-1)).y=c?c.y:m[0].y,h.height=f?f.y+J(f)-h.y:m[m.length-1].y+m[m.length-1].height-h.y,y.push(h))));return y},e.prototype.aJ=function(e,t,n,o,r,a){var s,l=this,u=l.kj,c=u.parent,f=u._eventHandler,h=o.x,p=o.y,d=Q(o),g=J(o),m=u.getViewportTopRow(t),y=u.getViewportLeftColumn(n),v=u.getViewportBottomRow(t),b=u.getViewportRightColumn(n),C=0,w=0,x=u.am(),A=0!==x.Cr;0!==x.Br||a.col!==y&&-1!==a.col||(C=2),A||a.row!==m&&-1!==a.row||(w=2),a.row+a.rowCount===v+1&&(r.height=r.height+1),a.col+a.colCount===b+1&&(r.width=r.width+1),d>=0&&g>=0&&(!r||o.intersect(r.x-1,r.y-1,Q(r)+2,J(r)+2))&&(e.save(),r&&!r.containsRect(o)&&(e.rect(r.x-C,r.y-w,Q(r),J(r)),e.clip()),e.beginPath(),e.strokeStyle=i.Rm.Om(u,u.getSelectionBorderColor()),e.lineWidth=2,d>0&&g>0?(f&&f.BG?2===(s=f.dJ)?(e.moveTo(h+.5,p-.5),e.lineTo(h+d-1,p-.5)):3===s?(e.moveTo(h+.5,p+g-.5),e.lineTo(h+d-1,p+g-.5)):0===s?(e.moveTo(h-.5,p+.5),e.lineTo(h-.5,p+g-1)):1===s&&(e.moveTo(h+d-.5,p+.5),e.lineTo(h+d-.5,p+g-1)):(c&&c.Vv)>2007?e.rect(h-1,p-1,d+1,g+1):e.rect(h-.5,p-.5,d,g),e.stroke(),c&&c.options.allowUserDragFill&&l.eJ&&l.eJ(e,t,n,o,r)):0!==d&&0!==g||e.strokeRect(h-1,p-1,d+1,g+1),e.beginPath(),e.restore())},e.prototype.VI=function(e,t,n){var o,r,i,a,s=this.kj,l=s.am(),u=l.Ft(e,t);return 1===t&&((r=(o=s.Hr(t)).length>0?o[o.length-1]:C)&&(u.width=w(Q(u),r.x+Q(r)-l.pt))),1===e&&((a=(i=s.Gr(e)).length>0?i[i.length-1]:C)&&(u.height=w(J(u),a.y+J(a)-l.qt))),n?n.getIntersect(u.x,u.y,Q(u),J(u)):u},e.prototype.XI=function(e,t,n,o){var r,i,a,s,l=this.kj,u=l._modelManager,c=n.length,f=[];for(s=0;s<c;s++)(i=n[s])&&((r=u.findSpan(i.row,i.col))&&r.containsRange(i)&&(i=r),(a=l.getRangeRect(e,t,i))&&a.x<=o.x+Q(o)&&a.y<=o.y+J(o)&&o.x<=a.x+Q(a)&&o.y<=a.y+J(a)&&f.push(a));return f},e.prototype.fJ=function(e,t,n){var o,r,i,a,s,l,u,c,f,h,p;if(e.save(),o=t.x,r=t.y,i=Q(t),a=J(t),s=[6,6],e.setLineDash)e.beginPath(),e.lineWidth=2,e.strokeStyle=n,e.setLineDash(s),e.rect(o,r,i-1,a-1),e.stroke();else{for(e.beginPath(),e.lineWidth=2,e.strokeStyle=n,l=s[0],u=s[1],c=void 0,f=void 0,h=void 0,p=void 0,c=o,f=r,h=i;h>0;)if(h>=l+u)e.moveTo(c,f),e.lineTo(c+l,f),c=c+l+u,h=h-l-u;else{if(h>=l){e.moveTo(c,f),e.lineTo(c+l,f),h=h-l-u;break}if(h>0){e.moveTo(c,f),e.lineTo(c+h,f),h=h-l-u;break}}for(c=o+i-1,f=r+1,p=a-1,h<0&&((h=A(h))>u&&(e.moveTo(c,f-2),e.lineTo(c,f+(h-u))),f+=h,p-=h);p>0;)p>=l+u?(e.moveTo(c,f),e.lineTo(c,f+l),f=f+l+u,p=p-l-u):p>=l?(e.moveTo(c,f),e.lineTo(c,f+l),p=p-l-u):p>0&&(e.moveTo(c,f),e.lineTo(c,f+p),p=p-l-u);for(c=o+i-2,f=r+a-1,h=i-1,p<0&&((p=A(p))>u&&(e.moveTo(c+2,f),e.lineTo(c-(p-u),f)),c-=p,h-=p);h>0;)if(h>=l+u)e.moveTo(c,f),e.lineTo(c-l,f),c=c-l-u,h=h-l-u;else{if(h>=l){e.moveTo(c,f),e.lineTo(c-l,f),h=h-l-u;break}if(h>0){e.moveTo(c,f),e.lineTo(c-h,f),h=h-l-u;break}}for(c=o,f=r+a-2,p=a-1,h<0&&((h=A(h))>u&&(e.moveTo(c,f+2),e.lineTo(c,f-(h-u))),f-=h,p-=h);p>0;)p>=l+u?(e.moveTo(c,f),e.lineTo(c,f-l),f=f-l-u,p=p-l-u):p>=l?(e.moveTo(c,f),f-l===r?e.lineTo(c,f-l-1):e.lineTo(c,f-l),p=p-l-u):p>0&&(f>r&&(e.moveTo(c,f),e.lineTo(c,f-p)),p=p-l-u);e.stroke()}e.beginPath(),e.restore()},e.prototype.XIb=function(e,t,n,o,r,i,a){var s,l,u,c,f;0!==t.length&&(s=t[0].col-1,l=t[t.length-1].col+1,u=n.zHb(o.row,s,a,1),r&&s>=0&&i.isValid&&!i.isValid(o.row,s,u)&&e.push({style:i.getDataValidator(o.row,s).highlightStyle(),x:t[0].x-i.getColumnWidth(s),y:o.y,width:i.getColumnWidth(s),height:o.height}),c=n.zHb(o.row,l,a,1),r&&i.isValid&&!i.isValid(o.row,l,c)&&(f=t[t.length-1],e.push({style:i.getDataValidator(o.row,l).highlightStyle(),x:f.x+f.width,y:o.y,width:i.getColumnWidth(l),height:o.height})))},e.prototype.YIb=function(e,t,n){var o,r,i,a,s=t.ss,l=e.row,u=e.col,c={},f={},h=[],p=e.rowCount,d=e.colCount;for(o=0;o<d;o++)f[o]=t.Tl(o+u,n);for(r=0;r<p;r++){for(c[r]=t.Sl(r+l,n),i=[],a=0;a<d;a++)i.push(s.Ym(l+r,u+a,n));h.push(i)}return{rowSizes:c,colSizes:f,styleList:h}},e.prototype.TI=function(e,t,o,i,a,s){var u,h,p,d,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,O,F,P,H,B,L,z,V,G,W,U,Z,q,Y,K,$,X,ee,te,ne,oe,re,ie,ae,se,le,ue,ce,fe,he,pe,de,ge,me,ye,ve,be,Ce,we,xe,Ae,Me,Se,Te,Ne;if(m(i)&&(i=3),p=(h=(u=this).kj).parent,d=h.am().Ft(t,o),y=p&&p.options.resizeZeroIndicator,v=h.Gr(t,i),b=h.Hr(o,i),C=h.options.sheetAreaOffset,w=h.Gt&&h.Gt()||{x:C.left,y:C.top,width:0,height:0},x=v.length,A=b.length,!(x<0||A<0)){for(S=(M=h.Ir(t,o,i,!0)).length>0,R=h.ss,D=0,j=0,O=0,F=0,B=new l.AF(h,v,b,i),L=[],z=[],V=[],G=[],W=!s&&3===i&&p&&p.options.highlightInvalidData,e.save(),e.beginPath(),U=[],Z=-1,q=-1,Y=h.ar(3),K=h.$q(3),X=0===($=h.am()).Cr&&0===w.height,ee=0===$.Br&&0===w.width,te=!!c(this.kj),ne=n("SheetsCalc"),oe=h.getActiveRowIndex(),re=h.getActiveColumnIndex(),ie=this.ZIb(i,h,oe,re),ae=0;ae<x;ae++)for(T=v[ae],u.XIb(G,b,R,T,W,h,i),se=0;se<A;se++)if(N=b[se],(I=S&&M.findCell(T.row,N.col))?(k=I.row,E=I.col,D=I.x,j=I.y,O=Q(I),F=J(I),I.isAutoMerge&&(D=(le=u.$Ib(I,t,o,i)).x,j=le.y,O=le.width,F=le.height),I.spanSizeInfo||(I.spanSizeInfo=u.YIb(I,h,i))):(k=T.row,E=N.col,D=N.x,j=T.y,O=Q(N),F=J(T)),1===y&&(-1===t&&h.getColumnVisible(E)&&0===h.$r(E)&&((q<0||q!==E-1)&&U.push({x1:D,y1:j,x2:D,y2:j+F,horizontal:!1}),q=E),-1===o&&h.getRowVisible(k)&&0===h.Yr(k)&&((Z<0||Z!==k-1)&&U.push({x1:D,y1:j,x2:D+O,y2:j,horizontal:!0}),Z=k)),!(a&&(D+O<=a.x||D>=a.x+Q(a)||j+F<=a.y||j>=a.y+J(a))||0===O||0===F||(ue=!1,I&&f.Bb(L,I)))){if(ce=!1,P=R.zHb(k,E,i,1),fe=h.jZ&&h.jZ(),ie&&0===k&&E>=ie.dj&&ie.cj+ie.Xj>h.lq&&E<ie.dj+ie.OZ){if(P=h.getCell(ie.cj,E).text()+"",ue=!0,ce=ie.filterButtonVisible(),fe)for(he=0;he<fe.length;he++)if(fe[he].col===E&&fe[he].rowFilter.sj===ie){this._Ib(fe[he],1,0,!0);break}}else if(fe&&fe.length>0)for(pe=fe[0].rowFilter&&fe[0].rowFilter.sj,he=fe.length-1;he>=0;he--)if(fe[he].tableColumnHeaderFilter&&fe[he].col===E){this._Ib(fe[he],3,pe.cj,!1);break}H=R.Ym(k,E,i),W&&h.isValid&&!h.isValid(k,E,P)&&G.push({style:h.getDataValidator(k,E).highlightStyle(),x:D,y:j,width:O,height:F}),3===i&&(de=H.formatter,ne&&!s&&de&&g(de)&&((ge=h.parent&&h.parent.aJb(de))&&(me=ge.getExpression(),P=ne.evaluateExpression(h,me,k,E)))),B.jF(k,E,D,j,O,F,H,I,k===Y&&X,E===K&&ee,P),ue&&(H.hAlign=0),z.push({data:P,row:k,col:E,x:D,y:j,width:O,sparkline:te&&h.getSparkline(k,E),height:F,style:H,cellLayout:I,tableFilter:ce}),I&&L.push(I)}if(z.length>0){if(3===i&&h.options.allowCellOverflow&&(ye=R.Sm(t,o,(function(){return new _(h,t,o)})),(V=u.hJ(e,ye,z,B)).length>0)){for(ve=a.x,be=a.x+a.width,ae=0;ae<V.length;ae++)(Ce=V[ae])&&(we=Ce.row,xe=Ce.col,(Ae=Ce.cellOverflowLayout&&Ce.cellOverflowLayout.layout)&&((Me=Ae.x)<ve&&(ve=Me),(Se=Me+Ae.width)>be&&(be=Se)),B.jF(we,xe,Ce.x,Ce.y,Ce.width,Ce.height,Ce.style,Ce.cellLayout,we===Y&&X,xe===K&&ee,Ce.data));z=z.concat(V),a.x=ve,a.width=be-ve,!s&&d&&(a=a?d.getIntersectRect(a):d)}a&&(Te=h.printInfo&&h.printInfo(),s&&Te&&(Te.columnStart()>0||Te.rowStart()>0)&&!Te.showBorder()?e.rect(a.x-(Te.columnStart()>0?2:0),a.y-(Te.rowStart()>0?2:0),Q(a)+(Te.columnStart()>0?4:0),J(a)+(Te.rowStart()>0?4:0)):e.rect(a.x,a.y,Q(a),J(a)),e.clip()),u.SI(e,z,i,s)}r.Worksheet.ao(h,"paintViewport",{ctx:e,rowViewportIndex:t,colViewportIndex:o,sheetArea:i,clipRect:a,isPrinting:s}),B.paint(e),U.length>0&&u.iJ(e,U,1,3),G.length>0&&(Ne=d.getIntersectRect(a),e.rect(Ne.x,Ne.y,Q(Ne),J(Ne)),e.clip(),u.jJ(e,G)),e.restore()}},e.prototype._Ib=function(e,t,n,o){e.sheetArea=t,e.row=n,e.tableColumnHeaderFilter=o},e.prototype.ZIb=function(e,t,n,o){if(t.tables&&1===e&&0===t.frozenRowCount()&&0===t.frozenColumnCount()){var r=t.tables.find(n,o);if(r&&r.MZ&&r.cj<t.lq)return r}return null},e.prototype.$Ib=function(e,t,n,o){var r,a,s,l,u,c,f,h,p,d=e.row,g=e.col,m=e.x,y=e.y,v=e.width,b=e.height,C=this.kj,w=C.am();return 1!==t||3!==o&&2!==o||(r=w.fm(t),a=C.frozenRowCount(),s=C.getRowCount(o)-C.frozenTrailingRowCount()-1,y<(l=r.y)&&a<=d&&d<=s&&(b-=l-y,y=l),y+b>l+(u=r.height)&&a<=d+e.rowCount-1&&d+e.rowCount-1<=s&&(b-=y+b-(l+u))),1!==n||3!==o&&1!==o||(r=w.gm(n),c=C.frozenColumnCount(),f=C.getColumnCount(o)-C.frozenTrailingColumnCount()-1,m<(h=r.x)&&c<=g&&g<=f&&(v-=h-m,m=h),m+v>h+(p=r.width)&&c<=g+e.colCount-1&&g+e.colCount-1<=f&&(v-=m+v-(h+p))),new i.Rect(m,y,v,b)},e.prototype.iJ=function(e,t,n,o){var r,i,a,s,l,u,c,f;if(0!==t.length)for(r=0,i=t.length;r<i;r++)s=(a=t[r]).x1,l=a.y1,u=a.x2,c=a.y2,f=a.horizontal,e.beginPath(),e.save(),e.lineWidth=n,e.strokeStyle=this.kJ(e,f,s,l,u,c),e.fillStyle=this.lJ(e,f,s,l,u,c),f?(-3,1,-1,-2,e.fillRect(s,l+-3,u-s-1,o+2*n),l+=.5,c+=.5,e.moveTo(s+-1,l+-3),e.lineTo(u+-2,c+-3),e.moveTo(s+-1,l+1),e.lineTo(u+-2,c+1)):(-3,1,0,-1,e.fillRect(s+-3,l+0,o+2*n,c-l-1),s+=.5,u+=.5,e.moveTo(s+-3,l+0),e.lineTo(u+-3,c+-1),e.moveTo(s+1,l+0),e.lineTo(u+1,c+-1)),e.stroke(),e.restore()},e.prototype.lJ=function(e,t,n,o,r,a){var s,l,u,c,f,h=t?D:j,p=i.Im.Km(0,"gc-"+h+"-normal"),d=p&&p.backgroundColor,g=p&&p.backgroundImage;if(!t&&g&&-1!==g.indexOf("linear-gradient"))for(l=i.Ul.wl(g),s=e.createLinearGradient(n,o,r,a),u=0,c=l.length;u<c;u++)f=l[u],s.addColorStop(f.point,f.color);else d&&(s=d);return s},e.prototype.kJ=function(e,t,n,o,r,a){var s=e.createLinearGradient(n,o,r,a),l=t?D:j,u=i.Im.Km(0,"gc-"+l+"-normal");return t?(s.addColorStop(0,u.borderTopColor),s.addColorStop(1,u.borderBottomColor)):(s.addColorStop(0,u.borderLeftColor),s.addColorStop(1,u.borderRightColor)),s},e.prototype.jJ=function(e,t){var n,o,r,i,a,s,l,u,c,f=this.kj.vu();if(t)for(n=t.length,o=0;o<n;o++)i=(r=t[o]).x,a=r.y,s=r.width,l=r.height,0===(c=(u=r.style).type)&&this.hyb(e,i,a,s,l,u),1===c&&this.iyb(e,i,a,s,l,u),2===c&&this.jyb(e,i,a,s,l,u,f)},e.prototype.hyb=function(e,t,n,o,r,i){var a=i.color,s=t-4,l=n-4,u=o+8,c=r+8,f=.5522848,h=u/2*f,p=c/2*f,d=s+u,g=l+c,m=s+u/2,y=l+c/2;e.save(),e.lineWidth=2,e.strokeStyle=a,e.beginPath(),e.moveTo(s,y),e.bezierCurveTo(s,y-p,m-h,l,m,l),e.bezierCurveTo(m+h,l,d,y-p,d,y),e.bezierCurveTo(d,y+p,m+h,g,m,g),e.bezierCurveTo(m-h,g,s,y+p,s,y),e.closePath(),e.stroke(),e.restore()},e.prototype.iyb=function(e,t,n,o,r,i){var a,s,l,u,c,f,h,p,d;t-=.5,n-=.5,h=Math.min(o/2,r/2),p=i.color,d=i.position,e.save(),e.lineWidth=2,e.strokeStyle=p,e.beginPath(),e.rect(t,n,o,r),e.stroke(),e.restore(),e.save(),e.beginPath(),0===d?(l=t,u=(s=n)+h,c=(a=t)+h,f=s):2===d?(l=a=t+o,u=(s=n+r)-h,c=a-h,f=s):3===d?(l=t,u=(s=n+r)-h,c=(a=t)+h,f=s):1===d&&(l=a=t+o,u=(s=n)+h,c=a-h,f=s),e.moveTo(a,s),e.lineTo(l,u),e.lineTo(c,f),e.fillStyle=p,e.fill(),e.closePath(),e.restore()},e.prototype.jyb=function(e,t,n,o,r,i,a){var s,l,u,c,f,h,p;if(t-=.5,n-=.5,s=this.kj.zoom(),15,15,c=i.image,f=i.position,3,h=i.color,e.save(),e.beginPath(),e.lineWidth=2,e.strokeStyle=h,e.rect(t,n,o,r),e.stroke(),c&&"none"!==c&&a){4===f?l=t-18:5===f&&(l=t+o+3);try{a.ko(c)?(p=a.lo(c),u=n+r/2-7.5,e.drawImage(p,l,u,15,15)):a.fo(c)}catch(e){}}else 4===f?l=t-18*s:5===f&&(l=t+o+3*s),u=n+r/2-15*s/2,e.translate(l,u),e.scale(.015*s,.015*s),e.beginPath(),e.moveTo(512,0),e.bezierCurveTo(229.248,0,0,229.184,0,512),e.bezierCurveTo(0,794.816,229.248,1024,512,1024),e.bezierCurveTo(794.752,1024,1024,794.752,1024,512),e.bezierCurveTo(1024,229.24800000000005,794.752,0,512,0),e.closePath(),e.moveTo(783.488,692.992),e.lineTo(692.9920000000001,783.4879999999999),e.lineTo(512,602.496),e.lineTo(331.00800000000004,783.4879999999999),e.lineTo(240.51200000000006,692.992),e.lineTo(421.504,512),e.lineTo(240.512,330.944),e.lineTo(331.008,240.44800000000004),e.lineTo(512,421.44),e.lineTo(692.992,240.384),e.lineTo(783.4879999999999,330.88),e.lineTo(602.496,512),e.lineTo(783.488,692.992),e.closePath(),e.fillStyle=h,e.fill(),e.stroke();e.restore()},e.prototype.SI=function(e,t,n,o,a,s,l){var u,f,h,g,m,y,v,w,x,A,M,S,T,N,I,R,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,Y,K,$,X,ee;for(void 0===s&&(s=0),void 0===l&&(l=0),h=3===n,g=(f=(u=this).kj).zoom(),m=b(u.Bl(),g),y=f.getDefaultStyle(n),v=f.Al(n),w=u.kj.conditionalFormats,x=ne(f),A=f.$q(2),M=f.ar(1),S=a?a.vu():f.vu(),e.save(),e.beginPath(),e.fillStyle=y&&y.foreColor||k,d(e,m.font),e.textAlign=h?"right":"center",I=t.length,U=[],q={sheet:f,row:-1,col:-1,fontInfo:C,lineHeight:-1,imageLoader:S,conditionalFormats:w,sheetArea:n,parentBackColor:x},T=0;T<I;T++)D=(R=t[T]).data,L=R.tableFilter,j=R.row,_=R.col,O=R.x,F=R.y,P=Q(R),H=J(R),B=R.style,z=R.cellOverflowLayout,G=B.font?b(B.font,g):m,B.font=G.font,P>0&&H>0&&(E=B.cellType||v,O--,F--,P++,H++,h?q.sparkline=R.sparkline:(V=o?0:u.mJ(j,_,n),q.visualState=V),W=p(G.font),q.lineHeight=W,q.row=j+s,q.col=_+l,q.fontInfo=G,q.cellOverflowLayout=z,q.needTopGridline=1===n&&j===M||0===n,q.needLeftGridline=2===n&&_===A||0===n,q.isPrinting=o,E.jp(e,D,O,F,P,H,B,q,L),z&&!q.showBarIconOnly&&(Y=new i.Rect(O,F,P,H),K=E.Ama?E.Ama(e,Y,B,q):Y,U.push({cellType:E,data:D,x:K.x,y:K.y,width:K.width,height:K.height,style:B,richText:void 0,options:{sheet:f,row:j,col:_,fontInfo:G,lineHeight:W,cellOverflowLayout:z,parentBackColor:x,imageLoader:S}})));if((I=U.length)>0)for($=f.isEditing(),X=f.Jl,ee=f.Kl,N=0;N<I;N++)D=(Z=U[N]).data,q=Z.options,$&&q.row===X&&q.col===ee||(c(this.kj)&&D&&"SparklineExValue"===D.typeName||u.BWa(e,Z));for(e.restore(),I=t.length,T=0;T<I;T++)R=t[T],r.Worksheet.ao(f,"paintCell",{ctx:e,sheetArea:n,cell:R,isPrinting:o})},e.prototype.BWa=function(e,t){var n,o,r=t.cellType,a=t.data,s=t.x,l=t.y,u=Q(t),c=J(t),f=t.style,h=t.options,p=h.cellOverflowLayout;p&&r.uxb&&(n=p.layout,o=new i.Rect(n?n.x:s,n?n.y:l,n?n.width:u,n?n.height:c),r.uxb(e,o,h,a)),r.paintValue&&r.paintValue(e,a,s,l,u,c,f,h)},e.prototype.mJ=function(e,t,n){var o=this.kj,r=0;return te(o)&&(3===n||m(n)?!o.isEditing()&&o.wt(e,t)?r=3:o.vp(e,t,n)&&(r=2):(o.vp(e,t,n)&&(r=1,o.wp(e,t,n)&&(r=2)),o.xt(e,t,n)&&(r=4))),r},e.prototype.hJ=function(e,t,n,o){var r,a,s,l,u,c,f,h,p,d,g,m,y,v,b,w,x,A,M=this.kj,S=M.ss,T=n.length,N=[],I={},R=[],k=function(x){var A,T,k,E,D,j,_,O,F,P,H,B,L,z,V;if(r=n[x],l=r.row,u=r.col,c=r.y,h=J(r),y=t.nJ(l,e),v=y.headingOverflowlayouts,b=y.trailingOverflowLayouts,!I[l]){for(A={},T=0,k=y;T<k.length;T++)E=k[T],A[E.column]=!1;v&&v.forEach((function(e){A[e.column]=!1})),b&&b.forEach((function(e){A[e.column]=!1})),I[l]=A}for(D=I[l],w=y.find(u),j=0;j<w.length;j++)if(_=w[j]){if(O=M.getCellRect(l,_.column,C,C,!0),!D[_.column]){if(F=_.column,(s=S.Ym(l,F)).showEllipsis)continue;a=S.zHb(l,F,3,1,s),f=_.columnWidth,p=_.backgroundWidth,d=_.backgroundLeftWidth<0?O.x:_.backgroundRightWidth<0?O.x+Q(O)-p:O.x+Q(O)/2-_.backgroundLeftWidth,m={data:a,row:l,col:F,x:O.x,y:c,width:f,height:h,cellOverflowLayout:_,style:s},N.push(m),_.layout=new i.Rect(d,c,p,h),s=S.Ym(l,F),o.gF(l,F,_,s,O.x,c,f,h),D[_.column]=!0}_.column===u&&D[_.column]&&R.push(x)}if(v)for(P=0;P<v.length;P++)if((H=v[P])&&!D[H.column]&&H.contains(r.col)){if(u=H.column,(s=S.Ym(l,u)).showEllipsis)continue;a=S.zHb(l,u,3,1,s),f=H.columnWidth,p=H.backgroundWidth,B=M.getCellRect(l,H.endColumn,C,C,!0),d=B.x+Q(B)-p,m={data:a,row:l,col:u,x:d,y:c,width:f,height:h,style:s,cellOverflowLayout:H},N.push(m),H.layout=new i.Rect(d,c,p,h),D[H.column]=!0,o.gF(l,u,H,s,d,c,f,h)}if(b)for(L=0;L<b.length;L++)if((z=b[L])&&!D[z.column]&&z.contains(r.col)){if(u=z.column,(s=S.Ym(l,u)).showEllipsis)continue;a=S.zHb(l,u,3,1,s),f=z.columnWidth,p=z.backgroundWidth,V=M.getCellRect(l,z.startColumn,C,C,!0),d=V.x,g=V.x+p-f,m={data:a,row:l,col:u,x:g,y:c,width:f,height:h,style:s,cellOverflowLayout:z},N.push(m),z.layout=new i.Rect(d,c,p,h),o.gF(l,u,z,s,d,c,f,h),D[z.column]=!0}};for(x=0;x<T;x++)k(x);if(R.length>0)for(A=R.length-1;A>=0;A--)n.splice(R[A],1);return N.length>0&&N.sort((function(e,t){var n=e.row,o=t.row,r=e.col,i=t.col;return n!==o?n-o:r!==i?r-i:void 0})),N},e}(),t.oJ=O,F=".cutCopyIndicator",P=i.Events.CellChanged,H=i.Events.ClipboardChanged,B=i.Events.ValueChanged,L=i.Events.ColumnChanged,z=i.Events.RowChanged,V=i.Events.RangeChanged,G=i.Events.ClipboardPasting,W=i.Events.ClipboardPasted,U=i.Events.DragMerging,Z=i.Events.FloatingElementSelected,q=function(){function e(e){var t=this;t.yJ=!1,t.zJ=!1,t.kj=e,t.AJ()}return e.prototype.jx=function(e){var t=this;return 0===arguments.length?t.zJ:void(t.zJ=e)},e.prototype.BJ=function(e,t){var n,o=this;return 0===arguments.length?o.yJ:void((o.yJ!==e||e||t)&&(o.yJ=e,n=o.kj,n&&(n.$p(),m(o.Lfc)||clearTimeout(o.Lfc),o.Lfc=setTimeout((function(){if(!o.yJ){var e=n.tu();e&&e.hZ(t)}o.Lfc=C})))))},e.prototype.AJ=function(){var e=this,t=e.kj,n=!1;function o(){e.yJ&&e.BJ(!1)}function r(e,t){"resizable"!==e&&e!==t&&"isVisible"!==e&&o()}t._bind(H+F,(function(){e.BJ(!0)})),t._bind(B+F,o),t._bind(P+F,o),t._bind(L+F,(function(e,t){r(t.propertyName,"width")})),t._bind(z+F,(function(e,t){r(t.propertyName,"height")})),t._bind(V+F,o),t._bind(G+F,(function(){n=e.BJ()})),t._bind(W+F,(function(t,o){var r,i,a,s=o.cellRange,l=o.sheet.tu(),u=l.n5,c=n;if(s&&u&&l.PA){if(e.jx()){for(i=0,a=u;i<a.length;i++)if(a[i].intersect(s.row,s.col,s.rowCount,s.colCount)){c=!1;break}}else c=!1,r=!0;e.BJ(c,r)}})),t._bind(U+F,o),t._bind(Z+F,(function(e,n){"worksheet"!==n.type&&(t.endEdit(),i.Vl.kmb(t))}))},e.prototype.UI=function(e,t,n,o){var r,a,s,l,u,c,f,h,p,d,g,y,v;if(this.yJ&&(a=(r=this.kj)._render,l=(s=r.parent)?s.options:{},c=(u=r.tu()).n5,f=l.cutCopyIndicatorVisible,m(f)&&(f=!0),h=i.Rm.Om(r,l.cutCopyIndicatorBorderColor||"blue"),f&&u.PA===r&&c&&(p=a.VI(n,o,C),(d=a.XI(n,o,c,t))&&p))){for(e.save(),e.rect(p.x,p.y,Q(p),J(p)),e.clip(),g=0,y=d;g<y.length;g++)v=y[g],a.fJ(e,v,h);e.beginPath(),e.restore()}},e.prototype.rI=function(){this.BJ(!1)},e.prototype.sI=function(){this.BJ(!1)},e.prototype.tI=function(){this.BJ(!1)},e.prototype.uI=function(){this.BJ(!1)},e.prototype.ky=function(){this.BJ(!1)},e.prototype.no=function(){var e=this.kj;e._unbind(P+F),e._unbind(H+F),e._unbind(B+F),e._unbind(L+F),e._unbind(z+F),e._unbind(V+F),e._unbind(G+F),e._unbind(W+F),e._unbind(U+F),e._unbind(Z+F)},e}(),t.CJ=q,r.Worksheet.$n("render",{init:function(){var e=this;e._render=new O(e),e.at=new q(e)},dispose:function(e){var t,n=this;!1!==e.clearCache&&(n._render&&(n._render.kj=C,n._render=C),(t=n.at)&&(t.no(),n.at=C))},onLayoutChanged:function(e){var t,n=this.at;n&&("addRows"===(t=e.changeType)?n.rI():"deleteRows"===t?n.sI():"addColumns"===t?n.tI():"deleteColumns"===t&&n.uI())}})},"./dist/core/worksheet/worksheet-selection.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p;function d(e,t){return e.getColumnCount(t)}function g(e,t){return e.getRowCount(t)}function m(e){return e.rowCount}function y(e){return e.colCount}function v(e,t,n){var o,r,i=[],a=e.length;for(r=0;r<a;r++)o=e[r],r===t?i=i.concat(n):i.push(o);return i}function b(e,t,n){for(var o=n-1;o>=0;o--)if(e.getColumnVisible(t+o))return t+o;return t+n-1}function C(e,t,n){for(var o=n-1;o>=0;o--)if(e.getRowVisible(t+o))return t+o;return t+n-1}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/worksheet/worksheet.js"),r=n("./dist/core/util/common.js"),i=n("@grapecity/js-sheets-common"),a=n("./dist/core/util/domUtil.js"),s=n("./dist/core/core.enum.js"),l=i.Common.j.Fa,u=i.Common.k.ac,c=null,f=Math.max,h=Math.min,p="gc-selection",a.GC$.extend(o.Worksheet.prototype,{addSelection:function(e,t,n,o){var i,a,s=this,l=e,c=t,f=n,h=o;-1!==l&&-1!==c&&((i=s._modelManager.getSpans())&&u(i)>0&&(l=(a=s.su(i,r.kf(e,t,n,o))).row,c=a.col,f=m(a),h=y(a))),s._modelManager.do("addSelection",l,c,f,h),s.$p()},setSelection:function(e,t,n,o){this.DJ(e,t,n,o,2)},DJ:function(e,t,n,o,i){var a,s,l,u=this,c=g(u),h=d(u);e>=c&&(e=c-1),t>=h&&(t=h-1),a=f(0,e),s=f(0,t),u.Tr(),l=2===i?r.Vl.Wl(u):1===i,u.Kr(a,s,u.Er(a),u.Fr(s),!l),u.addSelection(e,t,n,o)},getSelections:function(){return this._modelManager.getSelections()},clearSelection:function(){var e=this;e.Tr(),e.Kr(0,0),o.Worksheet.ao(e,"clearSelection"),e.$p()},Tr:function(){this._modelManager.do("clearSelection")},Qs:function(e,t,n){var o,r,i,a,s,l,u,c,f,h,p=this,m=p.options,y=m.protectionOptions,v=!1!==y.allowSelectLockedCells,b=!1!==y.allowSelectUnlockedCells;if(!m.isProtected||v&&b)return!0;if(!v&&!b)return!1;if(r=t<0,i=e<0,v===(o=n?n.locked:p.tq(e,t,"locked"))&&(i||r)){for(a=i?g(p):1,e=i?0:e,s=r?d(p):1,t=r?0:t,l=p._modelManager,u=e+a-1,c=t+s-1,f=void 0,h=void 0,f=e;f<=u;f++)for(h=t;h<=c;h++)if((n=l.getStyle(f,h))&&v!==n.locked)return!1;if(i)for(f=e;f<=u;f++)if((n=l.getStyle(f,-1))&&v!==n.locked)return!1;if(r)for(h=t;h<=c;h++)if((n=l.getStyle(-1,h))&&v!==n.locked)return!1}return v===o},SZa:function(e,t,n,o){var r,i;for(t=t<0?0:t,r=e=e<0?0:e;r<e+n;r++)for(i=t;i<t+o;i++)if(this.tq(r,i,"locked"))return!0},ZZa:function(){var e,t=this.getSelections();for(e=0;e<t.length;e++)if(-1!==t[e].col)return!1;return!0},$Za:function(){var e,t=this.getSelections();for(e=0;e<t.length;e++)if(-1!==t[e].row)return!1;return!0},selectionPolicy:function(e){var t=this,n=t._modelManager;return 0===arguments.length?n.getSelectionPolicy():(n.do("setSelectionPolicy",e),t)},selectionUnit:function(e){var t=this,n=t._modelManager;return 0===arguments.length?n.getSelectionUnit():(n.do("setSelectionUnit",e),t)},getSelectionBackColor:function(){return this.options.selectionBackColor||r.Im.Lm(p).backgroundColor},getSelectionBorderColor:function(){return this.options.selectionBorderColor||r.Im.Lm(p).borderTopColor},m_a:function(e){return e?void(this.options.m_a=e):this.options.m_a},EJ:function(){var e,t,n=this,o=n._modelManager.getSelections();u(o)>0&&(e={selections:o},0!==(t=n._modelManager.getActiveSelectedRangeIndex())&&(e.activeSelectedRangeIndex=t),n.FJ=e,n.Tr(),n._render.im())},GJ:function(){var e=this,t=e.FJ,n=t&&t.selections;n&&(e._modelManager.do("setSelections",n),e._modelManager.do("setActiveSelectedRangeIndex",t.activeSelectedRangeIndex||0))},Ax:function(e,t,n){var o,r,i,a=this,s=a.HJ(e,t,n,a.Rr||0);s&&(o=s.row,r=s.col,i=s.leadingCellCol,a.IJ(o,r)&&(a.Qr=o,a.Rr=i,a.Jr(o,r)))},HJ:function(e,t,n,o){var r,i,a=this,s=g(a),u=d(a),f=e;return 0===f&&!n||0===s||0===u?c:(i=a.JJ(f,o),n||a.KJ(i),f=i.r,r=i.c,f<0&&n&&(((r=a.br(r))<0||l(r))&&(r=a.br(u)),o=r,f=(i=a.JJ(s,r)).r,(r=i.c)===t&&f<=e)?c:{row:f,col:r,leadingCellCol:o})},Bx:function(e,t,n){var o,r,i,a=this,s=a.LJ(e,t,n,a.Rr||0);!s||s.row===e&&s.col===t||(o=s.row,r=s.col,i=s.leadingCellCol,a.IJ(o,r)&&(a.Qr=o,a.Rr=i,a.Jr(o,r)))},LJ:function(e,t,n,o){var r,i,a=this,s=g(a),u=d(a),c=e;if((c!==s-1||n)&&0!==s&&0!==u&&(i=a.MJ(c,o),n||a.KJ(i),c=i.r,r=i.c,!(c===s&&n&&(r=a.Zq(r),(r>=u||l(r))&&(r=a.Zq(-1)),o=r,i=a.MJ(-1,r),c=i.r,r=i.c,r===t&&c>=e))))return{row:c,col:r,leadingCellCol:o}},Dx:function(){var e,t,n=this,o=n.NJ();o&&(e=o.row,t=o.col,n.Qr=e,n.Rr=t,n.Jr(e,t))},NJ:function(){var e,t,n,o,r=this,i=r.ir(),a=r.dr(),s=a;if(!i&&!s)return c;if(n=!1!==(t=(e=r.options).protectionOptions).allowSelectLockedCells,o=!1!==t.allowSelectUnlockedCells,!e.isProtected||n&&o)return{row:i,col:s};if(!n&&!o)return c;for(;i!==c&&i>=0;i=r.gr(i))for(s=a;s!==c&&s>=0;s=r.br(s))if(n===r.tq(i,s,"locked"))return{row:i,col:s};return c},Cx:function(){var e,t,n=this,o=n.OJ();o&&(e=o.row,t=o.col,n.Qr=e,n.Rr=t,n.Jr(e,t))},OJ:function(){var e,t,n,o,r=this,i=r._q(r.frozenRowCount()-1),a=r.Zq(r.frozenColumnCount()-1),s=a,l=r.ir(),u=r.dr();if(i===c||s===c)return c;if(n=!1!==(t=(e=r.options).protectionOptions).allowSelectLockedCells,o=!1!==t.allowSelectUnlockedCells,!e.isProtected||n&&o)return{row:i,col:s};if(!n&&!o)return c;for(;i!==c&&i<=l;i=r._q(i))for(s=a;s!==c&&s<=u;s=r.Zq(s))if(n===r.tq(i,s,"locked"))return{row:i,col:s};return c},zx:function(e,t,n){var o,r,i,a,s=this,l=s.tables;n?(o=l&&l.bJb(e,t))||(o=s.iy(e,t,n,s.Qr||0)):o=s.iy(e,t,n,s.Qr||0),o&&(r=o.row,i=o.col,a=o.leadingCellRow,s.IJ(r,i)&&(s.Qr=a,s.Rr=i,s.Jr(r,i)))},iy:function(e,t,n,o){var r,i,a,s=this,u=g(s),f=d(s),h=t;if(0===h&&!n||0===u||0===f)return c;for(i=s.PJ(o,h),a=o,n||s.KJ(i),r=i.r,h=i.c;h<0&&n;){if(((r=s.gr(r,3,!0))<0||l(r))&&(r=s.gr(u,3,!0)),o=r,r=(i=s.PJ(o,f)).r,h=i.c,r===e&&h<t)return c;if(r===e&&h===t){if(o===a)return c;r=(i=s.PJ(o,h)).r,h=i.c}}return{row:r,col:h,leadingCellRow:o}},KJ:function(e){var t,n=this,o=!1;e.r<0?e.r=n.ar():e.r>=g(n)&&(e.r=n.ir(),o=!0),e.c<0?e.c=n.$q():e.c>=d(n)&&(e.c=n.dr(),o=!0),o&&((t=n._modelManager.getSpan(e.r,e.c)).row!==e.r&&(e.r=t.row),t.col!==e.c&&(e.c=t.col))},Fx:function(e,t){for(var n,o,r=this,i=r._modelManager,a=i.getActiveSelectedRangeIndex(),s=-1,l=r.Tq(r._getActiveSelectedRange()),u=l.row,c=l.col,f=l.col+y(l)-1,h=e,p=t;h=(n=r.QJ(h,p)).r,!((p=n.c)>=c);){if(s===a&&h===e&&p<=t)return;--h>=u?p=f+1:(o=r.Tq(r._getActiveSelectedRange(3)),s=i.getActiveSelectedRangeIndex(),u=o.row,c=o.col,f=o.col+y(o)-1,h=o.row+m(o)-1,p=o.col+y(o))}h>=0&&(r.Jr(h,p),r.Qr=h,r.Rr=p)},Gx:function(e,t){for(var n,o,r=this,i=r._modelManager,a=i.getActiveSelectedRangeIndex(),s=-1,l=r.Tq(r._getActiveSelectedRange()),u=l.col,c=l.row+m(l)-1,f=l.col+y(l)-1,h=e,p=t;h=(n=r.RJ(h,p)).r,!((p=n.c)<=f);){if(s===a&&h===e&&p>=t)return;++h<=c?p=u-1:(o=r.Tq(r._getActiveSelectedRange(4)),s=i.getActiveSelectedRangeIndex(),u=o.col,c=o.row+m(o)-1,f=o.col+y(o)-1,h=o.row,p=o.col-1)}h>=0&&(r.Jr(h,p),r.Qr=h,r.Rr=p)},Rs:function(e,t,n){var o,r,i,a,s=this,l=s.tables;n?(o=l&&l.cJb(e,t))||(o=s.hy(e,t,n,s.Qr||0)):o=s.hy(e,t,n,s.Qr||0),!o||o.row===e&&o.col===t||(r=o.row,i=o.col,a=o.leadingCellRow,s.IJ(r,i)&&(s.Qr=a,s.Rr=i,s.Jr(r,i)))},hy:function(e,t,n,o){var r,i,a,s=this,u=g(s),f=d(s),h=t;if(h===f-1&&!n||0===u||0===f)return c;for(i=s.SJ(o,h),a=o,n||s.KJ(i),r=i.r,h=i.c;h===f&&n;){if(!(e!==u-1||e!==r||s.getRowVisible(r,3)&&s.Sl(r,3)>0))return c;if(((r=s._q(r,3,!0))>=u||l(r))&&(r=s._q(-1,3,!0)),o=r,r=(i=s.SJ(o,-1)).r,h=i.c,r===e&&h>t)return c;if(r===e&&h===t){if(o===a)return c;r=(i=s.SJ(o,h)).r,h=i.c}}return{row:r,col:h,leadingCellRow:o}},PJ:function(e,t){for(var n,o,i,a=t;a>=0&&(n=e,!(--a<0));)if((o=this._modelManager.getSpans(r.kf(n,a,1,1)))&&u(o)>0&&(a>=(i=o[0]).col&&(a=i.col,n=i.row)),this.IJ(n,a))return{r:n,c:a};return{r:n,c:a}},QJ:function(e,t){for(var n,o,r=this;t>=0&&!(--t<0);){if(n=r._modelManager.findSpan(e,t)){if(!((o=r._getActiveSelectedRange()).row<=n.row&&n.row+m(n)<=o.row+m(o)&&o.col<=n.col&&n.col+y(n)<=o.col+y(o)))continue;if(n.row!==e||n.col!==t)continue;t>=n.col&&(t=n.col,e=n.row)}if(r.IJ(e,t))return{r:e,c:t}}return{r:e,c:t}},SJ:function(e,t){for(var n,o,i,a,s=this,l=d(s),c=t;c<l&&(n=e,!((c=(o=s._modelManager.getSpan(n,c)).col+y(o))>=l));)if((i=s._modelManager.getSpans(r.kf(n,c,1,1)))&&u(i)>0&&(c>(a=i[0]).col?c=f(c,a.col+y(a)):n=a.row),s.IJ(n,c))return{r:n,c:c};return{r:n,c:c}},RJ:function(e,t){for(var n,o,r,i=this,a=i._modelManager,s=d(i);t<s&&!((t=(n=a.getSpan(e,t)).col+y(n))>=s);){if(o=a.findSpan(e,t)){if(!((r=i._getActiveSelectedRange()).row<=o.row&&o.row+m(o)<=r.row+m(r)&&r.col<=o.col&&o.col+y(o)<=r.col+y(r)))continue;if(o.row!==e||o.col!==t)continue;t>o.col?t=f(t,o.col+y(o)):e=o.row}if(i.IJ(e,t))return{r:e,c:t}}return{r:e,c:t}},IJ:function(e,t){var n,o,r=this;return!!r.Qs(e,t)&&(n=e>=0&&e<g(r)&&t>=0&&t<d(r)&&r.getRowVisible(e)&&r.getColumnVisible(t)&&r.Sl(e)>0&&r.Tl(t)>0,o=!!r.Tx,!0===n&&!0===o&&(!1===r.tq(e,t,"tabStop")&&(n=!1)),n)},JJ:function(e,t){for(var n,o;e>=0&&!(--e<0);)if((n=this._modelManager.getSpans(r.kf(e,t,1,1)))&&u(n)>0&&(e>=(o=n[0]).row&&(e=o.row,t=o.col)),this.IJ(e,t))return{r:e,c:t};return{r:e,c:t}},MJ:function(e,t){for(var n,o,i,a=this,s=g(a);e<s&&!((e=(n=a._modelManager.getSpan(e,t)).row+m(n))>=s);)if((o=a._modelManager.getSpans(r.kf(e,t,1,1)))&&u(o)>0&&(e>(i=o[0]).row?e=f(e,i.row+m(i)):t=i.col),a.IJ(e,t))return{r:e,c:t};return{r:e,c:t}},Ur:function(e,t,n,o,r){var i=this;i._modelManager.do("addSelection",e,t,n,o),r&&i.Xq<=0&&i._render.im()},aH:function(e,t,n){var o=this,r=o.Jx(e,t,o.Jl,o.Kl),i=r.row,a=r.col,s=m(r),l=y(r),u=o.selectionPolicy(),c=o.selectionUnit();0!==u&&(1===u&&o._modelManager.do("clearSelection"),1===c?(a=-1,l=-1):2===c&&(i=-1,s=-1),o.Kx(i,a,s,l,n))},Jx:function(e,t,n,o,i){var a,s,c,f,h,p=this;return l(n)&&(n=p.Jl),l(o)&&(o=p.Kl),s=(a=p._modelManager).getSpan(n,o),c=a.getSpan(e,t),i&&s.equals(c)?new r.Range(s.row,s.col,1,1):(f=s.union(c),(h=p._modelManager.getSpans())&&u(h)>0&&(f=p.TJ(h,f)),f)},Kx:function(e,t,n,o,i){var a,s,l,c,f,h,p=this,d=p._modelManager,g=p._getActiveSelectedRange();if(u(d.getSelections())>0?(s=r.kf(e,t,n,o),p.n_a?(a=p.p_a,p.p_a=s):((l=d.getSelections())[d.getActiveSelectedRangeIndex()]=s,d.do("setSelections",l))):p.n_a||d.do("addSelection",e,t,n,o),i&&p.Xq<=0){if(c=p._getActiveSelectedRange(),!p.n_a&&c.row===g.row&&c.col===g.col&&m(c)===m(g)&&y(c)===y(g))return;f=p._render,p.n_a&&(h=p.p_a,a&&a.containsRange(h)?h=a:a&&(h=a.union(h)),g=(h=h.union(r.kf(p.getActiveRowIndex(),p.getActiveColumnIndex(),1,1))).union(g),c=h.union(c)),g.containsRange(c)?f.im(g):c.containsRange(g)?f.im(c):(f.im(g),f.im(c),f.im(p.p_a))}},kyb:function(e){var t=[];return e&&(t=this._modelManager.getSpans(e)),t},lyb:function(e,t){var n,o=e.row,r=e.col,i=e.rowCount,a=e.colCount,s=t.row,l=t.col,u=t.rowCount,c=t.colCount,f=o+i,h=r+a,p=s+u,d=l+c,g=!1,m=!1;return e.intersect(s,l,u,c)&&(g=n=o>s||r>l||f<p||h<d,m=!n),t.myb=t.myb||m,g},nyb:function(e,t,n,o){var r,i=[],a=[];for(r=0;r<e.length;r++)a=this.oyb(e[r],t,n,o),i=i.concat(a);return i},oyb:function(e,t,n,o){var r,i,a,s,l,u=[],c=t.length;for(u.push(e),s=c-1;s>=0;s--)for(i=t[s],l=0;l<u.length;)r=u[l],this.lyb(r,i)?(u=v(u,l,a=this.v_a(r,i,n,o)),l+=a.length):l++;return u},pyb:function(e,t){var n=t.row,o=t.col,r=t.rowCount,i=t.colCount;return e.intersect(n,o,r,i)},qyb:function(e,t){var n,o,r=[];for(o=e.length-1;o>=0;o--)n=e[o],this.pyb(n,t)||r.push(n);return r},ryb:function(e){var t=!1,n=this._modelManager.getSpans(e);return 1===n.length&&(t=e.equals(n[0])),t},syb:function(e,t){var n,o,r,i=e,a=t.length,s=i.length,l=!0;for(o=a-1;o>=0;o--){for(n=t[o],r=s-1;r>=0;r--)if(i[r].equals(n)){l=!1;break}l&&i.push(n)}return i},tyb:function(e){var t,n,o,r,i=[];for(n=e.length-1;n>=0;n--)(t=e[n]).myb&&(delete t.myb,i.push(n));for(o=i.length,r=0;r<o;r++)e.splice(i[r],1)},v_a:function(e,t,n,o){var i,a,s,l,u,c,f,h,p,d,g,m,y;return t=this.Tq(t),i=[],a=e.getIntersect(t,n,o),e&&a?(s=e.row>=0?e.row:0,l=e.col>=0?e.col:0,u=e.rowCount,c=e.colCount,f=a.row,h=a.col,p=a.rowCount,g=l+c,y=h+a.colCount,(d=s+u)-(m=f+p)>0&&i.push(r.kf(m,l,d-m,c)),g-y>0&&i.push(r.kf(f,y,p,g-y)),h-l>0&&i.push(r.kf(f,l,p,h-l)),f-s>0&&i.push(r.kf(s,l,f-s,c))):i.push(e),i},u_a:function(e,t){var n,o,r,i,a,s,l,c,f,h,p=[],d=this.getRowCount(3),g=this.getColumnCount(3),m=this.deselectIgnoreSpan();if(e&&e.length>0){for(o=[],r=[],i=[],a=void 0,s=void 0,n=!1,l=e.length-1;l>=0;l--)a=e[l],m||!this.ryb(a)||this.pyb(a,t)?(o=this.v_a(a,t,d,g),m||(s=this.kyb(a)).length>0&&(o=this.nyb(o,s,d,g),i=this.qyb(s,t),r=this.syb(r,i),this.tyb(r)),c=u(o),!n&&c>0&&(this.setSelection(o[c-1].row,o[c-1].col,1,1),n=!0),p=o.concat(p)):r=this.syb(r,[a]);m||(p=r.concat(p))}for(this.Tr(),f=p.length,this.suspendPaint(),h=0;h<f;h++)this.addSelection(p[h].row,p[h].col,p[h].rowCount,p[h].colCount);n||this.setActiveCell(this.Jl,this.Kl),this.resumePaint()},Sx:function(e,t){var n,o,r,i,a,s,l,c,f,h=this,p=h._modelManager.getSelections();if(!(u(p)<=0)&&(n=h._getActiveSelectedRange(),o=h.UJ(n,e,t))){if(r=o.row,i=o.col,a=m(o),s=y(o),l=h.selectionPolicy(),c=h.selectionUnit(),0===l)return;1===l&&h._modelManager.do("clearSelection"),1===c?(i=-1,s=-1):2===c&&(r=-1,a=-1),h.Kx(r,i,a,s,!0),f=h._modelManager.getSelections(),h._eventHandler.zu(p,f)&&(h.yu(p,f),h.Au(p))}},UJ:function(e,t,n,o,r){var i=this,a=i.Tq(e),s=c;return 37===t?s=n?i.VJ(a,!1,o,r):i.WJ(a,o,r):39===t?s=n?i.XJ(a,!1,o,r):i.YJ(a,o,r):38===t?s=n?i.ZJ(a,!1,o,r):i.$J(a,o,r):40===t?s=n?i._J(a,!1,o,r):i.aK(a,o,r):36===t?s=n?i.bK(a,o,r):i.cK(a,o,r):35===t?s=n?i.dK(a,o,r):i.eK(a,o,r):33===t?s=i.fK(a,o,r):34===t&&(s=i.gK(a,o,r)),s&&(e.row<0&&(s.row=-1,s.rowCount=i.getRowCount()),e.col<0&&(s.col=-1,s.colCount=i.getColumnCount())),s},WJ:function(e,t,n){for(var o,i,a,s,l,u,p,d,g=this,v=e.row,b=e.col,w=m(e),x=y(e),A=b+x-1,M=C(g,v,w);A>0;)if(A--,g.IJ(M,A)&&(o=g.Jx(M,A,t,n),i=h(v,o.row),a=h(b,o.col),l=f(v+w-1,o.row+m(o)-1)-i+1,u=(s=h(b+x-1,o.col+y(o)-1))-a+1,i!==v||a!==b||l!==w||u!==x))return p=g.qq,b<(d=g.Kl)?a<=p&&g.rq(a):b===d&&s<=p&&g.rq(s),g.parent&&g.parent.options.scrollByPixel&&a===p&&0!==g.eCb&&g.rq(a,0),r.kf(i,a,l,u);return c},VJ:function(e,t,n,o){var i,a,s,u,c,p=this,d=e.row,g=e.col,v=p.frozenColumnCount(),b=v?p.Zq(v-1):p.$q(),C=t?b:p.$q();if(!l(C))return(v<=0||t)&&p.rq(C),i=p.Jx(d,C,n,o),a=h(d,i.row),s=h(g,i.col),u=f(d+m(e)-1,i.row+m(i)-1)-a+1,c=h(g+y(e)-1,i.col+y(i)-1)-s+1,r.kf(a,s,u,c)},lCb:function(e){var t,n,o,r,i,a=this;if(a.parent&&a.parent.options.scrollByPixel){for(o=a.ss,r=a.Fr(e),i=a.getViewportWidth(r);0<=e&&!((i-=o._m(e))<0);e--);t=e,n=i}else t=a.ks(e,2),n=0;return{dj:t,UP:n}},YJ:function(e,t,n){for(var o,i,a,s,l,u,p,g,v,b=this,w=e.row,x=e.col,A=m(e),M=y(e),S=x,T=d(b)-1,N=C(b,w,A);S<T;)if(S++,b.IJ(N,S)&&(o=b.Jx(N,S,t,n),i=h(w,o.row),a=f(x,o.col),l=f(w+A-1,o.row+m(o)-1)-i+1,u=(s=f(x+M-1,o.col+y(o)-1))-a+1,i!==w||a!==x||l!==A||u!==M))return p=b.Aw(),x<(g=b.Kl)?a>=p&&(v=b.lCb(a),b.rq(v.dj,v.UP)):x===g&&s>=p&&(v=b.lCb(s),b.rq(v.dj,v.UP)),r.kf(i,a,l,u);return c},XJ:function(e,t,n,o){var i,a,s,u,c,p,d=this,g=e.row,v=e.col,b=d.lr();if(!l(b))return d.rq(b),i=d.dr(),t||(i+=d.frozenTrailingColumnCount()),a=d.Jx(g,i,n,o),s=h(g,a.row),u=f(v,a.col),c=f(g+m(e)-1,a.row+m(a)-1)-s+1,p=f(v+y(e)-1,a.col+y(a)-1)-u+1,r.kf(s,u,c,p)},$J:function(e,t,n){for(var o,i,a,s,l,u,p,d,g=this,v=e.row,C=e.col,w=m(e),x=y(e),A=v+w-1,M=b(g,C,x);A>0;)if(A--,g.IJ(A,M)&&(o=g.Jx(A,M,t,n),i=h(v,o.row),a=h(C,o.col),l=(s=h(v+w-1,o.row+m(o)-1))-i+1,u=f(C+x-1,o.col+y(o)-1)-a+1,i!==v||a!==C||l!==w||u!==x))return p=g.lq,v<(d=g.Jl)?i<=p&&g.mq(i):v===d&&s<=p&&g.mq(s),g.parent&&g.parent.options.scrollByPixel&&i===p&&0!==g.cCb&&g.mq(i,0),r.kf(i,a,l,u);return c},ZJ:function(e,t,n,o){var i,a,s,u,c,p=this,d=e.row,g=e.col,v=p.frozenRowCount(),b=v?p._q(v-1):p.ar(),C=t?b:p.ar();if(!l(C))return(v<=0||t)&&p.mq(C),i=p.Jx(C,g,n,o),a=h(d,i.row),s=h(g,i.col),u=h(d+m(e)-1,i.row+m(i)-1)-a+1,c=f(g+y(e)-1,i.col+y(i)-1)-s+1,r.kf(a,s,u,c)},mCb:function(e){var t,n,o,r,i,a=this;if(a.parent&&a.parent.options.scrollByPixel){for(o=a.ss,r=a.Er(e),i=a.getViewportHeight(r);0<=e&&!((i-=o.Sl(e))<0);e--);t=e,n=i}else t=a.ms(e,2),n=0;return{cj:t,UP:n}},aK:function(e,t,n){for(var o,i,a,s,l,u,p,d,v,C=this,w=e.row,x=e.col,A=m(e),M=y(e),S=w,T=g(C)-1,N=b(C,x,M);S<T;)if(S++,C.IJ(S,N)&&(o=C.Jx(S,N,t,n),i=f(w,o.row),a=h(x,o.col),l=(s=f(w+A-1,o.row+m(o)-1))-i+1,u=f(x+M-1,o.col+y(o)-1)-a+1,i!==w||a!==x||l!==A||u!==M))return p=C.Fw(),w<(d=C.Jl)?i>=p&&(v=C.mCb(i),C.mq(v.cj,v.UP)):w===d&&s>=p&&(v=C.mCb(s),C.mq(v.cj,v.UP)),r.kf(i,a,l,u);return c},_J:function(e,t,n,o){var i,a,s,u,c,p,d=this,g=e.row,v=e.col,b=d.kr();if(!l(b))return d.mq(b),i=d.ir(),t||(i+=d.frozenTrailingRowCount()),a=d.Jx(i,v,n,o),s=f(g,a.row),u=h(v,a.col),c=f(g+m(e)-1,a.row+m(a)-1)-s+1,p=f(v+y(e)-1,a.col+y(a)-1)-u+1,r.kf(s,u,c,p)},cK:function(e,t,n){for(var o,i,a,s,l,u=this,p=e.row,d=e.col,g=m(e),v=y(e),b=u.frozenColumnCount()-1,C=u.Kl,w=p+g-1;b<C;)if(b++,u.IJ(w,b)){if(d<=b&&d+v-1===u.Kl)break;return o=u.Jx(w,b,t,n),i=h(p,o.row),a=h(d,o.col),s=f(p+g-1,o.row+m(o)-1)-i+1,l=h(d+v-1,o.col+y(o)-1)-a+1,u.rq(u.$q()),r.kf(i,a,s,l)}return c},bK:function(e,t,n){return e=this.VJ(e,!0,t,n),this.ZJ(e,!0,t,n)},eK:function(e,t,n){for(var o,i,a,s,l,u=this,p=e.row,g=e.col,v=m(e),b=y(e),C=d(u),w=u.Kl,x=p+v-1;C>w;)if(C--,u.IJ(x,C)){if(g+b-1>=C&&g===u.Kl)break;return o=u.Jx(x,C,t,n),i=h(p,o.row),a=f(g,o.col),s=f(p+v-1,o.row+m(o)-1)-i+1,l=f(g+b-1,o.col+y(o)-1)-a+1,u.rq(u.lr()),r.kf(i,a,s,l)}return c},dK:function(e,t,n){return e=this.XJ(e,!0,t,n),this._J(e,!0,t,n)},fK:function(e,t,n){var o,i,a,s,p,d,g,v=this,b=e.row,C=e.col,w=m(e),x=v.Ew();return l(x)?c:(o=v.Gr(1),i=-1,v.mq(x)?i=v._q(b+w-1-u(o)):v.frozenRowCount()<=0&&(i=v.ar()),i<v.lq?i=v.lq:i>=v.Fw()&&(i=v.gr(v.Fw())),a=v.Jx(i,C,t,n),s=h(b,a.row),p=h(C,a.col),d=h(b+w-1,a.row+m(a)-1)-s+1,g=f(C+y(e)-1,a.col+y(a)-1)-p+1,r.kf(s,p,d,g))},gK:function(e,t,n){var o,i,a,s,p,d,g,v=this,b=e.row,C=e.col,w=m(e),x=v.$x();return l(x)?c:(o=v.Gr(1),v.mq(x),(i=v.gr(b+w-1+u(o)))<v.lq?i=v.lq:i>=v.Fw()&&(i=v.lq>=v.kr()?v.Fw():v.gr(v.Fw())),a=v.Jx(i,C,t,n),s=f(b,a.row),p=h(C,a.col),d=f(b+w-1,a.row+m(a)-1)-s+1,g=f(C+y(e)-1,a.col+y(a)-1)-p+1,r.kf(s,p,d,g))},Ew:function(){var e,t,n,o,r,i=this,a=i.Gr(1);if(!a||u(a)<=0)return c;for(t=(e=i.frozenRowCount())?i._q(e-1):i.ar(),n=0,o=i.lq,r=i.am();o>t&&(o--,!((n+=i.Sl(o))>r.jr)););return o},zw:function(){var e,t,n,o,r,i=this,a=i.Hr(1);if(!a||u(a)<=0)return c;for(t=(e=i.frozenColumnCount())?i.Zq(e-1):i.$q(),n=0,o=i.qq,r=i.am();o>t&&(o--,!((n+=i.Tl(o))>r.er)););return o},$x:function(){var e,t=this.Gr(1),n=u(t);return t&&n>0?(e=t[n-1].row,this.ir()<=e?this.lq:e):c},kr:function(){var e,t,n,o,r,i,a=this;if(a.ir()===a.Fw()&&(e=a.am(),t=a.Gr(1),n=u(t),t&&n>=1&&(o=t[n-1]).y+o.height<=e.qt+e.jr))return a.lq;r=a.lq;try{return a.lq=a.ir(),i=a.Ew(),i=a._q(i)}catch(e){}finally{a.lq=r}},lr:function(){var e,t,n,o,r,i,a=this;if(a.dr()===a.Aw()&&(e=a.am(),t=a.Hr(1),n=u(t),t&&n>=1&&(o=t[n-1]).x+o.width<=e.pt+e.width))return a.qq;for(e=a.am(),r=0,i=a.dr();i>0&&!((r+=a.Tl(i))>e.er);)i--;return i>0&&(i=a.Zq(i)),i},Fw:function(){var e=this.Gr(1),t=u(e);return e&&t>0?e[t-1].row:c},Aw:function(){var e=this.Hr(1),t=u(e);return e&&t>0?e[t-1].col:c},hr:function(){var e,t,n=this.Gr(1),o=u(n);return n&&o>0?(e=this.am(),n[t=o-1].y+n[t].height<=e.qt+e.jr?n[t].row:n[f(t-1,0)].row):c},cr:function(){var e,t,n=this.Hr(1),o=u(n);return n&&o>0?(e=this.am(),n[t=o-1].x+n[t].width<=e.pt+e.er?n[t].col:n[f(t-1,0)].col):c},ir:function(e){l(e)&&(e=3);var t=g(this,e);return 3!==e&&2!==e||(t-=this.frozenTrailingRowCount()),this.gr(t,e)},dr:function(e){l(e)&&(e=3);var t=d(this,e);return 3!==e&&1!==e||(t-=this.frozenTrailingColumnCount()),this.br(t,e)},TJ:function(e,t){var n,o,r;if(e)for(n=0,o=u(e);n<o;n++)if(r=e[n],t.intersect(r.row,r.col,m(r),y(r)))return e.splice(n,1),n--,this.TJ(e,t.union(r));return t},_getActiveSelectedRange:function(e){var t,n=this._modelManager,o=u(n.getSelections()),i=r.kf(-1,-1,0,0);return o<=0||(t=n.getActiveSelectedRangeIndex(),3===e?(--t<0&&(t=o-1),n.do("setActiveSelectedRangeIndex",t)):4===e&&(++t>=o&&(t=0),n.do("setActiveSelectedRangeIndex",t)),(t=n.getActiveSelectedRangeIndex())>=0&&(i=n.getSelections()[t])),i}}),o.Worksheet.$n("selection",{init:function(){this._modelManager.do("addSelection",0,0,1,1),this._modelManager.setCellState(0,0,s.CellStatesType.active,!0,s.SheetArea.viewport)}})},"./dist/core/worksheet/worksheet-sort.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v;function b(e,t,n){for(var o=e[n-t];o<n;)o=e[o-t];return o}function C(e){return"object"==typeof e?JSON.stringify(e):o.Common.pc.bc(o.Common.pc.ec(e))}function w(e,t){return e instanceof Date&&t instanceof Date?h(e)===h(t):typeof e===m&&typeof t===m?e.toLowerCase()===t.toLowerCase():e===t}function x(e,t,n,o){var r,i;return d(e)||(r=o?e.backColor:e.foreColor,d(r)||(r=C(r))),d(t)||(i=o?t.backColor:t.foreColor,d(i)||(i=C(i))),(r=r||"")===(i=i||"")?0:r===n?1:i===n?-1:0}function A(e,t){var n,o,r,i,a;return e instanceof Date&&(e=h(e)),t instanceof Date&&(t=h(t)),r=(n=typeof e)===m,i=(o=typeof t)===m,a=o===y,n===o||n!==y&&!a?!(n!==g||!i)||(!r||o!==g)&&(r&&i?e.toLowerCase()>t.toLowerCase():e>t):a}function M(e,t,n,o,r,i){var a,s,l,u,c,f,h,p,g,m,v,b,C=r,M=e,S=t;if(C)for(s=0;s<C.length&&(C[s]&&(l=C[s].ascending,0<=(u=C[s].index)&&(c=void 0,f=void 0,h=o?M:u,p=o?u:M,g=o?S:u,m=o?u:S,i?(c=i[h][p],f=i[g][m]):(c=n.getValue(h,p),f=n.getValue(g,m)),C[s].compareFunction?(a=C[s].compareFunction(c,f),l||(a*=-1)):d(C[s].color)?(v=d(c)||""===c||typeof c===y&&isNaN(c),b=d(f)||""===f||typeof f===y&&isNaN(f),v||b?v&&b?a=0:v&&!b?a=1:!v&&b&&(a=-1):a=w(c,f)?0:A(c,f)?l?1:-1:l?-1:1):(void 0,void 0,a=x(n.getActualStyle(h,p,3,!1,!1,!0),n.getActualStyle(g,m,3,!1,!1,!0),C[s].color,C[s].isBackColor),l||(a*=-1)))),0===a);s++);return a}function S(e,t,n,o,r){var i,a,s,l,u,c,f,h=e.length;if(h<=1)return e;for(a=e[i=Math.floor(h/2)],s=[],l=[],u=[],c=0;c<h;c++)i!==c?(f=M(e[c],a,t,n,o,r))<0?s.push(e[c]):f>0?l.push(e[c]):u.push(e[c]):u.push(e[c]);return S(s,t,n,o,r).concat(u,S(l,t,n,o,r))}function T(e,t,n,o,r,i,a){var s,l,u=t?e.rowOutlines:e.columnOutlines,c=[],f=[];if(t){for(s=i;s<i+a;s++)e.Ps(s)||e.rowOutlines&&e.rowOutlines.isCollapsed(s)||(e.getRowVisible(s,3,!0)?0===e.getRowHeight(s)&&(c.push(s),e.setRowHeight(s,e.defaults.rowHeight)):(f.push(s),e.setRowVisible(s,!0)));for(u.nec(n.groupSwap,n.array,r.start),s=0;s<f.length;s++)l=p.Cb(o,f[s])+i,e.setRowVisible(l,!1);for(s=0;s<c.length;s++)l=p.Cb(o,c[s])+i,e.setRowHeight(l,0)}else{for(s=i;s<i+a;s++)e.columnOutlines&&e.columnOutlines.isCollapsed(s)||(e.getColumnVisible(s,3)?0===e.getColumnWidth(s)&&(c.push(s),e.setColumnWidth(s,e.defaults.colWidth)):(f.push(s),e.setColumnVisible(s,!0)));for(u.nec(n.groupSwap,n.array,r.start),s=0;s<f.length;s++)l=p.Cb(o,f[s])+i,e.setColumnVisible(l,!1);for(s=0;s<c.length;s++)l=p.Cb(o,c[s])+i,e.setColumnWidth(l,0)}}function N(e,t,n){var o=e.qg(t,n,!1);o&&o.hasListeners()&&o.Yg()}function I(e,t,o,r){var i,a,s=n("SheetsCalc");s&&(i=s.CalcOperatorAdjustor.zj(e._source,e._source,e.Kf(t,o),t,o,0,0),e.Rf(t,o,i,r),(a=e.qg(t,o,!!i))&&a.og())}function R(e,t,n,o,r,i,a,s,l,u,c,f){var h,p,d,g,m,y,v,C,w,x,A,M=e._modelManager,S=M.Ky,T=S&&S.sV.length>0,R=i?t:n,k=i?t+o:n+r,E=i?n:t,D=i?n+r:t+o;for(x=R;x<k;x++)if(x!==(w=b(s,R,x)))for(i?(h=x,d=w):(p=x,g=w),A=E;A<D;A++)i?(p=A,g=A):(h=A,d=A),a&&(m=l[h][p],y=l[d][g]),T&&(v=S.get(h,p),C=S.get(d,g)),c&&f&&(N(c,h,p),N(c,d,g),c._f(h,p,d,g),I(c,h,p),I(c,d,g)),M.do("swapNode",h,p,d,g),e.uja&&e.wja(h,p,d,g),T&&S.qUa(v,h,p,C,d,g),a&&(l[h][p]=y,l[d][g]=m),u.push({row:h,col:p}),u.push({row:d,col:g})}function k(e,t,n,o,r,i,s,u,c,f,h){var p,d,g,m,y,b,C,w=[],x=e._modelManager.WTa;if(x>0&&t&&(e._modelManager.WTa=0,[].push.apply(e._modelManager.zTa,[{row:n,column:o,rowCount:r,columnCount:i,byRows:s,sortInfo:u,type:"sortRange",array:f.concat([])}])),p=l&&e.Bj(),d=l&&e.yj(),R(e,n,o,r,i,s,c,f,h,w,p,d),c)for(g=n;g<n+r;g++)for(m=o;m<o+i;m++)e.setValue(g,m,h[g][m]);if(p){for(y=n;y<n+r;y++)for(b=o;b<o+i;b++)(C=p.Kf(y,b))&&p.fg(y,b,C,v);e.getCalcService().recalcRange(d,n,o,r,i)}return a.Worksheet.ao(e,"sortRangeChanged",{column:o,columnCount:i}),x>0&&(e._modelManager.WTa=x),w}function E(e,t,n,o,r,i,a,s,u,c){var f,h,p,d,g,m;e.suspendPaint(),e.suspendEvent(),l&&e.suspendCalcService();try{if(c)for(h=[],p=t;p<t+o;p++)for(h[p]=[],d=n;d<n+r;d++)h[p][d]=e.getValue(p,d);return g=void 0,m=void 0,u?g=u:0===s.groupSort?g=(m=function(e,t,n,o,r,i,a,s,l){var u,c,f,h,p,d=i?o:r,g=i?t:n,m=[];for(u=0;u<d;u++)m[u]=g+u;for(c=s.ignoreHidden?function(e,t,n){var o,r,i=[];if(t)for(o=n.length-1;o>=0;o--)r=n[o],0===e.getRowHeight(r)&&(n.splice(o,1),i.push({mi:o,Qb:r}));else for(o=n.length-1;o>=0;o--)r=n[o],0===e.getColumnWidth(r)&&(n.splice(o,1),i.push({mi:o,Qb:r}));return i}(e,i,m):[],f=m.concat([]),h=!1,m=S(m,e,i,a,l),p=0;p<m.length;p++)if(m[p]!==f[p]){h=!0;break}return function(e,t){var n,o;for(n=e.length-1;n>=0;n--)o=e[n],t.splice(o.mi,0,o.Qb)}(c,m),{array:m,isChanged:h}}(e,t,n,o,r,i,a,s,h)).array:(m=function(e,t,n,o,r,i,a,s,l){var u,c,f,h,p=i?o:r,d=i?t:n,g=i?e.rowOutlines:e.columnOutlines,m=g.kec(d,p),y=g.lec(m,s.groupSort);if(!y){for(u=[],c=0;c<p;c++)u.push(d+c);y=[u]}for(c=0;c<y.length;c++)y[c]=S(y[c],e,i,a,l);return h=(f=g.mec(y,m,s.groupSort)).array,f.isChanged&&T(e,i,f,h,m,d,p),{array:h,isChanged:f.isChanged}}(e,t,n,o,r,i,a,s,h),g=m.array),!!g&&(f=k(e,m&&m.isChanged,t,n,o,r,i,a,c,g,h),!0)}finally{l&&e.resumeCalcService(!1),e.resumeEvent(),e.resumePaint(),e.Bu(t,n,o,r,f,4,v,v,v,!!u)}}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("./dist/core/util/domUtil.js"),i=n("./dist/core/util/common.js"),a=n("./dist/core/worksheet/worksheet.js"),s=n("@grapecity/js-calc"),l=!!s,u=n("./dist/core/core.ns.js"),c=new o.Common.ResourceManager(u.SR),f=c.getResource.bind(c),h=o.Common.l.Ra,p=o.Common.k,d=o.Common.j.Fa,g="boolean",m="string",y="number",v=void 0,r.GC$.extend(a.Worksheet.prototype,{sortRange:function(e,t,n,o,r,a,s,u,c){var h,p,d,g,m,y,v,b,C,w,x=this,A=x.getRowCount(),M=x.getColumnCount();if(-1===e&&(e=0),-1===n&&(n=A),-1===t&&(t=0),-1===o&&(o=M),e<0||e>=A||t<0||t>=M||n<0||e+n>A||o<0||t+o>M||!a)return!1;if(s=x.oec(i.kf(e,t,n,o),r,s),h=r?n:o,p=r?e:t,d=r?x.rowOutlines:x.columnOutlines,!u&&s.groupSort>0){if(!d)return!1;g=d.kec(p,h),r?(n=g.count,e=g.start):(o=g.count,t=g.start)}return l&&!x.Vq(e,t,n,o,!1)?(c&&x.Os(7,f().Exp_InvalidSortArrayFormulaInRange),!1):(m=x._modelManager.getSpans(i.kf(e,t,n,o)))&&m.length>0?(c&&x.Os(7,f().Exp_InvalidSortSpanInRange),!1):!(y=x.tables)||(b=1===(v=y.s$(e,t,n,o)).length&&v[0].dataRange().equals(i.kf(e,t,n,o)),v.length<=0||b)?((w=E(x,e,t,n,o,r,a,s,u,(C=x.wq)&&C.Ou||b&&v[0]&&v[0].LZ()))&&0!==s.groupSort&&x.xr&&x.xr.reFilter(),w):(c&&x.Os(7,f().Exp_InvalidSortPartTableOrMultiTableInRange),!1)},oec:function(e,t,n){var o,r=this,i=r.Tq(e),a=t?i.rowCount:i.colCount,s=t?i.row:i.col,l=t?r.rowOutlines:r.columnOutlines;return d(n)&&(n={}),r.outlineColumn&&r.outlineColumn.ZQa()&&t&&(o=r.outlineColumn.YQa.columnIndex,i.col<=o&&o<=i.col+i.colCount||(n.groupSort=0)),d(n.groupSort)&&(d(n.ignoreHidden)?n.groupSort=l&&l.pec(s,a)?1:0:n.groupSort=0),0===n.groupSort?n.ignoreHidden=!!d(n.ignoreHidden)||n.ignoreHidden:n.ignoreHidden=!1,n},hK:function(){var e=this.options;return!e.isProtected||e.protectionOptions.allowSort},wja:function(e,t,n,o){var r=this,i=r.getDataValidator(e,t),a=r.getDataValidator(n,o);r.setDataValidator(e,t,a),r.setDataValidator(n,o,i)}})},"./dist/core/worksheet/worksheet-static.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m;function y(e,t){return e.getRowCount(t)}function v(e,t){return e.getColumnCount(t)}function b(e,t,n){return e.$r(t,n)}function C(e,t,n){return e.Yr(t,n)}function w(e,t,n,o){e.setColumnWidth(t,n,o)}function x(e,t,n,o){e.setRowHeight(t,n,o)}function A(e,t,n,o){return e.getActualStyle(t,n,o)}function M(e,t){return e.getDefaultStyle(t)}function S(e,t,n){e.setDefaultStyle(t,n)}function T(e,t,n,o,r){e.Pq(t,n,o,r)}function N(e,t,n,o){throw Error(i.Common.u.Kb(m().Exp_InvalidAndSpace,[e,t,n,o]))}function I(e,t,n){return t&&n.Ps&&n.Ps(e)}function R(e,t,n,o,r,i,a,s,l){var u,c,f,h,d,g,b,C;if(!e)throw Error(m().Exp_SrcIsNull);if(!o)throw Error(m().Exp_DestIsNull);u=y(e),c=v(e),f=y(o),h=v(o),(t<-1||t>=u)&&N("from row index",t,"-1",u-1),(n<-1||n>=c)&&N("from column index",n,"-1",c-1),(r<-1||r>=f)&&N("to row index",r,"-1",f-1),(i<-1||i>=h)&&N("to column index",i,"-1",h-1),d=n,n<0&&(d=0,s=c),g=i<0?0:i,(s<1||d+s>c||g+s>h)&&N("column count",s,"1",p(c-d,h-g)),b=t,t<0&&(b=0,a=u),C=r<0?0:r,(a<1||b+a>u||C+a>f)&&N("row count",a,"1",p(u-b,f-C))}function k(e){if(!e)return e;if("number"==typeof e||"string"==typeof e||"boolean"==typeof e||u(e))return e;if(e.clone)return e.clone();if(e instanceof Date)return new Date(e.valueOf());var t,n,o;for(n in t=e instanceof Object?new e.constructor:new e.constructor(e.valueOf()),e)e.hasOwnProperty(n)&&(o=e[n],e.hasOwnProperty(n)&&t[n]!==o&&(t[n]="object"==typeof o?k(o):o));return t.toString=e.toString,t.valueOf=e.valueOf,t}function E(e,t,n,o,i,a,s,l,u){var c,f,p,d,g,m,y,v,b,C=e.getSpans(h,u),w=o.getSpans(h,u),x=[];if(C)for(c=0;c<C.length;c++)p=(f=C[c]).row,d=f.col,g=f.rowCount,m=f.colCount,-1===t?n<=d&&d+m<=n+l&&x.push(r.kf(p,a+d-n,g,m)):-1===n?t<=p&&p+g<=t+s&&x.push(r.kf(i+p-t,d,g,m)):t<=p&&p<t+s&&n<=d&&d<n+l&&x.push(r.kf(i+p-t,a+d-n,g,m));if(w)for(c=0;c<w.length;c++)p=(f=w[c]).row,void 0,y=(d=f.col)>=a&&d<a+l,v=p>=i&&p<i+s,(-1===t?y:-1===n?v:v&&y)&&((b=o.findSpan(p,d,u))&&b.row===p&&b.col===d&&o.do("removeSpan",b,u));for(c=0;c<x.length;c++)o.do("addSpan",x[c],u)}function D(e,t,n,o,r,i,a,s,l){var u,c=e.conditionalFormats,f=o.conditionalFormats,h=G(e,o);c&&f&&!e.dJb&&(u=c.XA(t,n,f,r,i,a,s,h),l&&c.YA(t,n,a,s,u,h))}function j(e,t,n,o,r,i,a,s,l,u){var c=!(e===o&&e.name()===o.name()),f=e._modelManager,h=f.zl(u);c?(E(f,t,n,o._modelManager,r,i,a,s,u),l&&h&&f.do("clearSpan",t,n,a,s,u)):l?f.do("moveSpan",t,n,r,i,a,s,u):f.do("copySpan",t,n,r,i,a,s,u)}function _(e,t,n,o,r,i,a,s,l){var u=t,c=n;u<0&&(u=0,a=p(y(e),y(o))),r<0&&(r=0),c<0&&(c=0,s=p(v(e),v(o))),i<0&&(i=0),t<0&&j(e,-1,c,o,-1,i,-1,s,l,1),n<0&&j(e,u,-1,o,r,-1,a,-1,l,2),j(e,u,c,o,r,i,a,s,l)}function O(e,t,n,o,r,i,a){var s,l,c,d,g,m,M,S;for(t<0&&(t=0,r=p(v(e),v(n))),o<0&&(o=0),1,s=0;s<r;s++)(64&i)>0&&(l=b(e,s+t),u(l)||(a&&w(e,s+t,e.defaults.colWidth),w(n,s+o,l)),c=e.getColumnVisible(s+t),u(c)||(a&&e.setColumnVisible(s+t,!0),n.setColumnVisible(s+o,c)),(d=A(e,-1,s+t))?(T(n,-1,s+o,d.clone()),a&&T(e,-1,s+t,f)):T(n,-1,s+o,f),(d=A(e,-1,s+t,1))?(T(n,-1,s+o,d.clone(),1),a&&T(e,-1,s+t,f,1)):T(n,-1,s+o,f,1)),(128&i)>0&&(g=e.getTag(-1,s+t),u(g)||(a&&e.setTag(-1,s+t,h),n.setTag(-1,s+o,g)));for(m=p(y(e,1),y(n,1)),M=0;M<m;M++)S=C(e,M,1),u(S)||(a&&x(e,M,e.defaults.colHeaderRowHeight,1),x(n,M,S,1))}function F(e,t,n,o,r,i,a,s){var l,c,d,g,m,M,S,N;for(t<0&&(t=0,r=p(y(e),y(n))),o<0&&(o=0),2,l=0;l<r;l++)!s&&I(o+l,a,n)||((64&i)>0&&(c=C(e,l+t),u(c)||(s&&x(e,l+t,e.defaults.rowHeight),x(n,l+o,c)),d=e.getRowVisible(l+t),u(d)||(s&&e.setRowVisible(l+t,!0),n.setRowVisible(l+o,d)),(g=A(e,l+t,-1))?(T(n,l+o,-1,g.clone()),s&&T(e,l+t,-1,f)):T(n,l+o,-1,f),(g=A(e,l+t,-1,2))?(T(n,l+o,-1,g.clone(),2),s&&T(e,l+t,-1,f,2)):T(n,l+o,-1,f,2)),(128&i)>0&&(m=e.getTag(l+t,-1),u(m)||(s&&e.setTag(l+t,-1,h),n.setTag(l+o,-1,m))));for(M=p(v(e,2),v(n,2)),S=0;S<M;S++)N=b(e,S,2),u(N)||(s&&w(e,S,e.defaults.rowHeaderColWidth,2),w(n,S,N,2))}function P(e,t,n,o){var r,i,a;e===t&&e.name()===t.name()||((64&n)>0&&(r=M(e),S(t,o?r:r.clone()),r=M(e,1),S(t,o?r:r.clone(),1),r=M(e,2),S(t,o?r:r.clone(),2),o&&(S(e,f),S(e,f,1),S(e,f,2))),i=t.defaults,a=e.defaults,i.colWidth=a.colWidth,i.rowHeight=a.rowHeight,i.rowHeaderColWidth=a.rowHeaderColWidth,i.colHeaderRowHeight=a.colHeaderRowHeight,o&&(a.colWidth=62,a.rowHeight=20,a.rowHeaderColWidth=40,a.colHeaderRowHeight=20))}function H(e,t,n,o,i,a,s,l,c,f,h,d){var g,m,b,C,w,x,A,M,S,T,N,R,E,D,j,_,O=!(e===o&&e.name()===o.name());if(2==(2&f)&&t<0)if(A=n,M=a,g=p(y(e,1),y(o,1)),m=l,n<0&&(A=0,m=v(e)),a<0&&(M=0),O)for(b=0;b<g;b++)for(C=0;C<m;C++)d(o,b,M+C,k(x=h(e,b,A+C,1)),1);else{for(w=new r.KTa,b=0;b<g;b++)for(C=0;C<m;C++)x=h(e,b,A+C,1),u(x)||w.set(b,C,k(x));for(b=0;b<g;b++)for(C=0;C<m;C++)d(o,b,M+C,w.get(b,C),1)}if(1==(1&f)&&n<0)if(S=t,T=i,g=s,m=p(v(e,2),v(o,2)),t<0&&(S=0,g=y(e)),i<0&&(T=0),O)for(b=0;b<g;b++)for(C=0;C<m;C++)d(o,T+b,C,k(x=h(e,S+b,C,2)),2);else{for(w=new r.KTa,b=0;b<g;b++)for(C=0;C<m;C++)x=h(e,S+b,C,2),u(x)||w.set(b,C,k(x));for(b=0;b<g;b++)for(C=0;C<m;C++)d(o,T+b,C,w.get(b,C),2)}if(N=t,R=n,E=i,D=a,j=s,_=l,t<0&&(N=0,j=p(y(e),y(o))),n<0&&(R=0,_=p(v(e),v(o))),i<0&&(E=0),a<0&&(D=0),O){for(b=0;b<j;b++)if(!I(E+b,c,o))for(C=0;C<_;C++)d(o,E+b,D+C,k(x=h(e,N+b,R+C,3)),3)}else{w=new r.KTa;try{for(b=0;b<j;b++)for(C=0;C<_;C++)x=h(e,N+b,R+C,3),u(x)||w.set(b,C,k(x));for(b=0;b<j;b++)if(!I(E+b,c,o))for(C=0;C<_;C++)d(o,E+b,D+C,w.get(b,C),3)}catch(e){}}}function B(e,t,n,o,i,a,s,l,c,h,p,d){var g;p&&(g=r.kf(t,n,s,l)),H(e,t,n,o,i,a,s,l,c,h,(function(e,t,n,o){var r,i,a,s,l,c,h,m,v=3===o,b=e._modelManager,C={};return v?(i=(p||d)&&b.getDynamicArrayInfo(t,n))&&i.isValid?(r=f,p&&(C[a=function(e){return[e.row,e.col].join(",")}(i)]||(C[a]=i,s=i.row,l=i.col,g.contains(s,l,1,1)&&b._getSheetModel(3).yIb(i)))):r=e.getValue(t,n,o,1):(r=b.getValue(t,n,o,!0,1),1===o&&u(r)&&((c=e.wq)&&c.Ou&&(h=b.Jp(!1,3,n),m=e.options.colHeaderAutoTextIndex,h&&(m>=0&&t===m||-1===m&&t===y(e,o)-1)&&(r=h.displayName||h.name)))),p&&(v?e.uq(t,n,f,o,!1):e._modelManager.do("setValue",t,n,f,o,!0,!0)),r}),(function(e,t,n,o,r){u(o)?e.uq(t,n,f,r,!1):e.uq(t,n,o,r,!1)}))}function L(e,t,n){var o,r,i,a=e.Tq(t),s=a.row,l=a.col,u=a.rowCount,c=a.colCount;for(o=0;o<u;o++)for(r=n[s+o]=n[s+o]||{},i=0;i<c;i++)r[l+i]=!0}function z(e,t,n,o,i,a,s,l,c,p,d,g){var m,y,v,b,C,w,x={};if(e.tables)for(m=r.kf(t,n,s,l),y=r.kf(i,a,s,l),b=void 0,C=0,w=(v=e.tables.all()).length;C<w;C++)b=v[C].range(),m.containsRange(b)?L(e,b,x):b.containsRange(m)&&b.containsRange(y)?L(e,m,x):b.intersect(m.row,m.col,m.rowCount,m.colCount)&&b.containsRange(y)&&L(e,b.getIntersect(m),x);H(e,t,n,o,i,a,s,l,c,p,(function(e,t,n,o){var r=(3===o||u(o))&&x[t]&&x[t][n],i=e.Dq(t,n,o,h,h,h,h,r,h,h,g);return d&&T(e,t,n,f,o),i}),(function(e,t,n,o,r){T(e,t,n,o,r)}))}function V(e,t,n,o,r,i,a,s,l,u){var c,h,p,d=e.uja.Dja;for(c in d)(h=d[c])&&((p=h.condition())&&p.initExpression());H(e,t,n,o,r,i,a,s,l,0,(function(t,n,r){var i=t.getDataValidator(n,r,3);return i&&(u&&t.setDataValidator(n,r,f),G(e,o)&&(i.Nja=!0)),i}),(function(t,n,r,i){t.setDataValidator(n,r,i),G(e,o)&&i&&delete i.Nja}))}function G(e,t){return e===t&&e.name()===t.name()}function W(e,t,n,o,r,i,a,s,l,u){H(e,t,n,o,r,i,a,s,l,0,(function(e,t,n){var o=e._modelManager.Ky,r=o&&o.get(t,n);return r&&u&&o.remove(t,n),r}),(function(e,t,n,o){var r=e._modelManager.Ky;r&&r.Cz(t,n,o)}))}function U(e,t,n,o,r,i,a,s,l,c,f){H(e,t,n,o,r,i,a,s,l,c,(function(e,t,n,o){var r=e.getTag(t,n,o);return!u(r)&&f&&e.setTag(t,n,h),r}),(function(e,t,n,r,i){o.setTag(t,n,r,i)}))}function Z(e,t,n,o,r,i,a,s,l,u){var c=[],h=[];return H(e,t,n,o,r,i,a,s,l,0,(function(o,r,i){var a=o.getBindingPath&&o.getBindingPath(r,i);return a&&c.push({row:r-d(0,t),col:i-d(0,n),value:o.getValue(r,i)}),u&&e.setBindingPath&&e.setBindingPath(r,i,f),a}),(function(e,t,n,o){h.push({sheet:e,r:t,c:n,value:o})})),{savedValues:c,bindingPathInfos:h}}function q(e){e.forEach((function(e){var t=e.sheet,n=e.r,o=e.c,r=e.value;t.setBindingPath&&t.setBindingPath(n,o,r)}))}function J(e,t,n,o,r,i,a,s,l,c,f){H(e,t,n,o,r,i,a,s,l,c,(function(e,t,n,o){var r=e.getHyperlink&&e.getHyperlink(t,n,o);return!u(r)&&f&&e.setHyperlink&&e.setHyperlink(t,n,h),r}),(function(e,t,n,r,i){o.setHyperlink&&o.setHyperlink(t,n,r,i)}))}function Q(e,t,o,r,i,a,s,l){var u,f,h,p,d,g,m,y,v,b=n("SheetsCalc");if(b){if(u=b.uyb,p=e._modelManager.dUa(),!e.parent||!e.parent.sheets)return void((d=e.getCustomNames())&&c(d,(function(n,c){f=c.getExpression(),(h=u(e,e,t,o,r,i,a,s,l,f))!==f&&c.fg(h,p)})));for(g=e.parent.sheets,(m=e.parent.getCustomNames())&&c(m,(function(n,c){f=c.getExpression(),(h=u(null,e,t,o,r,i,a,s,l,f))!==f&&c.fg(h,p)})),y=function(n){var d=g[n].getCustomNames();d&&c(d,(function(c,d){f=d.getExpression(),(h=u(g[n],e,t,o,r,i,a,s,l,f))!==f&&d.fg(h,p)}))},v=0;v<g.length;v++)y(v)}}function Y(e,t,o,i,a,u,c,h,g,m,b,C,w){var x,A,M,S,T,N,k,E,j,H,L,G,Y,K,$,X,ee,te,ne,oe,re,ie;if(R(e,t,o,i,a,u,c,h),C&&t<0)for(A=o,M=h,o<0&&(A=0,M=p(v(e),v(i))),S=u,u<0&&(S=0),x=!0,T=0;T<M;T++)N=e._modelManager.Jp(!1,3,A+T),k=e._modelManager.Jp(!1,3,S+T),E=N&&N.name,j=k&&k.name,N&&k&&E&&j||(x=!1),(k=l.GC$.extend(!0,{},i._modelManager.Jp(!1,3,S+T)||{})).displayName=N&&N.displayName,k.name=N&&N.name,i._modelManager.do("setItem",!1,3,S+T,k);(64&g)>0&&(z(e,t,o,i,a,u,c,h,m,b,C,w),e.dJb||e.uja&&V(e,t,o,i,a,u,c,h,m,C)),(512&g)>0&&D(e,t,o,i,a,u,c,h,C),(1&g)>0&&(2&g)>0&&((L=e.tables)&&(H=L.dB(r.kf(d(0,t),d(0,o),t<0?p(y(e),y(i)):c,o<0?p(v(e),v(i)):h),C))),(G=s)&&(e.suspendCalcService(),i.suspendCalcService()),Y=[],K=f,$=[],(256&g)>0&&(Y=(K=Z(e,t,o,i,a,u,c,h,m,C)).savedValues,$=K.bindingPathInfos);try{if((1&g)>0&&!x){if(B(e,t,o,i,a,u,c,h,m,b,C,(2&g)>0),q($),s&&0==(2&g)&&i.clearFormula(a,u,c,h,(function(e,t){return!m||!e.Ps||!e.Ps(t)})),(256&g)>0)for(X=Y.length,ee=a<0?0:a,te=u<0?0:u,ne=0;ne<X;ne++)oe=Y[ne],!C&&I(ee+oe.row,m,i)||i.setValue(ee+oe.row,te+oe.col,oe.value)}else q($);re=i.tables,(1&g)>0&&(2&g)>0&&re&&re.eB(H,d(0,t),d(0,o),d(0,a),d(0,u),C),s&&(C?(Q(e,t,o,i,a,u,c,h),(2&g)>0&&function(e,t,o,r,i,a,s,l){var u=n("SheetsCalc");u&&u.CalcOperatorAdjustor.moveFormula(e,t,o,r,i,a,s,l)}(e,t,o,i,a,u,c,h)):(2&g)>0&&((ie=n("SheetsCalc"))&&ie.vyb(e,t,o,i,a,u,c,h,m)),(1&g)>0&&(2&g)>0&&re&&re.R3(H))}finally{G&&(e.resumeCalcService(!1),i.resumeCalcService(!1))}if((4&g)>0&&W(e,t,o,i,a,u,c,h,m,C),(128&g)>0&&U(e,t,o,i,a,u,c,h,m,b,C),(1024&g)>0&&J(e,t,o,i,a,u,c,h,m,b,C),(16&g)>0&&function(e,t,n,o,r,i,a,s,l){var u;t<0&&(t=0,a=p(y(e),y(o))),r<0&&(r=0),n<0&&(n=0,s=p(v(e),v(o))),i<0&&(i=0),!(e===o&&e.name()===o.name())?(u=o.ZA)&&(l?e.ZA.count()>0&&u.$A(e,t,n,r,i,a,s):u._A(e,t,n,r,i,a,s)):(u=e.ZA)&&(l?u.count()>0&&u.aB(t,n,r,i,a,s):u.Zz(t,n,r,i,a,s))}(e,t,o,i,a,u,c,h,C),(8&g)>0&&(t<0&&function(e,t,n,o,r,i){var a,s;t<0&&(t=0,r=p(v(e),v(n))),o<0&&(o=0),a=e.columnOutlines,s=n.columnOutlines,!(e===n&&e.name()===n.name())?a&&s&&s.bB(a,t,o,r,i):a&&a.cB(t,o,r,i)}(e,o,i,u,h,C),o<0&&function(e,t,n,o,r,i){var a,s,l;t<0&&(t=0,r=p(y(e),y(n))),o<0&&(o=0),a=!(e===n&&e.name()===n.name()),s=e.rowOutlines,l=n.rowOutlines,a?s&&l&&l.bB(s,t,o,r,i):s&&s.cB(t,o,r,i)}(e,t,i,a,c,C)),(32&g)>0&&(C||1!==c||1!==h)&&_(e,t,o,i,a,u,c,h,C),t<0&&a<=0&&O(e,o,i,u,h,g,C),o<0&&u<=0&&F(e,t,i,a,c,g,m,C),t<0&&a<=0&&o<0&&u<=0&&P(e,i,g,C),C&&t<0)for(A=o,M=h,o<0&&(A=0,M=p(v(e),v(i))),T=0;T<M;T++)e.getDataColumnName&&e.getDataColumnName(A+T)&&e._modelManager.do("setItem",!1,3,A+T,f)}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/core.ns.js"),r=n("./dist/core/util/common.js"),i=n("@grapecity/js-sheets-common"),a=n("@grapecity/js-calc"),s=!!a,l=n("./dist/core/util/domUtil.js"),u=i.Common.j.Fa,c=l.GC$.each,f=null,h=void 0,p=Math.min,d=Math.max,g=new i.Common.ResourceManager(o.SR),m=g.getResource.bind(g),t.staticMembers={copyTo:function(e,t,n,o,r,i,a,s,l,u,c){Y(e,t,n,o,r,i,a,s,l,u,c,!1)},moveTo:function(e,t,n,o,r,i,a,s,l,u){Y(e,t,n,o,r,i,a,s,l,h,3,!0,u)}}},"./dist/core/worksheet/worksheet-ui.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y;function v(e){return"number"==typeof e}function b(e){return"string"==typeof e}function C(e){return Math.abs(e)}function w(e,t){var n=e,o=t;return function(e){var t,r,i=this,a=i.sheet,s=i.row,l=i.col,u=i.sheetArea;if(0===arguments.length)return n.call(a,s,l,u);if(s>=0&&l>=0)for(t=s;t<s+i.rowCount;t++)for(r=l;r<l+i.colCount;r++)x(a,t,r,u)&&o.call(a,t,r,e,u);return i}}function x(e,t,n,o){var r=e.getRowCount(o),i=e.getColumnCount(o);return n<0&&0<=t&&t<r||t<0&&0<=n&&n<i||0<=t&&t<r&&0<=n&&n<i}function A(e,t,n,o,i,a){var s,l;x(e,t,n,a)&&((s=e.Aj(t,n,a))||(s=new r.Style),"string"==typeof s&&(l=s,(s=new r.Style).parentName=l),"font"===o&&function(e,t,n){var o,r,i,a;g(t.themeFont)||(o=h(),r=o.style,i=t.font,r.font=i,a=i&&r.fontFamily,r.font=n,(n&&r.fontFamily)!==a&&(t.themeFont=p))}(0,s,i),s[o]=i,e.setStyle(t,n,s,a))}function M(e){return(e=e.replace(/[^\:]+\!/g,"")).replace(/\$/g,"")}function S(e){var t,n,o,r,i,a,s,l,u,c,f,h,p=e.split(":"),g=p[0],m=p[1],y=/([A-Z]+)(\d+)?(\D+)?/;if(isNaN(+g)){if((o=g.match(y))[3])return d;t=o[1],n=o[2]}else n=g;if(g&&!m){if(t&&n)return[r=T(n),N(t),1,1]}else if(g&&m){if(i=void 0,a=void 0,isNaN(+m)){if((s=m.match(y))[3])return d;i=s[1],a=s[2]}else a=m;if(!t&&n&&!i&&a)return l=T(n),u=T(a),[r=Math.min(l,u),-1,c=C(l-u)+1,-1];if(t&&!n&&i&&!a)return f=N(t),h=N(i),[-1,Math.min(f,h),-1,C(f-h)+1];if(t&&n&&i&&a)return l=T(n),u=T(a),f=N(t),h=N(i),r=Math.min(l,u),c=C(l-u)+1,[r,Math.min(f,h),c,C(f-h)+1]}return d}function T(e){return function(e){return parseInt(e,10)}(e)-1}function N(e){var t,n,o=0,r=e.length;for(t=0;t<r;t++)n=e[t].charCodeAt(0)-64,o+=Math.pow(26,r-t-1)*n;return o-1}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/worksheet/worksheet.js"),r=n("./dist/core/worksheet/style.js"),i=n("./dist/core/util/domUtil.js"),a=n("./dist/core/util/common.js"),s=n("@grapecity/js-sheets-common"),l=n("./dist/core/core.enum.js"),u=n("@grapecity/js-calc"),c=n("./dist/core/worksheet/clipboardhelper.js"),f=!!u,h=a.util.tt,p=void 0,d=null,g=s.Common.j.Fa,m=o.Worksheet.prototype,y=function(){function e(e,t,n,o,r,i){var a=this;t<0&&(t=o=-1),n<0&&(n=r=-1),a.sheet=e,a.row=t,a.rowCount=g(o)?1:o,a.col=n,a.colCount=g(r)?1:r,a.sheetArea=g(i)?3:i}return e.prototype.tag=function(e){var t,n,o=this,r=o.sheet,i=o.row,a=o.col,s=o.rowCount,l=o.colCount,u=o.sheetArea;if(0===arguments.length)return r.getTag(i,a,u);if(i>=0&&a>=0)for(t=i;t<i+s;t++)for(n=a;n<a+l;n++)r.setTag(t,n,e,u);else if(i>=0)for(t=i;t<i+s;t++)r.setTag(t,-1,e,u);else if(a>=0)for(n=a;n<a+l;n++)r.setTag(-1,n,e,u);return o},e.prototype.width=function(e){var t,n=this,o=n.sheet,r=n.row,i=n.col,a=n.sheetArea;if(0!==arguments.length){if(r<0)for(t=0;t<n.colCount;t++)o.setColumnWidth(t+i,e,a);return n}if(r<0)return o.getColumnWidth(i,a)},e.prototype.height=function(e){var t,n=this,o=n.sheet,r=n.row,i=n.col,a=n.sheetArea;if(0!==arguments.length){if(i<0)for(t=0;t<n.rowCount;t++)o.setRowHeight(t+r,e,a);return n}if(i<0)return o.getRowHeight(r,a)},e.prototype.visible=function(e){var t,n,o=this,r=o.sheet,i=o.row,a=o.col,s=o.sheetArea;if(0!==arguments.length){if(a<0&&i>=0)for(t=0;t<o.rowCount;t++)r.setRowVisible(t+i,e,s);else if(a>=0&&i<0)for(n=0;n<o.colCount;n++)r.setColumnVisible(n+a,e,s);return o}return a<0&&i>=0?r.getRowVisible(i,s):a>=0&&i<0?r.getColumnVisible(a,s):void 0},e.prototype.resizable=function(e){var t,n,o=this,r=o.sheet,i=o.row,a=o.col,s=o.sheetArea;if(0!==arguments.length){if(a<0&&i>=0)for(t=0;t<o.rowCount;t++)r.setRowResizable(t+i,e,s);else if(a>=0&&i<0)for(n=0;n<o.colCount;n++)r.setColumnResizable(n+a,e,s);return o}return a<0&&i>=0?r.getRowResizable(i,s):a>=0&&i<0?r.getColumnResizable(a,s):void 0},e.prototype.tq=function(e){var t=this;return t.sheet.tq(t.row,t.col,e,t.sheetArea)},e.prototype._w=function(e,t){var n,o,r=this,i=r.sheet,a=r.row,s=r.col,l=r.rowCount,u=r.colCount,c=r.sheetArea;if(a>=0&&s>=0)for(n=a;n<a+l;n++)for(o=s;o<s+u;o++)A(i,n,o,e,t,c);else if(a>=0)for(o=-1,n=a;n<a+l;n++)A(i,n,o,e,t,c);else if(s>=0)for(n=-1,o=s;o<s+u;o++)A(i,n,o,e,t,c);return r},e.prototype.clear=function(e){var t=this;t.sheet.clear(t.row,t.col,t.rowCount,t.colCount,t.sheetArea,e)},e.prototype.setBorder=function(e,t){var n,o,r,i,s,l,u,c,f,h,p,d=this,g=d.sheet,m=d.sheetArea;g.suspendPaint();try{if(n=new a.Range(d.row,d.col,d.rowCount,d.colCount),r=(o=g.Tq(n,m)).row,i=o.col,s=o.rowCount,l=o.colCount,u=void 0,c=void 0,f=t.all,h=t.outline,p=t.inside,t.left||f||h)for(u=0;u<s;u++)g.getCell(r+u,i,m).borderLeft(e);if(t.top||f||h)for(c=0;c<l;c++)g.getCell(r,i+c,m).borderTop(e);if(t.right||f||h)for(u=0;u<s;u++)g.getCell(r+u,i+l-1,m).borderRight(e);if(t.bottom||f||h)for(c=0;c<l;c++)g.getCell(r+s-1,i+c,m).borderBottom(e);if(t.diagonalUp)for(u=0;u<s;u++)for(c=0;c<l;c++)g.getCell(r+u,i+c,m).diagonalUp(e);if(t.diagonalDown)for(u=0;u<s;u++)for(c=0;c<l;c++)g.getCell(r+u,i+c,m).diagonalDown(e);if(t.innerHorizontal||f||p)for(u=0;u<s-1;u++)for(c=0;c<l;c++)g.getCell(r+u,i+c,m).borderBottom(e),g.getCell(r+u+1,i+c,m).borderTop(e);if(t.innerVertical||f||p)for(c=0;c<l-1;c++)for(u=0;u<s;u++)g.getCell(r+u,i+c,m).borderRight(e),g.getCell(r+u,i+c+1,m).borderLeft(e)}finally{g.resumePaint()}},e.prototype.toHtml=function(e,t){void 0===e&&(e=l.HeaderOptions.noHeaders),void 0===t&&(t=!0);var n=this;return n.sheetArea===l.SheetArea.corner?"":c.S4.Q4(n.sheet,e,n.row,n.rowCount,n.col,n.colCount,n.sheetArea,t,[],[],!0,!0,t,!0)},e.Pl=w,e}(),t.CellRange=y,y.prototype.value=w(m.getValue,m.setValue),y.prototype.text=w(m.getText,m.setText),y.prototype.formula=w((function(e,t){return f&&this.getFormula(e,t)}),(function(e,t,n,o){f&&this.setFormula(e,t,n,o)})),y.prototype.styleName=w(m.getStyleName,m.setStyleName),i.GC$.each(["backColor","foreColor","hAlign","vAlign","themeFont","font","formatter","borderLeft","borderTop","borderRight","borderBottom","diagonalDown","diagonalUp","locked","textIndent","wordWrap","showEllipsis","shrinkToFit","backgroundImage","backgroundImageLayout","cellType","tabStop","textDecoration","imeMode","watermark","cellPadding","labelOptions","quotePrefix","isVerticalText","cellButtons","dropDowns","textOrientation"],(function(e,t){y.prototype[t]=function(e){return 0===arguments.length?this.tq(t):this._w(t,e)}})),t.Hgc=S,t.Igc=N,i.GC$.extend(m,{getRange:function(){var e,t,o,r,i,a,s,l,u=arguments[0];if(b(u)){if(a=u.toUpperCase(),this.parent&&1===this.parent.options.referenceStyle)return d;if(i=arguments[1],(a=M(a)).split(",").length>1)return d;if(f){if(!(s=n("SheetsCalc").formulaToRange(this,a,p,p,i)))return d;e=s.row,t=s.col,o=s.rowCount,r=s.colCount}else{if(!(l=S(a)))return d;e=l[0],t=l[1],o=l[2],r=l[3]}}else v(u)&&(e=u,t=arguments[1],o=arguments[2],r=arguments[3],i=arguments[4]);return new y(this,e,t,o,r,i)},getCell:function(e,t,n){return g(t)&&(t=-1),new y(this,e,t,1,1,n)}})},"./dist/core/worksheet/worksheet.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe,re,ie,ae,se,le;function ue(e,t){var n,o,r,i,a=[],s=e._modelManager.hUa();if(s)for(n in s)if(R(s,n)&&((o=s[n])&&(t||"n"!==o.rs||(r={row:+n,item:e.getDataItem&&e.getDataItem(+n)},a.push(r)),t&&"e"===o.rs)))for(i in o)if(!P(i)&&o[i]){(r={row:+n,item:e.getDataItem&&e.getDataItem(+n)}).originalItem=o.originalItem,a.push(r);break}return a}function ce(e,t,n){var o,r=0;for(o=t;o<=n;o++)r+=e._m(o);return r}function fe(e,t,n){var o,r=0;for(o=t;o<=n;o++)r+=e.Sl(o);return r}function he(e){return e.getColumnCount()}function pe(e){return e.getRowCount()}function de(e){return e.frozenTrailingColumnCount()}function ge(e){return e.frozenTrailingRowCount()}function me(e){return e.frozenColumnCount()}function ye(e){return e.frozenRowCount()}function ve(e,t){var n=r.util.Pxb(e.font),o=r.util.Pxb(t.font);return n.fontStyle+" "+n.fontWeight+" "+o.fontSize+" "+o.fontFamily}function be(e,t,n){Object.defineProperty(e,t,{get:function(){return this["_"+t]},set:function(e){var o=this["_"+t];o!==e&&(this["_"+t]=e,n&&n(t,e,o))}})}function Ce(e,t,n,o){return{row:t,col:n,newValue:e.getValue(t,n),oldValue:o}}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/core/core.ns.js"),r=n("./dist/core/util/common.js"),i=n("./dist/core/util/imageLoader.js"),a=n("./dist/core/util/tasks.js"),s=n("./dist/core/worksheet/style.js"),l=n("./dist/core/worksheet/worksheet-model.js"),u=n("./dist/core/util/domUtil.js"),c=n("./dist/core/celltype/textcelltype.js"),f=n("@grapecity/js-calc"),h=n("./dist/core/celltype/headercelltype.js"),p=n("./dist/core/core.enum.js"),d=n("@grapecity/js-sheets-common"),g=n("@grapecity/js-calc"),m=!!g,v=n("./dist/core/util/theme.js"),b=n("./dist/core/worksheet/stylehelper.js"),C=r.util.n0a,w=r.util.lHb,x=d.Common.j.Fa,A=r.util.Nl,M=r.util.Pl,S=r.util.Ql,T=r.util.bq,N=u.GC$.each,I=u.GC$.isEmptyObject,R=d.Common.D,k=r.util.x0a,E=r.util.w0a,D=RegExp("^\\d*(\\.\\d+)?\\*$"),j=d.Common.u,_=document,O=parseInt,F=parseFloat,P=isNaN,H=null,B=void 0,L=Math.min,z=Math.max,V=Math.floor,G=Math.ceil,W="undefined",U="string",Z="width",q="height",J="tag",Q="onLayoutChanged",Y="onPaintSuspend",K="isVisible",$="starSize",X="resizable",ee=".gcSheet",te=".gcSheetInternal",ne={backColor:!0,foreColor:!0,font:!0,borderLeft:!0,borderTop:!0,borderRight:!0,borderBottom:!0,textDecoration:!0,cellType:!0,formatter:!0},oe=new d.Common.ResourceManager(o.SR),re=oe.getResource.bind(oe),function(e){e[e.dirty=1]="dirty",e[e.insert=2]="insert",e[e.delete=4]="delete"}(ie=t.ClearPendingChangeType||(t.ClearPendingChangeType={})),function(e){e[e.setFormula=0]="setFormula",e[e.copyPaste=1]="copyPaste",e[e.dragFill=2]="dragFill",e[e.dragDrop=3]="dragDrop",e[e.changePartOfArrayFornula=4]="changePartOfArrayFornula",e[e.changeSheetName=5]="changeSheetName",e[e.table=6]="table",e[e.hideSheet=7]="hideSheet"}(t.InvalidType||(t.InvalidType={})),ae={rowHeaderVisible:!0,colHeaderVisible:!0,clipBoardOptions:0,frozenlineColor:"black",rowHeaderAutoText:1,colHeaderAutoText:2,rowHeaderAutoTextIndex:-1,colHeaderAutoTextIndex:-1,sheetTabColor:H,selectionBackColor:H,selectionBorderColor:H,allowCellOverflow:!0,showFormulas:!1,isProtected:!1,protectionOptions:{},gridline:{},sheetAreaOffset:{left:0,top:0}},se=function(){function e(t){var n=this;n.yn=e.Np,e.Np++,n.options=S(ae,(function(e,t,o){n.Op(e,t,o)})),n.ad(t),n.fgc=new a.Tasks((function(){return this.tasks.pop()}),(function(){var e=n.parent;return e&&e.ku.Gw||n._eventHandler._isWorking||n._eventHandler.xG||n._eventHandler.eG}))}return e.prototype.Op=function(t,n,o){var r,i,a,s,l=this,u=l.parent;switch(t){case"allowCellOverflow":case"showFormulas":case"colHeaderAutoText":case"colHeaderAutoTextIndex":case"colHeaderVisible":case"frozenlineColor":case"rowHeaderAutoText":case"rowHeaderAutoTextIndex":case"rowHeaderVisible":case"selectionBackColor":case"selectionBorderColor":l.$p();break;case"sheetAreaOffset":r=function(e,t){t<0&&(l.options.sheetAreaOffset[e]=0),l.$p()},i=l.options.sheetAreaOffset,["left","top"].forEach((function(e){var t=n[e];be(i,e,r),i[e]=t}));break;case"gridline":a=function(){l.$p()},s=l.options.gridline,["color","showHorizontalGridline","showVerticalGridline"].forEach((function(e){var t=n[e];be(s,e,a),s[e]=t}));break;case"isProtected":n&&u&&u.undoManager().PY((function(e){return e.sheetId!==l.yn})),l._p(),e.ao(l,"onProtectChanged"),l.$p();break;case"protectionOptions":l._p(),e.ao(l,"onProtectChanged");break;case"sheetTabColor":u&&u.aq()}},e.prototype.name=function(e){var t=this,n=t.parent;if(0===arguments.length)return t._modelManager?t._modelManager.getName():"";if(!T(e,n?n.sheets:null,t))throw re().Exp_NotSupported;return t.cq(e),n&&n.aq(),t},e.prototype.isSelected=function(e){return this.DHb(e)},e.prototype.DHb=function(e,t){var n,o,i=this,a=i.parent,s=!!i._modelManager&&i._modelManager.TIb();return x(e)?s:(e!==s&&(n=i.name(),o=void 0,t&&(o={oldValue:s,newValue:e,sheetName:n,propertyName:"isSelected",cancel:!1,sheetIndex:i.parent.getSheetIndex(n)},i.parent.Wq(r.Events.SheetChanging,o)),(!t||o&&!1===o.cancel)&&(i._modelManager.CHb(e),a&&a.hq&&a.hq.repaint(),t&&i.parent.Wq(r.Events.SheetChanged,{oldValue:s,newValue:e,sheetName:n,propertyName:"isSelected",sheetIndex:i.parent.getSheetIndex(n)}))),i)},e.prototype.cq=function(t,n){var o=this,r=o.name();n||e.ao(o,"beforeSetName",{oldName:r,newName:t}),this._modelManager.do("setName",t),n||e.ao(o,"setName",{oldName:r,newName:t})},e.prototype.addRows=function(t,n,o){var r,i,a,s;if(!(n<=0)){i=pe(r=this),(t<0||t>i)&&(t=i),0===r._modelManager.WTa&&r.parent&&r.parent.pv.clear(),r.suspendPaint();try{if(r.eJb(!1),a={changeType:"addingRows",row:t,rowCount:n,canAdd:!0},e.ao(r,Q,a),!a.canAdd)return;x(a.newRow)||(t=a.newRow),s="addRows",r.pCb(t,3,s,n,i),this._modelManager.do("addRows",t,n),r.jq=!0,e.ao(r,Q,{changeType:s,row:t,oldValue:i,rowCount:n,rowExpand:o}),e.ao(r,Q,{changeType:"addRows2",row:t,oldValue:i,rowCount:n}),r.tables&&r.tables.Cec(!0,t),r.kq(t,3,s,n,i)}finally{r.eJb(!0),r.resumePaint()}}},e.prototype.eJb=function(e){var t=this,n=t.Jl,o=t.Kl;t._modelManager.setCellState(n,o,p.CellStatesType.active,e,p.SheetArea.viewport)},e.prototype.deleteRows=function(t,n){var o,r,i,a,s,l,u,c=this,f=pe(c);if(!(0>t||t>=f||n<=0)){0===c._modelManager.WTa&&c.parent&&c.parent.pv.clear(),c.suspendPaint();try{if(c.eJb(!1),o={changeType:"deletingRows",row:t,rowCount:n,canDelete:!0},e.ao(c,Q,o),!o.canDelete)return;if(r="deleteRows",c.pCb(t,3,r,n,f),c.RIb(t,n,0,this.getColumnCount()),c._modelManager.do("deleteRows",t,n),(i=c.lq)>=0){for(a=-1,s=ye(c),l=i;l>=s;l--)if(c.getRowVisible(l)&&c.Sl(l)>0){a=l;break}-1===a&&(a=0),i!==a&&c.mq(a)}u=f,c.getActiveRowIndex()>=u&&c.setActiveCell(u-1,c.getActiveColumnIndex()),c.jq=!0,e.ao(c,Q,{changeType:r,row:t,oldValue:f,rowCount:n}),c.tables&&c.tables.Cec(!0,t),c.kq(t,3,r,n,f)}finally{c.eJb(!0),c.resumePaint()}}},e.prototype.addColumns=function(t,n){var o,r,i,a;n<=0||(r=he(o=this),(t<0||t>r)&&(t=r),0===o._modelManager.WTa&&o.parent&&o.parent.pv.clear(),i={changeType:"addingColumns",col:t,colCount:n,canAdd:!0},e.ao(o,Q,i),i.canAdd&&(o.eJb(!1),a="addColumns",o.qCb(t,3,a,n,r),o._modelManager.do("addColumns",t,n),o.oq=!0,e.ao(o,Q,{changeType:a,col:t,oldValue:r,colCount:n}),e.ao(o,Q,{changeType:"addColumns2",col:t,oldValue:r,colCount:n}),o.tables&&o.tables.Cec(!1,t),o.pq(t,3,a,n,r),o.eJb(!0),o.$p()))},e.prototype.deleteColumns=function(t,n){var o,r,i,a,s,l,u,c=this,f=he(c);if(!(0>t||t>=f||n<=0)&&(0===c._modelManager.WTa&&c.parent&&c.parent.pv.clear(),o={changeType:"deletingColumns",col:t,colCount:n,canDelete:!0},e.ao(c,Q,o),o.canDelete)){if(c.eJb(!1),r="deleteColumns",c.RIb(0,this.getRowCount(),t,n),c.qCb(t,3,r,n,f),c._modelManager.do("deleteColumns",t,n),(i=c.qq)>=0){for(a=-1,s=me(c),l=i;l>=s;l--)if(c.getColumnVisible(l)&&c.Tl(l)>0){a=l;break}-1===a&&(a=0),i!==a&&c.rq(a)}u=f,c.getActiveColumnIndex()>=u&&c.setActiveCell(c.getActiveRowIndex(),u-1),c.oq=!0,e.ao(c,Q,{changeType:r,col:t,oldValue:f,colCount:n}),e.ao(c,Q,{changeType:"deleteColumns2",col:t,oldValue:f,colCount:n}),c.tables&&c.tables.Cec(!1,t),c.pq(t,3,r,n,f),c.eJb(!0),c.$p()}},e.prototype.getRowCount=function(e){return 0===e?0:this._modelManager.getRowCount(e)},e.prototype.getColumnCount=function(e){return 0===e?0:this._modelManager.getColumnCount(e)},e.prototype.setRowCount=function(t,n){var o;x(n)&&(n=3),o={changeType:"settingRowCount",rowCount:t,sheetArea:n,canSet:!0},e.ao(this,Q,o),o.canSet&&this.setRowCountCore(t,n)},e.prototype.setRowCountCore=function(t,n){var o,r;t=O(t,10),P(t)||(x(n)&&(n=3),r=(o=this).getRowCount(n),t<0||t===r||(3===n||2===n?(o._modelManager.do("setRowCount",t,n),ye(o)>t&&o.frozenRowCount(t)):1===n&&o._modelManager.do("setRowCount",t,n),e.ao(o,Q,{changeType:"setRowCount",rowCount:t,sheetArea:n}),o.jq=!0,o.Jl>=t&&(3===n||2===n)&&o.setActiveCell(t-1,o.getActiveColumnIndex()),o.$p(),o.clearPendingChanges()))},e.prototype.setColumnCount=function(t,n){var o,r;t=O(t,10),P(t)||(r=(o=this).getColumnCount(n),t<0||t===r||(x(n)&&(n=3),3===n||1===n?(o._modelManager.do("setColumnCount",t,n),me(o)>t&&o.frozenColumnCount(t)):2===n&&o._modelManager.do("setColumnCount",t,n),e.ao(o,Q,{changeType:"setColumnCount",colCount:t,sheetArea:n}),o.oq=!0,o.Kl>=t&&(3===n||1===n)&&o.setActiveCell(o.getActiveRowIndex(),t-1),o.$p(),o.clearPendingChanges()))},e.prototype.aHb=function(e,t,o){var r,i,a=this;return y||(y=n("SheetsCalc")),y&&((r="string"==typeof o&&a.parent&&a.parent.aJb(o))&&-1!==e&&-1!==t)?(i=r.getExpression(),y.evaluateExpression(a,i,e,t)):B},e.prototype.xHb=function(e,t,n){var o,r=this;if(r.options.showFormulas&&3===n){if(o=r.getFormula(e,t))return"="!==o[0]&&(o="="+o),o;if(r._modelManager&&r._modelManager.ZHb&&r._modelManager.ZHb.getAnchorInfo(e,t))return""}},e.prototype.getText=function(e,t,n){var o,r,i,a,s,l,u;return x(n)&&(n=3),r=(o=this).xHb(e,t,n),x(r)?(i=o.getCellType(e,t,n),a=o.getValue(e,t,n),(s=o.tq(e,t,"formatter",n))||(s=o.tq(e,t,"_autoFormatter",n)),l={},u=o.tq(e,t,"quotePrefix",n),(a=i.format(a,s,l,{sheet:o,row:e,col:t,sheetArea:n,quotePrefix:u}))&&"string"==typeof a&&(a=a.replace(/\r\n?/g,"\n")),a):r},e.prototype.setText=function(t,n,o,r){var i,a,s,l,u,c,f=this;x(r)&&(r=3),i=o,a={value:o},e.ao(f,"settingText",a),s=o=a.value,l=f.getCellType(t,n,r),u=f.getFormatter&&f.getFormatter(t,n,r),l&&u&&!w(u)&&(c={sheet:f,row:t,col:n,sheetArea:r},s=l.parse(i,u,c),s=x(s)?o:s),f.uq(t,n,s,r),f.$p()},e.prototype.getValue=function(e,t,n,o){var i,a,s,l,u,c,f,h,p,d,g,m;return 0===n?H:(x(n)&&(n=3),a=(i=this).options,l=(s=i._modelManager).getRowCount(n),u=s.getColumnCount(n),c=i.vq(s,e,t,n,o),1===n?x(c)&&((h=i.wq)&&h.Ou&&(p=i._modelManager.Jp(!1,3,t),d=a.colHeaderAutoTextIndex,p&&(d>=0&&e===d||-1===d&&e===l-1)&&(c=p.displayName||p.name)),x(c)&&(((f=a.colHeaderAutoTextIndex)<0||f>=l)&&(f=l-1),e===f&&(2===(g=a.colHeaderAutoText)?c=r.util.xq(t+1):1===g&&(c=t+1)))):2===n&&x(c)&&(((f=a.rowHeaderAutoTextIndex)<0||f>=u)&&(f=u-1),t===f&&(2===(m=a.rowHeaderAutoText)?c=r.util.xq(e+1):1===m&&(c=e+1))),c)},e.prototype.setValue=function(e,t,n,o,r){var i,a;this.uq(e,t,n,o,r),(i=this.parent)?(a=i.getActiveSheet())&&a.$p():this.$p()},e.prototype.eyb=function(e,t,n,o){var r=this;!o&&m&&r.zq(e,t,n),r.t4&&r.t4(e,t,1,1,n)},e.prototype.fyb=function(){var e=this.conditionalFormats;e&&e.Nm()},e.prototype.uq=function(e,t,n,o,r){var i,a,s,l;0!==o&&(x(o)&&(o=3),s=(a=(i=this)._modelManager).getRowCount(o),l=a.getColumnCount(o),e<0||e>=s||t<0||t>=l||(n=k(n),n=C(n),a.do("setValue",e,t,n,o),i.eyb(e,t,o,r),i.fyb()))},e.prototype.AHb=function(e,t,n,o,r,i){var a;return function(e,t,n,o,r){if((-1!==t||-1!==n)&&(x(r)&&(r=3),3===r)){var i=e.tables&&e.tables.find(t,n);i&&i.NZ&&t===i.footerIndex()&&se.ao(e,"composeTableFooterList",{table:i,row:t,col:n,style:o})}}(this,e,t,a=this.getActualStyle(e,t,n,o,r,i),n),a},e.prototype.getActualStyle=function(e,t,n,o,r,i){var a,l,u,c,f,h,p,d,g,m,y,v,b,C,w,A,M,S,T,N,I,R,k,E,D,j,_;if(x(n)&&(n=3),0===n)return new s.Style;if(-1===e&&-1===t)return this.getDefaultStyle(n);if(p=(a=this).Cq,A="__spreadJSDefault",M="__undefined",c=(S=this._modelManager).getStyle(e,t,n),f=S.getStyle(e,-1,n),h=S.getStyle(-1,t,n),c=c||H,f=f||H,h=h||H,b=M,T=a.parent&&a.parent.GBb,c&&(b=c.charAt?c:A+c.yn),C=M,f&&(C=f.charAt?f:A+f.yn),w=M,h&&(w=h.charAt?h:A+h.yn),d=(v=p[n])[b],N=a.tables,I=3===n&&N&&!i?N.find(e,t):H,R=3===n&&a.pivotTables&&a.pivotTables.Wic(e,t),I||R||(d||(d=v[b]={}),(m=d[C])?y=m[w]:m=d[C]={}),y||(u=a.Dq(e,t,n,c,f,h,I,B,i,R)),3!==n||o||(y||(k=u.formatter)&&k.hasFormatedColor&&k.hasFormatedColor()&&!i&&(E={value:H},k.format(a.getValue(e,t),E),E.value&&((l=new s.Style).foreColor=E.value)),(D=a.conditionalFormats)&&(l=D.Eq(l,e,t,n))),l)g=y||u,l.Yo(g),l&&l.font&&g&&g.font&&l.font!==g.font&&(l.font=ve(l,g)),u=l;else if(y)return!a.cellStates||o||T||(j=a.cellStates.getStyle(e,t,n,H,y.locked))&&(j.Yo(y),(y=j).Zo(a.Pm)),r?y:y.clone(!0);return x(u.locked)&&(u.locked=!0),u=u.Zo(a.Pm),l||I||R||(m[w]=u.clone(!0)),!a.cellStates||o||T||(_=a.cellStates.getStyle(e,t,n,H,u.locked))&&(_.Yo(u),u=(u=_).Zo(a.Pm)),u},e.prototype.tq=function(e,t,n,o){var r,i,a,l,u,c,f,h,p,d,g,m,y,v,b;if(0===o)return B;for(x(o)&&(o=3),u=(r=this)._modelManager,f=!1,3===o&&("foreColor"===n&&((p=r.tq(e,t,"formatter",o))&&p.hasFormatedColor&&p.hasFormatedColor()&&(d={value:H},p.format(r.getValue(e,t),d),d.value&&(c=d.value,f=!0))),(g=r.conditionalFormats)&&g.count()>0&&(f=(m=g.Fq(e,t,n,o)).v5,c=m.Fi)),y=0;!f&&y<=4;)if(0===y?i=u.getStyle(e,t,o):1===y?(v=r.tables,(b=3===o&&v?v.find(e,t):H)&&ne[n]&&(i=b.Gq(e,t,n))):i=2===y?u.getStyle(e,-1,o):3===y?u.getStyle(-1,t,o):r.getDefaultStyle(o),y++,i&&i.charAt&&typeof i===U&&(i=r.Hq(i)),i){if("font"===n&&i.themeFont&&!h&&(h=i.themeFont),i[n]!==B){c=i[n],f=!0;break}for(a=i.parentName;a&&(l=r.Hq(a));){if(l[n]!==B){c=l[n],f=!0;break}a=l.parentName}}return"locked"===n?!!x(c)||c:f||h?("foreColor"!==n&&"backColor"!==n&&"font"!==n&&"borderLeft"!==n&&"borderTop"!==n&&"borderRight"!==n&&"borderBottom"!==n||((i=new s.Style)[n]=c,"font"===n&&h&&(i.themeFont=h),i.Zo(r.Pm),c=i[n]),c):B},e.prototype.getStyle=function(e,t,n){return this.Iq(e,t,n,!0)},e.prototype.Iq=function(e,t,n,o){var r,i,a;if(x(n)&&(n=3),0!==n){if((r=this._modelManager.getStyle(e,t,n))instanceof s.Style)return o&&this.Jq(),r;if(typeof r===U&&((i=this.Hq(r))!==H&&i!==B))return(a=new s.Style).Yo(i,!1),o&&this.Jq(),a}return H},e.prototype.addNamedStyle=function(e){this.Kq(e),this.$p()},e.prototype.Kq=function(e){if(e){if(!e.name)throw Error(re().Exp_EmptyNamedStyle);var t=e.name.toUpperCase();this.Lq[t]=e}},e.prototype.getNamedStyle=function(e){return this.Mq(e,!0)},e.prototype.Mq=function(e,t){var n,o=this.Lq;return o&&e?((n=o[e=e.toUpperCase()])&&t&&this.Jq(),n):H},e.prototype.Jq=function(){this.Cq=[{},{},{},{}]},e.prototype.removeNamedStyle=function(e){var t,n=this.Lq;n&&e&&(e=e.toUpperCase(),R(n,e)&&((t=n[e].formatter)&&"string"==typeof t&&this.parent.QHb[t]&&this.parent.RHb(t),delete n[e],this.Jq(),this.$p()))},e.prototype.getNamedStyles=function(){var e=[],t=this.Lq;return t&&N(t,(function(t,n){e.push(n)})),this.Jq(),e},e.prototype.setStyle=function(e,t,n,o){var r,i;x(o)&&(o=3),n&&n.backColor&&"object"==typeof n.backColor&&b.To.processStops(n.backColor),(r=this).Nq(e,t,n,o),-1===e&&-1===t&&(r.Oq[o]=H),-1!==e&&-1!==t||(i=n&&n.validator)&&i.condition()&&4===i.condition().conType()&&i.condition().getExpected(this,e<0?0:e,t<0?0:t),r.Jq(),r.$p()},e.prototype.Pq=function(e,t,n,o){var r,i,a=this;a.options.isProtected?(r=a.getStyle(e,t,o),i=void 0,n?(i=r?r.locked:B,n.locked!==i&&(n.locked=i),a.setStyle(e,t,n,o)):r&&((i=r.locked)!==B&&((n=new s.Style).locked=i),a.setStyle(e,t,n,o))):a.setStyle(e,t,n,o)},e.prototype.getStyleName=function(e,t,n){var o=this.Aj(e,t,n);return o instanceof s.Style?o.name:o},e.prototype.setStyleName=function(e,t,n,o){typeof n===U&&(this.Nq(e,t,n,o),this.$p())},e.prototype.Aj=function(e,t,n){var o;return x(n)&&(n=3),0!==n&&(o=this._modelManager.getStyle(e,t,n)),o||H},e.prototype.Nq=function(e,t,n,o){var i,a,s,l,u,c,f,h,p,d,g;if(x(o)&&(o=3),0!==o){if(a=(i=this).Aj(e,t,o),l=(s=i._modelManager).getRowCount(o),u=s.getColumnCount(o),e<-1||e>=l||t<-1||t>=u)return;c=n,f=s.getStyle(e,t,o),typeof c===U&&(c=i.Hq(c)),(h=c&&c.formatter)&&w(h)&&i.fJb(e,t,h),s.do("setStyle",e,t,n,o),p=a&&a.cellType&&a.cellType.typeName||H,d=n&&n.cellType&&n.cellType.typeName||H,e===i.Jl&&t===i.Kl&&p!==d&&r.Vl.Wl(i)&&i._eventHandler.Qq(),g="[styleinfo]",-1!==e&&-1!==t?i.Bq(g,e,t,o,f,n):-1!==e&&-1===t?i.kq(e,o,g,n,f):-1===e&&-1!==t&&i.pq(t,o,g,n,f)}},e.prototype.fJb=function(e,t,o){var r,i,a,s,l,u,c,h=this;if(y||(y=n("SheetsCalc")),y){if(-1===e&&(e=0),-1===t&&(t=0),r=h.getCell(e,t,3),i=y.rangeToFormula(r,e,t,3),"="===(a=o.trim()).charAt(0)&&a.indexOf("@")>=0&&(a=a.replace(/@/g,i)),a.indexOf("{{")>=0&&a.indexOf("}}")>=0){for(""===(s=a.split(/{{|}}/))[0]&&s.shift(),""===s[s.length-1]&&s.pop(),l=0;l<s.length;l++)-1===s[l].indexOf("=")?s[l]='"'+s[l]+'"':(s[l].indexOf("@")>=0&&(s[l]=s[l].replace(/@/g,i)),(u=y.evaluateFormula(h,s[l]))instanceof f.CalcError?s[l]='"'+u+'"':s[l]=s[l].replace(/=/g,""));a="=CONCAT("+s.join(",")+")"}(c=h.parent).aJb(o)||c.Yu(c.QHb,o,a,e,t,!0,"")}},e.prototype.getDefaultStyle=function(e){var t,n,o,r,i,a,l;return x(e)&&(e=3),(o=(n=(t=this).Oq)[e])?o:0!==e?(typeof(i=(r=t._modelManager).getStyle(-1,-1,e))===U&&(i=t.Hq(i)),i||(i=new s.Style,r.do("setStyle",-1,-1,i,e)),a=1===e||2===e,typeof(i=i).hAlign===W&&(i.hAlign=a?1:3),typeof i.vAlign===W&&(i.vAlign=a?1:0),typeof i.imeMode===W&&(i.imeMode=1),i.font||typeof i.themeFont!==W||(i.themeFont="Body"),n[e]=i,i):((l=new s.Style).locked=!0,n[e]=l,l)},e.prototype.setDefaultStyle=function(e,t){x(t)&&(t=3);var n=this;0!==t&&n._modelManager.do("setStyle",-1,-1,e,t),n.Oq[t]=H,n.Jq(),n.$p()},e.prototype.Hq=function(e){var t,n=this.Mq(e,!1);return n||((t=this.parent)?t.Mq(e,!1):H)},e.prototype.Dq=function(e,t,n,o,r,i,a,l,u,c,f){var h,p,d,g,m,y,v,b,C,w,A;if(x(n)&&(n=3),h=this,p=new s.Style,m=!1,0!==n){if(y=h._modelManager,v=h.tables,b=y.getRowCount(n),C=y.getColumnCount(n),w=void 0,0<=e&&e<b&&0<=t&&t<C&&((w=o!==B?o:y.getStyle(e,t,n))&&w.charAt&&(w=h.Hq(w)),w))for(p.Yo(w,!0,10),m=!0,g=w.parentName;g&&(d=h.Hq(g));)p.Yo(d,!1,10,!0),g=d.parentName;if(l)return p;if(a!==B||u||(a=3===n&&v?v.find(e,t):H),c===B&&3===n&&h.pivotTables&&(c=h.pivotTables.Wic(e,t)||H),a&&!u&&(a.Yo(e,t,p),m=!0),c&&(c.Yo(e,t,p),m=!0),0<=e&&e<b&&((w=r!==B?r:y.getStyle(e,-1,n))&&w.charAt&&(w=h.Hq(w)),w))for(p.Yo(w,!m,30),m=!0,g=w.parentName;g&&(d=h.Hq(g));)p.Yo(d,!1,30,!0),g=d.parentName;if(0<=t&&t<C&&((w=i!==B?i:y.getStyle(-1,t,n))&&w.charAt&&(w=h.Hq(w)),w))for(p.Yo(w,!m,40),m=!0,g=w.parentName;g&&(d=h.Hq(g));)p.Yo(d,!1,40,!0),g=d.parentName}if((A=h.getDefaultStyle(n))&&A.charAt&&(A=h.Hq(A)),A&&!f)for(p.Yo(A,!m,50),g=A.parentName;g&&(d=h.Hq(g));)p.Yo(d,!1,50,!0),g=d.parentName;return p},e.prototype.getCellType=function(e,t,n){return this.tq(e,t,"cellType",n)||this.Al(n)},e.prototype.Al=function(e){x(e)&&(e=3);var t=this.Rq;return t||(t=this.Rq=new c.Text),3===e?t:1===e?new h.ColumnHeader:2===e?new h.RowHeader:0===e?new h.Corner:t},e.prototype.setCellType=function(e,t,n,o){var r=this.Iq(e,t,o);r||(r=new s.Style),r.cellType=n,this.setStyle(e,t,r,o)},e.prototype.Sq=function(e,t,n,o,i){var a,s,l,u,c,f,h=this;if(x(i)&&(i=3),(a=h._modelManager).do("clearSpan",e,t,n,o,i),s=r.kf(e,t,n,o),l=h.Tq(s,i),u=h.Fia(l,i),a.do("addSpan",u,i),3===i){for(c=h.getSelections(),f=0;f<c.length;f++)c[f].intersect(e,t,n,o)&&(c[f]=c[f].union(s));a.do("setSelections",c)}h.$p()},e.prototype.Fia=function(e,t){var n=this.getRowCount(t),o=this.getColumnCount(t),i=e.row,a=e.col,s=e.rowCount,l=e.colCount;return i+s>n&&(s=n-i),a+l>o&&(l=o-a),r.kf(i,a,s,l)},e.prototype.addSpan=function(t,n,o,r,i){var a,s,l,u,c=this;if((1!==o||1!==r)&&0!==i&&(a=c.getRowCount(i),s=c.getColumnCount(i),!(t>=a||n>=s||t<-1||n<-1)&&(l=!0,m&&(3===i||x(i))&&(l=c.Vq(t,n,o,r,!1)),l))){if(c._modelManager.qu(t,n,o,r,i))throw Error(re().Exp_InvalidRange);c.wyb&&c.wyb(t,n,o,r),c.Sq(t,n,o,r,i),u={sheet:c,row:t,col:n,rowCount:o,colCount:r,sheetArea:i,changeType:"addSpan"},e.ao(c,Q,u),c.Wq("spanChanged",u)}},e.prototype.removeSpan=function(t,n,o){var r,i,a,s=this;x(o)&&(o=3),(i=(r=s._modelManager).findSpan(t,n,o))&&i.row===t&&i.col===n&&r.do("removeSpan",i,o),a={sheet:s,row:t,col:n,sheetArea:o,changeType:"removeSpan"},e.ao(s,Q,a),s.Wq("spanChanged",a),s.$p()},e.prototype.getSpans=function(e,t){return 0===t?[]:this._modelManager.getSpans(e,t,!0)},e.prototype.getSpan=function(e,t,n){return 0===n?H:this._modelManager.findSpan(e,t,n)},e.prototype.repaint=function(e){this.Xq<=0&&this._render&&this._render.repaint(e)},e.prototype.Yq=function(e,t){var n,o,r,i,a,s,l,u,c,f,h,d,g,m,y,v=this,b=v.parent,C=b&&b.options.scrollbarAppearance===p.ScrollbarAppearance.mobile,w=!1,x=!1,A=b&&b.options.scrollByPixel,M=ye(v),S=me(v),T=S?v.Zq(S-1):v.$q(),N=M?v._q(M-1):v.ar();if(t<v.qq&&t>=T?(w=!0,v.rq(v.br(t+1),0)):A&&t===v.qq&&0!==v.eCb&&(w=!0,v.rq(t,0)),t>v.cr()&&t<=v.dr()){for(n=0,o=t,r=v.am(),(i=v._modelManager.findSpan(e,o))&&(o=i.col+i.colCount-1);o>v.qq&&!((n+=v.Tl(o))>r.er);)o--;a=void 0,s=void 0,A?(o===v.qq&&n<r.er&&(n+=v.Tl(o)),a=o,s=r.er-n):(a=v.Zq(o),s=0),w=!0,v.rq(a,s)}if(e<v.lq&&e>=N?(x=!0,v.mq(v.gr(e+1),0)):A&&e===v.lq&&0!==v.cCb&&(x=!0,v.mq(e,0)),e>v.hr()&&e<=v.ir()){for(l=0,u=e,(c=v._modelManager.findSpan(u,t))&&(u=c.row+c.rowCount-1),f=v.am();u>v.lq&&!((l+=v.Sl(u))>f.jr);)u--;h=void 0,d=void 0,A?(u===v.lq&&l<f.jr&&(l+=v.Sl(u)),h=u,d=f.jr-l):(h=v._q(u),d=0),x=!0,v.mq(h,d)}A||t!==v.dr()||v.rq(v.lr(),0),C&&(g=b.St,m=b.Pt,y=b.ku,x&&(g.Jwa(p.ScrollbarState.show),y.Rdc(!0)),w&&(m.Jwa(p.ScrollbarState.show),y.Rdc(!1)))},e.prototype.hitTest=function(e,t,n,o){var r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I=this;if(I.am(),r={x:e,y:t},i=I.rowOutlines,a=I.columnOutlines,i&&(s=i.hitTest(I,e,t)),!s&&a&&(s=a.hitTest(I,e,t)),s)r.outlineHitInfo=s;else{if(l=I.nr(t),u=I.or(e),r.rowViewportIndex=l,r.colViewportIndex=u,r.row=I.pr(t,l),r.col=I.qr(e,u),l>=0&&l<=2&&u>=0&&((c=I.rr(l,u,B,r.row,r.col))&&!0!==n&&(r.row=c.row,r.col=c.col)),r.hitTestType=I.sr(l,u),f=I._eventHandler,p=(h=I.xr)&&h.hitTest(r,e,t),g=void 0,(d=I.tables)&&(g=-1===r.rowViewportIndex?d&&d.find(I.getActiveRowIndex(),I.getActiveColumnIndex()):d.find(r.row,r.col)),p||(p=(m=g&&g.xr)&&m.hitTest(r,e,t)),y=d&&!p&&d.gJb(e,t,r))return r.tableSelectInfo=y,y.table&&y.table.xr&&(r.filterButtonHitInfo=p),r;(v=f.Yia&&f.Yia(r,e,t))?r.dragMergeInfo=v:(b=f.tr&&f.tr(r,e,t))?r.dragInfo=b:(C=f.ur(r,e,t,5))?r.resizeInfo=C:(w=f.vr?f.vr(r,e,t):H)?r.formulaRangeHitInfo=w:(A=(x=I._modelManager.Ky)&&x.hitTest(e,t))?r.commentHitInfo=A:(S=(M=I.wr)&&M.hitTest(e,t,o),T=void 0,I.shapes&&(T=I.shapes.hitTest(e,t)),T?r.shapeHitInfo=T:S?r.floatingObjectHitInfo=S:p?r.filterButtonHitInfo=p:(N=g&&!g.hJb()&&f.iJb&&f.iJb(r,g))?r.resizeTableHitInfo=N:r.cellTypeHitInfo=I.yr(r,e,t))}return r},e.prototype.getCellRect=function(e,t,n,o,i){var a,s,l,u,c,f,h=3;return-1===n?h=1:-1===o&&(h=2),s=(a=this).am(),-1===n&&-1===o?new r.Rect(s.zr,s.Ar,s.Br,s.Cr):(l=a.Dr(),x(n)&&(n=a.Er(e)),x(o)&&(o=a.Fr(t)),u=a.Gr(n,h).findRow(e),c=a.Hr(o,h).findCol(t),(f=a.Ir(n,o,h,i).findCell(e,t))?new r.Rect(f.x-l.x,f.y-l.y,f.width,f.height):u&&c?new r.Rect(c.x-l.x,u.y-l.y,c.width,u.height):new r.Rect)},e.prototype.Jr=function(e,t,n){var o,i,a,s,l=this,u=l._eventHandler,c=!1,f=l.Jl,h=l.Kl;x(e)||(l.Jl=e,c=!0),x(t)||(l.Kl=t,c=!0),l._modelManager.setCellState(f,h,p.CellStatesType.active,!1,p.SheetArea.viewport),l.xIb&&l.xIb(p.CellStatesType.active,f,h,p.SheetArea.viewport),l._modelManager.setCellState(e,t,p.CellStatesType.active,!0,p.SheetArea.viewport),l.xIb&&l.xIb(p.CellStatesType.active,e,t,p.SheetArea.viewport),!n&&u&&c&&(u.Qq(),(i=(o=l._modelManager).getDynamicArrayInfo(e,t))!==(a=o.WIb)&&(o.WIb=i,l.Xq<=0&&(s=void 0,i&&a?s=r.getUnionRange(i,a):(i=i||a,s=r.kf(i.row,i.col,i.rowCount,i.colCount)),l._render.im(s))))},e.prototype.gCb=function(e,t,n,o,r){var i=e.getCellRect(t,n,o,r),a=i.x,s=i.y,l=i.width,u=i.height;return i.x=a-2,i.y=s-2,i.width=l+4,i.height=u+4,i},e.prototype.Kr=function(e,t,n,o,i){var a,s=this,l=s.Jl,u=s.Kl,c=s._modelManager,f=c.getSpan(e,t);s.Lr=f.rowCount,s.Mr=f.colCount,s.Xq<=0&&(a=c.getSpan(l,u),s._render.im(r.kf(l,u,a.rowCount,a.colCount))),s.Nr=n,s.Pr=o,s.Jr(e,t,i),s.Qr=e,s.Rr=t},e.prototype.setActiveCell=function(e,t,n,o){this.Sr(e,t,n,o,2)},e.prototype.Sr=function(e,t,n,o,i){var a,s,l=this,u=pe(l),c=he(l);e<0?e=0:e>=u&&(e=u-1),t<0?t=0:t>=c&&(t=c-1),l.Tr(),a=2===i?r.Vl.Wl(l):1===i,l.Kr(e,t,n,o,!a),s=l._modelManager.getSpan(e,t),l.Ur(s.row,s.col,s.rowCount,s.colCount),l.$p()},e.prototype.getActiveRowIndex=function(){return this.Jl},e.prototype.getActiveColumnIndex=function(){return this.Kl},e.prototype.getRowResizable=function(e,t){return this._modelManager.getResizable(!0,t,e)},e.prototype.setRowResizable=function(e,t,n){this.Vr(e,t,X,!0,n)},e.prototype.Vr=function(e,t,n,o,r){x(r)&&(r=3),n!==q&&n!==Z||!D.test(t)||(n=$);var i,a=this,s=a._modelManager;switch(n){case X:i=s.getResizable(o,r,e);break;case"pageBreak":i=s.getPageBreak(o,r,e);break;case K:i=s.getVisible(o,r,e);break;case q:i=s.getSize(o,r,e);break;case Z:i=s.getSize(o,r,e)}switch(o?a.pCb(e,r,n,t,i):a.qCb(e,r,n,t,i),n){case X:s.do("setResizable",o,r,e,t);break;case"pageBreak":s.do("setPageBreak",o,r,e,t);break;case K:s.do("setVisible",o,r,e,t),o&&m&&3===r&&i!==t&&a.recalcRows([e]);break;case q:s.do("setSize",o,r,e,t),!m||3!==r||i===t||0!==i&&0!==t||a.recalcRows([e]);break;case Z:s.do("setSize",o,r,e,t),!m||3!==r||i===t||0!==i&&0!==t||a.recalcCols([e]);break;case $:s.do("setStarSize",o,r,e,t)}o?a.kq(e,r,n,t,i):a.pq(e,r,n,t,i)},e.prototype.getColumnResizable=function(e,t){return this._modelManager.getResizable(!1,t,e)},e.prototype.setColumnResizable=function(e,t,n){this.Vr(e,t,X,!1,n)},e.prototype.getRowHeight=function(e,t,n){var o,r,i,a,s,l,u=this;if(x(t)&&(t=3),n)return u._modelManager.getStarSize(!0,t,e);if(3===t||2===t){if(o=u.getRowCount(t),e<0||e>=o)return 0;for(r=u.Wr,i=0;i<r.length;i++)if(!r[i].Xr(e))return 0}return s=(a=u.defaults).rowHeight,1===t&&(s=a.colHeaderRowHeight),(l=u._modelManager.getSize(!0,t,e))||0===l?l:V(s)},e.prototype.Yr=function(e,t){var n,o,r;return x(t)&&(t=3),this,o=(n=this.defaults).rowHeight,1===t&&(o=n.colHeaderRowHeight),(r=this._modelManager.getActualSize(!0,t,e))||0===r?r:V(o)},e.prototype.setRowHeight=function(e,t,n){this.Vr(e,t,q,!0,n),this.jq=!0,this.$p()},e.prototype.getRowVisible=function(e,t,n){var o,r;if(x(t)&&(t=3),!n&&(3===t||2===t))for(o=this.Wr,r=0;r<o.length;r++)if(!o[r].Xr(e))return!1;return this._modelManager.getVisible(!0,t,e)},e.prototype.setRowVisible=function(e,t,n){var o=this;o.Vr(e,t,K,!0,n),o.jq=!0,o.$p()},e.prototype.getColumnWidth=function(e,t,n){var o,r,i,a,s,l,u=this;if(x(t)&&(t=3),n)return u._modelManager.getStarSize(!1,t,e);if(r=(o=u.defaults).colWidth,2===t&&(r=o.rowHeaderColWidth),3===t||1===t){if(i=u.getColumnCount(t),e<0||e>=i)return 0;for(a=u.Zr,s=0;s<a.length;s++)if(!a[s].Xr(e))return 0}return(l=this._modelManager.getSize(!1,t,e))||0===l?l:V(r)},e.prototype.$r=function(e,t){var n,o,r;return x(t)&&(t=3),this,o=(n=this.defaults).colWidth,2===t&&(o=n.rowHeaderColWidth),(r=this._modelManager.getActualSize(!1,t,e))||0===r?r:V(o)},e.prototype.setColumnWidth=function(e,t,n){this.Vr(e,t,Z,!1,n),this.oq=!0,this.$p()},e.prototype.getColumnVisible=function(e,t){var n,o;if(x(t)&&(t=3),3===t||1===t)for(n=this.Zr,o=0;o<n.length;o++)if(!n[o].Xr(e))return!1;return this._modelManager.getVisible(!1,t,e)},e.prototype.setColumnVisible=function(e,t,n){var o=this;o.Vr(e,t,K,!1,n),o.oq=!0,o.$p()},e.prototype.zoom=function(e){var t,n=this;return 0===arguments.length?n._modelManager.getZoomFactor():(e=F(e),!P(e)&&isFinite(e)&&(e>4?e=4:e<.25&&(e=.25),t=n._modelManager.getZoomFactor(),n.XSa(e),n.eCb=n.eCb/t*e,n.cCb=n.cCb/t*e,n.oq=!0,n.jq=!0,n.$p()),n)},e.prototype.XSa=function(t){this._modelManager.do("setZoomFactor",t),e.ao(this,Q,{changeType:"zoomSheet"})},e.prototype.x6a=function(){var e=this;e._r=H,e.as={colHeader:H,viewport:H},e.bs={rowHeader:H,viewport:H}},e.prototype.invalidateLayout=function(){var t,n,o=this,i=o._eventHandler;o._modelManager.$Gb(),o.x6a(),e.ao(o,"beforeLayoutChanged",{changeType:"invalidateLayout"}),o.oq&&(o.ds(),o.oq=!1),o.jq&&(o.es(),o.jq=!1),o.x6a(),e.ao(o,Q,{changeType:"invalidateLayout"}),i&&i.cs&&r.Vl.Wl(o)&&!i.byb(o)&&i.cs(o.Jl,o.Kl),o.$l=!0,(t=o.parent)&&t.options.enableAccessibility&&(n=o.cgc(),t.dgc(n))},e.prototype.$p=function(){var e=this;e.Xq<=0&&(e.invalidateLayout(),e.repaint())},e.prototype.getViewportHeight=function(e){var t=this.am();return 0===e?t.fs:1===e?t.jr:2===e?t.gs:0},e.prototype.getViewportWidth=function(e){var t=this.am();return 0===e?t.hs:1===e?t.er:2===e?t.js:0},e.prototype.getViewportTopRow=function(e){var t=this,n=ye(t);return 0===e?0:1===e?z(n,t.lq):2===e?z(n,pe(t)-ge(t)):-1},e.prototype.getViewportBottomRow=function(e){var t,n,o,r,i,a,s=this;if(2===e)return pe(s)-1;for(t=s.getViewportTopRow(e),n=s.getViewportHeight(e),o=1===e?s.cCb:0,r=0,i=pe(s)-ge(s),0===e&&(i=L(ye(s),i)),a=t;a<i&&o<n;a++,r++)o+=s.Sl(a);return t+r-1},e.prototype.jCb=function(e){var t,n=this,o=n.getViewportTopRow(e),r=n.getViewportBottomRow(e);for(t=o;t<r+1;t++)if(t>-1&&n.getRowVisible(t,3)&&n.Sl(t,3)>0)return t;return-1},e.prototype.getViewportLeftColumn=function(e){var t=this,n=me(t);return 0===e?0:1===e?z(n,t.qq):2===e?z(n,he(t)-de(t)):-1},e.prototype.getViewportRightColumn=function(e){var t,n,o,r,i,a,s=this;if(2===e)return he(s)-1;for(t=s.getViewportLeftColumn(e),n=s.getViewportWidth(e),o=0,r=1===e?s.eCb:0,i=he(s)-de(s),0===e&&(i=L(me(s),i)),a=t;a<i&&r<n;a++,o++)r+=s.Tl(a);return t+o-1},e.prototype.kCb=function(e){var t,n=this,o=n.getViewportLeftColumn(e),r=n.getViewportRightColumn(e);for(t=o;t<r+1;t++)if(t>-1&&n.getColumnVisible(t,3)&&n.Tl(t,3)>0)return t;return-1},e.prototype.showCell=function(e,t,n,o){var r,i,a,s,l,u,c=this;e<0||e>=pe(c)||t<0||t>=he(c)||(r=c.Fr(t),i=c.Er(e),a=c.getViewportTopRow(i),s=c.getViewportLeftColumn(r),1===r&&(t=c.ks(t,o)),1===i&&(e=c.ms(e,n)),l=!1,1===i&&e!==a&&(e=L(e,c.ns()),c.lq=e,c.cCb=0,c.os(),l=!0),1===r&&t!==s&&(t=L(t,c.ps()),c.qq=t,c.eCb=0,c.qs(),l=!0),l&&((u=c.parent)&&!u.options.scrollbarShowMax&&(c.oq=!0,c.jq=!0),c.$p()))},e.prototype.Er=function(e){var t=this,n=1;return e<ye(t)?n=0:e>=pe(t)-ge(t)&&(n=2),n},e.prototype.Fr=function(e){var t=this,n=1;return e<me(t)?n=0:e>=he(t)-de(t)&&(n=2),n},e.prototype.ks=function(e,t){var n,o=this,r=o.ss,i=o.Fr(e),a=o.getViewportLeftColumn(i);if(0!==t)if(1===t)for(n=V((o.getViewportWidth(i)-r._m(e))/2);0<e&&!((n-=r._m(e-1))<0);e--);else if(2===t)for(n=o.getViewportWidth(i)-r._m(e);0<e&&!((n-=r._m(e-1))<0);e--);else if(3===t&&e>=a)for(n=o.getViewportWidth(i)-r._m(e);a<e&&!((n-=r._m(e-1))<0);e--);return e},e.prototype.ms=function(e,t){var n,o=this,r=o.ss,i=o.Er(e),a=o.getViewportTopRow(i);if(0!==t)if(1===t)for(n=V((o.getViewportHeight(i)-r.Sl(e))/2);0<e&&!((n-=r.Sl(e-1))<0);e--);else if(2===t)for(n=o.getViewportHeight(i)-r.Sl(e);0<e&&!((n-=r.Sl(e-1))<0);e--);else if(3===t&&!(e<a||-1===a))for(n=o.getViewportHeight(i)-r.Sl(e);a<e&&!((n-=r.Sl(e-1))<0);e--);return e},e.prototype.showColumn=function(e,t){this.showCell(this.lq,e,0,t)},e.prototype.showRow=function(e,t){this.showCell(e,this.qq,t,0)},e.prototype.suspendEvent=function(){this.jm++},e.prototype.resumeEvent=function(){this.jm--,this.jm<0&&(this.jm=0)},e.prototype.isEventSuspended=function(){return this.jm>0},e.prototype.currentTheme=function(e){var t=this;return 0===arguments.length?(t.Pm||t.ts(),t.Pm):(typeof e===U&&(e=v.Themes[e]?v.Themes[e]:new v.Theme(e)),t.Pm=e,t._render.us(),t.Jq(),t.$p(),t)},e.prototype.P3=function(){var e=r.Im.Lm(""),t=O(e.zIndex),n=v.Themes.Office2007;return t>2007&&(n=v.Themes.Office),n},e.prototype.ts=function(){this.Pm=this.P3(),this.Jq()},e.prototype.reset=function(){this.vs(),this.$p()},e.prototype.vs=function(){var t,n,o=this,i=o.DHb();o.Pp(),o.Nr=0,o.Pr=0,o.T3(),o._r=H,o.as={colHeader:H,viewport:H},o.bs={rowHeader:H,viewport:H},o.lq=0,o.cCb=0,o.qq=0,o.eCb=0,o.frozenRowCount(0),o.frozenColumnCount(0),o.frozenTrailingRowCount(0),o.frozenTrailingColumnCount(0),e.ao(o,"beforeSetHost"),(t=o.parent)&&((n=t.getActiveSheet())&&o.name()===n.name()&&o.ws(t.xs)),o.Cq=[{},{},{},{}],o.ss=new r.ln(o),o.Oq={},m&&o.resetCalc(),o._modelManager=new l.lUa(o,e.Rp,e.Sp,e.Vp,e.Tp,o.name()),o.defaults=o._modelManager.defaults,o.DHb(i),o.ts(),o.Lq={},o.oq=!0,o.jq=!0,o.parent&&o.parent.xD?o.Xq=o.parent.xD:o.Xq=0,o.parent&&o.parent.jm?o.jm=o.parent.jm:o.jm=0,o.gga=0,o.Js=!1,o.Ks=H,o.Wr=[],o.Zr=[],o.OIb=!1,e.ao(o,"init")},e.prototype.T3=function(){var e=this;N(ae,(function(t,n){if(!x(n)){var o=n;"gridline"===t?o={color:r.Im.Lm("gc-gridlineColor").borderTopColor,showVerticalGridline:!0,showHorizontalGridline:!0}:"object"==typeof o&&(o=u.GC$.extend({},n)),e.options[t]=o}}))},e.prototype.Ls=function(t){var n,o=this;for(o.parent=t,n=o.Xq;n<t.xD;n++)o.suspendPaint();o.jm=t.jm,e.ao(o,"attach",t)},e.prototype.jJb=function(e,t){return e.row===t.row&&e.col===t.col&&e.rowCount===t.rowCount&&e.colCount===t.colCount},e.prototype.kJb=function(e,t,n,o,r){var i,a,s=this.Ms(t,n,o,r).ranges;for(i=0;i<s.length;i++)for(a=0;a<e.length;a++)if(this.jJb(e[i],s[a]))return!0;return!1},e.prototype.lJb=function(e,t,n,o,r){var i,a=!1;return void 0!==r?0===r?(i=this.Ms(e,t,n,this.getColumnCount()-t).ranges).length>0&&(e-1>0&&(a=this.kJb(i,e-1,t,1,this.getColumnCount()-t)),a||(a=this.kJb(i,e+n,t,1,this.getColumnCount()-t)),a||(a=this.kJb(i,e,t,n,1))):(i=this.Ms(e,t,this.getRowCount()-e,o).ranges).length>0&&(e-1>0&&(a=this.kJb(i,e-1,t,this.getRowCount()-e,1)),a||(a=this.kJb(i,e+n,t,this.getRowCount()-e,1)),a||(a=this.kJb(i,e,t,1,o))):a=!0,a},e.prototype.Y3=function(e,t,n,o,i,a,s,l){var u,c=this;return!s&&c.options.isProtected&&c.ou(r.kf(e,t,n,o))?(i&&c.Os(1,i),!1):(u=this.lJb(e,t,n,o,l),!(m&&u&&!c.Vq(e,t,n,o)&&(a&&c.Os(1,a),1)))},e.prototype.clear=function(e,t,n,o,r,i){0!==r&&this.cg(e,t,n,o,r,i)},e.prototype.cg=function(t,n,o,r,i,a,s,l){var u,c,f,h,p,d,g,y,v,b,C,w,A,M,S=this,T=m;try{if(T&&S.suspendCalcService(),S.suspendPaint(),u=S.defaults,c=void 0,f=void 0,h=void 0,p=void 0,3,x(i)||3===i){if(T&&!S.Vq(t,n,o,r))return!1;if(1&a&&S.getDataSource&&S.getDataSource()){for(S.suspendEvent(),c=t;c<t+o;c++)if(!(s&&S.Ps&&S.Ps(c)))for(f=n;f<n+r;f++)S.setValue(c,f,H,i);S.resumeEvent()}}for(d={changeType:"clear",row:t,col:n,rowCount:o,colCount:r,sheetArea:i,type:a,ignoreTable:l},e.ao(S,Q,d),g=S._modelManager,y=T&&S.Bj(),c=-1===t?0:t,v=-1===t?g.getRowCount(i):o,f=-1===n?0:n,b=-1===n?g.getColumnCount(i):r,C=[],w=c;w<v+c;w++)s&&S.Ps&&S.Ps(w)&&C.push(w);if(g.do("clear",c,f,v,b,a,C,i),y&&1&a&&(y.Sg(c,f,v,b),y.clear(c,f,v,b,g.dUa())),8&a&&!(t>=0&&n>=0))if(n>=0)for(p=0;p<b;p++)S.setTag(-1,f+p,H,i);else if(t>=0)for(h=0;h<v;h++)s&&S.Ps&&S.Ps(c+h)||S.setTag(c+h,-1,H,i);else S.setTag(-1,-1,H,i);if(256&a&&!(t>=0&&n>=0))if(n>=0)for(p=0;p<b;p++)S.setHyperlink(-1,f+p,H,i);else if(t>=0)for(h=0;h<v;h++)s&&S.Ps&&S.Ps(c+h)||S.setHyperlink(-1,-1,H);if(2&a&&!(t>=0&&n>=0))if(n>=0)for(p=0;p<b;p++)S.setStyle(-1,f+p,H,i);else if(t>=0)for(h=0;h<v;h++)s&&S.Ps&&S.Ps(c+h)||S.setStyle(c+h,-1,H,i);else S.setStyle(-1,-1,H,i);if(32&a){if(t<0)for(p=0;p<b;p++)S.setColumnVisible(f+p,!0,i),S.setColumnResizable(f+p,!0,i),S.setColumnWidth(f+p,2===i?u.rowHeaderColWidth:u.colWidth,i);if(n<0)for(h=0;h<v;h++)s&&S.Ps&&S.Ps(c+h)||(S.setRowVisible(c+h,!0,i),S.setRowResizable(c+h,!0,i),S.setRowHeight(c+h,1===i?u.colHeaderRowHeight:u.rowHeight,i))}for((x(i)||3===i)&&T&&1==(1&a)&&((A=S.Bj())&&A.Ag(t,n,o,r)),M=[],h=0;h<v;h++)for(p=0;p<b;p++)M.push({row:c+h,col:f+p});S.Bu(t,n,v,b,M,2,i)}finally{S.resumePaint(),T&&S.resumeCalcService(!1)}},e.prototype._p=function(){var e,t,n,o,r=this,i=r.options,a=i.protectionOptions;i.isProtected&&a&&(e=a.allowSelectLockedCells,t=a.allowSelectUnlockedCells,(!1===e&&!1!==t||!1!==e&&!1===t)&&(n=r.Jl,o=r.Kl,r.Qs(n,o)||(r.Tr(),r.Rs(n,o,!0),r.Ss(4,n,o))))},e.prototype.setArray=function(e,t,n,o){var r,i,a,s,l=this,c=m;if(o=c&&o,r=pe(l),i=he(l),n&&0<=e&&e<r&&0<=t&&t<i){c&&l.suspendCalcService(),l.suspendPaint();try{N(n,(function(n,c){u.GC$.isArray(c)?N(c,(function(u,c){s=t+u,(a=e+n)<r&&s<i&&(o?l.setFormula(a,s,c):l.setValue(a,s,c,3,!0))})):(s=t,(a=e+n)<r&&s<i&&(o?l.setFormula(a,s,c):l.setValue(a,s,c,3,!0)))}))}finally{c&&l.resumeCalcService(),l.resumePaint()}}},e.prototype.getArray=function(e,t,n,o,r){var i,a,s=this,l=[],u=pe(s),c=he(s);if(r=r&&m,0<=e&&e<u&&0<=t&&t<c)for(e+n>u&&(n=u-e),t+o>c&&(o=c-t),i=0;i<n;i++)for(l[i]=[],a=0;a<o;a++)l[i][a]=r?s.getFormula(e+i,t+a):s.getValue(e+i,t+a);return l},e.prototype.setTag=function(e,t,n,o){var r,i,a,s,l,u;if(x(o)&&(o=3),r=this,0!==o){if(a=(i=r._modelManager).getRowCount(o),s=i.getColumnCount(o),e<-1||e>=a||t<-1||t>=s)return;n=k(n),l=void 0,(u=r.jm>0)||(l=r.getTag(e,t,o)),i.do("setValueForKey",e,t,J,n,o),u||l===n||(-1!==e&&-1!==t?r.Bq(J,e,t,o,l,n):-1!==e&&-1===t?r.kq(e,o,J,n,l):-1===e&&-1!==t&&r.pq(t,o,J,n,l))}},e.prototype.getTag=function(e,t,n){var o;return x(n)&&(n=3),0!==n?(o=this._modelManager.getValueForKey(e,t,J,n),E(o)):H},e.prototype.tag=function(e){var t,n=this;return 0===arguments.length?(t=n._modelManager.getValueForKey(-1,-1,J,3),E(t)):(n._modelManager.do("setValueForKey",-1,-1,J,k(e),3),n)},e.prototype.getParent=function(){return this.parent},e.prototype.getDirtyRows=function(){return ue(this,!0)},e.prototype.getInsertRows=function(){return ue(this,!1)},e.prototype.getDeletedRows=function(){var e=[],t=this.Ts;return t&&N(t,(function(t,n){n&&!u.GC$.isFunction(n)&&e.push({row:n.row,originalItem:n.data})})),e},e.prototype.hasPendingChanges=function(){var e,t=this.Ts;return!!(t&&t.length>0)||(e=this._modelManager.hUa(),!I(e))},e.prototype.clearPendingChanges=function(t){var n,o,r,i,a,s=this;return x(t)||I(t)?(s._modelManager.iUa(),s.Ts=[],void e.ao(s,"clearPendingChanges")):(n=t.row,o=t.col,r=t.rowCount,i=t.colCount,(1&(a=(a=t.clearType)||ie.dirty))===ie.dirty&&s.Rec(n,o,r,i),(2&a)===ie.insert&&s.Sec(n,o,r,i),void((4&a)===ie.delete&&s.Tec(n,o,r,i)))},e.prototype.Rec=function(t,n,o,r){var i=this,a=i._modelManager,s=i.Uec(t,n,o,r),l=i.Vec(n,r);s?(a.Qec(),e.ao(i,"clearPendingChanges")):a.Mec(l,t,n,o,r)},e.prototype.Sec=function(e,t,n,o){var r=this,i=r._modelManager,a=r.Uec(e,t,n,o),s=r.Vec(t,o);i.Lec(a,s,e,n)},e.prototype.Tec=function(e,t,n,o){var r,i,a,s=this;if(s.Uec(e,t,n,o))s.Ts=[];else if(s.Vec(t,o)&&(r=s.Ts))for(i=[],N(r,(function(t,o){if(o){var r=o.row;e<=r&&r<e+n&&i.push(t)}})),a=i.length-1;a>=0;a--)s.Ts.splice(i[a],1)},e.prototype.Vec=function(e,t){return x(e)||-1===e||0===e&&this.getColumnCount()===t},e.prototype.Wec=function(e,t){return x(e)||-1===e||0===e&&t===this.getRowCount()},e.prototype.Uec=function(e,t,n,o){return this.Vec(e,n)&&this.Vec(t,o)},e.prototype.getDirtyCells=function(e,t,n,o){var r,i,a,s,l,u,c,f=this;if(x(e)&&(e=-1),x(t)&&(t=-1),(x(n)||n<=0)&&(n=1),(x(o)||o<=0)&&(o=1),r=[],i=f._modelManager.hUa(),!I(i)){if(a=[],e>=0)for(s=e;s<e+n;s++)a.push(s);else for(l in i)R(i,l)&&a.push(O(l));N(a,(function(e,n){var a,s;if((u=i[n])&&"e"===u.rs)if(t>=0)for(a=t;a<t+o;a++)(c=u[a])&&r.push(Ce(f,n,a,c.oldValue));else for(s in u)P(s)||(c=u[s])&&r.push(Ce(f,n,O(s),c.oldValue))}))}return r},e.prototype.suspendDirty=function(){this.gga++,this._modelManager.jUa()},e.prototype.resumeDirty=function(){var e=this;e.gga--,e.gga<0&&(e.gga=0),e._modelManager.kUa()},e.prototype.isDirtySuspended=function(){return this.gga>0},e.prototype.ad=function(e){this.Us(new r.Rect(0,0,0,0)),this.vs(),this.cq(e)},e.prototype.Vs=function(){var e,t=this.Ws(),n={top:0,left:0};return t&&t.parentElement&&((n=u.GC$(t).offset())&&(n.top+=_.body.clientTop||0,n.left+=_.body.clientLeft||0)),(e=t&&t.canvasOffset)&&(n=e),n},e.prototype.ws=function(t){var n,o,i;t&&((n=this).Js=!1,n.Xs&&n.no(!1),o=A("canvas"),i=n.parent&&n.parent.options.enableAccessibility?"":re().NeedCanvasSupport,u.GC$(o).attr("id",t.getAttribute("id")+"_vp").attr("gcUIElement","gcWorksheetCanvas").html(i).appendTo(t),r.En.Kn(o,H,n),n.Xs=o,n.fq(),n.repaint(),n.parent&&n.parent.Ys(),e.ao(n,"setHost",u.GC$(o)))},e.prototype.Jgc=function(e,t,n,o,r,i,a,s,l){var u,c,f=this;for(u=n;u<o;u++)c=f.getText(t,u,l),e.push('"'+c+'"');for(u=r;u<i;u++)c=f.getText(t,u,l),e.push('"'+c+'"');for(u=a;u<s;u++)c=f.getText(t,u,l),e.push('"'+c+'"')},e.prototype.Kgc=function(){var e,t,n,o,r,i=this,a=i.getViewportTopRow(1),s=i.getViewportBottomRow(1),l=i.getViewportLeftColumn(1),u=s-a+1,c=i.getViewportRightColumn(1)-l+1,f=i.getRowCount(p.SheetArea.colHeader),h=i.getColumnCount(p.SheetArea.rowHeader),d=i.frozenColumnCount(),g=i.frozenTrailingColumnCount(),m=i.getColumnCount(),y=i.frozenRowCount(),v=i.frozenTrailingRowCount(),b=i.getRowCount(),C=[];for(e=0;e<f;e++)t=[],i.Jgc(t,e,0,d,l,l+c,m-g,m,p.SheetArea.colHeader),C.push(t.join(","));for(e=0;e<y;e++){for(n=[],o=0;o<h;o++)r=i.getText(e,o,p.SheetArea.rowHeader),n.push('"'+r+'"');i.Jgc(n,e,0,d,l,l+c,m-g,m),C.push(n.join(","))}for(e=a;e<a+u;e++){for(n=[],o=0;o<h;o++)r=i.getText(e,o,p.SheetArea.rowHeader),n.push('"'+r+'"');i.Jgc(n,e,0,d,l,l+c,m-g,m),C.push(n.join(","))}for(e=b-v;e<b;e++){for(n=[],o=0;o<h;o++)r=i.getText(e,o,p.SheetArea.rowHeader),n.push('"'+r+'"');i.Jgc(n,e,0,d,l,l+c,m-g,m),C.push(n.join(","))}return C.join(";")},e.prototype.cgc=function(e){var t,n,o,i,a,s=this;return r.util.sl()?s.Kgc():(t=s.Jl,n=s.Kl,o=p.SheetArea.viewport,!e||x(e.row)||x(e.col)||(t=e.row,n=e.col,o=e.hitTestType),i=re(),a="",o===p.SheetArea.rowHeader?a=i.ARIA_RowHeader+" ":o===p.SheetArea.colHeader&&(a=i.ARIA_ColumnHeader+" "),a+i.ARIA_Cell+"("+t+","+n+") "+j.Kb(i.ARIA_HasValue,[s.getText(t,n,o)]))},e.prototype.fq=function(){var e,t,n,o,i,a,s,l,c=this,f=c.Ws();f&&f.parentNode&&(t=(e=getComputedStyle(f.parentNode)).width,n=e.height,(o=t.indexOf("px"))>0&&(t=t.substring(0,o)),(o=n.indexOf("px"))>0&&(n=n.substring(0,o)),i=O(t),a=O(n),P(i)&&(i=u.GC$(f.parentNode).width()),P(a)&&(a=u.GC$(f.parentNode).height()),0!==i&&0!==a&&(s=z(i,0),l=z(a,0),f.style.display="none",f.style.display="",f.width=s,f.height=l,f.style.width=s+"px",f.style.height=l+"px",s=f.clientWidth||f.width,l=f.clientHeight||f.height,c.Zs.width=s,c.Zs.height=l,r.En.Pn(f,s,l),c.invalidateLayout()))},e.prototype.no=function(t,n){var o,i,a,s=this;!0!==s.Js&&(r.En.Sn(s),s.isEditing&&s.isEditing()&&s.Yoa(),e.ao(s,"dispose",{clearCache:t,isSheetDestroy:!0,hasActiveSheet:n}),(o=s.Xs)&&((i=o.parentNode)&&i.removeChild(o),s.Xs=H),s.$s(),s._modelManager&&s._modelManager.no(t),!1!==t&&(s.Js=!0,(a=s.at)&&a.no(),s.parent=H,s._modelManager=H,s.ss&&(s.ss.no(),s.ss=H),s.bt&&(s.bt.no(),s.bt=H),r.Vl.Wl(s)&&r.Vl.Zl(H,!0),s.uu&&(s.uu=H),s.Wr=H,s.Zr=H))},e.prototype.$s=function(){var e=this.dt;e&&(u.GC$(e).remove(),this.dt=B)},e.prototype.vq=function(e,t,n,o,r){var i,a,s,l;return x(o)&&(o=3),3===o&&this.jIb&&((i=e.getDynamicArrayInfo(t,n))&&i.isValid&&(t!==i.row||n!==i.col))?H:(a=this.et,!this.loading&&a&&(a.getCalcService().calcOnDemand&&3===o&&((s=a.qg(t,n))&&!0===s.$l&&(s.$l=!1,delete s.dh,delete s.eh,a.recalculateCell(t,n),this.yj().zIc()))),l=e.getValue(t,n,o,this.loading,r),l=E(l))},e.prototype.Tq=function(e,t){var n,o,i,a,s;return x(t)&&(t=3),n=r.kf(-1,-1,-1,-1),e&&(this,o=e.row,i=e.col,a=e.rowCount,s=e.colCount,-1===i&&(i=0,s=this.getColumnCount(t)),-1===o&&(o=0,a=this.getRowCount(t)),n.col=i,n.row=o,n.colCount=s,n.rowCount=a),n},e.prototype.getRangeRect=function(e,t,n){var o,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C=new r.Rect(-1,-1,-1,-1),w=this,x=w.am();if(0===x.width||0===x.height)return C;if(o=w.it(t),i=w.jt(e),!o||0===o.length||!i||0===i.length)return C;return a=w.Tq(n),s=w.ss,l=a.row,u=a.row+a.rowCount-1,c=a.col,f=a.col+a.colCount-1,h=ye(w),p=pe(w)-ge(w)-1,d=me(w),g=he(w)-de(w)-1,m=o[0].col,y=o[o.length-1].col,v=i[0].row,b=i[i.length-1].row,c<m&&(c=function(e,t){for(;e>t;)if(e--,w.getColumnVisible(e))return e;return e}(m,c)),f>y&&(f=function(e,t){for(;e<t;)if(e++,w.getColumnVisible(e))return e;return e}(y,f)),l<v&&(l=function(e,t){for(;e>t;)if(e--,w.getRowVisible(e))return e;return e}(v,l)),u>b&&(u=function(e,t){for(;e<t;)if(e++,w.getRowVisible(e))return e;return e}(b,u)),f<c||u<l||(0===t?c<d&&(C.x=x.kt+ce(s,0,c-1),C.width=ce(s,c,f)):1===t?c<=g&&f>=d&&(C.x=c<m?o[0].x-ce(s,c,m-1):o[0].x+ce(s,m,c-1),C.width=ce(s,c,f)):2===t&&f>g&&(C.x=c<m?x.lt-ce(s,c,m-1):x.lt+ce(s,m,c-1),C.width=ce(s,c,f)),0===e?l<h&&(C.y=x.nt+fe(s,0,l-1),C.height=fe(s,l,u)):1===e?l<=p&&u>=h&&(C.y=l<v?i[0].y-fe(s,l,v-1):i[0].y+fe(s,v,l-1),C.height=fe(s,l,u)):2===e&&u>p&&(C.y=l<v?x.ot-fe(s,l,v-1):x.ot+fe(s,v,l-1),C.height=fe(s,l,u))),C},e.prototype.isintersectWithArrayFormula=function(e){var t,n,o=this.Bj();if(o)for(t=e.row;t<e.row+e.rowCount;t++)for(n=e.col;n<e.col+e.colCount;n++)if(o.dg(t,n,1,1))return!0;return!1},e.prototype.cm=function(e){var t,n,o,i,a,s,l,u,c,f,h,p,d,g,m=this,y=new r.Rect(-1,-1,-1,-1),v=m.am();if(0===v.width||0===v.height)return y;if(t=m.Tq(e),n=me(m),o=ye(m),i=de(m),a=ge(m),s=m.ss,l=t.row,u=t.row+t.rowCount-1,c=t.col,f=t.col+t.colCount-1,h=pe(m),p=he(m),c<n)y.x=v.kt+ce(s,0,c-1),y.width=ce(s,c,L(f,n-1)),n<=f&&f<p-i?(d=m.it(1))&&d.length>0&&(y.width+=ce(s,d[0].col,L(f,d[d.length-1].col))+m.eCb):f>=p-i&&((d=m.it(2))&&d.length>0&&(y.width=d[0].x-y.x,y.width+=ce(s,p-i,L(f,p-1))));else if(c<p-i){if(!(d=m.it(1))||0===d.length||c>d[d.length-1].col||f<d[0].col)return y;y.x=v.pt+ce(s,d[0].col,c-1)+m.eCb,n<=f&&f<p-i?y.width=ce(s,z(c,d[0].col),L(f,d[d.length-1].col)):f>=p-i&&((d=m.it(2))&&d.length>0&&(y.width=d[0].x-y.x,y.width+=ce(s,p-i,L(f,p-1))))}else c<p&&((d=m.it(2))&&d.length>0&&(y.x=v.lt+ce(s,d[0].col,c-1),y.width=ce(s,c,L(f,p-1))));if(l<o)y.y=v.nt+fe(s,0,l-1),y.height=fe(s,l,L(u,o-1)),o<=u&&u<h-a?(g=m.jt(1))&&g.length>0&&(y.height+=fe(s,g[0].row,L(u,g[g.length-1].row))+m.cCb):u>=h-a&&((g=m.jt(2))&&g.length>0&&(y.height=g[0].y-y.y,y.height+=fe(s,h-a,L(u,h-1))));else if(l<h-a){if(!(g=m.jt(1))||0===g.length||l>g[g.length-1].row||u<g[0].row)return y;y.y=v.qt+fe(s,g[0].row,l-1)+m.cCb,o<=u&&u<h-a?y.height=fe(s,z(l,g[0].row),L(u,g[g.length-1].row)):u>=h-a&&((g=m.jt(2))&&g.length>0&&(y.height=g[0].y-y.y,y.height+=fe(s,h-a,L(u,h-1))))}else l<h&&((g=m.jt(2))&&g.length>0&&(y.y=v.ot+fe(s,g[0].row,l-1),y.height+=fe(s,l,L(u,h-1))));return y},e.prototype.Ws=function(){return this.Xs},e.prototype.rt=function(e,t){return this.dp(e,t)+1},e.prototype.dp=function(e,t){var n,o=this._render;return n=t||o.Cl(o.Bl()),r.Vn.Xn(e,n)},e.prototype.or=function(e){var t=this.am(),n=H;return t.zr<e&&e<t.zr+t.Br?n=-1:t.kt<e&&e<t.kt+t.hs?n=0:t.pt<e&&e<t.pt+t.er?n=1:t.lt<e&&e<t.lt+t.js&&(n=2),n},e.prototype.nr=function(e){var t=this.am(),n=H;return t.Ar<e&&e<t.Ar+t.Cr?n=-1:t.nt<e&&e<t.nt+t.fs?n=0:t.qt<e&&e<t.qt+t.jr?n=1:t.ot<e&&e<t.ot+t.gs&&(n=2),n},e.prototype.pr=function(e,t){var n,o;if((n=-1===t?this.ut():this.jt(t))&&(o=n.findY(e)))return o.row},e.prototype.qr=function(e,t){var n,o;if((n=-1===t?this.vt():this.it(t))&&(o=n.findX(e)))return o.col},e.prototype.wt=function(e,t){var n=this;return n.Jl<=e&&e<n.Jl+n.Lr&&n.Kl<=t&&t<n.Kl+n.Mr},e.prototype.sp=function(e){return this._modelManager.sp(e)},e.prototype.tp=function(e){return this._modelManager.tp(e)},e.prototype.vp=function(e,t,n,o){var r=pe(this),i=he(this);return this._modelManager.vp(e,t,n,r,i,o)},e.prototype.wp=function(e,t,n){var o=pe(this),r=he(this);return this._modelManager.wp(e,t,n,o,r)},e.prototype.xt=function(e,t,n){var o,r,i,a,s,l,u=this,c=u.yt;if(c&&!c.resizeInfo&&!x(n)){if(a=c.hitTestType,s=c.row,l=c.col,1===n)return o=!1,(r=u._modelManager.findSpan(s,l,1))&&(o=r.contains(e,t,1,1)),i=e===s&&t===l||o,a===n&&i;if(2===n)return o=!1,(r=u._modelManager.findSpan(s,l,2))&&(o=r.contains(e,t,1,1)),i=e===s&&t===l||o,a===n&&i;if(3===n)return a===n&&e===s&&t===l;if(0===n)return a===n}return!1},e.prototype.sr=function(e,t){return e>=0&&e<=2&&t>=0?3:e>=0&&e<=2&&t<0?2:e<0&&t>=0?1:e<0&&t<0?0:H},e.prototype.zt=function(e){var t=this._eventHandler;t&&t.zt(e)},e.prototype.zo=function(){var e,t=this.parent,n=t&&t._host;return n||(n=(e=this.Xs)&&e.parentElement),n},e.prototype.Pp=function(){var e=this;e.Jl=0,e.Kl=0,e.Lr=1,e.Mr=1,e.Qr=0,e.Rr=0},e.prototype.Sl=function(e,t,n){var o=this.getRowHeight(e,t),r=this.zoom();return 1!==r&&(o*=r),n?o:G(o)},e.prototype.Tl=function(e,t,n){var o=this.getColumnWidth(e,t),r=this.zoom();return 1!==r&&(o*=r),n?o:G(o)},e.prototype.At=function(){var e,t,n,o,i,a,s,l,u,c=this,f=c.Dr(),h=c.options,p=h.sheetAreaOffset.left,d=h.sheetAreaOffset.top,g=new r.Rect(f.x+p,f.y+d,z(0,f.width-p),z(0,f.height-d)),m=g.width,y=g.height,v={x:g.x,y:g.y,width:g.width,height:g.height,Br:0,Cr:0,hs:0,fs:0,js:0,gs:0,Bt:0,Ct:0,Dt:0,Et:0,kt:0,nt:0,lt:0,ot:0,pt:0,qt:0,jr:0,er:0,zr:0,Ar:0,em:function(){var e=this;return new r.Rect(e.x,e.y,e.Br,e.Cr)},gm:function(e){var t=this;return 0===e?new r.Rect(t.kt,t.y,t.hs,t.Cr):1===e?new r.Rect(t.pt,t.y,t.er,t.Cr):2===e?new r.Rect(t.lt,t.y,t.js,t.Cr):H},fm:function(e){var t=this;return 0===e?new r.Rect(t.x,t.nt,t.Br,t.fs):1===e?new r.Rect(t.x,t.qt,t.Br,t.jr):2===e?new r.Rect(t.x,t.ot,t.Br,t.gs):H},Ft:function(e,t){var n=this;if(0===e){if(0===t)return new r.Rect(n.kt,n.nt,n.hs,n.fs);if(1===t)return new r.Rect(n.pt,n.nt,n.er,n.fs);if(2===t)return new r.Rect(n.lt,n.nt,n.js,n.fs)}else if(1===e){if(0===t)return new r.Rect(n.kt,n.qt,n.hs,n.jr);if(1===t)return new r.Rect(n.pt,n.qt,n.er,n.jr);if(2===t)return new r.Rect(n.lt,n.qt,n.js,n.jr)}else if(2===e){if(0===t)return new r.Rect(n.kt,n.ot,n.hs,n.gs);if(1===t)return new r.Rect(n.pt,n.ot,n.er,n.gs);if(2===t)return new r.Rect(n.lt,n.ot,n.js,n.gs)}return H}};if(c.Gt&&(0,(e=c.Gt()).width>0&&(v.x+=e.width+0,m-=e.width+0),e.height>0&&(v.y+=e.height+0,y-=e.height+0)),h.rowHeaderVisible)for(i=c.getColumnCount(2),o=0;o<i;o++)v.Br+=c.Tl(o,2);if(h.colHeaderVisible)for(n=c.getRowCount(1),t=0;t<n;t++)v.Cr+=c.Sl(t,1);if((a=me(c))>0)for(i=he(c),o=0;o<a&&o<i;o++)c.getColumnVisible(o)&&(v.hs+=c.Tl(o));if((s=ye(c))>0)for(n=pe(c),t=0;t<s&&t<n;t++)c.getRowVisible(t)&&(v.fs+=c.Sl(t));if((l=de(c))>0)for(i=he(c),o=z(a,i-l);o<i;o++)v.js+=c.Tl(o);if((u=ge(c))>0)for(n=pe(c),t=z(s,n-u);t<n;t++)v.gs+=c.Sl(t);return m-=v.Br,y-=v.Cr,m-=v.hs,y-=v.fs,m-=v.js,y-=v.gs,y-=v.Bt,v.er=z(0,m),v.jr=z(0,y),v.zr=v.x,v.Ar=v.y,v.kt=v.zr+v.Br,v.nt=v.Ar+v.Cr,v.pt=v.kt+v.hs,v.qt=v.nt+v.fs,v.lt=v.pt+v.er,v.ot=v.qt+v.jr,v.Dt=v.zr,v.Et=v.y+v.height-v.Bt,v},e.prototype.am=function(){var e=this;return e._r||(e._r=e.At()),e._r},e.prototype.Hr=function(e,t){return x(t)||3===t||1===t?this.it(e):2===t?this.vt():H},e.prototype.vt=function(){var e=this;return e.bs.rowHeader||(e.bs.rowHeader=e.Ht()),e.bs.rowHeader},e.prototype.it=function(e){var t=this;return t.bs.viewport||(t.bs.viewport={}),t.bs.viewport[e]||(t.bs.viewport[e]=t.It(e)),t.bs.viewport[e]},e.prototype.Ht=function(){var e,t,n=new l.yp,o=this.am().zr,r=this.getColumnCount(2);for(t=0;t<r;t++)e=this.Tl(t,2),n.push(new l.zp(-1,t,o,-1,e,-1)),o+=e;return n},e.prototype.It=function(e){var t,n,o,r,i,a=this,s=new l.yp,u=a.am(),c=he(a),f=a.ss,h=me(a),p=de(a);if(0===e)for(n=u.kt,c=L(h,c),t=0;t<c;t++)o=f._m(t),s.push(new l.zp(-1,t,n,-1,o,-1)),n+=o;else if(1===e)for(r=a.eCb,n=u.pt+r,c-=p,i=u.er-r,t=z(h,a.qq);i>0&&t<c;t++)o=f._m(t),s.push(new l.zp(-1,t,n,-1,o,-1)),n+=o,i-=o;else if(2===e)for(n=u.lt,t=z(h,c-p);t<c;t++)o=f._m(t),s.push(new l.zp(-1,t,n,-1,o,-1)),n+=o;return s},e.prototype.Gr=function(e,t){return x(t)||3===t||2===t?this.jt(e):1===t?this.ut():H},e.prototype.Jt=function(e){var t,n,o=new l.yp;for(t=0;t<3;t++)(n=this.Gr(t,e))&&n.length>0&&(o=u.GC$.merge(o,n));return o},e.prototype.Kt=function(e){var t,n,o=new l.yp;for(t=0;t<3;t++)(n=this.Hr(t,e))&&n.length>0&&(o=u.GC$.merge(o,n));return o},e.prototype.ut=function(){var e=this;return e.as.colHeader||(e.as.colHeader=e.Lt()),e.as.colHeader},e.prototype.jt=function(e){var t=this;return t.as.viewport||(t.as.viewport={}),t.as.viewport[e]||(t.as.viewport[e]=t.Mt(e)),t.as.viewport[e]},e.prototype.Lt=function(){var e,t,n=new l.yp,o=this.am().Ar,r=this.getRowCount(1);for(t=0;t<r;t++)e=this.Sl(t,1),n.push(new l.zp(t,-1,-1,o,-1,e)),o+=e;return n},e.prototype.Mt=function(e){var t,n,o,r,i,a=this,s=new l.yp,u=ye(a),c=ge(a),f=a.am(),h=pe(a),p=a.ss;if(0===e)for(n=f.nt,h=L(u,h),t=0;t<h;t++)o=p.Sl(t),s.push(new l.zp(t,-1,-1,n,-1,o)),n+=o;else if(1===e)for(r=a.cCb,n=f.qt+r,h-=c,i=f.jr-r,t=z(u,a.lq);i>0&&t<h;t++)o=p.Sl(t),s.push(new l.zp(t,-1,-1,n,-1,o)),n+=o,i-=o;else if(2===e)for(n=f.ot,t=z(u,h-c);t<h;t++)o=p.Sl(t),s.push(new l.zp(t,-1,-1,n,-1,o)),n+=o;return s},e.prototype.Ir=function(e,t,n,o){var i,a,s,u,c,f,h=this,p=h.getRowCount(n),d=h.getColumnCount(n),g=h.Gr(e,n),m=h.Hr(t,n),y=new l.yp;return g&&g.length>0&&m&&m.length>0&&(i=g[0].row,a=m[0].col,s=g[g.length-1].row,u=m[m.length-1].col,c=h._modelManager.getSpans(r.kf(i,a,s-i+1,u-a+1),n),o&&h.mJb&&(f=h.mJb.nJb(n),c=c.concat(f)),c.length>0&&h.Nt(c,i,a,s,u,y,p,d,n,g,m)),y},e.prototype.rr=function(e,t,n,o,r){var i,a,s,u,c=this,f=c.getRowCount(n),h=c.getColumnCount(n),p=c.Gr(e,n),d=c.Hr(t,n),g=new l.yp;return p&&p.length>0&&d&&d.length>0?(i=p[0].row,a=d[0].col,(s=c.getSpan(o,r,n))&&((u=[]).push(s),c.Nt(u,i,a,s.row+s.rowCount,s.col+s.colCount,g,f,h,n,p,d)),g.length>0?g[0]:H):H},e.prototype.Nt=function(e,t,n,o,r,i,a,s,u,c,f){var h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D=e.length;if(!(D<=0)){for(h=this,d=o+1,g=r+1,m=[],y=[],v=[],b=[],C=0,w=0,p=t-1;p>=0;p--)m[p]=h.Sl(p,u),w-=m[p],b[p]=w;for(w=0,p=t;p<d;p++)b[p]=w,m[p]=h.Sl(p,u),w+=m[p];for(p=n-1;p>=0;p--)y[p]=h.Tl(p,u),C-=y[p],v[p]=C;for(C=0,p=n;p<g;p++)v[p]=C,y[p]=h.Tl(p,u),C+=y[p];for(x=0;x<D;x++)if((A=e[x]).intersect(t,n,o-t+1,r-n+1)){if((M=A.row+A.rowCount)>d){for(p=d;p<M;p++)m.push(h.Sl(p,u)),b.push(b[p-1]+m[p]);d=M}if((S=A.col+A.colCount)>g){for(p=g;p<S;p++)y.push(h.Tl(p,u)),v.push(v[p-1]+y[p]);g=S}for(T=v[A.col],N=b[A.row],I=0,R=0,k=void 0,E=void 0,E=A.col;E<A.col+A.colCount&&E<s;E++)I+=y[E];for(k=A.row;k<A.row+A.rowCount&&k<a;k++)R+=m[k];i.push(new l.zp(A.row,A.col,f[0].x+T,c[0].y+N,I,R,A.rowCount,A.colCount,A.isAutoMerge))}}},e.prototype.qs=function(){var e,t,n=this,o=n.parent,r=n.Ot(n.qq),i=n.eCb;-1!==r&&r!==n.qq&&(n.qq=r),(e=o&&o.Pt)&&(t=e.QB===p.ScrollType.pixels?n.jgc(r)-i:n.Qt(r),e.value(t))},e.prototype.os=function(){var e,t,n=this,o=n.parent,r=n.Rt(n.lq),i=n.cCb;-1!==r&&r!==n.lq&&(n.lq=r),(e=o&&o.St)&&(t=e.QB===p.ScrollType.pixels?n.kgc(r)-i:n.Tt(r),e.value(t))},e.prototype.ds=function(){var e,t=this,n=t.parent;n&&n.Pt&&(e=n.options.scrollByPixel,n.Pt.QB=e?p.ScrollType.pixels:p.ScrollType.continuous),n&&n.Ut&&(n.options.scrollbarAppearance===p.ScrollbarAppearance.mobile&&n.hec(),n.options.scrollIgnoreHidden&&(t.Vt=t.Wt(!0)),n.Ut())},e.prototype.es=function(){var e,t=this,n=t.parent;n&&n.St&&(e=n.options.scrollByPixel,n.St.QB=e?p.ScrollType.pixels:p.ScrollType.continuous),n&&n.Xt&&(n.options.scrollbarAppearance===p.ScrollbarAppearance.mobile&&n.hec(),n.options.scrollIgnoreHidden&&(t.Yt=t.Zt(!0)),n.Xt())},e.prototype.$t=function(){var e=this,t=me(e);return t>0?e.Zq(t-1):e.$q()},e.prototype._t=function(){var e=this,t=ye(e);return t>0?e._q(t-1):e.ar()},e.prototype.$q=function(e){return this.Zq(-1,e)},e.prototype.Zq=function(e,t,n){for(var o=this,r=o.getColumnCount(t),i=n?r-1:r-1-de(o);e<i;)if(e++,o.getColumnVisible(e,t)&&o.Tl(e,t)>0)return e;return H},e.prototype.br=function(e,t){for(var n=this,o=me(n);e>o;)if(e--,n.getColumnVisible(e,t)&&n.Tl(e,t)>0)return e;return H},e.prototype.ar=function(e){return this._q(-1,e)},e.prototype._q=function(e,t,n){for(var o=this,r=o.getRowCount(t),i=n?r-1:r-1-ge(o);e<i;)if(e++,o.getRowVisible(e,t)&&o.Sl(e,t)>0)return e;return H},e.prototype.gr=function(e,t,n){for(var o=this,r=n?0:ye(o);e>r;)if(e--,o.getRowVisible(e,t)&&o.Sl(e,t)>0)return e;return H},e.prototype.au=function(){this.jq=!0,this.os()},e.prototype.bu=function(){this.oq=!0,this.qs()},e.prototype.kgc=function(e){var t,n=this,o=ye(n),r=o+(pe(n)-ge(n)-o)-1,i=0;if(e<=o)return i;for(e>r&&(e=r),t=o;t<e;t++)i+=n.Sl(t);return i},e.prototype.jgc=function(e){var t,n=this,o=me(n),r=o+(he(n)-de(n)-o)-1,i=0;if(e<=o)return i;for(e>r&&(e=r),t=o;t<e;t++)i+=n.Tl(t);return i},e.prototype.Tt=function(e){var t=this.parent;return t&&t.options.scrollIgnoreHidden?this.Zt().visibleIndex[e]:e},e.prototype.cu=function(e){var t=this.parent;return t&&t.options.scrollIgnoreHidden?this.Zt().originalIndex[e]:e},e.prototype.Qt=function(e){var t=this.parent;return t&&t.options.scrollIgnoreHidden?this.Wt().visibleIndex[e]:e},e.prototype.du=function(e){var t=this.parent;return t&&t.options.scrollIgnoreHidden?this.Wt().originalIndex[e]:e},e.prototype.Wt=function(e){var t,n,o,r,i,a,s,l=this;if(l.Vt&&!e)return l.Vt;if(o=(n=t=me(l))+(he(l)-de(l)-t)-1,r=l.ss,i={visibleIndex:{},originalIndex:{}},o-n+1<=0)return i;for(a=0,s=n;s<=o;s++)i.originalIndex[a]=s,i.visibleIndex[s]=a,r._m(s)>0&&a++;for(s--,a--;r._m(s)<=0&&s>=n;)i.originalIndex[a]=s,i.visibleIndex[s]=a,s--;return i},e.prototype.Zt=function(e){var t,n,o,r,i,a,s,l=this;if(l.Yt&&!e)return l.Yt;if(o=(n=t=ye(l))+(pe(l)-ge(l)-t)-1,r=l.ss,i={visibleIndex:{},originalIndex:{}},o-n+1<=0)return i;for(a=0,s=n;s<=o;s++)i.originalIndex[a]=s,i.visibleIndex[s]=a,r.Sl(s)>0&&a++;for(s--,a--;r.Sl(s)<=0&&s>=n;)i.originalIndex[a]=s,i.visibleIndex[s]=a,s--;return i},e.prototype.Rt=function(e,t){var n,o=this,r=ye(o),i=pe(o)-ge(o)-1;if(t){if(e>i&&(e=i),(n=o.gr(e+1))!==H&&n>=r)return n}else if(e<r&&(e=r),(n=o._q(e-1))!==H&&n<=i)return n;return-1},e.prototype.Ot=function(e,t){var n,o=this,r=me(o),i=he(o)-de(o)-1;if(t){if(e>i&&(e=i),(n=o.br(e+1))!==H&&n>=r)return n}else if(e<r&&(e=r),(n=o.Zq(e-1))!==H&&n<=i)return n;return-1},e.prototype.eu=function(e,t,n){var o,r,i,a,s;if(n<t)return n;for(o=0,r=this.ss,i=n,a=n;a>=t;a--)if(!((s=r.Sl(a))<=0)){if((o+=s)>e)break;i=a}return i},e.prototype.LHb=function(e,t,n){var o,r,i=0,a=n,s=0;for(o=n;o>=t;o--)if(!((r=this.Sl(o))<=0)&&(a=o,(i+=r)>=e)){s=e-i;break}return{cj:a,UP:s}},e.prototype.fu=function(e,t,n){var o,r,i,a,s;if(n<t)return n;for(o=0,r=this.ss,i=n,a=n;a>=t;a--)if(!((s=r._m(a))<=0)){if((o+=s)>e)break;i=a}return i},e.prototype.MHb=function(e,t,n){var o,r,i=0,a=n,s=0;for(o=n;o>=t;o--)if(!((r=this.Tl(o))<=0)&&(a=o,(i+=r)>=e)){s=e-i;break}return{dj:a,UP:s}},e.prototype.gu=function(){var e,t,n,o=this.am(),r=this.Hr(1,3),i=0,a=0;if(r)for(e=0;e<r.length;e++)i+=t=r[e].width,t>0&&a++;return 0===(n=i/(a=0===a?1:a))?1:V(o.er/n)},e.prototype.hu=function(){var e,t,n,o=this.am(),r=this.Gr(1,3),i=0,a=0;if(r)for(e=0;e<r.length;e++)i+=t=r[e].height,t>0&&a++;return 0===(n=i/(a=0===a?1:a))?1:V(o.jr/n)},e.prototype.ns=function(e){var t,n,o,r,i,a,s;return x(e)&&(e=3),n=(t=this).parent,o=ye(t),r=ge(t),n&&n.options.scrollbarMaxAlign?(i=t.am(),t.eu(i.jr,o,pe(t)-r-1)):(a=t.getRowCount(e),3!==e&&2!==e||(a-=r),(s=t.gr(a,e))===H&&(s=o),s)},e.prototype.ps=function(e){var t,n,o,r,i,a;return x(e)&&(e=3),n=(t=this).parent,o=me(t),n&&n.options.scrollbarMaxAlign?(r=t.am(),t.fu(r.er,o,he(t)-de(t)-1)):(i=t.getColumnCount(e),3!==e&&1!==e||(i-=de(t)),(a=t.br(i,e))===H&&(a=o),a)},e.prototype.iu=function(){var t,n,o,r,i=this,a=ye(i),s=me(i),l=pe(i)-ge(i)-1,u=he(i)-de(i)-1,c=i._modelManager,f=c.getLastNonNullRow(3);return f>a&&(a=f),(t=c.getLastNonNullCol(3))>s&&(s=t),(n=c.getLastNonNullRow(2))>a&&(a=n),(o=c.getLastNonNullCol(1))>s&&(s=o),(r=e._features)&&N(r,(function(e,t){var n,o=t.lastNonNullRowAndCol;o&&(n=o.call(i),a=z(a,n.lastNonNullRow),s=z(s,n.lastNonNullCol))})),a>l&&(a=l),s>u&&(s=u),{lastNonNullRow:a,lastNonNullCol:s}},e.prototype.mq=function(e,t,n){var o,r=this,i=r.lq,a=r.cCb,s=r.ns();i>=r.getRowCount()&&e>s&&(e=s),e>=r._t()&&e<=s&&(n||e!==i||t!==a)&&((o=r.parent)&&(o.ku.ju(e,t||0,n),r.os()),o&&!o.options.scrollbarShowMax&&r.es())},e.prototype.rq=function(e,t,n){var o,r=this,i=r.qq,a=r.eCb,s=r.ps();i>=r.getColumnCount()&&e>s&&(e=s),e>=r.$t()&&e<=s&&(n||e!==i||t!==a)&&((o=r.parent)&&(o.ku.lu(e,t||0,n),r.qs()),o&&!o.options.scrollbarShowMax&&r.ds())},e.prototype.yr=function(e,t,n){var o,r,i,a,s,l,u,c=this,f=e.row,h=e.col,p=e.hitTestType;return x(f)||x(h)?H:((o=c.getSpan(f,h,p))&&(f=o.row,h=o.col),c.mJb&&((r=c.mJb.oJb(f,h,p))&&(f=r.row,h=r.col)),i=c.AHb(f,h,p),a=1===p?-1:B,s=2===p?-1:B,l=c.getCellRect(f,h,a,s,!0),u={sheet:c,row:f,col:h,sheetArea:p},(i.cellType||c.Al(p)).h5(t,n,i,l,u))},e.prototype.mu=function(){this.unbindAll(),this.nu()},e.prototype.ou=function(e){var t,n,o,r,i,a=this.Tq(e),s=a.row,l=a.col,u=s+a.rowCount,c=l+a.colCount;for(t=s;t<u;t++)for(n=l;n<c;n++)if(r=(o=this.getSpan(t,n))?o.row:t,i=o?o.col:n,!0===this.getActualStyle(r,i).locked)return!0;return!1},e.prototype.pu=function(e,t,n,o,r,i){if(-1<=e&&e<r&&-1<=t&&t<i){if(-1===e&&-1===t)return!0;if(-1===e){if(0!==o&&t+o<=i)return!0}else if(-1===t){if(0!==n&&e+n<=r)return!0}else if(0!==o&&t+o<=i&&0!==n&&e+n<=r)return!0}return!1},e.prototype.qu=function(e,t,n,o){var r,i,a,s=this;return!(e<0&&t<0)&&(e<0&&((r=s._modelManager.zl(1))&&r.spans&&r.spans.length>0)?s._modelManager.qu(-1,t,-1,o,1):t<0&&((i=s._modelManager.zl(2))&&i.spans&&i.spans.length>0)?s._modelManager.qu(e,-1,n,-1,2):!!((a=s._modelManager.zl(3))&&a.spans&&a.spans.length>0)&&s._modelManager.qu(e,t,n,o,3))},e.prototype.suspendPaint=function(){var t=this,n=t.Xq;t.Xq++,0===n&&e.ao(t,Y,{suspend:!0})},e.prototype.resumePaint=function(){var t,n=this;n.Xq--,n.Xq<=0&&(n.Xq=0,e.ao(n,Y,{suspend:!1}),(t=n.parent)&&t.getActiveSheet()!==n||n.$p())},e.prototype.isPaintSuspended=function(){return this.Xq>0},e.prototype.su=function(e,t){var n,o,r=e&&e.length;for(n=0;n<r;n++)if(o=e[n],t.intersect(o.row,o.col,o.rowCount,o.colCount))return e.splice(n,1),this.su(e,t.union(o));return t},e.prototype.getClipboardHelperObj=function(){var e=this.tu();return{isCutting:e.G4,ranges:e.n5,showInsertCopyPasteCells:e.UHb}},e.prototype.tu=function(){var e=this,t=e.parent;return e.uu||(e.uu=t&&t.uu),e.uu},e.prototype.vu=function(){if(!this.bt){var e=this;e.bt=new i.oo((function(){e.bt&&e.repaint()}))}return this.bt},e.prototype.wu=function(){var e=this.parent;if(e)return e.commandManager()},e.prototype.Os=function(e,t){this.Wq(r.Events.InvalidOperation,{sheet:this,sheetName:this.name(),invalidType:e,message:t})},e.prototype.Bq=function(e,t,n,o,i,a){var s;0===this.jm&&(s={sheet:this,sheetName:this.name(),row:t,col:n,sheetArea:o,propertyName:e,oldValue:i,newValue:a,isUndo:this.OIb},this.Wq(r.Events.CellChanged,s),this._modelManager.ZVa(["cellChanged",e,t,n,o,a,i]))},e.prototype.xu=function(e,t,n,o){this.Wq(r.Events.ValueChanged,{sheet:this,sheetName:this.name(),row:e,col:t,oldValue:n,newValue:o})},e.prototype.qCb=function(e,t,n,o,i){var a;0===this.jm&&(a={sheet:this,sheetName:this.name(),col:e,sheetArea:t,propertyName:n,newValue:o,oldValue:i},"addColumns"!==n&&"deleteColums"!==n||(a.count=o),this.Wq(r.Events.ColumnChanging,a),this._modelManager.ZVa(["columnChanging",e,t,n,i,o]))},e.prototype.pq=function(e,t,n,o,i){var a;0===this.jm&&(a={sheet:this,sheetName:this.name(),col:e,sheetArea:t,propertyName:n,newValue:o,oldValue:i,isUndo:this.OIb},"addColumns"!==n&&"deleteColumns"!==n||(a.count=o),this.Wq(r.Events.ColumnChanged,a),this._modelManager.ZVa(["columnChanged",e,t,n,i,o]))},e.prototype.RIb=function(e,t,n,o){var i,a,s,l=[];if(this.tables){for(i=this.tables.pJb(e,t,n,o),a=0;a<i.length;a++)l.push(i[a].name());l.length>0&&(s={isUndo:this.OIb,sheet:this,sheetName:this.name(),row:e,col:n,rowCount:t,colCount:o,tableNames:l,action:2},this.Wq(r.Events.RangeChanged,s),this._modelManager.ZVa(["rangeChanged",e,t,n,o]))}},e.prototype.pCb=function(e,t,n,o,i){var a;0===this.jm&&(a={sheet:this,sheetName:this.name(),row:e,sheetArea:t,propertyName:n,newValue:o,oldValue:i},"addRows"!==n&&"deleteRows"!==n||(a.count=o),this.Wq(r.Events.RowChanging,a),this._modelManager.ZVa(["rowChanging",e,t,n,i,o]))},e.prototype.kq=function(e,t,n,o,i){var a;0===this.jm&&(a={sheet:this,sheetName:this.name(),row:e,sheetArea:t,propertyName:n,newValue:o,oldValue:i,isUndo:this.OIb},"addRows"!==n&&"deleteRows"!==n||(a.count=o),this.Wq(r.Events.RowChanged,a),this._modelManager.ZVa(["rowChanged",e,t,n,i,o]))},e.prototype.gyb=function(e,t){t!==e&&(this.Wq(r.Events.ViewZoomed,{sheet:this,sheetName:this.name(),oldZoomFactor:e,newZoomFactor:t}),this.Wq(r.Events.UserZooming,{sheet:this,sheetName:this.name(),oldZoomFactor:e,newZoomFactor:t}))},e.prototype.yu=function(e,t){return!(this.n_a||!this._eventHandler.zu(e,t)||(this.Wq(r.Events.SelectionChanging,{sheet:this,sheetName:this.name(),oldSelections:e,newSelections:t}),0))},e.prototype.Au=function(e){this.Wq(r.Events.SelectionChanged,{sheet:this,sheetName:this.name(),oldSelections:e,newSelections:this.getSelections()})},e.prototype.Bu=function(e,t,n,o,i,a,s,l,u,c){var f={sheet:this,sheetName:this.name(),row:e,col:t,rowCount:n,colCount:o,changedCells:i,action:a},h={sheet:this,sheetName:this.name(),row:e,col:t,rowCount:n,colCount:o,changedCells:i,isUndo:!!c,action:a};s&&(f.sheetArea=s,h.sheetArea=s),l&&(f.value=l),i&&i.length>0&&(u&&u.length>0&&(h.tableNames=u),this.Wq(r.Events.RangeChanged,h),this.Wq(r.Events.FormulatextboxRangeChanged,f))},e.prototype._raiseEditorStatusChanged=function(e,t){var n={sheet:this,sheetName:this.name(),oldStatus:e,newStatus:t};this.Wq(r.Events.EditorStatusChanged,n)},e.prototype.Du=function(){return this.b4||(this.b4=u.GC$(A("input"))),this.b4},e.prototype.bind=function(e,t,n){this.Du().bind(e+ee,t,n)},e.prototype.unbind=function(e,t){this.Du().unbind(e+ee,t)},e.prototype.Wq=function(e,t,n){this.updateEventsData&&this.updateEventsData(e,t),(0===this.jm||n)&&this.Du().trigger(e,t)},e.prototype.unbindAll=function(){this.unbind(ee)},e.prototype._bind=function(e,t,n){e.indexOf(".")>=0?this.bind(e,t,n):this.bind(e+te,t,n)},e.prototype._unbind=function(e,t){e.indexOf(".")>=0?this.unbind(e,t):this.unbind(e+te,t)},e.prototype.nu=function(){this.unbind(te)},e.prototype.Dr=function(){var e=this.Zs;return new r.Rect(e.x,e.y,e.width,e.height)},e.prototype.Us=function(e){this.Zs=new r.Rect(e.x,e.y,e.width,e.height)},e.prototype.scroll=function(e,t){var n,o,r,i,a,s,l,u,c,f,h,p=this,d=p.parent;d&&(o=(n=d.options).scrollByPixel,r=n.scrollPixel,i=d.ku,a=n.scrollbarShowMax,s=n.showHorizontalScrollbar,l=n.showVerticalScrollbar,0!==t&&(c=(u=i._Bb(p,Math.round(t)/r)).dj,f=o?u.UP:0,c===p.qq&&f===p.eCb||(i.lu(c,f),s&&(p.qs(),a||(p.oq=!0)))),0!==e&&(c=(h=i.aCb(p,Math.round(e)/r)).cj,f=o?h.UP:0,c===p.lq&&f===p.cCb||(i.ju(c,f),l&&(p.os(),a||(p.jq=!0)))))},e.prototype.isCtrlPressed=function(e){return this._eventHandler&&this._eventHandler.ctrl},e.prototype.deselectIgnoreSpan=function(){return!1},e.Np=1,e.Qp=ae,e.Rp=200,e.Sp=20,e.Tp=1,e.Vp=1,e}(),t.Worksheet=se,r.Zn(se),(le=se.prototype).visible=M("visible",!0,(function(e){var t,n=this,o=n.parent,r=o.sheets,i=r.length,a=u.GC$.inArray(n,r),s=o.getActiveSheetIndex();if(e)s<0?(o.dq(a,1),o.hq&&o.hq.gq<0&&(o.hq.gq=a)):o.aq();else if(a===s){for(t=a+1;t<i&&!r[t].visible();)t++;if(t>=i)for(t=a-1;t>=0&&!r[t].visible();)t--;o.hq&&t<o.hq.gq&&(o.hq.gq=t),t<0?(n.no(!1),o.eq=t,o.fq()):o.dq(t,1)}else o.aq()})),le.frozenColumnCount=M("frozenColumnCount",0,(function(e){var t=this;t.qq<e?t.qq=e:""!==e&&0!==e&&null!==e||(t.qq=0),t.oq=!0,t.$p()}),(function(e){return e>=0})),le.frozenRowCount=M("frozenRowCount",0,(function(e){var t=this;t.lq<e?t.lq=e:""!==e&&0!==e&&null!==e||(t.lq=0),t.jq=!0,t.$p()}),(function(e){return e>=0})),le.frozenTrailingRowCount=M("frozenTrailingRowCount",0,(function(){this.jq=!0,this.$p()}),(function(e){return e>=0})),le.frozenTrailingColumnCount=M("frozenTrailingColumnCount",0,(function(){this.oq=!0,this.$p()}),(function(e){return e>=0}))},"./dist/plugins/celltype/buttoncelltype.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function C(e,t,n,o){var r,i=e._modelManager;i&&(i.do("setValueForKey",t,n,d,p,o),(r=i.getValueForKey(t,n,g,o))&&(clearTimeout(r),i.do("setValueForKey",t,n,g,p,o)))}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("Core"),i=r.Events.SelectionChanged,a=o.Common.j.Fa,s=r.Ul.nl,l=r.CellTypes.Context,u=r.CellTypes.Text,c=r.CellTypes.Base,f=r.GC$,h=f.each,p=void 0,d="_isFirstMouseUp",g="_mouseupToken",m=".buttonCellType",y={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,text:"",buttonBackColor:null,buttonState:0},v=function(e){function t(){var t,n=e.call(this)||this;return n.typeName="6",t=n,h(y,(function(e,n){t["_"+e]=n})),n}return b(t,e),t.prototype.paintValue=function(e,t,n,o,i,a,s,l){var c,f,h,p,d,g,m,y,v,b,C;e&&(f=(c=this)._marginLeft,h=c._marginTop,p=n+f,d=o+h,g=i-f-c._marginRight,m=a-h-c._marginBottom,g-2>0&&m-2>0&&(p+g>n&&p<n+i&&d+m>o&&d<o+a)&&(e.save(),(p<n||p+g>n+i||d<o||d+m>o+a)&&(e.rect(n,o,i,a),e.clip()),e.beginPath(),y="#707070",e.strokeStyle!==y&&(e.strokeStyle=y),e.strokeRect(p+.5,d+.5,g-1,m-1),v=void 0,b=c._buttonState,C=c._text,2===b?v="#34B4E3":(v=c._buttonBackColor)||(v={degree:90,stops:[{position:0,color:"#F6FAFB"},{position:.125,color:"#F6FAFB"},{position:1,color:"#D2DBEB"}]}),e.fillStyle!==v&&(e.fillStyle=v),r.To.setFillStyle(e,v,n,o,i,a,(function(){e.fillRect(p+1,d+1,g-2,m-2)})),e.restore(),C&&u.prototype.paintValue.call(c,e,C,p,d,g,m,s,l)))},t.prototype.getText=function(e,t){return e},t.prototype.tw=function(e,t,n,o){var r=e.parent;r&&r.tw(e,t,n,o)},t.prototype.getHitInfo=function(e,t,n,o,r){var i,s,l,u,c,f,h=this;return r&&(i=r.sheetArea,(a(i)||3===i)&&o)?(s=o.x+h._marginLeft,l=o.x+o.width-h._marginRight,u=o.y+h._marginTop,c=o.y+o.height-h._marginBottom,f={x:e,y:t,row:r.row,col:r.col,cellRect:o,sheetArea:i,sheet:r.sheet,cellStyle:n},s<=e&&e<=l&&u<=t&&t<=c&&(f.isReservedLocation=!0),f):null},t.prototype.processMouseDown=function(e){var t=this,n=e&&e.sheet;return!(!n||!e.isReservedLocation||t.uK||(t.uK=!0,t._buttonState=2,n.repaint(e.cellRect),0))},t.prototype.processMouseUp=function(e){var t,n,o,r,i=this,a=e&&e.sheet;if(i.uK&&a&&e.isReservedLocation){if(i._buttonState=0,a.repaint(e.cellRect),i.uK=!1,t=e.row,n=e.col,o=e.sheetArea,!a._modelManager.getValueForKey(t,n,d,o))return i.tw(a,t,n,o),a._modelManager.do("setValueForKey",t,n,d,!0,o),r=setTimeout((function(){C(a,t,n,o)}),250),a._modelManager.do("setValueForKey",t,n,g,r,o),!0;C(a,t,n,o)}return!1},t.prototype.processMouseLeave=function(e){var t=this,n=e&&e.sheet;n&&t.uK&&(t._buttonState=0,n.repaint(e.cellRect),t.uK=!1)},t.prototype.processKeyDown=function(e,t){var n,o=t.sheet,r=this;return!(!o||r.vK||(n=o.getCellRect(t.row,t.col),r._buttonState=2,o.repaint(n),o._bind(i+m,(function(){o._unbind(i+m),r.vK=!1,r._buttonState=0,o.repaint(n)})),r.vK=!0,0))},t.prototype.processKeyUp=function(e,t){var n,o,r,a=t.sheet,s=this;return!(!a||!s.vK||(n=t.row,o=t.col,r=a.getCellRect(n,o),s._buttonState=0,a.repaint(r),a._unbind(i+m),s.tw(a,n,o,t.sheetArea),s.vK=!1,0))},t.prototype.isReservedKey=function(e,t){return 32===e.keyCode&&!e.ctrlKey&&!e.shiftKey&&!e.altKey},t.prototype.getAutoFitWidth=function(e,t,n,o,r){var i=this;return l.cp(e,i._text,n,o,r)+i._marginLeft+i._marginRight},t.prototype.getAutoFitHeight=function(e,t,n,o,r){var i=this;return l.ep(e,i._text,n,o,r)+i._marginTop+i._marginBottom},t.prototype.JH=function(e){this.isReservedKey(e)&&s(e)},t.prototype.isImeAware=function(e){return!1},t.prototype.toJSON=function(){var e,t=this,n={typeName:t.typeName};return h(y,(function(o,r){"buttonState"!==o&&((e=t["_"+o])!==r&&(n[o]=e))})),n},t.prototype.fromJSON=function(e){var t=this;h(y,(function(n){var o=e[n];a(o)||(t["_"+n]=o)}))},t.prototype._createCellTypeElement=function(e){},t.prototype.gQa=function(){},t}(c),t.Button=v,h(y,(function(e){v.prototype[e]=function(t){return 0===arguments.length?this["_"+e]:(this["_"+e]=t,this)}})),r.CellTypes._o[6]=v},"./dist/plugins/celltype/cellbuttons.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E;function D(e){switch(e){case A:return o.ButtonPosition.left;case M:return o.ButtonPosition.right;case S:return o.ButtonPosition.leftOfText;case T:return o.ButtonPosition.rightOfText}}function j(e){switch(e){case o.ButtonPosition.left:return A;case o.ButtonPosition.right:return M;case o.ButtonPosition.leftOfText:return S;case o.ButtonPosition.rightOfText:return T}}function _(e){var t,n,o=e.split(" ");for(n=0;n<o.length;n++)if(o[n].indexOf(v)>=0){t=o[n];break}switch(t){case b:return A;case C:return M;case w:return S;case x:return T}}function O(e){switch(e){case A:return b;case M:return C;case S:return w;case T:return x}}function F(e,t,n,o){var r,i=e._modelManager;i&&(i.do("setValueForKey",t,n,h,s,o),(r=i.getValueForKey(t,n,p,o))&&(clearTimeout(r),i.do("setValueForKey",t,n,p,s,o)))}function P(e,t,n){var r,i;switch(n){case k.topLeft:return new o.Rect(e.x,e.y,Math.min(t.width,e.width),Math.min(t.height,e.height));case k.topCenter:return r=(e.width-t.width)/2,r=Math.max(0,r),new o.Rect(e.x+r,e.y,Math.min(t.width,e.width),Math.min(t.height,e.height));case k.topRight:return r=e.width-t.width,r=Math.max(0,r),new o.Rect(e.x+r,e.y,Math.min(t.width,e.width),Math.min(t.height,e.height));case k.MiddleLeft:return i=(e.height-t.height)/2,i=Math.max(0,i),new o.Rect(e.x,e.y+i,Math.min(t.width,e.width),Math.min(t.height,e.height));case k.MiddleCenter:return r=(e.width-t.width)/2,r=Math.max(0,r),i=(e.height-t.height)/2,i=Math.max(0,i),new o.Rect(e.x+r,e.y+i,Math.min(t.width,e.width),Math.min(t.height,e.height));case k.MiddleRight:return r=e.width-t.width,r=Math.max(0,r),i=(e.height-t.height)/2,i=Math.max(0,i),new o.Rect(e.x+r,e.y+i,Math.min(t.width,e.width),Math.min(t.height,e.height));case k.bottomLeft:return i=e.height-t.height,i=Math.max(0,i),new o.Rect(e.x,e.y+i,Math.min(t.width,e.width),Math.min(t.height,e.height));case k.bottomCenter:return r=(e.width-t.width)/2,r=Math.max(0,r),i=e.height-t.height,i=Math.max(0,i),new o.Rect(e.x+r,e.y+i,Math.min(t.width,e.width),Math.min(t.height,e.height));case k.bottomRight:return r=e.width-t.width,r=Math.max(0,r),i=e.height-t.height,i=Math.max(0,i),new o.Rect(e.x+r,e.y+i,Math.min(t.width,e.width),Math.min(t.height,e.height))}}function H(e,t,n){var o,r=[];for(o=0;o<e.length;o++)r.push({width:X(e[o].button,t,n),height:ee(e[o].button,n)});return r}function B(e,t,n,o,r,a){var s,l,u,c,f=[],h=[];for(s=0;s<e.length;s++)l=t[e[s].index],i(l)?h.push(e[s]):f.push(l);for(u=V(f),s=0;s<h.length;s++)c=X(h[s].button,n,o),(!a||u.width+c<=a.width)&&(u.width+=c);return u.height=u.height?u.height:a?a.height:0,u}function L(e,t,n,r,s,l,u,c,f,h,p,d){var g,m,y,v,S,T,N,I,R,k=te(t,n,u,c,!0,[e]);if(k.length>0){switch(J(k,t),e){case o.ButtonPosition.left:g=b;break;case o.ButtonPosition.right:g=C;break;case o.ButtonPosition.leftOfText:g=w;break;case o.ButtonPosition.rightOfText:g=x;break;default:return}switch(m=B(k,h,s,r,0,l),y="0",v=a(),(o.Ul.Ml.mozilla||v>1)&&(y="1px"),S=m.width,T=m.height,N=j(e),i(f.canvasSizes)&&(f.canvasSizes={}),(I=f.canvasSizes)[N]={width:S,height:T},R=z(g,S,T,{width:S+"px",height:T+"px",display:"block",position:"absolute",bottom:y,overflow:"hidden",paddingTop:"0"}),e){case o.ButtonPosition.left:R.style.left="0";break;case o.ButtonPosition.right:R.style.right="0";break;case o.ButtonPosition.leftOfText:R.style.left=I[A].width+"px";break;case o.ButtonPosition.rightOfText:R.style.right=I[M].width+"px";break;default:return}p.appendChild(R)}}function z(e,t,n,o){var r,i=document.createElement("canvas");for(r in i.className=e+" "+y,o)o.hasOwnProperty(r)&&(i.style[r]=o[r]);return i.width=t,i.height=n,i}function V(e){var t,n,r,i,a;if(e.length<=0)return new o.Rect(0,0,0,0);for(t=e[0].x,n=e[0].y,r=e[0].x+e[0].width,i=e[0].y+e[0].height,a=1;a<e.length;a++)t=Math.min(t,e[a].x),n=Math.min(n,e[a].y),r=Math.max(r,e[a].x+e[a].width),i=Math.max(i,e[a].y+e[a].height);return new o.Rect(t,n,r-t,i-n)}function G(e,t,n,r,a,s,l,u){var c,f,h,p,d,g;if(!i(e))for(i(u[n])&&(u[n]={}),J(t,r.sheet),c=e.getContext("2d"),f=B(t,l,a,r),c.setTransform(parseFloat(e.style.width)/f.width,0,0,parseFloat(e.style.height)/f.height,0,0),h=0,0,p=new o.Rect(0,0,parseFloat(e.style.width),parseFloat(e.style.height)),d=0;d<t.length&&(g=Y(c,h,0,X(t[d].button,a,r),r.sheet.getRowHeight(r.row),t[d].button,a,r,s,u[n],t[d].index,p),!i(g));d++)h+=g.width}function W(e,t,n,r,a,s,l,u,c,f,h,p){var d,g,m,y,v,N,I,R=te(t,n,l,u,!0,[e]);if(R.length>0){switch(d=void 0,g=void 0,e){case o.ButtonPosition.left:d=b,g=A;break;case o.ButtonPosition.right:d=C,g=M;break;case o.ButtonPosition.leftOfText:d=w,g=S;break;case o.ButtonPosition.rightOfText:d=x,g=T;break;default:return}if(m=p.querySelector("."+d),i(m))return;switch(y=parseFloat(m.style.width),v=s.options.contentRect,N=s.options.leftExternalRect,I=s.options.rightExternalRect,e){case o.ButtonPosition.left:v.x+=y,v.width-=y;break;case o.ButtonPosition.right:v.width-=y;break;case o.ButtonPosition.leftOfText:N.width+=y;break;case o.ButtonPosition.rightOfText:I.width+=y}G(m,R,g,r,a,c,f,h),function(e,t,n,o,r,a){var s,l,u,c,f;i(a.eventListeners)&&(a.eventListeners={}),i(a.eventListeners[t])&&(a.eventListeners[t]={}),l=(s=a.eventListeners[t]).mouseDownListener=function(i){ae(ie({x:i.offsetX,y:i.offsetY,context:n,cellRect:r,cellStyle:o,buttonArea:t},!0),!0,e)},e.addEventListener("mousedown",l),u=s.mouseUpListener=function(i){se(ie({x:i.offsetX,y:i.offsetY,context:n,cellRect:r,cellStyle:o,buttonArea:t},!0),!0,e)},e.addEventListener("mouseup",u),c=s.mouseMoveListener=function(i){le(ie({x:i.offsetX,y:i.offsetY,context:n,cellRect:r,cellStyle:o,buttonArea:t},!0),!0,e)},e.addEventListener("mousemove",c),f=s.mouseLeaveListener=function(i){var a={x:i.offsetX,y:i.offsetY,context:n,cellRect:r,cellStyle:o,buttonArea:t};a.x<0&&(a.x=0),a.x>=parseFloat(e.style.width)&&(a.x=parseFloat(e.style.width)-1),ue(ie(a,!0),!0,e)},e.addEventListener("mouseleave",f)}(m,g,r,a,s.options.cellRect,c)}}function U(e,t,n,r,i,a,s){var l,u,c,f,h,p,d=te(t,n,r,i,!0,[e]);if(d&&d.length>0)switch(l=j(e),u=a[l]&&a[l].width||0,c=s.contentContainer,f=s.contentRect,h=s.leftExternalRect,p=s.rightExternalRect,e){case o.ButtonPosition.left:Z(c,"left",u),f.x+=u,f.width-=u;break;case o.ButtonPosition.leftOfText:Z(c,"left",u),h.width+=u;break;case o.ButtonPosition.right:f.width-=u;break;case o.ButtonPosition.rightOfText:p.width+=u;break;default:return}}function Z(e,t,n){var o=0;e.style[t]&&(o=function(e){return+e.replace("px","")||0}(e.style[t])),o+=n,e.style[t]=o-1+"px"}function q(e,t){i(t.mouseDownListener)||e.removeEventListener("mousedown",t.mouseDownListener),i(t.mouseUpListener)||e.removeEventListener("mouseup",t.mouseUpListener),i(t.mouseMoveListener)||e.removeEventListener("mousemove",t.mouseMoveListener),i(t.mouseLeaveListener)||e.removeEventListener("mouseleave",t.mouseLeaveListener)}function J(e,t){var n,o,r=t.vu();for(n=0;n<e.length;n++)(o=pe(e[n].button))&&r.fo(o)}function Q(e,t,n,r,a,s,l){var u,c,f,h,p,d,g;if(e&&!(t.length<=0)){if(a=fe(a),J(t,u=s.sheet),c=function(e,t,n){switch(n){case o.ButtonPosition.leftOfText:return new o.Rect(e.x,e.y,t.x-e.x,e.height);case o.ButtonPosition.rightOfText:return new o.Rect(t.x+t.width,e.y,e.x+e.width-t.x-t.width,e.height)}}(n,r,l?o.ButtonPosition.leftOfText:o.ButtonPosition.rightOfText),e.save(),e.rect(c.x,c.y,c.width,c.height),e.clip(),e.beginPath(),f=re(u,s.row,s.col,s.sheetArea),h=fe(a),i(f.layout)&&(f.layout={}),l)for(p=c.x+c.width,d=t.length-1;d>=0&&(g=Y(e,p-=X(t[d].button,h,s),n.y,X(t[d].button,h,s),c.height,t[d].button,h,s,f,f.layout,t[d].index,n),!i(g));d--);else for(p=c.x,d=0;d<t.length&&(g=Y(e,p,n.y,X(t[d].button,h,s),c.height,t[d].button,h,s,f,f.layout,t[d].index,n),!i(g));d++)p+=g.width;e.restore()}}function Y(e,t,n,r,a,s,l,u,c,f,h,p){var d,g=0;if(c.buttonDownIndex===h?g=2:c.buttonHoverIndex===h&&(g=3),d=function(e,t,n,r,i){if(!(e+n<i.x||e>i.x+i.width||t+r<i.y||t>i.y+i.height))return e+n>i.x+i.width&&(n=i.x+i.width-e),t+r>i.y+i.height&&(r=i.y+i.height-t),e<i.x&&(e=i.x),t<i.y&&(t=i.y),new o.Rect(e,t,n,r)}(t,n,r,a,p),!i(d))return K(e,d.x,d.y,d.width,d.height,s,l,u,g,p),f[h]=new o.Rect(d.x,d.y,d.width,d.height),f[h]}function K(e,t,n,r,a,u,c,h,p,d){var y,v,b,C,w,x,A,M,S,T,N,I,R,E,D,j,_,O,F;e.save(),e.beginPath(),y=u.useButtonStyle,v=h.sheet.zoom(),t+=b=y?2*v:0,n+=b,r-=2*b,a-=2*b,C="#707070",e.strokeStyle!==C&&(e.strokeStyle=C),y&&e.strokeRect(t+.5,n+.5,r-1,a-1),u.buttonBackColor?w=u.buttonBackColor:y?!1===u.enabled?w="#e6e6e6":2===p?w="#34B4E3":3===p||h.visualState===o.VisualState.hover?w=f:((x=e.createLinearGradient(t+r/2,n,t+r/2,n+a)).addColorStop(.125,"#F6FAFB"),x.addColorStop(1,"#D2DBEB"),w=x):(w="white",3===p&&(u.enabled||i(u.enabled))&&(w=f)),(A=c.font)&&e.font!==A&&(e.font=A),e.fillStyle!==w&&(e.fillStyle=w),t+=1,n+=1,r-=2,a-=2,e.rect(t,n,r,a),e.clip(),e.beginPath(),e.fillRect(t,n,r,a),M=new o.Rect(t,n,r,a),S=new o.Rect(t,n,r,a),T=0*v,N=pe(u),u.caption&&N&&(I=(m.cp(l,u.caption,c,v,h)+4)*v,R=ne(u)*v,E=new o.Rect(0,0,I+R+T,a),D=P(new o.Rect(t,n,r,a),E,k.MiddleCenter),u.captionAlign===o.CaptionAlignment.left?(S=new o.Rect(D.x,n,I,a),M=D.x+I+T<t+r-2?new o.Rect(D.x+I+T,n,Math.max(0,R),a):new o.Rect(0,0,0,0)):(M=new o.Rect(D.x,n,Math.min(R,r),a),S=D.x+R+T<t+r-2?new o.Rect(D.x+R+T,n,Math.min(r-2-R-T,I),a):new o.Rect(0,0,0,0))),u.caption&&(j=(m.cp(l,u.caption,c,v,h)+4)*v,_=(m.ep(l,u.caption,c,v,h)+4)*v,O=P(S,new o.Rect(0,0,j,_),k.MiddleCenter),F=new g,c=c.clone(),!1===u.enabled&&(c.foreColor="#CACACA"),c.cellButtons=s,F.paintValue(e,u.caption,O.x,O.y-2,O.width,O.height,c,h)),N&&$(e,u,M.x,M.y,M.width,M.height,N,h,d),e.restore()}function $(e,t,n,r,i,a,s,l,u){var c,f,h,p,d,g,m,y,v,b,C;e.save(),e.rect(n+2,r+2,i-4,a-4),e.clip(),e.beginPath(),(c=l.sheet.vu()).ko(s)?c.bgc(s)&&(f=l.sheet.zoom(),h=new o.Rect(n,r,i,a),p=ne(t)-2,d=oe(t)-2,g=P(h,new o.Rect(0,0,p*f,d*f),k.MiddleCenter),y=(m=c.lo(s)).width,v=m.height,o.Ul.Ml.msie&&t.imageType&&(t.imageType===o.ButtonImageType.custom?(I[s]||(m.style.position="absolute",m.style.left="-10000px",m.style.top="-100000px",document.body.appendChild(m),I[s]={width:m.width,height:m.height},document.body.removeChild(m)),y=I[s].width,v=I[s].height):(y=12,v=12)),u&&o.Ul.Ml.msie&&g.x+g.width>u.x+u.width?(b=u.x+u.width-g.x)>0&&(C=y/(p*f),e.drawImage(m,0,0,b*C,v,g.x,g.y,b,d*f)):e.drawImage(m,0,0,y,v,g.x,g.y,p*f,d*f)):c.fo(s),e.restore()}function X(e,t,n,o){var r,a,s,c,f;return void 0===o&&(o=!0),r=n.sheet.zoom(),a=7,i(e.width)?(s=m.cp(l,e.caption,t,r,n),c=e.useButtonStyle,pe(e)&&(s=ne(e)+s,a=(c?a:0)+0),o?(s+a+7)*r:s+a+7):(f=u(1,e.width),isNaN(f)&&(f=1),o?f*r:f)}function ee(e,t,n){var o,r,i,a;return void 0===n&&(n=!0),o=t.sheet.zoom(),r=t.sheet.getRowHeight(t.row),i=e.imageSize?e.imageSize.height:l,a=u(1,i||r),isNaN(a)&&(a=1),n?a*o:a}function te(e,t,n,r,a,s){var l,u,c,f,h=[];if(!t||0===t.length)return[];for(l=!1,u=e._modelManager.getValueForKey(n,r,d),e.getActiveRowIndex()===n&&e.getActiveColumnIndex()===r&&!0!==u&&(l=!0),c=0;c<t.length;c++)for(f=0;f<s.length;f++)(t[c].position===s[f]||i(t[c].position)&&s[f]===o.ButtonPosition.right)&&(t[c].visibility===o.ButtonVisibility.onEditing&&a||t[c].visibility!==o.ButtonVisibility.onEditing&&l||t[c].visibility===o.ButtonVisibility.always||i(t[c].visibility))&&h.push({index:c,button:t[c]});return h}function ne(e){var t;return e.imageSize&&("string"==typeof e.imageSize.width&&(t=c(e.imageSize.width)),"number"==typeof e.imageSize.width&&(t=e.imageSize.width)),(t===l||isNaN(t)||t<0)&&(t=16),t}function oe(e){var t;return e.imageSize&&("string"==typeof e.imageSize.height&&(t=c(e.imageSize.height)),"number"==typeof e.imageSize.height&&(t=e.imageSize.height)),(t===l||isNaN(t)||t<0)&&(t=16),t}function re(e,t,n,r,i){var a,s={isMouseDownReservedLocation:!1};return r===o.SheetArea.corner?s:((a=e._modelManager.getValueForKey(t,n,N,r))||i||function(e,t,n,o,r){e._modelManager.setValueForKey(t,n,N,r,o)}(e,t,n,r,a=s),a)}function ie(e,t){var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w;if(void 0===t&&(t=!1),n=e.context.row,r=e.context.col,i=e.cellRect,a=e.cellStyle,s=e.context,u=(l={x:e.x,y:e.y,row:n,col:r,cellRect:i,cellStyle:a,sheetArea:e.context.sheetArea,sheet:e.context.sheet,context:s}).sheet,!1!==e.cellStyle.locked&&u.options.isProtected)return null;if(c=re(u,l.row,l.col,l.sheetArea,!0),f=e.cellStyle.cellButtons,!c||!f||f.length<=0)return null;if(h=c.layout,t&&(h=c.editorLayout[e.buttonArea]),!h)return null;for(m in p=-1,d=l.x,g=l.y,h)if(h.hasOwnProperty(m)&&h[m].contains(d,g)){p=+m;break}return-1!==p?l.cellButtonHitInfo={hitButtonIndex:p,buttonConfig:f[p],buttonArea:e.buttonArea}:(y=u.getCellType(l.row,l.col))&&(v=B(te(u,f,n,r,t,[o.ButtonPosition.left]),h,a,s),b=B(te(u,f,n,r,t,[o.ButtonPosition.right]),h,a,s),C=new o.Rect(i.x+v.width,i.y,i.width-v.width-b.width,i.height),(w=y.getHitInfo(l.x,l.y,a,C,s))&&w.isReservedLocation&&(l.isReservedLocation=!0)),l}function ae(e,t,n){var r,a,s,u,c,f,h,p,d,g,m,y,v,b;return void 0===t&&(t=!1),!(!e||!e.cellButtonHitInfo)&&(r=e.sheet,a=e.row,s=e.col,u=e.sheetArea,a===r.Jl&&s===r.Kl||u!==o.SheetArea.viewport||r.endEdit()?(c=re(r,a,s,e.sheetArea),e.cellButtonHitInfo&&(h=e.cellButtonHitInfo.hitButtonIndex,f=e.cellButtonHitInfo.buttonConfig),!!(r&&!c.isMouseDownReservedLocation&&f&&(f.enabled||i(f.enabled))&&h>=0)&&(c.buttonDownIndex=h,c.isMouseDownReservedLocation=!0,h>=0&&f.command&&(p=f.command,t||r.getActiveRowIndex()===a&&r.getActiveColumnIndex()===s||r.DJ(a,s,1,1,2),"string"==typeof p?r.getParent().commandManager().execute({cmd:p,row:a,col:s,sheetName:r.name(),sheetArea:e.sheetArea}):"function"==typeof p&&p.call(l,r,a,s,e.sheetArea)),t&&n?(d=e.cellStyle,g=c.layout,m=e.context,y=c.editorLayout,v=e.cellButtonHitInfo&&e.cellButtonHitInfo.buttonArea,b=d.cellButtons,v&&G(n,te(r,b,a,s,!0,[D(v)]),v,m,d,c,g,y)):r.repaint(e.cellRect),!0)):void 0)}function se(e,t,n){var o,r,i,a,s,l,u,c,f,d,g,m;if(void 0===t&&(t=!1),e){if(o=e&&e.sheet,r=e.row,i=e.col,(a=re(o,e.row,e.col,e.sheetArea)).isMouseDownReservedLocation&&o){if(t&&a.buttonDownIndex>=0&&n&&(a.buttonDownIndex=-1,s=e.cellStyle,l=a.layout,u=e.context,c=a.editorLayout,f=e.cellButtonHitInfo&&e.cellButtonHitInfo.buttonArea,d=s.cellButtons,f&&G(n,te(o,d,r,i,!0,[D(f)]),f,u,s,a,l,c)),a.buttonDownIndex=-1,t||o.repaint(e.cellRect),a.isMouseDownReservedLocation=!1,g=e.sheetArea,!o._modelManager.getValueForKey(r,i,h,g))return function(e,t,n,o){var r=e.parent;r&&r.tw(e,t,n,o)}(o,r,i,g),o._modelManager.do("setValueForKey",r,i,h,!0,g),m=setTimeout((function(){F(o,r,i,g)}),250),o._modelManager.do("setValueForKey",r,i,p,m,g),!0;F(o,r,i,g)}return!1}}function le(e,t,n){var o,r,i,a,s,l,u,c,f,h;if(void 0===t&&(t=!1),e)return r=re(o=e&&e.sheet,e.row,e.col,e.sheetArea),i=-1,e.cellButtonHitInfo&&(i=e.cellButtonHitInfo.hitButtonIndex),i!==r.buttonHoverIndex?(r.buttonHoverIndex=i,t?(a=e.cellStyle,s=r.layout,l=e.context,u=r.editorLayout,c=a.cellButtons,f=e.row,h=e.col,n&&ce(c,o,f,h,n.parentElement,l,a,r,s,u)):o.repaint(e.cellRect),!0):void 0}function ue(e,t,n){var o,r,i,a,s,l,u,c,f;void 0===t&&(t=!1),e&&e.cellButtonHitInfo&&(r=re(o=e&&e.sheet,e.row,e.col,e.sheetArea),t?(r.buttonHoverIndex=-1,e.cellButtonHitInfo.hitButtonIndex>=0&&(i=e.cellStyle,a=r.layout,s=e.context,l=r.editorLayout,u=i.cellButtons,c=e.row,f=e.col,n&&ce(u,o,c,f,n.parentElement,s,i,r,a,l))):(o&&(r.buttonHoverIndex=-1),o.repaint(e.cellRect)))}function ce(e,t,n,o,r,i,a,s,l,u){var c,f;for(c=0;c<R.length;c++)f=j(R[c]),G(r.querySelector("."+O(f)),te(t,e,n,o,!0,[D(f)]),f,i,a,s,l,u)}function fe(e){var t=e.clone();return t.hAlign=o.HorizontalAlign.left,t.vAlign=o.VerticalAlign.center,t.wordWrap=!1,t.isVerticalText=!1,t.shrinkToFit=!1,t.formatter="General",t.textIndent=0,t}function he(e,t,n,o,r){var i,a=e.AHb(t,n,r);if(a&&a.cellButtons&&a.cellButtons.length>0&&a.cellButtons.filter((function(e){return 1===e.visibility})).length>0){o&&e._modelManager.do("setValueForKey",t,n,d,!0,r);try{i=e.getCellRect(t,n,1===r?-1:void 0,2===r?-1:void 0),e.repaint(i)}finally{o&&e._modelManager.do("setValueForKey",t,n,d,s,r)}}}function pe(e){var t,n=null,r=e.imageType;if(i(e.imageType))return null;switch(t=e.enabled||i(e.enabled),r){case o.ButtonImageType.dropdown:n=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case o.ButtonImageType.left:n=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case o.ButtonImageType.right:n=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case o.ButtonImageType.clear:n=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case 3:n=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case o.ButtonImageType.ok:n=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case o.ButtonImageType.plus:n=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiM2RTZFNkUiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiNDQUNBQ0EiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case o.ButtonImageType.minus:n=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiM2RTZFNkUiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiNDQUNBQ0EiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+";break;case o.ButtonImageType.redo:n=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case o.ButtonImageType.undo:n=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case o.ButtonImageType.search:n=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case o.ButtonImageType.separator:n=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case o.ButtonImageType.spinLeft:n=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case o.ButtonImageType.spinRight:n=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iIzZFNkU2RSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iI0NBQ0FDQSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case o.ButtonImageType.ellipsis:n=t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case o.ButtonImageType.expand:n=t?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==";break;case o.ButtonImageType.collapse:n=t?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=":"data:image/svg+xml;PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=";break;case o.ButtonImageType.custom:n=e.imageSrc}return n}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("@grapecity/js-sheets-common"),i=r.Common.j.Fa,o.To.No,o.Ul.fp,a=o.En.npb,s=void 0,l=null,u=Math.max,c=parseInt,f="lightgray",h="_isFirstMouseUp",p="_mouseupToken",d="_leaveCell",g=o.CellTypes.Base,m=o.CellTypes.Context,y="gc-cell-button-canvas",b=(v="gc-editor-")+"left-cellbuttons",C=v+"right-cellbuttons",w=v+"left-of-text-cellbuttons",x=v+"right-of-text-cellbuttons",A="leftButtonArea",M="rightButtonArea",S="leftOfTextButtonArea",T="rightOfTextButtonArea",N="_cellButtonParam",I={},o.GC$,R=[o.ButtonPosition.left,o.ButtonPosition.right,o.ButtonPosition.leftOfText,o.ButtonPosition.rightOfText],function(e){e[e.topLeft=0]="topLeft",e[e.topCenter=1]="topCenter",e[e.topRight=2]="topRight",e[e.MiddleLeft=3]="MiddleLeft",e[e.MiddleCenter=4]="MiddleCenter",e[e.MiddleRight=5]="MiddleRight",e[e.bottomLeft=6]="bottomLeft",e[e.bottomCenter=7]="bottomCenter",e[e.bottomRight=8]="bottomRight"}(k||(k={})),o.CellTypes.Base.$n("cellButton",{beforePaintLabel:function(e){var t,n,r,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C=e.options.context,w=e.options.style;if(!C.cellOverflowLayout&&w.cellButtons&&w.cellButtons.length>0&&(t=e.options.context.sheet,n=C.row,r=C.col,(a=te(t,w.cellButtons,n,r,!1,[o.ButtonPosition.left,o.ButtonPosition.right]))&&a.length>0)){if(s=fe(w),J(a,t),!(l=e.ctx))return;for(u=e.options.rect,l.save(),l.rect(u.x,u.y,u.width,u.height),l.clip(),l.beginPath(),c=u.x,f=u.x+u.width,h=re(t,C.row,C.col,C.sheetArea),i(h.layout)&&(h.layout={}),p=h.layout,d=te(t,w.cellButtons,n,r,!1,[o.ButtonPosition.left]),g=0;g<d.length&&(m=Y(l,c,u.y,X(d[g].button,s,C),u.height,d[g].button,s,C,h,p,d[g].index,u),!i(m));g++)c+=m.width;for(y=c,c=f,g=(v=te(t,w.cellButtons,n,r,!1,[o.ButtonPosition.right])).length-1;g>=0&&(m=Y(l,c-=b=X(v[g].button,s,C),u.y,b,u.height,v[g].button,s,C,h,p,v[g].index,u),!i(m));g--);l.restore(),u.x=y,u.width=c-y}},beforePaintText:function(e){var t,n,r,i,a=e.context,s=e.style;!a.cellOverflowLayout&&s.cellButtons&&s.cellButtons.length>0&&(t=e.context.sheet,n=a.row,r=a.col,(i=e.externals).left=i.left.concat(H(te(t,s.cellButtons,n,r,!1,[o.ButtonPosition.leftOfText]),s,a)),i.right=i.right.concat(H(te(t,s.cellButtons,n,r,!1,[o.ButtonPosition.rightOfText]),s,a)))},beforeFillTextArea:function(e){var t,n,r,i,a=e.style,s=a.cellButtons;a.cellButtons&&a.cellButtons.length>0&&(t=e.ctx,n=e.availRect,r=e.textRect,Q(t,te((i=e.context).sheet,s,i.row,i.col,!1,[o.ButtonPosition.leftOfText]),n,r,a,i,!0))},afterFillTextArea:function(e){var t,n,r,i,a=e.style,s=a.cellButtons;a.cellButtons&&a.cellButtons.length>0&&(t=e.ctx,n=e.availRect,r=e.textRect,Q(t,te((i=e.context).sheet,s,i.row,i.col,!1,[o.ButtonPosition.rightOfText]),n,r,a,i,!1))},onCreateCellEditor:function(e){var t,n,r,a,s,l,u,c,f,h,p,d,g,m=e.options.dom;if(m&&m.children&&((t=m.children[0])&&t.children&&t.children[0])){if(r=(n=e.context).sheet,a=n.row,s=n.col,l=e.options.cellStyle,i(l)&&(l=r.getActualStyle(a,s)),u=l.cellButtons,i(u)||u&&u.length<=0)return;for(c=e.options.cellRect,f=new o.Rect(c.x,c.y,c.width,c.height),h=re(r,a,s,n.sheetArea),i(h.layout)&&(h.layout={}),p=h.layout,d=!1,g=0;g<u.length;g++)u[g].position!==o.ButtonPosition.leftOfText&&u[g].position!==o.ButtonPosition.rightOfText||(d=!0);for(d&&(t.style.overflow="hidden"),g=0;g<R.length;g++)L(R[g],r,u,n,l,f,a,s,h,p,m)}},onActivateCellEditor:function(e){var t,n,o,r,a,s,l=e.context,u=l.sheet,c=l.row,f=l.col,h=e.options.cellStyle,p=h.cellButtons;if(!(i(p)||p.length<=0))for(t=re(u,c,f,l.sheetArea),i(t.editorLayout)&&(t.editorLayout={}),n=t.layout,o=t.editorLayout,r=fe(h),a=e.options.dom,s=0;s<R.length;s++)W(R[s],u,p,l,r,e,c,f,t,n,o,a)},onDeactivateCellEditor:function(e){var t,n,o,r,a,s,l=e.context,u=l.sheet,c=l.row,f=l.col,h=u.getActualStyle(c,f,l.sheetArea).cellButtons;if(h&&h.length>0)for(n=(t=re(l.sheet,c,f,l.sheetArea)).eventListeners,o=e.options.dom.querySelectorAll("."+y),r=0;r<o.length;r++)s=_((a=o[r]).className),i(s)||i(n)||i(n[s])||(q(a,n[s]),delete t.eventListeners[s])},onUpdateContainer:function(e){var t,n=e.context,o=n.sheet,r=n.row,a=n.col,s=re(n.sheet,r,a,n.sheetArea).canvasSizes,l=e.cellStyle.cellButtons;if(!(i(l)||l.length<=0))for(e.context.preventOverflow=!0,t=0;t<R.length;t++)U(R[t],o,l,r,a,s,e)},getCellButtonHitInfo:function(e){e.paddingHitInfo=ie(e)},processMouseDownOnCellPadding:function(e){ae(e)},processMouseUpOnCellPadding:function(e){se(e)},processMouseMoveOnCellPadding:function(e){le(e)},processMouseLeaveOnCellPadding:function(e){ue(e)},getCellButtonAutoHeight:function(e){var t,n,r=e.context.sheet,i=e.context.row,a=e.context.col,s=e.cellStyle;s.cellButtons&&0!==s.cellButtons.length&&(t=te(r,s.cellButtons,i,a,!1,[o.ButtonPosition.left,o.ButtonPosition.right]),n=0,t.forEach((function(t){var o=m.ep(l,t.button.caption,s,r.zoom(),e.context)-2;pe(t.button)&&(o=u(o,ne(t.button))),n=u(o,n)})),e.value=n+2)},getCellButtonAutoWidth:function(e){var t,n,r=e.context.sheet,i=e.context.row,a=e.context.col,s=e.cellStyle;s.cellButtons&&0!==s.cellButtons.length&&(t=te(r,s.cellButtons,i,a,!1,[o.ButtonPosition.left,o.ButtonPosition.right]),n=0,t.forEach((function(t){n+=X(t.button,s,e.context,!1)})),e.value=n)}}),E="cellButtons",o.Worksheet.$n(E,{setHost:function(){var e=this;e.bind(o.Events.EnterCell+"."+E,(function(t,n){he(e,n.row,n.col,!1,n.sheetArea)})),e.bind(o.Events.LeaveCell+"."+E,(function(t,n){he(e,n.row,n.col,!0,n.sheetArea)})),e.bind(o.Events.TopRowChanged+"."+E,(function(t,n){he(e,n.row,n.col,!0,n.sheetArea)}))},dispose:function(e){var t=this;t.unbind(o.Events.EnterCell+"."+E),t.unbind(o.Events.LeaveCell+"."+E),t.unbind(o.Events.TopRowChanged+"."+E)},processMouseDown:function(e){var t=e.hitInfo.cellTypeHitInfo;t&&t.cellButtonHitInfo&&ae(t)&&(e.r=!0)}})},"./dist/plugins/celltype/celltypes.entry.js":function(e,t,n){"use strict";var o,r,i,a,s;function l(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r=(o=n("Core")).CellTypes.Base,i=o.CellTypes.Context,a=o.CellTypes.EditorType,s=o.CellTypes._o,t.Base=r,t.Context=i,t.EditorType=a,t._o=s,t.vHb=o.CellTypes.vHb,t.wHb=o.CellTypes.wHb,Object.defineProperty(t,"Corner",{set:function(e){e!==t.vHb.Corner&&(t.vHb.Corner=e)},get:function(){return t.vHb.Corner}}),Object.defineProperty(t,"ColumnHeader",{set:function(e){e!==t.vHb.ColumnHeader&&(t.vHb.ColumnHeader=e)},get:function(){return t.vHb.ColumnHeader}}),Object.defineProperty(t,"RowHeader",{set:function(e){e!==t.vHb.RowHeader&&(t.vHb.RowHeader=e)},get:function(){return t.vHb.RowHeader}}),Object.defineProperty(t,"Text",{set:function(e){e!==t.wHb.Text&&(t.wHb.Text=e)},get:function(){return t.wHb.Text}}),l(n("./dist/plugins/celltype/checkboxcelltype.js")),l(n("./dist/plugins/celltype/buttoncelltype.js")),l(n("./dist/plugins/celltype/hyperlinkcelltype.js")),l(n("./dist/plugins/celltype/comboboxcelltype.js")),n("./dist/plugins/celltype/cellbuttons.js"),l(n("./dist/plugins/celltype/editor/colorpicker.js")),l(n("./dist/plugins/celltype/editor/timepicker.js")),l(n("./dist/plugins/celltype/editor/calendar.js")),l(n("./dist/plugins/celltype/editor/calculator.js")),l(n("./dist/plugins/celltype/editor/monthPicker.js")),l(n("./dist/plugins/celltype/editor/listControl.js")),l(n("./dist/plugins/celltype/dropdown-action.js")),l(n("./dist/plugins/celltype/radiochecklistcelltype.js")),l(n("./dist/plugins/celltype/celltypes.ns.js")),l(n("./dist/plugins/celltype/rangecelltype.js"))},"./dist/plugins/celltype/celltypes.ns.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("./dist/plugins/celltype/celltypes.res.en.js");t.SR={en:o}},"./dist/plugins/celltype/celltypes.res.en.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OK="OK",t.Cancel="Cancel",t.Calendar_ShortWeeks_1="MON",t.Calendar_ShortWeeks_2="TUE",t.Calendar_ShortWeeks_3="WED",t.Calendar_ShortWeeks_4="THU",t.Calendar_ShortWeeks_5="FRI",t.Calendar_ShortWeeks_6="SAT",t.Calendar_ShortWeeks_7="SUN",t.Calendar_Weeks_1="Monday",t.Calendar_Weeks_2="Tuesday",t.Calendar_Weeks_3="Wednesday",t.Calendar_Weeks_4="Thursday",t.Calendar_Weeks_5="Friday",t.Calendar_Weeks_6="Saturday",t.Calendar_Weeks_7="Sunday",t.Calendar_ShortMonths_1="JAN",t.Calendar_ShortMonths_2="FEB",t.Calendar_ShortMonths_3="MAR",t.Calendar_ShortMonths_4="APR",t.Calendar_ShortMonths_5="MAY",t.Calendar_ShortMonths_6="JUN",t.Calendar_ShortMonths_7="JUL",t.Calendar_ShortMonths_8="AUG",t.Calendar_ShortMonths_9="SEP",t.Calendar_ShortMonths_10="OCT",t.Calendar_ShortMonths_11="NOV",t.Calendar_ShortMonths_12="DEC",t.Calendar_Months_1="JANUARY",t.Calendar_Months_2="FEBRUARY",t.Calendar_Months_3="MARCH",t.Calendar_Months_4="APRIL",t.Calendar_Months_5="MAY",t.Calendar_Months_6="JUNE",t.Calendar_Months_7="JULY",t.Calendar_Months_8="AUGUST",t.Calendar_Months_9="SEPTEMBER",t.Calendar_Months_10="OCTOBER",t.Calendar_Months_11="NOVEMBER",t.Calendar_Months_12="DECEMBER",t.Calendar_Time_AM="AM",t.Calendar_Time_PM="PM",t.Calendar_EraName_1="M",t.Calendar_EraName_2="T",t.Calendar_EraName_3="S",t.Calendar_EraName_4="H",t.Calendar_FirstYear="1",t.Calendar_Today="Today",t.Calendar_LastMonth="Go to previous month",t.Calendar_NextMonth="Go to next month",t.Calendar_LastYear="Go to previous year",t.Calendar_NextYear="Go to next year",t.Calendar_LastTenYear="Go to previous ten years",t.Calendar_NextTenYear="Go to next ten years",t.Quarter_Format_1="Q1",t.Quarter_Format_2="Q2",t.Quarter_Format_3="Q3",t.Quarter_Format_4="Q4",t.ThemeColor="Theme Colors",t.StandardColor="Standard Colors",t.Calculator_DivideByZeroInfo="Cannot divide by zero.",t.Calculator_InvalidInputInfo="Invalid Input.",t.Calculator_SqrtParameterException="Invalid input for function.",t.Calculator_OverFlowInfo="Arithmetic operation resulted in an overflow.",t.MultiColumn_InvalidDataSource="Invalid data source. The formula should return an array."},"./dist/plugins/celltype/checkboxcelltype.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function D(e,t,n,o){var r,i=e._modelManager;i&&(i.do("setValueForKey",t,n,T,g,o),(r=i.getValueForKey(t,n,N,o))&&(clearTimeout(r),i.do("setValueForKey",t,n,N,g,o)))}function j(e){return 5*e}function _(e,t,n,o,r){var i=j(r),a=t.hAlign,s=n.x-1,l=n.width+1,u=0,c=0;return 0===e||1===e?(c=s+i,1===a?c=s+l/2-6:2===a&&(c=s+l-i-I)):2===e?(u=I+o,c=s+i+o,1===a?c=s+l/2-u/2+o:2===a&&(c=s+l-i-u+o)):(u=I+o,c=s+i,1===a?c=s+l/2-u/2:2===a&&(c=s+l-i-u)),c-s}function O(e,t,n,o,r){var i=j(r),a=t.vAlign,s=n.y-1,l=n.height+1,u=0,c=0;return 0===e?(u=I+o,c=s+i+o,1===a?c=s+l/2-u/2+o:2===a&&(c=s+l-i-u+o)):1===e?(u=I+o,c=s+i,1===a?c=s+l/2-u/2:2===a&&(c=s+l-i-u)):(c=s+i,1===a?c=s+l/2-6:2===a&&(c=s+l-i-I)),c-s}function F(e,t,n,o,r){var i=t.getValue(n,o,r),a=e.rK(i),s={cmd:"editCell",sheetName:t.name(),row:n,col:o,newValue:a,autoFormat:!0};t.wu().execute(s),e.tw(t,n,o,r)}function P(e,t,n,o,r){var i=r&&r.sheet,a=e.getEditorValue(t,r);e.setEditorValue(t,a,r),e.updateEditor(t,n,o,r),e.tw(i,i.Jl,i.Kl,r.sheetArea)}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("Core"),i=r.Ul.Nl,a=o.Common.j.Fa,s=r.Ul.fp,l=r.Ul.nl,u=r.CellTypes.Context,c=r.CellTypes.Base,f=r.GC$,h=f.each,p=r.Ul.hZa,d=null,g=void 0,m=Math.max,y=parseInt,v="position",b="absolute",C="font",w="left",x="right",A="alphabetic",M=".gcEditingInput",S="green",T="_isFirstMouseUp",N="_mouseupToken",function(e){e[e.top=0]="top",e[e.bottom=1]="bottom",e[e.left=2]="left",e[e.right=3]="right"}(t.CheckBoxTextAlign||(t.CheckBoxTextAlign={})),I=12,R={caption:"",textTrue:"",textIndeterminate:"",textFalse:"",textAlign:3,isThreeState:!1},k=function(e){function t(){var t,n=e.call(this)||this;return n.typeName="5",t=n,h(R,(function(e,n){t["_"+e]=n})),n}return E(t,e),t.prototype.paintValue=function(e,t,n,o,i,l,u,c){var f,h,p,d,g,m,v,b,C,M,T,N,I,R,k,E,D,j,F;e&&(e.save(),e.rect(n,o,i,l),e.clip(),e.beginPath(),f=u.hAlign,h=u.font,p=u.foreColor,g=(d=this)._textAlign,m=d.getText(t,c),v=0,b=0,(C=c.sheet)&&(v=C.dp(m,h),b=s(h),m&&(b*=m.split(/\r\n|\r|\n/).length)),M=C.zoom(),++n,++o,--i,--l,6,T=new r.Rect(n,o,i,l),N=y(""+(n+_(g,u,T,v,M))),I=y(""+(o+O(g,u,T,b,M))),R=w,k=N+1,1===f?(R="center",k+=6):2===f&&(R=x,k+=12),h&&e.font!==h&&r.Ul.lZa(e,h),p&&(e.fillStyle=p),E=u.textDecoration,F=b/2-(D=parseInt(c.fontInfo.fontSize,10))/2+(j=D>8?Math.floor((D-8)/5+2):1)-1,e.textBaseline!==A&&(e.textBaseline=A),2===g?(e.textAlign=x,e.fillText(m,N+1-2,I+6+b/2-F),E&&d.ip(e,E,N+1-2,I+6+b/2-F,v,D,j)):0===g&&(e.textAlign=R,e.fillText(m,k,I-2-F),E&&d.ip(e,E,k,I-2-F,v,b)),e.save(),e.strokeStyle="black",e.strokeRect(N+.5,I+.5,12.05,12.05),e.fillStyle="white",e.fillRect(N+1,I+1,11,11),d._isThreeState&&a(t)?(e.beginPath(),e.fillStyle=S,e.rect(N+3,I+3,7,7),e.fill()):1==!!t&&(e.beginPath(),e.lineWidth=2.5,e.moveTo(N+3,I+6),e.lineTo(N+6,I+12-3.5),e.lineTo(N+12-1.5,I+3),e.stroke()),e.restore(),p&&(e.fillStyle=p),3===g?(e.textAlign=w,e.fillText(m,N+1+12+2,I+6+b/2-F),E&&d.ip(e,E,N+1+12+2,I+6+b/2-F,v,D,j)):1===g&&(e.textAlign=R,e.fillText(m,k,I+12+2+b-F),E&&d.ip(e,E,k,I+12+2+b-F,v,D,j)),e.restore())},t.prototype.getText=function(e,t){return this.sK(e)},t.prototype.focus=function(e,t){e&&e.parentNode.focus()},t.prototype.createEditorElement=function(e,t){var n,o,a,s,l=e&&e.sheet&&e.sheet.parent&&e.sheet.parent._host,u=r.Ul.vl(l)+1e3;return f(t).css("z-index",u).attr("tabindex",1).attr("gcUIElement","gcEditingInput"),(n=f(t.firstChild)).css("overflow","hidden"),(o=f(i("input"))).attr("type","checkbox"),o.attr("class","gc-checkbox-cell-type-input"),n.append(o),(a=f(i("span"))).css(v,b).css(C,p("normal 11pt calibri")).css("cursor","default").css("white-space","nowrap"),n.append(a),(s=f(i("div"))).css(v,b).css("background-color",S).css("width",7).css("height",7),n.append(s),d},t.prototype.rK=function(e){return this._isThreeState?!a(e)&&(1!=!!e||d):!e},t.prototype.setEditorValue=function(e,t,n){var o,r,i,s,l,u,c,h;e&&(r=(o=e.parentNode.children)[0],i=o[1],s=o[2],r&&i&&s&&(l=this,c=void 0,h=void 0,(u=n&&n.sheet)&&u.HF||(h=l.rK(t)),l._isThreeState?a(h)?(c=!1,f(s).show()):(c=!!h,f(s).hide()):c=!!h,r.checked=c,f(i).text(l.sK(h))))},t.prototype.getEditorValue=function(e,t){if(e){var n=e.parentNode.children,o=n[0],r=n[1],i=n[2];if(o&&r&&i&&(!this._isThreeState||!f(i).isVisible()))return o.checked}return d},t.prototype.tw=function(e,t,n,o){var r=e.parent;r&&r.tw(e,t,n,o)},t.prototype.activateEditor=function(e,t,n,o){var r,i,a=o&&o.sheet;e&&a&&(r=f(e.parentNode.parentNode),i=this,r.bind("mousedown"+M,(function(e){l(e)})),r.bind("mouseup"+M,(function(){P(i,e,t,n,o)})),r.bind("keydown"+M,(function(e){var t=e.keyCode;if(!e.ctrlKey&&!e.shiftKey&&!e.altKey){if(32===t)return i.tK=!0,l(e),!1;8===t&&l(e)}})),r.bind("keyup"+M,(function(r){!i.tK||32!==r.keyCode||r.ctrlKey||r.shiftKey||r.altKey||(i.tK=!1,P(i,e,t,n,o))})),f(e).bind("click",(function(e){l(e)})))},t.prototype.updateEditor=function(e,t,n,o){var r,i,a,l,u,c,h,d,g,m,y,v,b,x,A,M,S,T,N,R,k,E,D,j,F,P,H,B,L=o&&o.sheet;e&&L&&(r=L._render,l=(a=(i=e.parentNode).children)[0],u=a[1],c=a[2],l&&u&&c&&(f(i).width(n.width).height(n.height),d=(h=f(u)).text(),g=t.foreColor,m=t.font,y=t.hAlign,v=t.textDecoration,g&&h.css("color",g),b=void 0,b=m||r.Bl(),(x=L.zoom())>1&&(b=r.Cl(b)),h.css(C,p(b)),A=L.rt(d,b),M=s(b),d&&(M*=d.split(/\r\n|\r|\n/).length),N=_(T=(S=this)._textAlign,t,n,A,x),R=O(T,t,n,M,x),f(l).css("margin-left",N).css("margin-top",R),k=l.offsetLeft,E=l.offsetTop,D=l.offsetWidth,j=l.offsetHeight,F=0,P=0,0===T?(F=k,1===y?F=k+6-A/2:2===y&&(F=k+I-A),P=E-M):1===T?(F=k,1===y?F=k+6-A/2:2===y&&(F=k+I-A),P=E+j):2===T?(F=k-A-2,P=E+6-M/2):(F=k+D+2,P=E+6-M/2),h.css(w,F).css("top",P),S._isThreeState?(H=k+(D-c.offsetWidth)/2,B=E+(j-c.offsetHeight)/2,f(c).css(w,H).css("top",B).toggle().toggle()):f(c).hide(),v&&S.lp(h,v)))},t.prototype.sK=function(e){var t=this,n=t._caption;return t._isThreeState&&a(e)?t._textIndeterminate||n:1==!!e?t._textTrue||n:t._textFalse||n},t.prototype.getHitInfo=function(e,t,n,o,r){if(r){var i=r.sheetArea;if(a(i)||3===i)return{x:e,y:t,row:r.row,col:r.col,cellRect:o,sheetArea:3,isReservedLocation:!0,sheet:r.sheet,cellStyle:n}}return d},t.prototype.processMouseDown=function(e){return!!e&&void(e.isReservedLocation&&(this.uK=!0))},t.prototype.processMouseUp=function(e){var t,n,o,r,i=this,a=e&&e.sheet;if(a&&i.uK&&e.isReservedLocation){if(i.uK=!1,t=e.row,n=e.col,o=e.sheetArea,!a._modelManager.getValueForKey(t,n,T,o))return F(i,a,t,n,o),a._modelManager.do("setValueForKey",t,n,T,!0,o),r=setTimeout((function(){D(a,t,n,o)}),250),a._modelManager.do("setValueForKey",t,n,N,r,o),!0;D(a,t,n,o)}return!1},t.prototype.processMouseLeave=function(e){return!!e&&void(this.uK=!1)},t.prototype.isReservedKey=function(e,t){return 32===e.keyCode&&!e.ctrlKey&&!e.shiftKey&&!e.altKey},t.prototype.processKeyUp=function(e,t){return F(this,t.sheet,t.row,t.col,t.sheetArea),!0},t.prototype.getAutoFitWidth=function(e,t,n,o,r){var i=this._textAlign,a=u.cp(e,this.sK(e),n,o,r);return 0===i||1===i?a=m(a,I):a+=I,a+5+2},t.prototype.getAutoFitHeight=function(e,t,n,o,r){var i=this._textAlign,a=u.ep(e,this.sK(e),n,o,r);return 0===i||1===i?a+=I:a=m(a,I),a+5},t.prototype.JH=function(e){this.isReservedKey(e)&&l(e)},t.prototype.isImeAware=function(e){return!1},t.prototype.gQa=function(){},t.prototype.toJSON=function(){var e,t=this,n={typeName:t.typeName};return h(R,(function(o,r){(e=t["_"+o])!==r&&(n[o]=e)})),n},t.prototype.fromJSON=function(e){var t=this;h(R,(function(n){var o=e[n];a(o)||(t["_"+n]=o)}))},t}(c),t.CheckBox=k,h(R,(function(e){k.prototype[e]=function(t){return 0===arguments.length?this["_"+e]:(this["_"+e]=t,this)}})),r.CellTypes._o[5]=k},"./dist/plugins/celltype/comboboxcelltype.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function ne(e,t){e.appendChild(t)}function oe(e,t){e.removeChild(t)}function re(e){return e&&e.parentNode.parentNode.comboBox}function ie(e){c(e).css(["margin","overflow","resize",A,"padding",j,F,"white-space",_,q],[0,"hidden",k,M,"1px 0px 0px 1px",k,L,"nowrap",B,k]).attr(I,"gcComboBoxEditor").attr(R,-1)}function ae(e){var t,n,o,r,i=["0","0","0","0"];return"string"==typeof e&&(o=void 0,r=void 0,1===(n=(t=e.split(" ",4)).length)?i=[o=t[0],o,o,o]:2===n?i=[o=t[0],r=t[1],o,r]:3===n?(r=t[1],i=[t[0],r,t[2],r]):4===n&&(i=[t[0],t[1],t[2],t[3]])),i}function se(e,t){return e.hasOwnProperty(t)}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("Core"),i=r.CellTypes.Base,a=r.Ul.Nl,s=o.Common.j.Fa,l=r.Ul,u=l.nl,c=r.GC$,f=c.each,h=l.hZa,p=l.Fxb,d=document,g=null,m=void 0,y=Math.max,v=parseInt,b="click",C="keydown",w="mouseover",x="mouseout",A="position",M="absolute",S="font",T="left",N="top",I="gcUIElement",R="tabindex",k="none",E="width",D="height",j="outline",_="box-sizing",O="color",F="background-color",P="z-index",H="display",B="content-box",L="white",z="black",V="title",G="div",W="span",U="text",Z="value",q="border",J=l.K_a,function(e){e[e.text=0]="text",e[e.index=1]="index",e[e.value=2]="value"}(t.EditorValueType||(t.EditorValueType={})),Q=17,Y="EndEdit.gcEditingInput",K="#1E90FF",$={editorValueType:0,items:g,itemHeight:22,editable:!1,maxDropDownItems:20},X=function(){function e(e,t,n,o,i,l,u){var f,h,p,d,g,v,S,O,z,V=this;V.KK=e,f=e.firstChild,c(e).bind(C,(function(e){V.LK(e)})).css([P,T,N,E,D,"overflow"],[l||0,t,n,o,i,"visible"]).attr([I],["gcComboBox"]),h=y(0,o-Q),V._editable=!1,V.MK=p=a(G),V.NK=d=a("textarea"),V.PK=p,ne(f,p),ie(p),ie(d),c(d).bind("keyup",(function(){var e,t=V.PK.value;V._text=t,e=V.QK(t),V.editorValue(e),V.RK(t),V.SK()})).bind(w,(function(){V.TK()})).bind(x,(function(){V.SK()})),c(p).bind(b,(function(){V.IK?V.Wq(Y,{isMouse:!0}):V.UK()})).bind(w,(function(){V.TK()})).bind(x,(function(){V.SK()})),V.VK(0,0,h,i),ne(f,g=V.WK=a(G)),c(g).css([q,A,F,_],[k,M,L,B]).attr(I,"gcDropDownButton").bind(b,(function(){var e;!s(V.JK)&&(e=V.JK,V.JK=m,(new Date).valueOf()-e<100)||(V.IK?V.Wq(Y,{isMouse:!0}):V.UK())})),v=a("canvas"),V.Xs=v,V.XK(h,0,o-h,i),ne(g,v),ne(f,S=V.YK=a(G)),V.ZK=!1,O=u||o,c(S).css([A,q,F,P,j,H,"cursor",_,D,"min-width"],[M,"1px solid",L,l||0,k,k,"default",B,i,O+"px"]),c(S).attr(I,"gcDropDownWindow").attr(R,-1),V.$K(0,i-0),V._K=0,ne(S,z=V.aL=a(G)),V.bL=new r.IB(S,z),V._itemHeight=22,V.cL=20,V.dL=-1,V._editorValueType=0,V._items=[]}return e.prototype.getComboBox=function(){return this.KK},e.prototype.dispose=function(){var e=this;c(e.KK).unbind(C),c(e.NK).unbind("keyup").unbind(w).unbind(x),c(e.MK).unbind(b).unbind(w).unbind(x),c(e.WK).unbind(b),c(e.aL).find("div").forEach((function(e){c(e).unbind(w).unbind(x).unbind(b)})),e.bL.dispose()},e.prototype.updateLocationAndSize=function(e,t,n,o){var r=this,i=y(0,n-Q);r.VK(0,0,i,o),r.XK(i,0,n-i,o),r.$K(0,o-0)},e.prototype.updateStyle=function(e,t,n){var o=this;n=h(n),e=e||m,c(o.PK).css(F,e).css(O,t).css(S,n),c(o.WK).css(F,e).css(O,t).css(S,n),c(o.YK).css(F,e).css(O,t).css(S,n),c(o.KK).css(F,"transparent")},e.prototype.updateImeMode=function(e){c(this.PK).css("ime-mode",e)},e.prototype.editorValueType=function(e){return 0===arguments.length?this._editorValueType:(this._editorValueType=e,this)},e.prototype.editorValue=function(e){var t,n=this;return 0===arguments.length?n.fL:(e!==n.fL&&(n.fL=e,t=n.gL(e),n.text(t),n.RK(t,!0)),n)},e.prototype.gL=function(e){var t,n,o,r,i=this,a=i._items,l=a.length,u=i._editorValueType;if(i.HK=!0,1===u)(t=(n=a[e])&&se(n,U)?n.text:n)===m&&(t=e,i.HK=!1);else if(0===u){for(t=e,r=0;r<l&&!((n=a[r])&&se(n,U)&&n.text===e||n===e);r++);r>=l&&(i.HK=!1)}else if(2===u){for(o=0;o<l;o++)if((n=a[o])&&se(n,Z)&&n.value===e){t=n.text;break}o>=l&&(t=e,i.HK=!1)}return s(e)&&(t=""),t},e.prototype.QK=function(e){var t,n,o,r=this._items,i=r.length,a=this._editorValueType,s=e;if(1===a)for(n=0;n<i;n++)((t=r[n])&&se(t,U)&&t.text===e||t===e)&&(s=n);else if(2===a)for(o=0;o<i;o++)(t=r[o])&&se(t,U)&&t.text===e?s=t.value:t===e&&(s=m);return s},e.prototype.RK=function(e,t){var n,o,r,i,a;if(e){for(r=(o=this._items).length,n=0;n<r&&(void 0,a=se(i=o[n],U)?i.text:i,(t?a:(""+a).substr(0,e.length))!==e);n++);n>=r&&(n=-1)}else n=-1;this.hL(n)},e.prototype.SK=function(){c(this.PK).removeAttr(V)},e.prototype.TK=function(){var e=this,t=e.Xn(e._text),n=c(e.PK);t>n.width()+1?n.attr(V,e._text):n.removeAttr(V)},e.prototype.VK=function(e,t,n,o){n-=0,o-=0,c(this.PK).css(T,e).css(N,t).css(E,n-1).css(D,o-1)},e.prototype.editable=function(e){var t,n,o,r,i,a=this;return 0===arguments.length?a._editable:a._editable!==e?(a._editable=e,t=a.KK.firstChild,n=a.PK,o=c(n),r={left:v(o.css(T)),top:v(o.css(N)),width:v(o.css(E)),height:v(o.css(D))},i={backColor:o.css(F),foreColor:o.css(O),font:n.style.font},oe(t,n),a.PK=e?a.NK:a.MK,ne(t,a.PK),c(a.PK).css(F,i.backColor).css(O,i.foreColor).css(S,i.font),a.VK(r.left,r.top,r.width,r.height),a):void 0},e.prototype.text=function(e){var t=this,n=t.PK;return 0===arguments.length?t._text:void(e!==t._text&&(t._text=e,t._editable?n.value=e:n.textContent=e))},e.prototype.focus=function(){var e=this.PK;e.focus(),this._editable&&(e.selectionStart=e.value.length)},e.prototype.selectAll=function(){this._editable&&this.PK.select()},e.prototype.XK=function(e,t,n,o){var r,i,a,s;n-=0,o-=0,r=this.Xs,c(this.WK).css(T,e).css(N,t).css(E,n).css(D,o),c(r).attr(E,n).attr(D,o),i=r.width,a=r.height,(s=r.getContext("2d")).beginPath(),s.lineWidth=2,s.fillStyle=z,s.moveTo(i-Q+4,(a-2)/2-2.5),s.lineTo(i-Q+7,(a-2)/2+3.5),s.lineTo(i-Q+10,(a-2)/2-2.5),s.fill()},e.prototype.showDropDownList=function(){var e=this,t=e.bL;e.ZK=!0,c(e.YK).bind(C,(function(t){e.LK(t)})).show(),e.iL=!1,e.jL(),this.adjustPosition(),e.iL&&t.lB(c(e.aL.children).height()),t.ew(!1),e.kL(K),e.lL(e.dL),e.focus()},e.prototype.adjustPosition=function(){var e,t,n,o,r,i,a,s,l,u,f=c(this.YK);if(f){if(e=parseInt(f.css("left"),10),t=parseInt(f.css("top"),10),n=f.width(),o=f.height(),isNaN(e)||isNaN(t)||isNaN(n)||isNaN(o))return;r=0,i=0,s=(a=d.documentElement).clientWidth,l=a.clientHeight,u=f[0].getBoundingClientRect(),o>l&&(f.css("max-height",Math.round(.8*l)+"px"),o=Math.round(.8*l)),n>s&&(f.css("max-width",Math.round(.8*s)+"px"),n=Math.round(.8*s)),u.left+n>s&&(i=u.left+n-s),u.top+o>l&&(r=u.top+o-l),(e<0||t<0||r>0||i>0)&&(t-=r,(e-=i)<0&&(e-=22),f.css({left:e+"px",top:t+"px"}))}},e.prototype.shiftPadding=function(e,t){var n=this.KK.firstChild;e===T?c(n).css({left:(+c(n).css(T).replace("px","")||0)-t}):e===N&&c(n).css({top:(+c(n).css(N).replace("px","")||0)-t})},e.prototype.closeDropDownList=function(){var e=this;e.ZK=!1,c(e.YK).unbind(C).hide(),e.kL(""),e.focus()},e.prototype.UK=function(){this.ZK?this.closeDropDownList():this.showDropDownList()},e.prototype.listHeight=function(e){var t=this,n=c(t.YK);return 0===arguments.length?n.height():void(e>0&&(n.height(e),t.bL.ew(!1)))},e.prototype.$K=function(e,t){c(this.YK).css(T,e).css(N,t)},e.prototype.items=function(e){var t,n,o,r,i,a=this;if(0===arguments.length)return a._items;if(e){for(a._items=e,t=a.aL,n=void 0,c(t).find("div").forEach((function(e){c(e).unbind(w).unbind(x).unbind(b)})),n=t.firstChild;n;)oe(t,n),n=t.firstChild;for(a._K=0,o=0,r=e.length;o<r;o++)i=e[o],a.mL(se(i,U)?i.text:i);return a}},e.prototype.mL=function(e){var t=this,n=a(G),o=a(W);o.textContent=""+e,o.style.padding="0 18px 0 1px",o.style.textOverflow="ellipsis",o.style.whiteSpace="nowrap",ne(n,o),ne(t.aL,n),t._K++,c(n).bind(b,(function(){var e=c(n).index();t.selectedIndex(e),t.closeDropDownList(),t.Wq(Y,{isMouse:!0})})).bind(w,(function(){var e=c(n);n.oldBackColor=e.css(F),e.css(F,"lightgrey")})).bind(x,(function(){c(n).css(F,n.oldBackColor||"")}))},e.prototype.nL=function(){var e=this;e.Po=a(W),c(e.Po).css([H,S],[k,e.YK.style.font]).appendTo(d.body)},e.prototype.oL=function(){oe(d.body,this.Po)},e.prototype.pL=function(e){return this.Po.textContent=e,c(this.Po).width()+2+1},e.prototype.kL=function(e){var t=this,n=t.dL;0<=n&&n<t._K&&c(t.aL.children[n]).css(F,e)},e.prototype.LK=function(e){var t,n,o,r=this,i=e.keyCode,a=e.which;(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey||37===a||39===a)&&9!==a&&r.editable()||(t=r._K,n=r.dL,o=0,38===a||40===a?(n>=0&&n<t&&(o=n+(38===a?-1:1)),o>=0&&o<t&&r.selectedIndex(o),r.ZK&&r.lL(o),u(e)):13===a||37===a||39===a||9===a?(r.selectedIndex(r.dL),r.closeDropDownList(),r.Wq(Y,{keyCode:i,shiftKey:e.shiftKey}),u(e)):27===a&&(r.closeDropDownList(),r.Wq(Y,{keyCode:i}),u(e)))},e.prototype.getSelectedValue=function(e,t,n){var o,r=t[e];return s(r)||(1===n?o=e:0===n?o=se(r,U)?r.text:r:2===n&&se(r,Z)&&(o=r.value)),o},e.prototype.hL=function(e){var t=this;t.kL(""),t.dL=e,t.kL(K),t.lL(e)},e.prototype.selectedIndex=function(e){var t,n=this;return 0===arguments.length?n.dL:void(0<=e&&e<n._K&&(n.hL(e),t=n.getSelectedValue(n.dL,n._items,n._editorValueType),s(t)||n.editorValue(t)))},e.prototype.itemCountPerPage=function(e){return 0===arguments.length?this.cL:void(e>0&&(this.cL=e))},e.prototype.Xn=function(e){this.nL();var t=this.pL(e);return this.oL(),t},e.prototype.itemHeight=function(e){return 0===arguments.length?this._itemHeight:void(e>0&&(this._itemHeight=e))},e.prototype.jL=function(){var e,t,n,o,r,i=this;i.nL(),e=i._items[0],t=y(i._itemHeight,c(i.Po).text(s(e)?"":e).height()),c(i.aL.children).css(D,t),(o=i._K)<=(r=i.cL)?n=o*t:(n=r*t,i.iL=!0),i.listHeight(n),i.oL()},e.prototype.lL=function(e){if(e>=0&&e<this._K){var t=this.aL.children[e];this.bL.BB(t)}},e.prototype.bind=function(e,t,n){c(this.KK).bind(e,t,n)},e.prototype.unbind=function(e,t){c(this.KK).unbind(e,t)},e.prototype.Wq=function(e,t){c(this.KK).trigger(e,t)},e}(),ee=function(e){function t(){var t,n=e.call(this)||this;return n.typeName="7",n.DF=!1,n.GK=!1,t=n,f($,(function(e,n){"items"===e&&(n=[]),t["_"+e]=n})),n}return te(t,e),t.prototype.isReservedKey=function(e,t){return this.GK},t.prototype.paintValue=function(e,t,n,o,i,a,s,l){var u,c,f,h,d,g,m,v,b=l.sheet,C=b.zoom?b.zoom():1,w=Q,x=y(0,i-w-1);3===s.hAlign&&(s.hAlign=0),s.wordWrap&&(s.wordWrap=!1),x>0&&a>0&&(u={},c=void 0,l.quotePrefix=s.quotePrefix,f=s.formatter&&"General"!==s.formatter,h=s._autoFormatter&&s._autoFormatter.formatCached&&"General"!==s._autoFormatter.formatCached,void 0,g=this.getItemValue(t),d=f?s.formatter:h?s._autoFormatter:r.CellTypes.Context.Ixb(e,g,x+1,s,C),(c=this.format(J(t),d,u,l))&&(m=s.isVerticalText,p(g)&&!m&&!0!==s.shrinkToFit&&(c!==(v=r.CellTypes.Context.Lxb(e,c,x+1,s,C))&&(delete u.content,s.textIndent=0),c=v),this.paintText(e,this.getText(t,l),n,o,x,a,s,l,c,u))),e.save(),(w>i||w>a)&&(e.rect(n,o,i,a),e.clip()),e.beginPath(),e.lineWidth=2,e.fillStyle=z,e.moveTo(n+i-w+3,o+(a-2)/2-2.5),e.lineTo(n+i-w+6,o+(a-2)/2+3.5),e.lineTo(n+i-w+9,o+(a-2)/2-2.5),e.fill(),e.restore()},t.prototype.getText=function(e,t){return e},t.prototype.createEditorElement=function(e,t){var n,o,r,i=e&&e.sheet,a=i&&i.parent,s=a&&a._host,u=l.vl(s)+1e3,c=i.defaults,f=this,h=i.getActualStyle(e.row,e.col).cellPadding,p=0;return h&&(p=parseFloat(h.split(" ")[3])||0),n=i.Tl(e.col)-p,(o=new X(t,0,0,c.colWidth,c.rowHeight,u,n)).editorValueType(f._editorValueType),o.items(f._items),o.itemHeight(f._itemHeight),o.itemCountPerPage(f._maxDropDownItems),o.editable(f._editable),r=o.getComboBox(),Object.defineProperty(r,"comboBox",{get:function(){return this.ixb},set:function(e){this.ixb!==e&&(this.ixb&&this.ixb.dispose(),this.ixb=e)}}),r.comboBox=o,g},t.prototype.getEditorValue=function(e,t){var n=re(e);return n&&(this.DF=!n.HK),n&&n.editorValue()},t.prototype.setEditorValue=function(e,t,n){var o=re(e);o&&o.editorValue(t)},t.prototype.focus=function(e,t){var n=re(e);n&&n.focus()},t.prototype.selectAll=function(e,t){var n=re(e);n&&n.selectAll()},t.prototype.activateEditor=function(e,t,n,o){var r=this,i=o.sheet,a=re(e);a&&(a.editorValueType(r._editorValueType),a.items(r._items),a.itemHeight(r._itemHeight),a.itemCountPerPage(r._maxDropDownItems),a.editable(r._editable),a.bind(Y,(function(e,t){var n,o,r,s,l,u=t.keyCode,c=t.shiftKey;if(u){if(o=(n=i.wu()).getShortcutKey(u,!1,c||!1,!1,!1),r=n.getCommands(o))for(s=0,l=r.length;s<l;s++)if("navigationLeft"!==r[s].Cj&&"navigationRight"!==r[s].Cj||(i._editorStatus=1),r[s].execute(i.parent,{sheetName:i.name()}))return!0}else t.isMouse&&a.IK&&i.endEdit()}))),r.GK=!0},t.prototype.deactivateEditor=function(e,t){var n,o,r,i,a,s;if(e&&(n=re(e))){if(o=t.sheet.getActualStyle(t.row,t.col,t.sheetArea).cellPadding)for(r=[T,N],i=[3,0],a=0;a<r.length;a++)s="number"==typeof(s=parseInt(ae(o)[i[a]],10))&&s>0?s:0,n.shiftPadding(r[a],s);n.unbind(Y),n.closeDropDownList(),n.IK=!1}this.GK=!1},t.prototype.updateImeMode=function(e,t){if(this.isImeAware()){var n=re(e);n&&n.updateImeMode(t)}},t.prototype.updateEditor=function(e,t,n,o){var r,i,a=e&&o&&o.sheet;a&&(r=re(e),t&&r&&(i=a._render,r.updateStyle(t.backColor,t.foreColor,i.Cl(t.font||i.Bl()))),n&&r&&r.updateLocationAndSize(n.x,n.y,n.width,n.height))},t.prototype.format=function(e,t,n,o){var r;return s(e)?"":(this,r=this.getItemValue(e),i.prototype.format.call(this,r||e,t,n))},t.prototype.getItemValue=function(e){var t,n,o,r,i=this._editorValueType,a=this._items;if(a)if(n=a.length,1===i){if(0<=(o=v(e))&&o<n&&((t=a[o])!==m&&t!==g))return se(t,U)?t.text:t}else if(2===i)for(r=0;r<n;r++)if((t=a[r])&&se(t,Z)&&t.value===e)return t.text},t.prototype.parse=function(e,t,n){var o,r,a,s=this,l=s._editorValueType,u=s._items,c=i.prototype.parse.call(s,e,t);if(u){if(a=u.length,0===l)return c;if(1===l){for(r=0;r<a;r++)if((o=u[r])&&se(o,U)&&o.text===c||o===c)return r}else if(2===l)for(r=0;r<a;r++)if((o=u[r])&&se(o,U)&&o.text===c)return o.value}return c},t.prototype.getHitInfo=function(e,t,n,o,r){var i,a,l,u,c,f;return r?(i=r.sheetArea,a=r.sheet,(s(i)||3===i)&&o&&(l=ae(n.cellPadding),u=parseInt(l[1],10)||0,c=o.x+o.width-u,f={x:e,y:t,row:r.row,col:r.col,cellStyle:n,cellRect:o,sheetArea:i,sheet:a},c-Q<=e&&e<c)?(f.isReservedLocation=!0,f):g):g},t.prototype.processMouseDown=function(e){var t,n=e.sheet,o=e.sheetArea;(s(o)||3===o)&&e.isReservedLocation&&n&&(e.row===n.Jl&&e.col===n.Kl||n.setActiveCell(e.row,e.col),n.startEdit(),(t=re(n._editor))&&(l.Ml.mozilla&&(t.JK=(new Date).valueOf()),t.showDropDownList(),t.IK=!0))},t.prototype.getAutoFitWidth=function(e,t,n,o,i){return n&&n.wordWrap&&(n.wordWrap=!1),r.CellTypes.Context.cp(e,t,n,o,i)+Q},t.prototype.getAutoFitHeight=function(e,t,n,o,i){return n&&n.wordWrap&&(n.wordWrap=!1),r.CellTypes.Context.ep(e,t,n,o,i)},t.prototype.isImeAware=function(e){return!0},t.prototype.gQa=function(){},t.prototype.toJSON=function(){var e,t=this,n={typeName:t.typeName};return f($,(function(o,r){e=t["_"+o],("items"===o?e&&e.length>0:e!==r)&&(n[o]=e)})),n},t.prototype.fromJSON=function(e){var t=this;f($,(function(n){var o=e[n];s(o)||(t["_"+n]=o)}))},t}(i),t.ComboBox=ee,f($,(function(e){ee.prototype[e]=function(t){return 0===arguments.length?this["_"+e]:(this["_"+e]=t,this)}})),r.CellTypes._o[7]=ee},"./dist/plugins/celltype/dropdown-action.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j;function _(e,t){return E.createElement(e,t)}function O(e){return{canUndo:!1,execute:function(t,n,c){var h,p,y,v,C,w,E,D,j,O=t.getSheetFromName(n.sheetName);if(!O||t.getActiveSheet().name()!==n.sheetName)return!1;if(h=n.row,p=n.col,(m.isNullOrUndefined(h)||m.isNullOrUndefined(p))&&(h=O.getActiveRowIndex(),p=O.getActiveColumnIndex()),y=n.sheetArea,m.isNullOrUndefined(y)&&(y=3),h<0||h>=O.getRowCount(y)||p<0||p>=O.getColumnCount(y))return!1;switch(O.showCell(h,p,o.VerticalPosition.nearest,o.HorizontalPosition.nearest),v=1===y?-1:void 0,C=2===y?-1:void 0,w=O.getCellRect(h,p,v,C),E=_("div"),D=function(e,t,n,o){var r,i;return e.isEditing()?(r=e.getCellType(t,n),i={sheet:e,row:t,col:n,sheetArea:o},r.getEditorValue(e._editor,i)):e.getValue(t,n,o)}(O,h,p,y),(m.isNullOrUndefined(n.row)||m.isNullOrUndefined(n.col))&&(n.row=O.getActiveRowIndex(),n.col=O.getActiveColumnIndex()),e){case x:j=new u.ColorPicker(E);break;case A:D=F(D,"date"),j=new f.Calendar(E);break;case M:D=F(D,"date"),j=new s.TimePicker(E);break;case S:D=""+(D=F(D,"number")),j=new r.Calculator(E);break;case T:D=F(D,"date"),j=new l.MonthPicker(E);break;case N:(j=new i.List(E)).formula=O.getFormula(n.row,n.col);break;case I:D=F(D,"number"),j=new a.Slider(E);break;case R:j=new d.WorkFlow(E),"string"!=typeof D&&D!==b&&(D=""+D);break;case k:j=new g.MultiColumn(E,b,O)}return B(j,e,D,w,O,n),!0}}}function F(e,t){return"date"===t?"string"==typeof e?(e=v.Qa(e))===b&&(e=new Date):e instanceof Date||(e=new Date):"number"===t&&("string"==typeof e?e=y.Qa(e):"number"!=typeof e&&(e=0)),e}function P(e,t,n,r){var i,a,s,l,u,c,f=n.row,h=n.col;(m.isNullOrUndefined(f)||m.isNullOrUndefined(h))&&(f=e.getActiveRowIndex(),h=e.getActiveColumnIndex()),i=n.sheetArea,m.isNullOrUndefined(i)&&(i=3),t&&t.submitCommand?"string"==typeof t.submitCommand?e.getParent().commandManager().execute({cmd:t.submitCommand,sheetName:e.name(),row:f,col:h,newValue:r.value}):"function"==typeof t.submitCommand&&((a={}).row=n.row,a.col=n.col,a.sheetArea=i,t.submitCommand.call(null,e,r.value,a)):(e.getParent().commandManager().execute({cmd:"editCell",sheetName:e.name(),row:f,col:h,newValue:r.text,autoFormat:!r.noAutoFormat,sheetArea:i,isUndo:!1}),e.isEditing()&&e.Kl===h&&e.Jl===f&&(s=e.getCellType(f,h),l={sheet:e,row:f,col:h,sheetArea:o.SheetArea.viewport},u=e.AHb(f,h,i),c=e.getCellRect(f,h),e._editor.LF=r.value,s.updateEditor(e._editor,u,c,l),s.setEditorValue(e._editor,r.text,l)))}function H(e){var t=-1;switch(e){case x:t=o.DropDownType.colorPicker;break;case A:t=o.DropDownType.dateTimePicker;break;case M:t=o.DropDownType.timePicker;break;case S:t=o.DropDownType.calculator;break;case T:t=o.DropDownType.monthPicker;break;case N:t=o.DropDownType.list;break;case I:t=o.DropDownType.slider;break;case R:t=o.DropDownType.workflowList;break;case k:t=o.DropDownType.multiColumn}return t}function B(e,t,n,o,r,i){var a,s,l,u,f,h,d,g,m,y,v,b,C;w.Gm(),a=r.zo(),l=i.row,u=i.col,f=i.sheetArea,h=r.AHb(l,u,f),d=H(t),(y=(g=h.dropDowns)&&g.length>0)&&((v=g.filter((function(e){return e.type===d}))[0])&&(void 0!==v.option&&null!==v.option&&(s=v.option),m=v)),e.setOptions(s),e.setValue(n),b=a.getBoundingClientRect(),C=new c.Rectangle(o.x+b.left,o.y+b.top,o.width,o.height),D=new c.PopupControl(e.getContainer(),C,{align:c.DropDownAlignment.Far,hostElement:a}),y&&e.SDc(),D.open(),e.scrollToSelect(),y&&e.refresh(),e.on(p.BaseDropdown.Event_ValueChanged,(function(e){e.notCloseDropDown||D.close(),function(e,t){return!0!==t.notSubmit&&(3===e.sheetArea||e.cmd!==S||!isNaN(t.value))}(i,e)&&P(r,m,i,e)})),e.getContainer().addEventListener("contextmenu",(function(e){e.stopPropagation(),e.preventDefault()})),D.on("close",(function(){(function(e,t,n,o,r){var i,a=t.cellButtons;e&&a&&a.length>0&&((i=e._modelManager.getValueForKey(n,o,"_cellButtonParam",r))&&i.isMouseDownReservedLocation&&(i.buttonDownIndex=-1,i.isMouseDownReservedLocation=!1,e.repaint(e.getCellRect(n,o))))})(r,h,l,u,f),e&&e.dispose(),D=null,w.Hm()}))}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),t.commands=o.Commands,r=n("./dist/plugins/celltype/editor/calculator.js"),i=n("./dist/plugins/celltype/editor/listControl.js"),a=n("./dist/plugins/celltype/editor/slider.js"),s=n("./dist/plugins/celltype/editor/timepicker.js"),l=n("./dist/plugins/celltype/editor/monthPicker.js"),u=n("./dist/plugins/celltype/editor/colorpicker.js"),c=n("./dist/plugins/celltype/editor/popupControl.js"),f=n("./dist/plugins/celltype/editor/calendar.js"),h=n("@grapecity/js-sheets-common"),p=n("./dist/plugins/celltype/editor/baseControl.js"),d=n("./dist/plugins/celltype/editor/workflowPicker.js"),g=n("./dist/plugins/celltype/editor/multiColumnPicker.js"),m=n("./node_modules/util/util.js"),y=h.Common.o,v=h.Common.l,b=null,C=window,w=C.Yl,x="openColorPicker",A="openDateTimePicker",M="openTimePicker",S="openCalculator",T="openMonthPicker",N="openList",I="openSlider",R="openWorkflowList",k="openMultiColumn",E=document,o.Commands[x]=O(x),o.Commands[A]=O(A),o.Commands[M]=O(M),o.Commands[S]=O(S),o.Commands[T]=O(T),o.Commands[N]=O(N),o.Commands[I]=O(I),o.Commands[R]=O(R),o.Commands[k]=O(k),j={init:function(){this.commandManager().register(x,o.Commands[x]),this.commandManager().register(A,o.Commands[A]),this.commandManager().register(M,o.Commands[M]),this.commandManager().register(S,o.Commands[S]),this.commandManager().register(T,o.Commands[T]),this.commandManager().register(N,o.Commands[N]),this.commandManager().register(I,o.Commands[I]),this.commandManager().register(R,o.Commands[R]),this.commandManager().register(k,o.Commands[k])}},o.Workbook.$n("registerOpendropdownCommand",j),o.Worksheet.$n("registerOpendropdownCommand",{preProcessMouseWheel:function(e){D&&!this.sgc&&(e.r=!0)}})},"./dist/plugins/celltype/editor/baseControl.js":function(e,t,n){"use strict";var o,r,i,a=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0}),r=function(e){function t(t){var n=e.call(this)||this;return n.xo=t,n}return a(t,e),t.prototype.init=function(e,t,n){this._host=this.xo.querySelector("."+t),this._host?this.RemoveChilds(this._host):(this._host=this.CreateElement(e,t,n),this.xo.appendChild(this._host))},t.prototype.GetContainer=function(){return this.xo},t.prototype.RemoveChilds=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},t.prototype.CreateElement=function(e,t,n,o){var r,i=document.createElement(e);if(t&&(i.className=t),n)for(r in n)n[r]&&i.setAttribute(r,n[r]);return o&&o.appendChild(i),i},t}((o=n("./dist/plugins/celltype/editor/eventbase.js")).EventBase),t.BaseControl=r,i=function(e){function t(t){var n=e.call(this)||this;return n._host=t,n}return a(t,e),t.prototype.updateStyle=function(e,t,n){},t.prototype.scrollToSelect=function(){},t.prototype.getContainer=function(){return this._host},t.prototype.refresh=function(){},t.prototype.SDc=function(){},t.prototype.dispose=function(){},t.Event_ValueChanged="ValueChangedEvent",t}(o.EventBase),t.BaseDropdown=i},"./dist/plugins/celltype/editor/baseSpreadPicker.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function h(e,t,n){var o={sheet:e};i.isNullOrUndefined(n)||(o.isEsc=n),e.Wq(t,o)}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/baseControl.js"),r=n("Core"),i=n("./node_modules/util/util.js"),a=Math.min,s=Math.max,l=null,u=".baseSpreadNS",c=function(e){function t(t,n,o){var r=e.call(this,t)||this;return r.setOptions(n),r.Lgc=o,r}return f(t,e),t.prototype.setOptions=function(e){var t,n;this.$z=e,e&&(t=this._host,(n=document.createElement("div")).setAttribute("class","gc-base-spread-div"),t.appendChild(n),this.Mgc=n,this.Ngc=this.Ogc(n))},t.prototype.setValue=function(e){var t;this.$z&&(t=this.Ngc,setTimeout((function(){window.Yl.Hm(),t&&t.focus(!0)}),1e3))},t.prototype.SDc=function(){var e,t,n,o,a,s=this;s.Mgc&&(e=s._host,(t=s.$z)&&(n=t.width,o=t.height),a=s.mAa(),i.isNullOrUndefined(n)&&(n=a.width),i.isNullOrUndefined(o)&&(o=a.height),r.GC$(e).width(n).height(o))},t.prototype.refresh=function(){this.Ngc&&this.Ngc.refresh()},t.prototype.dispose=function(){var e=this;e.Lgc&&(e.Lgc.zt(),e.Lgc=l),e.Mgc&&(e.Mgc=l),e.Ngc&&(e.Ngc.unbind(r.Events.DropdownSpreadMouseClick+u),e.Ngc.unbind(r.Events.DropdownSpreadKeyboardEnter+u),e.Ngc.no(),e.Ngc=l)},t.prototype.mAa=function(){var e,t,n,o,r,i,l,u=this.Ngc,c=u.getActiveSheet(),f=c.getColumnCount(),h=0;for(e=0;e<f;e++)h+=c.getColumnWidth(e,3);return t=h,n=c.getRowCount(3)+c.getRowCount(1),o=c.getRowHeight(0,3)*n,t<800?u.options.showHorizontalScrollbar=!1:(r=0,u.Pt&&(r=u.Pt._v()),o+=r),o<400?u.options.showVerticalScrollbar=!1:(i=0,(l=u.St)&&(i=l.wDc(!1)||l.Vo()),t+=i),{width:a(t,800),height:a(s(o,100),400)}},t.prototype.Ogc=function(e){var t,n,o=new r.Workbook(e,{sheetCount:1});return o.jDc=!0,(t=o.options).allowUserDragDrop=!1,t.allowUserDragFill=!1,t.allowUserResize=!1,t.allowUserZoom=!1,t.tabStripVisible=!1,t.allowContextMenu=!1,t.allowUserDeselect=!1,t.scrollbarMaxAlign=!0,o.getActiveSheet().sgc=!0,n=this,o.bind(r.Events.DropdownSpreadMouseClick+u,(function(e,t){n.submitData(t)})),o.bind(r.Events.DropdownSpreadKeyboardEnter+u,(function(e,t){n.submitData(t)})),o},t.prototype.submitData=function(e){},t}(o.BaseDropdown),t.BaseSpreadPicker=c,r.GC$.extend(r.Worksheet.prototype,{tgc:function(){h(this,r.Events.DropdownSpreadMouseClick)},ugc:function(e){h(this,r.Events.DropdownSpreadKeyboardEnter,e)}})},"./dist/plugins/celltype/editor/calculator.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/baseControl.js"),r=n("./dist/plugins/celltype/celltypes.ns.js"),i=n("@grapecity/js-sheets-common"),a=n("Core"),s=new i.Common.ResourceManager(r.SR),l=s.getResource.bind(s),u=Math.floor,c=Math.abs,f=Math.pow,h=Math.round,p=Math.sqrt,d=Math.max,g=["0","1","2","3","4","5","6","7","8","9","+/-",".","+","-","*","/","SQRT","%","1/x","=","MC","MR","MS","M+","BS","CE","C","POW"],(m=function(){function e(){}return e.Init=function(){e.GetBrowserType();var t=void 0!==e.edge;e.IsIE=void 0!==e.ie||t},e.GetBrowserType=function(){try{var t=navigator.userAgent.toLowerCase();window.ActiveXObject?e.ie=t.match(/msie ([\d.]+)/)[1]:-1!==t.indexOf("edge")?e.edge=t.match(/edge\/([\d.]+)/)[1]:-1!==t.indexOf("firefox")&&(e.firefox=t.match(/firefox\/([\d.]+)/)[1]),-1!==t.indexOf("rv:")&&-1===t.indexOf("firefox")&&(e.ie=t.match(/rv:([\d.]+)/)[1])}catch(e){}},e}()).Init(),y=function(){function e(){}return e.IsErrorText=function(e){return e===l().Calculator_DivideByZeroInfo||e===l().Calculator_InvalidInputInfo||e===l().Calculator_SqrtParameterException||e===l().Calculator_OverFlowInfo},e}(),t.CalculatorErrorInfo=y,v=function(){function e(){}return e.IsDotContained=function(e){return-1!==(e+"").indexOf(".")},e.GetDotPosition=function(e){var t=e+"",n=0,o=0;for(o=t.length;o>0;o--){if("."===t.substring(o-1,o))return n;n++}return 0===o?0:n},e.FormatOutput=function(t){var n,o;if(null==t)return null;if(0,o=(n=t+"").length,e.IsDotContained(n))for(;"0"===n.substring(o-1,o)&&""!==n&&-1===n.indexOf("e");)n=n.substring(0,o-1),o--;return n},e.FormatResult=function(t){var n,o,r,i,a,s,u;return isNaN(t)&&(t=0),n=t+"",o="",t<0&&(o="-",n=n.substring(1,n.length)),r=n.length,i="",-1!==(a=n.indexOf("e"))&&(i=n.substring(a,r),r=(n=n.substring(0,a)).length),e.IsDotContained(n)&&r>16&&(s=0,parseFloat(n)>1?(s=e.GetDotPosition(n)-(r-16),n=(""+n).substring(0,17)):(s=e.GetDotPosition(n)-(r-17),n=(""+n).substring(0,18)),n=s>0?""+h(parseFloat(n)*f(10,s))/f(10,s):""+h(parseFloat(n))),r=n.length,!e.IsDotContained(n)&&r>15&&(s=r-15,n=""+h(parseFloat(n)/f(10,s))*f(10,s)),n=o+n+i,u=parseFloat(n),e.IsOverFlow(""+u)?l().Calculator_OverFlowInfo:u},e.SingleMathOperation=function(t,n){var o,r=parseFloat(t);if(isNaN(r)&&(r=0),"SQRT"===n){if(r<0)return l().Calculator_InvalidInputInfo;r=p(r)}if("POW"===n&&(r=f(r,2)),"1/x"===n){if(0===r)return l().Calculator_DivideByZeroInfo;o=e.GetDotPosition(""+r),r=f(10,o)/(f(10,o)*r)}return e.FormatResult(r)},e.DoubleMathOperation=function(t,n,o){var r,i,a,s,u=parseFloat(t),c=parseFloat(n);if(e.IsDotContained(""+u)||e.IsDotContained(""+c)){if(i=0,a=0,e.IsDotContained(""+u)&&(i=e.GetDotPosition(""+u)),e.IsDotContained(""+c)&&(a=e.GetDotPosition(""+c)),s=d(i,a),"+"===o&&(r=((u*=f(10,s))+(c*=f(10,s)))/f(10,s)),"-"===o&&(r=((u*=f(10,s))-(c*=f(10,s)))/f(10,s)),"*"===o&&(r=(u*=f(10,i))*(c*=f(10,a))/f(10,i+a)),"/"===o){if(u*=f(10,s),0===(c*=f(10,s)))return l().Calculator_DivideByZeroInfo;r=u/c}"%"===o&&(r=(u*=f(10,i))*(c*=f(10,a))/f(10,i+a+2))}else{if("+"===o&&(r=u+c),"-"===o&&(r=u-c),"*"===o&&(r=u*c),"/"===o){if(0===c)return l().Calculator_DivideByZeroInfo;r=u/c}"%"===o&&(r=u*c/100)}return e.FormatResult(r)},e.IsOverFlow=function(e){var t=parseFloat(e);if(0!==t){if(t>79e27)return!0;if(t<1e-28&&t>-1e-28)return!0;if(t<-79e27)return!0}return!1},e}(),b=function(){function e(e,t,n,o,r,i,a,s,l,u,c){var f=this;f.Fi=e,f.XHa=t,f.YHa=n,f.JCb=o,f.KCb=r,f.Jb=i,f.LCb=a,f.MCb=s,f.NCb=l,f.OCb=u,f.PCb=c,f.QCb=g}return e.prototype.RCb=function(){var e=this;e.Fi="",e.XHa=null,e.YHa=null,e.JCb=null,e.KCb=0,e.MCb=!1,e.NCb=!1},e.prototype.Click=function(e){var t,n=this;return e>=0&&e<=11&&(n.OCb&&(n.SCb(e),n.OCb=!1),n.TCb(e),10!==e&&(n.PCb="ClickNumericButton")),(e>=12&&e<=19||27===e)&&(n.OCb?(n.SCb(e),n.OCb=!1):(n.UCb(e),n.PCb="ClickMathButton")),24===e&&(n.OCb&&(n.SCb(e),n.OCb=!1),n.VCb()),25!==e&&26!==e||(n.SCb(e),n.OCb=!1),n.OCb?null:((t={}).outputText=n.WCb(),y.IsErrorText(n.Fi)&&(n.OCb=!0),t.result=void 0===n.Fi||null===n.Fi?"":n.Fi,t.x=n.XHa,t.y=n.YHa,t.operation=n.JCb,t.token=n.KCb,t.count=n.Jb,t.memoryNumber=n.LCb,t.isBSCanUse=n.MCb,t.isEqualClicked=n.NCb,t.isOperationInvalid=n.OCb,t.lastOperation=n.PCb,t)},e.prototype.TCb=function(e){var t=this;if(null!==t.Fi&&void 0!==t.Fi||(t.Fi=""),!(t.Jb>14&&10!==e))switch(11!==e&&10!==e&&(0!==e||t.Fi+""!="0"&&""!==t.Fi)&&t.Jb++,10!==e&&(t.MCb=!0),t.KCb){case 0:e>=0&&e<=9&&("ClickNumericButton"!==t.PCb&&void 0!==t.PCb&&null!==t.PCb&&(t.Fi="0"),"0"===t.Fi&&0!==e?t.Fi=""+e:"0"!==t.Fi&&(t.Fi=t.Fi+""+e)),10===e&&(-1===(""+t.Fi).indexOf("e")?""!==t.Fi&&"0"!==t.Fi&&(-1===(""+t.Fi).indexOf("-")?t.Fi="-"+t.Fi:t.Fi=(""+t.Fi).substring(1,(""+t.Fi).length)):t.Fi-0>0?t.Fi="-"+t.Fi:t.Fi=t.Fi.substring(1,t.Fi.length)),11===e&&("ClickNumericButton"!==t.PCb&&void 0!==t.PCb&&null!==t.PCb&&(t.Fi="0."),""===t.Fi||v.IsDotContained(t.Fi)?""!==t.Fi&&v.IsDotContained(t.Fi)||(t.Fi="0."):t.Fi=t.Fi+"."),t.KCb=1;break;case 1:e>=0&&e<=9&&("ClickNumericButton"!==t.PCb&&void 0!==t.PCb&&null!==t.PCb&&(t.Fi="0"),"0"===t.Fi&&0===e||("0"===t.Fi&&0!==e?t.Fi=""+e:t.Fi=t.Fi+""+e)),10===e&&(-1===(""+t.Fi).indexOf("e")?""!==t.Fi&&"0"!==t.Fi&&(-1===(""+t.Fi).indexOf("-")?t.Fi="-"+t.Fi:t.Fi=(""+t.Fi).substring(1,(""+t.Fi).length)):t.Fi-0>0?t.Fi="-"+t.Fi:t.Fi=t.Fi.substring(1,t.Fi.length)),11===e&&("ClickNumericButton"!==t.PCb&&void 0!==t.PCb&&null!==t.PCb?t.Fi="0.":v.IsDotContained(t.Fi)||(""===t.Fi?t.Fi="0.":t.Fi=t.Fi+".")),t.NCb||(t.YHa=t.Fi);break;case 2:e>=0&&e<=9&&(t.Fi="",t.Fi=t.Fi+e),11===e&&(t.Fi="0."),10===e&&(t.Fi="0"),t.KCb=3,t.YHa=t.Fi;break;case 3:e>=0&&e<=9&&("ClickNumericButton"!==t.PCb&&void 0!==t.PCb&&null!==t.PCb&&(t.Fi="0"),"0"===t.Fi&&0===e||("0"===t.Fi&&0!==e?t.Fi=""+e:t.Fi=t.Fi+""+e)),10===e&&(-1===(""+t.Fi).indexOf("e")?""!==t.Fi&&"0"!==t.Fi&&(-1===(""+t.Fi).indexOf("-")?t.Fi="-"+t.Fi:t.Fi=(""+t.Fi).substring(1,(""+t.Fi).length)):t.Fi-0>0?t.Fi="-"+t.Fi:t.Fi=t.Fi.substring(1,t.Fi.length)),11===e&&("ClickNumericButton"!==t.PCb&&null!==t.PCb?t.Fi="0.":v.IsDotContained(t.Fi)||(""===t.Fi?t.Fi="0.":t.Fi=t.Fi+".")),t.YHa=t.Fi}},e.prototype.UCb=function(e){var t=this;switch(t.Jb=0,t.MCb=!1,t.NCb&&(t.NCb=!1),t.Fi=v.FormatOutput(t.Fi),t.KCb){case 0:""===t.Fi&&(t.Fi=0),(e>=16&&e<=18&&17!==e||27===e)&&(t.Fi=""+v.SingleMathOperation(t.Fi,t.QCb[e]),y.IsErrorText(t.Fi)||(t.XHa=t.Fi),t.KCb=1),e>=12&&e<=15&&(t.JCb=e,t.XHa=t.Fi,t.KCb=2),17===e&&t.RCb();break;case 1:(e>=16&&e<=18&&17!==e||27===e)&&(t.Fi=""+v.SingleMathOperation(t.Fi,t.QCb[e]),y.IsErrorText(t.Fi)||(null!==t.JCb&&void 0!==t.JCb&&null!==t.YHa&&void 0!==t.YHa?t.YHa=t.Fi:t.XHa=t.Fi)),19===e&&(null!==t.JCb&&void 0!==t.JCb&&null!==t.YHa&&void 0!==t.YHa?(t.Fi=""+v.DoubleMathOperation(""+t.XHa,""+t.YHa,t.QCb[t.JCb]),y.IsErrorText(t.Fi)||(t.XHa=t.Fi)):"-0."===t.Fi&&(t.Fi="0."),t.NCb=!0,t.MCb=!1),e>=12&&e<=15&&(t.JCb=e,t.XHa=t.Fi,t.KCb=2),17===e&&(null!==t.JCb&&void 0!==t.JCb?(t.YHa=t.Fi,t.Fi=""+v.DoubleMathOperation(""+t.XHa,""+t.YHa,t.QCb[17]),t.YHa=t.Fi):t.RCb());break;case 2:(e>=16&&e<=18&&17!==e||27===e)&&(t.Fi=""+v.SingleMathOperation(t.Fi,t.QCb[e]),y.IsErrorText(t.Fi)||(t.KCb=3,t.YHa=t.Fi)),19===e&&(t.YHa=t.XHa,t.Fi=""+v.DoubleMathOperation(""+t.XHa,""+t.XHa,t.QCb[t.JCb]),y.IsErrorText(t.Fi)||(t.XHa=t.Fi,t.KCb=1,t.MCb=!1),t.NCb=!0),e>=12&&e<=15&&(t.JCb=e,t.YHa=t.Fi),17===e&&(t.Fi=v.DoubleMathOperation(""+t.XHa,""+t.XHa,t.QCb[17]),y.IsErrorText(t.Fi)||(t.YHa=t.Fi,t.KCb=3));break;case 3:e>=16&&e<=18&&17!==e&&(t.Fi=""+v.SingleMathOperation(t.Fi,t.QCb[e]),y.IsErrorText(t.Fi)||(t.YHa=t.Fi)),e>=12&&e<=15&&(t.YHa=t.Fi,t.Fi=""+v.DoubleMathOperation(""+t.XHa,""+t.YHa,t.QCb[t.JCb]),y.IsErrorText(t.Fi)||(t.XHa=t.Fi,t.YHa=null,t.JCb=e,t.KCb=2)),17===e&&(t.Fi=v.DoubleMathOperation(""+t.XHa,""+t.YHa,t.QCb[17]),y.IsErrorText(t.Fi)||(t.YHa=t.Fi)),19===e&&(t.YHa=t.Fi,t.Fi=""+v.DoubleMathOperation(""+t.XHa,""+t.YHa,t.QCb[t.JCb]),y.IsErrorText(t.Fi)||(t.XHa=t.Fi,t.KCb=1,t.MCb=!1),t.NCb=!0)}t.Fi+=""},e.prototype.VCb=function(){var e,t=this;if(t.Jb>0&&t.Jb--,(0===t.KCb||1===t.KCb||3===t.KCb)&&!0===t.MCb)switch(t.Fi+="",0,e=t.Fi.length,e>0&&(t.Fi=t.Fi.substring(0,e-1)),"-0"===t.Fi&&(t.Fi="0"),"-"===t.Fi&&(t.Fi=""),""===t.Fi&&(t.MCb=!1),t.KCb){case 0:case 1:t.XHa=t.Fi;break;case 3:t.YHa=t.Fi}},e.prototype.SCb=function(e){var t=this;t.Jb=0,t.MCb=!1,t.Fi="",25===e&&(1===t.KCb&&(null===t.JCb||void 0===t.JCb||t.NCb||(t.YHa=0)),2===t.KCb&&(t.KCb=3)),26===e&&t.RCb()},e.prototype.WCb=function(){var e=this;return""===e.Fi||null===e.Fi||void 0===e.Fi?"0":e.Fi},e.prototype.XCb=function(e){var t=e.keyCode;switch(e.shiftKey&&(t|=65536),e.ctrlKey&&(t|=131072),e.altKey&&(t|=262144),t){case 131138:case 131140:case 131141:case 131144:case 131145:case 131148:case 131150:case 131154:case 131159:case 131188:case 262181:case 262183:case 117:case 65657:case 131081:case 196617:case 9:case 65545:case 121:case 123:return null;case 48:case 96:return 0;case 49:case 97:return 1;case 50:case 98:return 2;case 51:case 99:return 3;case 52:case 100:return 4;case 53:case 101:return 5;case 54:case 102:return 6;case 55:case 103:return 7;case 56:case 104:return 8;case 57:case 105:return 9;case 120:return 10;case 190:case 188:case 110:return 11;case 65723:case 107:return 12;case 65643:if(!m.IsIE)return 12;break;case 189:case 109:return 13;case 65592:case 106:case 65722:return 14;case 191:case 111:return 15;case 65586:case 192:return 16;case 65589:return 17;case 82:return 18;case 13:return 19;case 393292:return 20;case 393298:return 21;case 393293:return 22;case 393296:return 23;case 8:return 24;case 46:return 25;case 27:case 131118:return 26;default:return 61===t&&m.firefox||187===t&&!m.firefox?19:-1}},e}(),C=function(e){function t(t){var n=e.call(this,t)||this,o=n;return o._host=document.createElement("div"),o._host.classList.add("gc-calculator-container"),o._host.innerHTML='\n<div class="gc-calculator">\n    <header class="gc-top-part">\n        <div class="gc-screen">\n            <div class="gc-main-screen">\n                <input class="gc-main" value="" type="text" disabled readonly="readonly"></div>\n        </div>\n    </header>\n    <section class="gc-bottom-part">\n        <div class="gc-features">\n            <div class="gc-sub-menu">\n                <div class="gc-row">\n                    <div class="percentage button image icon-group1" data-value="%" role="button">\n                        <img class="icon icons8-Percentage" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABK0lEQVRYR+2WYQ3CMBCFvznAAgrAAeAAHOAACYADHCABJIACcAA4wAHkkpYM6K7XZs3+rAnZYNf169u7Nyo6HlXH69MD9ArEFJgDK2AKnICtO2re3bk5D2AMPLViDUAWPwQmzxQIWfDi5iyAY6zLNIArMHK73gDyWQNnp0jo3qLSJFLzNU8DeLnKek3oN3/DJbB3X4bAPbZ7ud4WwAC4AXIUn4haptEWQJLx6mRtACQbzwrgTShyellDJkw2nhXA0oZZxrMCSJ0EkCjgW0vOZccyso2XApCTeEnpGYviJoAm41kemzmItN03GS85PXMU0IyXmp7J/4hixisOEEu8ogCWxCsKYEk8a3p+DG41oTXxirRhzHi/7aql519rWxUwvdtzinqAXoHOFXgD+J9gIZOwvCMAAAAASUVORK5CYII="></div>\n                    <div class="sqrt button image icon-group1" data-value="sqrt" role="button">\n                        <img class="icon icons8-Square-Root" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABP0lEQVRYR+3V4S0FQRQF4O9VgApQATrQASpABXSAClABOqCCRwWoABWgAnKTnWSzeV5mdkf2z55fm83sPWfPuXfuzMiYjcxvEjA5UNuBd6z/0dgLuWoK2MV8yVT9u4BbHOIC57njXcuBVXw2pJuIKLJQS8ARbvCA/Szm5lAtAS/YwjEiimzUELCNZ3wjoihCDQFXOME1TovYqbILvrCCHUQURRjqQGq+V0QUxVgm4KdVLcYqxquLe+z1ab5UKFdAnO92+AbemkJriCiKkRNBsrnrQjTcJe4QZ3ohR0AUTkum7UJ6d4CIohdyBXRdSIvnAxFFb+QKaLsQfxzXbfHiWaSyREBy4bEZubj1ihbPUAFBGLnHpRN4QkQxCCUOBFHs+bOGsXjxDHUgvk8upOdBfx8flzowmLBbYBIwOTC6A7+1/zEhMa617wAAAABJRU5ErkJggg=="></div>\n                    <div class="sqr button icon-group1" data-value="pow" role="button">\n                        <span class="x-sign">\n                            <sub>x</sub></span>\n                        <span>\n                            <sup>2</sup></span>\n                    </div>\n                    <div class="fraction button icon-group1" data-value="1/x" role="button">\n                        <span>\n                            <sup>1</sup></span>\n                        <span>&frasl;</span>\n                        <span class="x-sign">\n                            <sub>\n                                <em>x</em></sub>\n                        </span>\n                    </div>\n                </div>\n            </div>\n            <div class="gc-main-menu">\n                <div class="gc-row">\n                    <div class="clear-entry button icon-group1" data-value="CE" role="button">CE</div>\n                    <div class="clear button icon-group1" data-value="C" role="button">C</div>\n                    <div class="clear-element button image icon-group1" data-value="BS" role="button">BS</div>\n                    <div class="divide button image operation icon-group1" data-value="/" role="button">\n                        <img class="icon icons8-Divide" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAo0lEQVRYR+2VSxGDMBRFTxTUAkioklrAQSVAHSChjmqhdYCDMm8mCz7DIp/yurisQ+6Zk5u8gPMXnPMRgAyUGBiBWyzxE3jkFDoXwMLvm0ADGFIhcgEm4AJcY+ALeAOtJ8AHaM4CMNW95xFYtkF0ixImn7/9m9uBVNOH6wVwZOBbzfF6o13e3wL8SMB+W5WwxICmoaahpmGVx6rkGgpABqoYmAH2Lh4hfK3KfwAAAABJRU5ErkJggg=="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="7">7</div>\n                    <div class="button number icon-group2" role="button" data-value="8">8</div>\n                    <div class="button number icon-group2" role="button" data-value="9">9</div>\n                    <div class="multiply button image operation icon-group1" data-value="*" role="button">\n                        <img class="icon icons8-Multiply" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABBUlEQVRYR+2W6w3CMAyErxuwCYwAG7AJjAATMQKMUDZhBHQSQaFqYp8DqpDSn2nj+3J+NAMWfoaF9dEBugN/4cAewA3AQ+yYFYADgHNtn+UAxS8ARgA7AYLiVwCbF8CpBGEBMBBPvxYgcvE7gG0N3AIguAIhiTO4B8ALIYsrABZESFwFKEFwPRWcmfNpMXpTkO+b1gTfsdpl8YgDCSSH4FpIvBUg2c446px4OxpNQZ5zBlPmxEcZqABz1c6A6rAKOVBrNWVYhRzw9HkIwpMCj/hcd7gK0wJQxEMQFkD6Hat9nqeD94Hw75inarmQHGviLYNIvByVP7dS8DWh6I2oA3QHfu7AEzfHWCF+OOmJAAAAAElFTkSuQmCC"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="4">4</div>\n                    <div class="button number icon-group2" role="button" data-value="5">5</div>\n                    <div class="button number icon-group2" role="button" data-value="6">6</div>\n                    <div class="minus button image operation icon-group1" data-value="-" role="button">\n                        <img class="icon icons8-Minus-Math-" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAARElEQVRYR+3V0Q0AMAQFQPYfuh1A+ql8nAF4LhIZw5XD80MAAgQIECCwVuA0fcmy8EtgPEATQG279gYIECBAgACBbwIXi38CITaYSB4AAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="1">1</div>\n                    <div class="button number icon-group2" role="button" data-value="2">2</div>\n                    <div class="button number icon-group2" role="button" data-value="3">3</div>\n                    <div class="plus button image operation icon-group1" data-value="+" role="button">\n                        <img class="icon icons8-Plus-Math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAWUlEQVRYR+2WMQoAIAgA9f+PrsWmEMQSEa7Z8rzEUmle2pxfABhvYFkPpQtJb7TEAGAAAxgoM3AO/v1YXoPPm4TtANHKy64AAAxgAANjDERB3bjXXzEA8w1s3k4WIU0YaEoAAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="plus-minus button image icon-group1" data-value="+/-" role="button">\n                        <img class="icon icons8-Plus-Minus" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAYUlEQVRYR+2VMQ4AIAgD4f+P1gUdCakx1VB3pL0UcCM/J/c3CfiewIgMwUbgwmgsASLQg8ByiW7tdNIqY0gXkDnvkQEREIGnCaDLaddVFtFxk+wDCagQoN8CugCFUASuEpjXIBIhP3OSdgAAAABJRU5ErkJggg=="></div>\n                    <div class="button number icon-group2" role="button" data-value="0">0</div>\n                    <div class="dot button icon-group1" data-value="." role="button">.</div>\n                    <div class="equal button image operation icon-group1" data-value="=" role="button">\n                        <img class="icon icons8-Equal-Sign" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAQ0lEQVRYR+3U0Q0AMAQFQPYfuh1A+ikkPQMgF0/GcOXw/LAAAQIECLwETtOLLvPWLtAEUNs6wrUCUiAFBAgQIPCPwAX8vwQhcNJI5wAAAABJRU5ErkJggg==" width="32" height="32"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button okbtn icon-group1" role="button">OK</div>\n                </div>\n            </div>\n        </div>\n    </section>\n</div>\n',o._host.querySelector(".okbtn").textContent=l().OK,t.appendChild(n._host),o.YCb(),o.ZCb(),o.$Cb(),o._Cb(),o.aDb("0"),n}return w(t,e),t.prototype.setValue=function(e){var t,n=this;e=n.bDb(e);try{if(!n.Na(e))throw Error(l().Calculator_InvalidInputInfo);e=""===e?"0":e,n.Fi=n.cDb(e),n._text=n.dDb(e),n.XHa=parseFloat(n.Fi),n.YHa=null,n.JCb=null,n.KCb=0,n.Jb=n.eDb(parseFloat(n.Fi)),n.Jb>0?n.MCb=!0:n.MCb=!1,n.NCb=!1,n.OCb=!1,n.PCb=null}catch(e){n._text=l().Calculator_InvalidInputInfo,n.Fi="",n.XHa=null,n.YHa=null,n.OCb=!0}return n.fDb(n.OCb),n.aDb(n._text),(t={}).outputText=n._text,t.result=n.Fi,t.x=n.XHa,t.y=n.YHa,t.operation=n.JCb,t.token=n.KCb,t.count=n.Jb,t.memoryNumber=n.LCb,t.isBSCanUse=n.MCb,t.isEqualClicked=n.NCb,t.isOperationInvalid=n.OCb,t.lastOperation=n.PCb,n.gDb=new b(n.Fi,n.XHa,n.YHa,n.JCb,n.KCb,n.Jb,n.LCb,n.MCb,n.NCb,n.OCb,n.PCb),n},t.prototype.setOptions=function(){},t.prototype.scrollToSelect=function(){var e=this._host.querySelector(".gc-main-screen .gc-main");this.kDb(e)},t.prototype.YCb=function(){var e=this;e.hDb="0",e._text=e.hDb,e.Fi="",e.XHa=0,e.YHa=0,e.JCb=null,e.KCb=0,e.Jb=0,e.LCb=null,e.MCb=!1,e.NCb=!1,e.OCb=!1,e.PCb=null},t.prototype.ZCb=function(){var e=this;e.gDb=new b(this.Fi,e.XHa,e.YHa,e.JCb,e.KCb,e.Jb,e.LCb,e.MCb,e.NCb,e.OCb,e.PCb)},t.prototype.$Cb=function(){this.fDb(this.OCb)},t.prototype._Cb=function(){var e=this,n=this,r=n._host;r.addEventListener("click",(function(i){for(var a,s,l=i.srcElement||i.target;l&&!l.classList.contains("button");)l=l.parentElement;l&&(l.getAttribute("data-value")?(a=l.getAttribute("data-value"),s=t.iDb(a),r.focus(),-1!==s&&n.jDb(s)):l.classList.contains("okbtn")&&("ClickNumericButton"===n.PCb&&n.jDb(19),e.fire(o.BaseDropdown.Event_ValueChanged,{value:n._text,text:n._text})))})),r.addEventListener("keydown",(function(e){!0!==n.XCb(e)&&(e.preventDefault(),e.stopPropagation())})),r.addEventListener("contextmenu",(function(e){e.preventDefault(),e.stopPropagation()}))},t.prototype.aDb=function(e){var t=this._host.querySelector(".gc-main-screen .gc-main"),n=t.value;null!=n&&(""+n).replace(/\r\n/g,"\n")!==(""+e).replace(/\r\n/g,"\n")&&(t.value=e,this.kDb(t))},t.prototype.kDb=function(e){var t=this;if(null!==t.lDb&&void 0!==t.lDb||(t.lDb=parseInt(window.getComputedStyle(e)["font-size"].replace("px",""),0)),t.mDb(e))for(;t.mDb(e);)t.nDb(e);else t.oDb(e)},t.prototype.mDb=function(e){var t,n;return e.scrollWidth>e.clientWidth||!(!a.Ul.Ml.edge&&!a.Ul.Ml.msie)&&!(e.clientWidth<=0)&&(n=(t=window.getComputedStyle(e)).fontWeight+" "+t.fontSize+" "+t.fontFamily,a.Vn.Xn(e.value,n)+40>e.clientWidth)},t.prototype.nDb=function(e){var t=parseInt(window.getComputedStyle(e)["font-size"].replace("px",""),0);e.style.fontSize=t-1+"px"},t.prototype.oDb=function(e){for(var t=this,n=parseInt(window.getComputedStyle(e)["font-size"].replace("px",""),0);!t.mDb(e)&&n<t.lDb;)if(++n,e.style.fontSize=n+"px",t.mDb(e)){for(;t.mDb(e);)t.nDb(e);break}},t.prototype.bDb=function(e){if(void 0===e||"string"!=typeof e&&!(e instanceof String))throw Error(e+" type is not a string.");return null!=e||(e=""),""+e},t.prototype.pDb=function(e,t){var n,o,r,i;if(0===t.length)return"";for(n="",o=0,r=0,o=0;o<t.length;o++){for(i=!1,r=0;r<e.length;r++)t.substring(o,o+1)===e.substring(r,r+1)&&(i=!0);!0===i&&(n+=t.substring(o,o+1))}return n},t.prototype.Na=function(e){if(this.pDb("-.0123456789",e)!==e)return!1;var t=e.indexOf("-");return(-1===t||0===t)&&e.indexOf("-")===e.lastIndexOf("-")&&e.indexOf(".")===e.lastIndexOf(".")},t.prototype.cDb=function(e){var t,n,o,r,i,a=parseFloat(e),s=!1;if(a<0&&(s=!0),t=c(a),n=u(t),o=v.GetDotPosition(""+t),r=(t*f(10,o)-n*f(10,o))/f(10,o),n>999999999999999)throw Error(l().Calculator_InvalidInputInfo);if(999999999999999===n){if(0===r)return n;throw Error(l().Calculator_InvalidInputInfo)}return r=h(r*f(10,i=0===n?15:15-(""+n).length))/f(10,i),o=v.GetDotPosition(""+r),t=(n*f(10,o)+r*f(10,o))/f(10,o),n=u(t),o=v.GetDotPosition(""+t),0===(r=(t*f(10,o)-n*f(10,o))/f(10,o))&&(t=n),s?"-"+t:""+t},t.prototype.dDb=function(e){var t=""+e;return""===t&&(t="0"),t},t.prototype.eDb=function(e){var t=c(e),n=u(t),o=v.GetDotPosition(""+t),r=(t*f(10,o)-n*f(10,o))/f(10,o);return(0===n?0:(""+n).length)+(0===r?0:o)},t.prototype.fDb=function(e){for(var t=10;t<=18;t++)this.qDb(t,e);this.qDb(27,e)},t.prototype.qDb=function(e,t){var n=g[e],o=this._host.querySelector('[data-value="'+n.toLowerCase()+'"]');o&&(t?o.classList.add("disabled"):o.classList.remove("disabled"))},t.iDb=function(e){var t=-1;switch(e){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":t=parseInt(e,10);break;case"+/-":t=10;break;case".":t=11;break;case"+":t=12;break;case"-":t=13;break;case"*":t=14;break;case"/":t=15;break;case"sqrt":t=16;break;case"%":t=17;break;case"1/x":t=18;break;case"=":t=19;break;case"MC":t=20;break;case"MR":t=21;break;case"MS":t=22;break;case"M+":t=23;break;case"BS":t=24;break;case"CE":t=25;break;case"C":t=26;break;case"pow":t=27;break;default:t=-1}return t},t.prototype.jDb=function(e){var t=this,n=t.gDb.Click(e);null!=n&&(null!==n.result&&void 0!==n.result&&(t.Fi=n.result),null!==n.outputText&&void 0!==n.outputText&&(t.hDb=n.outputText,t._text=t.hDb,t.aDb(t.hDb)),null!==n.isOperationInvalid&&void 0!==n.isOperationInvalid&&n.isOperationInvalid!==t.OCb&&(t.OCb=n.isOperationInvalid,t.fDb(t.OCb)),n.memoryNumber!==t.LCb&&(t.LCb=n.memoryNumber),n.lastOperation!==t.PCb&&(t.PCb=n.lastOperation))},t.prototype.XCb=function(e){var t=this.gDb.XCb(e);return null==t||-1!==t&&void this.jDb(t)},t}(o.BaseDropdown),t.Calculator=C},"./dist/plugins/celltype/editor/calendar.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function te(e){return f.createElement(e)}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/eventbase.js"),r=n("./dist/plugins/celltype/editor/timepicker.js"),i=n("./dist/plugins/celltype/editor/baseControl.js"),a=n("./dist/plugins/celltype/celltypes.ns.js"),s=n("@grapecity/js-sheets-common"),l=n("Core"),u=new s.Common.ResourceManager(a.SR),c=u.getResource.bind(u),f=document,h="gc-content-container",p="gc-header-container",d="gc-header-title",g="gc-year-page",m="gc-month-page",y="gc-day-page",v="gc-left-arrow",b="gc-right-arrow",C="gc-is-focused",w="gc-cl-is-selected",x="gc-cl-disabled-text",A="gc-cl-select-container",M="gc-focus-part-indicator",S="gc-cl-datepicker",T="gc-cl-dropdown",N="gc-cl-datepicker-filter",I="gc-cl-datepicker-filter-month",R="gc-cl-grid-align-spread",k="gc-cl-align-middle",E="gc-cl-button-icon-container",D="gc-cl-datepicker-month",j="gc-cl-day",_="gc-cl-grow",O="gc-cl-grid",F="gc-cl-button",P="year-index",H="month-index",B="week-index",L="day-index",function(e){e[e.Date=1]="Date",e[e.Time=2]="Time"}(z||(z={})),V=function(){function e(){}return e.initResource=function(){e.resource={shortWeeks:[c().Calendar_ShortWeeks_1,c().Calendar_ShortWeeks_2,c().Calendar_ShortWeeks_3,c().Calendar_ShortWeeks_4,c().Calendar_ShortWeeks_5,c().Calendar_ShortWeeks_6,c().Calendar_ShortWeeks_7],shortMonths:[c().Calendar_ShortMonths_1,c().Calendar_ShortMonths_2,c().Calendar_ShortMonths_3,c().Calendar_ShortMonths_4,c().Calendar_ShortMonths_5,c().Calendar_ShortMonths_6,c().Calendar_ShortMonths_7,c().Calendar_ShortMonths_8,c().Calendar_ShortMonths_9,c().Calendar_ShortMonths_10,c().Calendar_ShortMonths_11,c().Calendar_ShortMonths_12],weeks:[c().Calendar_Weeks_7,c().Calendar_Weeks_1,c().Calendar_Weeks_2,c().Calendar_Weeks_3,c().Calendar_Weeks_4,c().Calendar_Weeks_5,c().Calendar_Weeks_6],months:[c().Calendar_Months_1,c().Calendar_Months_2,c().Calendar_Months_3,c().Calendar_Months_4,c().Calendar_Months_5,c().Calendar_Months_6,c().Calendar_Months_7,c().Calendar_Months_8,c().Calendar_Months_9,c().Calendar_Months_10,c().Calendar_Months_11,c().Calendar_Months_12],timePrefix:[c().Calendar_Time_AM,c().Calendar_Time_PM],eraNames:[c().Calendar_EraName_1,c().Calendar_EraName_2,c().Calendar_EraName_3,c().Calendar_EraName_4],earFirstYear:c().Calendar_FirstYear,today:c().Calendar_Today,lastMonth:c().Calendar_LastMonth,nextMonth:c().Calendar_NextMonth,lastYear:c().Calendar_LastYear,nextYear:c().Calendar_NextYear,lastTenYears:c().Calendar_LastTenYear,nextTenYears:c().Calendar_NextTenYear}},e.resource={shortWeeks:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],shortMonths:["Jan","Feb","Mar","Api","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weeks:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],months:["January","February","March","Apirl","May","June","July","August","September","October","November","December"],timePrefix:["AM","PM"],eraNames:["M","T","S","H"],earFirstYear:"1",today:"Today",lastMonth:"Go to previous month",nextMonth:"Go to next month",lastYear:"Go to previous year",nextYear:"Go to next year",lastTenYears:"Go to previous ten years",nextTenYears:"Go to next ten years"},e}(),G=function(){this.yearTds=[]},W=function(){this.monthTds=[]},U=function(){this.weekThs=[],this.dayTds=[]},Z=function(){this.calendarYearSection=new G,this.calendarMonthSection=new W,this.calendarDaySection=new U,this.timeItemLIs=[]},q=function(){function e(){}return e.dateEqual=function(e,t,n){if(!e&&!t)return!0;if(!e)return!1;if(!t)return!1;try{return n?e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()&&e.getHours()===t.getHours()&&e.getMinutes()===t.getMinutes()&&e.getSeconds()===t.getSeconds():e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}catch(e){return!1}},e.getMonthMaxDay=function(e,t){return-1!==[1,3,5,7,8,10,12].indexOf(t)?31:-1!==[4,6,9,11].indexOf(t)?30:e%4==0&&e%100!=0?29:28},e.isValidEraDate=function(e){return!(e<this.eraMin||e>this.eraMax)},e.addMilliseconds=function(e,t){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());return n.setMilliseconds(n.getMilliseconds()+t),new Date(n.valueOf())},e.getEraDate=function(t){var n,o={era:-1,eraYear:-1};if(!e.isValidEraDate(t))return o;for(n=0;n<e.eraCount;n++)if(t<(n+1!==e.eraCount?e.eraDates[n+1]:e.addMilliseconds(e.eraMax,1))){o.era=n,o.eraYear=t.getFullYear()-e.eraDates[n].getFullYear()+1;break}return o},e.getEraYearString=function(t){var n=new Date(t,5,30),o=e.getEraDate(n);return-1===o.era||-1===o.eraYear?""+t:t+""},e.getShortEraYearString=function(t){var n,o=new Date(t,11,31),r=e.getEraDate(o);return-1===r.era||-1===r.eraYear?"":(n=1===r.eraYear?V.resource.earFirstYear:r.eraYear,V.resource.eraNames[r.era]+n+"")},e.getDateLocaleLabel=function(e){var t=e.getHours(),n=e.getMinutes();return(t<12?V.resource.timePrefix[0]:V.resource.timePrefix[1])+" "+(0===t||12===t?"12":""+t%12)+":"+(n<10?"0"+n:""+n)},e.eraCount=4,e.eraMax=new Date(2087,11,31,23,59,59),e.eraMin=new Date(1868,8,8),e.eraDates=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)],e}(),J=function(){function e(e,t,n,o){this.year=e,this.selected=!!t,this.disabled=!!n,this.focused=!!o}return e.prototype.getLabel=function(){return""+this.year},e}(),Q=function(){function e(e,t,n,o){this.month=e,this.selected=!!t,this.disabled=!!n,this.focused=!!o}return e.prototype.getLabel=function(){return V.resource.shortMonths[this.month]},e}(),Y=function(){function e(e,t,n,o){this.date=e,this.selected=!!t,this.disabled=!!n,this.focused=!!o}return e.prototype.getLabel=function(){return""+this.date.getDate()},e}(),K=function(){function e(e){this.owner=e,this.calendarPage=l.CalendarPage.month,this.oldSelectedData=null,this.selectedDate=new Date,this.focusDate=new Date(this.selectedDate.valueOf()),this.focusDateTimeIndex=-1,V.initResource()}return e.getMonthName=function(e){return V.resource.months[e]},e.getShortMonthName=function(e){return V.resource.shortMonths[e]},e.prototype.updateDayItems=function(){var e,t,n,o,r,i,a;for(this.dayItems=[],e=this.focusDate.getFullYear(),t=this.focusDate.getMonth(),r=o=((n=new Date(e,t,1).getDay()-this.owner.rDb)<0?n+7:n)%7;r>0;r--)(i=new Date(e,t,1)).setDate(i.getDate()-r),a=new Y(i,!1,!0,!1),this.dayItems.push(a);for(r=1;r<=42-o;r++)i=new Date(e,t,r),a=new Y(i),i.getMonth()!==t&&(a.disabled=!0),q.dateEqual(i,this.selectedDate)&&(a.selected=!0),q.dateEqual(i,this.selectedDate)&&(a.selected=!0),q.dateEqual(i,this.focusDate)&&(a.focused=!0),this.dayItems.push(a)},e.prototype.updateMonthItems=function(){var e,t,n=this.selectedDate,o=this.focusDate;for(this.monthItems=[],e=0;e<12;e++)(t=new Q(e)).selected=n&&n.getMonth()===e&&n.getFullYear()===o.getFullYear(),t.focused=o&&o.getMonth()===e,this.monthItems.push(t)},e.prototype.updateYearItems=function(){var e,t;for(this.yearItems=[],e=this.focusDateYearRangeStart-1;e<=this.focusDateYearRangeEnd+1;e++)(t=new J(e)).selected=this.selectedDate&&this.selectedDate.getFullYear()===e,t.focused=this.focusDate&&this.focusDate.getFullYear()===e,t.disabled=e<this.focusDateYearRangeStart||e>this.focusDateYearRangeEnd,this.yearItems.push(t)},e.prototype.updateYearRange=function(){this.focusDateYearRangeStart=10*Math.floor(this.focusDate.getFullYear()/10),this.focusDateYearRangeEnd=this.focusDateYearRangeStart+9},e.prototype.getShortWeekName=function(e){return V.resource.shortWeeks[e=(this.owner.rDb+e-1)%7]},e.prototype.getCurrentMonthName=function(){var t=this.focusDate.getMonth();return e.getMonthName(t)},e}(),$=function(e){function t(t){var n=e.call(this)||this;return n.sDb=40,n.tDb=100,n.uDb=!1,n.tc=t,n}return ee(t,e),Object.defineProperty(t.prototype,"host",{get:function(){return this.tc.getContainer()},enumerable:!0,configurable:!0}),t.prototype.createCalendarDom=function(){var e,t,n,o,r,i,a,s=this.tc;this.vDb=new Z,(e=te("div")).tabIndex=0,e.classList.add("gc-calendar-container"),s.JK?e.classList.add("gc-date-time-container"):e.classList.add("gc-date-container"),t=te("table"),n=te("tr"),(o=te("td")).classList.add("gc-content-td-date"),s.JK&&o.classList.add("gc-content-td-time"),o.appendChild(this.wDb()),n.appendChild(o),t.appendChild(n),e.appendChild(t),s.JK&&(r=te("tr"),i=te("td"),o.appendChild(this.xDb()),o.appendChild(this.yDb()),i.appendChild(this.zDb()),i.appendChild(this.ADb()),r.appendChild(i),t.appendChild(r)),this.vDb.outterContainerDiv=e,(a=this.host)&&(a.innerHTML="",a.appendChild(e))},t.prototype.ADb=function(){var e,t=te("div");return t.classList.add("gc-ok-button-container"),(e=te("button")).textContent="OK",e.className=F+" gc-cl-button-brand gc-uiButton",t.appendChild(e),this.vDb.okButton=e,t},t.prototype.xDb=function(){var e=te("div");return e.classList.add("gc-date-time-vertical-partline"),e},t.prototype.zDb=function(){var e=te("div");return e.classList.add("gc-date-time-horizontal-partline"),e},t.prototype.wDb=function(){var e=te("div");return e.className="gc-date-part-container "+S+" "+T,e.tabIndex=0,e.appendChild(this.BDb()),e.appendChild(this.CDb()),e.appendChild(this.DDb()),this.vDb.dateContainerDiv=e,e},t.prototype.BDb=function(){var e=te("div");return e.classList.add(g),e.appendChild(this.EDb()),e.appendChild(this.FDb()),e},t.prototype.EDb=function(){var e,t,n,o,r,i,a,s=te("div");return s.className=p+" "+N+" "+O,(e=te("div")).className=I+" "+O+" "+R+" "+_,te("div").classList.add(k),(t=te("button")).className=F+" "+E,t.title=c().Calendar_LastTenYear,(n=te("div")).classList.add(v),t.appendChild(n),(o=te("span")).classList.add(k),(r=te("button")).className=F+" "+E,r.title=c().Calendar_NextTenYear,(i=te("div")).classList.add(b),r.appendChild(i),e.appendChild(t),e.appendChild(o),e.appendChild(r),(a=this.vDb.calendarYearSection).headerDiv=s,a.lastYearRangeButton=t,a.focusDateYearRangeName=o,a.nextYearRangeButton=r,s.appendChild(e),s},t.prototype.FDb=function(){var e,t=te("table");return t.className=h+" "+D,(e=te("div")).appendChild(t),this.vDb.calendarYearSection.currentYearRangeTable=t,this.GDb(),e},t.prototype.GDb=function(){var e,t,n,o,r,i=this.vDb.calendarYearSection,a=te("tbody");for(e=0;e<3;e++){for(t=te("tr"),n=0;n<4;n++)(o=te("td")).setAttribute(P,""+(4*e+n)),(r=te("span")).classList.add(j),r.setAttribute(P,""+(4*e+n)),r.innerText=""+(4*e+n+1),o.appendChild(r),t.appendChild(o),i.yearTds.push(o);a.appendChild(t)}i.currentYearRangeTable.appendChild(a)},t.prototype.CDb=function(){var e=te("div");return e.classList.add(m),e.appendChild(this.HDb()),e.appendChild(this.IDb()),e},t.prototype.HDb=function(){var e,t,n,o,r,i,a,s=te("div");return s.className=p+" "+N+" "+O,(e=te("div")).className=I+" "+O+" "+R+" "+_,te("div").classList.add(k),(t=te("button")).className=F+" "+E,t.title=c().Calendar_LastYear,(n=te("div")).classList.add(v),t.appendChild(n),(o=te("span")).className=d+" "+k,(r=te("button")).className=F+" "+E,r.title=c().Calendar_NextYear,(i=te("div")).classList.add(b),r.appendChild(i),e.appendChild(t),e.appendChild(o),e.appendChild(r),(a=this.vDb.calendarMonthSection).headerDiv=s,a.lastYearButton=t,a.currentYearName=o,a.nextYearButton=r,s.appendChild(e),s},t.prototype.IDb=function(){var e,t=te("table");return t.className=h+" "+D,(e=te("div")).appendChild(t),this.vDb.calendarMonthSection.currentYearTable=t,this.JDb(),e},t.prototype.JDb=function(){var e,t,n,o,r,i=this.vDb.calendarMonthSection,a=te("tbody");for(e=0;e<3;e++){for(t=te("tr"),n=0;n<4;n++)(o=te("td")).setAttribute(H,""+(4*e+n+1)),(r=te("span")).classList.add(j),r.setAttribute(H,""+(4*e+n+1)),r.innerText=""+(4*e+n+1),o.appendChild(r),t.appendChild(o),i.monthTds.push(o);a.appendChild(t)}i.currentYearTable.appendChild(a)},t.prototype.DDb=function(){var e=te("div");return e.classList.add(y),e.appendChild(this.KDb()),e.appendChild(this.LDb()),e.appendChild(this.MDb()),e.appendChild(this.NDb()),e},t.prototype.KDb=function(){var e,t,n,o,r,i,a,s,l,u,f,h,g,m,y,C=te("div");for(C.className=p+" "+N+" "+O,(e=te("div")).className=I+" "+O+" "+R+" "+_,te("div").classList.add(k),(t=te("button")).className=F+" "+E,t.title=c().Calendar_LastMonth,(n=te("div")).classList.add(v),t.appendChild(n),(o=te("span")).className=d+" "+k,(r=te("button")).className=F+" "+E,r.title=c().Calendar_NextMonth,(i=te("div")).classList.add(b),r.appendChild(i),e.appendChild(t),e.appendChild(o),e.appendChild(r),(a=te("div")).className="gc-year-select-div gc-cl-shrink-none",(s=te("div")).classList.add(A),(l=te("select")).classList.add("gc-cl-select"),f=(u=new Date).getFullYear()-this.tDb,h=u.getFullYear()+this.sDb,g=f;g<=h;g++)(m=te("option")).text=""+g,m.value=""+g,l.options.add(m);return te("div").classList.add(A),s.appendChild(l),a.appendChild(s),C.appendChild(a),C.appendChild(e),(y=this.vDb.calendarDaySection).headerDiv=C,y.lastMonthButton=t,y.currentMonthName=o,y.nextMonthButton=r,y.yearSelect=l,C},t.prototype.LDb=function(){var e,t,n,o,r,i,a=te("div");for(a.className="gc-week-container "+N+" "+O,(e=te("table")).className=h+" "+D,t=te("thead"),n=te("tr"),o=0;o<7;o++)(r=te("th")).setAttribute(B,""+o),(i=te("span")).classList.add("gc-cl-week"),i.setAttribute(B,""+o),i.innerText=this.tc.aT.getShortWeekName(o),r.appendChild(i),n.appendChild(r),this.vDb.calendarDaySection.weekThs.push(r);return t.appendChild(n),e.appendChild(t),a.appendChild(e),a},t.prototype.MDb=function(){var e,t,n,o,r,i,a=this.vDb.calendarDaySection,s=te("div"),l=te("div"),u=te("table");for(u.className=h+" "+D,e=te("tbody"),t=0;t<6;t++){for(n=te("tr"),o=0;o<7;o++)(r=te("td")).setAttribute(L,""+(7*t+o)),(i=te("span")).classList.add(j),i.setAttribute(L,""+(7*t+o)),r.appendChild(i),n.appendChild(r),a.dayTds.push(r);e.appendChild(n)}return u.appendChild(e),l.appendChild(u),s.appendChild(l),a.dayContentTable=u,s},t.prototype.NDb=function(){var e,t,n,o,r,i=te("div");return i.classList.add("gc-today-container"),(e=te("table")).classList.add(h),t=te("tbody"),n=te("tr"),o=te("td"),(r=te("a")).href="javascript:void(0);",r.className="gc-cl-show-inline-block gc-cl-p-bottom-x-small",r.innerText=V.resource.today,o.appendChild(r),n.appendChild(o),t.appendChild(n),e.appendChild(t),i.appendChild(e),this.vDb.calendarDaySection.todayTd=o,this.vDb.calendarDaySection.todayTable=e,i},t.prototype.yDb=function(){var e=this,t=te("div");return t.className="gc-time-part-container "+S+" "+T,t.tabIndex=0,this.vDb.timeContainerDiv=t,this.ODb=new r.TimePicker(t),this.ODb.setOptions({step:{minute:30},height:260}),this.ODb.on(i.BaseDropdown.Event_ValueChanged,(function(t){e.PDb(t)})),t},t.prototype.updateCalendarDom=function(){this.QDb(),this.tc.JK&&this.RDb()},t.prototype.QDb=function(){switch(this.tc.aT.calendarPage){case l.CalendarPage.year:this.SDb();break;case l.CalendarPage.month:this.TDb();break;case l.CalendarPage.day:this.UDb()}},t.prototype.VDb=function(){var e,t,n,o,r,i=this.tc.aT,a=this.vDb.calendarDaySection,s=!1;for(a.currentMonthName.innerText=i.getCurrentMonthName(),e=i.focusDate.getFullYear(),t=a.yearSelect,n=0;n<t.options.length;n++)if(""+e===t.options[n].value){t.selectedIndex=n,s=!0;break}o=this.sDb+this.tDb+1,s?t.options[o]&&t.selectedIndex<=o-1&&t.options[o].remove():((r=te("option")).text=""+e,r.value=""+e,t.options[o]=r,t.selectedIndex=o)},t.prototype.SDb=function(){var e,t,n,o,r,i,a,s,l=this.tc.aT,u=this.vDb.calendarYearSection;for(l.updateYearItems(),u.focusDateYearRangeName.innerText=l.focusDateYearRangeStart+" - "+l.focusDateYearRangeEnd,e=u.yearTds,t=l.yearItems,n=0;n<3;n++)for(o=0;o<4;o++)i=t[r=4*n+o],(s=(a=e[r]).querySelector("span")).innerText=i.getLabel(),i.disabled?a.classList.add(x):a.classList.remove(x),i.selected?a.classList.add(w):a.classList.remove(w),i.focused?s.classList.add(C):s.classList.remove(C)},t.prototype.TDb=function(){var e,t,n,o,r,i,a,s,l,u=this.tc.aT,c=this.vDb.calendarMonthSection;for(u.updateMonthItems(),e=u.focusDate.getFullYear(),t=u.monthItems,n=c.monthTds,c.currentYearName.innerText=""+e,o=0;o<3;o++)for(r=0;r<4;r++)a=t[i=4*o+r],(l=(s=n[i]).querySelector("span")).innerText=a.getLabel(),a.selected?s.classList.add(w):s.classList.remove(w),a.focused?l.classList.add(C):l.classList.remove(C)},t.prototype.UDb=function(){this.VDb(),this.WDb()},t.prototype.WDb=function(){var e,t,n,o,r,i,a,s,l=this.tc.aT;for(l.updateDayItems(),e=l.dayItems,t=this.vDb.calendarDaySection.dayTds,n=0;n<6;n++)for(o=0;o<7;o++)i=e[r=7*n+o],(s=(a=t[r]).querySelector("span")).innerText=i.getLabel(),i.disabled?a.classList.add(x):a.classList.remove(x),i.focused?s.classList.add(C):s.classList.remove(C),i.selected?a.classList.add(w):a.classList.remove(w)},t.prototype.RDb=function(){this.ODb.setValue(this.tc.aT.selectedDate)},t.prototype.attachEvent=function(){this.XDb(),this.attachDateEvent(),this.tc.JK&&this.attachTimeEvent()},t.prototype.XDb=function(){var e=this;this.vDb.outterContainerDiv.addEventListener("keydown",(function(t){e.YDb(t)}))},t.prototype.YDb=function(e){return 9===e.keyCode?(this.tc.JK&&(this.tc.aT.calendarActivePart===z.Date?this.setCalendarActivePart(z.Time):this.setCalendarActivePart(z.Date)),void e.preventDefault()):void(this.tc.aT.calendarActivePart===z.Date&&this.ZDb(e))},t.prototype.ZDb=function(e){switch(this.tc.aT.calendarPage){case l.CalendarPage.year:this.$Db(e);break;case l.CalendarPage.month:this._Db(e);break;case l.CalendarPage.day:this.aEb(e)}},t.prototype.$Db=function(e){var t=this.tc.aT,n=t.focusDate;switch(e.keyCode){case 13:t.selectedDate=new Date(n.valueOf()),this.showCalendarPage(l.CalendarPage.month);break;case 32:t.selectedDate=new Date(n.valueOf());break;case 37:this.bEb();break;case 39:this.cEb();break;case 38:this.bEb(4);break;case 40:e.ctrlKey||e.metaKey?this.dEb():this.cEb(4);break;case 36:n.setFullYear(t.focusDateYearRangeStart);break;case 35:n.setFullYear(t.focusDateYearRangeEnd);break;case 33:this.eEb();break;case 34:this.fEb()}t.updateYearRange(),this.QDb()},t.prototype._Db=function(e){var t=this.tc.aT,n=t.focusDate;switch(e.keyCode){case 13:t.selectedDate=new Date(n.valueOf()),this.showCalendarPage(l.CalendarPage.day);break;case 32:t.selectedDate=new Date(n.valueOf());break;case 37:this.gEb();break;case 39:this.hEb();break;case 38:e.ctrlKey||e.metaKey?this.iEb():this.gEb(4);break;case 40:e.ctrlKey||e.metaKey?this.jEb():this.hEb(4);break;case 36:n.setMonth(0);break;case 35:n.setMonth(11);break;case 33:this.bEb();break;case 34:this.cEb()}this.QDb()},t.prototype.aEb=function(e){var t=this.tc.aT,n=t.focusDate,o=n.getFullYear(),r=n.getMonth(),i=n.getDate(),a=q.getMonthMaxDay(o,r+1);switch(e.keyCode){case 13:return t.selectedDate=new Date(n.valueOf()),void this.lEb();case 32:t.selectedDate=new Date(n.valueOf());break;case 37:n.setDate(i-1);break;case 39:n.setDate(i+1);break;case 38:n.setDate(i-7);break;case 40:n.setDate(i+7);break;case 36:n.setDate(1);break;case 35:n.setDate(a);break;case 33:e.shiftKey?this.gEb(12):this.gEb();break;case 34:e.shiftKey?this.hEb(12):this.hEb()}t.selectedDate=new Date(n.valueOf()),this.QDb()},t.prototype.attachDateEvent=function(){var e=this;this.vDb.dateContainerDiv.addEventListener("click",(function(t){var n=t.target;(!n||n!==e.vDb.calendarDaySection.yearSelect&&n.parentElement!==e.vDb.calendarDaySection.yearSelect)&&e.setCalendarActivePart(z.Date)})),this.attachYearEvent(),this.attachMonthEvent(),this.attachDayEvent()},t.prototype.attachYearEvent=function(){var e=this;this.vDb.calendarYearSection.lastYearRangeButton.addEventListener("click",(function(t){e.eEb(),e.QDb()})),this.vDb.calendarYearSection.nextYearRangeButton.addEventListener("click",(function(t){e.fEb(),e.QDb()})),this.vDb.calendarYearSection.currentYearRangeTable.addEventListener("click",(function(t){e.mEb(t)}))},t.prototype.eEb=function(){var e=this.tc.aT;e.focusDateYearRangeStart-=10,e.focusDateYearRangeEnd=e.focusDateYearRangeStart+9,e.focusDate.setFullYear(e.focusDate.getFullYear()-10)},t.prototype.fEb=function(){var e=this.tc.aT;e.focusDateYearRangeStart+=10,e.focusDateYearRangeEnd=e.focusDateYearRangeStart+9,e.focusDate.setFullYear(e.focusDate.getFullYear()+10)},t.prototype.dEb=function(){this.showCalendarPage(l.CalendarPage.month)},t.prototype.mEb=function(e){var t,n,o=e.srcElement||e.target;o&&(t=+o.getAttribute(P),n=this.tc.aT.yearItems[t],this.tc.aT.focusDate.setFullYear(n.year),this.dEb())},t.prototype.attachMonthEvent=function(){var e=this;this.vDb.calendarMonthSection.lastYearButton.addEventListener("click",(function(t){e.bEb(),e.QDb()})),this.vDb.calendarMonthSection.nextYearButton.addEventListener("click",(function(t){e.cEb(),e.QDb()})),this.vDb.calendarMonthSection.currentYearName.addEventListener("click",(function(t){e.iEb()})),this.vDb.calendarMonthSection.currentYearTable.addEventListener("click",(function(t){e.nEb(t)}))},t.prototype.bEb=function(e){var t=e||1,n=Math.max(this.tc.aT.focusDate.getFullYear()-t,0);this.tc.aT.focusDate.setFullYear(n)},t.prototype.cEb=function(e){var t=e||1,n=Math.min(this.tc.aT.focusDate.getFullYear()+t,9999);this.tc.aT.focusDate.setFullYear(n)},t.prototype.iEb=function(){this.tc.aT.updateYearRange(),this.showCalendarPage(l.CalendarPage.year)},t.prototype.jEb=function(){this.showCalendarPage(l.CalendarPage.day)},t.prototype.nEb=function(e){var t,n=e.srcElement||e.target;n&&(t=+n.getAttribute(H),this.tc.aT.focusDate.setMonth(t-1),this.jEb())},t.prototype.attachDayEvent=function(){var e=this,t=this.vDb.calendarDaySection;t.lastMonthButton.addEventListener("click",(function(t){e.gEb(),e.uDb||e.QDb()})),t.nextMonthButton.addEventListener("click",(function(t){e.hEb(),e.uDb||e.QDb()})),t.currentMonthName.addEventListener("click",(function(t){e.oEb()})),t.todayTable.addEventListener("click",(function(t){e.pEb()})),t.dayContentTable.addEventListener("click",(function(t){e.qEb(t)})),t.yearSelect.addEventListener("change",(function(t){e.rEb(t)})),this.vDb.calendarDaySection.yearSelect.addEventListener("keydown",(function(e){e.stopPropagation()}))},t.prototype.gEb=function(e){var t,n,o=this.tc.aT,r=e||1,i=o.focusDate.getFullYear(),a=o.focusDate.getMonth()-r,s=o.focusDate.getDate();a<0&&(a+=12,i-=1),t=q.getMonthMaxDay(i,a+1),n=new Date(i,a,Math.min(s,t)),o.focusDate=n},t.prototype.hEb=function(e){var t,n,o=this.tc.aT,r=e||1,i=o.focusDate.getFullYear(),a=o.focusDate.getMonth()+r,s=o.focusDate.getDate();a>11&&(a-=12,i+=1),t=q.getMonthMaxDay(i,a+1),n=new Date(i,a,Math.min(s,t),o.focusDate.getHours(),o.focusDate.getMinutes(),o.focusDate.getSeconds()),o.focusDate=n},t.prototype.oEb=function(){this.showCalendarPage(l.CalendarPage.month)},t.prototype.qEb=function(e){var t,n,o,r,i=this.tc.aT,a=e.srcElement||e.target;a&&(t=a.getAttribute(L),n=i.dayItems[+t].date,r=(o=i.selectedDate)?new Date(o.valueOf()):new Date,i.selectedDate=new Date(n.getFullYear(),n.getMonth(),n.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),i.focusDate=new Date(i.selectedDate.valueOf()),this.QDb(),this.tc.JK||this.lEb()),this.vDb.dateContainerDiv.focus()},t.prototype.pEb=function(){var e=this.tc,t=e.aT.selectedDate,n=t?new Date(t.valueOf()):null,o=new Date;n&&(o.setHours(n.getHours()),o.setMinutes(n.getMinutes()),o.setSeconds(0)),e.aT.selectedDate=o,e.aT.focusDate=new Date(o.valueOf()),this.QDb(),e.JK||this.lEb()},t.prototype.rEb=function(e){var t=e.srcElement||e.target;t&&(this.tc.aT.focusDate.setFullYear(+t.value),this.updateCalendarDom())},t.prototype.attachTimeEvent=function(){var e=this;this.vDb.timeContainerDiv.addEventListener("click",(function(t){e.setCalendarActivePart(z.Time)})),this.vDb.okButton.addEventListener("click",(function(t){e.lEb()}))},t.prototype.PDb=function(e){var t=this.tc.aT,n=t.selectedDate?new Date(t.selectedDate.valueOf()):new Date,o=e.value;n.setHours(o.getHours()),n.setMinutes(o.getMinutes()),n.setSeconds(o.getSeconds()),t.selectedDate=n,t.focusDate=new Date(n.valueOf())},t.prototype.lEb=function(){var e=this.tc.aT;this.fire(i.BaseDropdown.Event_ValueChanged,{oldValue:e.oldSelectedData,newValue:e.selectedDate}),e.oldSelectedData=e.selectedDate},t.prototype.showCalendarPage=function(e){var t=this.host.querySelector("."+g),n=this.host.querySelector("."+m),o=this.host.querySelector("."+y);switch(t.style.display="none",n.style.display="none",o.style.display="none",e){case l.CalendarPage.year:t.style.display="";break;case l.CalendarPage.month:n.style.display="";break;case l.CalendarPage.day:o.style.display=""}this.tc.aT.calendarPage=e,this.updateCalendarDom()},t.prototype.setCalendarActivePart=function(e){switch(this.tc.aT.calendarActivePart=e,this.vDb.dateContainerDiv.classList.remove(M),this.tc.JK&&this.vDb.timeContainerDiv.classList.remove(M),e){case z.Date:this.tc.JK&&this.vDb.dateContainerDiv.classList.add(M),this.vDb.outterContainerDiv.focus();break;case z.Time:this.tc.JK&&this.vDb.timeContainerDiv.classList.add(M),this.vDb.outterContainerDiv.focus()}},t.Event_GetHost="GetHost",t}(o.EventBase),X=function(e){function t(t,n){var o=e.call(this,t)||this;return o.rDb=7,o.JK=!0,o.aT=new K(o),o._render=new $(o),o._render.on(i.BaseDropdown.Event_ValueChanged,(function(e){var t=s.Common.CultureManager.q4().DateTimeFormat,n=new s.Formatter.GeneralFormatter(t.shortDatePattern+" h:mm:ss").format(e.newValue);o.fire(i.BaseDropdown.Event_ValueChanged,{text:n,value:e.newValue})})),o._render.on($.Event_GetHost,(function(e){e.host=o._host})),o._render.createCalendarDom(),o._render.attachEvent(),o.setValue(new Date),o._render.showCalendarPage(l.CalendarPage.day),o._render.setCalendarActivePart(z.Date),n&&o.setOptions(n),o}return ee(t,e),t.prototype.setOptions=function(e){var t,n;e&&(e.showTime||(this.JK=e.showTime,this._render.createCalendarDom(),this._render.attachEvent()),t=e&&e.calendarPage?e.calendarPage:l.CalendarPage.day,(n=e&&e.startDay?e.startDay:l.CalendarStartDay.saturday)!==this.rDb&&(this.rDb=n,this._host.innerHTML="",this._render.createCalendarDom(),this._render.attachEvent()),this._render.showCalendarPage(t),this._render.setCalendarActivePart(z.Date))},t.prototype.setValue=function(e){var t=this.aT;t.selectedDate=e,t.oldSelectedData=new Date(e.valueOf()),t.focusDate=new Date(e.valueOf()),t.updateYearRange()},t.prototype.scrollToSelect=function(){this._render.updateCalendarDom()},t}(i.BaseDropdown),t.Calendar=X},"./dist/plugins/celltype/editor/colorpicker.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/listControl.js"),r=n("Core"),i=n("./dist/plugins/celltype/editor/baseControl.js"),a=n("./dist/plugins/celltype/celltypes.ns.js"),s=n("@grapecity/js-sheets-common"),l=s.Common.j.Fa,u="group-name",c=new s.Common.ResourceManager(a.SR),f=c.getResource.bind(c),h=function(e){function t(t,n){var o=e.call(this,t)||this;return o.ad(),o.setOptions(n),o}return p(t,e),t.prototype.setOptions=function(e){if(e){if(this.options=this.options||{},!l(e.colorBlockSize)){var t=parseInt(e.colorBlockSize,10);!isNaN(t)&&t>=0&&(this.options.colorBlockSize=e.colorBlockSize)}l(e.groups)||(this.options.groups=e.groups),this.VF()}else this.VF()},t.prototype.setValue=function(e){l(e)||(this.BYa=e,this.sEb=null,this.VF())},t.prototype.ad=function(){var e,n=this,o=t.DefaultColorGroup(),r=[];for(e=0;e<o.length;e++)r.push({name:o[e].name,colors:o[e].colors,needScaleColor:o[e].needScaleColor});this.options={colorBlockSize:t.DefaultCellWidth,groups:r},this.tEb=document.createElement("div"),this.tEb.classList.add("gc-color-picker-outer-div"),this.tEb.addEventListener("click",(function(e){n.uEb(e)})),this._host.appendChild(this.tEb)},t.prototype.VF=function(){this.tEb.innerHTML="",new o.List(this.tEb,this.vEb()),this.wEb()},t.prototype.wEb=function(){var e,t,n,o=this.tEb.querySelectorAll(".gc-color-picker-color-cell");if(o.length>0)for(e=0;e<o.length;e++)o[e].classList.remove("selected"),t=o[e].getAttribute("color"),n=o[e].getAttribute(u),this.BYa===t&&(!this.sEb||this.sEb&&this.sEb===n)&&o[e].classList.add("selected")},t.prototype.xEb=function(){var e,t,n,o,r=0,i=this.options.groups;for(e=0;e<i.length;e++)for(t=i[e],n=0;n<t.colors.length;n++)o=t.colors[n],r=Math.max(r,o.length);return r},t.prototype.vEb=function(){var e,n,o,r=[],i=this.options.colorBlockSize||t.DefaultCellWidth,a=this.xEb(),s=this.options.groups;for(e=0;e<s.length;e++)n=this.yEb(s[e],i,a),r.push(n),s[e].needScaleColor&&(o=this.zEb(s[e].colors[0]),r.push(this.yEb(o,i,a)));return{items:r}},t.prototype.zEb=function(e){var t,n,o,r,i,a,s,l,u,c,f,h,p,d={},g=[];g.length=5,t=[-5,-15,-25,-35,-50],n=[-10,-25,-50,-75,-90],o=[80,60,40,-25,-50],r=document.createElement("span"),i=e.length,r.style.display="none",document.body.appendChild(r);try{for(a=0;a<i;a++)for(l=(s=this.AEb(e[a],r))[0],u=s[1],c=s[2],f=this.BEb(l,u,c),h=0;h<5;h++)g[h]||((p=[]).length=i,g[h]=p),g[h][a]=1===f?this.CEb(l,u,c,t[h]):f>=.8?this.CEb(l,u,c,n[h]):0===f?this.CEb(l,u,c,Math.abs(t[5-h-1])):f<=.2?this.CEb(l,u,c,Math.abs(n[5-h-1])):this.CEb(l,u,c,o[h]);d.colors=g}finally{document.body.removeChild(r)}return d},t.prototype.AEb=function(e,t){var n;return t.style.color=e,n=window.getComputedStyle(t).color.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(","),[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10)]},t.prototype.CEb=function(e,t,n,o){var r,i,a;return o/=100,r=this.DEb(e,t,n),i=parseInt(""+(o>0?(240-r.luminosity)*o:r.luminosity*o),10),a=this.EEb(r.hue,r.luminosity+i,r.saturation),this.FEb(a.r,a.g,a.b)},t.prototype.GEb=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},t.prototype.FEb=function(e,t,n){return"#"+this.GEb(e)+this.GEb(t)+this.GEb(n)},t.prototype.EEb=function(e,t,n){var o,r,i,a,s;return 0===n?o=r=i=parseInt(""+255*t/240,10):(void 0,void 0,a=2*t-(s=t<=120?(t*(240+n)+120)/240:t+n-(t*n+120)/240),o=parseInt(""+(255*this.fc(a,s,e+80)+120)/240,10),r=parseInt(""+(255*this.fc(a,s,e)+120)/240,10),i=parseInt(""+(255*this.fc(a,s,e-80)+120)/240,10)),{a:255,r:o,g:r,b:i}},t.prototype.fc=function(e,t,n){return n<0&&(n+=240),n>240&&(n-=240),n<40?e+((t-e)*n+20)/40:n<120?t:n<160?e+((t-e)*(160-n)+20)/40:e},t.prototype.BEb=function(e,t,n){return this.DEb(e,t,n).luminosity/240},t.prototype.DEb=function(e,t,n){var o,r,i,a,s,l=Math.max(Math.max(e,t),n),u=Math.min(Math.min(e,t),n),c=l+u,f=parseInt(""+(240*c+255)/510,10),h=l-u;return 0===h?(o=0,r=160):(o=f<=120?parseInt(""+(240*h+c/2)/c,10):parseInt(""+(240*h+(510-c)/2)/(510-c),10),i=(40*(l-e)+h/2)/h,a=(40*(l-t)+h/2)/h,s=(40*(l-n)+h/2)/h,(r=e===l?parseInt(""+(s-a),10):t===l?parseInt(""+(80+i-s),10):parseInt(""+(160+a-i),10))<0&&(r+=240),r>240&&(r-=240)),{luminosity:f,saturation:o,hue:r}},t.prototype.yEb=function(e,t,n){var o=this,i={items:function(){var r,i,a,s,l,c=document.createElement("div");for(c.classList.add("gc-color-picker-group-row"),c.style.width=(t+7)*n+"px",r=0;r<e.colors.length;r++){for((i=document.createElement("div")).classList.add("gc-color-picker-color-row"),a=e.colors[r],s=0;s<a.length;s++)(l=document.createElement("div")).setAttribute(u,e.name),l.setAttribute("color",a[s]),l.style.backgroundColor=a[s],l.style.width=t+"px",l.style.height=t+"px",l.classList.add("gc-color-picker-color-cell"),o.BYa===a[s]&&o.sEb===e.name&&l.classList.add("selected"),i.appendChild(l);c.appendChild(i)}return c},layout:{direction:r.LayoutDirection.horizontal,displayAs:r.LayoutDisplayAs.inline}};return e.name&&(i.text=e.name),i},t.prototype.uEb=function(e){var t,n,o=e.srcElement||e.target;o&&(t=o.getAttribute("color"),n=o.getAttribute(u),t&&n&&(this.BYa=t,this.sEb=n,this.HEb(t),this.wEb()))},t.prototype.HEb=function(e){this.fire(i.BaseDropdown.Event_ValueChanged,{value:e,text:e})},t.DefaultCellWidth=10,t.DefaultColorGroup=function(){return[{name:f().ThemeColor,colors:[["#ffffff","#000000","#e7e6e6","#44546a","#5b9bd5","#ed7d31","#a5a5a5","#ffc000","#4472c4","#70ad47"]],needScaleColor:!0},{name:f().StandardColor,colors:[["#C00000","#FF0000","#FFC000","#FFFF00","#92D050","#00B050","#00B0F0","#0070C0","#002060","#7030A0"]]}]},t}(i.BaseDropdown),t.ColorPicker=h},"./dist/plugins/celltype/editor/eventbase.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){this.IEb={}}return e.prototype.on=function(e,t){var n=this.IEb[e];null!=n||(n=this.IEb[e]=[]),n.push(t)},e.prototype.off=function(e,t){var n,o;if(e){if(null==(n=this.IEb[e]))return;t?(o=n.indexOf(t),n.splice(o,1)):n=[],this.IEb[e]=n}else this.IEb={}},e.prototype.fire=function(e,t){var n=this,o=this.IEb[e];null!=o&&o.forEach((function(e){try{e.call(n,t)}catch(e){}}))},e}();t.EventBase=o},"./dist/plugins/celltype/editor/listControl.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function C(e){return u.createElement(e)}function w(e,t){return e.substring(0,t)+e.substring(t+1,e.length)}function x(e,t){if(i.Common.k.Bb(e,t))return!0;if(i.Common.l.Ska(t))for(var n=0;n<e.length;n++)if(e[n]-t==0)return!0;return!1}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/popupControl.js"),r=n("./dist/plugins/celltype/editor/baseControl.js"),i=n("@grapecity/js-sheets-common"),a=n("Core"),s=i.Common.j.Fa,l=i.Common.k.Cb,u=document,c=function(){function e(){this.JEb=new WeakMap}return e.prototype.set=function(e,t,n){var o=this.JEb.get(e);o||this.JEb.set(e,o={}),o[t]=n},e.prototype.get=function(e,t){var n=this.JEb.get(e);return n&&n[t]},e.prototype.clear=function(){this.JEb=new WeakMap},e}(),f="gc-list-control-container",h="gc-list-control-item",p="gc-list-control-hassubitem",d="gc-list-control-selected-item",g="gc-list-control-subitem",m="hide-children",y="gc-list-control-tree-content",v=function(e){function t(t,n,o){var r=e.call(this,t)||this;return r._host=C("div"),r._host.classList.add("gc-list-control"),t.appendChild(r._host),r.xn=new c,r.JJb=o&&o.JJb||{Qb:void 0},r.bHb={items:[],doms:[]},r.setOptions(n),r}return b(t,e),t.prototype.setOptions=function(e){s(e)||(this.$z=function e(t){if(t.hasOwnProperty("items"))e(t.items);else if(Array.isArray(t))for(var n=0;n<t.length;n++)t[n].hasOwnProperty("items")?e(t[n]):t[n].hasOwnProperty("text")&&!t[n].hasOwnProperty("value")&&(t[n].value=t[n].text);return t}(e),this._host.innerHTML="",this._render())},t.prototype.setValue=function(e){if(this.$z&&this.$z.multiSelect)if("string"==typeof e)e=function(e){var t,n,o,r,i;if(s(e)||0===e.length)return[];for(t=[],n=0,o=0;o<e.length;o++)"\\"===(r=e.charAt(o))?","!==(i=e.charAt(o+1))&&"\\"!==i||(e=w(e,o)):","===r&&(t.push(e.substring(n,o)),n=o+1);return t.push(e.substring(n,e.length)),t}(e);else if(s(e))e=[];else if(i.Common.j.Ca(e)){if(1!==this.$z.valueType){e=e.slice(0);for(var t=0;t<e.length;t++)e[t]=""+e[t]}}else e=[e];this.JJb.Qb=e,this.KEb()},t.prototype.scrollToSelect=function(){},t.prototype.updateStyle=function(e,t,n){this._host.style.font=n},t.prototype._render=function(){var e=C("div");e.classList.add(f),this.SXa(e,this.$z),this._host.appendChild(e),this.LXa()},t.prototype.SXa=function(e,t){if(t&&(this.LEb(e,t.layout),t.items))if(Array.isArray(t.items))this.MEb(e,t.items);else{var n=t.items();n instanceof HTMLElement&&(e.appendChild(n),e.classList.add(h),this.LEb(n,t.layout))}},t.prototype.LEb=function(e,t){t&&t.direction===a.LayoutDirection.horizontal?e.classList.add("gc-list-alignment-horizontal"):e.classList.add("gc-list-alignment-vertical")},t.prototype.MEb=function(e,t){var n,o,r,i,l,u,c,f,d,v,b=t.some((function(e){return!!e.icon}));for(n=0;n<t.length;n++)t[n].items?(o=t[n]).layout&&o.layout.displayAs===a.LayoutDisplayAs.inline?((r=C("div")).classList.add("gc-list-control-group"),(i=C("span")).innerText=o.text,(s(o.text)||""===o.text)&&i.classList.add(m),i.classList.add("gc-list-control-group-text"),r.appendChild(i),Array.isArray(o.items)?this.SXa(r,o):(l=o.items())instanceof HTMLElement&&((u=C("div")).classList.add(h),this.LEb(l,o.layout),u.appendChild(l),r.appendChild(u)),e.appendChild(r)):o.layout&&o.layout.displayAs===a.LayoutDisplayAs.tree?((c=C("div")).classList.add("gc-list-control-tree"),(f=C("div")).classList.add(h),f.classList.add(p),(i=C("span")).innerText=o.text,i.classList.add("gc-list-control-tree-text"),f.appendChild(i),o.layout.collapsible&&((d=C("span")).classList.add(g),f.appendChild(d),this.NEb(f)),c.appendChild(f),(v=C("div")).classList.add(y),Array.isArray(o.items)?this.SXa(v,o):(l=o.items())instanceof HTMLElement&&((u=C("div")).classList.add(h),this.LEb(l,o.layout),u.appendChild(l),v.appendChild(u)),c.appendChild(v),e.appendChild(c)):this.OEb(e,t[n],!1,!0):this.OEb(e,t[n],b)},t.prototype.OEb=function(e,t,n,o){var r,i,a,u,c,f,d;void 0===o&&(o=!1),(r=C("div")).classList.add(h),"-"===t.text?(r.classList.add("gc-list-control-noitem"),(i=C("div")).classList.add("gc-list-control-listseparator"),r.appendChild(i)):(n&&((a=C("div")).classList.add("gc-list-control-item-icon"),t.icon?a.style.backgroundImage="url("+t.icon+")":a.classList.add("gc-list-control-emptyicon"),r.appendChild(a)),(u=C("span")).classList.add("gc-list-control-item-text"),u.innerText=t.text,s(t.text)&&(u.innerText=s(t.value)?"":t.value),r.appendChild(u),c=s(t.value)?null:t.value,(f=l(this.bHb.items,c))<0&&(f=this.bHb.items.length,this.bHb.doms.push([]),this.bHb.items.push(c)),this.bHb.doms[f].push(r),this.xn.set(r,"items",t),o&&((d=C("span")).classList.add(g),r.classList.add(p),this.xn.set(r,"sub-items",t),r.appendChild(d),this.PEb(r))),e.appendChild(r)},t.prototype.CHb=function(e,t){var n,o=this.bHb.doms[e];if(t)for(n=0;n<o.length;n++)o[n].classList.contains(p)||o[n].classList.add(d);else for(n=0;n<o.length;n++)o[n].classList.contains(d)&&o[n].classList.remove(d)},t.prototype.KEb=function(){var e,t,n,o=this,r=o.$z;for(s(o.formula)?r&&r.multiSelect?e=o.JJb.Qb:e=[o.JJb.Qb]:e=["="+o.formula],t=0;t<o.bHb.items.length;t++)n=o.bHb.items[t],r&&r.multiSelect&&1!==r.valueType&&(n=""+n),x(e,n)?o.CHb(t,!0):o.CHb(t,!1)},t.prototype.LXa=function(){var e=this;this._host.querySelector("."+f).addEventListener("click",(function(t){var n,o,a,l,u=e.QEb(t.target,"."+h);if(u){if(u.classList.contains(p))return void e.KJb(t);n=e.xn.get(u,"items"),o=e.$z,!n&&i.Common.j.Aa(o&&o.onItemSelected)&&(n={value:o.onItemSelected(t)}),s(n)||(a=n.value,o&&o.multiSelect&&(l=(l=e.JJb.Qb).slice(0),o.multiSelect&&1!==o.valueType&&(a=""+a),x(l,a)?function(e,t){var n,o=i.Common.l.Ska(t);for(n=e.length-1;n>=0;n--)(e[n]===t||o&&e[n]-t==0)&&e.splice(n,1)}(l,a):i.Common.k.Sb(l,a),e.JJb.Qb=a=l,e.KEb(),1!==o.valueType&&(a=function(e){var t,n,o=[];for(t=0;t<e.length;t++)(n=e[t])&&"string"==typeof n&&(n=n.replace(/\\/g,"\\\\").replace(/,/g,"\\,")),o[t]=n;return o.join(",")}(a))),e.fire(r.BaseDropdown.Event_ValueChanged,{value:a,text:a,notCloseDropDown:o&&o.multiSelect,noAutoFormat:!0}))}}))},t.prototype.QEb=function(e,t){Element.prototype.matches||(Element.prototype.matches=Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;n>=0&&t.item(n)!==this;)--n;return n>-1});for(var n=e;n&&!n.matches(t);)n=n.parentElement;return n},t.prototype.KJb=function(e){var n,i,a,s,l,u=this,c=this.QEb(e.target,"."+h);c.classList.contains(p)&&((n=this.xn.get(c,"sub-items"))&&n.items&&(i=C("div"),a=this.$z,n.multiSelect=a&&a.multiSelect,n.valueType=a&&a.valueType,n.onItemSelected=a&&a.onItemSelected,(s=new t(i,n,this)).KEb(),(l=new o.PopupControl(i,c,{align:o.DropDownAlignment.Near,hostElement:c,direction:o.DropDownDirection.Right})).open(),i.parentElement.style.top="0",s.on(r.BaseDropdown.Event_ValueChanged,(function(e){u.fire(r.BaseDropdown.Event_ValueChanged,e),u.$z&&u.$z.multiSelect?u.KEb():l.close()})),this.xn.set(c,"sub-items-popup",l),e.stopPropagation(),e.preventDefault()))},t.prototype.PEb=function(e){var t=this;e.addEventListener("mouseenter",(function(e){t.KJb(e)})),e.addEventListener("mouseleave",(function(e){var n,o=e.target;o.classList.contains(p)&&((n=t.xn.get(o,"sub-items-popup"))&&(n.close(),t.xn.set(o,"sub-items-pop",void 0)))}))},t.prototype.NEb=function(e){var t=this;e.addEventListener("click",(function(e){var n=e.target,o=t.QEb(n,"."+p);o&&(o.parentElement.querySelector("."+y)&&(o.parentElement.classList.contains(m)?o.parentElement.classList.remove(m):o.parentElement.classList.add(m),e.stopPropagation(),e.preventDefault()))}))},t}(r.BaseDropdown),t.List=v},"./dist/plugins/celltype/editor/monthPicker.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function y(e){return u.createElement(e)}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/baseControl.js"),r=n("./dist/plugins/celltype/celltypes.ns.js"),i=n("@grapecity/js-sheets-common"),a=i.Common.j.Fa,s=new i.Common.ResourceManager(r.SR),l=s.getResource.bind(s),u=document,c="gc-month-picker-month-item",f="gc-month-picker-qtr-item",h="selected",p="data-month",d="data-qtr",g=function(e){function t(t,n){var o=e.call(this,t)||this;return o.setOptions(n),o.LXa(),o}return m(t,e),t.prototype.setOptions=function(e){var t,n,o,r=this,i=new Date,s={startYear:i.getFullYear()-10,stopYear:i.getFullYear(),height:300};e&&(a(e.startYear)||(t=parseInt(e.startYear,10),isNaN(t)||(s.startYear=t)),!a(e.stopYear)&&e.stopYear>0&&(n=parseInt(e.stopYear,10),isNaN(n)||(s.stopYear=n)),s.stopYear<s.startYear&&(s.stopYear=e.startYear),a(e.height)||(o=parseInt(e.height,10),isNaN(o)||(s.height=o))),s.height=Math.max(1,s.height),r.$z=s,r._host.innerHTML="",r.REb()},t.prototype.setValue=function(e){var t,n,o,r=this;e&&(t=e.getMonth()+1,n=e.getFullYear()),"number"==typeof t&&((o=r._host.querySelector("["+p+"='"+n+"-"+t+"']"))&&(o.classList.add(h),r.SEb&&r.SEb.classList.remove(h),r.SEb=o))},t.prototype.scrollToSelect=function(){var e,t=this.SEb;t&&(e=t.offsetTop,this._host.scrollTop=e)},t.prototype.TEb=function(e,t){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;n>=0&&t.item(n)!==this;)--n;return n>-1});for(var n=e;n&&!n.matches(t);)n=n.parentElement;return n},t.prototype.LXa=function(){var e=this;this._host.addEventListener("click",(function(t){var n,r,a,s,l,u,g=e,m=g.TEb(t.target,"."+c+",."+f);m&&(m.getAttribute(d)||(m.classList.add(h),g.SEb&&g.SEb.classList.remove(h),g.SEb=m,n=null,null,r=null,m.getAttribute(p)&&(n=+(a=m.getAttribute(p).split("-"))[1],r=+a[0]),s=new Date(r,n-1,1,0,0,0,0),l=i.Common.CultureManager.q4().DateTimeFormat,u=new i.Formatter.GeneralFormatter(l.shortDatePattern).format(s),g.fire(o.BaseDropdown.Event_ValueChanged,{text:u,value:s})))}))},t.prototype.REb=function(){var e,t,n,o,r=this;for(this.$z.height>=0?r._host.style.maxHeight=this.$z.height+"px":r._host.style.height="auto",r._host.classList.add("gc-month-picker-container"),e=r.$z.startYear;e<=r.$z.stopYear;e++)t=document.createElement("div"),r.UEb(t),(n=document.createElement("div")).classList.add("gc-month-picker-year-container"),r.VEb(e,n),(o=document.createElement("div")).classList.add("gc-month-picker-month-container"),r.WEb(e,1,o),r.WEb(e,2,o),r.WEb(e,3,o),r.WEb(e,4,o),t.appendChild(n),t.appendChild(o),this._host.appendChild(t)},t.prototype.UEb=function(e){var t=y("div");t.classList.add("gc-month-picker-separator"),e.appendChild(t)},t.prototype.VEb=function(e,t){var n=y("div");n.classList.add("gc-month-picker-year-item"),n.innerText=""+e,t.appendChild(n)},t.prototype.WEb=function(e,t,n){var o=document.createElement("div"),r=y("div"),i=y("div"),a=y("div"),s=y("div");switch(r.classList.add(c),i.classList.add(c),a.classList.add(c),s.classList.add(f),t){case 1:r.innerText=l().Calendar_ShortMonths_1,r.setAttribute(p,e+"-1"),i.innerText=l().Calendar_ShortMonths_2,i.setAttribute(p,e+"-2"),a.innerText=l().Calendar_ShortMonths_3,a.setAttribute(p,e+"-3"),s.innerText=l().Quarter_Format_1,s.setAttribute(d,e+"-1");break;case 2:r.innerText=l().Calendar_ShortMonths_4,r.setAttribute(p,e+"-4"),i.innerText=l().Calendar_ShortMonths_5,i.setAttribute(p,e+"-5"),a.innerText=l().Calendar_ShortMonths_6,a.setAttribute(p,e+"-6"),s.innerText=l().Quarter_Format_2,s.setAttribute(d,e+"-2");break;case 3:r.innerText=l().Calendar_ShortMonths_7,r.setAttribute(p,e+"-7"),i.innerText=l().Calendar_ShortMonths_8,i.setAttribute(p,e+"-8"),a.innerText=l().Calendar_ShortMonths_9,a.setAttribute(p,e+"-9"),s.innerText=l().Quarter_Format_3,s.setAttribute(d,e+"-3");break;case 4:r.innerText=l().Calendar_ShortMonths_10,r.setAttribute(p,e+"-10"),i.innerText=l().Calendar_ShortMonths_11,i.setAttribute(p,e+"-11"),a.innerText=l().Calendar_ShortMonths_12,a.setAttribute(p,e+"-12"),s.innerText=l().Quarter_Format_4,s.setAttribute(d,e+"-4")}o.appendChild(r),o.appendChild(i),o.appendChild(a),o.appendChild(s),n.appendChild(o),t<4&&this.UEb(n)},t}(o.BaseDropdown),t.MonthPicker=g},"./dist/plugins/celltype/editor/multiColumnPicker.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("SheetsCalc"),i=n("@grapecity/js-calc"),a=n("@grapecity/js-calc"),s=n("@grapecity/js-sheets-common"),l=n("./dist/plugins/celltype/editor/baseControl.js"),u=n("./dist/plugins/celltype/editor/baseSpreadPicker.js"),c=n("./node_modules/util/util.js"),f=n("./dist/plugins/celltype/celltypes.ns.js"),h=new s.Common.ResourceManager(f.SR),p=h.getResource.bind(h),d=!!i,g=function(e){function t(t,n,o){return e.call(this,t,n,o)||this}return m(t,e),t.prototype.setOptions=function(t){var n,r,i,a,s,l,u;if(e.prototype.setOptions.call(this,t),(n=this).$z=t,t&&(r=n.Ngc,i=t.dataSource,a=t.bindingInfos,s=r.getActiveSheet(),i)){l=!0,function(e){e.suspendPaint(),e.suspendEvent(),e.suspendCalcService()}(s),s.options.isProtected=!0,s.options.rowHeaderVisible=!1,s.selectionPolicy(o.SelectionPolicy.single),s.selectionUnit(o.SelectionUnit.row);try{n.Rgc(s,i,a)}catch(e){l=!1,n.dispose()}finally{l&&s&&((u=new o.Style).THb=!1,s.setStyle(-1,-1,u,o.SheetArea.viewport),function(e){e.resumeCalcService(),e.resumeEvent(),e.resumePaint()}(s))}}},t.prototype.setValue=function(t){var n,o,r=this;r.$z&&(e.prototype.setValue.call(this,t),n=r.Ngc.getActiveSheet(),o=r.Sgc(t),n.setSelection(o,-1,1,-1))},t.prototype.dispose=function(){e.prototype.dispose.call(this)},t.prototype.Rgc=function(e,t,n){if(t){var o=this.Ugc(t);o&&(e.setDataSource(function(e,t){var n,o,r,i,a,s=e[0],l=[];if(c.isArray(s))for(n=e,o=function(e,t){var n=[];return t&&t.length>0?t.forEach((function(e){n.push(e.name)})):n=e.shift(),n}(e,t),r=function(e,t){var r=n[e],i={};o.forEach((function(e,t){i[e]=r[t]})),l.push(i)},i=0,a=n.length;i<a;i++)r(i);else l=e;return l}(o,n)),n&&e.bindColumns(n))}},t.prototype.Ugc=function(e){var t,n,i,s,l,u=e,f=this.Lgc;if(c.isString(u)){if(d){if(n=r.formulaToExpression(f,u),i=f.getCalcService()._evaluateParsedFormula(f.yj(),n,a._createCellIdentity(0,0),!0),s=!1,l=void 0,(a.Convert._isReference(i)||a.Convert.Ca(i))&&((l=a.Convert.Ph(i,0,!1,!1,!1)).isError||l.isConvertError||(s=!0)),!s)throw Error(p().MultiColumn_InvalidDataSource);t=l}}else u instanceof o.Range?t=f.getArray(u.row,u.col,u.rowCount,u.colCount):c.isArray(u)&&(t=u);return t},t.prototype.Sgc=function(e){var t,n,o,r,i,a,s,l,u,c,f=0;if(e)for(this,t=this.Ngc.getActiveSheet(),o=(n=Object.keys(e)).length,i=(r=t.getDataSource()).length,a=!1,s=0;s<i;s++){for(l=r[s],u=0;u<o;u++){if(l[c=n[u]]!==e[c]){a=!1;break}a=!0}if(a){f=s;break}}return f},t.prototype.submitData=function(e){var t,n,o,r=e.sheet;e.isEsc?t={notSubmit:!0}:(n=r.getSelections()[0].row)>-1&&(t={value:o=r.getDataItem(n),text:o}),c.isNullOrUndefined(t)||this.fire(l.BaseDropdown.Event_ValueChanged,t)},t}(u.BaseSpreadPicker),t.MultiColumn=g},"./dist/plugins/celltype/editor/popupControl.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/baseControl.js"),function(e){e[e.Down=0]="Down",e[e.Up=1]="Up",e[e.Left=2]="Left",e[e.Right=3]="Right"}(r=t.DropDownDirection||(t.DropDownDirection={})),function(e){e[e.Near=0]="Near",e[e.Center=1]="Center",e[e.Far=2]="Far"}(i=t.DropDownAlignment||(t.DropDownAlignment={})),function(e){e[e.None=0]="None",e[e.Flip=1]="Flip",e[e.Slide=2]="Slide"}(a=t.DropDownAdjustment||(t.DropDownAdjustment={})),s=function(){function e(e,t,n,o){this.XHa=e,this.YHa=t,this.Vo=n,this._v=o}return e.CreateFromDom=function(t){return new e(t.left,t.top,t.width,t.height)},Object.defineProperty(e.prototype,"x",{get:function(){return this.XHa},set:function(e){this.XHa=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.YHa},set:function(e){this.YHa=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.Vo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._v},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.XHa},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.XHa+this.Vo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.YHa},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.YHa+this._v},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Location",{get:function(){return{X:this.XHa,Y:this.YHa}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Size",{get:function(){return{width:this.Vo,height:this._v}},enumerable:!0,configurable:!0}),e.prototype.Offset=function(){var e,t=[];for(e=0;e<arguments.length;e++)t[e]=arguments[e];1===t.length&&"number"==typeof t[0].X&&"number"==typeof t[0].X?(this.XHa+=t[0].X,this.YHa+=t[0].Y):2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&(this.XHa+=t[0],this.YHa+=t[1])},e}(),t.Rectangle=s,l="ribbon-dropdowngroup-popup",u=function(e){function t(t,n,o){var s=e.call(this,null)||this;return s.sourceElement=t,s.target=n,s.defaultOption={closeAfterResize:!0,closeAfterClickOutside:!0,direction:r.Down,align:i.Near,horAdj:a.Flip|a.Slide,verAdj:a.Flip|a.Slide},s.globalMousedownEventHandler=function(e){var t;if(s.cXa){for(t=e.target;t&&t!==s.sourceElement;)t=t.parentElement;t||(s.close(),e.stopPropagation(),e.preventDefault())}},s.windowResizeEventHandler=function(){s.cXa&&s.close()},s.$z=s.defaultOption,s.cXa=!1,o&&s.mergeOption(o),s.XEb=null===s.$z.hostElement||void 0===s.$z.hostElement||!(s.$z.hostElement instanceof HTMLElement),s}return c(t,e),t.prototype.open=function(){this.cXa||(this.beforeOpen(),this.render(),this.clearPosition(),this.calcPosition(),this.cXa=!0,this.sourceElement.tabIndex=-1,this.sourceElement.style.cssText+="outline:none",this.sourceElement.focus())},t.prototype.beforeOpen=function(){this.bindEvent()},t.prototype.dispose=function(){var e=this;this.$z.closeAfterResize&&document.removeEventListener("resize",this.windowResizeEventHandler),this.$z.closeAfterClickOutside&&(document.removeEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach((function(t){document.removeEventListener(t,e.globalMousedownEventHandler,!0)}))),this.XEb?(this.sourceElement.classList.remove(l),this.sourceElement.style.display=this.YEb,this.sourceElement.style.position=this.xC):this.ZEb&&(this.$z.hostElement.removeChild(this.ZEb),this.ZEb=null)},t.prototype.close=function(){this.cXa&&(this.cXa=!1,this.dispose(),this.fire("close"))},t.prototype.mergeOption=function(e){for(var t in e)void 0!==e[t]&&(this.$z[t]=e[t])},t.prototype.clearPosition=function(){this.$Eb.style.top=this.$Eb.style.bottom=this.$Eb.style.left=this.$Eb.style.right=""},t.prototype.calcPosition=function(){var e,t,n,o,r,i,a,l,u;e=this.target instanceof s?this.target:s.CreateFromDom(this.target.getBoundingClientRect()),t=new s(0,0,window.innerWidth,window.innerHeight),n=this.calculateDropDownLocation(t,e,{width:this.sourceElement.offsetWidth,height:this.sourceElement.offsetHeight},this.$z.direction,this.$z.align,this.$z.horAdj,this.$z.verAdj),r=(o=this.$Eb.offsetParent).getBoundingClientRect(),i=o===document.body,a=document.documentElement,l=(window.pageXOffset||a.scrollLeft)-(a.clientLeft||0),u=(window.pageYOffset||a.scrollTop)-(a.clientTop||0),this.$Eb.style.left=n.X-(i?-l:r.left)+"px",this.$Eb.style.top=n.Y-(i?-u:r.top)+"px"},t.prototype.calculateDropDownLocation=function(e,t,n,o,l,u,c){var f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T={X:e.x,Y:e.y};switch(e.Offset(-T.X,-T.Y),t.Offset(-T.X,-T.Y),f=t.left,h=t.right,p=t.top,d=t.bottom,g=p,m=e.height-d,y=f,v=e.width-h,b=(c&a.Flip)===a.Flip,C=(u&a.Flip)===a.Flip,w=(c&a.Slide)===a.Slide,x=(u&a.Slide)===a.Slide,o){case r.Up:n.height>g&&b&&(o=r.Down);break;case r.Down:n.height>m&&b&&(o=r.Up);break;case r.Left:n.width>y&&C&&(o=r.Right);break;case r.Right:n.width>v&&C&&(o=r.Left)}switch(A=0,M=0,o){case r.Up:M=p-n.height;break;case r.Down:M=d;break;case r.Left:A=f-n.width;break;case r.Right:A=h}return o===r.Up||o===r.Down?l===i.Near?A=f:l===i.Center?A=f-(n.width-t.width)/2:l===i.Far&&(A=h-n.width):o!==r.Right&&o!==r.Left||(l===i.Near?M=p:l===i.Center?M=p-(n.height-t.height)/2:l===i.Far&&(M=d-n.height)),S=new s(A,M,n.width,n.height),x&&(S.width>e.width?S.x=0:(S.x=Math.max(S.x,0),S.x=Math.min(S.x,e.width-S.width))),w&&(S.height>e.height?S.y=0:(S.y=Math.max(S.y,0),S.y=Math.min(S.y,e.height-S.height))),S.Offset(T),S.Location},t.prototype.render=function(){this.XEb?(this.xC=this.sourceElement.style.position,this.sourceElement.style.position="absolute",this.YEb=this.sourceElement.style.display,this.sourceElement.style.display="",this.sourceElement.style.zIndex="10000",this.sourceElement.classList.add(l),this.$Eb=this.sourceElement):(this.ZEb=document.createElement("div"),this.ZEb.style.cssText="position:absolute; z-index:10000; box-shadow:rgba(0, 0, 0, 0.4) 2px 4px 5px; outline:none",this.ZEb.classList.add(l),this.ZEb.appendChild(this.sourceElement),this.$z.hostElement.appendChild(this.ZEb),this.$Eb=this.ZEb)},t.prototype.bindEvent=function(){var e=this;this.$z.closeAfterClickOutside&&(document.addEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach((function(t){document.addEventListener(t,e.globalMousedownEventHandler,!0)}))),this.$z.closeAfterResize&&document.addEventListener("resize",this.windowResizeEventHandler)},t}(o.BaseControl),t.PopupControl=u},"./dist/plugins/celltype/editor/slider.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function v(e){var t=function(e){var t=e.toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/);return e.toFixed(Math.max(0,(t[1]||"").length-parseInt(t[2],10)))}(e||0),n=0;return t.indexOf(".")>=0&&(n=t.length-t.indexOf(".")-1),n}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/baseControl.js"),r=n("@grapecity/js-sheets-common"),i=n("Core"),a=r.Common.j.Fa,s=r.Common.u.Ob,l=null,u=function(){function e(){}return e.isEmpty=function(e){return void 0===e||e===l||""===e||Array.isArray(e)&&0===e.length},e.isEmptyObject=function(e){var t,n=!0;for(t in e)if(t){n=!1;break}return n},e.pauseEvent=function(e){e.stopPropagation(),e.preventDefault()},e.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},e.allKeys=function(t){var n,o=[];if(!e.isObject(t))return[];for(n in t)t.hasOwnProperty(n)&&o.push(n);return o},e.parseStyleObject=function(t){var n,o,r,i,a,s;if(!e.isObject(t))return"";for(n="",r=0,i=(o=e.allKeys(t)).length;r<i;r++)s=t[a=o[r]],n+=a.replace(/([A-Z])/g,"-$1").toLowerCase()+": "+s+"; ";return n.trim()},e.extend=function(t,n,o){var r,i,a,s,l;for(void 0===o&&(o={}),r=e.allKeys(t),a=0,s=(i=e.allKeys(n)).length;a<s;a++)o[l=i[a]]=n[l];for(a=0,s=r.length;a<s;a++)void 0===o[l=r[a]]&&(o[l]=t[l]);return o},e.noop=function(){},e.measureWidth=function(e,t){var n=0,o=document.createElement("span");o.classList.add(t);try{o.innerText=e,o.style.display="none",document.body.appendChild(o),n=i.GC$(o).width()}finally{document.body.removeChild(o)}return n},e}(),c=function(){function e(e,t){this.xo=t,this.vFb={},this.vFb=u.extend(this.vFb,e)}return e.prototype.render=function(){var e,t;return this.vFb.included?(e=this.wFb(),(t=this.xo.querySelector("."+this.vFb.className))===l&&((t=document.createElement("div")).classList.add(""+this.vFb.className),this.xo.appendChild(t)),void t.setAttribute("style",u.parseStyleObject(e))):l},e.prototype.setLength=function(e){this.vFb.length=e,this.render()},e.prototype.wFb=function(){return this.vFb.direction===i.LayoutDirection.vertical?{bottom:this.vFb.offset+"%",height:this.vFb.length+"%"}:{left:this.vFb.offset+"%",width:this.vFb.length+"%"}},e}(),f=function(){function e(e,t){this.xo=t,this.xFb={},this.xFb=u.extend(this.xFb,e)}return e.prototype.render=function(){var e,t,n,o,r=this.xo.querySelector("."+this.xFb.className);if(r===l){for((r=document.createElement("div")).className=""+this.xFb.className,t=0,n=(e=this.yFb()).length;t<n;t++)o=this.zFb(e[t]),r.appendChild(o);this.xo.appendChild(r)}},e.prototype.zFb=function(e){var t=document.createElement("span"),n=this.xFb.max-this.xFb.min,o=Math.abs(e-this.xFb.min)/n*100+"%",r=this.xFb.direction===i.LayoutDirection.vertical?{bottom:o}:{left:o};return t.classList.add(this.xFb.prefixCls+"-dot"),t.setAttribute("style",u.parseStyleObject(r)),t.setAttribute("key",""+e),t},e.prototype.yFb=function(){var e,t,n=Object.keys(this.xFb.marks).map((function(e){return+e}));if(n.sort((function(e,t){return e-t})),e=n,this.xFb.dots)for(t=this.xFb.min;t<=this.xFb.max;t+=this.xFb.step)-1===e.indexOf(t)&&e.push(t);return e},e}(),h=function(){function e(e,t){this.xo=e,this.AFb={},this.exb="",this.AFb=u.extend(this.AFb,t),this.exb='\n        <div class="'+this.AFb.prefixCls+"-tooltip "+this.AFb.prefixCls+'-tooltip-placement-top">\n            <div class="'+this.AFb.prefixCls+'-tooltip-content">\n                <div class="'+this.AFb.prefixCls+'-tooltip-arrow"></div>\n                <div class="'+this.AFb.prefixCls+'-tooltip-inner">{{value}}</div>\n            </div>\n        </div>\n        '}return e.prototype.render=function(e,t){var n,o,i,a,l;this.AFb.offset=e,n=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip"),o=new r.Formatter.GeneralFormatter(this.AFb.formatString).format(t),u.isEmpty(n)&&(i=s(o),this.exb=this.exb.replace(/{{value}}/,i),(a=document.createElement("div")).innerHTML=this.exb,this.xo.appendChild(a.firstElementChild),n=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip")),n.querySelector("."+this.AFb.prefixCls+"-tooltip-inner").textContent=o,l=this.BFb(o),n.setAttribute("style",u.parseStyleObject(l)),this.AFb.tooltipVisible?this.show():this.hide()},e.prototype.show=function(){var e=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip");u.isEmpty(e)||(e.style.display="inline-block")},e.prototype.hide=function(){var e=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip");u.isEmpty(e)||(e.style.display="none")},e.prototype.BFb=function(e){var t=u.measureWidth(e,this.AFb.prefixCls+"-tooltip");return t=0===t?12:t/2+4,this.AFb.direction===i.LayoutDirection.vertical?{left:"-"+t+"px",bottom:"calc("+this.AFb.offset+"% + 10px)"}:{top:"-28px",left:"calc("+this.AFb.offset+"% - "+(t+4)+"px)"}},e}(),p=function(){function e(e,t){this.xo=t,this.CFb={},this.DFb=!1,this.EFb=l,this.CFb=u.extend(this.CFb,e),this.EFb=new h(this.xo,this.FFb())}return e.prototype.render=function(){var e,t=this,n=this.GFb(),o=this.BFb(),r=this.CFb.tabIndex||0;(this.CFb.disabled||r===l)&&(r=l),(e=this.xo.querySelector("."+this.CFb.className))===l&&((e=document.createElement("div")).className=n,this.xo.appendChild(e),e.setAttribute("role","slider"),e.setAttribute("aria-valuemin",""+this.CFb.min),e.setAttribute("aria-valuemax",""+this.CFb.max),e.setAttribute("aria-valuenow",""+this.CFb.value),e.setAttribute("aria-disabled",this.CFb.disabled+""),e.addEventListener("blur",(function(){t.HFb(!1)})),e.addEventListener("mouseenter",(function(){t.EFb.show()})),e.addEventListener("keydown",(function(){t.HFb(!1)})),e.addEventListener("mousedown",(function(){e.focus(),t.EFb.show()})),document.addEventListener("mouseup",(function(){document.activeElement===e&&(t.HFb(!0),t.EFb.hide())}))),e.tabIndex=r,e.setAttribute("style",u.parseStyleObject(o))},e.prototype.setOffset=function(e,t){this.CFb.offset=e,this.render(),this.EFb.render(e,t)},e.prototype.HFb=function(e){this.DFb=e},e.prototype.GFb=function(){return this.DFb?this.CFb.className+" "+this.CFb.prefixCls+"-handle-click-focused":""+this.CFb.className},e.prototype.BFb=function(){return this.CFb.direction===i.LayoutDirection.vertical?{bottom:this.CFb.offset+"%"}:{left:this.CFb.offset+"%"}},e.prototype.FFb=function(){return{prefixCls:"gc-slider",tooltipVisible:this.CFb.tooltipVisible,direction:this.CFb.direction,offset:this.CFb.offset,formatString:this.CFb.formatString}},e}(),d=function(){function e(e,t){this.xo=t,this.IFb={},this.IFb=u.extend(this.IFb,e)}return e.prototype.render=function(){var e,t,n,o,r,i=this.xo.querySelector("."+this.IFb.className);if(i===l){for((i=document.createElement("div")).className=""+this.IFb.className,e=this.JFb(),this.LJb(e),t=0,n=e.length;t<n;t++)o=e[t],(r=this.KFb(o))!==l&&i.appendChild(r);this.xo.appendChild(i)}},e.prototype.LJb=function(e){var t,n,o,r;for(this.MJb=0,t=1,n=e.length;t<n;t++)(o=this.IFb.marks[e[0]])&&(r=u.measureWidth(o.label,this.IFb.className+"-text"),(!this.MJb||this.MJb<r)&&(this.MJb=r))},Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this.MJb},enumerable:!0,configurable:!0}),e.prototype.JFb=function(){return u.allKeys(this.IFb.marks).sort((function(e,t){return e-t}))},e.prototype.KFb=function(e){var t,n,o,r,i=this,a=this.IFb.marks[e],c=u.isObject(a)?a.label:a;return u.isEmptyObject(c)?l:(t=this.IFb.className+"-text",n=this.LFb(e),o=u.extend(n,a.style),(r=document.createElement("span")).classList.add(t),r.setAttribute("style",u.parseStyleObject(o)),r.setAttribute("key",""+e),r.addEventListener("mousedown",(function(t){i.IFb.onClickLabel(t,e)})),r.innerHTML=s(c),r)},e.prototype.LFb=function(e){var t=this.IFb.max-this.IFb.min;return this.IFb.direction===i.LayoutDirection.vertical?{"margin-bottom":"-50%",bottom:(e-this.IFb.min)/t*100+"%"}:{left:(e-this.IFb.min)/t*100+"%",transform:"translateX(-50%)"}},e}(),g=function(){function e(e,t,n,o){this.xo=e,this.MFb=t,this.NFb=n,this.$z=o,this.Tyb=l,this.OFb=l,this.Tyb=new f(this.PFb(),this.xo),this.OFb=new d(this.QFb(),this.xo)}return e.prototype.render=function(){var e=document.createElement("div");e.className=this.$z.prefixCls+"-rail",this.xo.appendChild(e),this.MFb.render(),this.Tyb.render(),this.NFb.render(),this.OFb.render(),this.OFb.maxWidth&&this.$z.direction===i.LayoutDirection.vertical&&(this.xo.style.paddingRight=this.OFb.maxWidth+"px")},e.prototype.calcValueByPosition=function(e){var t=e-this.RFb();return this.trimAlignValue(this.SFb(t))},e.prototype.trimAlignValue=function(e){return u.isEmpty(e)?l:this.TFb(e)},e.prototype.calcOffset=function(){return 100*(Math.max(this.$z.value-this.$z.min,0)/(this.$z.max-this.$z.min))},e.prototype.getKeyboardValueMutator=function(e){var t=this;switch(e.keyCode){case 38:case 39:return function(e){return t.calculateNextValue("increase",e)};case 40:case 37:return function(e){return t.calculateNextValue("decrease",e)};case 35:return function(e){return t.$z.max};case 36:return function(e){return t.$z.min}}},e.prototype.calculateNextValue=function(e,t){var n={increase:function(e,t){return e+t},decrease:function(e,t){return e-t}},o=Object.keys(this.$z.marks).indexOf(t+""),r=n[e](o,1),i=Object.keys(this.$z.marks)[r];return this.$z.step?n[e](t,this.$z.step):!u.isEmptyObject(this.$z.marks)&&this.$z.marks[i]?this.$z.marks[i]:t},e.prototype.TFb=function(e){var t=isFinite(this.UFb(e))?this.UFb(e):0;return this.$z.step===l?t:parseFloat(t.toFixed(this.Yrb()))},e.prototype.Yrb=function(){var e,t;if(a(this.$z.precision)){for(t in e=Math.max(v(this.$z.max),v(this.$z.min),v(this.$z.step)),this.$z.marks)e=Math.max(v(parseFloat(t)),e);this.$z.precision=e}return this.$z.precision},e.prototype.UFb=function(e){var t,n,o,r,i=Object.keys(this.$z.marks).map(parseFloat);return this.$z.step!==l&&(t=Math.ceil((this.$z.max-this.$z.min)/this.$z.step),n=Math.min((e-this.$z.min)/this.$z.step,t),o=Math.round(n)*this.$z.step+this.$z.min,i.push(Math.min(o,this.$z.max))),r=i.map((function(t){return Math.abs(e-t)})),i[r.indexOf(Math.min.apply(Math,r))]},e.prototype.PFb=function(){return{prefixCls:this.$z.prefixCls,className:this.$z.prefixCls+"-step",direction:this.$z.direction,marks:this.$z.marks,dots:this.$z.dots,step:this.$z.step,included:this.$z.included,max:this.$z.max,min:this.$z.min}},e.prototype.QFb=function(){var e=this;return{className:this.$z.prefixCls+"-mark",onClickLabel:this.$z.disabled?u.noop:function(t,n){e.VFb(t,n)},direction:this.$z.direction,marks:this.$z.marks,included:this.$z.included,max:this.$z.max,min:this.$z.min}},e.prototype.VFb=function(e,t){},e.prototype.RFb=function(){var e=this.xo.getBoundingClientRect();return this.$z.direction===i.LayoutDirection.vertical?e.top:e.left},e.prototype.WFb=function(){var e=this.xo.getBoundingClientRect();return this.$z.direction===i.LayoutDirection.vertical?e.height:e.width},e.prototype.SFb=function(e){var t=this.$z.min,n=this.$z.max,o=Math.abs(Math.max(e,0)/this.WFb());return this.$z.direction===i.LayoutDirection.vertical&&(o=Math.max(1-o,0)),o*(n-t)+t},e}(),m=function(e){function t(t,n){var r=e.call(this,t)||this;return r.MFb=l,r.NFb=l,r.XFb=l,r.YFb=function(e){u.pauseEvent(e),0===e.button&&(document.addEventListener("mouseup",r.ZFb,!1),document.addEventListener("pointerup",r.ZFb,!1),document.addEventListener("MSPointerUp",r.ZFb,!1),document.addEventListener("mousemove",r._Fb,!1),document.addEventListener("pointermove",r._Fb,!1),document.addEventListener("MSPointerMove",r._Fb,!1),r._Fb(e))},r._Fb=function(e){u.pauseEvent(e);var t=r.aGb(e);r.bGb!==t&&(r.setValue(t),r.$Fb.onChange(t))},r.ZFb=function(e){r._Fb(e),document.removeEventListener("mousemove",r._Fb),document.removeEventListener("mouseup",r.ZFb),document.removeEventListener("pointermove",r._Fb),document.removeEventListener("pointerup",r.ZFb),document.removeEventListener("MSPointerMove",r._Fb),document.removeEventListener("MSPointerUp",r.ZFb);var t=r.aGb(e);r.bGb=t,r.$Fb.onAfterChange(r.$Fb.value),r.fire(o.BaseDropdown.Event_ValueChanged,{value:t,text:""+t,notCloseDropDown:!0}),u.pauseEvent(e)},r.cGb=function(e){u.pauseEvent(e);var t=e.target||e.srcElement;document.addEventListener("touchend",r.dGb,!1),t.classList.contains(r.$Fb.prefixCls+"-handle")?document.addEventListener("touchmove",r.eGb,!1):r.eGb(e)},r.eGb=function(e){var t,n;u.pauseEvent(e),t=e.targetTouches[0],n=r.aGb(t),r.bGb!==n&&(r.setValue(n),r.$Fb.onChange(n))},r.dGb=function(e){var t,n;document.removeEventListener("touchmove",r.eGb),document.removeEventListener("touchend",r.dGb),t=e.changedTouches[0],n=r.aGb(t),r.bGb=n,r.$Fb.onAfterChange(r.$Fb.value),r.fire(o.BaseDropdown.Event_ValueChanged,{value:n,text:""+n,notCloseDropDown:!0}),u.pauseEvent(e)},r.init(n),r}return y(t,e),t.prototype.setValue=function(e){if(!this.$Fb.disabled){var t=parseFloat(e);isNaN(t)?t=this.$Fb.min:(t=Math.max(this.$Fb.min,t),t=Math.min(this.$Fb.max,t)),this.$Fb.value=t,this.bGb=this.$Fb.value,this.MFb.setLength(this.calcOffset()),this.NFb.setOffset(this.calcOffset(),t)}},t.prototype.calcOffset=function(){var e=Math.max(this.$Fb.value-this.$Fb.min,0)/(this.$Fb.max-this.$Fb.min);return 100*(e=Math.min(e,1))},t.prototype.setOptions=function(e){this.init(e)},t.prototype.init=function(e){var t,n;this.fGb(e),this.gGb(),this._host.innerHTML="",(t=document.createElement("div")).className="gc-slider-container",this._host.appendChild(t),this.$Fb.direction===i.LayoutDirection.vertical?(t.classList.add(this.$Fb.prefixCls+"-vertical"),t.style.height=this.$Fb.height+"px"):t.style.width=this.$Fb.width+"px",(n=document.createElement("div")).className=this.GFb(),t.appendChild(n),this.MFb=new c(this.hGb(),n),this.NFb=new p(this.iGb(),n),this.XFb=new g(n,this.MFb,this.NFb,this.jGb()),this.XFb.render(),this.QQ(n)},t.prototype.QQ=function(e){var t=this;this.$Fb.disabled||(e.addEventListener("mousedown",this.YFb),e.addEventListener("pointerdown",this.YFb),e.addEventListener("MSPointerDown",this.YFb),e.addEventListener("touchstart",this.cGb),e.addEventListener("keyup",(function(e){var n,r,i;if(u.pauseEvent(e),n=t.XFb.getKeyboardValueMutator(e),!u.isEmpty(n)){if(r=n(t.$Fb.value),(i=t.XFb.trimAlignValue(r))===t.$Fb.value)return;t.setValue(i),t.$Fb.onChange(i),t.$Fb.onAfterChange(i),t.fire(o.BaseDropdown.Event_ValueChanged,{value:i,text:""+i,notCloseDropDown:!0})}})))},t.prototype.aGb=function(e){return this.$Fb.direction===i.LayoutDirection.vertical?this.XFb.calcValueByPosition(e.clientY):this.XFb.calcValueByPosition(e.clientX)},t.prototype.sYa=function(){var e=function(e){};return{prefixCls:"gc-slider",dots:!1,range:!1,disabled:!1,max:100,min:0,step:1,value:0,direction:i.LayoutDirection.horizontal,included:!0,width:350,height:350,marks:{},tooltipVisible:!1,onChange:e,onAfterChange:e,formatString:"General"}},t.prototype.gGb=function(){(u.isEmpty(this.$Fb)||u.isEmptyObject(this.$Fb))&&(this.$Fb={}),this.$Fb=u.extend(this.sYa(),this.$Fb)},t.prototype.fGb=function(e){var t=this;e&&(a(e.scaleVisible)||(this.$Fb.dots=e.scaleVisible),a(e.direction)||(this.$Fb.direction=e.direction),a(e.formatString)||(this.$Fb.formatString=e.formatString),this.kGb(e.min,"min"),this.kGb(e.max,"max"),this.kGb(e.step,"step"),this.kGb(e.width,"width"),this.kGb(e.height,"height"),this.$Fb.step<=0&&(this.$Fb.step=1),this.$Fb.min>this.$Fb.max&&(this.$Fb.max=this.$Fb.min),a(e.tooltipVisible)||(this.$Fb.tooltipVisible=e.tooltipVisible),this.$Fb.marks={},e.marks&&e.marks.forEach((function(e){var n,o=parseFloat(e);isNaN(o)||o>=t.$Fb.min&&o<=t.$Fb.max&&(n=new r.Formatter.GeneralFormatter(t.$Fb.formatString),t.$Fb.marks[o]={label:n.format(o)})})))},t.prototype.kGb=function(e,t){if(!a(e)){var n=parseFloat(e);isNaN(n)||(this.$Fb[t]=n)}},t.prototype.hGb=function(){return{className:this.$Fb.prefixCls+"-track",included:this.$Fb.included,direction:this.$Fb.direction,offset:0,length:0}},t.prototype.iGb=function(){return{prefixCls:this.$Fb.prefixCls,className:this.$Fb.prefixCls+"-handle",direction:this.$Fb.direction,disabled:this.$Fb.disabled,min:this.$Fb.min,max:this.$Fb.max,value:this.$Fb.value,offset:0,tabIndex:0,tooltipVisible:this.$Fb.tooltipVisible,formatString:this.$Fb.formatString}},t.prototype.jGb=function(){return{prefixCls:this.$Fb.prefixCls,min:this.$Fb.min,max:this.$Fb.max,value:this.$Fb.value,disabled:this.$Fb.disabled,direction:this.$Fb.direction,dots:this.$Fb.dots,step:this.$Fb.step,included:this.$Fb.included,marks:this.$Fb.marks}},t.prototype.GFb=function(){var e=""+this.$Fb.prefixCls;return this.$Fb.direction===i.LayoutDirection.vertical&&(e+="  "+this.$Fb.prefixCls+"-vertical"),u.isEmptyObject(this.$Fb.marks)||(e+=" "+this.$Fb.prefixCls+"-with-marks"),this.$Fb.disabled&&(e+=" "+this.$Fb.prefixCls+"-disabled"),e},t}(o.BaseDropdown),t.Slider=m},"./dist/plugins/celltype/editor/timepicker.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/listControl.js"),r=n("./dist/plugins/celltype/editor/baseControl.js"),i="undefined",a=n("@grapecity/js-sheets-common"),s=a.Common.j.Fa,l=function(e){function t(t,n){var o=e.call(this,t)||this;return o.ad(),o.setOptions(n),o}return u(t,e),t.prototype.setOptions=function(e){var t,n,o,r;return e?(null!==(t=this.pGb(e.min))&&(this.$z.min=t),null!==(n=this.pGb(e.max))&&(this.$z.max=n),null!==(o=this.pGb(e.step))&&(this.$z.step=o),s(e.formatString)||(this.$z.formatString=e.formatString),s(e.height)||(r=parseInt(e.height,10),isNaN(r)||(this.$z.height=r)),this.$z.height=Math.max(1,this.$z.height),void this.VF()):void this.VF()},t.prototype.setValue=function(e){void 0!==e&&(this.KEb={hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds()},this.cHb=e,this.wEb(),this.scrollToSelect())},t.prototype.scrollToSelect=function(){var e,t=this.tEb.querySelector(".selected");null!==t&&(e=t.offsetTop,this.xo.scrollTop=e)},t.prototype.ad=function(){var e=this;this.$z={min:{},max:{hour:23,minute:59,second:59},step:{hour:1},formatString:"hh:mm",height:200},this.tEb=document.createElement("div"),this.tEb.classList.add("gc-time-picker-outer-div"),this.tEb.addEventListener("click",(function(t){e.uEb(t)})),this._host.appendChild(this.tEb)},t.prototype.pGb=function(e){var t,n,o,r=null;return s(e)||(r={},s(e.hour)||(t=parseInt(e.hour,10),isNaN(t)||(r.hour=t)),s(e.minute)||(n=parseInt(e.minute,10),isNaN(n)||(r.minute=n)),s(e.second)||(o=parseInt(e.second,10),isNaN(o)||(r.second=o))),r},t.prototype.VF=function(){this.tEb.innerHTML="",new o.List(this.tEb,this.qGb()),this.wEb()},t.prototype.wEb=function(){var e,t,n,o,r=this.tEb.querySelectorAll(".gc-time-picker-li");if(r.length>0)for(e=0;e<r.length;e++)r[e].classList.remove("selected"),t=+r[e].getAttribute("hour"),n=+r[e].getAttribute("minute"),o=+r[e].getAttribute("second"),this.rGb(this.KEb,{hour:t,minute:n,second:o})&&r[e].classList.add("selected")},t.prototype.qGb=function(){var e=this;return{items:function(){var t,n,o=e.sGb(),r=document.createElement("div");for(r.classList.add("gc-time-picker-container"),e.xo=r,e.$z.height<0?r.style.height="auto":r.style.maxHeight=e.$z.height+"px",(t=document.createElement("ul")).classList.add("gc-time-picker-ul"),n=0;n<o.length;n++)t.appendChild(e.tGb(o[n]));return 24*o.length>e.$z.height&&e.$z.height>=0?r.style.overflowY="scroll":r.style.overflowY="hidden",r.appendChild(t),r}}},t.prototype.tGb=function(e){var t=document.createElement("li");return t.classList.add("gc-time-picker-li"),t.setAttribute("hour",""+e.hour),t.setAttribute("minute",""+e.minute),t.setAttribute("second",""+e.second),t.innerText=this.uGb(e),t},t.prototype.sGb=function(){for(var e=this.vGb(this.$z.min),t=this.vGb(this.$z.max),n=[];e<=t;)n.push({hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds()}),e=this.wGb(e,this.$z.step);return n},t.prototype.wGb=function(e,t){return typeof t.hour!==i&&e.setHours(e.getHours()+t.hour),typeof t.minute!==i&&e.setMinutes(e.getMinutes()+t.minute),typeof t.second!==i&&e.setSeconds(e.getSeconds()+t.second),e},t.prototype.uGb=function(e){var t,n=new Date;return n.setHours(e.hour),n.setMinutes(e.minute),n.setSeconds(e.second),(t=new a.Formatter.GeneralFormatter(this.$z.formatString).format(n))&&""!==t&&null!==t?t:this.xGb(n)},t.prototype.xGb=function(e){var t=e.getHours(),n=e.getMinutes();return(t<12?"AM":"PM")+" "+(0===t||12===t?"12":""+t%12)+":"+(n<10?"0"+n:""+n)},t.prototype.vGb=function(e){var t=new Date;return t.setHours(e.hour||0),t.setMinutes(e.minute||0),t.setSeconds(e.second||0),t},t.prototype.rGb=function(e,t){return!(!e||!t)&&(e=this.yGb(e),t=this.yGb(t),e.hour===t.hour&&e.minute===t.minute&&e.second===t.second)},t.prototype.yGb=function(e){return{hour:e.hour||0,minute:e.minute||0,second:e.second||0}},t.prototype.uEb=function(e){var t,n,o,i,s,l,u=e.target;u&&(t=+u.getAttribute("hour"),n=+u.getAttribute("minute"),o=+u.getAttribute("second"),(i=this.cHb||new Date).setHours(t),i.setMinutes(n),i.setSeconds(o),i.setMilliseconds(0),s=a.Common.CultureManager.q4().DateTimeFormat," h:mm:ss",l=new a.Formatter.GeneralFormatter(s.shortDatePattern+" h:mm:ss").format(i),this.fire(r.BaseDropdown.Event_ValueChanged,{value:i,text:l}),this.KEb={hour:t,minute:n,second:o},this.wEb())},t}(r.BaseDropdown),t.TimePicker=l},"./dist/plugins/celltype/editor/workflowPicker.js":function(e,t,n){"use strict";var o,r,i,a,s,l=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/baseControl.js"),r=n("./dist/plugins/celltype/editor/listControl.js"),i=n("@grapecity/js-sheets-common"),a=i.Common.j.Fa,s=function(e){function t(t,n){var i=e.call(this,t)||this;return i.FP=new r.List(t),i.FP.on(o.BaseDropdown.Event_ValueChanged,(function(e){i.fire(o.BaseDropdown.Event_ValueChanged,e)})),i.setOptions(n),i}return l(t,e),t.prototype.setOptions=function(e){this.$z=e},t.prototype.setValue=function(e){if(this.$z){var t=function(e,t){var n,o,r={items:[]},i=e.items,s=i.filter((function(e){return e.value===t}))[0];if(a(s)&&i&&i.length>0)r.items.push({text:i[0].value,value:i[0].value});else if(s&&s.transitions&&s.transitions.length>0)for(n=function(e){var t,n=s.transitions[e];"number"==typeof n&&i[n]&&(n=i[n].value),(t=i.filter((function(e){return e.value===n}))[0])&&r.items.push({text:t.value,value:t.value})},o=0;o<s.transitions.length;o++)n(o);return r}(this.$z,e);this.FP.setOptions(t)}},t.prototype.updateStyle=function(e,t,n){this.FP.updateStyle(e,t,n)},t}(o.BaseDropdown),t.WorkFlow=s},"./dist/plugins/celltype/hyperlinkcelltype.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function N(e,t,n,o,r,i){var a=0,s=0,l=e.width,u=e.height;return a=i=i||0,1===o?a=(l-t)/2:2===o&&(a=l-t-i),1===r?s=(u-n)/2:2===r&&(s=u-n),{x:a,y:s}}function I(e,t,n,o){var r=k(e,n),i=r.width;return i+=1==(1!==t&&!u(o))?o:0,r.width=i,r}function R(e,t,n,o,r,i){var a=k(e,o),s=N(r,a.width,a.height,t,n,i);return a.x=s.x,a.y=s.y,a}function k(e,t){var n=f(t);return{x:0,y:0,width:Math.max(0,r.Vn.Xn(e,t,!0)),height:e.split(/\r\n|\r|\n/).length*n}}function E(e,t,n,o,i,a){var s,l,c,f,h,p,d,g,m,y,b,C=i.sheet,w=C._render;if(u(n))return!1;if(a||(s=C.getValue(i.row,i.col,i.sheetArea),u(s)||(a=s+"")),!a)return!1;for(o=n.cellType.f5(o,n),a=a.replace(/\s+/g," "),l=n&&n.font?n.font:w.Bl(),l=w.Cl(l),c=[a],f=D(n),n.wordWrap&&(a=(c=r.Vn.Wn(a,o.width-3-f,l)).join("\r\n")),h=R(a,n.hAlign,n.vAlign,l,o,f),p=o.y+h.y,d=0;d<c.length;d++)if(g=R(c[d],n.hAlign,n.vAlign,l,o,f),m=o.x+g.x,y=v(m+g.width,o.x+o.width),p=v((b=p)+g.height,o.y+o.height),m<=e&&e<y&&b<=t&&t<p)return!0;return!1}function D(e){return 8*(e.textIndent||0)}function j(e,t,n,o,i){var s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x=o&&o.sheet;if(x){if(u=x._render,c=t.font||u.Bl(),n>1&&(c=u.Cl(c)),f=D(t),t.wordWrap||i){if(t.wordWrap){if(h=o.row,p=o.col,d=o.sheetArea,g=0,m=x._modelManager.findSpan(h,p,d)){if(m.row>=h&&m.rowCount<=1&&m.col>=p&&p===m.col&&(g=x.Tl(p),m.colCount>1))for(y=p+1;y<p+m.colCount;y++)g+=x.Tl(y)}else g=x.Tl(p);if(s=a(t,1),(l=a(t,3))>0&&(g-=l),s>0&&(g-=s),v=r.Vn.Wn(e,g-3-f,c),i&&e.split(/\r\n|\r|\n/).length>1){for(b=0,C=0;C<v.length;C++)b=Math.max(b,I(v[C],t.hAlign,c,D(t)).width);return b}i||(e=v.join("\r\n"))}}else e=e.replace(/\s+/g," ");return w=I(e,t.hAlign,c,D(t)),i?w.width:w.height}return 0}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),i=(r=n("Core")).CellTypes.Context,a=i.u5,s=r.CellTypes.Base,l=r.Ul.Nl,u=o.Common.j.Fa,c=o.Common.u.BIc,f=r.Ul.fp,h=r.Ul.Ml,p=h.mozilla,d=r.GC$,g=d.each,m=null,y=Math.max,v=Math.min,b=Math.floor,C=window.open,w="left",x="default",A="hyperlinkInfo",function(e){e[e.blank=0]="blank",e[e.self=1]="self",e[e.parent=2]="parent",e[e.top=3]="top"}(t.HyperLinkTargetType||(t.HyperLinkTargetType={})),M={linkColor:"#0066cc",visitedLinkColor:"#3399ff",text:"",linkToolTip:"",target:0,activeOnClick:!0},S=function(e){function t(){var t,n=e.call(this)||this;return n.typeName="8",t=n,n.yn=n.wK(),g(M,(function(e,n){t["_"+e]=n})),n._onAction=function(e){var t=e&&e.sheet,n=e.row,o=e.col,r=e.sheetArea,i=t.getValue(n,o,r),a=function(e){return["_blank","_self","_parent","_top"][e]}(this._target);i&&C(c(i),a)},n}return T(t,e),t.prototype.wK=function(){var e,t;return u(this.yn)&&(this.yn="0"),t="id_"+(e=parseInt(this.yn,10)),e++,this.yn=e+"",t},t.prototype.Eka=function(e,t,n,o,r,i,a,s,l,u){var c,f,d,g,m,y,v,C,x,A=1,M=w,S=a.hAlign,T=a.vAlign,N=s.lineHeight,I=l.length;for(A+=t,1===S?(A=r/2,M="center"):2===S&&(A=r-1,A-=t,M="right"),e.textAlign!==M&&(e.textAlign=M),c=1,f="alphabetic",c+=N-(m=N/2-(d=parseInt(s.fontInfo.fontSize,10))/2+(g=d>8?b((d-8)/5+2):1)-1),1===T?N<i&&(c=p?(i-u)/2+1:h.msie?(i-u)/2+.5:(i-u)/2,b(c)!==c&&(c+=.5),c+=N/2-m):2===T&&(c=i-u-2.5-m),e.textBaseline!==f&&(e.textBaseline=f),y=o+c,v=0;v<I;v++)e.fillText(l[v],n+A,y),C=e.measureText(l[v]).width,(x=a.textDecoration)&&this.ip(e,x,n+A,y,C,d,g),y+=N},t.prototype.Fka=function(e,t,n,o,i,a,s,l,u){var c,f,h,p,d,g,m,v=s.hAlign,C=s.vAlign,w=l.lineHeight,x=u.length,A=0,M=0,S=0,T=0;for(2!==v&&(S=1),2===s.vAlign&&(T=-2.5),T-=y(0,Math.round(w/9)-1),e.strokeStyle!==e.fillStyle&&(e.strokeStyle=e.fillStyle),d=l.fontInfo.fontSize,g=b((d-12)/21+1),e.lineWidth=g,e.beginPath(),m=0;m<x;m++)c=e.measureText(u[m]).width,h=(f=S+n+(p=N(new r.Rect(n,o,i,a),c,w*x,v,C,t)).x)+c,A=T+o+p.y+w,b(A)===A&&(A+=.5),M=A,e.moveTo(f,A),e.lineTo(h,M),e.stroke(),T+=w},t.prototype.paintValue=function(e,t,n,o,i,a,s,l){var c,f,h,p,d,g,m,y,v,b,C,w,x,M,S,T,N=this;if(e&&(c=N.getText(t,l),!u(c))){for(f=(c+="").split(/\r\n|\r|\n/),h=0;h<f.length;)f[h]=f[h].replace(/\s+/g," "),h++;c=f.join("\r\n"),p=!1,d=l.sheet._modelManager,g=l.row,m=l.col,y=l.sheetArea,(v=d.getValueForKey(g,m,A,y))&&(N.yn===v.id?p=v.visited:d.do("setValueForKey",g,m,A,void 0,y)),e.save(),e.beginPath(),(b=p?N._visitedLinkColor:N._linkColor)&&e.fillStyle!==b&&(e.fillStyle=b),(C=s.font)&&e.font!==C&&r.Ul.lZa(e,C),w=D(s),l.sheet.outlineColumn&&l.sheet.outlineColumn.XQa(l.col)&&(w=0),x=[],M=0,S=0,s.wordWrap?(T=i-3-w,T-=1,(M=(x=r.Vn.Wn(c,T,C)).length)>1&&0!==s.vAlign&&(S=(M-1)*l.lineHeight)):x.push(c),e.rect(n,o,i,a),e.clip(),e.beginPath(),N.Eka(e,w,n,o,i,a,s,l,x,S),N.Fka(e,w,n,o,i,a,s,l,x),e.restore()}},t.prototype.getText=function(e,t){return this._text||e},t.prototype.tw=function(e,t,n,o){if(!e.HF){var r=e.parent;r&&r.tw(e,t,n,o)}},t.prototype.getHitInfo=function(e,t,n,o,r){var i;return r&&(i=r.sheetArea,(u(i)||3===i)&&n&&o)?{x:e,y:t,row:r.row,col:r.col,cellStyle:n,cellRect:o,sheetArea:i,isFocusAware:!0,sheet:r.sheet,isReservedLocation:E(e,t,n,o,r,this._text)}:m},t.prototype.processMouseDown=function(e){var t=e&&e.sheet;t&&!t.isEditing()&&e.isReservedLocation&&(this.AK=!0)},t.prototype.processMouseUp=function(e){var t,n=e&&e.sheet;n&&!n.isEditing()&&(t=this,e.isReservedLocation&&t.AK&&t.Eia(e),t.AK=!1)},t.prototype.processMouseMove=function(e){var t,n=e.row,o=e.col,r=e.sheet;!r||r.isEditing()&&r.getActiveRowIndex()===n&&r.getActiveColumnIndex()===o||(t=r.Ws(),e.isReservedLocation?t&&(this.BK(r,e),t.style.cursor="pointer"):(this.CK(r),t&&(t.style.cursor=x)))},t.prototype.processMouseLeave=function(e){var t,n=e.sheet;this.AK=!1,this.CK(n),n&&((t=n.Ws())&&(t.style.cursor=x))},t.prototype.BK=function(e,t){var n,o,r,i,a,s,l=this;l._linkToolTip&&(n=l.DK(),(o=d(n)).text(l._linkToolTip),i=(r=e._eventHandler.bG()).left+t.x,a=r.top+t.y+20,0===o.parent().length&&((s=e&&e.zo())&&s.insertBefore(n,m),o.css("top",a).css(w,i)))},t.prototype.CK=function(e){var t,n=this;n.EK&&((t=e&&e.zo())&&n.EK.parentElement===t&&function(e,t){e.removeChild(t)}(t,n.EK),n.EK=m)},t.prototype.DK=function(){var e,t=this;return t.EK||(e=l("div"),d(e).css("position","absolute").css("margin",0).css("padding",2).css("border","1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css("box-sizing","content-box").css("background-color","white").css("font","9pt Arial"),t.EK=e),t.EK},t.prototype.isReservedKey=function(e,t){return 32===e.keyCode&&!e.ctrlKey&&!e.shiftKey&&!e.altKey},t.prototype.processKeyUp=function(e,t){return!!t.sheet&&(this.Eia(t),!0)},t.prototype.getAutoFitWidth=function(e,t,n,o,r){return j(this._text||e,n,o,r,!0)},t.prototype.getAutoFitHeight=function(e,t,n,o,r){return j(this._text||e,n,o,r)},t.prototype.isImeAware=function(e){return!1},t.prototype.Eia=function(e){var t=e&&e.sheet,n=this,o=e.row,r=e.col,i=e.sheetArea;n.onClickAction().call(this,e),t._modelManager.do("setValueForKey",o,r,A,{id:n.yn,visited:!0},i),t.repaint(t.getCellRect(o,r)),n.tw(t,o,r,i)},t.prototype.onClickAction=function(e){return 0===arguments.length?this._onAction:(e&&(this._onAction=e),this)},t.prototype.toJSON=function(){var e,t=this,n={typeName:t.typeName};return g(M,(function(o,r){(e=t["_"+o])!==r&&(n[o]=e)})),n},t.prototype.fromJSON=function(e){var t=this;g(M,(function(n){var o=e[n];u(o)||(t["_"+n]=o)}))},t.prototype._createCellTypeElement=function(e){},t.prototype.gQa=function(){var e,n=this,o=new t;return g(M,(function(t,r){(e=n["_"+t])!==r&&(o["_"+t]=e)})),o._onAction=n._onAction,o},t}(s),t.HyperLink=S,g(M,(function(e){S.prototype[e]=function(t){return 0===arguments.length?this["_"+e]:(this["_"+e]=t,this)}})),r.CellTypes._o[8]=S},"./dist/plugins/celltype/radiochecklistcelltype.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function D(e,t){return e.hasOwnProperty(t)}function j(e,t){return e instanceof Date&&t instanceof Date?a(e)===a(t):!p(e)&&!p(t)&&e.toString&&t.toString?""+e==""+t:e===t}function _(e,t,n,o,r){var i=t.zoom(),a=e.icon_size*i,s=P(e,n),u=l(s,a),c=o;return e._items.length<o&&(c=e._items.length),u*c+e._itemSpacing.vertical*i*(c-1)}function O(e,t,n,o,r){var i=e.icon_size*t.zoom(),a=e.defaultPadding*t.zoom(),s=F(e,t,n,o,r),l=0;return s.forEach((function(e){l+=e})),l+=r*(i+a)+(r-1)*e._itemSpacing.horizontal*t.zoom()}function F(e,t,n,o,r){var i,a,l,u,c,f=[];for(i=0;i<e._items.length;i++)a=D(e._items[i],b)?e._items[i].text:e._items[i],l=t.dp(a,n.font),(u=e.dHb()).hasMagin&&(l=l+u.paddingLeft+u.paddingRight),c=s(i%r),e._direction===x.vertical&&(c=s(i/o)),f[c]===h?f[c]=l:f[c]=Math.max(f[c],l);return f}function P(e,t){var n=v(t.font),o=e.dHb();return o.hasMagin&&(n=n+o.paddingTop+o.paddingBottom),n}function H(e,t,n,o){var r=z(e)*n,i=r;return 1===e.hAlign?i=(t.width-o)/2:2===e.hAlign&&(i=t.width-r-o),i}function B(e,t,n,o){var r=2;return 1===e.vAlign?t.height-2>o&&(r=(t.height-o-2)/2+2):2===e.vAlign&&(r=t.height-o-2),r}function L(e,t,n,o,r){var i,a;if(e._direction===x.vertical){if(e._isFlowLayout){if(r!==h)for(i=e._items.length;i>0;){if(!(_(e,t,n,i,u(e._items.length/i))>r))return[i=l(i,1),u(e._items.length/i)];i-=1}return[e._items.length,1]}return[i=l(1,e._maxRowCount),u(e._items.length/i)]}if(e._isFlowLayout){if(o!==h)for(a=e._items.length;a>0;){if(!(O(e,t,n,u(e._items.length/a),a)>o))return a=l(a,1),[u(e._items.length/a),a];a-=1}return[1,e._items.length]}return a=l(1,e._maxColumnCount),[u(e._items.length/a),a]}function z(e){var t=e.textIndent;return 1===e.hAlign||0===t||t===f||t===h?2:8*t}function V(e,t){var n,r,i=t.cellRect.width,a=t.cellRect.height,u=t.sheet,c=L(e,t.sheet,t.cellStyle,i-1,a),f=c[0],h=c[1],p=F(e,t.sheet,t.cellStyle,f,h),d=e.icon_size*u.zoom(),g=e.defaultPadding*u.zoom(),m=l(P(e,t.cellStyle),d),y=O(e,u,t.cellStyle,f,h),v=_(e,u,t.cellStyle,f),w=H(t.cellStyle,t.cellRect,u.zoom(),y),M=B(t.cellStyle,t.cellRect,u.zoom(),v),S=function(n){var r,i,a,l,c,y=D(e._items[n],b)?e._items[n].text:e._items[n],v=u.dp(y,t.cellStyle.font),S=s(n/h),T=n%h;if(e._direction===x.vertical&&(S=n%f,T=s(n/f)),r=new o.Rect,i=0,p.filter((function(e,t){return t<T})).forEach((function(e){i+=e})),r.x=w+i+T*(d+g+e._itemSpacing.horizontal*u.zoom()),r.y=M+S*m+e._itemSpacing.vertical*u.zoom()*S,a=e.dHb(),r.width=(e._textAlign!==A.right||a.hasMagin?p[T]:v)+d+g,r.height=m,l=t.x-t.cellRect.x,c=t.y-t.cellRect.y,r&&r.contains(l,c))return{value:{value:D(e._items[n],C)?e._items[n].value:e._items[n]}}};for(n=0;n<e._items.length;n++)if("object"==typeof(r=S(n)))return r.value}function G(e,t){var n,o=!1,r=D(e,C)?e.value:e;if(t!==f)if(Array.isArray(t)){for(n=0;n<t.length;n++)if(j(t[n],r)){o=!0;break}}else o=j(t,r);return o}function W(e,t,n,o){var r,i,a,s;if(o)return t;for(e===f&&(e=[]),Array.isArray(e)||(e=[e]),r={},n.forEach((function(e){r[D(e,C)?e.value:e]=!0})),i=e.length-1;i>=0;i--)r[e[i]]||e.splice(i,1);if(-1===(a=e.slice()).indexOf(t))a.push(t);else for(i=a.length-1;i>=0;i--)j(a[i],t)&&a.splice(i,1);return s=[],n.forEach((function(e){-1!==a.indexOf(e.value)&&s.push(e.value)})),s}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("@grapecity/js-sheets-common"),i=r.Common.j.C4,a=r.Common.l.Ra,s=Math.floor,l=Math.max,u=Math.ceil,c="alphabetic",f=null,h=void 0,p=r.Common.j.Fa,d=o.Ul.lZa,g=o.CellTypes.Base,m=o.GC$,y=m.each,v=o.Ul.fp,b="text",C="value",w="number",function(e){e[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical"}(x=t.Direction||(t.Direction={})),function(e){e[e.left=2]="left",e[e.right=3]="right"}(A=t.TextAlign||(t.TextAlign={})),M={items:f,direction:x.horizontal,maxColumnCount:1,maxRowCount:1,isFlowLayout:!0,itemSpacing:{horizontal:20,vertical:5},textAlign:A.right},S=function(e){function t(){var t,n=e.call(this)||this;return n.typeName="11",n.icon_size=12,n.defaultPadding=5,t=n,y(M,(function(e,n){"items"===e&&(n=[]),t["_"+e]=n})),n}return E(t,e),t.prototype.paintValue=function(e,t,n,r,i,a,u,c){var f,h,p,g,m,y,C,w,M,S,T,N,I,R,k,E,j,z,V,G,W,U,Z,q,J,Q,Y,K,$=this;if(e){for(e.save(),e.rect(n+1,r+1,i-2,a-2),e.clip(),e.beginPath(),f=0,0,p=(h=c.sheet).zoom(),g=$.icon_size*p,m=$.defaultPadding*p,y=g/2,C=new o.Rect(n+1,r+1,i-2,a-2),T=O($,h,u,M=(w=L($,h,u,i-2,a-2))[0],S=w[1]),N=_($,h,u,M,S),I=F($,h,u,M,S),R=P($,u),k=n+H(u,C,p,T),E=r+B(u,C,p,N),(j=u.font)&&e.font!==j&&d(e,c.fontInfo.font),u.foreColor&&(e.fillStyle=u.foreColor),z=u.textDecoration,G=(V=c.fontInfo.fontSize)>8?s((V-8)/5+2):1,0,W=v(u.font)/2-V/2+G-1,U=k,Z=E,q=0;q<$._items.length;q++)k>n+i||E>r+a||(J=D($._items[q],b)?$._items[q].text:$._items[q],f=h.dp(J,u.font),e.textAlign="left",Q=$._direction===x.vertical?I[s(q/M)]:I[q%S],Y=0,$._textAlign===A.left?($.zGb(e,$._items[q],t,f,k,E,Q,R,W),k=k+Q+m,e.save(),$.AGb(e,t,$._items[q],k,E+R-W-g,y),e.restore(),Y=g):(e.save(),$.AGb(e,t,$._items[q],k,E+R-W-g,y),k=k+g+m,e.restore(),$.zGb(e,$._items[q],t,f,k,E,Q,R,W),Y=Q),z&&(K=this.dHb(),$.ip(e,z,k-($._textAlign===A.right?0:Q+m)+K.paddingLeft,E+R-W-K.paddingBottom,f,V,G)),$._direction===x.vertical?(E+=l(R,g)+$._itemSpacing.vertical*p,(q+1)%M==0&&(U=U+Q+g+m+$._itemSpacing.horizontal*p,E=r+B(u,C,p,N)),k=U):(k=k+Y+$._itemSpacing.horizontal*p,(q+1)%S==0&&(k=n+H(u,C,p,T),Z=Z+l(R,g)+$._itemSpacing.vertical*p),E=Z));e.restore()}},t.prototype.getText=function(e,t){return e},t.prototype.zGb=function(e,t,n,o,r,i,a,s,l){var u=D(t,b)?t.text:t;e.textBaseline!==c&&(e.textBaseline=c),e.fillText(u,r,i+s-l)},t.prototype.getItemsBound=function(e,t,n,r){var i,a,u,c,f,h,p,d,g,m,y,v,C,w,M,S,T,N,I,R=this,k=e.zoom(),E=e.getActualStyle(t,n,r),j=o.To.No("11pt "+e.currentTheme().bodyFont(),k);for(E.font&&(j=o.To.No(E.font,k)),E.font=j.font,i=1===r?-1:void 0,a=2===r?-1:void 0,c=(u=e.getCellRect(t,n,i,a)).width,f=u.height,h=L(R,e,E,c-1,f),p=h[0],d=h[1],g=F(R,e,E,p,d),m=R.icon_size*e.zoom(),y=R.defaultPadding*e.zoom(),v=l(P(R,E),m),C=O(R,e,E,p,d),w=_(R,e,E,p,d),M=H(E,u,e.zoom(),C),S=B(E,u,e.zoom(),w),T=[],N=function(t){var n,r,i,a=D(R._items[t],b)?R._items[t].text:R._items[t],l=e.dp(a,E.font),c=s(t/d),f=t%d;R._direction===x.vertical&&(c=t%p,f=s(t/p)),n=new o.Rect,r=0,g.filter((function(e,t){return t<f})).forEach((function(e){r+=e})),n.x=M+r+f*(m+y+R._itemSpacing.horizontal*e.zoom())+u.x,n.y=S+c*v+R._itemSpacing.vertical*e.zoom()*c+u.y,i=R.dHb(),n.width=(R._textAlign!==A.right||i.hasMagin?g[f]:l)+m+y,n.height=v,n.x>u.x+u.width||n.y>u.y+u.height?T[t]=null:T[t]=n},I=0;I<R._items.length;I++)N(I);return T},t.prototype.AGb=function(e,t,n,o,r,i){},t.prototype.dHb=function(){return{hasMagin:!1,paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}},t.prototype.getAutoFitWidth=function(e,t,n,o,r){var i=r&&r.sheet,a=z(n),s=L(this,i,n);return(O(this,i,n,s[0],s[1])+a)/i.zoom()},t.prototype.getAutoFitHeight=function(e,t,n,o,r){var i=r&&r.sheet,a=L(this,i,n);return _(this,i,n,a[0],a[1])/i.zoom()},t.prototype.getHitInfo=function(e,t,n,r,i){var a,s,l,u,c,h,d,g,m,y,v=this;return i?(r=n.cellType.f5(r,n),a=i.sheetArea,s=i.sheet,(p(a)||3===a)&&r?(l={x:e,y:t,row:i.row,col:i.col,cellStyle:n,cellRect:r,sheetArea:a,sheet:s},n.font&&(n.font=o.To.No(n.font,s.zoom()).font),d=O(v,s,n,c=(u=L(v,s,n,r.width-1,r.height-2))[0],h=u[1]),g=_(v,s,n,c,h),m=r.x+H(n,r,s.zoom(),d),y=r.y+B(n,r,s.zoom(),g),new o.Rect(m,y,d,g).contains(l.x,l.y)&&(l.isReservedLocation=!0),l):f):f},t.prototype.processMouseDown=function(e){return!!e&&void(e.isReservedLocation&&(this.uK=!0))},t.prototype.processMouseLeave=function(t){return e.prototype.processMouseLeave.call(this,t),!!t&&void(this.uK=!1)},t.prototype.processMouseUp=function(e){var t,n,o,r,i,a;return!!e&&(t=this,n=e.sheet,!!(t.uK&&n&&e.isReservedLocation&&(t.uK=!1,o=e.row,r=e.col,i=e.sheetArea,a=V(t,e)))&&(function(e,t,n,o,r,i){var a=t.getValue(n,o,i),s=e.rK(a,r),l={cmd:"editCell",sheetName:t.name(),row:n,col:o,newValue:s,autoFormat:!0};t.wu().execute(l),e.triggerButtonClicked(t,n,o,i)}(t,n,o,r,a.value,i),!0))},t.prototype.rK=function(e,t){return W(e,t,this._items,!0)},t.prototype.triggerButtonClicked=function(e,t,n,o){var r=e.parent;r&&r.tw(e,t,n,o)},t.prototype.toJSON=function(){var e,t=this,n={typeName:t.typeName};return y(M,(function(o,r){e=t["_"+o],("items"===o?e&&e.length>0:e!==r)&&(n[o]="object"==typeof e?i(e):e)})),n},t.prototype.fromJSON=function(e){var t=this;y(M,(function(n){var o=e[n];p(o)||(t["_"+n]=o)}))},t}(g),T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return E(t,e),t.prototype.AGb=function(e,t,n,o,r,i){var a=D(n,C)?n.value:n;e.beginPath(),e.fillStyle="white",e.arc(o+i,r+i,i,0,2*Math.PI),e.fill(),e.beginPath(),e.strokeStyle="black",e.arc(o+i,r+i,i,0,2*Math.PI),e.stroke(),t!==f&&j(t,a)&&(e.beginPath(),e.strokeStyle="black",e.arc(o+i,r+i,.5*i,0,2*Math.PI),e.fillStyle="black",e.fill(),e.stroke())},t}(S),t.RadioButtonList=T,N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.typeName="12",t}return E(t,e),t.prototype.AGb=function(e,t,n,o,r,i){e.strokeStyle="black",e.strokeRect(o+.5,r+.5,2*i+.05,2*i+.05),e.fillStyle="white",e.fillRect(o+1,r+1,2*i-1,2*i-1);var a=G(n,t);t!==f&&a&&(e.beginPath(),e.lineWidth=2.5,e.moveTo(o+3,r+i),e.lineTo(o+i,r+2*i-3.5),e.lineTo(o+2*i-1.5,r+3),e.stroke())},t.prototype.rK=function(e,t){return W(e,t,this._items,!1)},t}(S),t.CheckBoxList=N,function(e){e[e.single=0]="single",e[e.multiple=1]="multiple"}(I=t.SelectionMode||(t.SelectionMode={})),R={selectedBackColor:"rgb(227,119,0)",selectedForeColor:"white",padding:"5",items:f,itemSpacing:{horizontal:5,vertical:5},selectionMode:I.multiple},k=function(e){function t(){var t,n=e.call(this)||this;return n.typeName="13",n.icon_size=0,n.defaultPadding=0,t=n,y(R,(function(e,n){"items"===e&&(n=[]),t["_"+e]=n})),n}return E(t,e),t.prototype.zGb=function(e,t,n,o,r,i,a,s,l){var u,f,h,p,d;e.save(),e.beginPath(),u=G(t,n),f=D(t,b)?t.text:t,h=this._selectedBackColor,p=this._selectedForeColor,u&&(e.fillStyle=h,e.fillRect(r+1,i+1,a-1,s-1),e.fillStyle=p),e.textAlign="center",e.textBaseline!==c&&(e.textBaseline=c),d=this.dHb(),e.fillText(f,r+d.paddingLeft+(a-d.paddingLeft-d.paddingRight)/2,i+d.paddingTop+s-d.paddingTop-d.paddingBottom-l),e.restore()},t.prototype.rK=function(e,t){return W(e,t,this._items,this._selectionMode===I.single)},t.prototype.dHb=function(){var e,t=0,n=0,o=0,r=0;return this._padding&&(e=function(e){var t,n,o,r,i=["0","0","0","0"];return"string"==typeof e&&(o=void 0,r=void 0,1===(n=(t=e.split(" ",4)).length)?i=[o=t[0],o,o,o]:2===n?i=[o=t[0],r=t[1],o,r]:3===n?(r=t[1],i=[t[0],r,t[2],r]):4===n&&(i=[t[0],t[1],t[2],t[3]])),i}(this._padding),t=typeof(t=parseInt(e[0],10))===w&&t>0?t:0,r=typeof(r=parseInt(e[1],10))===w&&r>0?r:0,n=typeof(n=parseInt(e[2],10))===w&&n>0?n:0,o=typeof(o=parseInt(e[3],10))===w&&o>0?o:0),{hasMagin:!0,paddingTop:t,paddingBottom:n,paddingLeft:o,paddingRight:r}},t.prototype.toJSON=function(){var t,n=this,o=e.prototype.toJSON.call(this);return y(R,(function(e,r){t=n["_"+e],("items"===e?t&&t.length>0:t!==r)&&(o[e]="object"==typeof t?i(t):t)})),o},t.prototype.fromJSON=function(t){e.prototype.fromJSON.call(this,t);var n=this;y(R,(function(e){var o=t[e];p(o)||(n["_"+e]=o)}))},t}(S),t.ButtonList=k,y(M,(function(e){S.prototype[e]=function(t){var n,o,r,i,a,s,l="_"+e;if(0===arguments.length)return this[l];if("items"===e){for(n=[],o=0;o<t.length;o++)r=t[o],p(r.text)||p(r.value)?p(r.text)?p(r.value)?p(r)||"object"==typeof r||n.push({text:r,value:r}):(r.text=r.value,n.push(r)):(r.value=r.text,n.push(r)):n.push(r);t=n}return"itemSpacing"===e?(i=this[l],this[l]={horizontal:i.horizontal,vertical:i.vertical},p(t.horizontal)||(a=parseInt(t.horizontal,10),isNaN(a)||(this[l].horizontal=a)),p(t.vertical)||(s=parseInt(t.vertical,10),isNaN(s)||(this[l].vertical=s))):this[l]=t,this}})),o.CellTypes._o[11]=T,o.CellTypes._o[12]=N,y(R,(function(e){k.prototype[e]=function(t){var n,o,r,i,a,s,l="_"+e;if(0===arguments.length)return this[l];if("items"===e){for(n=[],o=0;o<t.length;o++)r=t[o],p(r.text)||p(r.value)?p(r.text)?p(r.value)?p(r)||"object"==typeof r||n.push({text:r,value:r}):(r.text=r.value,n.push(r)):(r.value=r.text,n.push(r)):n.push(r);t=n}return"itemSpacing"===e?(i=this[l],this[l]={horizontal:i.horizontal,vertical:i.vertical},p(t.horizontal)||(a=parseInt(t.horizontal,10),isNaN(a)||(this[l].horizontal=a)),p(t.vertical)||(s=parseInt(t.vertical,10),isNaN(s)||(this[l].vertical=s))):this[l]=t,this}})),o.CellTypes._o[13]=k},"./dist/plugins/celltype/rangecelltype.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function p(e){return e.map((function(e){return{start:e.start,size:e.size}}))}function d(e,t,n,r,i,a){var u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q=t.x,Y=t.y,K=t.width,$=t.height,X=r.sheet,ee=r.sheetArea,te=r.isPrinting,ne=r.needTopGridline,oe=r.needLeftGridline,re=[],ie=[],ae=X.vu(),se=a.rowCount,le=a.colCount,ue=a.rowSize,ce=a.colSize,fe=a.cellStyleList,he=a.sparklines;for(i.$Jb(n),c=(u=i.cKb()).baseRow,f=u.baseCol,p=(h=i.UJb).Pm,h.Us(new o.Rect(0,0,K,$)),d=new o.AF(h,h.Gr(1,3),h.Hr(1,3),3),g=i.dKb(!0),Y+=1,$-=1,Q+=1,K-=1,m=0,y=0,ue=ue.map((function(e){var t=e.size*$,n=l(t);return(y+=t-n)>=1&&(n++,y--),{start:l(e.start*$),size:n}})),ce=ce.map((function(e){var t=e.size*K,n=l(t);return(m+=t-n)>=1&&(n++,m--),{start:l(e.start*K),size:n}})),v=h.conditionalFormats,b=0;b<se;b++)for(C=0;C<le;C++)if(fe[b][C]){if(x=(w=fe[b][C]).style,A=w.isSpan,M=w.span,S=!1,T=g[b][C],A&&!M)continue;if(x=x.clone(!0),N=l(Q+ce[C].start),I=l(Y+ue[b].start),void 0,void 0,E=A?M.colCount:1,D=A?M.rowCount:1,R=ce[C+E]?ce[C+E].start:K,j=l(R-ce[C].start),k=ue[b+D]?ue[b+D].start:$,_=l(k-ue[b].start),T.formatStyle&&(T.formatStyle.Yo(x),x=T.formatStyle),x.Zo(p),O=null,A){for(O={row:b,col:C,x:l(N),y:l(I),width:l(j),height:l(_),rowCount:D,colCount:E},F={},P={},H=[],B=void 0,L=void 0,z=0,V=0,B=0;B<E-1;B++)W=(G=ce[C+B])?G.size:0,P[B]=W,z+=W;for(P[B]=l(j)-z,L=0;L<D-1;L++)W=(U=ue[b+L])?U.size:0,F[L]=W,V+=W;for(F[L]=l(_)-V,L=0;L<D;L++){for(Z=[],q=0;q<E;q++)fe[L+b]&&fe[L+b][C+q]&&Z.push(fe[L+b][C+q].style);H.push(Z)}O.spanSizeInfo={styleList:H,rowSizes:F,colSizes:P}}d.jF(b,C,l(N),l(I),l(j),l(_),x,O,ne&&0===b,oe&&0===C),J=null,he[b][C]&&((J=he[b][C].clone())&&(J.oZa=h.name(),J.hKb=J.iKb(h),J.jKb=J.kKb(h),J.lKb=h)),T&&T.value&&"SparklineExValue"===T.value.typeName&&(s.bDc(e,T.value,N,I,j,_,X),S=!0),T.validStyle&&ie.push({style:T.validStyle,x:N,y:I,width:j,height:_}),!S&&re.push({data:T.value,row:b,col:C,x:N,y:I,width:j,height:_,style:x,sparkline:J,baseRow:b+c,baseCol:C+f,conditionalFormats:v,imageLoader:ae,cellLayout:{row:b,col:C,x:N,y:I,width:j,height:_}})}e.save(),ne&&(Y-=2,$+=4),oe&&(Q-=2,K+=4),e.rect(Q,Y,K,$),e.clip(),re.length>0&&h._render.SI(e,re,ee,te,X,c,f),d.paint(e),ie.length>0&&h._render.jJ(e,ie),e.restore()}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("Bindings"),i=n("Sparkline"),a=o.CellTypes.Base,s=o.CellTypes.Context,l=Math.floor,u=function(){function e(){this.Uu=0,this.SV=0,this.Xj=0,this.OZ=0}return e.prototype.YE=function(e,t){var n=this,o=t.row,r=t.col,i=t.rowCount,a=t.colCount;return n.Uu=o,n.SV=r,n.Xj=i,n.OZ=a,n.Ny=n.nJb(e,t),n.NJb=n.OJb(e,t),n},e.prototype.PJb=function(){return this.NJb},e.prototype.OJb=function(e,t){var n,o,r,i,a,s=this,l=t.row,u=t.col,c=t.rowCount,f=t.colCount,h=0,p=[],d=0,g=[],m=0,y=l+c,v=u+f;for(n=l;n<y;n++)m=e.getRowHeight(n),d+=m,g.push(m);for(o=u;o<v;o++)m=e.getColumnWidth(o),h+=m,p.push(m);return m=0,r=g.map((function(e){var t=m/d;return m+=e,{start:t,size:e/d}})),m=0,i=p.map((function(e){var t=m/h;return m+=e,{start:t,size:e/h}})),a=s.nJb(e,t),{rowCount:c,colCount:f,rowSize:r,colSize:i,cellStyleList:s.QJb(e,t,a,r,i),sparklines:s.RJb(e,t),totalHeight:d,totalWidth:h}},e.prototype.SJb=function(e,t,n,r,i){var a,s,l,u,c,f,h,p=null;for(a=0,s=i;a<s.length;a++)if(u=(l=s[a]).rowOffset,c=l.colOffset,f=l.rowCount,h=l.colCount,new o.Range(u+n,c+r,f,h).contains(e,t)){p=l;break}return p},e.prototype.TJb=function(e,t,n){var o,r=[0,0],i=r[0],a=r[1],s=e.rowOffset,l=e.colOffset,u=s+e.rowCount,c=l+e.colCount;for(o=s;o<u;o++)a+=t[o]?t[o].size:0;for(o=l;o<c;o++)i+=n[o]?n[o].size:0;return{width:i,height:a}},e.prototype.QJb=function(e,t,n,o,r){var i,a,s,l,u,c=t.row,f=t.col,h=t.rowCount,p=t.colCount,d=[];for(i=c;i<c+h;i++){for(a=[],s=f;s<f+p;s++)(l=this.SJb(i,s,c,f,n))&&l.rowOffset+c===i&&l.colOffset+f===s?(u=this.TJb(l,o,r),a.push({style:e.getActualStyle(i,s,3,!0),spanWidth:u.width,spanHeight:u.height,isSpan:!0,span:l})):l?a.push({style:e.getActualStyle(i,s,3,!0),isSpan:!0}):a.push({style:e.getActualStyle(i,s,3,!0)});d.push(a)}return d},e.prototype.nJb=function(e,t){var n,o,r,i=e._modelManager.getSpans(),a=[],s=t.row,l=t.col,u=t.rowCount,c=t.colCount;for(n=0,o=i;n<o.length;n++)(r=o[n]).intersect(s,l,u,c)&&a.push({rowOffset:r.row-s,colOffset:r.col-l,rowCount:r.rowCount,colCount:r.colCount});return a},e.prototype.RJb=function(e,t){var n,o,r,i,a=t.row,s=t.col,l=t.colCount,u=t.rowCount,c=[];for(n=a;n<a+u;n++){for(o=[],r=s;r<s+l;r++)(i=e.getSparkline(n,r))?o.push(i.clone()):o.push(null);c.push(o)}return c},e.prototype.toJSON=function(){var e=this.PJb(),t=e.rowCount,n=e.colCount,o=e.rowSize,r=e.colSize,i=e.cellStyleList,a=e.sparklines,s=e.totalWidth,l=e.totalHeight,u=p(o),c=p(r),f=i.map((function(e){return e.map((function(e){if(e){var t=e.style,n=e.spanWidth,o=e.spanHeight,r=e.isSpan,i=e.span;return{style:t.toJSON(),spanWidth:n,spanHeight:o,isSpan:r,span:i}}return null}))}));return{rowCount:t,colCount:n,rowSize:u,colSize:c,cellStyleList:f,sparklines:a.map((function(e){return e.map((function(e){if(e)return{sparklineType:e.sparklineType(),sp:e.toJSON(),setting:e.setting().toJSON()}}))})),totalWidth:s,totalHeight:l}},e.prototype.fromJSON=function(e){var t,n,r,a,s,l,u,c,f,h,d,g;e&&(t=e.rowCount,n=e.colCount,r=e.rowSize,a=e.colSize,s=e.cellStyleList,l=e.sparklines,u=e.totalWidth,c=e.totalHeight,f=p(r),h=p(a),d=s.map((function(e){return e.map((function(e){var t,n,r,i,a,s;return e?(t=e.style,n=e.spanWidth,r=e.spanHeight,i=e.isSpan,a=e.span,s=null,t&&(s=new o.Style).fromJSON(t),{style:s,spanWidth:n,spanHeight:r,span:a,isSpan:i}):null}))})),g=l.map((function(e){return e.map((function(e){if(e){var t=new i.Sparkline,n=new i.SparklineSetting(e.setting);return t.fromJSON(e.sp),t.setting(n),t.sparklineType(e.sparklineType),t}}))})),this.NJb={rowCount:t,colCount:n,rowSize:f,colSize:h,cellStyleList:d,sparklines:g,totalWidth:u,totalHeight:c})},e.prototype.no=function(){this.NJb=null},e}(),t.Wgc=u,c=function(){function e(){}return e.prototype.YE=function(e,t){var n=this;return n.my=t,n.UJb=new o.Worksheet,n.VJb=e.parent&&e.parent.options.allowDynamicArray,n.UJb.getCalcService&&(n.UJb.getCalcService().allowDynamicArray=n.VJb,n.WJb=n.XJb(e)),n.YJb(e),n},e.prototype.XJb=function(e){var t,n,o,r,i,a,s,l=this.my,u=l.row,c=l.col,f=l.colCount,h=l.rowCount,p=[],d=e.Bj&&e.Bj();for(t=u;t<u+h;t++)for(n=c;n<c+f;n++)e.getFormula(t,n)&&((o=d&&d.Qf(t,n))&&o.isDynamicArray&&(r=o.row,i=o.col,a=o.rowCount,s=o.colCount,a>1&&p.push({row:r+1,col:i,rowCount:a-1,colCount:s}),s>1&&p.push({row:r,col:i+1,rowCount:1,colCount:s-1})));return p},e.prototype.ZJb=function(){var e,t,n,o,r,i,a,s=this.WJb,l=this.UJb;for(e=0,t=s;e<t.length;e++)o=(n=t[e]).row,r=n.col,i=n.rowCount,a=n.colCount,l.clear(o,r,i,a,3,1)},e.prototype.$Jb=function(e){var t,n=this.UJb;n.suspendEvent(),t=new r.CellBindingSource(e),this.ZJb(),n.setDataSource(t),n.resumeEvent()},e.prototype.YJb=function(e){var t=this.UJb,n=e.toJSON({includeBindingSource:!0});delete n.charts,delete n.shapes,delete n.tables,t.fromJSON(JSON.parse(JSON.stringify(n))),this._Jb()},e.prototype._Jb=function(){var e,t,n=this.my,o=n.row,r=n.col,i=n.colCount,a=n.rowCount,s=[],l=[];for(e=o;e<o+a;e++){for(l=[],t=r;t<r+i;t++)l.push(this.aKb(e,t,3));s.push(l)}this.bKb=s},e.prototype.cKb=function(){var e=this.my;return{baseRow:e.row,baseCol:e.col}},e.prototype.dKb=function(e){var t,n,o,r,i,a,s,l=this.UJb,u=this.my,c=u.row,f=u.col,h=u.colCount,p=u.rowCount,d=[];for(t=c;t<c+p;t++){for(n=[],o=void 0,r=void 0,i=f;i<f+h;i++)a=l.getText(t,i),s=l.getValue(t,i,3,1),o=this.eKb(t,i,3),r=this.fKb(l,t,i,s,e),n.push({value:s,formatStyle:o,text:a,validStyle:r});d.push(n)}return d},e.prototype.aKb=function(e,t,n){var o;return this.UJb.uja&&(o=this.UJb.getDataValidator(e,t,n))?o.highlightStyle():null},e.prototype.fKb=function(e,t,n,o,r){if(r&&e.isValid&&!e.isValid(t,n,o)){var i=this.my,a=i.row,s=i.col;return this.bKb[t-a][n-s]}return null},e.prototype.eKb=function(e,t,n){var r=this.UJb.conditionalFormats;return r?r.Eq(new o.Style,e,t,n):null},e.prototype.getCellValueInfo=function(e){var t,n,o,r=this.my,i=r.row,a=r.col,s=r.colCount,l=r.rowCount,u=[],c=e._modelManager;for(t=i;t<i+l;t++){for(n=[],o=a;o<a+s;o++)n.push({bindPath:e.getBindingPath(t,o),formula:e.getFormula(t,o),value:c.getValue(t,o,3,null,1)});u.push(n)}return u},e.prototype.setValueToDataStruct=function(e,t,n,o){o[e]||(o[e]={}),o[e][t]=n},e.prototype.toJSON=function(){var e=this.UJb,t=this.VJb,n=this.WJb.map((function(e){return{row:e.row,col:e.col,rowCount:e.rowCount,colCount:e.colCount}})),o=this.my;return{spillRangs:n,allowDynamicArray:t,range:{row:o.row,col:o.col,rowCount:o.rowCount,colCount:o.colCount},templatejson:JSON.stringify(e.toJSON({includeBindingSource:!0}))}},e.prototype.fromJSON=function(e){var t,n,r,i,a,s,l;e&&((n=(t=this).UJb=new o.Worksheet).suspendCalcService&&n.suspendCalcService(),t.WJb=e.spillRangs,t.VJb=e.allowDynamicArray,n.getCalcService&&(n.getCalcService().allowDynamicArray=t.VJb),n.fromJSON(JSON.parse(e.templatejson)),t.ZJb(),i=(r=e.range).row,a=r.col,s=r.rowCount,l=r.colCount,t.my=new o.Range(i,a,s,l),this._Jb(),n.resumeCalcService&&n.resumeCalcService())},e.prototype.no=function(){this.UJb.no(),this.UJb=null,this.my=null},e}(),t.Xgc=c,f=function(e){function t(t,n,r,i,a){var s,l=e.call(this)||this;return l.allowOverflow=!1,l.typeName="16",s=1===arguments.length?new o.Range(0,0,t.getRowCount(),t.getColumnCount()):new o.Range(n,r,i,a),t&&s&&(l._R=(new u).YE(t,s),l.gKb=(new c).YE(t,s)),l}return h(t,e),t.prototype.getAutoFitWidth=function(){return this._R.NJb.totalWidth},t.prototype.getAutoFitHeight=function(){return this._R.NJb.totalHeight},t.prototype.updateTemplate=function(e,t){e&&t&&(this._R.YE(e,t),this.gKb.YE(e,t))},t.prototype.paintContent=function(e,t,n,o,r,i,a,s){var l,u=this.gKb,c=this._R;u&&c&&(l=this._R.PJb(),a.cellPadding&&(s.needTopGridline=!0,s.needLeftGridline=!0),d(e,{x:n,y:o,width:r,height:i},t,s,u,l))},t.prototype.toJSON=function(){return{typeName:this.typeName,layout:this._R.toJSON(),resolvor:this.gKb.toJSON()}},t.prototype.fromJSON=function(e){e.layout&&(this._R=new u,this._R.fromJSON(e.layout)),e.resolvor&&(this.gKb=new c,this.gKb.fromJSON(e.resolvor))},t}(a),t.RangeTemplate=f,o.CellTypes._o[16]=f,t.paintRangeTemplate=d},"./dist/plugins/conditional/conditional.entry.js":function(e,t,n){"use strict";function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),o(n("./dist/plugins/conditional/conditional.js")),o(n("./dist/plugins/conditional/conditional.ns.js"))},"./dist/plugins/conditional/conditional.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe,re,ie,ae,se,le,ue,ce,fe,he,pe,de,ge,me,ye,ve,be,Ce,we,xe,Ae,Me,Se,Te,Ne,Ie,Re,ke,Ee,De,je,_e,Oe,Fe,Pe,He,Be,Le,ze,Ve,Ge,We,Ue,Ze,qe,Je,Qe,Ye,Ke,$e,Xe=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function et(e){return e.rowCount}function tt(e){return e.colCount}function nt(e,t,n,o){switch(o&&"string"==typeof t&&"string"==typeof n&&(t=t.toLowerCase(),n=n.toLowerCase()),e){case se.equalsTo:return t===n;case se.notEqualsTo:return t!==n;case se.greaterThan:return t>n;case se.greaterThanOrEqualsTo:return t>=n;case se.lessThan:return t<n;case se.lessThanOrEqualsTo:return t<=n;default:return!1}}function ot(e,t,n,o,r,i,a,s,l){var u=Math.round;switch(e.lineWidth=1,e.rect(i,a,s,l),n=u(++n),o=u(o),e.clip(),t.iconSetType){case 10:case 15:case 1:case 11:case 16:case 0:c.drawArrows(e,t.iconSetType,t.iconIndex,n,o,r);break;case 2:c.drawIconTypeIsTwo(e,t.iconSetType,t.iconIndex,n,o,r);break;case 3:c.drawStar(e,t.iconSetType,t.iconIndex,n,o,r);break;case 14:case 12:case 5:c.drawCircle(e,t.iconSetType,t.iconIndex,n,o,r);break;case 4:c.drawFlag(e,t.iconSetType,t.iconIndex,n,o,r);break;case 6:c.drawTrafficLight(e,t.iconSetType,t.iconIndex,n,o,r);break;case 7:c.drawIconTypeIsSen(e,t.iconSetType,t.iconIndex,n,o,r);break;case 8:c.drawIconTypeIsEight(e,t.iconSetType,t.iconIndex,n,o,r);break;case 9:c.drawIconTypeIsNine(e,t.iconSetType,t.iconIndex,n,o,r);break;case 18:c.drawSector(e,t.iconSetType,t.iconIndex,n,o,r);break;case 17:case 13:c.drawSignal(e,t.iconSetType,t.iconIndex,n,o,r);break;case 19:c.drawMagicCube(e,t.iconSetType,t.iconIndex,n,o,r)}}function rt(e,t,n,o){var r=t.ranges(),i=F(r),a=u.formulaToExpression(e,n,i.r,i.c,o);return u.expressionToFormula(e,a,i.r,i.c,!o)}function it(e){return"string"==typeof e&&("="!==(e=f.trim(e))[0]&&(e='="'+h.Gb(e,'"','""')+'"')),e}function at(e,t){if(t)for(var n=0;n<t.length;n++)e.push(t[n])}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("Core"),i=n("@grapecity/js-calc"),a=n("./dist/plugins/conditional/conditional.ns.js"),s=n("@grapecity/js-calc"),l=n("Core"),u=n("SheetsCalc"),c=n("./dist/plugins/conditional/conditionalFormatIcon.js"),f=r.GC$,h=o.Common.u,p=null,d=void 0,g="undefined",m="string",y=Math.min,v=Math.max,b=Math.abs,C=Math.floor,w=Math.ceil,x=i.Convert,A=x.Na,M=x.Pa,S=x.Th,T=o.Common.u,N=T.Db,I=T.kb,R=T.jb,k=T.Bb,E=o.Common.j.Fa,D=o.Common.q,j=o.Common.F,_=r.Ul,O=_.T$a,F=_.l_a,P=!!i,H=r.Style,B=o.Common.k,L=o.Common.pc,z=L.bc,V=r.kf,G=r.Range,W=o.Common.l,U=o.Common.k,Z=U.Fb,q=U.Cb,J=U.ac,Q=i.Functions,Y=i.evaluateOperator,K=r.Rm,$=new o.Common.ResourceManager(a.SR),X=$.getResource.bind($),ee=function(e){var t=e.row<0?u.BAND_INDEX_CONST:e.row,n=e.col<0?u.BAND_INDEX_CONST:e.col;return s.uf(p,p,t,n,t+e.rowCount-1,n+e.colCount-1)},te=function(e){var t;if(e instanceof i.Expression)t=e;else if(e instanceof G)t=ee(e);else{if(!A(e))throw X().Exp_NotSupport;e=M(e),isNaN(e)||((t=new i.Expression(2)).value=e)}return t},ne=function(e,t,n,o){var r=e,i=t,a=function(e,t){var a,s,l=this;return l.hasOwnProperty("_ps")||(l._ps={}),a=l._ps,0===arguments.length?a[r]!==d?o?o.call(l,a[r]):a[r]:i:(a[r]!==e&&(s=a[r]!==d?a[r]:i,a[r]=e,!1!==t&&n&&n.call(l,e,s)),l)};return a.isDefault=function(e){return e===i},a},oe=function(e,t,n){var o=this;return n||(n={}),t||(t=o),f.each(t,(function(t,r){var i,a=o[r];E(a)||(i=a.call(o),"formula"===r?(o.getFormulaString?i=o.getFormulaString(e,d,d,!0):o.condition()&&o.condition().getFormulaString&&(i=o.condition().getFormulaString(e,d,d,!0)),i&&(n[r]=i)):"iconCriteria"===r||"icons"===r?n[r]=i:W.Ska(i)?n[r]=W.Daa(i):i&&i.toJSON?n[r]=i.toJSON(e):E(i)||a.isDefault(i)||(n[r]=i))})),n},re=function(e,n,o,r){if(o){var i,a=this;n||(n=a),f.each(n,(function(n,s){var l,u,c,h,p,d,g,y,v,b;if(i=o[s],!E(i))if("ranges"===s){for(l=[],u=0;u<i.length;u++)c=i[u],l.push(V(c.row,c.col,et(c),tt(c)));a.ranges(l,!1)}else if("style"===s)a.style(new H,!1),a.style().fromJSON(i,r);else if("iconCriteria"===s)for(h=i.length,p=0;p<h;p++)d=i[p],a.NV[p]=new Je(d.isGreaterThanOrEqualTo,d.iconValueType,d.iconValue);else if("icons"===s)for(g=i.length,y=0;y<g;y++)v=i[y],a.CZa[y]={iconSetType:v.iconSetType,iconIndex:v.iconIndex};else"iconSetType"===s?a[s](i,!0):"item1"===s||"item2"===s?(a[s](t.$V(),!1),a[s]().fromJSON(i,e)):"expected"===s?f.getType(i)!==m||5!==o.conType&&13!==o.conType?a[s](i,!1):"/OADate("===i.substr(0,8)?a[s](W.Rka(i),!1):a[s](new Date(i)):"condition"===s?((b=new Oe).fromJSON(i,e),a.condition(b,!1)):f.getType(i)===m&&"/OADate("===i.substr(0,8)?a[s](W.Rka(i),!1):a[s](i,!1)}))}},ie=r.lUa,f.extend(ie.prototype,{YUa:function(){var e=this.zTa;e&&!e.ZUa&&(e.ZUa=this.U5.AW.map((function(e){return{rule:e,ranges:e.ranges().slice()}})))},$Ua:function(e){var t=this.U5,n=this.kj;n.suspendPaint(),e&&(t.AW=e.map((function(e){var t=e.rule;return t.ranges(e.ranges),t})),t.QV()),n.resumePaint()},_Ua:function(e,t,n){this.YUa(),this.U5.rI(e,t,n)},aVa:function(e,t){this.YUa(),this.U5.GR(e,t)},bVa:function(e,t,n){this.YUa(),this.U5.tI(e,t,n)},cVa:function(e,t){this.YUa(),this.U5.HR(e,t)},dVa:function(){this.YUa(),this.U5.Nm()},eVa:function(){this.YUa(),this.U5.QV()}}),ie.$n("conditionalFormat",{init:function(){this.U5=new $e(this.kj)},undo:function(e){var t=e.ZUa;t&&this.$Ua(t)},dispose:function(e){var t=this;!1!==(e&&e.clearCache)&&t.U5&&(t.U5.no(),t.U5=p)}}),ae={init:function(){this.conditionalFormats=this._modelManager.U5},dispose:function(e){if(!1!==e.clearCache){var t=this.conditionalFormats;t&&t.OV()}},onLayoutChanged:function(e){var t=e.changeType,n=e.row,o=et(e),r=e.col,i=tt(e),a=e.sheetArea,s=this._modelManager,l=this.tables;"addRows"===t?s._Ua(n,o,l&&l.KFc(n,-1,o,-1,!0)):"deleteRows"===t?s.aVa(n,o):"addColumns"===t?s.bVa(r,i):"deleteColumns"===t?s.cVa(r,i):"clear"===t?s.dVa():"setColumnCount"!==t&&"setRowCount"!==t||3!==a&&1!==a||s.eVa()},toJson:function(e,t){var n=this.conditionalFormats,o=t&&t.ignoreStyle;n&&!o&&(e.conditionalFormats=n.toJSON(this))},fromJson:function(e,t,n){var o=n&&n.ignoreStyle;e&&e.conditionalFormats&&!o&&this.conditionalFormats.fromJSON(e.conditionalFormats,this,t)}},r.Worksheet.$n("conditionalFormat",ae),r.Workbook.$n("conditionalFormat",{fromJson:function(e,t,n){this.sheets.forEach((function(e){e.conditionalFormats&&e.conditionalFormats.getRules().forEach((function(e){e.S$a()}))}))}}),function(e){e[e.equalsTo=0]="equalsTo",e[e.notEqualsTo=1]="notEqualsTo",e[e.greaterThan=2]="greaterThan",e[e.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",e[e.lessThan=4]="lessThan",e[e.lessThanOrEqualsTo=5]="lessThanOrEqualsTo"}(se=t.GeneralComparisonOperators||(t.GeneralComparisonOperators={})),le=[9,10,13,14,11,12],function(e){e[e.or=0]="or",e[e.and=1]="and"}(ue=t.LogicalOperators||(t.LogicalOperators={})),function(e){e[e.equalsTo=0]="equalsTo",e[e.notEqualsTo=1]="notEqualsTo",e[e.greaterThan=2]="greaterThan",e[e.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",e[e.lessThan=4]="lessThan",e[e.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",e[e.between=6]="between",e[e.notBetween=7]="notBetween"}(ce=t.ComparisonOperators||(t.ComparisonOperators={})),function(e){e[e.contains=0]="contains",e[e.doesNotContain=1]="doesNotContain",e[e.beginsWith=2]="beginsWith",e[e.endsWith=3]="endsWith"}(t.TextComparisonOperators||(t.TextComparisonOperators={})),function(e){e[e.equalsTo=0]="equalsTo",e[e.notEqualsTo=1]="notEqualsTo",e[e.beginsWith=2]="beginsWith",e[e.doesNotBeginWith=3]="doesNotBeginWith",e[e.endsWith=4]="endsWith",e[e.doesNotEndWith=5]="doesNotEndWith",e[e.contains=6]="contains",e[e.doesNotContain=7]="doesNotContain"}(fe=t.TextCompareType||(t.TextCompareType={})),function(e){e[e.backgroundColor=0]="backgroundColor",e[e.foregroundColor=1]="foregroundColor"}(he=t.ColorCompareType||(t.ColorCompareType={})),function(e){e[e.empty=0]="empty",e[e.nonEmpty=1]="nonEmpty",e[e.error=2]="error",e[e.nonError=3]="nonError",e[e.formula=4]="formula"}(pe=t.CustomValueType||(t.CustomValueType={})),function(e){e[e.equalsTo=0]="equalsTo",e[e.notEqualsTo=1]="notEqualsTo",e[e.before=2]="before",e[e.beforeEqualsTo=3]="beforeEqualsTo",e[e.after=4]="after",e[e.afterEqualsTo=5]="afterEqualsTo"}(de=t.DateCompareType||(t.DateCompareType={})),function(e){e[e.dateOccurring=0]="dateOccurring",e[e.yearOccurring=1]="yearOccurring",e[e.quarterOccurring=2]="quarterOccurring",e[e.monthOccurring=3]="monthOccurring",e[e.weekOccurring=4]="weekOccurring",e[e.dayOccurring=5]="dayOccurring",e[e.yearTodate=6]="yearTodate"}(ge=t.DateExConditionExpectType||(t.DateExConditionExpectType={})),function(e){e[e.top=0]="top",e[e.bottom=1]="bottom"}(t.Top10ConditionType||(t.Top10ConditionType={})),function(e){e[e.today=0]="today",e[e.yesterday=1]="yesterday",e[e.tomorrow=2]="tomorrow",e[e.last7Days=3]="last7Days",e[e.thisMonth=4]="thisMonth",e[e.lastMonth=5]="lastMonth",e[e.nextMonth=6]="nextMonth",e[e.thisWeek=7]="thisWeek",e[e.lastWeek=8]="lastWeek",e[e.nextWeek=9]="nextWeek",e[e.nextQuarter=10]="nextQuarter",e[e.thisQuarter=11]="thisQuarter",e[e.lastQuarter=12]="lastQuarter",e[e.nextYear=13]="nextYear",e[e.thisYear=14]="thisYear",e[e.lastYear=15]="lastYear"}(me=t.DateOccurringType||(t.DateOccurringType={})),function(e){e[e.quarter1=0]="quarter1",e[e.quarter2=1]="quarter2",e[e.quarter3=2]="quarter3",e[e.quarter4=3]="quarter4"}(ye=t.QuarterType||(t.QuarterType={})),function(e){e[e.above=0]="above",e[e.below=1]="below",e[e.equalOrAbove=2]="equalOrAbove",e[e.equalOrBelow=3]="equalOrBelow",e[e.above1StdDev=4]="above1StdDev",e[e.below1StdDev=5]="below1StdDev",e[e.above2StdDev=6]="above2StdDev",e[e.below2StdDev=7]="below2StdDev",e[e.above3StdDev=8]="above3StdDev",e[e.below3StdDev=9]="below3StdDev"}(ve=t.AverageConditionType||(t.AverageConditionType={})),function(e){e[e.number=0]="number",e[e.lowestValue=1]="lowestValue",e[e.highestValue=2]="highestValue",e[e.percent=3]="percent",e[e.percentile=4]="percentile",e[e.automin=5]="automin",e[e.formula=6]="formula",e[e.automax=7]="automax"}(be=t.ScaleValueType||(t.ScaleValueType={})),function(e){e[e.leftToRight=0]="leftToRight",e[e.rightToLeft=1]="rightToLeft"}(t.BarDirection||(t.BarDirection={})),function(e){e[e.automatic=0]="automatic",e[e.cellMidPoint=1]="cellMidPoint",e[e.none=2]="none"}(t.DataBarAxisPosition||(t.DataBarAxisPosition={})),function(e){e[e.threeArrowsColored=0]="threeArrowsColored",e[e.threeArrowsGray=1]="threeArrowsGray",e[e.threeTriangles=2]="threeTriangles",e[e.threeStars=3]="threeStars",e[e.threeFlags=4]="threeFlags",e[e.threeTrafficLightsUnrimmed=5]="threeTrafficLightsUnrimmed",e[e.threeTrafficLightsRimmed=6]="threeTrafficLightsRimmed",e[e.threeSigns=7]="threeSigns",e[e.threeSymbolsCircled=8]="threeSymbolsCircled",e[e.threeSymbolsUncircled=9]="threeSymbolsUncircled",e[e.fourArrowsColored=10]="fourArrowsColored",e[e.fourArrowsGray=11]="fourArrowsGray",e[e.fourRedToBlack=12]="fourRedToBlack",e[e.fourRatings=13]="fourRatings",e[e.fourTrafficLights=14]="fourTrafficLights",e[e.fiveArrowsColored=15]="fiveArrowsColored",e[e.fiveArrowsGray=16]="fiveArrowsGray",e[e.fiveRatings=17]="fiveRatings",e[e.fiveQuarters=18]="fiveQuarters",e[e.fiveBoxes=19]="fiveBoxes",e[e.noIcons=20]="noIcons"}(Ce=t.IconSetType||(t.IconSetType={})),function(e){e[e.number=1]="number",e[e.percent=4]="percent",e[e.formula=7]="formula",e[e.percentile=5]="percentile"}(we=t.IconValueType||(t.IconValueType={})),function(e){e[e.relationCondition=0]="relationCondition",e[e.numberCondition=1]="numberCondition",e[e.textCondition=2]="textCondition",e[e.colorCondition=3]="colorCondition",e[e.formulaCondition=4]="formulaCondition",e[e.dateCondition=5]="dateCondition",e[e.dateExCondition=6]="dateExCondition",e[e.textLengthCondition=7]="textLengthCondition",e[e.top10Condition=8]="top10Condition",e[e.uniqueCondition=9]="uniqueCondition",e[e.averageCondition=10]="averageCondition",e[e.cellValueCondition=11]="cellValueCondition",e[e.areaCondition=12]="areaCondition",e[e.timeCondition=13]="timeCondition"}(xe=t.ConditionType||(t.ConditionType={})),function(e){e[e.conditionRuleBase=0]="conditionRuleBase",e[e.cellValueRule=1]="cellValueRule",e[e.specificTextRule=2]="specificTextRule",e[e.formulaRule=3]="formulaRule",e[e.dateOccurringRule=4]="dateOccurringRule",e[e.top10Rule=5]="top10Rule",e[e.uniqueRule=6]="uniqueRule",e[e.duplicateRule=7]="duplicateRule",e[e.averageRule=8]="averageRule",e[e.twoScaleRule=10]="twoScaleRule",e[e.threeScaleRule=11]="threeScaleRule",e[e.dataBarRule=12]="dataBarRule",e[e.iconSetRule=13]="iconSetRule"}(Ae=t.RuleType||(t.RuleType={})),Me=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0)},Se=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999)},Te=function(e,t){e.setDate(t)},Ne=function(e){return e.getDate()},Ie=function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},Re=function(e,t){return t>Se(e)},ke=function(e,t){return t<Me(e)},Ee=function(e,t){return e.getHours()===t.getHours()&&e.getMinutes()===t.getMinutes()&&e.getSeconds()===t.getSeconds()&&e.getMilliseconds()===t.getMilliseconds()},De=function(e,t){var n=new Date(1899,11,30,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return new Date(1899,11,30,t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())>n},je=function(e,t){return!De(e,t)&&!Ee(e,t)},t.$V=function(e,t,n,o,r,i,a,s,l){return new Oe(e,{compareType:t,expected:n,formula:o,customValueType:r,type:i,ranges:a,item1:s,item2:l})},t.Cxb=new H,_e=["conType","compareType","item1","item2","ignoreBlank","expected","formula","treatNullValueAsZero","integerValue","forceValue2Text","useWildCards","ignoreCase","customValueType","expectTypeId","type","ranges","isPercent","regex"],Oe=function(){function e(e,t){var n,o;t||(t={}),n=t.formula,(o=this).offsetRow=0,o.offsetCol=0,o.conType("string"==typeof e?xe[e]:e),E(t.compareType)||o.RV(t.compareType),E(t.expected)||o.expected(t.expected),E(n)||o.formula("string"==typeof n?N(f.trim(n),"="):n),E(t.item1)||o.item1(t.item1),E(t.item2)||o.item2(t.item2),E(t.customValueType)||o.customValueType(t.customValueType),E(t.type)||o.type(t.type),o.ranges(t.ranges),o.Lf=p,o.TV=p}return e.prototype.context=function(e){if(1===arguments.length){this.xc=e;var t=this.item1(),n=this.item2();t&&t.context&&t.context(e),n&&n.context&&n.context(e)}return this.xc},e.prototype.j_a=function(e){var t=this,n=t.item1(),o=t.item2();e?t.q$a=!0:t.p$a=!0,n&&n.j_a(e),o&&o.j_a(e)},e.prototype.k_a=function(){var e=this,t=e.item1(),n=e.item2();delete e.q$a,delete e.p$a,t&&t.k_a(),n&&n.k_a()},e.prototype.initExpression=function(e,t,n){var o,r,i,a,s,l=this.item1(),u=this.item2();l&&l.initExpression&&l.initExpression(),u&&u.initExpression&&u.initExpression(),e=e||this.xc,o=this.Yw,e&&o&&!this.Lf&&(this.ranges()?(t=(r=F(this.ranges())).r,n=r.c):(t=t||0,n=n||0),i=e.getCalcService(),a=e.yj(),i&&a&&(s=!1,this.q$a&&(s=!this.p$a),this.Lf=i.parse(a,o,t,n,!1,!0,s)))},e.prototype.expression=function(e,t,n,o){var r,i,a;return 1===arguments.length?(this.Lf=e,t=t||this.xc,e?t&&(this.ranges()?(n=(r=F(this.ranges())).r,o=r.c):(n=n||0,o=o||0),i=t.getCalcService(),a=t.yj(),i&&a&&(this.Yw=i.unparse(a,e,n,o))):this.Yw=e,this.Lf):(this.Lf||this.initExpression(t,n,o),this.Lf)},e.prototype.getFormulaString=function(e,t,n,o){var r,i,a;return e=e||this.xc,r=this.Lf,i=this.Yw,e&&i?(r||(this.initExpression(e,t,n),r=this.Lf),a=F(this.ranges()),t=E(t)?a.r:t,n=E(n)?a.c:n,e.getCalcService().unparse(e.yj(),r,t,n,d,!!o)):i},e.prototype.formula=function(e,t,n){if("string"!=typeof e){var o=this.item1(),r=this.item2();return 0===n&&o&&o.formula?o.formula(e,t,n):1===n&&r&&r.formula?r.formula(e,t,n):this.getFormulaString(d,e,t)}this.Yw=e,this.Lf=p},e.prototype.adjustOffset=function(e,t){var n=this,o=n.item1();o&&o.adjustOffset&&o.adjustOffset(e,t),(o=n.item2())&&o.adjustOffset&&o.adjustOffset(e,t),n.offsetRow=e,n.offsetCol=t},e.prototype.relationConditionEvaluate=function(e,t,n,o,r){var i,a,s=this;function l(o,r){if(e&&o&&3===o.conType()){var i=e.getActualStyle(t,n,3,!0);i&&(0===o.RV()?r=i.backColor:1===o.RV()&&(r=i.foreColor))}return r}function u(e,t){if(e)return e.ignoreBlank(s.ignoreBlank()),arguments.length<5?l(e,o):t}function c(o,r){return!E(o)&&o.evaluate(e,t,n,r)}return i=u(s.item1(),o),a=u(s.item2(),r),(c(s.item1(),i)?1:0)+(c(s.item2(),a)?1:0)>s.RV()},e.prototype.cellValueConditionEvaluate=function(e,t,n,o){var r=this.getExpected(e,t,n);return!(r!==p||!e||!e.lRa)||this.cellValueConditionCheckCondition(r,o)},e.prototype.cellValueConditionCheckCondition=function(e,t){var n,o,r,i,a=0,s=!1,l=this.RV();if(E(t)&&E(e))switch(l){case se.equalsTo:case se.greaterThanOrEqualsTo:case se.lessThanOrEqualsTo:return!0;case se.notEqualsTo:case se.greaterThan:case se.lessThan:default:return!1}return"boolean"==typeof e||"boolean"==typeof t?nt(l,t,e):(n={},E(t)?this.treatNullValueAsZero()?s=!0:a=t:"boolean"!=typeof t&&S(t,n)&&(a=n.value,s=!isNaN(a)),o=0,r=!1,S(e,n)&&(o=n.value,r=!0),i=le[l],s?r?nt(l,a,o):Y(i,t,e):"string"==typeof t?r?Y(i,t,o):"string"==typeof e?Y(i,t,e):1===l:!!E(t)&&l===se.notEqualsTo)},e.prototype.numberConditionEvaluate=function(e,t,n,o){var r=this.numberConditionGetExpected(e,t,n);return!(r!==p||!e||!e.lRa)||(this.integerValue()&&(r=isNaN(r)?p:r>0?C(r):w(r)),this.numberConditionCheckCondition(r,o))},e.prototype.numberConditionCheckCondition=function(e,t){var n,o,r=this;if((E(t)||""===t)&&r.ignoreBlank())return!0;if(isNaN(t))return!1;if(E(e)){if(r.ignoreBlank())return!0;e=0}try{n=parseFloat(t)}catch(e){return!1}return!(r.integerValue()&&(o=n-C(n)==0,!o))&&nt(r.RV(),n,e)},e.prototype.numberConditionGetExpected=function(e,t,n){var o,r=this;return r.Yw&&r.Yw.length>0?(o=e.Cf())?o.evaluate(e.yj(),r.expression(p,e),t,n):r.expected():r.expected()},e.prototype.textConditionEvaluate=function(e,t,n,o){var r,i,a,s=this,l=s.compareType(),u=s.ignoreCase();function c(e,t){return s.testTextByCondition(t,e,"^","$",(function(){return u?e.toLowerCase()===t.toLowerCase():e===t}))}function f(e,t){return s.testTextByCondition(t,e,"^","",(function(){return I(t,e,u)}))}function h(e,t){return s.testTextByCondition(t,e,"","$",(function(){return R(t,e,u)}))}function g(e,t){return s.testTextByCondition(t,e,"","",(function(){return k(t,e===d||e===p?"":e,u)}))}if(!s.forceValue2Text()&&j(o,Date))return l!==fe.beginsWith&&l!==fe.endsWith&&l!==fe.contains&&(l===fe.doesNotBeginWith||l===fe.doesNotEndWith||l===fe.doesNotContain);if(r=E(o)?"":""+o,s.ignoreBlank()&&""===r)return!0;if(i=this.getExpected(e,t,n),a=E(i)?"":""+i,s.hasWildcard(a)&&"number"==typeof o)return l===fe.doesNotBeginWith||l===fe.doesNotContain||l===fe.doesNotEndWith||l===fe.notEqualsTo;switch(l){case fe.equalsTo:return c(a,r);case fe.notEqualsTo:return!c(a,r);case fe.beginsWith:return f(a,r);case fe.doesNotBeginWith:return!f(a,r);case fe.endsWith:return h(a,r);case fe.doesNotEndWith:return!h(a,r);case fe.contains:return g(a,r);case fe.doesNotContain:return!g(a,r);default:return!1}},e.prototype.hasWildcard=function(e){return e.indexOf("*")>-1||e.indexOf("?")>-1},e.prototype.testTextByCondition=function(e,t,n,o,r){var i;return this.useWildCards()?this.regex()?D.qb(this.regex()).test(e):(i=D.ub(t))?(i=n+i+o,this.ignoreCase()?D.sb(i).test(e):D.qb(i).test(e)):r():r()},e.prototype.colorConditionEvaluate=function(e,t,n,r){var i,a,s,l;function u(e){return E(e)||""===e?p:L.ec(e)}if(a=u((i=this).expected()),E(a)||""===a){if(i.ignoreBlank()||E(a)&&E(r))return!0}else if(s=u(r),(E(s)||""===s)&&e&&e.getDefaultStyle&&(l=e.getDefaultStyle(),i.RV()===he.backgroundColor?s=l.backColor:i.RV()===he.foregroundColor&&(s=l.foreColor)),!E(s)&&""!==s)return o.Common.pc.Pka(s,a);return!1},e.prototype.formulaConditionEvaluate=function(e,t,n,o){var r,i,a,s;if(!P)return!1;if((r=this).customValueType()===pe.formula)return i=r.getExpected(e,t,n),!(!r.ignoreBlank()||!E(i)&&""!==i)||(a={},!!x.Uh(i,a)&&a.value);switch(s=x.vf,r.customValueType()){case pe.empty:return E(o)||""===o;case pe.nonEmpty:return!E(o)&&""!==o;case pe.error:return s(o);case pe.nonError:return!s(o);default:return!1}},e.prototype.formulaConditionGetExpected=function(e,t,n){var o,r,a,l,u,c,f,h,p,g,m=this;if(m.Yw&&m.Yw.length>0){if(!(o=e.Cf()))return m.expected();if(r=o._evaluateParsedFormula(e.yj(),m.expression(d,e),s._createCellIdentity(t,n),!0),a=void 0,l=void 0,u=void 0,c=void 0,f=void 0,x._isReference(r)){for(a=r.getRowCount(0),l=r.getColumnCount(0),u=[],c=0;c<a;c++)for(u[c]=[],f=0;f<l;f++)u[c][f]=r.getValue(0,c,f);r=u}else if(x.Ca(r)){for(a=r.getRowCount(),l=r.getColumnCount(),u=[],c=0;c<a;c++)for(u[c]=[],f=0;f<l;f++)u[c][f]=r.getValue(c,f);r=u}return j(r,Array)?(a=J(r),l=J(r[0]),1===a&&1===l?r[0][0]:(p=t-(h=function(e,t,n){var o,r;for(o=0;o<e.length;o++)if((r=e[o]).contains(t,n))return r}(m.ranges(),t,n)).row,g=n-h.col,p<a&&g<l?r[p][g]:i.Errors.NotAvailable)):r}return m.expected()},e.prototype.dateOrTimeEvaluate=function(e,t,n,o,r,i,a){var s,l,u=this;if((E(o)||""===o)&&u.ignoreBlank())return!0;if(!j(o,Date))return u.RV()===de.notEqualsTo;if(s=p,l=this.getExpected(e,t,n),j(l,Date)?s=l:"string"==typeof l?s=W.Qa(l):"number"==typeof l&&(s=W.Xb(l)),E(s))return!!u.ignoreBlank();switch(u.RV()){case de.equalsTo:return r(s,o);case de.notEqualsTo:return!r(s,o);case de.after:return a(s,o);case de.afterEqualsTo:return a(s,o)||r(s,o);case de.before:return i(s,o);case de.beforeEqualsTo:return i(s,o)||r(s,o);default:return!1}},e.prototype.dateConditionEvaluate=function(e,t,n,o){return this.dateOrTimeEvaluate(e,t,n,o,Ie,ke,Re)},e.prototype.timeConditionEvaluate=function(e,t,n,o){return this.dateOrTimeEvaluate(e,t,n,o,Ee,je,De)},e.prototype.dateExConditionEvaluate=function(e,t,n,o){var r=this.A4(e,t,n);return!E(r)&&this.dateExConditionCheckCondition(r,o)},e.prototype.getExConditionDateScope=function(e){var t,n,o,r,i,a,s,l,u,c,f,h,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O=p,F=p,P=new Date,H=new Date(P.getFullYear(),P.getMonth(),P.getDate(),P.getHours(),P.getMinutes(),P.getSeconds(),P.getMilliseconds());switch(e){case me.last7Days:Te(H,Ne(H)-6),O=Me(H),F=Se(P);break;case me.yesterday:Te(H,Ne(H)-1),O=Me(H),F=Se(H);break;case me.today:O=Me(P),F=Se(P);break;case me.tomorrow:Te(H,Ne(H)+1),O=Me(H),F=Se(H);break;case me.lastWeek:Te(t=P,Ne(P)-P.getDay()-7),(n=H).setDate(Ne(H)-H.getDay()-1),O=Me(t),F=Se(n);break;case me.thisWeek:Te(o=P,Ne(P)-P.getDay()),Te(r=H,Ne(H)-H.getDay()+6),O=Me(o),F=Se(r);break;case me.nextWeek:Te(i=P,Ne(P)-P.getDay()+7),Te(a=H,Ne(H)-H.getDay()+13),O=Me(i),F=Se(a);break;case me.lastMonth:Te(s=P,1),s.setMonth(P.getMonth()-1),Te(l=H,0),O=Me(s),F=Se(l);break;case me.thisMonth:Te(u=P,1),Te(c=H,1),c.setMonth(H.getMonth()+1),Te(c,0),O=Me(u),F=Se(c);break;case me.nextMonth:Te(f=P,1),f.setMonth(P.getMonth()+1),Te(h=H,1),h.setMonth(H.getMonth()+2),Te(h,0),O=Me(f),F=Se(h);break;case me.nextQuarter:m=(g=(d=P).getMonth())%3,d.setDate(1),d.setMonth(g-m+3),void 0,(y=H).setDate(1),y.setMonth(g-m+3+2),v=2===y.getMonth()||11===y.getMonth()?31:30,y.setDate(v),O=Me(d),F=Se(y);break;case me.thisQuarter:w=(C=(b=P).getMonth())%3,b.setDate(1),b.setMonth(C-w),void 0,(x=H).setDate(1),x.setMonth(C-w+2),A=2===x.getMonth()||11===x.getMonth()?31:30,x.setDate(A),O=Me(b),F=Se(x);break;case me.lastQuarter:T=(S=(M=P).getMonth())%3,M.setDate(1),M.setMonth(S-T-3),void 0,(N=H).setDate(1),N.setMonth(S-T-3+2),I=2===N.getMonth()||11===N.getMonth()?31:30,N.setDate(I),O=Me(M),F=Se(N);break;case me.nextYear:(R=P).setDate(1),R.setFullYear(R.getFullYear()+1),R.setMonth(0),(k=H).setFullYear(k.getFullYear()+1),k.setMonth(11),k.setDate(31),O=Me(R),F=Se(k);break;case me.thisYear:(E=P).setDate(1),E.setMonth(0),(D=H).setMonth(11),D.setDate(31),O=Me(E),F=Se(D);break;case me.lastYear:(j=P).setFullYear(j.getFullYear()-1),j.setDate(1),j.setMonth(0),(_=H).setFullYear(_.getFullYear()-1),_.setMonth(11),_.setDate(31),O=Me(j),F=Se(_)}return{from:O,to:F}},e.prototype.dateExConditionCheckCondition=function(e,n){var o,r,i,a,s,l,u,c,f,h,d;if(r=n,(o=this).ignoreBlank()&&(E(r)||""===r))return!0;try{r=x.Wh(r)}catch(e){return!1}if((a=o.expectTypeId())===ge.dateOccurring){if(l=(s=this.getExConditionDateScope(e)).from,u=s.to,!E(l)&&!E(u))return c=t.$V(xe.dateCondition,de.afterEqualsTo,l,p),f=t.$V(xe.dateCondition,de.beforeEqualsTo,u,p),t.$V(xe.relationCondition,ue.and,p,p,p,p,p,c,f).evaluate(p,0,0,r)}else if(i=o.A4(p,0,0),!E(i)){if(a===ge.yearOccurring)return i===r.getFullYear();if(a===ge.quarterOccurring)return function(e,t){switch(e){case ye.quarter1:return t.getMonth()>=0&&t.getMonth()<=2;case ye.quarter2:return t.getMonth()>=3&&t.getMonth()<=5;case ye.quarter3:return t.getMonth()>=6&&t.getMonth()<=8;case ye.quarter4:return t.getMonth()>=9&&t.getMonth()<=11;default:return!1}}(i,r);if(a===ge.monthOccurring)return i===r.getMonth();if(a===ge.weekOccurring)return i===r.getDay();if(a===ge.dayOccurring)return i===Ne(r);if(a===ge.yearTodate)return h=new Date,d=new Date,h.setMonth(0,1),h.setHours(0,0,0,0),d.setHours(23,59,59,59),h<=r&&r<=d}return!1},e.prototype.textLengthConditionEvaluate=function(e,t,n,o){var r,i;return E(o)||""===o?this.ignoreBlank():(r=E(o)?0:(""+o).length,"number"==typeof(i=this.A4(e,t,n))&&nt(this.RV(),r,i))},e.prototype.top10ConditionEvaluate=function(e,t,n,o){var r,i,a,s=this;if(E(o)||""===o)return s.ignoreBlank();if(r=s.A4(e,t,n),!E(r)&&(i=void 0,s.k$a?(E(s.mxb)&&(s.mxb=s.getTopValues(e,r,s.ranges())),i=s.mxb):i=s.getTopValues(e,r,s.ranges()),i)){a=0;try{a=s.Pa(o)}catch(e){return!1}if(U.Bb(i,a))return!0}return!1},e.prototype.A4=function(e,t,n){var o=this.getExpected(e,t,n);return o=parseInt(o,10),isNaN(o)||!isFinite(o)?p:o},e.prototype.adjustRange=function(e,t){return V(e.row,e.col,Math.min(et(e),t.getRowCount()),Math.min(tt(e),t.getColumnCount()))},e.prototype.getTopValues=function(e,t,n){var o,r,i,a,s,l,u,c,f,h=0===this.type()?1:-1,p=[];if(!n)return p;for(o=this.UV(e,n),r=J(o),u=0;u<r;u++)for(i=this.adjustRange(o[u],e),c=0;c<et(i);c++)for(a=c+i.row,f=0;f<tt(i);f++)s=f+i.col,l=this.Pa(e.getValue(a,s)),E(l)||p.push(l);return p.sort((function(e,t){return(t-e)*h})),J(p)>t&&(p=p.slice(0,t)),p},e.prototype.Pa=function(e){return("number"==typeof e||j(e,Date))&&P?M(e):p},e.prototype.uniqueConditionEvaluate=function(e,t,n,o){var r,i,a,s,l=this,u=o;return E(u)||""===u?l.ignoreBlank():(P&&A(u)&&(u=M(u)),r=this.getExpected(e,t,n),i={},x.Uh(r,i),!E(a=i.value)&&(s=l.duplicatedArrayCached||l.getDuplicated(e,l.ranges()),!E(s)&&U.Bb(s,u)?!0===a:!0!==a))},e.prototype.getDuplicated=function(e,t){var n,o,r,i,a,s,l,u,c,f,h,p=[],d={},g=this.UV(e,t);if(g)for(n=J(g),o=0;o<n;o++)for(r=g[o],i=et(r=this.adjustRange(r,e)),a=tt(r),s=0;s<i;s++)for(l=s+r.row,u=0;u<a;u++)c=u+r.col,f=e.getValue(l,c,3),!E(f)&&P&&A(f)&&(f=M(f)),(h=d[f])?1===h&&p.push(f):d[f]=1;return p},e.prototype.VV=function(e,t){var n,o=e.length;for(n=0;n<o;n++)if(e[n].key===t)return!0;return!1},e.prototype.averageConditionEvaluate=function(e,t,n,o){var r,i,a,s,l,u,c,f;if(!P)return!1;if((r=this).ignoreBlank()&&(E(o)||""===o))return!0;if(r.WV(),r.k$a?(E(r.mxb)&&(r.mxb=r.getExpected(e,t,n)),i=r.mxb):i=r.getExpected(e,t,n),s=S(i,a={})?a.value:NaN,l=p,u=r.TV?r.XV(e,r.TV,t,n):p,E(u)||(l=S(u,a={})?a.value:NaN),A(o)&&(c=M(o),!isNaN(s)))switch(f=isNaN(l),r.type()){case ve.above:return c>s;case ve.below:return c<s;case ve.equalOrAbove:return c>=s;case ve.equalOrBelow:return c<=s;case ve.above1StdDev:return!f&&c>s+l;case ve.below1StdDev:return!f&&c<s-l;case ve.above2StdDev:return!f&&c>s+2*l;case ve.below2StdDev:return!f&&c<s-2*l;case ve.above3StdDev:return!f&&c>s+3*l;case ve.below3StdDev:return!f&&c<s-3*l;default:return!1}return!1},e.prototype.WV=function(){var e=this;e.ranges()&&(e.Lf=e.YV("AVERAGE",e.ranges()),e.type()>=4&&e.type()<=9&&(e.TV=e.YV("STDEV",e.ranges())))},e.prototype.YV=function(e,t){var n,o,r,a;if(!P)return p;if(n=Q.findGlobalFunction(e)){for(o=[],r=J(t),a=0;a<r;a++)o[a]=te(t[a]);return i.Jh(n,o)}return p},e.prototype.averageConditionGetExpected=function(e,t,n){var o=e.Cf();return o?o._evaluateParsedFormula(e.yj(),this.expression(d,e),s._createCellIdentity(t,n),!1):p},e.prototype.nxb=function(){var e=this.conType();e!==xe.averageCondition&&e!==xe.top10Condition||(this.k$a=!0)},e.prototype.oxb=function(){this.k$a=!1,this.mxb=d},e.prototype.XV=function(e,t,n,o){var r=e.Cf();return r?r._evaluateParsedFormula(e.yj(),t,s._createCellIdentity(n,o),!1):p},e.prototype.ZV=function(e,t){var n,o;for(o=0;o<J(t);o++)n=t[o],j(n,Array)&&J(n)>0?J(t)>1?e.push(n[0]):e.push.apply(e,n):e.push(n)},e.prototype.getValidList=function(e,t,n){var o,r,i=[],a=this.getValidListImp(e,t,n);for(o=0,r=J(a);o<r;o++)i.push(a[o].value);return i},e.prototype.CIc=function(){return this.Yw&&this.Yw.length>0},e.prototype.getValidListImp=function(e,t,n){var o,r,i,a,s,l,u=this,c=[];if(u.Yw&&u.Yw.length>0)o=u.getExpected(e,t,n),j(o,Array)?u.ZV(c,o):c.push(o);else if(u.expected()&&u.expected().length>0&&(r=u.expected().replace(/\\,/g,String.fromCharCode(206)).split(",")))for(i=0;i<J(r);i++)a=r[i],E(a)||(s=RegExp(String.fromCharCode(206),"g"),""!==(l=f.trim(a).replace(s,","))&&c.push({text:l,value:l}));return c},e.prototype.areaConditionEvaluate=function(e,t,n,o){var r,i,a,s,l;function u(e,t,n){return j(e,Date)&&j(t,Date)?e.valueOf()===t.valueOf():n||"string"!=typeof e||"string"!=typeof t?e===t:e.toLowerCase()===t.toLowerCase()}if(r=this,E(o)||""===o)return!0===r.ignoreBlank();for(i=r.getValidList(e,t,n),a=0;a<J(i);a++){if(s=i[a],E(s)&&E(o))return!0;if(r.Yw){if(u(s,o,!1))return!0}else if(l=e.getActualStyle(t,n,3,!0),u(_.ul(l,s,!0),o,!0))return!0}return!1},e.prototype.areaConditionGetExpected=function(e,t,n){var o,r,i,a,l,u,c,f,h,p,g,m,y,b=this,C=[];if(b.Yw){if(o=void 0,r=void 0,i=void 0,a=void 0,l=void 0,u=void 0,!(c=e.Cf()))return C;if(f=c._evaluateParsedFormula(e.yj(),b.expression(d,e),s._createCellIdentity(t,n),!0),x._isReference(f))for(o=f.getRowCount(0),r=f.getColumnCount(0),h=f.getRow(0),p=f.getColumn(0),(g=f._source&&f._source.kj)&&(m=g.getRowCount(),y=g.getColumnCount(),o=o>m?v(m-h,0):o,r=r>y?v(y-p,0):y),i=0;i<o;i++)for(C[i]=[],a=0;a<r;a++)l=f.getValue(0,i,a),u=g?g.getText(h+i,p+a):l,C[i][a]={value:l,text:u};else if(x.Ca(f))for(o=f.getRowCount(),r=f.getColumnCount(),i=0;i<o;i++)for(C[i]=[],a=0;a<r;a++)l=f.getValue(i,a),C[i][a]={value:l,text:l}}else C.push({value:b.expected(),text:b.expected()});return C},e.prototype.reset=function(){var e=this;switch(e.ignoreBlank(!1),e.RV(1),e.item1(p),e.item2(p),e.value1=p,e.value2=p,e.expected(p),e.RV(0),e.integerValue(!1),e.operator=0,e.text="",e.RV(0),e.useWildCards(!0),e.ignoreCase(!1),e.forceValue2Text(!1),e.customValueType(0),e.Lf=p,e.type(0),this.expectTypeId(0),e.ranges(p),e.isPercent(!1),e.regex(p),e.conType()){case xe.relationCondition:e.ignoreBlank(!1),e.RV(1);break;case xe.numberCondition:e.RV(0),e.integerValue(!1);break;case xe.textCondition:e.RV(0),e.useWildCards(!0),e.forceValue2Text(!1);break;case xe.colorCondition:e.RV(0);break;case xe.formulaCondition:e.customValueType(0),e.TV=p;break;case xe.dateCondition:case xe.timeCondition:e.RV(0);break;case xe.dateExCondition:e.expectTypeId(0);break;case xe.textLengthCondition:e.RV(0);break;case xe.top10Condition:case xe.averageCondition:e.type(0);break;case xe.cellValueCondition:e.operator=6;break;case xe.areaCondition:}},e.prototype.evaluate=function(e,t,n,o){var r=this.conType();return!E(r)&&this[xe[r]+"Evaluate"](e,t,n,o)},e.prototype.getExpectedNormal=function(e,t,n,o,r,i){var a,l=this,u=l.Yw,c=l.expected();return u?(a=e.Cf())?a._evaluateParsedFormula(e.yj(),l.expression(d,e),s._createCellIdentity(t,n),!1,i):c:c},e.prototype.getExpected=function(e,t,n){var o=this;switch(o.conType()){case 2:return o.getExpectedNormal(e,t,n,t-o.offsetRow,n-o.offsetCol,!1);case 5:case 6:case 7:case 9:case 11:case 13:return o.getExpectedNormal(e,t,n,t-o.offsetRow,n-o.offsetCol,!1);case 8:return o.getExpectedNormal(e,t,n,t,n);case 0:return p;case 1:return o.numberConditionGetExpected(e,t,n);case 3:return p;case 4:return o.formulaConditionGetExpected(e,t,n);case 10:return o.averageConditionGetExpected(e,t,n);case 12:return o.areaConditionGetExpected(e,t,n);default:return p}},e.prototype.UV=function(e,t){var n,o,r,i=[];for(n=0,o=J(t);n<o;n++)r=e.Tq(t[n]),i.push(r);return i},e.prototype.getExpressions=function(){var e=[],t=this;return 0===t.conType()?(t.item1()&&t.item1().getExpressions&&(e=t.item1().getExpressions()),t.item2()&&t.item2().getExpressions&&(e=e.concat(t.item2().getExpressions())),e):(t.Lf||t.initExpression(),t.Lf?[t.Lf]:[])},e.prototype.setExpressions=function(e,t){var n,o=this;return t&&t.push({type:"condition",condition:this,expressions:o.getExpressions()}),0===o.conType()?(o.item1()&&o.item1().setExpressions&&(n=o.item1().getExpressions().length,o.item1().setExpressions(e.slice(0,n))),void(o.item2()&&o.item2().setExpressions&&o.item2().setExpressions(e.slice(n)))):void o.expression(e[0])},e.prototype.toJSON=function(e){return oe.call(this,e,_e)},e.prototype.fromJSON=function(e,t,n){var o;e&&(re.call(o=this,t,_e,e,n),t&&t.Wu&&t.Wu.useR1C1&&t instanceof l.Worksheet&&(o.context(t),O(o)),o.j_a(!0),o.initExpression(),o.k_a())},e.fromSource=function(e){return t.$V(12,p,e,p)},e.fromFormula=function(e){return t.$V(12,p,"",e)},e.fromDay=function(e){var n=t.$V(6,p,e);return n.expectTypeId(5),n},e.fromMonth=function(e){var n=t.$V(6,p,e);return n.expectTypeId(3),n},e.fromQuarter=function(e){var n=t.$V(6,p,e);return n.expectTypeId(2),n},e.fromWeek=function(e){var n=t.$V(6,p,e);return n.expectTypeId(4),n},e.fromYear=function(e){var n=t.$V(6,p,e);return n.expectTypeId(1),n},e}(),t.Condition=Oe,Oe.prototype.conType=ne("conType",p),Oe.prototype.ranges=ne("ranges",p,(function(e){var t=this.item1(),n=this.item2();t&&t.ranges&&t.ranges(e),n&&n.ranges&&n.ranges(e)})),Oe.prototype.ignoreBlank=ne("ignoreBlank",!1),Oe.prototype.compareType=ne("compareType",d),Oe.prototype.RV=Oe.prototype.compareType,Oe.prototype.expected=ne("expected",d),Oe.prototype.item1=ne("item1",p),Oe.prototype.item2=ne("item2",p),Oe.prototype.treatNullValueAsZero=ne("treatNullValueAsZero",!1),Oe.prototype.integerValue=ne("integerValue",!1),Oe.prototype.forceValue2Text=ne("forceValue2Text",!1),Oe.prototype.useWildCards=ne("useWildCards",!0),Oe.prototype.regex=ne("regex",p),Oe.prototype.ignoreCase=ne("ignoreCase",!1),Oe.prototype.customValueType=ne("customValueType",d),Oe.prototype.expectTypeId=ne("expectTypeId",0),Oe.prototype.type=ne("type",p),Oe.prototype.isPercent=ne("isPercent",!1),Fe=function(){function e(e,t,n){var o=this;o.xyb=!0,o.ruleType(e),o.style(t),o.ranges(n)}return e.prototype.stopIfTrue=function(e){},e.prototype.evaluate=function(e,n,o,r){var i,a,s=this;return s.contains(n,o)?(s.initCondition(),i={baseRow:0,baseCol:0},s.getBaseCoordinate(i),s.condition().adjustOffset(n-i.baseRow,o-i.baseCol),a=p,s.condition().evaluate(e,n,o,r)&&(a=s.getExpected()||t.Cxb),s.condition().adjustOffset(0,0),a):p},e.prototype.contains=function(e,t){var n,o,r=this.ranges();if(r)for(n=J(r),void 0,o=0;o<n;o++)if(r[o].contains(e,t))return!0;return!1},e.prototype.createCondition=function(){return this.xyb=!1,null},e.prototype.initCondition=function(e){var t=this.condition();t||((t=this.createCondition())&&(t.ranges(this.ranges()),this.condition(t)),e&&this.context(e),this.context()&&t&&t.context(this.context()))},e.prototype.yyb=function(){var e,t=this;t.xyb&&((e=t.condition())||(t.initCondition(),e=t.condition()),e&&!e.Lf&&e.initExpression())},e.prototype.context=function(e){return 1===arguments.length&&(this.xc=e,this.condition()&&this.condition().context(e)),this.xc},e.prototype.getExpected=function(){return this.style()},e.prototype.reset=function(){var e=this;e.ranges(p),e.condition(p),e.style(p),e.stopIfTrue(!1),e.priority(1)},e.prototype.intersects=function(e,t,n,o){var r,i,a=this.ranges();if(a)for(r=J(a),void 0,i=0;i<r;i++)if(a[i].intersect(e,t,n,o))return!0;return!1},e.prototype.isScaleRule=function(){return!1},e.prototype.getBaseCoordinate=function(e){var t,n,o,r,i;if(e.baseRow=Number.MAX_VALUE,e.baseCol=Number.MAX_VALUE,(t=this).ranges()&&J(t.ranges())>0)for(n=0;n<J(t.ranges());n++)r=-1===(r=(o=t.ranges()[n]).row)?0:r,i=-1===(i=o.col)?0:i,e.baseRow=y(r,e.baseRow),e.baseCol=y(i,e.baseCol);else e.baseRow=0,e.baseCol=0},e.prototype._V=function(e,t,n,o){var r,i,a,s,l,u,c,f,h,p=this,d=n?t:0,g=n?0:t;if(p.yyb(),p.ranges())for(r=J(p.ranges()),i=0;i<r;i++)if(a=p.ranges()[i],s=n?a.row:a.col,l=n?et(a):tt(a),-1!==s){if(o&&o.length>0){for(u=!1,c=0,f=o.length;c<f;c++)if((h=o[c])&&(!n&&h.col===e&&(h.col===a.col&&h.col+h.colCount-t===a.col+a.colCount||a.row===h.row&&a.rowCount===h.rowCount&&a.col>=h.col&&a.col+a.colCount<=h.col+h.colCount)||n&&h.row===a.row&&h.row+h.rowCount-t===a.row+a.rowCount&&a.row===e)){p.ranges()[i]=V(a.row,a.col,et(a)+d,tt(a)+g),u=!0;break}if(u)break}s>=e?p.ranges()[i]=V(a.row+d,a.col+g,et(a),tt(a)):e<=s+l&&(p.ranges()[i]=V(a.row,a.col,et(a)+d,tt(a)+g))}},e.prototype.rI=function(e,t,n){this._V(e,t,!0,n)},e.prototype.tI=function(e,t,n){this._V(e,t,!1,n)},e.prototype.aW=function(e,t,n){var o,r,i,a,s,l,u,c,f,h,p=this,d=n?e:0,g=n?0:e,m=n?t:0,v=n?0:t;if(p.yyb(),p.ranges()){for(o=[],r=J(p.ranges()),i=0;i<r;i++)a=p.ranges()[i],s=n?a.row:a.col,l=n?et(a):tt(a),-1!==s&&(s>e?s+l<=e+t?o.push(a):p.ranges()[i]=V(a.row-m,a.col-v,et(a),tt(a)):e<s+l&&(u=V(a.row,a.col,et(a)-y(a.row+et(a)-d,m),tt(a)-y(a.col+tt(a)-g,v)),0===tt(u)||0===et(u)?o.push(a):p.ranges()[i]=u));for(c=J(o),f=0;f<c;f++)h=o[f],Z(p.ranges(),h)}},e.prototype.GR=function(e,t){this.aW(e,t,!0)},e.prototype.HR=function(e,t){this.aW(e,t,!1)},e.prototype.toJSON=function(e){return oe.call(this,e)},e.prototype.fromJSON=function(e,t,n){e&&(re.call(this,t,p,e,n),this.initCondition(t))},e.prototype.S$a=function(){var e=this.condition();e&&O(e)},e.prototype.hW=function(e){var t,n,o=[],r=J(e);for(n=0;n<r;n++)t=e[n],o.push(V(t.row,t.col,et(t),tt(t)));return o},e.prototype.iW=function(){var e,t,n=this.cW,o=this.ranges();if(!n)return this.cW=this.hW(o),!1;if(J(n)!==(e=J(o)))return!0;for(t=0;t<e;t++)if(!n[t].equals(o[t]))return!0;return!1},e}(),t.ConditionRuleBase=Fe,(Pe=Fe.prototype).ruleType=ne("ruleType",p),Pe.ranges=ne("ranges",p,(function(e){var t,n=this.condition();n&&n.ranges()&&((t=n.xc)&&t._modelManager.YUa(),n.ranges(e))})),Pe.condition=ne("condition",p),Pe.style=ne("style",p),Pe.priority=ne("priority",1),Pe.stopIfTrue=ne("stopIfTrue",!1),He=["ruleType","style","operator","text","formula","type","rank","priority","stopIfTrue","ranges"],Be=function(e){function n(t,n,o,r,i,a,s,l,u,c){var h=e.call(this,t,o)||this,d=h;return d.ranges(n),d.operator(r),d.value1("string"==typeof i?f.trim(i):i),d.value2("string"==typeof a?f.trim(a):a),d.text(s),d.formula(l),d.type(u),d.rank(c),d.cached=!1,d.cW=p,h}return Xe(n,e),n.prototype.value1=function(e,t){var n,o;return 1!==arguments.length?(n=this.condition())&&((o=n.formula(e,t,0))&&o.length>0)?"="+N(f.trim(""+o),"="):this._Qa:void(this._Qa=e)},n.prototype.value2=function(e,t){var n,o;return 1!==arguments.length?(n=this.condition())&&((o=n.formula(e,t,1))&&o.length>0)?"="+N(f.trim(""+o),"="):this.aRa:void(this.aRa=e)},n.prototype.formula=function(e,t){var n=this,o=n.condition();return"string"!=typeof e?o&&o.formula(e,t)||n.Yw:(n.Yw=e,void(o&&o.formula(e)))},n.prototype.cellValueRuleCreateCondition=function(){var e,n,o,r,i,a,s,l,u=this,c=u.value1(),f=u.value2(),h=u.ranges(),g=u.bW(c)?N(c,"="):p,m=u.bW(f)?N(f,"="):p,y=u.operator();return y===ce.between?((e=t.$V(xe.cellValueCondition,3,c,g,d,d,h)).treatNullValueAsZero(!0),(n=t.$V(xe.cellValueCondition,5,f,m,d,d,h)).treatNullValueAsZero(!0),i=t.$V(xe.relationCondition,1,p,p,p,p,h,e,n),(o=t.$V(xe.cellValueCondition,5,c,g,d,d,h)).treatNullValueAsZero(!0),(r=t.$V(xe.cellValueCondition,3,f,m,d,d,h)).treatNullValueAsZero(!0),a=t.$V(xe.relationCondition,1,p,p,p,p,h,o,r),t.$V(xe.relationCondition,0,p,p,p,p,h,i,a)):y===ce.notBetween?((e=t.$V(xe.cellValueCondition,4,c,g,d,d,h)).treatNullValueAsZero(!0),n=t.$V(xe.cellValueCondition,2,f,m,d,d,h),e.treatNullValueAsZero(!0),i=t.$V(xe.relationCondition,0,p,p,p,p,h,e,n),(o=t.$V(xe.cellValueCondition,2,c,g,d,d,h)).treatNullValueAsZero(!0),(r=t.$V(xe.cellValueCondition,4,f,m,d,d,h)).treatNullValueAsZero(!0),a=t.$V(xe.relationCondition,0,p,p,p,p,h,o,r),t.$V(xe.relationCondition,1,p,p,p,p,h,i,a)):(s=y,(l=t.$V(11,s,c,g,d,d,h)).treatNullValueAsZero(!0),l)},n.prototype.bW=function(e){return!E(e)&&"="===e[0]},n.prototype.specificTextRuleCreateCondition=function(){var e,n,o,r,i=this.operator();switch(i){case 2:e=2;break;case 3:e=4;break;case 0:e=6;break;case 1:e=7;break;default:e=0}return n=this.text(),o=p,n&&"="===n[0]&&(o=n),(r=t.$V(2,e,n,o,d,d,this.ranges())).ignoreCase(!0),r.useWildCards(2!==i&&3!==i),r},n.prototype.formulaRuleCreateCondition=function(){var e=this.ranges();return t.$V(4,p,p,this.Yw,4,p,e)},n.prototype.dateOccurringRuleCreateCondition=function(){return t.$V(6,p,this.type(),p,p,d,this.ranges())},n.prototype.top10RuleCreateCondition=function(){return t.$V(8,p,this.rank(),p,p,this.type(),this.ranges())},n.prototype.uniqueRuleCreateCondition=function(){return t.$V(9,p,!1,p,p,p,this.ranges())},n.prototype.duplicateRuleCreateCondition=function(){return t.$V(9,p,!0,p,p,p,this.ranges())},n.prototype.averageRuleCreateCondition=function(){return t.$V(10,p,p,p,p,this.type(),this.ranges())},n.prototype.createCondition=function(){return this[Ae[this.ruleType()]+"CreateCondition"]()},n.prototype.reset=function(){var e=this;switch(e.ranges(p),e.condition(p),e.style(p),e.stopIfTrue(!1),e.priority(1),e.operator(6),e.value1(p),e.value2(p),e.text(""),e.formula(p),e.type(0),e.rank(10),e.ruleType()){case 1:e.operator(6);break;case 2:e.operator(0);break;case 4:e.style(p);break;case 5:e.type(0),e.rank(10);break;case 8:e.type(0)}},n.prototype.evaluate=function(t,n,o,r){return this.jW(t),e.prototype.evaluate.call(this,t,n,o,r)},n.prototype.jW=function(e){var t,n=this;n.initCondition(),9===(t=n.condition()).conType()&&(n.iW()&&(n.Nm(),n.cW=n.hW(n.ranges())),!1===n.cached&&(t.duplicatedArrayCached=t.getDuplicated(e,n.ranges()),n.cached=!0))},n.prototype.Nm=function(){this.cached=!1},n.prototype.rI=function(t,n,o){e.prototype.rI.call(this,t,n,o),this.Nm()},n.prototype.tI=function(t,n,o){e.prototype.tI.call(this,t,n,o),this.Nm()},n.prototype.GR=function(t,n){e.prototype.GR.call(this,t,n),this.Nm()},n.prototype.HR=function(t,n){e.prototype.HR.call(this,t,n),this.Nm()},n.prototype.toJSON=function(e){var t,n,o,r,i=this;return E(i.condition())&&this.initCondition(),t=oe.call(i,e,He),n=i.value1(),function(e,t){return e===Ae.cellValueRule&&(t===ce.between||t===ce.notBetween)}(t.ruleType,t.operator)&&(o=i.value2()),r=e&&e.parent&&1===e.parent.options.referenceStyle,E(n)||(i.bW(n)&&r&&(n=rt(e,i,n,r)),t.value1=n),E(o)||(i.bW(o)&&r&&(o=rt(e,i,o,r)),t.value2=o),i.ruleType()===Ae.conditionRuleBase&&(t.condition=i.condition().toJSON()),t},n.prototype.fromJSON=function(e,t,n){var o=He;E(e.condition)||(o=He.concat(["condition"])),re.call(this,t,o,e,n),E(e.value1)||this.value1(e.value1),E(e.value2)||this.value2(e.value2),this.initCondition(t)},n}(Fe),t.NormalConditionRule=Be,Le={operator:ne("operator",p),text:ne("text",p),type:ne("type",p),rank:ne("rank",p),priority:ne("priority",1)},f.extend(Be.prototype,Le),ze=function(e,t){this.type=e,this.value=t},t.ScaleValue=ze,Ve=["ruleType","ranges","minType","minValue","minColor","maxType","maxValue","maxColor","midType","midValue","midColor","priority"],Ge=function(e){function n(t,n,o,r,i,a,s,l,u,c,f){var h,d,g,m,y,v,b,C,w,x=e.call(this,t,p,f)||this,A=x;return A.xyb=!1,A.lowestValueCached=p,A.highestValueCached=p,A.zyb={},A.cached=!1,A.cW=p,h=n,d=o,g=r,m=i,y=a,v=s,b=l,C=u,w=c,arguments.length<=1&&(h=1,d=p,g=z(255,248,105,107),m=4,y=50,v=z(255,255,235,132),b=2,C=p,w=z(255,99,190,123)),A.minColor(g),A.minValue(d),A.minType(h),A.midColor(v),A.midValue(y),A.midType(m),A.maxColor(w),A.maxValue(C),A.maxType(b),x}return Xe(n,e),n.prototype.stopIfTrue=function(e){return!1},n.prototype.isScaleRule=function(){return!0},n.prototype.createCondition=function(){return p},n.prototype.fW=function(e){var n=t.$V(8,p,p,p,p,1).getTopValues(e,1,this.ranges());return J(n)>0?n[0]:p},n.prototype.gW=function(e){var n=t.$V(8,p,p,p,p,0).getTopValues(e,1,this.ranges());return J(n)>0?n[0]:p},n.prototype.jW=function(e){var t=this;t.iW()&&(t.Nm(),t.cW=t.hW(t.ranges())),!1===t.cached&&(t.lowestValueCached=t.fW(e),t.highestValueCached=t.gW(e),t.cached=!0)},n.prototype.Nm=function(){this.lowestValueCached=p,this.highestValueCached=p,this.zyb={},this.cached=!1},n.prototype.kW=function(e,t,n,o){var r,i;return o&&(r=e.Cf())?(i=r.parse(e.yj(),o,t,n),r._evaluateParsedFormula(e.yj(),i,s._createCellIdentity(t,n),!1)):p},n.prototype.bW=function(e){return e&&"="===e[0]},n.prototype.lW=function(e){return E(e)||""===e?p:"="===e[0]?e.substr(1):e},n.prototype.mW=function(e,t,n,o){if(this.bW(o))return this.kW(e,t,n,this.lW(""+o));var r={};return S(o,r)?r.value:NaN},n.prototype.dW=function(e){return this.jW(e),this.highestValueCached},n.prototype.eW=function(e){return this.jW(e),this.lowestValueCached},n.prototype.nW=function(e,t,n,o){var r,i,a=this.mW(e,t,n,o);return!isNaN(a)&&0<=a&&a<=100&&(r=this.eW(e),i=this.dW(e),typeof r!==g&&r!==p&&typeof i!==g&&i!==p)?r+(i-r)*a/100:p},n.prototype.oW=function(e,t,n,o){var r,i,a,l,u,c,f,h,d,g,m,y,v=this.zyb;if(void 0!==v[o])return v[o];if(r=this.mW(e,t,n,o),!isNaN(r)&&0<=r&&r<=100){for(i=0,a=this.ranges(),l=J(a),u=0;u<l;u++)c=this.YV("PERCENTILE",[e.Tq(a[u]),r/100]),f=e.Cf(),h=e.yj(),d=f.unparse(h,c,t,n),g=f.parse(h,d,t,n),m=f._evaluateParsedFormula(h,g,s._createCellIdentity(t,n),!1),i+=S(m,y={})?y.value:0;return v[o]=i/l,v[o]}return v[o]=p,v[o]},n.prototype.pW=function(e,t,n,o,r){var i,a,s=this;switch(o){case be.formula:return s.bW(r)||(r="="+r),s.mW(e,t,n,r);case be.highestValue:return s.dW(e);case be.lowestValue:return s.eW(e);case be.number:return s.mW(e,t,n,r);case be.percent:return s.nW(e,t,n,r);case be.percentile:return s.oW(e,t,n,r);case be.automax:return(i=s.dW(e))<0?0:i;case be.automin:return(a=s.eW(e))>0?0:a;default:return p}},n.prototype.qW=function(e,t,n){return e===t&&e===n?1:e<=t?0:e>=n?1:(e-t)/(n-t)},n.prototype.rW=function(e,t,n){var o,r,i,a,s,l;return 0<=e&&e<=1?(o=L.ec(t),r=L.ec(n),i=o.a*(1-e)+r.a*e,a=o.r*(1-e)+r.r*e,s=o.g*(1-e)+r.g*e,l=o.b*(1-e)+r.b*e,z(parseFloat(i/255+""),parseInt(a+"",10),parseInt(s+"",10),parseInt(l+"",10))):p},n.prototype.YV=function(e,t){var n,o,r,a;if(!P)return p;if(n=Q.findGlobalFunction(e)){for(o=[],r=J(t),a=0;a<r;a++)o[a]=te(t[a]);return i.Jh(n,o)}return p},n.prototype.rI=function(t,n,o){e.prototype.rI.call(this,t,n,o),this.Nm()},n.prototype.tI=function(t,n,o){e.prototype.tI.call(this,t,n,o),this.Nm()},n.prototype.GR=function(t,n){e.prototype.GR.call(this,t,n),this.Nm()},n.prototype.HR=function(t,n){e.prototype.HR.call(this,t,n),this.Nm()},n.prototype.scaleEvaluate=function(e,t,n,o){var r,i,a,s,l=this;if(l.jW(e),l.contains(t,n)){if(E(o))return p;try{if(r=M(o),i=l.pW(e,t,n,l.minType(),l.minValue()),a=l.pW(e,t,n,l.midType(),l.midValue()),i>(s=l.pW(e,t,n,l.maxType(),l.maxValue())))return p;if(isNaN(a)){if(!isNaN(i)&&!isNaN(s))return l.qW(r,i,s)}else if(!isNaN(i)&&!isNaN(s))return r<i?0:r>=s?2:i<=r&&r<=a?l.qW(r,i,a):1+l.qW(r,i,s)}catch(e){return p}}return p},n.prototype.twoScaleRuleEvaluate=function(e,t,n,o){var r,i,a,s,l,u;if(!E(o)){if(r={},i=A(o)&&S(o,r)?r.value:NaN,isNaN(i))return p;if(s=(a=this).pW(e,t,n,a.minType(),a.minValue()),l=a.pW(e,t,n,a.maxType(),a.maxValue()),!E(s)&&!E(l))return u=a.qW(i,s,l),a.rW(u,a.minColor(),a.maxColor())}return p},n.prototype.threeScaleRuleEvaluate=function(e,t,n,o){var r,i,a,s,l,u,c=this;if(c.lh=e,!E(o)){if(r={},i=A(o)&&S(o,r)?r.value:NaN,isNaN(i))return p;if(a=c.pW(e,t,n,c.minType(),c.minValue()),s=c.pW(e,t,n,c.midType(),c.midValue()),l=c.pW(e,t,n,c.maxType(),c.maxValue()),!E(a)&&!E(l)&&!E(s))return u=void 0,a>l?p:i<=a||a===l?i>=l?c.maxColor():c.minColor():i>=l?c.maxColor():i<=s?(u=c.qW(i,a,s),c.rW(u,c.minColor(),c.midColor())):(u=c.qW(i,s,l),c.rW(u,c.midColor(),c.maxColor()))}return p},n.prototype.evaluate=function(e,t,n,o){return this[Ae[this.ruleType()]+"Evaluate"](e,t,n,o)},n.prototype.ad=function(){var e=this;e.minValue(p),e.minType(1),e.midValue(50),e.midType(4),e.maxValue(p),e.maxType(2),10===e.ruleType()&&(e.minColor(z(0,255,255,255)),e.maxColor(z(255,99,190,123))),11===e.ruleType()&&(e.midValue(50),e.midType(4),e.minColor(z(255,248,105,107)),e.midColor(z(255,255,235,132)),e.maxColor(z(255,99,190,123)))},n.prototype.reset=function(){var e=this;e.ranges(p),e.condition(p),e.style(p),e.ad(),e.lh=p,e.stopIfTrue(!1),e.priority(1)},n.prototype.toJSON=function(e){return oe.call(this,e,Ve)},n.prototype.fromJSON=function(e,t,n){re.call(this,t,Ve,e,n),this.initCondition(t)},n}(Fe),t.ScaleRule=Ge,We={minValue:ne("minValue",p),minType:ne("minType",5),minColor:ne("minColor",p),midValue:ne("midValue",50,p,(function(e){var t=this;if(t.lh){if(2===t.midType())return t.dW(t.lh);if(1===t.midType())return t.eW(t.lh)}return e})),midType:ne("midType",p),midColor:ne("midColor",p),maxType:ne("maxType",7),maxValue:ne("maxValue",p),maxColor:ne("maxColor",p)},f.extend(Ge.prototype,We),Ue=["ruleType","ranges","gradient","color","showBorder","borderColor","dataBarDirection","negativeFillColor","useNegativeFillColor","negativeBorderColor","useNegativeBorderColor","axisPosition","axisColor","showBarOnly","minType","minValue","maxType","maxValue","priority"],Ze=function(e){function t(t,n,o,r,i,a){var s=this,l=t,u=n,c=o,f=r,h=i;return 0===arguments.length&&(l=5,u=p,c=7,f=p,h=z(255,99,142,198)),(s=e.call(this,12,l,u,p,p,p,p,c,f,p,a)||this).xyb=!1,s.ad(h),s}return Xe(t,e),t.prototype.ad=function(e){var t=this;t.gradient(!0),t.color(e),t.showBorder(!1),t.borderColor("black"),t.dataBarDirection(0),t.negativeFillColor("red"),t.useNegativeFillColor(!0),t.negativeBorderColor("black"),t.useNegativeBorderColor(!1),t.axisPosition(0),t.axisColor("black"),t.showBarOnly(!1)},t.prototype.reset=function(){var e=this;e.ranges(p),e.condition(p),e.style(p),e.ad(z(255,99,142,198)),e.stopIfTrue(!1),e.priority(1),e.minValue(p),e.minType(5),e.midValue(p),e.midType(p),e.maxValue(p),e.maxType(7),e.minColor(p),e.midColor(p),e.maxColor(p)},t.prototype.sW=function(e,t,n,o){var r,i,a,s,l=this,u=o?l.maxType():l.minType(),c=o?l.maxValue():l.minValue();if(6!==u&&4!==u)return l.pW(e,t,n,u,c);for(i=0;i<J(l.ranges());i++)if(l.ranges()[i].intersect(t,-1,1,-1)&&(r=l.ranges()[i]))return a=-1===(a=r.row)?0:a,s=-1===(s=r.col)?0:s,l.pW(e,a,s,u,c)},t.prototype.tW=function(e,t,n){return e>=n&&e>t?[1,0]:e<=t&&e<n?[0,0]:n===t?[.5,0]:[(e-t)/(n-t),0]},t.prototype.uW=function(e,t,n){var o,r,i=.5,a=b(n-t);return n>0&&t>=0?n===t||e>=n?[.5,i]:e<=t?[t/n*.5,i]:[.5*b(e/n),i]:n>0&&t<0?(o=n>b(t)?.5:n/a,r=n>b(t)?t/a:-.5,e>0?e>=n?[o,i]:[e/n*o,i]:e<0?e<=t?[r,i]:[e/t*r,i]:[0,i]):n<=0&&t<0?n===t?[-.5,i]:e>=n?[-n/t*.5,i]:e<=t?[-.5,i]:[-e/t*.5,i]:0===n&&0===t?[0,i]:[-1,i=-1]},t.prototype.vW=function(e,t,n){var o,r,i,a=-1,s=b(t),l=b(n),u=b(n-t),c=t<0?-1:1;return n>0&&t>=0||n<=0&&t<0?(o=v(s,l),r=y(s,l),a=t<0?1:0,(i=b(e))<=r&&i<o?[0,a]:i>=o&&i>r?[c,a]:r===o?[.5*c,a]:[c*(b(e)-r)/u,a]):n>0&&t<0?(a=b(t)/u,0===e?[0,a]:e>=n?[1-a,a]:[v(e,t)/u,a]):0===n&&0===t?(a=.5,0===e?[0,a]:[.5*c,a]):[-1,a]},t.prototype.wW=function(e,t,n){var o=this;return 0===o.axisPosition()?o.vW(e,t,n):1===o.axisPosition()?o.uW(e,t,n):o.tW(e,t,n)},t.prototype.evaluate=function(e,t,n,o){var r,i,a,s,l,u,c,f,h,d,g,m;if(!E(o)){if(r={},i=A(o,!0)&&S(o,r)?r.value:NaN,isNaN(i))return p;if(s=(a=this).sW(e,t,n,!1),l=a.sW(e,t,n,!0),j(s,Date)&&(s=W.Ra(s)),j(l,Date)&&(l=W.Ra(l)),!E(s)&&!E(l))return s>l&&(u=l,l=s,s=u),c=void 0,!(f=a.wW(i,s,l))||J(f)<2?p:(h=f[0],c=f[1],d=i<0&&a.useNegativeFillColor()?a.negativeFillColor():a.color(),g=i<0&&a.useNegativeBorderColor()?a.negativeBorderColor():a.borderColor(),m=a.axisColor(),d=K.Om(e,d),g=K.Om(e,g),m=K.Om(e,m),{fillColor:d,borderColor:g,showBorder:a.showBorder(),axisColor:m,isGradient:a.gradient(),direction:a.dataBarDirection(),axisLocation:c,scale:h,showBarOnly:a.showBarOnly()})}return p},t.prototype.toJSON=function(e){return oe.call(this,e,Ue)},t.prototype.fromJSON=function(e,t,n){re.call(this,t,Ue,e,n),this.initCondition(t)},t.paintDataBar=function(e,t,n,o,i,a){var s,l,u,c,f,h,p,d,g,m,y,v,w,x=new r.Rect(n+2,o+2,i-4,a-4),A=x.x,M=x.y,S=C(b(x.width*t.scale)),T=x.height;if(0===t.axisLocation)t.scale<=0&&(S=0);else if(1===t.axisLocation)t.scale<0?A=A+x.width-S:S=0;else{for(s=C(x.width*t.axisLocation+A)+.5,l=x.y,1,u=a-2,e.lineWidth=1,e.strokeStyle=t.axisColor,e.beginPath(),c=0;c<=u;c+=2)1===t.direction?(e.moveTo(2*n+i-s,l+c),e.lineTo(2*n+i-s,l+c+1)):(e.moveTo(s,l+c),e.lineTo(s,l+c+1));e.stroke(),t.scale>0?A=s+1:t.scale<0?A=s-S:S=0}t.showBorder&&(A=C(A)+.5,S-=1,M+=.5,T-=1),f=A,h=A+S,1===t.direction&&(f=2*n+i-A-S,h=2*n+i-A),S>=0&&T>=0&&(p=t.fillColor,t.isGradient&&(d=.9,p=e.createLinearGradient(f,M,h,M),g=L.ec(t.fillColor),m=z(g.a,C(229.5+g.r*(1-d)),C(229.5+g.g*(1-d)),C(229.5+g.b*(1-d))),y=t.scale<0?1-d:d,v=t.fillColor,w=t.scale<0?1:0,1===t.direction?(p.addColorStop(y,v),p.addColorStop(w,m)):(p.addColorStop(y,m),p.addColorStop(w,v))),e.fillStyle=p,e.fillRect(f,M,S,T),t.showBorder&&S>0&&T>0&&(e.strokeStyle=t.borderColor,e.strokeRect(f,M,S,T)))},t}(Ge),t.DataBarRule=Ze,qe={gradient:ne("gradient",!0),color:ne("color",p),showBorder:ne("showBorder",!1),borderColor:ne("borderColor","black"),dataBarDirection:ne("dataBarDirection",0),negativeFillColor:ne("negativeFillColor","red"),useNegativeFillColor:ne("useNegativeFillColor",!0),negativeBorderColor:ne("negativeBorderColor","black"),useNegativeBorderColor:ne("useNegativeBorderColor",!1),axisPosition:ne("axisPosition",0),axisColor:ne("axisColor","black"),showBarOnly:ne("showBarOnly",!1)},f.extend(Ze.prototype,qe),Je=function(e,t,n){this.isGreaterThanOrEqualTo=e,this.iconValueType=t,this.iconValue=n},t.IconCriterion=Je,Qe=["ruleType","ranges","iconSetType","iconCriteria","showIconOnly","reverseIconOrder","priority","icons"],Ye=function(e){function t(t,n){var o=this,r=t;return 0===arguments.length&&(r=0),(o=e.call(this,13,p,p,p)||this).xyb=!1,o.ranges(n),o.ad(r),o}return Xe(t,e),t.prototype.xW=function(e){var t=this;t.iconSetType(e,!1),t.iconSetType()>=Ce.threeArrowsColored&&t.iconSetType()<=Ce.threeSymbolsUncircled?(t.NV=[],t.NV[0]=new Je(!0,we.percent,33),t.NV[1]=new Je(!0,we.percent,67),t.CZa=[],t.CZa[0]={iconSetType:e,iconIndex:0},t.CZa[1]={iconSetType:e,iconIndex:1},t.CZa[2]={iconSetType:e,iconIndex:2}):t.iconSetType()>=Ce.fourArrowsColored&&t.iconSetType()<=Ce.fourTrafficLights?(t.NV=[],t.NV[0]=new Je(!0,we.percent,25),t.NV[1]=new Je(!0,we.percent,50),t.NV[2]=new Je(!0,we.percent,75),t.CZa=[],t.CZa[0]={iconSetType:e,iconIndex:0},t.CZa[1]={iconSetType:e,iconIndex:1},t.CZa[2]={iconSetType:e,iconIndex:2},t.CZa[3]={iconSetType:e,iconIndex:3}):t.iconSetType()>=Ce.fiveArrowsColored&&t.iconSetType()<=Ce.fiveBoxes?(t.NV=[],t.NV[0]=new Je(!0,we.percent,20),t.NV[1]=new Je(!0,we.percent,40),t.NV[2]=new Je(!0,we.percent,60),t.NV[3]=new Je(!0,we.percent,80),t.CZa=[],t.CZa[0]={iconSetType:e,iconIndex:0},t.CZa[1]={iconSetType:e,iconIndex:1},t.CZa[2]={iconSetType:e,iconIndex:2},t.CZa[3]={iconSetType:e,iconIndex:3},t.CZa[4]={iconSetType:e,iconIndex:4}):t.iconSetType()>Ce.fiveBoxes&&(t.NV=[],t.CZa=[])},t.prototype.ad=function(e){this.showIconOnly(!1),this.reverseIconOrder(!1),this.xW(e)},t.prototype.yW=function(e){var t=J(this.NV)+1;return this.reverseIconOrder()&&t>2?t-1-e:e},t.prototype.pW=function(e,t,n,o){var r=this,i=r.NV[o];if(i)switch(i.iconValueType){case we.formula:case we.number:return r.mW(e,t,n,i.iconValue);case we.percent:return r.nW(e,t,n,i.iconValue);case we.percentile:return r.oW(e,t,n,i.iconValue);default:return p}},t.prototype.evaluate=function(e,t,n,o){var r,i,a,s,l,u,c,f,h,d,g,m,y=this,v=o;if(E(v))return p;if(r={},i=A(o,!0)&&"boolean"!=typeof v&&S(o,r)?r.value:NaN,isNaN(i))return p;if(a=0,s=y.iconSetType(),l=y.NV,s>=Ce.fiveArrowsColored?a=5:s>=Ce.fourArrowsColored?a=4:s>=Ce.threeArrowsColored&&(a=3),!l)return 0;for(c=0,f=a-1;f>0;f--)if(f<J(l)+1&&(u=l[f-1],!E(u&&u.iconValue)&&(h=y.pW(e,t,n,f-1),!E(h)&&(d=u.isGreaterThanOrEqualTo?i>=h:i>h,i<Number.MAX_VALUE&&d)))){c=f;break}return g=y.yW(c),(m=y.CZa)?{iconSetType:m[g]?m[g].iconSetType:Ce.noIcons,iconIndex:m[g]?m[g].iconIndex:0,showIconOnly:y.showIconOnly()}:{iconSetType:Ce.noIcons,iconIndex:0,showIconOnly:y.showIconOnly()}},t.prototype.reset=function(){var e=this;e.ranges(p),e.condition(p),e.style(p),e.showIconOnly(!1),e.reverseIconOrder(!1),e.iconSetType(0,p),e.NV=p,e.stopIfTrue(!1),e.priority(1),e.minColor(p),e.minValue(p),e.minType(5),e.midColor(p),e.midValue(p),e.midType(p),e.maxColor(p),e.maxValue(p),e.maxType(7),e.CZa=p},t.prototype.icons=function(e){return 1===arguments.length&&(this.CZa=e),this.CZa},t.prototype.iconCriteria=function(){return this.NV},t.prototype.toJSON=function(e){return oe.call(this,e,Qe)},t.prototype.fromJSON=function(e,t,n){re.call(this,t,Qe,e,n),this.initCondition(t)},t.getIcon=function(e,t){return p},t.Pdc=function(e,t,n,o,r,i,a){if(a.ko(t)){var s=a.lo(t);e.drawImage(s,n,o,r,i)}else a.fo(t)},t.paintIconSet=function(e,n,o,r,i,a,s,u,c,h){var p,d,g=l.To.No(s.font,1).fontSize,m=o+2;if(n.showIconOnly&&(1===s.hAlign?m=o+i/2-g/2:2===s.hAlign&&(m=o+i-2-g-2)),p=1===s.vAlign?r+a/2-g/2:2===s.vAlign?r+a-2-u/2-g/2:r+2+u/2-g/2,n.iconSetType!==Ce.noIcons)if((d=t.getIcon(n.iconSetType,n.iconIndex))&&"string"===f.getType(d)&&h)try{t.Pdc(e,d,m,p,g,g,h)}catch(e){}else ot(e,n,m,p,g,o,r,i,a)},t}(Ge),t.IconSetRule=Ye,Ke={iconSetType:ne("iconSetType",Ce.threeArrowsColored,(function(e){this.xW(e)})),reverseIconOrder:ne("reverseIconOrder",!1),showIconOnly:ne("showIconOnly",!1)},f.extend(Ye.prototype,Ke),$e=function(){function e(e){this.AW=[],this.BW=p,this.DW={},this.Kfc=!0,this.WS=e}return e.prototype.no=function(){this.WS=p},e.prototype.getRule=function(e){return this.AW[e]},e.prototype.count=function(){return J(this.AW)},e.prototype.w4=function(){return this.AW},e.prototype.UV=function(e){var t,n,o=[],r=this.WS,i=J(e);for(t=0;t<i;t++)n=r.Tq(e[t]),o.push(n);return o},e.prototype.EW=function(e){var t,n,o,r,i=[],a=this.WS;for(t=0,n=J(e);t<n;t++)o=e[t],r=new G(o.row,o.col,et(o),tt(o)),0===o.row&&et(o)===a.getRowCount()&&(r.row=-1),0===o.col&&tt(o)===a.getColumnCount()&&(r.col=-1),i.push(r);return i},e.prototype.QV=function(){if(this.Kfc&&(this.DW={},this.AW))for(var e=0;e<J(this.AW);e++)this.FW(this.AW[e])},e.prototype.OV=function(){this.Kfc&&(this.DW={})},e.prototype.FW=function(e){var t,n,o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v;if(this.Kfc)for(n=(t=this).DW,s=t.UV(e.ranges()),u=(l=t.WS).getRowCount(),c=l.getColumnCount(),f=0;f<J(s);f++)for(p=(h=s[f]).row,d=h.col,p+(g=et(h))-1>=u&&(g=u-p),d+(m=tt(h))-1>=c&&(m=c-d),y=0;y<g;y++)for((o=n[i=y+p])||(n[i]=o=[]),v=0;v<m;v++)(r=o[a=v+d])||(o[a]=r=[]),r.push(e)},e.prototype.GW=function(e){var t,n,o,r,i,a,s,l,u,c,f;if(this.Kfc)for(t=this.DW,i=this.UV(e.ranges()),a=0;a<J(i);a++)for(s=i[a],l=0;l<et(s);l++)if(n=t[l+s.row])for(u=0;u<tt(s);u++)if(o=n[r=u+s.col]){for(c=[],f=0;f<J(o);f++)o[f]!==e&&c.push(o[f]);0===J(c)&&(c=d),n[r]=c}},e.prototype.HW=function(e,t,n,o){var r,i,a,s;if(this.Kfc)for(r=this.DW,a=0;a<n;a++)if(i=r[a+e])for(s=0;s<o;s++)i[s+t]=d},e.prototype.Ayb=function(e,t){var n,o,r=[];for(n=0;n<J(this.AW);n++)(o=this.AW[n]).contains(e,t)&&r.push(o);return r},e.prototype.addSpecificTextRule=function(e,t,n,o){var r=new Be(2,o,n,e,p,p,t);return this.addRule(r)},e.prototype.addCellValueRule=function(e,t,n,o,r){var i=new Be(1,r,o,e,it(t),it(n));return this.addRule(i)},e.prototype.addDateOccurringRule=function(e,t,n){var o=new Be(4,n,t,p,p,p,p,p,e);return this.addRule(o)},e.prototype.addFormulaRule=function(e,t,n){var o=new Be(3,n,t,p,p,p,p,e);return this.addRule(o)},e.prototype.addTop10Rule=function(e,t,n,o){var r=new Be(5,o,n,p,p,p,p,p,e,t);return this.addRule(r)},e.prototype.addUniqueRule=function(e,t){var n=new Be(6,t,e);return this.addRule(n)},e.prototype.addDuplicateRule=function(e,t){var n=new Be(7,t,e);return this.addRule(n)},e.prototype.addAverageRule=function(e,t,n){var o=new Be(8,n,t,p,p,p,p,p,e);return this.addRule(o)},e.prototype.add3ScaleRule=function(e,t,n,o,r,i,a,s,l,u){var c;return c=0===arguments.length?new Ge(11):new Ge(11,e,t,n,o,r,i,a,s,l,u),this.addRule(c)},e.prototype.add2ScaleRule=function(e,t,n,o,r,i,a){var s;return s=0===arguments.length?new Ge(10):new Ge(10,e,t,n,p,p,p,o,r,i,a),this.addRule(s)},e.prototype.addDataBarRule=function(e,t,n,o,r,i){var a;return a=0===arguments.length?new Ze:new Ze(e,t,n,o,r,i),this.addRule(a)},e.prototype.addIconSetRule=function(e,t){var n=new Ye(e,t);return this.addRule(n)},e.prototype.addRule=function(e){var t,n,o,r,i,a,s,l,u,c,f=this,h=f.WS;if(h){if(!e)throw Error(X().Exp_RuleIsNull);for(n=void 0,o=void 0,(t=e.ranges())&&(n=(r=F(t)).r,o=r.c),(a=(i=e.getExpected())&&i.formatter)&&"string"==typeof a&&h.fJb(n||0,o||0,a),h._modelManager.YUa(),s=0,l=J(f.AW);s<l;s++)c=(u=f.AW[s]._ps).priority||1,u.priority=c+1;return e.priority(1),f.AW.push(e),e.context(h),f.FW(e),h.$p(),e}},e.prototype.removeRule=function(e){var t,n,o=this,r=o.WS,i=r.parent;r&&(e&&((n=(t=e.getExpected())&&t.formatter)&&"string"==typeof n&&i.QHb[n]&&i.RHb(n),r._modelManager.YUa(),o.GW(e),Z(o.AW,e)),r.$p())},e.prototype.IW=function(e,t,n,o,r){var i,a,s,l,u,c,f,h,d,g,m,b,C;return e.intersect(t,n,o,r)?(i=e.row,a=e.row+et(e)-1,s=e.col,l=e.col+tt(e)-1,u=t,c=t+o-1,f=n,h=n+r-1,d=[],-1!==i&&-1!==s&&-1!==u&&-1!==f&&(f-s>0&&(g=V(i,s,et(e),f-s),d.push(g)),l-h>0&&(m=V(i,h+1,et(e),l-h),d.push(m)),u-i>0&&(b=V(i,v(f,s),u-i,y(h,l)-v(f,s)+1),d.push(b)),a-c>0&&(C=V(c+1,v(f,s),a-c,y(h,l)-v(f,s)+1),d.push(C))),J(d)>0?d:p):[e]},e.prototype.removeRuleByRange=function(e,t,n,o){var r,i,a,s,l,u,c,f,h,p,d,g=this,m=g.WS;if(m){if(r=[],g.AW)for(m._modelManager.YUa(),g.HW(e,t,n,o),i=0,a=J(g.AW);i<a;i++)if((s=g.AW[i])&&s.ranges()&&s.intersects(e,t,n,o)){for(l=[],u=g.UV(s.ranges()),c=0,f=J(u);c<f;c++)(h=g.IW(u[c],e,t,n,o))&&(l=l.concat(h));J(l)>0?s.ranges(g.EW(l)):r.push(s)}for(p=0,d=J(r);p<d;p++)Z(g.AW,r[p]);m.$p()}},e.prototype.clearRule=function(){var e,t,n,o,r=this,i=r.WS,a=i.parent;if(i){for(e=r.AW,i._modelManager.YUa(),t=0;t<e.length;t++)(o=(n=e[t].getExpected())&&n.formatter)&&"string"==typeof o&&a.QHb[o]&&a.RHb(o);r.AW.length=0,r.QV(),i.$p()}},e.prototype.getRules=function(e,t){var n,o,r,i,a,s,l,u,c=this,h=c.AW;if(0===arguments.length||0===J(h))return h;if(e=e===d?-1:e,t=t===d?-1:t,n=[],c.Kfc)o=c.DW,i=void 0,-1!==e&&-1!==t?(i=o[e])&&(r=i[t],at(n,r)):-1===e?f.each(o,(function(e,o){r=o[t],at(n,r)})):(i=o[e])&&f.each(i,(function(e,t){at(n,t)}));else if(s=(a=c.WS).getRowCount(),l=a.getColumnCount(),u=void 0,-1!==e&&-1!==t)at(n,c.Ayb(e,t));else if(-1===e)for(u=0;u<s;u++)at(n,c.Ayb(u,t));else for(u=0;u<l;u++)at(n,c.Ayb(e,u));return n},e.prototype.containsRule=function(e,t,n){return!(!e||!U.Bb(this.AW,e))&&e.contains(t,n)},e.prototype._V=function(e,t,n,o){var r,i,a,s=this;if(s.AW&&s.WS)for(r=J(s.AW),i=0;i<r;i++)(a=s.AW[i])&&(n?a.rI(e,t,o):a.tI(e,t,o));s.QV()},e.prototype.rI=function(e,t,n){this._V(e,t,!0,n)},e.prototype.tI=function(e,t,n){this._V(e,t,!1,n)},e.prototype.aW=function(e,t,n){var o,r,i=this;if(i.AW&&i.WS)for(o=J(i.AW)-1;o>=0;o--)(r=i.AW[o])&&(n?r.GR(e,t):r.HR(e,t),r.ranges().length<=0&&(i.GW(r),i.AW.splice(o,1)));i.QV()},e.prototype.GR=function(e,t){this.aW(e,t,!0)},e.prototype.HR=function(e,t){this.aW(e,t,!1)},e.prototype.Nm=function(){var e,t,n,o=this.AW;if(o!==p&&J(o)>0)for(t=0,n=J(o);t<n;t++)(e=o[t]).Nm&&e.Nm()},e.prototype.XA=function(e,t,n,o,r,i,a,s){var l,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O=[],P=[],H=[],B=[],L=this,z=L.WS;for(-1===e&&(e=0,o=0,i=z.getRowCount()),-1===t&&(t=0,r=0,a=z.getColumnCount()),l=0;l<i;l++)for(c=0;c<a;c++)for(f=L.getRules(e+l,t+c),h=0;h<J(f);h++){for(d=(p=f[h]).ranges(),g=[],m=0;m<J(d);m++)y=d[m],b=(v=z.Tq(y)).row,C=v.col,w=et(v),x=tt(v),q(H,y)<=-1&&y.contains(e+l,t+c)&&(H.push(y),(A=V(o+l,r+c,-1,-1)).rowCount=b+w>=i+e?i-l:e<b?w:b+w-e,A.colCount=C+x>=a+t?a-c:t<C?x:C+x-t,L===n&&y.containsRange(A)||g.push(A),s&&-1===B.indexOf(A)&&B.push(A));g.length>0&&((M=O.indexOf(p))<0?(O.push(p),P.push(g)):P[M]=P[M].concat(g))}for(S=0,T=O.length;S<T;S++)I=(N=L.iga(O[S].toJSON(),O[S].context())).ranges(),N.ranges(P[S]),(R=N.Yw)&&(k=1===z.parent.options.referenceStyle,E=F(I),D=u.formulaToExpression(z,R,E.r,E.c,k),j=F(P[S]),_=u.expressionToFormula(z,D,j.r,j.c,k),N.formula(_)),n.addRule(N);return L.QV(),B},e.prototype.YA=function(e,t,n,o,r,i){var a,s,l,u,c,f,h,p,d,g,m,b,C,w,x,A=[],M=this,S=M.WS,T=S.getRowCount(3),N=S.getColumnCount(3);for(-1===e&&(e=0,n=S.getRowCount()),-1===t&&(t=0,o=S.getColumnCount()),a=0;a<n;a++)for(s=0;s<o;s++)for(l=M.getRules(e+a,t+s),u=0;u<J(l);u++){for(f=(c=l[u]).ranges(),h=[],p=0;p<J(f);p++)d=f[p],m=(g=S.Tq(d)).row,b=g.col,C=et(g),w=tt(g),B.Bb(r,d)||q(A,d)<=-1&&d.contains(e+a,t+s)&&(A.push(d),e>m&&h.push(V(m,b,e-m,w)),t>b&&h.push(V(v(e,m),b,y(e+n,m+C)-v(e,m),t-b)),t+o<b+w&&h.push(V(v(e,m),t+o,y(e+n,m+C)-v(e,m),b+w-(t+o))),e+n<m+C&&h.push(V(e+n,b,m+C-(e+n),w)));M.Byb(S,A,r,f,T,N,i),(x=f.concat(h)).length>0?(c.yyb(),c.ranges(x)):M.removeRule(c)}M.QV()},e.prototype.Byb=function(e,t,n,o,r,i,a){var s,l,u,c,f,h;for(s=0;s<J(t);s++){if(u=[l=t[s]],a)for(c=0;c<J(n);c++)f=n[c],l.intersect(f.row,f.col,f.rowCount,f.colCount)&&(u=u.concat(e.v_a(l,f,r,i)));for(h=0;h<J(u);h++)Z(o,u[h])}},e.prototype.jp=function(e,t,n,o,r,i,a,s){var l=16,u=!1,c=!1,f=s.sheet,h=s.row,p=s.col,d=f.zoom(),g=this.oRa(f,h,p,t),m=g.iconSet,y=g.dataBar;return(y||m)&&(e.save(),e.beginPath(),y&&(Ze.paintDataBar(e,y,n,o,r,i),u=y.showBarOnly),m&&((r<(l=parseInt(l*d+"",10))||i<l)&&(e.rect(n,o,r,i),e.clip(),e.beginPath()),Ye.paintIconSet(e,m,n,o,r,i,a,s.lineHeight,d,s.imageLoader),c=m.showIconOnly),e.restore()),u||c},e.prototype.oRa=function(e,t,n,o){var r,i,a,s,l,u,c,f,h=e.ss,d=h.Um(t,n);if(d)r=d.i,i=d.d;else{if(a=this.getRules(t,n),(s=J(a))>0){for(a.sort((function(e,t){return e.priority()-t.priority()})),l=p,u=p,c=void 0,void 0,f=void 0,f=0;f<s&&(!l||!u);f++)(c=a[f])&&(j(c,Ze)&&(l=c),j(c,Ye)&&(u=c));if(l||u)for(l=u=p,f=0;!(!(f<s)||l&&u||(c=a[f],c&&(!l&&j(c,Ze)&&(l=c),!u&&j(c,Ye)&&(u=c),c.stopIfTrue()&&c.evaluate(e,t,n,o))));f++);l&&(i=l.evaluate(e,t,n,o)),u&&(r=u.evaluate(e,t,n,o))}h.Wm(t,n,i,r)}return{dataBar:i,iconSet:r}},e.prototype.bp=function(e,t,n){var o,r,i;if(E(n)||3===n)for(o=this.getRules(e,t),r=0,i=J(o);r<i;r++)if(o[r]instanceof Ye)return!0;return!1},e.prototype.toJSON=function(e){var t,n,o=[];for(t=0;t<J(this.AW);t++)n=this.AW[t],o.push(n?n.toJSON(e):p);return 0===J(o)?d:{rules:o}},e.prototype.fromJSON=function(e,t,n){var o,r,i,a,s;if(e&&(o=e.rules)){for(this.AW=[],r=J(o),i=0;i<r;i++)a=o[i],(s=this.iga(a,t,n))&&this.AW.push(s);this.Kfc=!function(e){var t,n,o,r,i=J(e);for(t=0;t<i;t++)if(n=e[t],o=n.ranges)for(r=0;r<o.length;r++)if(o[r].rowCount>1e3)return!0;return!1}(o),this.QV()}},e.prototype.iga=function(e,t,n){var o,r=p;return e&&((o=this.JW()[e.ruleType])&&(r=new o).fromJSON(e,t,n)),r},e.prototype.JW=function(){if(!this.BW){var e={};e[0]=Be,e[1]=Be,e[2]=Be,e[3]=Be,e[4]=Be,e[5]=Be,e[6]=Be,e[7]=Be,e[8]=Be,e[9]=Ge,e[10]=Ge,e[11]=Ge,e[12]=Ze,e[13]=Ye,this.BW=e}return this.BW},e.prototype.Eq=function(e,t,n,o){var r,i,a,s,l,u,c=this;if(c&&c.count()>0&&(r=c.getRules(t,n),i=J(r),a=void 0,s=p,i>0))for(r.sort((function(e,t){return e.priority()-t.priority()})),l=0;l<i&&!((a=r[l])&&(u=c.WS,a.isScaleRule()?10!==a.ruleType()&&11!==a.ruleType()||(s=a.evaluate(u,t,n,u.getValue(t,n,o)),s&&(e||(e=new H),e.backColor===d&&(e.backColor=s))):(s=a.evaluate(u,t,n,u.getValue(t,n,o)),s&&(e||(e=new H),e.Yo(s,!1,1))),a.stopIfTrue()&&s));l++);return e},e.prototype.Fq=function(e,t,n,o){var r,i,a,s,l,u,c,f,h={v5:!1},g=this;if(g&&g.count()>0&&(r=g.getRules(e,t),i=J(r),a=void 0,s=p,i>0))for(r.sort((function(e,t){return e.priority()-t.priority()})),l=0;l<i;l++)if(a=r[l]){if(u=g.WS,a.isScaleRule()){if(c=a.ruleType(),"backColor"===n&&(10===c||11===c)&&(s=a.evaluate(u,e,t,u.getValue(e,t,o)))){h.Fi=s,h.v5=!0;break}}else{if(!((f=a.style())&&void 0!==f[n]||a.stopIfTrue()))continue;if((s=a.evaluate(u,e,t,u.getValue(e,t,o)))&&s[n]!==d){h.Fi=s[n],h.v5=!0;break}}if(a.stopIfTrue()&&s)break}return h},e}(),t.ConditionalFormats=$e},"./dist/plugins/conditional/conditional.ns.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("./dist/plugins/conditional/conditional.res.en.js");t.SR={en:o}},"./dist/plugins/conditional/conditional.res.en.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_RuleIsNull="The argument 'rule' is null",t.Exp_NotSupported="NotSupportException"},"./dist/plugins/conditional/conditionalFormatIcon.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C;function w(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t+o,n),e.lineTo(t+o,n+r),e.lineTo(t,n+r),e.lineTo(t,n),e.closePath(),e.fill(),e.stroke()}function x(e,t,n){e.moveTo(i(.1*o)*t,-a(.1*o)*t),e.lineTo(i(.3*o)*n,-a(.3*o)*n),e.lineTo(0*t,-a(.5*o)*t),e.lineTo(i(.7*o)*n,-a(.7*o)*n),e.lineTo(i(.9*o)*t,-a(.9*o)*t),e.lineTo(i(1.1*o)*n,-a(1.1*o)*n),e.lineTo(i(1.3*o)*t,-a(1.3*o)*t),e.lineTo(0*n,-a(1.5*o)*n),e.lineTo(i(1.7*o)*t,-a(1.7*o)*t),e.lineTo(i(1.9*o)*n,-a(1.9*o)*n),e.lineTo(i(.1*o)*t,-a(.1*o)*t)}function A(e,t,n,i,a,s){var l=s,u=r(l/2);e.translate(i+u,a+u),e.strokeStyle=C[t][n].strokeStyle,e.rotate(C[t][n].rotate),e.beginPath(),e.arc(0,0,u,0,2*o),e.closePath(),e.fillStyle=C[t][n].fillColor,e.fill(),e.beginPath(),e.arc(0,0,u,0,2*o),e.closePath(),e.stroke(),e.beginPath(),e.fillStyle=C[t][n].fillColor2,e.fillRect(.375*-l,.1*-l,.75*l,.2*l),e.closePath(),e.fill(),e.beginPath(),e.fillStyle=C[t][n].fillColor2,e.fillRect(.1*-l,.375*-l,.2*l,.75*l),e.closePath(),e.fill(),e.stroke()}function M(e,t,n,r,i,a){var s=a;e.translate(r,i),e.strokeStyle=C[t][n].strokeStyle,e.beginPath(),e.arc(.5*s,.5*s,.5*s,0,2*o),e.closePath(),e.fillStyle=C[t][n].fillColor,e.fill(),e.beginPath(),e.arc(.5*s,.5*s,.5*s,0,2*o),e.stroke(),e.closePath(),e.beginPath(),e.moveTo(s/3,.1*s),e.lineTo(s/1.5,.1*s),e.lineTo(.625*s,.6*s),e.lineTo(.375*s,.6*s),e.lineTo(s/3,.1*s),e.moveTo(.625*s,.85*s),e.arc(.5*s,.8*s,.15*s,0,2*o),e.fillStyle=C[t][n].fillColor2,e.fill(),e.closePath()}function S(e,t,n,i,a,s){var l=s;e.translate(r(i+l/2),r(l/2+a)),e.strokeStyle=C[t][n].strokeStyle,e.rotate(C[t][n].rotate),e.beginPath(),e.arc(0,0,l/2,0,2*o),e.closePath(),e.fillStyle=C[t][n].fillColor,e.fill(),e.beginPath(),e.arc(0,0,l/2,0,2*o),e.stroke(),e.closePath(),e.beginPath(),e.fillStyle=C[t][n].fillColor2,e.fillRect(.325*-l,.25*-l,.2*l,.5*l),e.closePath(),e.fill(),e.beginPath(),e.fillStyle=C[t][n].fillColor2,e.fillRect(.325*-l,.05*l,.65*l,.2*l),e.closePath(),e.fill(),e.stroke()}function T(e,t,n,r,i,a){var s=a;e.translate(r,i),e.beginPath(),e.strokeStyle=C[t][n].strokeStyle,e.moveTo(s/3,.5),e.lineTo(s/1.5,.5),e.lineTo(.625*s,.65*s),e.lineTo(.375*s,.65*s),e.lineTo(s/3,.5),e.moveTo(.65*s,.85*s),e.arc(.5*s,.85*s,.15*s,0,2*o),e.fillStyle=C[t][n].fillColor,e.fill(),e.stroke()}function N(e,t,n,o,i,a){var s,l,u=a;e.translate(r(o+u/2),r(i+u/2)),e.strokeStyle=C[t][n].strokeStyle,e.rotate(C[t][n].rotate),e.beginPath(),F(e,-(s=.5*u),-(l=.075*u)),O(e,-s,l),O(e,-l,l),O(e,-l,s),O(e,l,s),O(e,l,l),O(e,s,l),O(e,s,-l),O(e,l,-l),O(e,l,-s),O(e,-l,-s),O(e,-l,-l),O(e,-s,-l),e.fillStyle=C[t][n].fillColor,e.fill(),e.stroke()}function I(e,t,n,o,i,a){var s=a;e.translate(r(o+s/2),r(i+s/2)),e.strokeStyle=C[t][n].strokeStyle,e.rotate(C[t][n].rotate),e.beginPath(),e.fillStyle=C[t][n].fillColor,e.fillRect(.375*-s,.25*-s,.2*s,.5*s),e.closePath(),e.fill(),e.beginPath(),e.fillStyle=C[t][n].fillColor,e.fillRect(.375*-s,.05*s,.75*s,.2*s),e.closePath(),e.fill(),e.stroke()}function R(e,t,n,r,i,a){var s=a;e.strokeStyle=C[t][n].strokeStyle,e.beginPath(),e.arc(s/2+r,s/2+i,s/2,0,2*o),e.fillStyle=C[t][n].fillColor,e.closePath(),e.fill(),e.stroke()}function k(e,t,n,o,i,a){var s=a;e.strokeStyle=C[t][n].strokeStyle,e.beginPath(),e.translate(o+r(s/2),i+r(s/2)),e.beginPath(),F(e,0,-s/2),O(e,s/2,0),O(e,0,s/2),O(e,-s/2,0),O(e,0,-s/2),e.fillStyle=C[t][n].fillColor,e.closePath(),e.fill(),e.stroke()}function E(e,t,n,o,i,a){var s=r(a);e.translate(o,i),e.strokeStyle=C[t][n].strokeStyle,e.beginPath(),F(e,0,s),O(e,s/2,s-s/2*Math.sqrt(3)),O(e,s,s),O(e,0,s),e.fillStyle=C[t][n].fillColor,e.closePath(),e.fill(),e.stroke()}function D(e,t,n,o,i,a){var s=a;e.strokeStyle=C[t][n].strokeStyle,e.translate(r(s/2+o),r(s/2+i)),e.beginPath(),e.rotate(C[t][n].rotate),F(e,-s/2,-s/5.4),O(e,s/2,-s/5.4),O(e,s/2,s/5.4),O(e,-s/2,s/5.4),O(e,-s/2,-s/5.4),e.fillStyle=C[t][n].fillColor,e.fill(),e.stroke()}function j(e,t,n,o,i,a){e.strokeStyle=C[t][n].strokeStyle;var s=a;e.translate(r(s/2+o),r(s/2+i)),e.beginPath(),F(e,-s/2,-s/3),O(e,s/2,-s/3),O(e,0,s/3),O(e,-s/2,-s/3),e.fillStyle=C[t][n].fillColor,e.fill(),e.stroke()}function _(e,t,n,o,i,a){e.strokeStyle=C[t][n].strokeStyle;var s=a;e.translate(r(s/2+o),r(s/2+i)),e.beginPath(),F(e,-s/2,s/3),O(e,s/2,s/3),O(e,0,-s/3),O(e,-s/2,s/3),e.fillStyle=C[t][n].fillColor,e.fill(),e.stroke()}function O(e,t,n){e.lineTo(r(t)+.5,r(n)+.5)}function F(e,t,n){e.moveTo(r(t)+.5,r(n)+.5)}Object.defineProperty(t,"__esModule",{value:!0}),o=Math.PI,r=Math.round,i=Math.cos,a=Math.sin,C=[[{strokeStyle:l="#326f5b",fillColor:u="#76a797",fillColor2:"",rotate:o},{strokeStyle:c="#A4802b",fillColor:f="#EAC282",fillColor2:"",rotate:-.5*o},{strokeStyle:h="#9E381C",fillColor:p="#D86344",fillColor2:"",rotate:0}],[{strokeStyle:d="#646262",fillColor:g="#808080",fillColor2:"",rotate:o},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:-.5*o},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"",rotate:o}],[{strokeStyle:c,fillColor:"#FFFFFF",fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:y="#303030",fillColor:v="#505050",fillColor2:"#d86344",rotate:0},{strokeStyle:y,fillColor:v,fillColor2:"#eac282",rotate:0},{strokeStyle:y,fillColor:v,fillColor2:u,rotate:0}],[{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:p,fillColor2:"white",rotate:.25*o},{strokeStyle:c,fillColor:f,fillColor2:"white",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"white",rotate:-.25*o}],[{strokeStyle:h,fillColor:p,fillColor2:"",rotate:.25*o},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"",rotate:-.25*o}],[{strokeStyle:l,fillColor:u,fillColor2:"",rotate:o},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:-.75*o},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:-.25*o},{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:d,fillColor:g,fillColor2:"",rotate:o},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:-.75*o},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:-.25*o},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:0}],[{strokeStyle:m="#353535",fillColor:v,fillColor2:"",rotate:0},{strokeStyle:g,fillColor:"#b1b1b1",fillColor2:"",rotate:0},{strokeStyle:"#b28578",fillColor:"#edb9ab",fillColor2:"",rotate:0},{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:b="#727272",fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:s="#4d82b8 #4d82b8 #4d82b8 #4d82b8",fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:v,fillColor2:"",rotate:0},{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:l,fillColor:u,fillColor2:"",rotate:o},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:-.75*o},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:-.5*o},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:-.25*o},{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:d,fillColor:g,fillColor2:"",rotate:o},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:-.75*o},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:-.5*o},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:-.25*o},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:0}],[{strokeStyle:b,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:s,fillColor2:"",rotate:0}],[{strokeStyle:v,fillColor:v,fillColor2:"",rotate:2*o},{strokeStyle:v,fillColor:v,fillColor2:"",rotate:.5*o},{strokeStyle:v,fillColor:v,fillColor2:"",rotate:.5*o},{strokeStyle:v,fillColor:v,fillColor2:"",rotate:1*o},{strokeStyle:v,fillColor:v,fillColor2:"",rotate:2*o}],[{strokeStyle:b,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:"#4d82b8 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:s,fillColor2:"",rotate:0}]],t.drawSignal=function(e,t,n,o,i,a){var s,l;e.translate(o,i),e.strokeStyle=C[t][n].strokeStyle,s=C[t][n].fillColor.split(" "),l=r(.2*a),e.fillStyle=s[0],w(e,l+.5,3*l+.5,l,2*l),e.fillStyle=s[1],w(e,2*l+.5,2*l+.5,l,3*l),e.fillStyle=s[2],w(e,3*l+.5,l+.5,l,4*l),e.fillStyle=s[3],w(e,4*l+.5,.5,l,5*l)},t.drawMagicCube=function(e,t,n,o,i,a){var s,l;e.translate(o,i),e.strokeStyle=C[t][n].strokeStyle,s=C[t][n].fillColor.split(" "),e.fillStyle=C[t][n].strokeStyle,l=r(a/2),e.fillStyle=s[0],w(e,.5,.5,l,l),e.fillStyle=s[1],w(e,l+.5,.5,l,l),e.fillStyle=s[2],w(e,.5,l+.5,l,l),e.fillStyle=s[3],w(e,l+.5,l+.5,l,l)},t.drawSector=function(e,t,n,r,i,a){e.translate(r+a/2,i+a/2),e.strokeStyle=C[t][n].strokeStyle,4===n?(e.beginPath(),e.arc(0,0,a/2,0,C[t][n].rotate),e.closePath(),e.fillStyle=C[t][n].fillColor,e.fill(),e.beginPath(),e.arc(0,0,a/2,0,C[t][n].rotate),e.closePath(),e.stroke()):0===n?(e.beginPath(),e.arc(0,0,a/2,0,2*o),e.closePath(),e.fillStyle="white",e.fill(),e.beginPath(),e.arc(0,0,a/2,0,C[t][n].rotate),e.stroke(),e.closePath()):1===n?(e.beginPath(),e.arc(0,0,a/2,0,2*o),e.closePath(),e.fillStyle="white",e.fill(),e.beginPath(),e.moveTo(0,0),e.lineTo(0,-a/2),e.arc(0,0,a/2,.5*-o,0),e.lineTo(0,0),e.closePath(),e.fillStyle=C[t][n].fillColor,e.fill(),e.arc(0,0,a/2,0,2*o),e.stroke()):2===n?(e.beginPath(),e.arc(0,0,a/2,0,2*o),e.closePath(),e.fillStyle="white",e.fill(),e.beginPath(),e.moveTo(0,0),e.lineTo(0,-a/2),e.arc(0,0,a/2,.5*-o,.5*o),e.moveTo(0,0),e.closePath(),e.fillStyle=C[t][n].fillColor,e.fill(),e.arc(0,0,a/2,0,2*o),e.stroke()):3===n&&(e.beginPath(),e.arc(0,0,a/2,0,2*o),e.closePath(),e.fillStyle="white",e.fill(),e.beginPath(),e.moveTo(0,0),e.lineTo(0,-a/2),e.arc(0,0,a/2,.5*-o,o),e.lineTo(0,0),e.fillStyle=C[t][n].fillColor,e.fill(),e.arc(0,0,a/2,0,2*o),e.stroke(),e.closePath())},t.drawStar=function(e,t,n,r,s,l){var u=l/1.8,c=u/2.5;e.translate(u+r,u+s),e.strokeStyle="#727272",e.fillStyle=C[t][n].fillColor,e.beginPath(),2===n&&(e.strokeStyle="#727272",x(e,u,c),e.fill(),e.stroke(),e.strokeStyle=C[t][n].strokeStyle,x(e,u,c),e.stroke(),e.closePath()),0===n&&(e.fillStyle="white",x(e,u,c),e.fill(),e.stroke(),e.strokeStyle="#727272",x(e,u,c),e.stroke(),e.closePath()),1===n&&(e.strokeStyle=C[t][n].fillColor,e.moveTo(0*u,-a(.5*o)*u),e.lineTo(i(.7*o)*c,-a(.7*o)*c),e.lineTo(i(.9*o)*u,-a(.9*o)*u),e.lineTo(i(1.1*o)*c,-a(1.1*o)*c),e.lineTo(i(1.3*o)*u,-a(1.3*o)*u),e.lineTo(0*c,-a(1.5*o)*c),e.fill(),e.stroke(),e.closePath(),e.beginPath(),e.moveTo(0*u,-a(.5*o)*u),e.lineTo(-i(.7*o)*c,-a(.7*o)*c),e.lineTo(-i(.9*o)*u,-a(.9*o)*u),e.lineTo(-i(1.1*o)*c,-a(1.1*o)*c),e.lineTo(-i(1.3*o)*u,-a(1.3*o)*u),e.lineTo(0*c,-a(1.5*o)*c),e.fillStyle="white",e.fill(),e.closePath(),e.beginPath(),e.strokeStyle="#727272",x(e,u,c),e.stroke(),e.closePath())},t.drawIconTypeIsEight=function(e,t,n,o,r,i){2===n?S(e,t,n,o,r,i):0===n?A(e,t,n,o,r,i):1===n&&M(e,t,n,o,r,i)},t.drawIconTypeIsNine=function(e,t,n,o,r,i){2===n?I(e,t,n,o,r,i):0===n?N(e,t,n,o,r,i):1===n&&T(e,t,n,o,r,i)},t.drawFlag=function(e,t,n,o,i,a){var s=1.2*a;e.translate(o,i),e.strokeStyle=g,e.fillStyle=g,w(e,r(.2*s)+.5,.5,r(.06*s),r(.8*s)),e.strokeStyle=C[t][n].strokeStyle,e.beginPath(),F(e,.4*s,.5),O(e,.4*s,.5*s),O(e,.9*s,.25*s),O(e,.4*s,.5),e.fillStyle=C[t][n].fillColor,e.fill(),e.stroke()},t.drawIconTypeIsSen=function(e,t,n,o,r,i){2===n?R(e,t,n,o,r,i):1===n?E(e,t,n,o,r,i):k(e,t,n,o,r,i)},t.drawTrafficLight=function(e,t,n,i,a,s){var l=r(s);e.strokeStyle=C[t][n].strokeStyle,e.fillStyle=C[t][n].fillColor,w(e,i+.5,a+.5,l,l),e.beginPath(),e.arc(l/2+i+.5,l/2+a+.5,.375*l,0,2*o),e.fillStyle=C[t][n].fillColor2,e.fill(),e.stroke()},t.drawCircle=R,t.drawIconTypeIsTwo=function(e,t,n,o,r,i){1===n?D(e,t,n,o,r,i):0===n?j(e,t,n,o,r,i):2===n&&_(e,t,n,o,r,i)},t.drawArrows=function(e,t,n,o,i,a){var s,l,u,c,f=a/3.5,h=C[t].length-1;e.strokeStyle=C[t][h-n].strokeStyle,e.translate(r(1.75*f+o),r(1.75*f+i)),e.rotate(C[t][h-n].rotate),e.beginPath(),s=.25*f,l=1.25*f,F(e,-(u=.75*f),-(c=1.75*f)),O(e,s,-c),O(e,s,s),O(e,l,-u),O(e,l,s),O(e,-s,c),O(e,-c,s),O(e,-c,-u),O(e,-u,s),O(e,-u,-c),e.fillStyle=C[t][h-n].fillColor,e.fill(),e.stroke()}},"./dist/plugins/contextMenu/context-menu-dialog.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=o.Ul.vl,i=o.Go,a=o.GC$,s="gc.command.executed",l=function(e){function t(t,n){var o=e.call(this,t,r(t))||this;return o.Eu=n,o}return u(t,e),t.prototype.Qla=function(e,t,n){var o=this,r=e[0];o.kma&&o.kma.ai&&o.kma.ai(r,t,n,o.Eu)},t.prototype.OT=function(e,t,n,o,r){var i=this,a=i.Sla(n,o);i.kma=e,i.Qla(a,t,r)},t.prototype.Sla=function(t,n){var o=this.yo();return o.css(["left","top"],[t,n]),o.empty(),e.prototype.Ao.call(this),this.QQ(),o},t.prototype.Loa=function(e){var t,n,o,r=this.yo();return"block"!==r.css("display")||((t=r.offset()).top+=document.body.clientTop||0,t.left+=document.body.clientLeft||0,n=e.x,o=e.y,n<t.left||n>r.width()+t.left||o<t.top||o>r.height()+t.top)},t.prototype.QQ=function(){var e=this;e.Eu.bind(s,(function(){e.close()}))},t.prototype.Tla=function(){this.Eu.unbind(s)},t.prototype.close=function(){var t=this;t.kma&&t.kma.no(),t.Tla(),t.vo(t.Cj)&&a("#"+t.Cj).remove(),e.prototype.close.call(this)},t}(i),t.ContextMenuViewDialog=l},"./dist/plugins/contextMenu/context-menu.entry.js":function(e,t,n){"use strict";function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),o(n("./dist/plugins/contextMenu/context-menu.js")),o(n("./dist/plugins/contextMenu/menu-view.js")),o(n("./dist/plugins/contextMenu/context-menu.ns.js"));var r=n("./dist/plugins/contextMenu/context-menu-dialog.js");t.Cyb=r.ContextMenuViewDialog},"./dist/plugins/contextMenu/context-menu.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe,re,ie,ae,se,le,ue,ce,fe,he,pe,de,ge,me,ye,ve,be;function Ce(e){var t,n;if(e.slicers){if(!(t=e.slicers.all())||c(t))return null;for(n in t)if(t[n].isSelected())return!0;return!1}}function we(e,t,n){var o,r,i,a,s="row"===t?"rowCount":"colCount";for(o=0;o<e.length;o++)for(i=-1===(r=e[o])[t]?0:r[t],a=0;a<r[s];a++)n(i+a)}function xe(e,t){var n,o=[],r=-1;for(n=e.row;n<e.row+e.rowCount;n++)!1!==t[n]&&-1===r&&(r=n),!1===t[n]&&-1!==r&&(o.push([r,n-r]),r=-1);return-1!==r&&o.push([r,n-r]),o}function Ae(e,t){var n,o,r,i;if(1===t.colCount&&-1===t.row){if((n=t.col)===e.$q()&&((o=n-1)>=0&&!e.getColumnVisible(o)))return!0}else if(1===t.rowCount&&-1===t.col&&((r=t.row)===e.ar()&&((i=r-1)>=0&&!e.getRowVisible(i))))return!0}function Me(e,t){var n,o,r,i,a,s=[p+O,p+M,p+x,p+A],l=t.name;if(s.indexOf(l)<0)return!0;if(o=(n=e.getActiveSheet()).getActiveRowIndex(),r=n.getActiveColumnIndex(),n.comments){if(n.comments.get(o,r))return l!==p+O;if(l===p+M||l===p+x)return!1;if(l===p+O)return!0;for(i=n.getSelections(),a=0;a<i.length;a++)if(Te(i[a],n))return!0;return!1}}function Se(e,t){var n,o,r,i,a,s;if(t.comments)for(n=t.comments.all(),o=void 0,r=void 0,i=0;i<e.length;i++)for(a=e[i],s=0;s<n.length;s++)if(!n[s].locked()&&(r=n[s].nT,o=n[s].oT,r>=a.row&&r<a.row+a.rowCount&&o>=a.col&&o<a.col+a.colCount))return!0;return!1}function Te(e,t){var n,o,r,i;if(t.comments)for(n=t.comments.all(),o=void 0,r=void 0,i=0;i<n.length;i++)if(r=n[i].nT,o=n[i].oT,r>=e.row&&r<e.row+e.rowCount&&o>=e.col&&o<e.col+e.colCount)return!0;return!1}function Ne(e,t){var n,o,r,i,a;return[p+j,p+_].indexOf(t.name)<0||!(!(o=(n=e.getActiveSheet()).getSelections())||1!==o.length||(r=o[0],i=Re(n,r),i&&(a=i.range(),r.row<a.row||r.col<a.col||r.row+r.rowCount>a.row+a.rowCount||r.col+r.colCount>a.col+a.colCount)))}function Ie(e){var t,n,o,r=e.getActiveRowIndex(),i=e.getActiveColumnIndex();if(!e.tu().UHb)return!1;if(e.tables&&e.tables.find(r,i))return!1;for(t=e._modelManager.getSpans(),n=0;n<t.length;n++)if(r>=(o=t[n]).row&&r<o.row+o.rowCount&&i>=o.col&&i<o.col+o.colCount)return!1;return!0}function Re(e,t){var n,o,r;if(!t)return null;for(n=t.row;n<t.row+t.rowCount;n++)for(o=t.col;o<t.col+t.colCount;o++)if(e.tables&&(r=e.tables.find(n,o)))return r;return null}function ke(e,t,n,o){var r,i;for(r=0;r<t.length;r++)(i=t[r]).PIb(n,o,!0,de,i.nKb())}function Ee(e){var t,n,o,r=e;for(t=0;t<r.length-1;t++)for(n=t+1;n<r.length;n++)r[t].row<r[n].row&&(o=r[t],r[t]=r[n],r[n]=o);return r}function De(e){var t,n,o,r=e;for(t=0;t<r.length-1;t++)for(n=t+1;n<r.length;n++)r[t].col<r[n].col&&(o=r[t],r[t]=r[n],r[n]=o);return r}function je(e,t,n,o){var r=e._modelManager.getSpans(de,3);t>=0?(Oe(e,r,t,o,3),Oe(e,e._modelManager.getSpans(de,2),t,o,2)):n>=0&&(_e(e,r,n,o,3),_e(e,e._modelManager.getSpans(de,1),n,o,1))}function _e(e,t,n,o,r){var i,a,s,l,u,c,f;for(i=0,a=t.length;i<a;i++)if(n>(s=t[i]).col&&n<s.col+s.colCount)for(l=e.getStyle(s.row,s.col,r),u=n;u<n+o;u++)for(c=s.row;c<s.row+s.rowCount;c++)e.setStyle(c,u,l,r),c===s.row+s.rowCount-1&&((f=e.getCell(s.row+s.rowCount-1,s.col).borderBottom())&&e.getCell(c,u).borderBottom(f))}function Oe(e,t,n,o,r){var i,a,s,l,u,c,f;for(i=0,a=t.length;i<a;i++)if(n>=(s=t[i]).row&&n<=s.row+s.rowCount)for(l=e.getStyle(s.row,s.col,r),u=n;u<n+o;u++)for(c=s.col;c<s.col+s.colCount;c++)e.setStyle(u,c,l,r),c===s.col+s.colCount-1&&((f=e.getCell(s.row,s.col+s.colCount-1).borderRight())&&e.getCell(u,c).borderRight(f))}function Fe(e,t,n,o,r){var i,s,l,u,c,f=e.getSheetFromName(t.sheetName);return!!f&&(i=t.considerAllSheets,s=e.sheets,f.suspendPaint(),l=a.Commands.bWa(f.name()),n?(r&&r(f,t),i?a.Commands._xb(s,t):f._modelManager.undo(t[l])):(i?a.Commands.Zxb(s):f._modelManager.startTransaction(),u=o(f,t),i?a.Commands.$xb(s,t):t[l]=f._modelManager.endTransaction()),f.resumePaint(),i&&((c=e.getActiveSheet())&&f!==c&&c.repaint()),u)}function Pe(e,t,n){var o;if(n>0){for(o=t+1;o<e.getRowCount();o++)if((n-=e.getRowHeight(o))<=0)return o-t}else if(n<0)for(o=t-1;o>=0;o--)if((n+=e.getRowHeight(o))>=0)return o-t;return 0}function He(e,t,n,o){var r,i,a=e.getSheetFromName(t.sheetName);a&&(r=a.options.clipBoardOptions,a.options.clipBoardOptions=o,i=function(){a.options.clipBoardOptions=r},n.execute({cmd:G,sheetName:a.name(),callback:i}))}function Be(e,t,n,o){return Fe(e,t,n,(function(e){var t,n=function(e){var t,n,o;if(e.slicers){if(!(t=e.slicers.all())||c(t))return null;for(o in n=[],t)t[o].isSelected()&&n.push(t[o]);return n}}(e);if(n&&0!==n.length)for(t in n)n.hasOwnProperty(t)&&n[t].sortState(o)}))}function Le(e){e.Os(7,me().hideSheetFailureInfo)}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("./dist/plugins/contextMenu/context-menu-dialog.js"),i=n("./dist/plugins/contextMenu/menu-view.js"),a=n("Core"),s=n("./dist/plugins/contextMenu/context-menu.ns.js"),l=a.GC$,u=o.Common.j.Fa,c=o.Common.j.za,f=a.Ul.nl,o.Commands.CommandManager,h="gc.spread.contextMenu.",p="gc.spread.",d="gc-spread-",g="viewport",m="colHeader",y="rowHeader",v="slicer",b="sheetTab",C="corner",w="removeSlicer",x="toggleComment",A="deleteComment",M="editComment",S="unhideSheet",T="hideSheet",N="unhideRows",I="unhideColumns",R="hideRows",k="hideColumns",E="sortAscend",D="sortDescend",j="sort",_="filter",O="insertComment",F="deleteSheet",P="insertSheet",H="insertRows",B="insertColumns",L="deleteRows",z="deleteColumns",V="clearContents",G="paste",W="pasteOptions",U="pasteFormatting",Z="pasteValues",q="pasteFormula",J="pasteAll",Q="cut",Y="copy",K="pasteValuesFormatting",$="pasteFormulaFormatting",X="separator",ee="slicerSortAscend",te="slicerSortDescend",ne="tableInsert",oe="tableDelete",re="tableInsertRowsAbove",ie="tableInsertRowsBelow",ae="tableInsertColumnsLeft",se="tableInsertColumnsRight",le="tableDeleteRows",ue="tableDeleteColumns",ce="insertCopiedCells",fe="insertCutCells",he="shiftCellsDown",pe="shiftCellsRight",de=void 0,ge=new o.Common.ResourceManager(s.SR),me=ge.getResource.bind(ge),ye={sheetTab:function(e,t,n){return RegExp("sheetTab","i").test(n.workArea)&&e.tabStripHitInfo&&e.tabStripHitInfo.sheetTab&&"newSheet"!==e.tabStripHitInfo.sheetTab.sheetName},outline:function(e,t,n){return!!(RegExp("outline","i").test(n.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.outlineHitInfo)},viewport:function(e,t,n){if(RegExp("viewport","i").test(n.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&!e.worksheetHitInfo.floatingObjectHitInfo&&!e.worksheetHitInfo.shapeHitInfo&&!e.worksheetHitInfo.commentHitInfo)return Me(t,n)&&Ne(t,n)&&function(e,t){var n,o;return[p+ce].indexOf(t.name)<0||(n=e.getActiveSheet(),(o=n.tu())&&!o.G4&&o.n5&&1===o.n5.length&&1===n.getSelections().length&&Ie(n))}(t,n)&&function(e,t){var n,o;return[p+fe].indexOf(t.name)<0||(n=e.getActiveSheet(),(o=n.tu())&&o.G4&&o.n5&&1===o.n5.length&&1===n.getSelections().length&&Ie(n))}(t,n)},rowHeader:function(e,t,n){if(RegExp("rowHeader","i").test(n.workArea)&&e.worksheetHitInfo&&2===e.worksheetHitInfo.hitTestType)return function(e,t){var n,o,r,i,a,s,l,u;if([p+y+ce,p+y+fe].indexOf(t.name)<0)return!0;if(n=e.getActiveSheet(),o=n.tu(),r=n.getActiveRowIndex(),n.tables)for(i=n.tables.all(),a=0;a<i.length;a++)if(s=i[a],r>s.cj&&r<s.cj+s.Xj)return!1;for(l=n._modelManager.getSpans(),a=0;a<l.length;a++)if(u=l[a],r>u.row&&r<u.row+u.rowCount)return!1;if(!o.UHb||o.n5&&1!==o.n5.length||1!==n.getSelections().length)return!1;if(t.name===p+y+fe){if(o.G4&&o.n5&&n.getColumnCount()%o.n5[0].colCount==0)return!0}else if(t.name===p+y+ce&&!o.G4&&o.n5&&n.getColumnCount()%o.n5[0].colCount==0)return!0;return!1}(t,n)},colHeader:function(e,t,n){if(RegExp("colHeader","i").test(n.workArea)&&e.worksheetHitInfo&&1===e.worksheetHitInfo.hitTestType)return function(e,t){var n,o,r,i,a,s,l,u;if([p+m+ce,p+m+fe].indexOf(t.name)<0)return!0;if(n=e.getActiveSheet(),o=n.tu(),r=n.getActiveColumnIndex(),n.tables)for(i=n.tables.all(),a=0;a<i.length;a++)if(s=i[a],r>s.dj&&r<s.dj+s.OZ)return!1;for(l=n._modelManager.getSpans(),a=0;a<l.length;a++)if(u=l[a],r>u.col&&r<u.col+u.colCount)return!1;if(!o.UHb||o.n5&&1!==o.n5.length||1!==n.getSelections().length)return!1;if(t.name===p+m+ce){if(!o.G4&&o.n5&&n.getRowCount()%o.n5[0].rowCount==0)return!0}else if(t.name===p+m+fe&&o.G4&&o.n5&&n.getRowCount()%o.n5[0].rowCount==0)return!0;return!1}(t,n)},corner:function(e,t,n){if(RegExp("corner","i").test(n.workArea)&&e.worksheetHitInfo&&0===e.worksheetHitInfo.hitTestType)return Me(t,n)&&Ne(t,n)},slicer:function(e,t,n){return RegExp("slicer","i").test(n.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.floatingObjectHitInfo&&e.worksheetHitInfo.floatingObjectHitInfo.floatingObject&&"Slicer"===e.worksheetHitInfo.floatingObjectHitInfo.floatingObject.typeName},chart:function(e,t,n){return RegExp("chart","i").test(n.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.floatingObjectHitInfo&&e.worksheetHitInfo.floatingObjectHitInfo.floatingObject&&"2"===e.worksheetHitInfo.floatingObjectHitInfo.floatingObject.typeName},shape:function(e,t,n){return RegExp("shape","i").test(n.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.shapeHitInfo},table:function(e,t,n){var o=t.getActiveSheet().tables;return RegExp("table","i").test(n.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&o&&o.mKb()},vpWithoutTb:function(e,t,n){if(RegExp("vpWithoutTb","i").test(n.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&!e.worksheetHitInfo.floatingObjectHitInfo&&!e.worksheetHitInfo.shapeHitInfo&&!e.worksheetHitInfo.commentHitInfo){var o=t.getActiveSheet().tables;return!(o&&o.mKb())&&Me(t,n)&&Ne(t,n)}}},ve=[],be=function(){function e(){this.menuView=new i.MenuView,this.menuData=[{text:me().copy,name:p+Y,command:h+Y,iconClass:d+Y,workArea:g+m+y+v+C},{text:me().cut,name:p+Q,command:h+Q,iconClass:d+Q,workArea:g+m+y+v+C},{text:me().pasteOptions,name:p+W,iconClass:d+W,type:"groupHeader",workArea:g+m+y+v+C},{command:h+J,name:p+J,iconClass:d+J,group:p+W,text:me().pasteAll,workArea:g+m+y+v+C},{command:h+q,name:p+q,iconClass:d+q,group:p+W,text:me().pasteFormula,workArea:g+m+y+C},{command:h+Z,name:p+Z,iconClass:d+Z,group:p+W,text:me().pasteValues,workArea:g+m+y+C},{command:h+U,name:p+U,iconClass:d+U,group:p+W,text:me().pasteFormatting,workArea:g+m+y+C},{command:h+K,name:p+K,iconClass:d+K,group:p+W,text:me().pasteValuesFormatting,workArea:g+m+y+C},{command:h+$,name:p+$,iconClass:d+$,group:p+W,text:me().pasteFormulaFormatting,workArea:g+m+y+C},{type:X},{text:me().clearContents,command:h+V,name:p+V,workArea:g+m+y+C},{type:X},{text:me().headerInsertCopiedCells,name:p+y+ce,command:h+y+ce,workArea:y},{text:me().headerInsertCutCells,name:p+y+fe,command:h+y+fe,workArea:y},{text:me().headerInsertCopiedCells,name:p+m+ce,command:h+m+ce,workArea:m},{text:me().headerInsertCutCells,name:p+m+fe,command:h+m+fe,workArea:m},{text:me().insertCopiedCells,name:p+ce,subMenu:[{text:me().shiftCellsRight,name:p+ce+pe,command:h+ce+pe,iconClass:d+pe},{text:me().shiftCellsDown,name:p+ce+he,command:h+ce+he,iconClass:d+he}],workArea:g},{text:me().insertCutCells,name:p+fe,subMenu:[{text:me().shiftCellsRight,name:p+fe+pe,command:h+fe+pe,iconClass:d+pe},{text:me().shiftCellsDown,name:p+fe+he,command:h+fe+he,iconClass:d+he}],workArea:g},{text:me().insertRows,name:p+H,command:h+H,workArea:y},{text:me().insertColumns,name:p+B,command:h+B,workArea:m},{text:me().deleteRows,name:p+L,command:h+L,workArea:y},{text:me().deleteColumns,name:p+z,command:h+z,workArea:m},{type:X},{text:me().tableInsert,name:p+ne,subMenu:[{text:me().tableInsertColumnsLeft,name:p+ae,command:"tableInsertColumnsLeftForContextMenu",iconClass:d+ae},{text:me().tableInsertColumnsRight,name:p+se,command:"tableInsertColumnsRightForContextMenu",iconClass:d+se},{text:me().tableInsertRowsAbove,name:p+re,command:"tableInsertRowsAboveForContextMenu",iconClass:d+re},{text:me().tableInsertRowsBelow,name:p+ie,command:"tableInsertRowsBelowForContextMenu",iconClass:d+ie}],workArea:"table"},{text:me().tableDelete,name:p+oe,subMenu:[{text:me().tableDeleteColumns,name:p+ue,command:"tableDeleteColumnsForContextMenu",iconClass:d+ue},{text:me().tableDeleteRows,name:p+le,command:"tableDeleteRowsForContextMenu",iconClass:d+le}],workArea:"table"},{type:X},{text:me().insertSheet,name:p+P,command:h+P,workArea:b},{text:me().deleteSheet,name:p+F,command:h+F,workArea:b},{type:X},{text:me().filter,name:p+_,command:h+_,workArea:g+C},{text:me().sort,name:p+j,subMenu:[{text:me().sortAscend,name:p+E,command:h+E,iconClass:d+E},{text:me().sortDescend,name:p+D,command:h+D,iconClass:d+D}],workArea:g+C},{text:me().slicerSortAscend,name:p+ee,command:h+ee,iconClass:d+E,workArea:v},{text:me().slicerSortDescend,name:p+te,command:h+te,iconClass:d+D,workArea:v},{type:X},{text:me().insertComment,name:p+O,command:h+O,iconClass:d+O,workArea:g+C},{text:me().editComment,name:p+M,command:h+M,iconClass:d+M,workArea:g+C},{text:me().deleteComment,name:p+A,command:h+A,iconClass:d+A,workArea:g+C},{text:me().toggleComment,name:p+x,command:h+x,workArea:g+C},{type:X},{text:me().hideRows,name:p+R,command:h+R,workArea:y},{text:me().unhideRows,name:p+N,command:h+N,workArea:y},{text:me().hideColumns,name:p+k,command:h+k,workArea:m},{text:me().unhideColumns,name:p+I,command:h+I,workArea:m},{type:X},{text:me().hideSheet,name:p+T,command:h+T,workArea:b},{text:me().unhideSheet,name:p+S,command:h+S,workArea:b},{type:X},{text:me().removeSlicer,name:p+w,command:h+w,workArea:v}]}return e.prototype.ad=function(e){var t=this;t.Mma||(t.wu=e.commandManager(),u(t.Ela)&&(t.Ela=new r.ContextMenuViewDialog(e.xv(),l(e.sv))),t.nla(e),t.kTa={filter:{menuDataDict:[p+_],checkFunction:function(e){if(e.rowFilter)return!0}},comments:{menuDataDict:[p+O,p+M,p+A,p+x],checkFunction:function(e){if(e.comments)return!0}},slicer:{menuDataDict:[p+ee,p+te,p+w],checkFunction:function(e){if(e.slicers)return!0}},floatingObject:{menuDataDict:[p+Z,p+U,p+q],checkFunction:function(e){var t;return!e.BR||(!((t=e.BR().fromSheet)&&t.CR)||void 0)}},table:{menuDataDict:[p+ne,p+oe],checkFunction:function(e){if(e.tables)return!0}}},t.Mma=!0)},e.prototype.ola=function(e,t){var n,o,r,i,a,s=this;return t.focus(),n=s.pla(e,t),o=t.getActiveSheet(),u(n)||u(o)?void f(e):(r={row:o.getActiveRowIndex(),col:o.getActiveColumnIndex()},void(o.isEditing()&&n.worksheetHitInfo&&n.worksheetHitInfo.col===r.col&&n.worksheetHitInfo.row===r.row||t.getTab()&&t.getTab().FD||(s.ad(t),s.qla(n,t),i=s.Fla(s.menuData,n,t),a=s.onOpenMenu(s.menuData,i,n,t),a||(f(e),i.length&&s.jla(i,n,t)))))},e.prototype.qla=function(e,t){this.Ela.Loa(e)&&this.sla(e,t)},e.prototype.sla=function(e,t){var n=this,o=t.getActiveSheet();o.isEditing()&&o.endEdit(),n.tla(e)?n.ula(e,t):n.vla(e)&&n.wla(e,t)},e.prototype.vla=function(e){return!!e.worksheetHitInfo},e.prototype.xla=function(e,t,n,o){var r,i,a=!0;if(1===o){for(r=0;r<e.length;r++)-1===(i=e[r]).row&&n>=i.col&&n<i.col+i.colCount&&(a=!1);return a}if(2===o){for(r=0;r<e.length;r++)-1===(i=e[r]).col&&t>=i.row&&t<i.row+i.rowCount&&(a=!1);return a}for(r=0;r<e.length;r++)if((i=e[r]).contains(t,n))return!1;return!0},e.prototype.tla=function(e){return!(!e.tabStripHitInfo||!e.tabStripHitInfo.sheetTab)},e.prototype.yla=function(e){return e.tabStripHitInfo.sheetTab.sheetName},e.prototype.wla=function(e,t){var n=t.getActiveSheet(),o=e.worksheetHitInfo;o.floatingObjectHitInfo||o.commentHitInfo||o.shapeHitInfo||(this.Ala(n,o),this.aPa(n))},e.prototype.aPa=function(e){var t,n=e.getActiveRowIndex(),o=e.getActiveColumnIndex(),r=e.comments;r&&((t=r.get(n,o))&&r.bU===t&&r.hT(t))},e.prototype.zla=function(e){return 3===e.hitTestType},e.prototype.cs=function(e,t,n){e.cs&&e.cs(t,n)},e.prototype.Ala=function(e,t){var n=e._modelManager.getSelections(),o=t.row,r=t.col;this.xla(n,o,r,t.hitTestType)&&e.Qs(t.rowViewportIndex<0?-1:t.row,t.colViewportIndex<0?-1:t.col)&&(e._eventHandler.Ala(e,t,o,r),e._eventHandler.hH())},e.prototype.ula=function(e,t){var n=this.yla(e),o=t.getSheetIndex(n),r=t.sheets[o];r&&(r.isSelected()||(t.sheets.forEach((function(e){e.isSelected()&&e.DHb(!1,!0)})),t.hq&&t.hq.BHb(t,r,!1,!0,r.name(),o)),t.dq(o,2,!1,!0),this.$Oa(this.menuData,e,t))},e.prototype.pla=function(e,t){var n=t.oia(),o=e.pageX-n.left,r=e.pageY-n.top;return t.hitTest(o,r,!0)},e.prototype.onOpenMenu=function(e,t,n,o){},e.prototype.jla=function(e,t,n){var o=this;o.Ela.Loa(t)&&(o.Cla(),o.Dla(e,t,n))},e.prototype.Cla=function(){this.Ela.close()},e.prototype.Dla=function(e,t,n){this.Ela.OT(this.menuView,e,t.x,t.y,n)},e.prototype.Fla=function(e,t,n){var o=this,r=[],i={};return l.extend(!0,i,e),l.each(i,(function(e,o){u(o)||(o.type===X&&r.push(o),l.each(ye,(function(e,i){i(t,n,o)&&r.push(o)})))})),o.J$a(r,t),o.lTa(r,n),o.oKb(r,n),o.UZa(r,n),o.RZa(r),r=o.Bma(r),o.pKb(r),r},e.prototype.pKb=function(e){var t,n,o=0,r=!1;for(t=0;t<e.length&&((n=e[t].name)!==p+y+ce&&n!==p+y+fe&&n!==p+m+ce&&n!==p+m+fe||(r=!0),n!==p+H&&n!==p+B||(o=t,!r));t++);r&&e.splice(o,1)},e.prototype.J$a=function(e,t){var n=t.worksheetHitInfo;n&&(n.row===de||n.col===de)&&e.splice(0,e.length)},e.prototype.lTa=function(e,t){var n=this,o=t.getActiveSheet(),r=n.kTa;return l.each(r,(function(t,r){var i,a,s;if(!r.checkFunction(o))for(a=0,s=(i=r.menuDataDict).length;a<s;a++)n.hma(e,i[a],(function(e,t){e[t]=null}))})),e},e.prototype.oKb=function(e,t){var n,o,r,i=t.getActiveSheet(),a=i.getSelections();a&&a.length>0&&(n=Re(i,a[0]),o=i.getActiveRowIndex(),r=i.getActiveColumnIndex(),n&&l.each(e,(function(e,t){if(!u(t)&&t.name===p+ne){var i=t.subMenu;n.checkTableLastRow(o)&&i.splice(3,1),n.checkTableLastCol(r)&&i.splice(1,1)}})))},e.prototype.RZa=function(e){var t;for(t=e.length-1;t>0;t--)e[t]?e[t].subMenu&&this.RZa(e[t].subMenu):e.splice(t,1);return e},e.prototype.Bma=function(e){var t,n,o,r,i,a=[],s=e.length;for(t=0;t<s;t++)e[t]&&e[t].type===X&&e[t+1]&&e[t+1].type===X||a.push(e[t]);for(s=a.length,n=0,o=0,r=!0,i=!0,t=0;t<s&&(r&&a[t].type===X?n++:r=!1,i&&a[s-1-t].type===X?o++:i=!1,r||i);t++);return a.splice(s-o,o),a.splice(0,n),a},e.prototype.UZa=function(e,t){this.VZa(e,t),this.QZa(e,t)},e.prototype.VZa=function(e,t){var n,o=t.getActiveSheet(),r=o.tables;for(n=0;n<e.length;n++)if(e[n]){switch(e[n].name){case p+H:o.ZZa()||(e[n].disable=!0);break;case p+L:(!o.ZZa()||r&&r.containTableHeaderTotalRowForSheet())&&(e[n].disable=!0);break;case p+B:case p+z:o.$Za()||(e[n].disable=!0);break;case p+re:r&&(r.isAcrossTables()||r.containTableHeader()||r.noRoomToInsertRow())&&(e[n].disable=!0);break;case p+ie:r&&(r.isAcrossTables()||r.noRoomToInsertRow())&&(e[n].disable=!0);break;case p+le:r&&(r.checkTableRow()||r.isAcrossTables()||r.containTableHeaderTotalRow())&&(e[n].disable=!0);break;case p+ae:case p+se:r&&(r.isAcrossTables()||r.noRoomToInsertColumn())&&(e[n].disable=!0);break;case p+ue:r&&(r.checkTableCol()||r.isAcrossTables()||r.isWholeTableCol())&&(e[n].disable=!0)}e[n]&&e[n].subMenu&&this.VZa(e[n].subMenu,t)}},e.prototype.QZa=function(e,t){var n,o,r,i,a=t.getActiveSheet(),s=a.options.isProtected,l=a.options.protectionOptions;if(s&&l)for(n=void 0,o=0;o<e.length;o++)if(e[o]){switch(e[o].name){case p+H:l.allowInsertRows||(e[o].disable=!0);break;case p+B:l.allowInsertColumns||(e[o].disable=!0);break;case p+L:l.allowDeleteRows||(e[o].disable=!0);break;case p+z:l.allowDeleteColumns||(e[o].disable=!0);break;case p+_:l.allowFilter||(e[o].disable=!0);break;case p+E:case p+D:l.allowSort||(e[o].disable=!0);break;case p+R:case p+N:case p+k:case p+I:e[o].disable=!0;break;case p+ee:case p+te:l.allowEditObjects||e.splice(0,e.length);break;case p+O:l.allowEditObjects||(e[o]=null);break;case p+M:r=void 0,a.comments&&(r=(n=a.comments.get(a.getActiveRowIndex(),a.getActiveColumnIndex()))&&n.lockText()),!l.allowEditObjects&&r&&(e[o]=null);break;case p+A:i=void 0,a.comments&&(i=!Se(a.getSelections(),a)),!l.allowEditObjects&&i&&(e[o]=null);break;case p+re:case p+ie:case p+ae:case p+se:case p+le:case p+ue:e[o].disable=!0}e[o]&&e[o].subMenu&&this.QZa(e[o].subMenu,t)}},e.prototype.$Oa=function(e,t,n){var o,r,i;if(t.tabStripHitInfo&&(this,o=n.sheets,r=this.RS(p+S))){for(i=0;i<o.length;i++)if(!o[i].visible())return void(r.disable=!1);r.disable=!0}},e.prototype.RS=function(e){return this.gma(this.menuData,e)},e.prototype.gma=function(e,t){var n;return this.hma(e,t,(function(e,t){n=e[t]})),n},e.prototype.hma=function(e,t,n){for(var o=e.length,r=0;r<o;r++)if(!u(e[r])){if(t===e[r].name)return void n(e,r);e[r].subMenu&&this.hma(e[r].subMenu,t,n)}},e.prototype.nla=function(e){var t,n,o,r,i,s,l,f,p,d,g,v,b,C,j,W,X,ne,oe,re,ie,ae,se,le,ue,ge,me,ye,be,Me,Se,Te,Ne=e.commandManager(),Ie={canUndo:!1,execute:function(e,t){var n=e.getSheetFromName(t.sheetName);n&&(Ce(n)?Ne.execute({cmd:"copyFloatingObjects",sheetName:n.name()}):Ne.execute({cmd:Y,sheetName:n.name(),ignoreClipboard:!0}))}};Ne.register(h+Y,Ie,null,!1,!1,!1,!1),t={canUndo:!1,execute:function(e,t){var n=e.getSheetFromName(t.sheetName);n&&(Ce(n)?Ne.execute({cmd:"cutFloatingObjects",sheetName:n.name()}):Ne.execute({cmd:Q,sheetName:n.name(),ignoreClipboard:!0}))}},Ne.register(h+Q,t,null,!1,!1,!1,!1),n={canUndo:!1,execute:function(e,t){var n,o,r=e.getSheetFromName(t.sheetName);r&&(r.isPasteFloatingObject&&r.isPasteFloatingObject()?Ne.execute({cmd:"pasteFloatingObjects",sheetName:r.name()}):r.isPasteShapes&&r.isPasteShapes()?Ne.execute({cmd:"pasteShapes",sheetName:r.name()}):(n=r.options.clipBoardOptions,r.options.clipBoardOptions=0,o=function(){r.options.clipBoardOptions=n},Ne.execute({cmd:G,sheetName:r.name(),callback:o})))}},Ne.register(h+J,n,null,!1,!1,!1,!1),o={canUndo:!1,execute:function(e,t){var n,o,r=e.getSheetFromName(t.sheetName);r&&(n=r.options.clipBoardOptions,r.options.clipBoardOptions=0,o=function(){r.options.clipBoardOptions=n},Ne.execute({cmd:G,sheetName:r.name(),callback:o,shiftCells:a.InsertShiftCell.right}))}},Ne.register(h+ce+pe,o,null,!1,!1,!1,!1),Ne.register(h+fe+pe,o,null,!1,!1,!1,!1),Ne.register(h+m+ce,o,null,!1,!1,!1,!1),Ne.register(h+m+fe,o,null,!1,!1,!1,!1),r={canUndo:!1,execute:function(e,t){var n,o,r=e.getSheetFromName(t.sheetName);r&&(n=r.options.clipBoardOptions,r.options.clipBoardOptions=0,o=function(){r.options.clipBoardOptions=n},Ne.execute({cmd:G,sheetName:r.name(),callback:o,shiftCells:a.InsertShiftCell.down}))}},Ne.register(h+ce+he,r,null,!1,!1,!1,!1),Ne.register(h+fe+he,r,null,!1,!1,!1,!1),Ne.register(h+y+ce,r,null,!1,!1,!1,!1),Ne.register(h+y+fe,r,null,!1,!1,!1,!1),i={canUndo:!1,execute:function(e,t){He(e,t,Ne,3)}},Ne.register(h+q,i,null,!1,!1,!1,!1),s={canUndo:!1,execute:function(e,t){He(e,t,Ne,1)}},Ne.register(h+Z,s,null,!1,!1,!1,!1),l={canUndo:!1,execute:function(e,t){var n,o,r=e.getSheetFromName(t.sheetName);r&&(n=r.options.clipBoardOptions,r.options.clipBoardOptions=2,o=function(){r.options.clipBoardOptions=n},Ne.execute({cmd:G,sheetName:r.name(),callback:o}))}},Ne.register(h+U,l,null,!1,!1,!1,!1),f={canUndo:!1,execute:function(e,t){He(e,t,Ne,4)}},Ne.register(h+K,f,null,!1,!1,!1,!1),p={canUndo:!1,execute:function(e,t){He(e,t,Ne,5)}},Ne.register(h+$,p,null,!1,!1,!1,!1),d={canUndo:!1,execute:function(e,t){var n=e.getSheetFromName(t.sheetName);n&&Ne.execute({cmd:"clear",sheetName:n.name()})}},Ne.register(h+V,d,null,!1,!1,!1,!1),g={canUndo:!0,execute:function(e,t,n){return Fe(e,t,n,(function(t,n){var o,r,i,a,s,l,u,c,f,h,p,d,g=n.commentState||2,m=n.displayMode,y=n.activeRow,v=n.activeCol,b=t.comments.add(y,v,"");b&&(b.commentState(g),m&&b.displayMode(m),o=t.Er(y),r=t.Fr(v),i=t.getCellRect(y,v,o,r),a=t.am().Ft(o,r),s=b.location(),l=b.width(),u=b.height(),c=void 0,f=void 0,h=void 0,p=void 0,d=e.ku,i.y+s.y<a.y?(h=Pe(t,y,i.y+s.y-a.y),c=d.ms(t,h),d.ju(c.cj,0),t.os()):i.y+s.y+u>a.y+a.height&&(h=Pe(t,y,i.y+s.y+u-(a.y+a.height)),c=d.ms(t,h),d.ju(c.cj,0),t.os()),i.x+s.x+l>a.x+a.width&&(p=function(e,t,n){var o;if(n>0){for(o=t+1;o<e.getColumnCount();o++)if((n-=e.getColumnWidth(o))<=0)return o-t}else if(n<0)for(o=t-1;o>=0;o--)if((n+=e.getColumnWidth(o))>=0)return o-t;return 0}(t,v,i.x+s.x+l-(a.x+a.width)),f=d.Sw(t,p),d.lu(f.dj,0),t.qs()))}),(function(e,t){var n=t.activeRow,o=t.activeCol,r=e.comments.get(n,o);r&&(t.displayMode=r.displayMode(),t.commentState=r.commentState())}))}},Ne.register(h+O,g,null,!1,!1,!1,!1),v={canUndo:!1,execute:function(e,t){var n,o,r,i=e.getSheetFromName(t.sheetName);i&&(n=t.activeRow,o=t.activeCol,(r=i.comments.get(n,o))&&r.commentState(2))}},Ne.register(h+M,v,null,!1,!1,!1,!1),b={canUndo:!0,execute:function(e,t,n){return Fe(e,t,n,(function(e){var n,o,r,i,a,s=t.selections,l=s.length;if(!(l<=0))for(n=0;n<l;n++)for(r=(o=s[n]).row;r<o.row+o.rowCount;r++)for(i=o.col;i<o.col+o.colCount;i++)!(a=e.comments.get(r,i))||e.options.isProtected&&!e.options.protectionOptions.allowEditObjects&&a.locked()||Ne.execute({cmd:A,sheetName:e.name(),row:a.nT,col:a.oT})}))}},Ne.register(h+A,b,null,!1,!1,!1,!1),C={canUndo:!1,execute:function(e,t){var n,o,r,i=e.getSheetFromName(t.sheetName);i&&(n=t.activeRow,o=t.activeCol,(r=i.comments.get(n,o))&&(2===r.displayMode()?r.displayMode(1):r.displayMode(2)))}},Ne.register(h+x,C,null,!1,!1,!1,!1),j={canUndo:!0,execute:function(e,t,n){return t.considerAllSheets=!0,Fe(e,t,n,(function(e){var n,o,r,i,a,s,l,u,c,f,h,p=Ee(t.selections);for(o=0;o<p.length;o++){for(n=p[o],r=e.getRange(n.row-1,0,1,n.colCount),i=[],a=0;a<r.colCount;a++)e.getCell(r.row,a).locked()||i.push(a);for(s=n.row,l=n.rowCount,e.addRows(s,l),u=0;u<i.length;u++)for(c=p[o].row;c<p[o].row+p[o].rowCount;c++)e.getCell(c,i[u]).locked(!1);if(e.tables&&l>0)for(f=e.tables.s$(s,-1,l,-1),h=0;h<f.length;h++)f[h].PIb(s,l,!1,!1);je(e,s,-1,l)}}))}},Ne.register(h+H,j,null,!1,!1,!1,!1),W={canUndo:!0,execute:function(e,t,n){return t.considerAllSheets=!0,Fe(e,t,n,(function(e){var n,o,r,i,a,s,l,u,c,f,h,p=De(t.selections);for(o=0;o<p.length;o++){for(n=p[o],r=e.getRange(0,n.col-1,n.rowCount,1),i=[],a=0;a<r.rowCount;a++)e.getCell(a,r.col).locked()||i.push(a);for(s=n.col,l=n.colCount,e.addColumns(s,l),u=0;u<i.length;u++)for(c=s;c<s+l;c++)e.getCell(i[u],c).locked(!1);if(e.tables&&l>0)for(f=e.tables.s$(-1,s,-1,l),h=0;h<f.length;h++)f[h].QIb(s,l,!1,!1);je(e,-1,s,l)}}))}},Ne.register(h+B,W,null,!1,!1,!1,!1),X={canUndo:!0,execute:function(e,t,n){return t.considerAllSheets=!0,Fe(e,t,n,(function(e){var n,o,r,i,a,s,l,u,c=Ee(t.selections),f=e.filterRowsVisibleInfo&&e.filterRowsVisibleInfo.rowsVisibleInfo,h=f&&Object.keys(f).length>0;for(n=0;n<c.length;n++)if(r=(o=c[n]).row,i=o.rowCount,a=e.getRowCount(),h)for(l=(s=xe(o,f)).length-1;l>=0;l--)r=s[l][0],i=s[l][1],u=e.tables&&e.tables.s$(r,-1,i,-1),e.deleteRows(r,i),u.length>0&&a-e.getRowCount()>0&&(a=e.getRowCount(),ke(0,u,r,i));else u=e.tables&&e.tables.s$(r,-1,i,-1),e.deleteRows(r,i),u.length>0&&a-e.getRowCount()>0&&ke(0,u,r,i)}))}},Ne.register(h+L,X,null,!1,!1,!1,!1),ne={canUndo:!0,execute:function(e,t,n){return t.considerAllSheets=!0,Fe(e,t,n,(function(e){var n,o,r,i,a,s,l=De(t.selections);for(n=0;n<l.length;n++)if(o=e.getColumnCount(),r=l[n].col,i=l[n].colCount,a=void 0,e.tables&&(a=e.tables.s$(-1,r,-1,i)),e.deleteColumns(r,i),e.tables&&o-e.getColumnCount()>0)for(s=0;s<a.length;s++)a[s].QIb(r,i,!0)}))}},Ne.register(h+z,ne,null,!1,!1,!1,!1),oe={canUndo:!1,execute:function(t){var n,o,r=t.getActiveSheetIndex(),i=[],s=t.getActiveSheet(),l=t.vv(t._getDefaultSheetName(r));t.sheets.forEach((function(e){e.DHb()&&i.push(e)})),i.forEach((function(e){e.DHb(!1,!0)})),n={sheetName:l.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:r},t.Wq(a.Events.SheetChanging,n),n.cancel||(t.ow(r,2,l),o=l.name(),t.hq&&t.hq.BHb(e,l,!1,!0,o,t.getSheetIndex(o)),t.Wq(a.Events.SheetChanged,{sheetName:l.name(),propertyName:"insertSheet",sheetIndex:r}),t.Wq(a.Events.ActiveSheetChanged,{oldSheet:s,newSheet:l}))}},Ne.register(h+P,oe,null,!1,!1,!1,!1),re={canUndo:!1,execute:function(t){var n,o,r,i,s=t.getActiveSheet();t.getSheetCount()>1?(n=[],o=[],t.sheets.forEach((function(e,t){if(e.DHb()){var r=e.name();n.push(r),o.push(t)}})),n.length!==t.sheets.length?n.length>=1&&(n.forEach((function(e,n){var r,i=o[n],s=t.getSheetFromName(e),l={sheetName:e,propertyName:"deleteSheet",cancel:!1,sheetIndex:i};t.Wq(a.Events.SheetChanging,l),l.cancel||(t.removeSheet(t.getSheetIndex(e)),t.Wq(a.Events.SheetChanged,{sheetName:e,propertyName:"deleteSheet",sheetIndex:i}),s===(r=t.getActiveSheet())&&t.Wq(a.Events.ActiveSheetChanged,{oldSheet:s,newSheet:r}))})),i=(r=t.getActiveSheet()).name(),r.isSelected()||t.hq&&t.hq.BHb(e,r,!1,!0,i,t.getSheetIndex(i))):Le(s)):Le(s),t.undoManager().clear()}},Ne.register(h+F,re,null,!1,!1,!1,!1),ie={canUndo:!0,execute:function(e,t,n){return Fe(e,t,n,(function(e){var n,o=t.selections[0],r=Re(e,o),i=t.activeRow,a=t.activeCol;r?r.range().contains(i,a,1,1)&&(n=r.name(),Ne.execute({cmd:"contextmenuFilterForTable",sheetName:e.name(),cmdOption:{tableName:n,activeRow:i,activeCol:a,expectedText:e.getText(i,a)}})):e.rowFilter&&Ne.execute({cmd:"contextmenuFilterForSheet",sheetName:e.name(),cmdOption:{activeRow:i,activeCol:a,selection:o,expectedText:e.getText(i,a)}})}))}},Ne.register(h+_,ie,null,!1,!1,!1,!1),ae={canUndo:!0,execute:function(e,t,n){return Fe(e,t,n,(function(e){var n=t.activeCol,o=t.selections,r=Re(e,o[0]),i=r?r.dataRange():o[0],s=e.oec(i,!0,null),l={sheet:e,sheetName:e.name(),col:n,ascending:!0,range:i,compareFunction:de,groupSort:s.groupSort,ignoreHidden:s.ignoreHidden,cancel:!1};e.Wq(a.Events.RangeSorting,l),!1===l.cancel&&(e.sortRange(i.row,i.col,i.rowCount,i.colCount,!0,[{index:n,ascending:!0,compareFunction:l.compareFunction}],{groupSort:l.groupSort,ignoreHidden:l.ignoreHidden},de,!!r),e.Wq(a.Events.RangeSorted,l))}))}},Ne.register(h+E,ae,null,!1,!1,!1,!1),se={canUndo:!0,execute:function(e,t,n){return Fe(e,t,n,(function(e){var n=t.activeCol,o=t.selections,r=Re(e,o[0]),i=r?r.dataRange():o[0],s=e.oec(i,!0,null),l={sheet:e,sheetName:e.name(),col:n,ascending:!1,range:i,compareFunction:de,groupSort:s.groupSort,ignoreHidden:s.ignoreHidden,cancel:!1};e.Wq(a.Events.RangeSorting,l),!1===l.cancel&&(e.sortRange(i.row,i.col,i.rowCount,i.colCount,!0,[{index:n,ascending:!1,compareFunction:l.compareFunction}],{groupSort:l.groupSort,ignoreHidden:l.ignoreHidden},de,!!r),e.Wq(a.Events.RangeSorted,l))}))}},Ne.register(h+D,se,null,!1,!1,!1,!1),le={canUndo:!0,execute:function(e,t,n){return Be(e,t,n,1)}},Ne.register(h+ee,le,null,!1,!1,!1,!1),ue={canUndo:!0,execute:function(e,t,n){return Be(e,t,n,2)}},Ne.register(h+te,ue,null,!1,!1,!1,!1),ge={canUndo:!0,execute:function(e,t,n){return Fe(e,t,n,(function(e){we(t.selections,"row",(function(t){e.setRowVisible(t,!1)}))}))}},Ne.register(h+R,ge,null,!1,!1,!1,!1),me={canUndo:!0,execute:function(e,t,n){return Fe(e,t,n,(function(e){we(t.selections,"col",(function(t){e.setColumnVisible(t,!1)}))}))}},Ne.register(h+k,me,null,!1,!1,!1,!1),ye={canUndo:!1,execute:function(e){var t,n,o,r,i,s,l,u,c,f,h,p,d,g=0;if(e.sheets.forEach((function(e){e.visible()&&(g+=1)})),t=e.getActiveSheet(),g<=1)Le(t);else{if(o=[],e.sheets.forEach((function(e){e.DHb()&&o.push(e)})),g!==o.length){for(r=0;r<o.length;r++)u={sheetName:s=(i=o[r]).name(),propertyName:"isVisible",cancel:!1,sheetIndex:l=e.getSheetIndex(s),oldValue:!0,newValue:!1},e.Wq(a.Events.SheetChanging,u),u.cancel||(i.DHb(!1,!0),ve.push(i),i.visible(!1),c=e.getActiveSheet(),r!==o.length-1||c.isSelected()||(n={oldValue:!1,newValue:!0,sheetName:f=c.name(),propertyName:"isSelected",cancel:!1,sheetIndex:e.getSheetIndex(f)},e.Wq(a.Events.SheetChanging,n)),e.Wq(a.Events.SheetChanged,{sheetName:s,propertyName:"isVisible",sheetIndex:l,oldValue:!0,newValue:!1}));p=(h=e.getActiveSheet()).name(),n&&(n.cancel?h._modelManager.CHb(!1):(h._modelManager.CHb(!0),e&&e.hq&&e.hq.repaint(),d={oldValue:!1,newValue:!0,sheetName:p,propertyName:"isSelected",sheetIndex:e.getSheetIndex(p)},e.Wq(a.Events.SheetChanged,d))),t===h&&e.Wq(a.Events.ActiveSheetChanged,{oldSheet:t,newSheet:h})}else Le(t);e.undoManager().clear()}}},Ne.register(h+T,ye,null,!1,!1,!1,!1),be={canUndo:!0,execute:function(e,t,n){return Fe(e,t,n,(function(e){var n=t.selections,o=t.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;u(o)&&(o=t.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=Ae(e,n[0])),1===n.length&&o?(e.setRowVisible(n[0].row-1,!0),e.mq(n[0].row-1)):we(n,"row",(function(t){e.setRowVisible(t,!0),t===e._t()&&(e.lq=0,e.os())}))}))}},Ne.register(h+N,be,null,!1,!1,!1,!1),Me={canUndo:!0,execute:function(e,t,n){return Fe(e,t,n,(function(e){var n=t.selections,o=t.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;u(o)&&(o=t.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=Ae(e,n[0])),1===n.length&&o?(e.setColumnVisible(n[0].col-1,!0),e.rq(n[0].col-1)):we(n,"col",(function(t){e.setColumnVisible(t,!0),t===e.$t()&&(e.qq=0,e.qs())}))}))}},Ne.register(h+I,Me,null,!1,!1,!1,!1),Se={canUndo:!1,execute:function(e){var t,n,o,r,i,s,l,u;if(0===ve.length)for(t=e.sheets,n=0;n<t.length;n++)t[n].visible()||(ve.push(t[n]),t[n].DHb(!1));if(o=e.getActiveSheet(),ve.length>0){if(e.sheets.forEach((function(e){e.DHb(!1,!0)})),s={sheetName:i=(r=ve.pop()).name(),propertyName:"isVisible",cancel:!1,sheetIndex:e.getSheetIndex(i),oldValue:!1,newValue:!0},e.Wq(a.Events.SheetChanging,s),s.cancel)return;r.visible(!0),l={oldValue:!1,newValue:!0,sheetName:i,propertyName:"isSelected",cancel:!1,sheetIndex:e.getSheetIndex(i)},e.Wq(a.Events.SheetChanging,l),e.setActiveSheet(r.name()),l.cancel?r._modelManager.CHb(!1):(r._modelManager.CHb(!0),e&&e.hq&&e.hq.repaint(),u={oldValue:!1,newValue:!0,sheetName:i,propertyName:"isSelected",sheetIndex:e.getSheetIndex(i)},e.Wq(a.Events.SheetChanged,u)),e.Wq(a.Events.SheetChanged,{sheetName:i,propertyName:"isVisible",sheetIndex:e.getSheetIndex(i),oldValue:!1,newValue:!0})}e.getActiveSheet()&&(e.focus(!0),e.Wq(a.Events.ActiveSheetChanged,{oldSheet:o,newSheet:e.getActiveSheet()}))}},Ne.register(h+S,Se,null,!1,!1,!1,!1),Te={canUndo:!1,execute:function(e,t){var n,o,r,i=e.getSheetFromName(t.sheetName);if(i&&(e.suspendPaint(),n=[],(o=i.slicers.all())&&!c(o))){for(r in o)o[r].isSelected()&&n.push(o[r].name());n.length>0&&Ne.execute({cmd:"deleteFloatingObjects",sheetName:i.name(),floatingObjects:n}),e.resumePaint()}}},Ne.register(h+w,Te,null,!1,!1,!1,!1)},e}(),t.ContextMenu=be,a.Workbook.$n("contextmenu",{setHost:function(){var e=this,t=e._host;e.contextMenu||(e.contextMenu=new be),l(t).bind("contextmenu.gcSheet",(function(t){if(e.options.allowContextMenu)return e.contextMenu.ola(t,e)}))},dispose:function(){l(this._host).unbind("contextmenu.gcSheet")},onCultureChanged:function(){var e,t=me(),n=this.contextMenu;n&&(e=n.menuData,l.each(t,(function(t,o){n.hma(e,p+t,(function(e,t){e[t].text=o}))})))}})},"./dist/plugins/contextMenu/context-menu.ns.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("./dist/plugins/contextMenu/context-menu.res.en.js");t.SR={en:o}},"./dist/plugins/contextMenu/context-menu.res.en.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copy="Copy",t.cut="Cut",t.pasteOptions="Paste Options:",t.pasteAll="All",t.pasteFormula="Formulas",t.pasteValues="Values",t.pasteFormatting="Formatting",t.pasteValuesFormatting="Values&Formatting",t.pasteFormulaFormatting="Formula&Formatting",t.clearContents="Clear Contents",t.insertRows="Insert",t.insertColumns="Insert",t.deleteRows="Delete",t.deleteColumns="Delete",t.insertSheet="Insert",t.deleteSheet="Delete",t.insertComment="Insert Comment",t.filter="Filter",t.sort="Sort",t.insertCopiedCells="Insert Copied Cells...",t.insertCutCells="Insert Cut Cells...",t.shiftCellsRight="Shift Cells Right",t.shiftCellsDown="Shift Cells Down",t.headerInsertCopiedCells="Insert Copied Cells",t.headerInsertCutCells="Insert Cut Cells",t.slicerSortAscend="Sort A to Z",t.slicerSortDescend="Sort Z to A",t.sortAscend="Sort A to Z",t.sortDescend="Sort Z to A",t.hideRows="Hide",t.hideColumns="Hide",t.hideSheet="Hide",t.unhideSheet="Unhide",t.unhideColumns="Unhide",t.unhideRows="Unhide",t.editComment="Edit Comment",t.deleteComment="Delete Comment",t.toggleComment="Show/Hide Comment",t.removeSlicer="Remove",t.removeFloatingObject="Remove",t.tableInsert="Insert",t.tableInsertRowsAbove="Table Rows Above",t.tableInsertRowsBelow="Table Row Below",t.tableInsertColumnsLeft="Table Columns to the Left",t.tableInsertColumnsRight="Table Columns to the Right",t.tableDelete="Delete",t.tableDeleteRows="Table Rows",t.tableDeleteColumns="Table Columns",t.hideSheetFailureInfo="A workbook must contain at least one visible worksheet.\nTo hide, delete or move the selected sheet(s), you must first insert a new sheet or unhide a sheet that is already hidden."},"./dist/plugins/contextMenu/menu-view.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S;Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("Core"),i=r.GC$,a=r.Ul.Nl,s=o.Common.j,l=s.Fa,u=s.Aa,c=s.C4,f=void 0,h=document,d=(p={qKb:"mouseenter",rKb:"mouseleave",sKb:"click",tKb:"gc.command.executed",uKb:".",vKb:"gc-ui-contextmenu",wKb:"-",xKb:"container",yKb:"hover",zKb:"disable-hover",AKb:"text",BKb:"icon",CKb:"menuitem",DKb:"nonselective-menuitem",EKb:"menuitem-content",FKb:"sup-container",GKb:"separator",HKb:"sup-indicator",IKb:"subitems-container",JKb:"group-container",KKb:"title",LKb:"group-header",MKb:"groupitems-container",NKb:"groupitem",OKb:"nonexecutable",PKb:"executable",QKb:"disable",RKb:"gc-statusbar-contextmenu",SKb:" ui-widget",TKb:" ui-state-hover",UKb:" ui-icon ui-icon-triangle-1-e",VKb:"DIV",WKb:"SPAN",XKb:"keydown.ctx.gcSheet",YKb:"none",ZKb:"inline-block",$Kb:"visible",_Kb:"hidden"}).vKb+p.wKb+p.yKb,g=p.vKb+p.wKb+p.CKb,m=p.vKb+p.wKb+p.DKb,y=p.vKb+p.wKb+p.EKb,v=p.vKb+p.wKb+p.PKb,b=p.vKb+p.wKb+p.FKb,C=p.vKb+p.wKb+p.IKb,w=p.RKb+p.wKb+"check",x=p.RKb+p.wKb+"check-container",A=p.RKb+p.wKb+"content",M=p.RKb+p.wKb+"status",S=function(){function e(){}return e.prototype.ai=function(e,t,n,o){var r=this;r._host=i(e),r.lla=c(t),r.wu=n.commandManager(),r.xc=n,r.Eu=o,r.LQ=[],r.YPa={},r.rQa=[],r.ZPa=null,r.lma()},e.prototype.mma=function(){var e,t,n,o,r,a,s,u=this,c=parseInt(u._host.css("left"),10),f=parseInt(u._host.css("top"),10),d=u._host.width(),g=u._host.height(),m=i(u.xc.getHost()),y=m.width(),v=u.hostInfo;l(v)?(o=m.height(),c+d>y&&(c=c-d>0?c-d:c,u._host.css("left",c)),f+g>o&&(f>g?f-=g:o>=g?f=o-g:(r=u._host.css("display"),u._host.css("display",p.YKb),(a=h.documentElement.scrollHeight)-(s=m.offset().top)>f+g||a>g&&(f=o+(a-s-o)-g),u._host.css("display",r)),u._host.css("top",f))):(e=v.top,t=v.width,n=v.height,c+d>t&&(c=c-d>0?c-d:c,u._host.css("left",c)),window.innerHeight-e-n<e&&(f-=g,u._host.css("top",f)))},e.prototype.lma=function(){var e,t,n,o=this,r=o.lla;l(r)||!function(e){if(e instanceof Object)return!0}(r)||r.length<1||(r instanceof Array||(r=[r]),e="menuView",t=o.nma(e,r),o.YPa.menuView=t,(n=o.oma(o.lla)).appendTo(o._host),o.mma(),o.QQ(),o.rQa.push({name:e,menuView:n}))},e.prototype.nma=function(e,t){for(var n,o=this,r=t.length,i=0,a=[];i<r;i++)n=t[i],l(n)||"separator"===n.type||(n.subMenu?o.YPa[n.name]=o.nma(n.name,n.subMenu):"groupHeader"===n.type&&(o.pma(n,t),o.YPa[n.name]=o.nma(e,n.groups)),a.push(o.qma(e,n)));return a},e.prototype.qma=function(e,t){var n,o,r,a=this;if(n="groupHeader"===t.type?a.$Pa():a.rma(),o=a.createMenuItemElement(t),!l(o))return o instanceof HTMLElement&&(o=i(o)),o.appendTo(n),r={name:t.name,host:n,menuItemData:t,menuName:e},a.LQ.push(r),r},e.prototype.rma=function(){var e=i(a(p.VKb));return e.addClass(g),e},e.prototype.$Pa=function(){var e=i(a(p.VKb));return e.addClass(m),e},e.prototype.createMenuItemElement=function(e){var t=this,n=e.type;return"groupHeader"===n?t.tma(e):"groupItem"===n?t.uma(e):"statusBar"===n?t.Eyb(e):e.subMenu?t.vma(e):t.wma(e)},e.prototype.wma=function(e){var t,n,o=i(a(p.VKb)).addClass(y);return e.command?e.disable?o.addClass(p.vKb+p.wKb+p.QKb):o.addClass(v):o.addClass(p.vKb+p.wKb+p.OKb),t=i(a(p.WKb)).addClass(p.vKb+p.wKb+p.BKb),e.iconClass&&t.addClass(e.iconClass),t.appendTo(o),e.text&&((n=i(a(p.WKb)).addClass(p.vKb+p.wKb+p.AKb))[0].innerHTML=e.text,n.appendTo(o)),o},e.prototype.sma=function(e){return i(a(p.VKb)).addClass(p.vKb+p.wKb+p.GKb)},e.prototype.tma=function(e){var t,n,o,r,s,l,u=i(a(p.VKb)).addClass(p.vKb+p.wKb+p.JKb);if(e.groups.length<=0)return u;for((t=this.wma(e)).addClass(p.vKb+p.wKb+p.LKb),t.appendTo(u),n=i(a(p.VKb)).addClass(p.vKb+p.wKb+p.MKb),r=(o=e.groups).length,s=0;s<r;s++)(l=this.xma("name",o[s].name).host).addClass(p.vKb+p.wKb+p.NKb),l.appendTo(n);return n.appendTo(u),u},e.prototype.uma=function(e){var t=this.wma(e);return t.find(p.uKb+p.vKb+p.wKb+p.AKb).remove(),t.attr(p.KKb,e.text),t},e.prototype.Eyb=function(e){var t,n,o,r=a("div"),s=i(r).addClass(y),l=e.visible,u=e.menuContent,c=e.status,f=a("div");return i(f).addClass(w),t=a("div"),i(t).addClass(x),t.appendChild(f),t.style.visibility=l?p.$Kb:p._Kb,(n=a("div")).innerText=u,i(n).addClass(A),o=a("div"),i(o).addClass(M),c?(o.innerText=c,o.style.display=p.ZKb):o.style.display=p.YKb,r.appendChild(t),r.appendChild(n),r.appendChild(o),s},e.prototype.vma=function(e){var t,n=i(a(p.VKb)).addClass(b),o=this.wma(e);return e.subMenu.length>0&&(i(a(p.WKb)).addClass(p.vKb+p.wKb+p.HKb+p.UKb).appendTo(o),(t=this.oma(e.subMenu)).addClass(C),t.appendTo(n)),o.appendTo(n),n},e.prototype.oma=function(e){for(var t,n,o,r=this,s=i(a(p.VKb)).addClass(p.vKb+p.wKb+p.xKb+p.SKb),u=e.length,c=0;c<u;c++)l(e[c])||(t=e[c].name,l(t)?"separator"===e[c].type&&(o=r.$Pa(),r.sma(e[c]).appendTo(o),o.appendTo(s)):(n=r.xma("name",t),l(n)||n.host.appendTo(s)));return s},e.prototype.xma=function(e,t){for(var n=this.LQ,o=n.length,r=0;r<o;r++)if(t instanceof i?t[0]===n[r][e][0]:n[r][e]===t)return n[r]},e.prototype.pma=function(e,t){var n,o,r;for(e.groups=[],n=t.length,o=0;o<n;o++)(r=t[o])&&r.group&&r.group===e.name&&(r.type="groupItem",e.groups.push(r),t.splice(o,1),o--)},e.prototype.QQ=function(){var e=this;i(p.uKb+g).bind(p.qKb,(function(){var t,n,o=i(this),r=e.xma("host",o);for(e.ZPa=r,t=0,n=e.rQa.length;t<n&&r.menuName!==e.rQa[n-t-1].name;t++)e.Ooa();e._Pa(),e.cQa(!1)})).bind(p.rKb,(function(){e.ZPa=null,e._Pa()})).bind(p.sKb,(function(t){var n=i(this),o=e.xma("host",n);e.ZPa=o,e.aQa(!1,t)&&e.WT()})),i(h).bind(p.XKb,(function(t){var n,o;switch(t.keyCode){case 27:e.Ooa()||e.WT();break;case 32:case 13:e.aQa(!0,t)&&e.WT();break;case 9:t.shiftKey?e.bQa(!1,!0):e.bQa(!0,!0);break;case 37:n=e.Ooa(),(o=e.xma("name",n))&&(e.ZPa=o),e.ZPa&&e.ZPa.menuItemData.group&&e.bQa(!1,!0);break;case 38:e.bQa(!1,!1);break;case 39:e.ZPa&&e.ZPa.menuItemData.group&&e.bQa(!0,!0),e.cQa(!0);break;case 40:e.bQa(!0,!1)}t.preventDefault?t.preventDefault():t.returnValue=!1}))},e.prototype.Noa=function(e){var t,n,o,r,i=e.offset().left,a=e.width();i+a>(window.scrollX||window.pageXOffset)+window.innerWidth&&e.css("left",-a),t=e.offset().top,n=e.height(),o=e.position().top,t+n>(r=window.scrollY||window.pageYOffset)+window.innerHeight&&e.css("top",o-(t+n-(r+window.innerHeight)))},e.prototype.zma=function(e){return e.command},e.prototype.getCommandOptions=function(e,t,n){},e.prototype.aQa=function(e,t){var n,o=this,r=o.ZPa;if(r&&!r.menuItemData.disable)return(n=r.menuItemData).subMenu?void(n.subMenu.length>0&&o.cQa(e)):(o.h4(t),!0)},e.prototype.h4=function(e){var t,n,o,r,i,a,s=this,c=s.ZPa,f=s.zma(c.menuItemData);l(f)||(t=s.getCommandOptions(c.menuItemData,c.host[0],e),n=s.wu,u(f)?f(s.xc,t):(r=(o=s.xc.getActiveSheet()).getActiveColumnIndex(),i=o.getActiveRowIndex(),a=o.tables.find(i,r),n.execute({cmd:f,sheetName:o.name(),selections:o.getSelections(),activeRow:i,activeCol:r,commandOptions:t,tableName:a?a.name():""})))},e.prototype.Tla=function(){i(p.uKb+g).unbind(p.qKb).unbind(p.rKb).unbind(p.sKb),i(h).unbind(p.XKb)},e.prototype.no=function(){var e=this;e._host=null,e.lla=null,e.wu=null,e.xc=null,e.Eu=null,e.LQ=null,e.YPa=null,e.ZPa=null,e.Tla()},e.prototype.Ooa=function(){var e;if(this.rQa.length>1)return(e=this.rQa.pop()).menuView.find(p.uKb+g).removeClass(d+p.TKb),e.menuView.hide(),e.name},e.prototype._Pa=function(){var e,t,n=this,o=n.dQa(!0);if(o){for(e=0,t=o.length;e<t;e++)o[e].host.removeClass(d+p.TKb);n.ZPa&&(n.ZPa.menuItemData.disable?n.ZPa.host.addClass(p.vKb+p.wKb+p.zKb+p.TKb):n.ZPa.host.addClass(d+p.TKb))}},e.prototype.WT=function(){this.Eu.trigger(p.tKb),this.no()},e.prototype.bQa=function(e,t){var n,o,r,i=this,a=i.dQa(t);i.ZPa&&((n=i.eQa(i.ZPa,a))||(o=i.YPa[i.ZPa.menuItemData.group])&&(r=o[0],n=i.eQa(r,a))),e?(n!==f&&n!==a.length-1||(n=-1),n="number"==typeof n?n+1:0):(n!==f&&0!==n||(n=a.length),n="number"==typeof n?n-1:0),i.ZPa=a[n],i._Pa()},e.prototype.dQa=function(e){for(var t,n,o,r=this,i=r.rQa[r.rQa.length-1].name,a=r.YPa[i],s=0,l=a.length,u=[];s<l;s++)if("groupHeader"!==a[s].menuItemData.type)u.push(a[s]);else if(t=r.YPa[a[s].menuItemData.name],e)for(n=0,o=t.length;n<o;n++)u.push(t[n]);else u.push(t[0]);return u},e.prototype.eQa=function(e,t){var n,o=t.length;for(n=0;n<o;n++)if(e.name===t[n].name)return n},e.prototype.cQa=function(e){var t,n,o=this,r=o.ZPa;r&&((t=r.menuItemData).subMenu&&t.subMenu.length>0&&(t.name!==o.rQa[o.rQa.length-1].name&&((n=i(r.host.find(p.uKb+C)[0])).show(),o.Noa(n),o.rQa.push({name:t.name,menuView:n})),o.ZPa=null,e&&o.bQa(!0,!1)))},e}(),t.MenuView=S},"./dist/plugins/data/binding.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C;function w(e,t){var n=e&&e.wq;return!(!n||!n.xL(t)||(e.clearPendingChanges(),o.Worksheet.ao(e,"initBinding",{sheet:e,data:t}),0))}function x(e,t,n){var o,r,i,a,s,l,u,f,h,p=e,m=p.Ou,y={value:c,hasBinding:!1};if(!m)return y;if(o=p.kj,(r=p.CL)===g){if(s=o?o.getBindingPath(t,n):c)return{value:m.getValue(s),hasBinding:!0}}else{if(t<0||e.getRowCount()<=t)return y;if(l=o?o.getColumnCount():e.getColumnCount(),n<0||l<=n)return y;if(o?(p.qia||(p.qia=o._modelManager.Hp(!1,3)),(i=p.qia[n])&&(a=i.name)):e.HL&&(p.qia?(i=p.qia[n])&&(a=i.dataField):a=e.HL[n]),r)return u=d[r],h=S(f=i&&i.value)?f:c,u.getValue(m,h,a,t,n)}return y}function A(e,t){return e&&t&&t!==g?d[t].getProperties(e):c}function M(e){return v&&e instanceof v}function S(e){return e instanceof Function}function T(e,t,n){var o,r,i,a,s;if(e&&t){if(o=e[t],!u(o))return void(S(o)?e[t](n):e[t]=n);for(i=(r=t.split(".")).length,a=0;a<i&&(s=r[a],e);a++)a===i-1?S(e[s])?e[s](n):e[s]=n:S(e[s])?(u(e[s]())&&e[s]({}),e=e[s]()):(u(e[s])&&(e[s]={}),e=e[s])}}function N(e,t,n){var o,r,i,a,s;if(!e||!t)return c;if(o=e[t],!u(o))return S(o)?o():o;r=null,n?(r=n[t])||(r=t.split("."),n[t]=r):r=t.split("."),i=r.length,a=0;do{if(e=S(e[s=r[a]])?e[s]():e[s],u(e))return c;++a}while(a<i);return e}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("Core"),i=r.GC$,a=n("@grapecity/js-sheets-common"),s=n("./dist/plugins/data/data.ns.js"),l=i.isNumeric,u=a.Common.j.Fa,c=null,f=void 0,h="string",t.yL=p,d=t.yL=p={},g="cellBinding",m=new a.Common.ResourceManager(s.SR),y=m.getResource.bind(m),v=function(){function e(e){this._source=e}return e.prototype.setValue=function(e,t){T(this._source,e,t)},e.prototype.getValue=function(e){return N(this._source,e)},e.prototype.getSource=function(){return this._source},e}(),t.CellBindingSource=v,b=function(){function e(e){this.ad(e)}return e.prototype.bind=function(e,t){var n,o,r,a,s=this,l=s.kj,u=s.Ou;if(t&&s.tUa(t,{type:"bind",oldDataSource:u}),u&&(u.lka&&(u.subscribe=u.lka,delete u.mka,delete u.lka),S(u.dispose)&&u.dispose()),s.zL(s.AL),s.zL(s.BL),s.ad(l),s.Ou=e,e){if(!(n=s.CL=function(e){var t=c;return e&&(M(e)?t=g:i.each(d,(function(n,o){if(o.isDataSource(e))return t=n,!1}))),t}(e)))throw Error(y().Exp_NotSupportedDataSource);s.DL=s.EL(),l&&i[i.sd]({tc:l.parent}),l&&(o=s.AL,r=e.currentPosition,e.subscribe&&o.push(e.subscribe(s.FL,s)),r&&r.subscribe&&o.push(r.subscribe(s.GL,s)),S(e.subscribe)&&!e.lka&&(a=e.lka=e.subscribe,e.mka=!1,e.subscribe=function(t,n){var o=[].concat.apply([],arguments),r=function(){if(!e.mka&&S(t))return t.apply(n,arguments)};return o[0]=r,a.apply(e,o)}),s.Lx()),s.HL=A(e,n)}return w(l,e)},e.prototype.Lx=function(){var e,t,n,o,r,i=this,a=i.kj,s=i.Ou;if(a&&s&&(e=i.CL,i.zL(i.BL),t=c,e!==g&&(n=a.getActiveRowIndex(),s.currentPosition?(-1<=n&&n<s.count()&&s.currentPosition(n),t=s.currentItem()):t=i.ru(n)),t))for(r in o=function(){a&&a.repaint()},t)t[r]&&S(t[r].subscribe)&&i.BL.push(t[r].subscribe(o,c,c))},e.prototype.zL=function(e){var t,n;if(e)for(t=0;t<e.length;t++)(n=e[t])&&S(n.dispose)&&n.dispose()},e.prototype.getRowCount=function(){var e=this.Ou,t=this.CL,n=0;return e&&t&&t!==g&&(n=d[t].getDataLength(e)),n},e.prototype.getColumnCount=function(){var e,t,n,o=this.HL;return o?o.length:(e=this.Ou)&&(t=e[0],"null"===(n=i.getType(t))||n===h||"number"===n)?1:0},e.prototype.getSource=function(){return this.Ou},e.prototype.rL=function(){return this.HL},e.prototype.Nka=function(e){this.HL=e},e.prototype.ru=function(e){var t=this.Ou,n=this.CL,o=c;return t&&n&&n!==g&&(o=d[n].getDataItem(t,e)),o},e.prototype.EL=function(){var e,t,n,o=this;if(!o.DL)for(e=o.getRowCount(),t=0;t<e;t++)if(n=o.ru(t)){o.DL=n.entityAspect&&n.entityType||n.constructor;break}return o.DL},e.prototype.getValue=function(e,t){return x(this,e,t)},e.prototype.setValue=function(e,t,n,o){var r,i=this;return o&&(r=x(i,e,t).value,i.tUa(o,{type:"setValue",row:e,col:t,oldValue:r})),function(e,t,n,o){var r,i,a,s,l,u,f,h,p,m=e,y=m.Ou,v=!1;if(!y)return v;if(r=m.kj,(i=m.CL)===g)(l=r?r.getBindingPath(t,n):c)&&(y.setValue(l,o),v=!0);else{if(t<0||e.getRowCount()<=t)return v;if(u=r?r.getColumnCount():e.getColumnCount(),n<0||u<=n)return v;r?(m.qia||(m.qia=r._modelManager.Hp(!1,3)),(a=m.qia[n])&&(s=a.name)):e.HL&&(m.qia?(a=m.qia[n])&&(s=a.dataField):s=e.HL[n]),i&&(f=d[i],h=a&&a.value,p=S(h)?h:c,v=f.setValue(y,p,s,t,n,o))}return v}(i,e,t,n)},e.prototype.sL=function(){var e=d[this.CL];return e&&e.canAdd&&e.canAdd()},e.prototype.tL=function(){var e=d[this.CL];return e&&e.canInsert&&e.canInsert()},e.prototype.vL=function(){var e=d[this.CL];return e&&e.canRemove&&e.canRemove()},e.prototype.uL=function(e,t,n){var o,r,i=this,a=i.Ou;!a||e>i.getRowCount()||(o=i.CL,r=i.EL(),o&&o!==g&&!i.IL&&(i.JL=!0,n&&i.tUa(n,{type:"addItems",row:e,rowCount:t}),d[o].addItems(a,e,t,r),i.JL=!1))},e.prototype.wL=function(e,t,n){var o,r=this,i=r.CL,a=r.getRowCount(),s=r.Ou;!s||e>=a||i&&i!==g&&!r.IL&&(r.JL=!0,o=d[i].removeItems(s,e,t),n&&o&&o.length>0&&r.tUa(n,{type:"removeItems",row:e,removedItems:o}),r.JL=!1)},e.prototype.uUa=function(e,t){var n=this.Ou,o=this.CL;d[o].undoRemoveItems(n,e,t)},e.prototype.xL=function(e){return M(e||this.Ou)},e.prototype.ad=function(e){var t=this;t.Ou=c,t.CL="",t.DL=c,t.HL=c,t.AL=[],t.BL=[],t.qia=c,t.kj=e,function(e){var t=e&&e.wq;t&&t.xL()&&o.Worksheet.ao(e,"resetBinding",{sheet:e})}(e)},e.prototype.FL=function(e){var t,n,o,r,i=this,a=i.kj;if(a&&!i.JL){if(e){if(i.IL=!0,!isNaN(e.length)&&(a.setRowCountCore(e.length),t=a._modelManager,u(i.HL)&&0===t.VTa(!1,3)&&(i.HL=A(i.Ou),a.setColumnCount(i.getColumnCount()),n=i.rL())))for(o=0,r=n.length;o<r;o++)t.do("setItem",!1,3,o,{name:n[o]});i.IL=!1}a.$p()}},e.prototype.GL=function(){var e,t=this.kj,n=this.Ou;t&&n&&n.currentPosition&&(e=n.currentPosition(),t.Jl!==e&&(t.Sr(e,t.Kl,f,f,2),t.$p()))},e.prototype.tUa=function(e,t){if(!(this.kj&&this.kj._modelManager&&!u(this.kj._modelManager.WTa)&&this.kj._modelManager.WTa<=0)){var n=e.rUa;n||(n=e.rUa=[]),t.bindingManager=this,n.push(t)}},e.prototype.sUa=function(e){var t=this,n=e.type,o=e.row;"bind"===n?t.bind(e.oldDataSource):"setValue"===n?t.setValue(o,e.col,e.oldValue):"addItems"===n?t.wL(o,e.rowCount):"removeItems"===n&&t.uUa(o,e.removedItems)},e.prototype.toJSON=function(){var e,t=this.Ou;return t?{type:e=this.CL,source:t=e===g?t.getSource():d[e].toJSON(t)}:c},e.prototype.fromJSON=function(e){var t,n,o=e&&e.source;o&&(void 0,(n=(t=e.type)===g?new v(o):d[t].fromJSON(o))&&this.bind(n))},e}(),t.qL=b,t.setValueByPath=T,t.LL=N,C=function(){function e(){this.pathCache={}}return e.prototype.isDataSource=function(e){return i.isArray(e)},e.prototype.getDataLength=function(e){return e.length},e.prototype.getDataItem=function(e,t){return e[t]},e.prototype.addItems=function(e,t,n,o){var r,i;for(r=0;r<n;r++)i={},o&&(i=o.createEntity?o.createEntity():new o),e.splice(t,0,i)},e.prototype.removeItems=function(e,t,n){var o=this.getDataLength(e);if(t<o)return e.splice(t,Math.min(n,o-t))},e.prototype.undoRemoveItems=function(e,t,n){for(var o=0,r=n.length;o<r;o++)e.splice(t+o,0,n[o])},e.prototype.getProperties=function(e){var t,n,o=e.length,r=c;if(o>0)for(n in r=[],t=e[0])S(t[n])||r.push(n);return r},e.prototype.getValue=function(e,t,n,o,r){var i=c,a=!1,s=this.getDataItem(e,o);return u(s)||(t?(i=t(s),a=!0):n?(i=N(s,n,this.pathCache),a=!0):(typeof s===h||l(s))&&0===r&&(i=s,a=!0)),{value:i,hasBinding:a}},e.prototype.setValue=function(e,t,n,o,r,i){var a=!1,s=this.getDataItem(e,o);return u(s)||(t?(t(s,i),a=!0):n?(T(s,n,i),a=!0):(typeof s===h||l(s))&&0===r&&(e[o]=i,a=!0)),a},e.prototype.fromJSON=function(e){return e},e.prototype.toJSON=function(e){return e},e}(),d.defaultBindingSource=new C},"./dist/plugins/data/data.dataview.js":function(e,t,n){"use strict";var o,r,i,a;Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("./dist/plugins/data/binding.js"),t.yL=r.yL,i=o.Common.j.Fa,a=function(){function e(){}return e.prototype.isDataSource=function(e){var t=window.wijmo;return t&&t.data&&t.data.isDataView&&t.data.isDataView(e)},e.prototype.getDataLength=function(e){return e.count()},e.prototype.getDataItem=function(e,t){return e.item(t)},e.prototype.addItems=function(e,t,n,o){if(o)for(var r=0;r<n;r++)e.mka=!0,e.add(o.createEntity?o.createEntity():new o),e.mka=!1,e.commitEdit()},e.prototype.removeItems=function(e,t,n){var o,r,i,a,s=this.getDataLength(e);if(t<s){for(o=[],r=Math.min(n,s-t),i=0;i<r;i++)a=e.item(t),e.remove(a),o.push(a);return o}},e.prototype.undoRemoveItems=function(e,t,n){var o,r,i=e.getSource();for(o=0,r=n.length;o<r;o++)i.splice(t+o,0,n[o]);e.refresh()},e.prototype.getProperties=function(e){var t,n=0,o=null,r=e.getProperties();if(r&&r.length>0)for(n=r.length,o=[],t=0;t<n;t++)o.push(r[t].name);return o},e.prototype.canInsert=function(){return!1},e.prototype.getValue=function(e,t,n,o,r){var a=null,s=!1,l=this.getDataItem(e,o);return i(l)||(t?(a=t(l),s=!0):n&&(a=e.getProperty(l,n),s=!0)),{value:a,hasBinding:s}},e.prototype.setValue=function(e,t,n,o,r,a){var s=!1,l=this.getDataItem(e,o);return i(l)||(t?(t(l,a),s=!0):n&&(e.setProperty(l,n,a),s=!0)),s},e.prototype.fromJSON=function(e){return e},e.prototype.toJSON=function(e){return e.local},e}(),r.yL.dataViewBinding=new a},"./dist/plugins/data/data.entry.js":function(e,t,n){"use strict";function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),n("./dist/plugins/data/worksheet-databind.js");var r=n("./dist/plugins/data/binding.js");t.CellBindingSource=r.CellBindingSource,t.qL=r.qL,t.setValueByPath=r.setValueByPath,t.LL=r.LL,o(n("./dist/plugins/data/data.ko.js")),o(n("./dist/plugins/data/data.dataview.js")),o(n("./dist/plugins/data/data.ns.js"))},"./dist/plugins/data/data.ko.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d;Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("@grapecity/js-sheets-common"),i=n("./dist/plugins/data/binding.js"),t.yL=i.yL,a=r.Common.j.Fa,s=o.GC$,l=s.isFunction,u=s.getType,c=s.isNumeric,f="string",h=window.ko,p=function(){function e(){}return e.prototype.isDataSource=function(e){return h&&h.isObservable(e)},e.prototype.getDataLength=function(e){return e().length},e.prototype.getDataItem=function(e,t){return e()[t]},e.prototype.addItems=function(e,t,n,o){var r,i;for(r=0;r<n;r++)i={},o&&(i=o.createEntity?o.createEntity():new o),e.splice(t,0,i)},e.prototype.removeItems=function(e,t,n){var o=this.getDataLength(e);if(t<o)return e.splice(t,Math.min(n,o-t))},e.prototype.undoRemoveItems=function(e,t,n){for(var o=0,r=n.length;o<r;o++)e.splice(t+o,0,n[o])},e.prototype.getProperties=function(e){var t,n,o=e(),r=[];if(o.length>0)for(n in t=o[0])l(t[n])?h&&h.isObservable(t[n])&&r.push(n):r.push(n);return r},e.prototype.getValue=function(e,t,n,o,r){var s=null,l=!1,h=this.getDataItem(e,o);return a(h)||(t?(s=t(h),l=!0):n?(s=i.LL(h,n),l=!0):(u(h)===f||c(h))&&0===r&&(s=h,l=!0)),{value:s,hasBinding:l}},e.prototype.setValue=function(e,t,n,o,r,s){var l=!1,h=this.getDataItem(e,o);return a(h)||(t?(t(h,s),l=!0):n?(i.setValueByPath(h,n,s),l=!0):(u(h)===f||c(h))&&0===r&&(e()[o]=s,l=!0)),l},e.prototype.fromJSON=function(e){return h?h.observableArray(e):null},e.prototype.toJSON=function(e){return e()},e}(),i.yL.koBinding=new p,h&&((d=h.bindingHandlers)["gc-spread-sheets"]=d["gcspread-sheets"]=d.wijspread={init:function(e,t,n,r){var i,a,l,u,c,h,p,d,g,m,y,v;if(!s(e).data("workbook")&&(a=(i=t())&&i.sheets,l=new o.Workbook(s("#"+e.id)[0],i),a)){for(u=void 0,c=void 0,h=a.length,p=l.getSheetCount();p<h;)u=l.vv(l._getDefaultSheetName(p)),l.ow(p,0,u),p=l.getSheetCount();for(d=0;d<h;d++)u=l.getSheet(d),g=(c=a[d]).name,m=c.autoGenerateColumns,y=c.data,v=c.columns,typeof g===f&&g.length>0&&u.cq(g),"boolean"==typeof m&&(u.autoGenerateColumns=m),y&&u.setDataSource(y),v&&v.length>0&&(u.autoGenerateColumns=!1,u.bindColumns(v))}},update:function(e,t,n,o){}})},"./dist/plugins/data/data.ns.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("./dist/plugins/data/data.res.en.js");t.SR={en:o}},"./dist/plugins/data/data.res.en.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_NotSupportedDataSource="The data source is not supported!"},"./dist/plugins/data/worksheet-databind.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d;function g(e,t,n){"string"==typeof n&&(n={name:n}),e._modelManager.do("setItem",!1,3,t,n);var o=n&&n.formatter,r=n&&n.cellType;o&&e.setFormatter&&e.setFormatter(-1,t,o),r&&e.setCellType(-1,t,r),n&&n.width&&e.setColumnWidth(t,n.width)}function m(e,t,n,o){var r,i,s,l,u=e.wq;for(r=0;r<n;r++)for(i=0;i<o;i++)s=u.getValue(r,i).value,a(s)||(l=s,p.Ska(s)&&(l=p.Daa(s)),e.qI(t,r,i,l))}function y(e,t,n,o){var r,i,s,l,u,c=e.options.colHeaderAutoTextIndex;for(r=0;r<n;r++)if(c>=0&&r===c||-1===c&&r===n-1)for(i=0;i<o;i++)s=t[r]&&t[r][i]&&t[r][i].value,l=e._modelManager.Jp(!1,3,i),a(s)&&l&&((u=l.displayName||l.name)&&e.qI(t,r,i,u))}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("@grapecity/js-sheets-common"),i=n("./dist/plugins/data/binding.js"),a=r.Common.j.Fa,s=o.GC$.isEmptyObject,l=o.GC$.extend,u=o.Worksheet.prototype,c=null,f="bindingPath",h=RegExp("^\\d*(\\.\\d+)?\\*$"),p=r.Common.l,d={getDataSource:function(){var e=this.wq;return e?e.getSource():c},setDataSource:function(e,t){var n,o,r,a,s,l=this,u=l.wq;if(u&&u.getSource()!==e){if(t&&l.vs(),e){if((u=l.wq).aLb=!0,!u.bind(e,l._modelManager.zTa)&&(l.setRowCountCore(u.getRowCount()),l.autoGenerateColumns&&(l.setColumnCount(u.getColumnCount()),n=u.rL())))for(o=0,r=n.length;o<r;o++)l._modelManager.do("setItem",!1,3,o,{name:n[o]})}else l.wq=new i.qL(l);l.clearPendingChanges(),a=!1,u&&u.aLb&&(a=u.bLb,delete u.bLb,delete u.aLb),l.recalcAll&&l.recalcAll(a),(s=l.tu())&&s.PA===l&&s.hZ(),l.$p()}},bindColumn:function(e,t){var n=this;n.suspendPaint();try{g(n,e,t)}finally{n.resumePaint()}},bindColumns:function(e){var t,n,o,r,i=this;i.suspendPaint();try{if(e)for(t=e.length,isNaN(t)||i.setColumnCount(t),n=0;n<t;n++)r=(o=e[n]).size,h.test(r)&&(o.starSize=r),g(i,n,o)}finally{i.resumePaint()}},getDataItem:function(e){var t,n,o,r,i,s,l=this,u=l.wq;if(!u||0===u.getRowCount())return c;if(t=l.getColumnCount(),n={},o=u.ru(e))for(r in o)o.hasOwnProperty(r)&&"function"!=typeof r&&(n[r]=o[r]);for(i=0;i<t;i++)(s=l._modelManager.Jp(!1,3,i))&&s.name&&s.name.length>0&&a(n[s.name])&&(n[s.name]=l.getValue(e,i));return n},getDataColumnName:function(e){var t,n=this;return 0<=e&&e<n.getColumnCount()&&n.getDataSource()?(t=n._modelManager.Jp(!1,3,e))&&(t.displayName||t.name):c},getBindingPath:function(e,t){return this._modelManager.getValueForKey(e,t,f)},setBindingPath:function(e,t,n){var o=this;return o._modelManager.do("setValueForKey",e,t,f,n),o.$p(),o}},l(u,d),o.CellRange.prototype.bindingPath=o.CellRange.Pl(u.getBindingPath,u.setBindingPath),o.Worksheet.$n("binding",{init:function(){var e=this;e.autoGenerateColumns=!0,e.wq=new i.qL(e)},dispose:function(e){!1!==e.clearCache&&(this.wq=c)},onLayoutChanged:function(e){var t,n,o,r,i,a=this,s=e.changeType,l=e.row,u=e.rowCount,f=e.sheetArea,h=a.wq;if("addingRows"===s)h&&!1===h.sL()?e.canAdd=!1:h&&!1===h.tL()&&(e.newRow=a.getRowCount());else if("addRows"===s)h&&h.uL(l,u,a._modelManager.zTa);else if("deletingRows"===s){if(h)if(!1===h.vL())e.canDelete=!1;else for(a.Ts||(a.Ts=[]),t=a.Ts,n=a._modelManager,o=h.getRowCount(),r=0;r<u&&l+r<n.getRowCount();r++)i=c,l+r<o&&(i=h.ru(l+r)),t.push({row:l+r,data:i})}else"deleteRows"===s?h&&h.wL(l,u,a._modelManager.zTa):"settingRowCount"===s&&(!h.getSource()||h.xL()||3!==f&&2!==f||(e.canSet=!1))},toJson:function(e,t){var n,o,r=this,i=r.getColumnCount(),a=r.getDataSource();t&&t.includeBindingSource&&a&&(m(r,n=e.data.dataTable||{},r.getRowCount(),i),s(n)||(e.data.dataTable=n),y(r,o=e.colHeaderData.dataTable||{},r.getRowCount(1),i),s(o)||(e.colHeaderData.dataTable=o)),!0!==r.autoGenerateColumns&&(e.autoGenerateColumns=r.autoGenerateColumns)},fromJson:function(e,t){var n,o,r,s,l=this;l.wq=new i.qL(l),t&&(n=l.wq,o=e.dataSource,r=e.dataBinding,o&&n.bind(o),r&&n.fromJSON(r,t)),s=e.autoGenerateColumns,a(s)||(l.autoGenerateColumns=s)},preFromJson:function(){this.wq=new i.qL(this)}}),o.lUa.$n("binding",{priority:6e3,getValue:function(e){var t,n=e.row,o=e.col,r=e.sheetArea,i=this.kj.wq;3===r&&i&&i.Ou&&(t=i.getValue(n,o),e.isValueGet=t.hasBinding,e.value=t.value)},setValue:function(e){var t,n,o,r=e.row,i=e.col,a=e.value,s=e.sheetArea,l=this.kj,u=l.wq;3===s&&u&&u.Ou&&((t=u.getValue(r,i)).hasBinding&&(a!==(n=t.value)&&(l.isDirtySuspended()||(o=l.getDataItem(r),this.Cp(r,i,{Dp:o,Ep:n},s)),u.setValue(r,i,a,l._modelManager.zTa)),e.isValueSet=!0))},undo:function(e){var t,n,o=e.rUa;if(o)for(t=o.length-1;t>=0;t--)(n=o[t]).bindingManager.sUa(n)}})},"./dist/plugins/fill/drag-fill.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function O(e){return e.rowCount}function F(e){return e.colCount}function P(e,t){return e.getRowCount(t)}function H(e,t){return e.getColumnCount(t)}function B(e,t,n,o,r){var i,a,s=e.getSelections();e.Tr(),e.addSelection(t,n,o,r),e.Au(s),i=t>0?t:e.ar(),a=n>0?n:e.$q(),e.Kr(i,a,e.Nr,e.Pr)}function L(e){var t=e.parent.getActiveSheet();t&&e!==t&&t.repaint()}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("Core"),i=n("./dist/plugins/fill/fill.js"),a=n("./dist/plugins/fill/fill.ns.js"),s=n("@grapecity/js-calc"),l=!!s,u=o.Common.j.Fa,c=null,f=void 0,h=r.kf,p=r.GC$,d=Math.max,g=Math.floor,m=r.Commands.ActionBase,y=r.Commands.xy,v=r.Commands.Bu,b=2047,C="startRange",w="fillRange",x="autoFillType",A="fillDirection",M="cancel",S="fill",T="dragDrop",N=p.isEmptyObject,I=new o.Common.ResourceManager(a.SR),R=I.getResource.bind(I),k={fillAuto:function(e,t,n){if(!t)throw Error(R().Exp_RangeIsNull);var r=this,a=n.fillType,s=n.series,l=n.direction,f=n.step,h=n.stop,p=new i.z$(r);if(function(e,t,n,o){return!!(e&&t&&t.containsRange(e))&&(!u(n)&&(1===n&&e.row===t.row&&O(e)===O(t)||0===n&&e.col===t.col&&F(e)===F(t))||!(u(o)||(2!==o&&3!==o||e.col!==t.col||F(e)!==F(t))&&(0!==o&&1!==o||e.row!==t.row||O(e)!==O(t))))}(e,t,l?c:s,l)){r.suspendPaint(),e&&(r._eventHandler.A$=e);try{4===a?p.B$(t,s,!1,n.withTag,n.withoutStyle):0===a?p.C$(t,l):1===a||2===a?p.D$(1===a,t,s,f,h):3===a&&p.E$(t,s,3,f,u(h)?c:o.Common.l.Ra(h),n.unit)}finally{r.resumePaint()}}}},p.extend(r.Worksheet.prototype,k),r.Worksheet.$n(S,{init:function(){this.Fyb=new i.Gyb(this)},setHost:function(e){if(e){var t=this.wu();t[S]||t.register(S,r.Commands[S]),t[T]||t.register(T,r.Commands[T])}},dispose:function(e){if(!1!==e.clearCache){var t=this;t.Fyb&&(t.Fyb.no(),t.Fyb=c)}}}),E=function(e){function t(t,n){var o=e.call(this)||this,i=o,a=n[A],s=0===a,l=s||1===a,u=n[w],c=n[C],f=c.row,p=c.col,d=O(c),g=F(c);return i.kj=t,i.G$=n,4===n[x]?i.H$=new r.Commands.OA(t,{ranges:[n[w]]}):i.I$=l?h(f,s?u.col:p,d,g+F(u)):h(2===a?u.row:f,p,d+O(u),g),i.J$=l?1:0,o}return _(t,e),t.prototype.canExecute=function(){var e=this.kj,t=this.G$,n=t[C],o=t[w];return!(!e.Y3(o.row,o.col,O(o),F(o))||4!==t[x]&&o.intersect(n.row,n.col,O(n),F(n)))},t.prototype.execute=function(){var e,t,n,o,i,a=this;if(a.canExecute()){t=(e=a.G$)[w],(n=a.kj)._modelManager.startTransaction(),a.Lz(n,!0);try{l&&n.suspendCalcService(),o=n.getSelections(),n.isDirtySuspended()||(a.N$=new y(n,e[w],b)),4===e[x]?a.K$(n):a.L$(n),n.yu(o,n.getSelections())&&n.Au(o)}finally{a.Mz(n,!0),e[r.Commands.bWa(n.name())]=n._modelManager.endTransaction(),l&&n.resumeCalcService(!1),n.t4&&n.t4(t.row,t.col,O(t),F(t)),i=[],n.isDirtySuspended()||(a.M$=new y(n,t,b),a.M$.uy(a.N$.sy()),i=a.M$.wy()),v(n,t.row,t.col,O(t),F(t),i,1)}}},t.prototype.K$=function(e){var t,n,o,r,i,a,s,l,u,c=this;c.H$.execute(e),n=(t=c.G$)[C],o=t[w],r=0===c.J$,a=O(n),s=F(n),l=r?d(1,a-O(o)):a,u=r?s:d(1,s-F(o)),n.equals(o)||(i=h(n.row,n.col,l,u),e.Kr(d(e.ar(),i.row),d(e.$q(),i.col),e.Nr,e.Pr),e.Tr(),e.addSelection(i.row,i.col,O(i),F(i)))},t.prototype.L$=function(e){var t,n,o,r=this,i=r.kj,a=r.G$[C],s=r.G$[w],l=r.G$[x],u=r.I$,c={fillType:4,series:r.J$,withTag:!0};try{i.tables&&i.tables.fIb(u)}catch(e){return i.Os(6,e.message),void i.resumePaint()}if(1===l){if(i.fillAuto(a,u,c),i._modelManager.MTa(a.row,a.col,a.rowCount,a.colCount))for(t=0;t<s.rowCount;t++)for(n=0;n<s.colCount;n++)(o=i.Aj(a.row+g(t%a.rowCount),a.col+g(n%a.colCount)))&&o.clone&&(o=o.clone()),i.Nq(s.row+t,s.col+n,o)}else 0===l?(2043,r.O$(a,s,2043)):2===l?r.O$(a,s,192):3===l&&(!(1!==O(a)||1!==F(a)||-1===a.row&&-1!==a.col||-1===a.col&&-1!==a.row)?(187,r.O$(a,s,187)):(c.withoutStyle=!0,i.fillAuto(a,u,c)));i.Kr(d(e.ar(),u.row),d(e.$q(),u.col),e.Nr,e.Pr),e.Tr&&e.Tr(),i.addSelection(u.row,u.col,O(u),F(u))},t.prototype.O$=function(e,t,n){var o,r,i,a,s,l=this,u=l.kj,c=u.Tq(e),f=u.Tq(t),h=c.row,p=c.col,d=O(c),m=F(c),y=f.row,v=f.col,b=O(f),C=F(f),w=l.G$[A],x=3===w,M=1===w,S=g(b/d),T=b%d,N=g(C/m),I=C%m;if(0===l.J$){for(o=0;o<S;o++)a=x?y+o*d:y+b-(o+1)*d,u.ax(h,p,a,v,d,m,n,!0);0!==T&&(r=x?h:h+(S+1)*d-b,a=x?y+d*S:y+b-S*d-T,u.ax(r,p,a,v,T,m,n,!0))}else{for(o=0;o<N;o++)s=M?v+o*m:v+C-(o+1)*m,u.ax(h,p,y,s,d,m,n,!0);0!==I&&(i=M?p:p+(N+1)*m-C,s=M?v+m*N:v+C-N*m-I,u.ax(h,i,y,s,d,I,n,!0))}},t.prototype.undo=function(){var e,t,n,o,r=this,i=r.kj,a=!1;if(r.canUndo()){r.Lz(i,!0);try{l&&i.suspendCalcService(),e=i.getSelections(),t=r.G$,n=i.NF,o=t[w],a=4===t[x]?r.S$(i):r.T$(i),!i.U$&&n&&n.close(),v(i,o.row,o.col,O(o),F(o),r.M$?r.M$.wy():[],1,f,!0),i.yu(e,i.getSelections())&&i.Au(e)}finally{r.Mz(i,!0),l&&i.resumeCalcService(!1)}}return a},t.prototype.S$=function(e){var t=this.G$[C],n=t.row,o=t.col,i=r.Commands.bWa(e.name());return e._modelManager.undo(this.G$[i]),e.Kr(d(e.ar(),n),d(e.$q(),o),e.Nr,e.Pr),!0},t.prototype.T$=function(e){var t,n=this.G$,o=n[C],i=o.row,a=o.col;l&&e.suspendCalcService();try{t=r.Commands.bWa(e.name()),e._modelManager.undo(n[t]),e.Kr(d(e.ar(),i),d(e.$q(),a),e.Nr,e.Pr)}finally{l&&e.resumeCalcService(!1)}return e.invalidateLayout(),!0},t}(m),D=function(e){function t(t,n){var o=e.call(this)||this,r=o;return r.kj=t,r.i4=n,r.W$=n[C],r.X$=n[w],r.Y$=n[x],r.Z$=n[A],o}return _(t,e),t.prototype.execute=function(){var e,t,n,o,i,a,s=this,l=!1;if(s.canExecute()){e=s.kj,t=s.X$,e._modelManager.startTransaction(),s.oUa(),s.Lz(e,!0),e.vxb=!0;try{n=e.getSelections(),o=e._eventHandler,(i={sheet:e,sheetName:e.name()})[M]=!1,i[w]=t,i[x]=s.Y$,i[A]=s.Z$,e.Wq(r.Events.DragFillBlock,i),o.$$=i[x],o._$=i[M],s.a_(i),delete i[M],e.Wq(r.Events.DragFillBlockCompleted,i),l=!0,e.yu(n,e.getSelections())&&e.Au(n)}finally{s.Mz(e,!0),e.vxb=!1,s.IVa(e,t),a=r.Commands.bWa(e.name()),s.i4[a]=e._modelManager.endTransaction()}}return l},t.prototype.a_=function(e){var t,n,o=this,r=o.kj,i=r._eventHandler,a=o.X$,s=o.Y$;i.$$=s,i._$||((t={})[C]=o.W$,t[w]=a,t[x]=5===e[x]?s:e[x],t[A]=o.Z$,n=new E(r,t),r.suspendEvent(),n.execute(),r.resumeEvent(),o.i4.d_=n)},t.prototype.oUa=function(){var e=this;e.kj.isDirtySuspended()||(e.N$=new y(e.kj,e.X$,b))},t.prototype.undo=function(){var e,t,n,o,i=this;if(i.canUndo()){e=i.kj,t=i.X$,i.oUa(),i.Lz(e,!0);try{n=e.getSelections(),e.suspendEvent(),o=r.Commands.bWa(e.name()),e._modelManager.undo(i.i4[o]),e.resumeEvent(),e.yu(n,e.getSelections())&&e.Au(n)}finally{i.Mz(e,!0),i.IVa(e,t,!0)}}return!0},t.prototype.IVa=function(e,t,n){var o,r=[];e.isDirtySuspended()||((o=new y(e,t,b)).uy(this.N$.sy()),r=o.wy()),v(e,t.row,t.col,O(t),F(t),r,1,f,n)},t}(m),j=function(e){function t(t,n){return e.call(this,t,n)||this}return _(t,e),t.prototype.canExecute=function(){var e,t,n,o=this,r=o.kj,i=o.VQ,a=i.fromRow,s=i.fromColumn,l=O(i),u=i.columnCount,f=i.toRow,h=i.toColumn,p=!i.copy,d={row:a,col:s,rowCount:l,colCount:u},g={row:f,col:h,rowCount:l,colCount:u};return(!r.tables||!r.tables.zxb(r,d,r,g,p))&&!!r.pu(a,s,l,u,P(r),H(r))&&!(!i.insert&&!r.pu(f,h,l,u,P(r),H(r)))&&(e=f>=0&&h<0&&a>=0&&s<0&&l>0&&u<0,t=f<0&&h>=0&&a<0&&s>=0&&l<0&&u>0,n=o.KZa(e,t),r.Y3(f,h,l,u,c,c,n)&&r.Y3(a,s,l,u,c,c,n))},t.prototype.KZa=function(e,t){var n,o,r=this.VQ,i=this.kj,a=r.insert,s=i.options.isProtected,l=i.options.protectionOptions;return!(!s||N(l)||(n=l.allowDragInsertRows,o=l.allowDragInsertColumns,!a||!(n&&e||o&&t)))},t.prototype.execute=function(){var e,t,n,o,i,a,s,l,u,c,f,h,p,d,g,m,y=this,v=!1;if(y.canExecute()){e=y.kj,t=y.VQ,y.oUa(),n=void 0,o=void 0,i=void 0,a=t.fromRow,s=t.fromColumn,l=t.toRow,u=t.toColumn,c=O(t),f=t.columnCount,h=t.option,p=e.parent.sheets,r.Commands.Zxb(p),y.Lz(e,!0),e.vxb=!0;try{try{e.tables&&e.tables.fIb(new r.Range(l,u,c,f),new r.Range(a,s,c,f))}catch(t){return e.Os(6,t.message),void e.resumePaint()}t.insert?s>=0&&a<0?(n=s,o=u,i=f,d=u,e.addColumns(o,i),t.copy?e.copyTo(-1,o<=n?n+i:n,-1,o,-1,i,h):(e.moveTo(-1,o<=n?n+i:n,-1,o,-1,i,h),e.deleteColumns(o<=n?n+i:n,i),n<o&&(d=o-i)),B(e,-1,d,P(e),i)):a>=0&&s<0&&(n=a,o=l,i=c,g=l,e.addRows(o,i),t.copy?e.copyTo(o<=n?n+i:n,-1,o,-1,i,-1,h):(e.moveTo(o<=n?n+i:n,-1,o,-1,i,-1,h),e.deleteRows(o<=n?n+i:n,i),n<o&&(g=o-i)),B(e,g,-1,i,H(e))):(t.copy?e.copyTo(a,s,l,u,c,f,h):e.moveTo(a,s,l,u,c,f,h),e&&(B(e,l,u,c,f),m=t.io,t.copy||e.isDirtySuspended()||(m._z=y.aA(e,m.cA,a,s,c,f)),e.isDirtySuspended()||(m.dA=y.aA(e,m.fA,l,u,c,f)))),v=!0}finally{e._eventHandler.gA={},y.Mz(e,!0),e.vxb=!1,r.Commands.$xb(p,t)}L(e)}return v},t.prototype.aA=function(e,t,n,o,r,i){var a=new y(e,h(n,o,r,i),this.VQ.option),s=e.tables&&e.tables.$Hb&&e.tables.$Hb(n,o,r,i);return s&&s.length>0&&(this.VQ.tableNamesObj={r:n,c:o,rc:r,cc:i,tableNames:s}),a.uy(t.sy()),v(e,n,o,r,i,a.wy(),0,s),a},t.prototype.oUa=function(){var e=this.kj,t=this.VQ,n=t.io={},o=t.fromRow,r=t.fromColumn,i=t.toRow,a=t.toColumn,s=t.option,l=o<0?0:o,u=r<0?0:r,c=i<0?0:i,f=a<0?0:a,p=o<0?P(e):O(t),d=r<0?H(e):t.columnCount;t.insert||e.isDirtySuspended()||(t.copy||(n.cA=new y(e,h(l,u,p,d),s)),n.fA=new y(e,h(c,f,p,d),s)),n.rA=e.Nr,n.sA=e.Pr,n.tA=e.Jl,n.uA=e.Kl},t.prototype.undo=function(){var e,t,n,o,i,a,s,l,u,c,f,h,p,d,g,m,y,b,C,w,x,A=this;if(A.canUndo()){if(e=A.kj,n=(t=A.VQ).fromRow,o=t.fromColumn,i=t.toRow,a=t.toColumn,s=O(t),l=t.columnCount,!e.pu(n,o,s,l,P(e),H(e)))return!1;if(!t.insert&&!e.pu(i,a,s,l,P(e),H(e)))return!1;u=void 0,c=t.io,A.Lz(e,!0),f=e.parent.sheets,r.Commands._xb(f,t);try{t.insert?o>=0&&n>=0||(o>=0?(u=l,e&&B(e,-1,o,P(e),u)):n>=0&&(u=s,e&&B(e,n,-1,u,H(e)))):(h=n<0?0:n,p=o<0?0:o,d=i<0?0:i,g=a<0?0:a,m=n<0?P(e):s,y=o<0?H(e):l,e&&(B(e,n,o,s,l),b=t.tableNamesObj,C=[],w=[],b&&(b.r===d&&b.c===g&&b.rc===m&&b.cc===y?w=b.tableNames:C=b.tableNames),v(e,d,g,m,y,c.dA?c.dA.wy():[],0,C,!0),v(e,h,p,m,y,c._z?c._z.wy():[],0,w,!0))),e&&(-1!==c.tA&&-1!==c.uA&&((x=e.getSelections()[0]).contains(c.tA,c.uA)?e.Jr(c.tA,c.uA):e.Jr(x.row,x.col)),-2!==c.rA&&-2!==c.sA&&-1!==c.tA&&-1!==c.uA&&e.showCell(c.tA,c.uA,3,3))}finally{A.Mz(e,!0)}L(e)}return!0},t}(m),r.Commands[S]={canUndo:!0,execute:function(e,t,n){return r.Commands.h4(e,D,t,n)}},r.Commands[T]={canUndo:!0,execute:function(e,t,n){return r.Commands.h4(e,j,t,n)}}},"./dist/plugins/fill/fill-event.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M;function S(e){return e.rowViewportIndex}function T(e){return e.colViewportIndex}function N(e){return e.hitTestType}function I(e,t){return e.getRowCount(t)}function R(e,t){return e.getColumnCount(t)}function k(e){return e.colCount}function E(e){return e.rowCount}function D(e){return e.height}function j(e){return e.width}function _(e,t,n,o,i){var a,s,l;e.save(),t===o?(e.rect(t-2,n,7,y(i-n)),e.clip(),e.beginPath(),n<i?(n-=3,i+=3):(n+=3,i-=3),a=r.zF(t-1,n-1,o-1,i+1,w,7),s=r.zF(t,n,o,i,w,7),l=r.zF(t+1,n-1,o+1,i+1,w,7)):n===i&&(e.rect(t,n-2,y(o-t),7),e.clip(),e.beginPath(),t<o?(t-=3,o+=3):(t+=3,o-=3),a=r.zF(t-1,n-1,o+1,i-1,w,7),s=r.zF(t,n,o,i,w,7),l=r.zF(t-1,n+1,o+1,i+1,w,7)),a&&a.vE(e),s&&s.vE(e),l&&l.vE(e),e.stroke(),e.beginPath(),e.restore()}function O(e,t,n,o,i,a,s,l,u,c,f){var h=t?r.Events.DragDropBlock:r.Events.DragDropBlockCompleted,p={sheet:e,sheetName:e.name(),fromRow:n,fromCol:o,toRow:i,toCol:a,rowCount:s,colCount:l,copy:u,insert:c,copyOption:f};return t&&(p.cancel=!1),e.Wq(h,p),p.cancel}function F(e,t,n,o,r){var i,a,s;for(i=0;i<n.rowCount;i++){for(a=0;a<n.colCount;a++){if(!(s=e.getSpan(n.row+i,n.col+a))||s.rowCount!==t.rowCount||s.colCount!==t.colCount)return!1;o&&(a+=t.colCount)}r&&(i+=t.rowCount)}return!0}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("Core"),i=n("SheetsCalc"),a=n("./dist/plugins/fill/fill-ui.js"),s=n("./dist/plugins/fill/fill.js"),l=n("./dist/plugins/fill/fill.ns.js"),u=n("@grapecity/js-calc"),c=!!u,f=r.GC$,h=r.kf,p=o.Common.j.Fa,d=null,g=void 0,m=Math.min,y=Math.abs,v=Math.max,b="drag",C="corner",w="black",x=2047,A=new o.Common.ResourceManager(l.SR),M=A.getResource.bind(A),f.extend(r.iI.prototype,{gG:function(e){var t,n,o,r,i,a,s,l,u=this;u.zG||(t=u.kj,n=d,1===(o=t._modelManager.getSelections()).length?n=o[0]:o.length<1&&(n=t._modelManager.getSpan(t.Jl,t.Kl)),n&&(u.zG=!0,u._isWorking=!0,u.L_=n,r=t.getRangeRect(S(e),T(e),n),(i=u.gA).x=r.x,i.y=r.y,i.width=r.width-1,i.height=r.height-1,i.row=n.row,i.col=n.col,i.rowCount=E(n),i.colCount=k(n),a=t.Tq(n),s=e.row,l=e.col,s<a.row&&(s=a.row),s>=a.row+E(a)&&(s=a.row+E(a)-1),l<a.col&&(l=a.col),l>=a.col+k(a)&&(l=a.col+k(a)-1),i.hitRow=s,i.hitCol=l,i.rowOffset=s-a.row,i.colOffset=l-a.col,u.rG={KG:S(e),MG:T(e),sG:N(e)},u.qG()))},AG:function(){var e,t,n,o,r,i,a,s,l,u,c=this;c.rG&&c._isWorking&&c.zG&&c.L_&&(e=c.$F,t=c.gA,o=(n=c.kj.getCellRect(t.hitRow,t.hitCol)).width/2,r=n.x+o,i=n.height/2,a=n.y+i,t.hitTarget={x:e.x,y:e.y},s=c.fH(),l=c.gH(),u=!1,(y(r-e.x)>o+5||y(a-e.y)>i+5)&&(u=!0),s>=0&&l>=0&&u&&c.M_(s,l),c.NG())},M_:function(e,t){var n,o,r,i,a,s,l,u,c=this;c.zG&&c.L_&&(n=c.kj,o=c.gA,-1===(r=n._getActiveSelectedRange()).row&&-1!==r.col?(o.row=-1,o.col=v(0,m(R(n)-k(o),t-o.colOffset))):-1!==r.row&&-1===r.col?(o.row=v(0,m(I(n)-E(o),e-o.rowOffset)),o.col=-1):(o.row=o.row<0?-1:v(0,m(I(n)-E(o),e-o.rowOffset)),o.col=o.col<0?-1:v(0,m(R(n)-k(o),t-o.colOffset))),o.hitRow=e,o.hitCol=t,i=n.Tq(o),(a=c.N_)&&i.row===a.row&&i.col===a.col&&E(i)===E(a)&&k(i)===k(a)&&i.row>n.ar()&&i.col>n.$q()&&i.row+E(i)-1<n.ir()&&i.col+k(i)-1<n.dr()||(c.MI=i,n._render.QH(),c.N_=i,(s=n.parent)&&s.options.showDragDropTip&&(l=o.x+o.width+5,u=o.y+o.height+5,s.uw(c.O_(i),l,u))))},O_:function(e){var t,n,o,r,a,s,l,f,h;return e&&c?(n=(t=this.kj)._getActiveSelectedRange(),a=void 0,o=(o=t.getActiveRowIndex())<0?0:o,r=(r=t.getActiveColumnIndex())<0?0:r,1===E(n)&&1===k(n)?a=u.rf(d,d,e.row-o,e.col-r,!0,!0):(s=void 0,l=void 0,f=void 0,h=void 0,-1===n.row&&n.col>=0?(s=f=i.BAND_INDEX_CONST,l=e.col-r,h=e.col-r+k(n)-1):-1===n.col&&n.row>=0?(l=h=i.BAND_INDEX_CONST,s=e.row-o,f=e.row-o+E(n)-1):n.row>=0&&n.col>=0&&(s=e.row-o,f=e.row-o+E(n)-1,l=e.col-r,h=e.col-r+k(n)-1),a=u.uf(d,d,s,l,f,h,!0,!0,!0,!0,o,r)),t.Cf().unparse(t.yj(),a,o,r)):g},wH:function(){var e,t,n,o,i,a,s,l,u,f,p,g,m=this,y=!1,v="",b=!1,C=m.kj;m.rG=d,m.RG(),e=(t=C._getActiveSelectedRange())&&(E(t)>0||k(t)>0)?{r:t.row,c:t.col,rc:E(t),cc:k(t)}:{r:C.Jl,c:C.Kl,rc:1,cc:1},!0===m.zG&&!0===m._isWorking&&(n=e.r,o=e.c,i=e.rc,a=e.cc,s=m.gA.row,l=m.gA.col,u=C.options.protectionOptions,void 0,f={fromRow:n,fromColumn:o,rowCount:i,columnCount:a,toRow:s,toColumn:l,isDragInsert:m.OH,isDragCopy:m.PH},C.Wq(r.Events.BeforeDragDrop,f),(v=f.invalidMessage)&&0!==v.length||(!m.OH||-1!==n&&-1!==o?s===n&&l===o||((C.qu(n,o,i,a)||C.qu(s,l,i,a))&&(y=!0,v=M().Exp_ChangeMergedCell),y||c&&(C.Ns(n,o,i,a)||C.Ns(s,l,i,a))&&(y=!0,v=M().Exp_ChangePartOfArray),!y&&C.options.isProtected&&(!m.PH&&C.ou(h(n,o,i,a))||C.ou(h(s,l,i,a)))&&(y=!0,v=M().Exp_CellReadOnly),y||(O(C,!0,n,o,s,l,i,a,m.PH,!1,x)||(b=C.wu().execute({cmd:"dragDrop",sheetName:C.name(),fromRow:n,fromColumn:o,toRow:s,toColumn:l,rowCount:i,columnCount:a,copy:m.PH,insert:!1,option:x}),O(C,!1,n,o,s,l,i,a,m.PH,!1,x)))):o>=0?(m.PH&&(l<=o||l>=o+a)||!m.PH&&(l<o||l>o+a))&&((C.qu(-1,o,-1,a)||C.qu(-1,l,-1,0))&&(y=!0,v=M().Exp_ChangeMergedCell),p=u&&u.allowDragInsertColumns,!y&&C.options.isProtected&&!0!==p&&(y=!0,v=M().Exp_ColumnReadOnly),y||(O(C,!0,-1,o,-1,l,-1,a,m.PH,!0,x)||(b=C.wu().execute({cmd:"dragDrop",sheetName:C.name(),fromRow:-1,fromColumn:o,toRow:-1,toColumn:l,rowCount:-1,columnCount:a,copy:m.PH,insert:!0,option:x}),O(C,!1,-1,o,-1,l,-1,a,m.PH,!0,x)))):n>=0&&o<0&&(m.PH&&(s<=n||s>=n+i)||!m.PH&&(s<n||s>n+i))&&((C.qu(n,-1,i,-1)||C.qu(s,-1,0,-1))&&(y=!0,v=M().Exp_ChangeMergedCell),y||c&&(C.Ns(n,-1,i,-1)||C.Ns(s,-1,0,-1))&&(y=!0,v=M().Exp_ChangePartOfArray),g=u&&u.allowDragInsertRows,!y&&C.options.isProtected&&!0!==g&&(y=!0,v=M().Exp_RowReadOnly),y||(O(C,!0,n,-1,s,-1,i,-1,m.PH,!0,x)||(b=C.wu().execute({cmd:"dragDrop",sheetName:C.name(),fromRow:n,fromColumn:-1,toRow:s,toColumn:-1,rowCount:i,columnCount:-1,copy:m.PH,insert:!0,option:x}),O(C,!1,n,-1,s,-1,i,-1,m.PH,!0,x)))))),m._isWorking=!1,m.zG=!1,m.L_=d,m.OH=!1,m.PH=!1,m.N_=d,m.xw(),b||(m.gA={},C.repaint()),y&&C.Os(3,v)},hG:function(e){var t=this;!0!==t.BG&&!0!==t._isWorking&&(t.P_(),t.A$&&(t._isWorking=!0,t.BG=!0,t.$I=!0,t.Q_=e,t.R_=T(e),t.S_=S(e),t.T_=T(e),t.U_(),t.rG={KG:S(e),MG:T(e),sG:N(e)},t.qG()))},U_:function(){var e,t=this,n=function(e){return e.frozenRowCount()}(t.kj),o=function(e){return e.frozenColumnCount()}(t.kj),r=t.V_();r>=0&&r<n?t.W_=0:r>=n&&r<=I(t.kj)&&(t.W_=1),t.X_()?t.Y_=1:t.Y_=t.Q_,(e=t.Z_())>=0&&e<o?t.__=0:e>=o&&e<=R(t.kj)&&(t.__=1),t.a0()?t.b0=1:t.b0=t.R_},CG:function(){var e,t,n=this;n.rG&&n.BG&&n._isWorking&&n.A$&&(n.S_=n.iH(),n.T_=n.jH(),n.c0=n.fH(),n.d0=n.gH(),n.c0>=0&&n.d0>=0&&(n.e0(),n.f0(),e=n.kj.parent,t=!1,n.g0()&&(t=n.h0(n.A$,n.A_,!0)),e&&e.options.showDragFillTip&&t&&n.i0(),n.j0()),n.NG())},k0:function(){var e,t,n,r,i,a,l,u,c,f,h,p=this,g=p.kj,m=p.A$,y=p.A_,v=g.parent.options.defaultDragFillType,b=p.l0(3===v?5:v,3===v),C=p.m0(),w=p.g0();return 1===b?(e=0===C||1===C?1:0,n=new s.z$(g).B$(w,e,!0),t=p.n0(C,y,m),i=(r=g.getActualStyle(t.row,t.col)).cellType||g.Al(),a=r.formatter?r.formatter:r._autoFormatter,l=o.Formatter&&o.Formatter.GeneralFormatter,n instanceof Date&&l&&(a=new l(o.Common.CultureManager.q4().DateTimeFormat.shortDatePattern+" hh:mm:ss AM/PM;@","0")),c=3,(u=p.rG)&&(c=u.sG),f={sheet:g,row:t.row,col:t.col,sheetArea:c,quotePrefix:r.quotePrefix},h={},i.format(n,a,h,f)):0===b?(t=p.n0(C,y,m),g.getFormula(t.row,t.col)?d:g.getText(t.row,t.col)):d},n0:function(e,t,n){var o,r=n.row,i=n.col,a=E(n),s=k(n),l=h(r,i,1,1);return 3===e?(o=0===(o=E(t)%a)?r+a-1:r+o-1,l.row=o,l.col=i):1===e?(o=0===(o=k(t)%s)?i+s-1:i+o-1,l.row=r,l.col=o):0===e?(o=0===(o=k(t)%s)?i:i+s-o,l.row=r,l.col=o):2===e&&(o=0===(o=E(t)%a)?r:r+a-o,l.row=o,l.col=i),l},i0:function(){var e,t,n,o,r,i,a=this,s=a.kj;return 4===a.l0()||a.a0()||a.X_()?(a.xw(),d):(o=a.m0(),r=a.g0(),i=s.cm(r),n=a.k0(),3===o||1===o?(e=i.x+i.width+3,t=i.y+i.height+3):0===o?(e=i.x+3,t=i.y+i.height+3):2===o&&(e=i.x+i.width+3,t=i.y+3),void a.uw(n,e,t))},j0:function(){var e=this;e.o0(),e.p0(),e.q0(),e.r0=e.g0()},o0:function(){var e,t=this.kj;this.r0&&((e=t.cm(this.r0)).x-=2,e.y-=2,e.width+=4,e.height+=4,t._render.dm(e))},p0:function(e){this.kj._render.im(this.A$,d,e)},q0:function(){var e,t,n=this.kj,o=n._render,r=this.g0();r&&(e=o.bm(),t=n.cm(r),e.save(),e.beginPath(),o.RI(e,t),e.restore())},f0:function(){this.A_=this._I()},a0:function(){return-1===this.A$.col&&-1!==this.A$.row},X_:function(){return-1===this.A$.row&&-1!==this.A$.col},ZI:function(){return 4===this.dJ||5===this.dJ},_I:function(){var e=this,t=-1,n=-1,o=-1,r=-1;switch(e.dJ){case 0:e.X_()?(t=-1,o=-1):(t=e.V_(),o=E(e.A$)),n=e.d0,r=e.Z_()-n;break;case 1:e.X_()?(t=-1,o=-1):(t=e.V_(),o=E(e.A$)),n=e.s0()+1,r=e.d0-n+1;break;case 2:t=e.c0,o=e.V_()-t,e.a0()?(n=-1,r=-1):(n=e.Z_(),r=k(e.A$));break;case 3:t=e.t0()+1,o=e.c0-t+1,e.a0()?(n=-1,r=-1):(n=e.Z_(),r=k(e.A$));break;case 5:t=e.c0,o=e.t0()-t+1,e.a0()?(n=-1,r=-1):(n=e.Z_(),r=k(e.A$));break;case 4:e.X_()?(t=-1,o=-1):(t=e.A$.row,o=E(e.A$)),n=e.d0,r=e.s0()-n+1}return h(t,n,o,r)},u0:function(){var e=this.t0();return-1!==e?this.kj.Gr(this.Y_).findRow(e):d},v0:function(){return this.kj.Gr(this.S_).findRow(this.w0())},w0:function(){return this.kj.getViewportBottomRow(this.S_)},x0:function(){var e=this.s0();return-1!==e?this.kj.Hr(this.b0).findCol(e):d},y0:function(){return this.kj.Hr(this.T_).findCol(this.z0())},z0:function(){return this.kj.getViewportRightColumn(this.T_)},e0:function(){var e,t,n,o,r,i,a,s,l,u,c,h,p,d,g,v,b,C,w,x=this,A=x.a0(),M=x.X_(),S=f(x.kj.Ws()).offset(),T=x.$F.e,N=x.$F.x,I=x.$F.y,R=T.pageX-S.left,k=T.pageY-S.top,E=!1;A||M?M?x.d0>=x.Z_()&&x.d0<=x.s0()?x.dJ=4:x.d0<x.Z_()?x.dJ=0:x.d0>x.s0()&&(x.dJ=1):A&&(x.c0>=x.V_()&&x.c0<=x.t0()?x.dJ=5:x.c0<x.V_()?x.dJ=2:x.c0>x.t0()&&(x.dJ=3)):x.c0>=x.V_()&&x.c0<=x.t0()?x.d0>=x.Z_()&&x.d0<=x.s0()?(e=y(x.d0-x.s0()),(t=y(x.c0-x.t0()))>e?x.dJ=5:t<e?x.dJ=4:((n=x.u0())||(n=x.v0()),I>n.y+n.height?x.dJ=3:((o=x.x0())||(o=x.y0()),r=o.x+o.width-N,i=n.y+n.height-I,R>=o.x&&R<=o.x+o.width&&k>=n.y&&k<=n.y+n.height?x.dJ=r>=i?4:5:E=!0))):x.d0<x.Z_()?x.dJ=0:x.d0>x.s0()&&(x.dJ=1):x.c0<x.V_()?x.d0>=x.Z_()&&x.d0<=x.s0()?x.dJ=2:x.d0<x.Z_()?(e=y(x.d0-x.Z_()),t=y(x.c0-x.V_()),x.dJ=t>=e?2:0):x.d0>x.s0()&&(e=y(x.d0-x.s0()),t=y(x.c0-x.V_()),x.dJ=t>=e?2:1):x.c0>x.t0()&&(x.d0>=x.Z_()&&x.d0<=x.s0()?x.dJ=3:x.d0<x.Z_()?(e=y(x.d0-x.Z_()),t=y(x.c0-x.t0()),x.dJ=t>=e?3:0):x.d0>x.s0()&&(e=y(x.d0-x.s0()),t=y(x.c0-x.t0()),x.dJ=t>=e?3:1)),(a=x.kj._render.rH)&&(u=(s=x.t0())+1,c=(l=x.s0())+1,h=x.kj.getRowHeight(s,3),p=x.kj.getColumnWidth(l,3),d=x.kj.getRowHeight(u,3),g=x.kj.getColumnWidth(c,3),v=a.x+a.width/2-m(10,p/2),b=a.x+a.width/2+m(10,g/2),C=a.y+a.height/2-m(10,h/2),w=a.y+a.height/2+m(10,d/2),!1,(A||M?M?v<=R&&R<=b:C<=k&&k<=w:v<=R&&R<=b&&C<=k&&k<=w)||E?(x.$I=!0,x.dJ=4):x.$I=!1)},V_:function(){return this.A$?-1===this.A$.row?0:this.A$.row:-1},t0:function(){var e=this;return e.A$?-1===e.A$.row?I(e.kj)-1:e.A$.row+E(e.A$)-1:-1},Z_:function(){return this.A$?-1===this.A$.col?0:this.A$.col:-1},s0:function(){var e=this;return e.A$?-1===e.A$.col?R(e.kj)-1:e.A$.col+k(e.A$)-1:-1},hla:function(e,t){var n,o,r,i,a,s,l=h(t.row,t.col,t.rowCount,t.colCount),u=this.kj;return u._modelManager.findSpan(e.row,e.col)&&(n=e.rowCount,o=l.rowCount,0!==Math.floor(o%n)&&(r=Math.ceil(o/n)*n,l.row+r<=u.getRowCount()&&(l.rowCount=r)),i=e.colCount,a=l.colCount,0!==Math.floor(a%i)&&(s=Math.ceil(a/i)*i,l.col+s<=u.getColumnCount()&&(l.colCount=s))),l},xH:function(){var e,t,n,o,r,i,a=this,s=a.kj;return a.rG=d,a.RG(),a.xw(),a.BG&&a._isWorking?(a.BG=!1,a._isWorking=!1,void((e=a.g0())&&(t=a.h0(a.A$,a.A_),!t||a.$I?(a.A0(),a.WA(e)):(n=s._eventHandler.A$,o=a.hla(n,a.A_),r=a.l0(),s.wu().execute({cmd:"fill",sheetName:s.name(),startRange:n,fillRange:o,autoFillType:r,fillDirection:s._eventHandler.m0()}),i=a._$,!i&&a.B0()&&s.parent.options.showDragFillSmartTag&&4!==a.$$?a.C0(a.$$):a.WA(e),a.A0())))):void a.A0()},C0:function(e){var t=this.kj,n=t._render.rH,o={x:n.x+n.width,y:n.y+n.height,fillType:e};t.NF=new a.K_(t.parent.xv(),t,o),t.NF.OT()},P_:function(){var e=this.kj,t=e._modelManager.getSelections();1===t.length?this.A$=t[0]:e.Jl>=0&&e.Kl>=0&&(this.A$=h(e.Jl,e.Kl,1,1))},A0:function(){this._isWorking=!1,this.BG=!1},WA:function(e){this.kj._render.im(e)},l0:function(e,t){var n=this,o=n.kj,r=e!==g?e:o.parent.options.defaultDragFillType;return n.ZI()?4:5!==r?r:1===E(n.A$)&&1===k(n.A$)&&!n.X_()&&!n.a0()?n.RH&&!t?1:0:n.RH&&!t?0:1},g0:function(){var e,t,n,o,r=this;return r.A$?r.ZI()?r.A$:r.A_?(e=0,t=0,n=0,o=0,r.D0()?(e=2===r.dJ?r.A_.row:r.A$.row,t=E(r.A$)+E(r.A_),n=r.A$.col,o=k(r.A$)):(e=r.A$.row,t=E(r.A$),n=0===r.dJ?r.A_.col:r.A$.col,o=k(r.A$)+k(r.A_)),h(e,n,t,o)):d:d},h0:function(e,t,n){var o=this.kj,r=!0,i="";return o._modelManager.MTa(t.row,t.col,E(t),k(t))&&!function(e,t,n){var o,r=t.row,i=t.rowCount,a=t.col,s=t.colCount,l=n.row,u=n.rowCount,c=n.col,f=n.colCount,h=r===l&&i===u,p=a===c&&s===f;return!(!h&&!p)&&(!(!(o=e.getSpan(r,a))||!F(e,o,t,h,p))&&!e._modelManager.qu(l,c,u,f)&&F(e,o,n,h,p))}(o,e,t)&&(r=!1,i=M().Exp_FillRangeContainsMergedCell),r&&o.options.isProtected&&o.ou(t)&&(r=!1,i=M().Exp_FillCellsReadOnly),r||n||o.Os(2,i),r},B0:function(){return this.E0()||this.F0()},E0:function(){return 3===this.dJ||1===this.dJ},F0:function(){return 0===this.dJ||2===this.dJ},D0:function(){return 2===this.dJ||3===this.dJ||5===this.dJ},m0:function(){var e=this.dJ;return e>=0&&e<=3?e:4===e?0:5===e?2:3},tr:function(e,t,n){var o,r,i,a=this,s=d,l=S(e),u=T(e),c=a.kj,f=c.parent;if(p(l)||p(u)||!f.options.allowUserDragDrop&&!f.options.allowUserDragFill)return s;if(-1===(o=c._getActiveSelectedRange()).row&&-1===o.col)return s;if(l>=0&&u>=0&&1===c._modelManager.getSelections().length){if(a.qH(l,u,t,n))return s;(r=c.getRangeRect(l,u,o)).x-4<t&&t<r.x+4&&r.y<=n&&n<r.y+r.height&&(s={action:b,side:"left"}),s||(i=a.kj._render.rH)&&i.x<=t&&t<=i.x+i.width&&i.y<=n&&n<=i.y+i.height&&(s={action:b,side:C}),s||r.x+r.width-4<t&&t<r.x+r.width+4&&r.y<=n&&n<r.y+r.height&&(s={action:b,side:"right"}),s||r.y-4<n&&n<r.y+4&&r.x<=t&&t<r.x+r.width&&(s={action:b,side:"top"}),s||r.y+r.height-4<n&&n<r.y+r.height+4&&r.x<=t&&t<r.x+r.width&&(s={action:b,side:"bottom"}),s&&(t<r.x||t>r.x+r.width||n<r.y||n>r.y+r.height)&&(s.outside=!0)}return f&&f.options.allowUserDragDrop||s&&s.side!==C&&(s.side=d),f&&f.options.allowUserDragFill||s&&s.side===C&&(s.side=d),s},Hyb:function(e,t){var n=this,o=n.kj.getSpan(e,t,3);return o?!p(n.kj.getValue(o.row,o.col,3,0)):!p(n.kj.getValue(e,t,3,0))},Iyb:function(e,t,n,o){var r;for(r=t;r<t+o;r++)if(!this.Hyb(e,r))return!1;return!0},Jyb:function(e,t,n,o){var r;for(r=t;r<t+o;r++)if(this.Hyb(e,r))return!1;return!0},Kyb:function(e,t,n,o){var r,i,a,s,l,u,c,f=this,h=f.kj;if("left"===o){for(r=0;r<t;r++)f.Hyb(e,r)&&(n.searchArray[r]=!0);for(i=t-1,a=1;n.searchArray[i];)i--,a++;n.searchLength=a}if("right"===o){for(s=h.getColumnCount(),l=t;l<s;l++)f.Hyb(e,l)&&(n.searchArray[l-t]=!0);for(u=0,c=1;n.searchArray[u];)u++,c++;n.searchLength=c}return n},Lyb:function(e,t,n,o,r){var i,a,s,l,u,c=this,f=c.kj,h=0,p={searchArray:Array(o),searchLength:1},d={searchArray:Array(f.getColumnCount()-r),searchLength:1};for(i=t;i<n;i++)p=c.Kyb(i,e.col,p,"left"),d=c.Kyb(i,e.col+e.colCount-1,d,"right");for(;c.Jyb(n+h,e.col,1,e.colCount);){for(a=!0,s=!1,p=c.Kyb(n+h,o,p,"left"),d=c.Kyb(n+h,r,d,"right"),l=o-1;l>=o-p.searchLength;l--)if(c.Hyb(n+h,l)){h++,a=!1;break}if(a){for(u=r+1;u<=r+d.searchLength;u++)if(c.Hyb(n+h,u)){h++,s=!0;break}if(!s)return h}}return h},Myb:function(e){for(var t=0;this.Iyb(e.row+e.rowCount+t,e.col,1,e.colCount);)t++;return t},Nyb:function(e){var t,n,o,r,i=this;return i.Iyb(e.row+e.rowCount,e.col,1,e.colCount)?i.Myb(e):(o=e.row-2,r=e.row+e.rowCount,1===e.colCount?n=t=e.col:(t=e.col,n=e.col+e.colCount-1),i.Lyb(e,o,r,t,n))},cyb:function(){var e,t,n,o=this,r=o.kj,i=r._eventHandler.A$,a=o.Nyb(i);0!==a&&(e=h(i.row+i.rowCount,i.col,a,i.colCount),o.dJ=3,o.A_=e,t=o.l0(),n=o._$,r.wu().execute({cmd:"fill",sheetName:r.name(),startRange:i,fillRange:e,autoFillType:t,fillDirection:o.dJ}),!n&&r.parent.options.showDragFillSmartTag&&4!==o.$$&&o.C0(o.$$))}}),f.extend(r.oJ.prototype,{gJ:function(e,t){var n,o=this.kj,i=e.x,a=e.y,s=j(e),l=D(e),u=o._getActiveSelectedRange(),c=o.am(),f=4,h=-2.5;return t>2007&&(f=5,h=-3),n=new r.Rect(-4,-4,f,f),-1===u.col?(n.x=c.kt,n.y=a+l+h):-1===u.row?(n.x=i+s+h,n.y=c.nt):(n.x=i+s+h,n.y=a+l+h),n},eJ:function(e,t,n,o,i){var a,s,l=this,u=l.kj,c=u.am(),f=u.parent,h=f&&f.Vv,p=l.gJ(o,h),d=p.x,g=p.y,m=j(p),y=D(p),b=c.Ft(t,n);i&&!p.intersectRect(i)||p.intersectRect(b)&&(a=-1.5,h>2007&&(a=-1),(s=new r.Rect(d+a,g+a,m+2,y+2)).x=v(s.x,b.x),s.y=v(s.y,b.y),l.dm(s),e.save(),i&&!i.containsRect(p)&&(e.rect(i.x,i.y,j(i),D(i)),e.clip()),e.beginPath(),e.fillStyle=r.Rm.Om(u,u.getSelectionBorderColor()),e.fillRect(d,g,m,y),l.rH=new r.Rect(p.x,p.y,4,4),e.beginPath(),e.restore())},RI:function(e,t){var n=t.x,o=t.y,r=n+j(t),i=o+D(t);_(e,n,o,r,o),_(e,n,i,r,i),_(e,n,o,n,i),_(e,r,o,r,i)},NI:function(e,t){var n,o,i,a,s,l,u,c,f,h,p,d=this,g=d.kj,m=g._eventHandler.gA,y=m.hitTarget;m&&y&&(n=m.hitCol,o=m.hitRow,i=g._eventHandler.OH,a=g.OI,e.save(),!0!==i||-1!==m.row&&-1!==m.col?(a&&(s=new r.Rect(a.x-2,a.y-2,j(a)+4,D(a)+4),d.dm(s,t),d.im(g._getActiveSelectedRange(),t)),e.rect(t.x,t.y,j(t),D(t)),e.clip(),e.beginPath(),d.RI(e,m)):-1===m.row&&-1!==m.col?((l=g.Hr(0).findCol(n))||(l=g.Hr(1).findCol(n)),l||(l=g.Hr(2).findCol(n)),l&&(u=l.x,c=j(l),m.col=n,y.x>u+c/2&&(m.col<g.cr()||m.col===g.dr())&&(u=l.x+j(l),m.col++),a&&0===j(a)||(a=g._eventHandler.gA),a&&(s=new r.Rect(a.x-2,a.y-2,j(a)+4,D(a)+4),d.dm(s,t),d.im(g._getActiveSelectedRange(),t)),g.QI=new r.Rect(u,m.y,0,D(m)),e.rect(t.x,t.y,j(t),D(t)),e.clip(),e.beginPath(),_(e,u,m.y,u,m.y+D(m)))):-1!==m.row&&-1===m.col&&((f=g.Gr(0).findRow(o))||(f=g.Gr(1).findRow(o)),f||(f=g.Gr(2).findRow(o)),f&&(h=f.y,p=D(f),m.row=o,y.y>h+p/2&&(m.row<g.hr()||m.row===g.ir())&&(h=f.y+D(f),m.row++),a&&0===D(a)||(a=g._eventHandler.gA),a&&(s=new r.Rect(a.x-2,a.y-2,j(a)+4,D(a)+4),d.dm(s,t),d.im(g._getActiveSelectedRange(),t)),g.QI=new r.Rect(m.x,h,j(m),0),e.rect(t.x,t.y,j(t),D(t)),e.clip(),e.beginPath(),_(e,m.x,h,m.x+j(m),h))),e.beginPath(),e.restore())},QH:function(){var e,t,n,o,i,a,s,l,u,c,f,h=this,p=h.kj,d=p.yt,g=p._eventHandler.MI;d&&d.dragInfo&&g&&(e=h.bm(),t=p.am(),n=p._eventHandler.gA,o=p.cm(g),i=p.frozenTrailingColumnCount(),a=p.frozenTrailingRowCount(),s=p.getColumnCount()-i,l=p.getRowCount()-a,u=t.Ft(1,1),i>0&&g.col+g.colCount<=s&&o.x+j(o)>u.x+j(u)&&o.intersectRect(u)&&(o=o.getIntersectRect(u)),a>0&&g.row+g.rowCount<=l&&o.y+D(o)>u.y+D(u)&&o.intersectRect(u)&&(o=o.getIntersectRect(u)),c=new r.Rect(t.kt,t.nt,t.lt+t.js,t.ot+t.gs),j(o)>0&&D(o)>0?(n.x=o.x,n.y=o.y,n.width=j(o)-1,n.height=D(o)-1,h.NI(e,c)):0!==j(o)&&0!==D(o)||(n.x=o.x,n.y=o.y,n.width=j(o),n.height=D(o),h.NI(e,c)),f=p._eventHandler.OH,p.OI=!0===f?p.QI:new r.Rect(n.x,n.y,j(n),D(n)))}})},"./dist/plugins/fill/fill-ui.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function H(e,t,n,o,r,i){var l=e.CH,u=l?"160px":"150px",f=l?"25px":"20px",h=a(s("div")).css([A,"min-width",M,"padding",S],["block",u,f,0,0]).addClass("gc-smartMenu-item-default "+n+" ui-state-default"+c),p=a(s("div")).addClass(y).appendTo(h),d=a(s("div")).addClass("gc-menu-item-text").appendTo(h),g=a(s("input")).attr({id:t,value:r,type:"radio",name:"fill-group",style:"display:none"}).appendTo(p);return a(s("span")).text(o).appendTo(d),i?(p.addClass(m),g.prop("checked","checked")):g.prop("checked",""),h}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("Core"),i=n("./dist/plugins/fill/fill.ns.js"),a=r.GC$,s=r.Ul.Nl,l=r.Ul.vl,u=a(document),c=" btn btn-default",h="gc-fill-type-item",p="gc-fill-menu-container",d=(f="ui-state-hover ")+"gc-smartMenu-item-hover",g=f+"gc-smart-tag-hover",m="ui-icon ui-icon-check gc-check-image",y="gc-menu-item-input",v="ui-state-active gc-smart-tag-active",b="gc-tag-container",C="float",w="left",x="top",A="display",M="height",S="margin",T="change",N="input[type=radio]",I="mouseover",R="mouseout",k="click",E="fillTypeChanged",D="keydown.ui-fill",j=new o.Common.ResourceManager(i.SR),_=j.getResource.bind(j),O=function(e){function t(t,n){var o,r=e.call(this,t,l(n.parent._host))||this;return r.kj=n,r.v_=a("."+b),(o=r.w_=r.yo()).addClass(p),H(n,"smartMenuCopyCells",h,_().CopyCells,"0",!0).appendTo(o),H(n,"smartMenuFillSeries",h,_().FillSeries,"1").appendTo(o),H(n,"smartMenuFillFormattingOnly",h,_().FillFormattingOnly,"2").appendTo(o),H(n,"smartMenuFillWithoutFormatting",h,_().FillWithoutFormatting,"3").appendTo(o),r}return P(t,e),t.prototype.Ao=function(){e.prototype.Ao.call(this)},t.prototype.QQ=function(){var e=this;a("."+h).bind(I,(function(){a(this).addClass(d)})).bind(R,(function(){a(this).removeClass(d)})).bind(k,(function(){var t,n=a(this),o=e.v_,r=n.find(N),i=r[0];i.checked=!0,r.trigger(T),o.trigger(k),o.trigger(R),n.removeClass(d),t=parseInt(a(i).attr("value"),10),e.x_(t)})),e.w_.find(N).bind(T,(function(){a("."+y).removeClass(m),a(this).parent().addClass(m)}))},t.prototype.y_=function(){a("."+h).unbind(I).unbind(R).unbind(k),this.w_.find(N).unbind(T)},t.prototype.x_=function(e){var t=this,n=t.kj,o=n._eventHandler;if(t.z_!==e){t.z_=e,n.U$=!0,n.suspendEvent();try{r.Commands.undo.execute(n.parent,{sheetName:n.name()})}finally{n.resumeEvent()}n.U$=!1,n.wu().execute({cmd:"fill",sheetName:n.name(),startRange:o.A$,fillRange:o.A_,autoFillType:e,fillDirection:o.dJ}),t.v_.trigger(E,e)}},t.prototype.MQ=function(){return!!a("."+p).length},t}(r.Go),F=function(e){function t(t,n,o){var r,i=e.call(this,t,l(n.parent._host))||this;return i.kj=n,i.B_=o,r=i.C_=i.yo().addClass("gc-smart-tag-default "+b+" gc-no-user-select ui-widget-header"+c),i.D_=a(s("div")).attr("class","fillSmartTag").css(C,w).appendTo(r),i.E_=a(s("div")).attr("class","fillSmartTagDown").css([C,A],[w,"none"]).appendTo(r),i}return P(t,e),t.prototype.F_=function(e,t,n){var o=this,r=o.kj.CH,i=a(t),s=o.G_,l=o.E_,u=r?"38px":"32px",c=r?"24px":"18px";s&&s.MQ()||(e?i.addClass(g):i.removeClass(g),i.css(["width",M],[e?u:c,c]),n||(e?l.show():l.hide()))},t.prototype.H_=function(){var e=this,t=e.C_,n=r.Ul.rl(),o=r.Ul.Ml.safari&&(n.ipad||n.iphone);t.bind(I,(function(){e.F_(!0,this,o)})).bind(R,(function(){e.F_(!1,this,o)})),t.bind(k,(function(){var t,n,r=a(this),i=e.G_,s=e.E_;i&&i.MQ()?(o&&s.hide(),r.removeClass(v),e.I_()):(o&&s.show(),r.addClass(v),e.J_(),(n=(t=e.w_)&&t.find(N)[e.B_.fillType])&&!n.checked&&(n.checked=!0,a(n).trigger(T)))})),u.bind(D,(function(t){27===t.keyCode&&(e.G_&&e.G_.MQ()?e.I_():e.close(),r.Ul.nl(t))}))},t.prototype.OT=function(){var e=this,t=e.C_,n=e.B_,o=e.kj.CH,r=o?"3px":"0px",i=o?"24px":"18px";t&&(t.css([w,x],[n.x,n.y]),e.Ao(),e.H_(),e.D_.css(S,r),e.E_.css(M,i),e.hZ())},t.prototype.J_=function(){var e,t,n,o,r,i,a,s=this,l=s.kj;s.G_||(s.G_=new O(l.parent.xv(),l),s.w_=s.G_.yo()),t=(e=s.C_).css(w),n=e.css(x),o=parseFloat(n),i=s.G_,a=s.B_,i.z_=a.fillType,isNaN(o)||(r=o+e.height()+2),s.w_.css([w,x],[t,r]),i.Ao(),i.QQ(),i.v_.unbind(E).bind(E,(function(e,t){a.fillType=t}))},t.prototype.I_=function(){var e=this.G_;e&&(e.y_(),e.close())},t.prototype.hZ=function(){var e=this.G_,t=this.C_;e&&(e.MQ()&&t.trigger(k),t.trigger(R))},t.prototype.close=function(){var t,n=this.kj;this.hZ(),u.unbind(D),e.prototype.close.call(this),(t=n.Xs)&&(t.style.cursor="default"),n&&n.zt()},t}(r.Go),t.K_=F},"./dist/plugins/fill/fill.entry.js":function(e,t,n){"use strict";function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),n("./dist/plugins/fill/drag-fill.js"),n("./dist/plugins/fill/fill-event.js"),o(n("./dist/plugins/fill/fill-ui.js")),o(n("./dist/plugins/fill/fill.js")),o(n("./dist/plugins/fill/fill.ns.js"))},"./dist/plugins/fill/fill.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function U(e){return!Z(e)&&u.Na(e)}function Z(e){return"string"==typeof e}function q(e){var t=[e];return t.rowCount=1,t.colCount=v(e),t}function J(e){return e}function Q(e,t,n,r){var i=q(t),a=q(n),s=q([r]),l=e?o.Common.qc(i,a,s,!0,J,c,c,c):o.Common.sc(i,a,s,!0,c,c,c),u=l&&l[0][0];return typeof u===x?o.Common.o.Lma(u,13):u}function Y(e){return e.toLowerCase()}function K(e){var t,n=e.length,o=1;if(n>1)for(o=e[1]-e[0],t=2;t<n;t++)if(o!==e[t]-e[t-1]){o=0;break}return o}function $(e,t){return e>0?(e-1)%t:t-Math.abs(e)%t-1}function X(e){for(var t="",n=0;n<e;)t+="0",n++;return t}function ee(e,t){return 12*(t.getFullYear()-e.getFullYear())+(t.getMonth()-e.getMonth())}function te(e,t){var n,o=e.length,r=!0;for(n=2;n<o&&(r=t===ee(e[n-1],e[n]));n++);return r}function ne(e){return"0"===e[0]}function oe(e,t,n){var o,r,i,a,s,l=n?1:2,u=n?2:1;return t.every((function(t){return!!(o=t.match(e.Yyb))&&(r=o[l],(s=r.length)>e.Zyb&&ne(r)&&(e.Zyb=s),i=parseInt(r,10),a=o[u],d(e.Qyb)&&(e.Qyb=a),a!==e.Qyb?(e.$yb=!0,e.Qyb=c,e.Pyb=[]):e.Pyb.push(i),!0)}))}function re(e){e.forEach((function(e){e&&e.dispose()}))}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("Core"),i=n("@grapecity/js-calc"),a=n("SheetsCalc"),s=n("./dist/plugins/fill/fill.ns.js"),l=!!i,u=o.Common.j,c=null,f=void 0,h=Math.floor,p=r.kf,d=u.Fa,g=u.Pa,m=o.Common.k,y=m.Eb,v=m.ac,b=o.Common.l,C=b.Ra,w=b.Xb,x="number",A="date",M="string",S=new o.Common.ResourceManager(s.SR),T=S.getResource.bind(S),function(e){e[e.copyCells=0]="copyCells",e[e.fillSeries=1]="fillSeries",e[e.fillFormattingOnly=2]="fillFormattingOnly",e[e.fillWithoutFormatting=3]="fillWithoutFormatting",e[e.clearValues=4]="clearValues",e[e.auto=5]="auto"}(t.AutoFillType||(t.AutoFillType={})),function(e){e[e.left=0]="left",e[e.right=1]="right",e[e.up=2]="up",e[e.down=3]="down"}(t.FillDirection||(t.FillDirection={})),function(e){e[e.column=0]="column",e[e.row=1]="row"}(t.FillSeries||(t.FillSeries={})),function(e){e[e.direction=0]="direction",e[e.linear=1]="linear",e[e.growth=2]="growth",e[e.date=3]="date",e[e.auto=4]="auto"}(t.FillType||(t.FillType={})),function(e){e[e.day=0]="day",e[e.weekday=1]="weekday",e[e.month=2]="month",e[e.year=3]="year"}(t.FillDateUnit||(t.FillDateUnit={})),N=function(){function e(e){this.e_=[],this.f_=[],this.Oyb=[],this.Nc=c,this.Pyb=[],this.Qyb=c,this.g_=d(e)?-1:e}return e.prototype.h_=function(){return v(this.e_)},e.prototype.Ey=function(){var e,t,n=this,o=[],r=n.f_;for(e=0;e<v(r);e++)t=r[e],o.push("object"===n.Nc?n.Wh(t):t);return o},e.prototype.i_=function(){var e,t,n,o=this.e_;if(v(o)>0){for(t=[],n=void 0,-1===(e=this.g_)&&(e=o[0]),n=0;n<v(o);n++)t[n]=o[n]-e+1;return t}return c},e.prototype.j_=function(){var e=this.f_;return v(e)?e:c},e.prototype.Eb=function(e,t,n){if(!U(n))throw Error(T().Exp_NumberOnly);var o=this;d(o.Nc)&&(o.Nc=n instanceof Date?A:x),y(o.e_,e,t),y(o.f_,e,g(n))},e.prototype.Sb=function(e,t){var n=this,o=d(n.Nc);U(t)?(o&&(t instanceof Date?n.Nc=A:n.Nc=x),n.f_.push(g(t))):o&&(n.Nc=Z(t)?M:"default"),n.e_.push(e),n.Oyb.push(t)},e.prototype.k_=function(e){return this.Nc===A?this.Wh(e):e},e.prototype.Wh=function(e){var t=c;if(e instanceof Date)t=e;else if(i)try{t=i.Convert.Wh(e)}catch(n){t=e}return t},e}(),I=function(){function e(e){this.Ryb=-1,this.Syb=[],this.Tyb=-1,this.kj=e}return e.prototype.no=function(){this.kj=c},e.prototype.Uyb=function(){var e=this.kj;return e.parent&&e.parent.Txb()||[]},e.prototype.Vyb=function(e){var t,n,o,r,i,a,s,l,u,c,f,h,p,d,g=e.length,m=!1;if(e&&g>0)for(t=Y(e[0]),n=this.Uyb(),o=void 0,r=void 0,i=void 0,a=void 0,s=void 0,l=void 0,o=0;o<n.length;o++)if((a=(i=(r=n[o]).map((function(e){return Y(e)}))).indexOf(t))>=0){for(s=a,u=i.length,c=void 0,f=void 0,h=void 0,p=1;p<g;p++){if(f=Y(e[p]),!((c=i.indexOf(f))>=0)){m=!1;break}if(h=c-s+u,l){if(l!==h){m=!1;break}}else m=!0,l=h,s=c}if(d=1===g,m||d){m=!0,this.Ryb=a,this.Syb=r,this.Tyb=d?1:l;break}}return m},e.prototype.ge=function(e){var t=this.Syb,n=this.Ryb,o=this.Tyb,r=t.length;return t[(n+o*$(e,r))%r]},e}(),R=function(){function e(){this.Uk="",this.Wyb="",this.Tyb=0,this.Xyb=1,this._padding=""}return e.prototype.ge=function(e){var t=this.Tyb*(e-1)+this.Xyb,n=this._padding.length,o=""+Math.abs(t),r=o.length,i=this._padding+o,a=i.length;return o=r>n?o:i.substr(a-n),this.Uk+o+this.Wyb},e}(),E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.azb=0,t.Nc=A,t}return W(t,e),t}(k=function(){function e(){}return e.prototype.match=function(e){return!1},e.prototype.getTargetValue=function(e,t,n,o,r){},e.prototype.resetProp=function(){},e.prototype._yb=function(e,t){return e.indexOf(t+1)},e.prototype.dispose=function(){},e}()),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return W(t,e),t.prototype.match=function(e){var t=this.azb=ee(e[0],e[1]),n=function(e){return e.every((function(e){return 1===e.getDate()}))}(e),o=e.length,r=!0;return n&&o>2&&(r=te(e,t)),n&&r},t.prototype.getTargetValue=function(e,t){var n=e.Oyb[0],o=n.getFullYear(),r=t-1,i=n.getMonth()+this.azb*r;return new Date(o+parseInt(i/12,10),i%12,1)},t}(E),j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return W(t,e),t.prototype.match=function(e){var t=this.azb=ee(e[0],e[1]),n=function(e){return e.every((function(e){var t=e.getFullYear(),n=e.getMonth();return e.getDate()===new Date(t,n+1,0).getDate()}))}(e),o=e.length,r=!0;return n&&o>2&&(r=te(e,t)),n&&r},t.prototype.getTargetValue=function(e,t){var n=e.Oyb[0],o=n.getFullYear(),r=t-1,i=n.getMonth()+this.azb*r,a=o+parseInt(i/12,10),s=i%12;return new Date(a,s,function(e,t){return new Date(e,t+1,0).getDate()}(a,s))},t}(E),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return W(t,e),t.prototype.match=function(e){var t,n,o,r,i,a=!1;return function(e){return e.every((function(e){var t=e.getHours(),n=e.getMinutes(),o=e.getSeconds();return 0!==t||0!==n||0!==o}))}(e)||(t=this.azb=ee(e[0],e[1]),o=(n=function(e){var t=0;return e.every((function(e){var n=e.getDate();return t||(t=n),t===n}))?t:0}(e))>0,r=e.length,i=!0,this.bzb=n,o&&r>2&&(i=te(e,t)),a=o&&i),a},t.prototype.getTargetValue=function(e,t){var n=e.Oyb[0],o=n.getFullYear(),r=t-1,i=n.getMonth()+this.azb*r,a=o+parseInt(i/12,10);return new Date(a,i%12,this.bzb)},t}(E),O=function(e){function t(){var t=e.call(this)||this;return t.Yyb=c,t.Pyb=[],t.Qyb=c,t.$yb=!1,t.Zyb=0,t.Nc=M,t.t_=!1,t.czb=!1,t.dzb=new R,t}return W(t,e),t.prototype.resetProp=function(){this.Pyb=[],this.Zyb=0,this.Qyb=c,this.$yb=!1,this.t_=!1,this.czb=!1},t.prototype.getInternal=function(e){var t,n,o=!1,r=e[0];for(n=1;n<e.length;n++)if(t=e[n],1!==Math.abs(t-r)){o=!0;break}return o},t}(k),F=function(e){function t(t){var n=e.call(this)||this;return n.ezb=new I(t),n}return W(t,e),t.prototype.dispose=function(){var e=this;e.ezb&&(e.ezb.no(),e.ezb=c)},t.prototype.match=function(e){return this.ezb.Vyb(e)},t.prototype.getTargetValue=function(e,t,n,o,r){var i,a=e.Oyb.length,s=this._yb(n,o),l=c;return-1!==s&&(i=a*r+s+1,l=this.ezb.ge(i)),l},t}(O),P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Yyb=/^\d+$/,t}return W(t,e),t.prototype.match=function(e){var t,n,o=this;return e.every((function(e){return!!e.match(o.Yyb)&&((n=e.length)>o.Zyb&&ne(e)&&(o.Zyb=n),t=parseInt(e,10),o.Pyb.push(t),!0)}))},t.prototype.getTargetValue=function(e,t,n,o,r){var i,a=e.Oyb,s=this.dzb,l=K(this.Pyb),u=a.length,f=0!==l,h=f?0:$(t,u),p=this._yb(n,o),d=c;return this.t_=f,this.czb=this.getInternal(e.e_),-1!==p&&(s.Tyb=l,s.Xyb=this.Pyb[h],s._padding=X(this.Zyb),i=u*r+p+1,d=s.ge(i)),d},t}(O),H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Yyb=/^(.*\D+)(\d+)$/,t}return W(t,e),t.prototype.match=function(e){return oe(this,e,!1)},t.prototype.getTargetValue=function(e,t,n,o,r){var i,a=e.Oyb,s=this.dzb,l=K(this.Pyb),u=a.length,f=0!==l,h=f?0:$(t,u),p=this._yb(n,o),d=c;return this.t_=f,this.czb=this.getInternal(e.e_),-1!==p&&(s.Uk=this.Qyb,s.Tyb=l,s.Xyb=this.Pyb[h],s._padding=X(this.Zyb),i=u*r+p+1,d=s.ge(i)),d},t}(O),B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Yyb=/^(\d+)(\D+.*)$/,t}return W(t,e),t.prototype.match=function(e){return oe(this,e,!0)},t.prototype.getTargetValue=function(e,t,n,o,r){var i,a=e.Oyb,s=this.dzb,l=K(this.Pyb),u=a.length,f=0!==l,h=f?0:$(t,u),p=this._yb(n,o),d=c;return this.t_=f,this.czb=this.getInternal(e.e_),-1!==p&&(s.Wyb=this.Qyb,s.Tyb=l,s.Xyb=this.Pyb[h],s._padding=X(this.Zyb),i=u*r+p+1,d=s.ge(i)),d},t}(O),L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return W(t,e),t.prototype.getTargetValue=function(e,t,n){return Q(!0,e.j_(),n,t)},t}(k),z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.t_=!0,t}return W(t,e),t.prototype.getTargetValue=function(e,t,n,o){var r=e.Oyb;return r[$(t,r.length)]},t}(k),V=function(){function e(e){this.fzb=[new D,new j,new _],this.gzb=[new F(e),new P,new H,new B],this.hzb=new L,this.izb=new z}return e.prototype.getRule=function(e,t){var n,o,r,i=[],a=this.izb;for(e===A?(i=this.fzb,a=this.hzb):e===M?i=this.gzb:e===x&&(a=this.hzb),n=0;n<i.length;n++)if(r=void 0,(o=i[n]).resetProp(),o.match(t)){if(r=o.$yb,d(r)||!1===r)return o;if(!0===r)return a}return a},e.prototype.no=function(){var e=this;e.fzb&&(re(e.fzb),e.fzb=c),e.gzb&&(re(e.gzb),e.gzb=c),e.hzb&&(e.hzb.dispose(),e.hzb=c),e.izb&&(e.izb.dispose(),e.izb=c)},e}(),t.Gyb=V,G=function(){function e(e){this.kj=e,this.AX=!1,this.cLb=[]}return e.prototype.D$=function(e,t,n,o,r){var i=e?1:2;d(o)&&d(r)?this.E$(t,n,i):this.E$(t,n,i,o,r,c)},e.prototype.E$=function(e,t,n,o,r,i){var a,s,l,u,c,f,h,p,d,g,m,y,b,C,w,x,A,M,S=this,N=S.kj,I=N.Tq(e),R=I.row,k=I.col,E=I.rowCount,D=I.colCount;if(N._modelManager.MTa(R,k,E,D))throw Error(T().Exp_RangeContainsMergedCell);for(h=0,d=(p=1===t)?D:E,g=p?R:k,m=p?R+E:k+D,y=(f=arguments.length>3)?1:d,C=(b=this.kj._eventHandler.A$).row===R&&b.rowCount===E&&b.col>k||b.col===k&&b.colCount===D&&b.row>R,a=g;a<m;a++)if(w=C&&f?k+D-1:k,x=C&&f?R+E-1:R,(A=p?S.l_(a,w,1,y,t):S.l_(x,a,y,1,t))&&A.h_())for(u=A.e_[0],f?(c=C?A.f_[v(A.f_)-1]:A.f_[0],s=S.m_(C,c,d,n,o,r,i),C&&(h=d-v(s),u=A.e_[v(A.e_)-1])):s=S.n_(A,d,n),l=0;l<v(s);l++)M=A.k_(s[l]),p?S.o_(N,a,u,a,k+h+l,M,n):S.o_(N,u,a,R+h+l,a,M,n)},e.prototype.l_=function(e,t,n,o,r){for(var i,a=c,s=this.kj,l=1===r,u=l?t+o-1:e+n-1,f=l?t:e;u>=f;)U(i=l?s.getValue(e,u):s.getValue(u,t))&&(a||(a=new N(f)),a.Eb(0,u,i)),u--;return a},e.prototype.m_=function(e,t,n,o,r,i,a){var s,l,u,c=[],f=t,h=r>=0,p=d(i);for(s=0;s<n;s++)l=f>=i,u=f<=i,e&&(p||h&&l||!h&&u)?(c.unshift(f),1===o?f-=r:2===o?f/=r:3!==o||d(a)||(f=this.p_(!0,a,t,f,r,s+1))):!e&&(p||h&&u||!h&&l)&&(c.push(f),1===o?f+=r:2===o?f*=r:3!==o||d(a)||(f=this.p_(!1,a,t,f,r,s+1)));return c},e.prototype.n_=function(e,t,n){var o,r=[],i=1===n;if(i||2===n){for(1===e.h_()&&e.Sb(e.e_[0]+1,i?e.k_(e.f_[0]+1):e.Ey()[0]),o=0;o<t;o++)r.push(Q(!!i,e.j_(),e.i_(),o+1));return r}return c},e.prototype.B$=function(e,t,n,o,r){var i=this.kj,a=i._modelManager,s=i.Tq(e),l=s.row,u=s.col,c=s.rowCount,f=s.colCount,h=i.Tq(i._eventHandler.A$),p=h.row,d=h.col;if(a.qu(p,d,h.rowCount,h.colCount)||a.qu(l,u,c,f))throw Error(T().Exp_ChangeMergedCell);return this.q_(h,c,f,t,n,!(l<p||u<d),o,r)},e.prototype.q_=function(e,t,n,o,r,i,a,s){var l,u,d,g,m=this,y=i?1:-1,v=e.row,b=e.col,C=e.rowCount,w=e.colCount;if(1===o){if(l=h(n/w),u=n%w,!r)for(g=1;g<l;g++)d=p(v,b+g*y*w,C,w),m.r_(e,d,o,4,r,i,f,f,f,a,s);if(r&&l>1&&0===u&&(l-=1,u=w),l>0&&u>0)return d=p(v,i?b+l*w:b-l*w+w-u,C,u),m.r_(e,d,o,4,r,i,c,i?0:w-u,f,a,s)}else{if(l=h(t/C),u=t%C,m.AX||(d=p(v+y*C,b,t-C,n),m.dLb(e,d,y)),!r)for(g=1;g<l;g++)d=p(v+g*y*C,b,C,w),m.r_(e,d,o,4,r,i,c,c,!0,a,s);if(r&&l>1&&0===u&&(l-=1,u=C),l>0&&u>0)return d=p(i?v+l*C:v-l*C+C-u,b,u,w),m.r_(e,d,o,4,r,i,i?0:C-u,c,!0,a,s)}},e.prototype.r_=function(e,t,n,o,r,i,a,s,l,u,f){var h,p,g,m,y,v,b,C,w,S,T,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,q,J,Q,Y,K,$=this,X=$.kj,ee=1===n,te=ee?e.row:e.col,ne=ee?e.col:e.row,oe=ee?t.row:t.col,re=ee?t.col:t.row,ie=ee?e.rowCount:e.colCount,ae=ee?e.colCount:e.rowCount,se=ee?t.colCount:t.rowCount;for(m=0;m<ie;m++){for(v=c,b=c,C=0,T=w=te+m,I=S=oe+m,R=(ee?s:a)||0,k=ee?0:R,E=ee?c:l,D=c;C<ae;)if(O=c,F=j=ne+C,P=_=re+C-R,ee||(w=j,j=T,S=_,_=I),g=X._modelManager.findSpan(w,j),(h=X.getFormula&&X.getFormula(w,j))&&""!==h||(O=X.getValue(w,j)),(H=$.AX)&&d(D)&&(D=!1===i?X.getValue(ne+ae-1,j):X.getValue(w,j)),H||4!==o||!U(O)&&!Z(O)||(v||(v=new N),p=U(O)?O instanceof Date?A:x:M,b||(b=p),b!==p))if(!H&&O&&v&&v.h_()){if(y=$.s_(ee,e,t,T,I,v,r,i,k,E,u,f),r&&y)return y;v=c,b=c}else{if(H||!g||g&&(ee?g.row:g.col)===T)if(B=P===re+se-1,L=H?D:O,r){if(H)return L;if(g&&B||!g&&(B&&i||!i&&P===re))return O}else P<re+se&&P>=re&&(H||ee||!ee&&!(l&&X.Ps&&X.Ps(P)))&&(H&&-1!==$.cLb.indexOf(S)||$.o_(X,w,j,S,_,L,o,u,f));g?C+=ee?g.colCount:g.rowCount:C++}else v.Sb(F,O),g?C+=ee?g.colCount:g.rowCount:C++;if($.AX)for(z=e.row,V=e.col,G=e.rowCount,W=e.colCount,q=void 0,J=void 0,Q=!1===i?-1:1,Y=1;Y<G;Y++)for(q=z+Q*Y,K=0;K<W;)J=V+K,-1===$.cLb.indexOf(q)&&$.o_(X,z,V,q,J,D,o,u,f),K++;if(v&&v.h_()&&(y=$.s_(ee,e,t,T,I,v,r,i,k,E,u,f),r&&!d(y)))return y}return c},e.prototype.dLb=function(e,t,n){var o,r,i,a,s,l,u,c=this,f=c.kj,h=f.tables,p=e.union(t),d=p.row,g=p.rowCount,m=e.row,y=e.col,v=e.rowCount,b=e.colCount;if(h)for(o=h.s$(m,y,v,b),r=0;r<o.length;r++)if(i=o[r].xr,a=c.cLb,s=void 0,i&&i.isFiltered&&i.isFiltered()){for(l=0;l<g;l++)s=d+n*l,i.isRowFilteredOut(s)&&c.cLb.push(s);if(a.length>0){c.AX=!0;break}}if(u=f.xr,!0!==c.AX&&u&&u.isFiltered&&u.isFiltered()){for(a=c.cLb,s=void 0,l=0;l<g;l++)s=d+n*l,u.isRowFilteredOut(s)&&c.cLb.push(s);a.length>0&&(c.AX=!0)}},e.prototype.o_=function(e,t,n,o,r,i,s,u,f){var h,p,d,g=e._modelManager;l&&(e.hasFormula(t,n)||e.hasFormula(o,r))&&(e.setFormula(o,r,c),0!==s&&4!==s||(h=e.Bj(),e.getFormula(t,n)&&a.CalcOperatorAdjustor.copyFormula(h,t,n,h,o,r,1,1))),e.setValue(o,r,i),d=f?0:64,u&&(d|=128),d|=1024,e.copyTo(t,n,o,r,1,1,d),e.removeSpan(o,r,3),(p=g.findSpan(t,n))&&t===p.row&&n===p.col&&e.Sq(o,r,p.rowCount,p.colCount,3)},e.prototype.s_=function(e,t,n,o,r,i,a,s,l,u,f,h){var p,d,g,m,y,v,b,C,w,x,S,T,N,I,R,k,E=this,D=E.kj,j=e?n.col:n.row,_=e?t.col:t.row,O=e?n.colCount:n.rowCount,F=e?t.colCount:t.rowCount;if(l=l||0,y=i.h_(),v=(j-_-l)/F,b=E.t_(i.e_,i.f_),C=i.Nc,b){for(g=[],d=0;d<y;d++)g[d]=d+1;p=y}else m=i.e_[0],p=i.e_[y-1]-m+1,1===y&&C!==M&&i.Sb(i.e_[0]+1,i.k_(i.f_[0]+1)),g=i.i_();for(d=0;d<p;d++)if(w=i.Oyb,x=void 0,S=void 0,T=void 0,C!==A&&C!==M||(x=D.Fyb&&D.Fyb.getRule(C,w)),x?(S=x.getTargetValue(i,p*v+d+1,g,d,v),b=x.t_?x.t_:b,N=!!x.czb&&x.czb,T=b&&!N):(S=Q(!0,i.j_(),g,p*v+d+1),T=b),I=j+O-1,k=(R=T?i.e_[d]:m+d)+v*F,a){if(b&&(s&&k===I||!s&&k===j)||!b&&k+l===I)return i.k_(S)}else k<j+O&&k>=j&&(e?E.o_(D,o,R,r,k,i.k_(S),4,f,h):u&&D.Ps&&D.Ps(k)||E.o_(D,R,o,k,r,i.k_(S),4,f,h));return c},e.prototype.t_=function(e,t){var n,o,r,i=v(t);if(i<=1||v(e)!==i)return!1;for(n=e[1]-e[0],o=t[1]-t[0],r=2;r<i;r++)if(e[r]-e[r-1]!==n||t[r]-t[r-1]!==o)return!1;return!0},e.prototype.C$=function(e,t){var n,o=this.kj,r=o._modelManager.getSpans(),i=o.Tq(e),a=i.row,s=i.col,l=i.rowCount,u=i.colCount;n=0===t?p(a,s+u-1,l,1):1===t?p(a,s,l,1):p(2===t?a+l-1:a,s,1,u),(n=o.su(r,n))&&this.u_(n,a,s,l,u,t)},e.prototype.u_=function(e,t,n,o,r,i){var a,s,l,u,c,f,d,g,m=e.row,y=e.col,v=e.rowCount,b=e.colCount,C=this.kj._modelManager;if(0===i?(g=C.MTa(t,n,o,r-b),f=0,d=-1*b,l=r,u=b,c=1):1===i?(g=C.MTa(t,n+b,o,r-b),f=0,d=b,l=r,u=b,c=1):2===i?(g=C.MTa(t,n,o-v,r),f=-1*v,d=0,l=o,u=v,c=0):(g=C.MTa(t+v,n,o-v,r),f=v,d=0,l=o,u=v,c=0),g)throw Error(T().Exp_TargetContainsMergedCells);if(l%u!=0)throw Error(T().Exp_MergedCellsIdentical);for(a=h(l/u),s=1;s<a;s++)this.r_(e,p(m+s*f,y+s*d,v,b),c,0)},e.prototype.p_=function(e,t,n,o,r,i){var a=e?-1:1,s=h(i*r),l=Math.abs(r),u=w(t>1?n:o);if(0===t)u.setDate(u.getDate()+a*r);else if(1===t)for(;l>0;)u.setDate(u.getDate()+a*(r>0?1:-1)),6!==u.getDay()&&0!==u.getDay()&&l--;else 2===t?u.setMonth(u.getMonth()+a*s):u.setFullYear(u.getFullYear()+a*s);return C(u)},e}(),t.z$=G},"./dist/plugins/fill/fill.ns.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("./dist/plugins/fill/fill.res.en.js");t.SR={en:o}},"./dist/plugins/fill/fill.res.en.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyCells="Copy Cells",t.FillSeries="Fill Series",t.FillFormattingOnly="Fill Formatting Only",t.FillWithoutFormatting="Fill Without Formatting",t.Exp_NumberOnly="Only works for Numbers",t.Exp_RangeContainsMergedCell="Range should not have merged cells.",t.Exp_TargetContainsMergedCells="Target range should not have merged cells.",t.Exp_MergedCellsIdentical="This operation requires the merged cells to be identically sized.",t.Exp_FillRangeContainsMergedCell="Cannot fill range that contains a merged cell.",t.Exp_FillCellsReadOnly="The cells you are trying to fill are protected and therefore read-only.",t.Exp_ChangeMergedCell="Cannot change part of merged cell.",t.Exp_ColumnReadOnly="The column you are trying to change is protected and therefore read-only.",t.Exp_RowReadOnly="The row you are trying to change is protected and therefore read-only.",t.Exp_CellReadOnly="The cell you are trying to change is protected and therefore read-only.",t.Exp_RangeIsNull="range is null",t.Exp_ChangePartOfArray="Cannot change part of an array."},"./dist/plugins/formulaTextbox/formulaTextBox.entry.js":function(e,t,n){"use strict";function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),o(n("./dist/plugins/formulaTextbox/formulatextbox.js")),o(n("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js")),n("./dist/plugins/formulaTextbox/formulatextbox-event.js"),n("./dist/plugins/formulaTextbox/formulatextbox-actions.js"),n("./dist/plugins/formulaTextbox/formulatextbox-render.js")},"./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js":function(e,t,n){"use strict";var o,r,i,a;function s(e){var t=o.Ul.Nl("textarea");return o.GC$(t).css({display:"none"}),o.GC$(e).append(t),t}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("./dist/plugins/formulaTextbox/formulatextbox.js"),t._createEditorElement=s,i=function(){function e(){var e=this;e.nT=-1,e.Mk=-1,e._text="",e.Q2=-1,e.kj=null,e.MH=!1,e.R2=-1,e.I0=null,e.OC=null,e.f1=null}return e.prototype.$b=function(){var e=this;e.S2(),e.nT=-1,e.Mk=-1,e._text="",e.Q2=-1,e.MH=!1,e.R2=-1,e.kj=null,e.OC=null,e.f1=null},e.prototype.S2=function(){var e,t,n=this;n.kj.Js||(e=n.kj.getCellType(n.nT,n.Mk),t={sheet:n.kj,row:n.nT,col:n.Mk,sheetArea:3},n.I0&&n.I0.firstChild&&e.deactivateEditor(n.I0.firstChild.firstChild,t)),o.GC$(n.I0).remove(),n.I0=null},e.prototype.T2=function(e){var t=this,n=e._formulaTextBox;n&&(t._text=n.text(),t.nT=e.getActiveRowIndex(),t.Mk=e.getActiveColumnIndex(),t.Q2=n.caret(),t.MH=n.MH,t.R2=n.C1(),t._isSelectMode=n._isSelectMode,t.C5=n.C5,t.Nfa=n.Nfa,t.kj=e,t.OC=e.parent,t.f1=e._eventHandler.bG())},e.prototype.VF=function(e){var t=this;e._formulaTextBox&&(t._text=e._formulaTextBox.text(),t.Q2=e._formulaTextBox.caret(),t.MH=e._formulaTextBox.MH,t.R2=e._formulaTextBox.C1())},e.prototype.U2=function(e){var t=this,n=e._formulaTextBox;n&&(n._isSelectMode=t._isSelectMode,n.C5=t.C5,n.Nfa=t.Nfa,n.text(t._text),n.caret(t.Q2),t.MH&&(n.B1(),n.C1(t.R2)))},e.prototype.V2=function(e){var t,n=e.oldSheet,o=this,r=n&&n._formulaTextBox;if(r)if(r.close(),(!o.kj||o.kj.Js)&&r.M0()||o.C5!==r.C5){o.T2(n),t=n.getValue(n.Jl,n.Kl,3),n.suspendEvent();try{if(!n.endEdit(!0))return}finally{n.resumeEvent()}n.setValue(n.Jl,n.Kl,t,3,!0),n._editorStatus=1,e.needTriggerSheetChange=!1}else o._text&&(o.VF(n),r.destroy(),n._formulaTextBox=null,e.needTriggerSheetChange=!1)},e.prototype.W2=function(e){var t,n=e.oldSheet,o=e.newSheet,i=this;o.Js||(i.I0&&""===i._text&&(n.GJ(),i.$b()),i._text&&i.kj===o?(o._editorStatus=0,o.zt(),o.suspendEvent(),i._isSelectMode?(t=s(o.parent._host),r._attachFormulaTextBox(o,t),o._editorStatus=2,o._render._paintFormulaTextBox()):o.startEdit(!1),o.resumeEvent(),i.U2(o),i.VK(o,i.nT,i.Mk),n.GJ(),i.$b()):i._text&&!i.I0?(o._editorStatus=1,n._editorStatus=1,i.X2(o),o.EJ()):i._text&&i.kj!==o&&(o._editorStatus=1,n._editorStatus=1,i.X2(o),n.GJ(),o.EJ()))},e.prototype.X2=function(e){var t,n,i,a,s,l,u,c=this,f=c.kj;f.Js||(t=c.nT,n=c.Mk,i=f.getCellType(t,n),a={sheet:f,row:t,col:n,sheetArea:3,canvasOffset:this.f1},i.isImeAware(a)&&(e._editorStatus=1,s=i._createCellTypeElement(a),c.I0&&c.S2(),c.I0=s,o.GC$(s).css("position","absolute"),l=f.getCellRect(t,n),o.GC$(s).attr("id","across"),u=f.getActualStyle(t,n),i._activateEditorWrapper(s,u,l,a),(c.OC&&c.OC.getHost()||document.body).insertBefore(s,null),c._isSelectMode&&o.GC$(s).css({display:"none"}),r._attachFormulaTextBox(e,i.getEditingElement(),!0),s.firstChild&&!c._isSelectMode&&i.focus(s.firstChild.firstChild),c.U2(e),i._updateEditorWrapper(s,u,l,a)))},e.prototype.VK=function(e,t,n){var o,r=e.getCellType(t,n),i=e._editor,a=e.am(),s=e.getActualStyle(t,n),l=e.getCellRect(t,n);l&&l.width>0&&l.height>0&&l.x>=a.kt&&l.y>=a.nt&&l.x+l.width<=a.lt+a.js&&l.y+l.height<=a.ot+a.gs&&(o={sheet:e,row:t,col:n,sheetArea:3},i&&i.parentNode&&r._updateEditorWrapper(i.parentNode.parentNode,s,l,o,!0))},e}(),a=function(){function e(){}return e.Q0=function(t,n){e.H0||(e.H0=new i),e.H0.V2(n)},e.R0=function(t,n){e.H0||(e.H0=new i),e.H0.W2(n)},e}(),t.G0=a},"./dist/plugins/formulaTextbox/formulatextbox-actions.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u;function c(e){var t=e._formulaTextBox,n=e._eventHandler;return t.MH?n.E2:n.E2={anchorRow:e.Jl,anchorCol:e.Kl,leadingRow:e.Qr,leadingCol:e.Rr}}function f(e,t,n,r,a){var s,u,f,h,p,d,g,m,y,v,b,C,w=e._formulaTextBox,x=e.parent,A=x&&x.options;if(w&&w.M0()&&A&&A.allowUserEditFormula&&A.enableFormulaTextbox){switch(u=(s=c(e)).anchorRow,f=s.anchorCol,h=s.leadingRow,p=s.leadingCol,l(r)&&(r=u),l(a)&&(a=f),d=e._eventHandler,t){case 3:b=e.iy(r,a,n,h);break;case 4:b=e.hy(r,a,n,h);break;case 1:b=e.HJ(r,a,n,p);break;case 2:b=e.LJ(r,a,n,p);break;case 5:b=e.OJ();break;case 6:b=e.NJ()}b&&(g=b.row,m=b.col,y=b.leadingCellRow?b.leadingCellRow:g,v=b.leadingCellCol?b.leadingCellCol:m,e.IJ(g,m)&&(s.anchorRow=g,s.anchorCol=m,s.leadingRow=y,s.leadingCol=v,(C=i._rangeToString(d.kj,o.kf(g,m,1,1)))&&w._appendRange(C,!1,!0),g>=0&&m>=0&&e.Yq(g,m)))}}function h(e,t,n){var r,a,s,l,u,f,h,p,d=e._formulaTextBox,g=e.parent,m=g&&g.options;d&&d.M0()&&m&&m.allowUserEditFormula&&m.enableFormulaTextbox&&(r=e._eventHandler,s=(a=c(e)).anchorRow,l=a.anchorCol,d.MH?(f=d.m1(),u=i._stringToRange(e,f.text)):u=o.kf(s,l,1,1),u&&(h=e.UJ(u,t,n,s,l),(p=i._rangeToString(r.kj,h))&&d._appendRange(p,!0,!1)))}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("@grapecity/js-sheets-common"),i=n("./dist/plugins/formulaTextbox/formulatextbox.js"),a=n("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),s=void 0,l=r.Common.j.Fa,o.Commands.Ox=function(e,t){if(e){if(2===e._editorStatus)return!1;var n=e._formulaTextBox;return n&&n.M0()?(f(e,t,!1),!0):(n&&(e=u.O2(e)),e.yx(t,!1),!0)}return!1},o.Commands.Qx=function(e,t,n,o){if(e){if(2===e._editorStatus)return!1;var r=e._formulaTextBox;return r&&r.M0()?(f(e,t,!1,n,o),!0):(r&&(e=u.O2(e)),e.yx(t,!1,n,o),!0)}return!1},o.Commands.Rx=function(e,t,n){if(e){if(2===e._editorStatus)return!1;var o=e._formulaTextBox;return o&&o.M0()?(h(e,t,n),!0):(o&&(e=u.O2(e)),!!e.endEdit()&&(e.Sx(t,n),!0))}return!1},u=function(){function e(){}return e.fv=function(t){return e.O2(t)},e.Xx=function(t){return e.O2(t)},e.Yx=function(t){return e.O2(t)},e.O2=function(t){var n=t,o=a.G0.H0;return o&&o._text&&(n=o.kj,e.G2(n)),n},e.G2=function(e,t){var n,o;void 0===t&&(t=!0),n=e.parent,(o=a.G0.H0)&&o._text&&n.hw(e,t)},e.Zx=function(t,n,r){var a,s,l=!1,u=t._formulaTextBox;return u&&u.M0()?((a=c(t)).anchorRow=n,a.leadingRow=n,(s=i._rangeToString(t,o.kf(a.anchorRow,a.anchorCol,1,1)))&&u._appendRange(s,!1,!0),t.mq(r),l=!0):u&&(t=e.O2(t)),{sheet:t,r:l}},e._x=function(t,n,r){var a,s,l=!1,u=t._formulaTextBox;return u&&u.M0()?((a=c(t)).anchorRow=n,a.leadingRow=n,(s=i._rangeToString(t,o.kf(a.anchorRow,a.anchorCol,1,1)))&&u._appendRange(s,!1,!0),t.mq(r),l=!0):u&&(t=e.O2(t)),{sheet:t,r:l}},e.pzb=function(t,n){var o=!1,r=n?5:6,i=t._formulaTextBox,a=t.Jl,s=t.Kl;return i&&i.M0()?(i.MH||(t._eventHandler.E2={anchorRow:a,anchorCol:s,leadingRow:t.Qr,leadingCol:t.Rr}),f(t,r,!1,a,s),o=!0):i&&(t=e.O2(t)),{sheet:t,r:o}},e.ay=function(t){return e.pzb(t,!0)},e.by=function(t){return e.pzb(t,!1)},e.ey=function(t){return e.O2(t)},e.gy=function(t){return e.O2(t)},e.jy=function(t){var n,o,r,l=a.G0.H0;if(l&&l._text&&(t=l.kj,n=l.nT,o=l.Mk,e.G2(t,!1),i._detachFormulaTextBox(t),t.Sr(n,o,s,s,1),t.isEditing()))return r=t.getValue(n,o,3),!!t._endEditImp(!0,void 0,void 0,!0)&&(t.setValue(n,o,r,3,!0),!0)},e}(),o.Commands.Wx=u},"./dist/plugins/formulaTextbox/formulatextbox-event.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h;Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("@grapecity/js-calc"),i=n("SheetsCalc"),a=n("./dist/plugins/formulaTextbox/formulatextbox.js"),s=n("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),l=o.GC$.extend,u=null,c=void 0,f=Math.max,h=Math.min,l(o.iI.prototype,{D2:function(e){var t,n,r,i,s,l,u,f,h,p,d,g,m,y,v,b,C,w=this,x=w.kj,A=x._formulaTextBox;A&&(w.Kka(),t=x.frozenRowCount(),n=x.frozenColumnCount(),(r=A.MH)&&w.E2||(w.E2={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1}),i=x.getRowCount(),s=x.getColumnCount(),l=e.hitTestType,u=e.row,f=e.col,h=w.shift,p=w.ctrl,g=(d=w.E2).anchorRow,m=d.anchorCol,y=-1,v=-1,0===l?(y=t?x.ar():x.lq,v=n?x.$q():x.qq,b=o.kf(-1,-1,-1,-1),A._appendRange(a._rangeToString(x,b),h,!p),w._isWorking=!0):1===l?(y=t?x.ar():x.lq,v=f,b=x.Jx(0,f,i-1,f,!0),h&&m>=0&&(b=x.Jx(0,f,i-1,m,!0)),b=o.kf(-1,b.col,-1,b.colCount),A._appendRange(a._rangeToString(x,b),h,!p),w._isWorking=!0):2===l?(y=u,v=n?x.$q():x.qq,b=x.Jx(u,0,u,s-1,!0),h&&g>=0&&(b=x.Jx(u,0,g,s-1,!0)),b=o.kf(b.row,-1,b.rowCount,-1),A._appendRange(a._rangeToString(x,b),h,!p),w._isWorking=!0):3===l&&(y=u,v=f,u!==c&&f!==c&&((C=e.tableSelectInfo&&e.tableSelectInfo.tableSelection)?b=C:(b=x.Jx(u,f,u,f,!0),b=o.kf(b.row,b.col,1,1),h&&g>=0&&m>=0&&(b=x.Jx(u,f,g,m,!0))),A._appendRange(a._rangeToString(x,b),h,!p)),w._isWorking=!0),w.DG=w._isWorking,h&&r||(d.anchorRow=y,d.anchorCol=v,d.leadingRow=y,d.leadingCol=v),w.rG={KG:e.rowViewportIndex,MG:e.colViewportIndex,sG:e.hitTestType},w.qG())},F2:function(e){var t,n,r=!1,i=s.G0.H0;if(i&&i.I0)if(t=i.kj,(n=e._formulaTextBox)&&t.setFormula(i.nT,i.Mk,n.text()),t!==e){if(o.Commands.Wx.G2(t),!t.endEdit())return;r=!0}else n&&(n.destroy(),e._formulaTextBox=u),i.$b();return r},EG:function(){var e,t=this,n=t.rG;n&&t._isWorking&&(3===(e=n.sG)?t.H2():2===e?t.I2():1===e&&t.J2())},H2:function(){var e,t,n,o=this,r=o.E2,i=r.anchorRow,s=r.anchorCol,l=o.fH(),u=o.gH();i>=0&&s>=0&&l>=0&&u>=0&&(t=(e=o.kj).Jx(l,u,i,s,!0),(n=a._rangeToString(e,t))&&e._formulaTextBox._appendRange(n,!0,!1)),o.NG()},I2:function(){var e,t,n,r=this,i=r.E2.anchorRow,s=r.fH();i>=0&&s>=0&&(t=(e=r.kj).Jx(s,0,i,e.getColumnCount()-1,!0),t=o.kf(t.row,-1,t.rowCount,-1),(n=a._rangeToString(e,t))&&e._formulaTextBox._appendRange(n,!0,!1)),r.NG()},J2:function(){var e,t,n,r=this,i=r.E2.anchorCol,s=r.gH();i>=0&&s>=0&&(t=(e=r.kj).Jx(0,s,e.getRowCount()-1,i,!0),t=o.kf(-1,t.col,-1,t.colCount),(n=a._rangeToString(e,t))&&e._formulaTextBox._appendRange(n,!0,!1)),r.NG()},yH:function(){var e=this;e.RG(),e.rG=u,e._isWorking=!1,e.DG=!1},iG:function(e){var t,n,o,r,i,s,l,u,c=this,f=c.kj,h=c._oa(),p=e.formulaRangeHitInfo;p&&p.inBorder&&h&&(h.MH&&h._stopAppending(),h.close(),(n=(t=p.paramRange)&&t.text)&&((o=a._stringToRange(f,n))&&(c.Kka(),r=f.Tq(o),i=e.row,s=e.col,i<r.row&&(i=r.row),i>=r.row+r.rowCount&&(i=r.row+r.rowCount-1),s<r.col&&(s=r.col),s>=r.col+r.colCount&&(s=r.col+r.colCount-1),l=i-r.row,u=s-r.col,c._isWorking=!0,c.FG=!0,c.K2={paramRange:t,fromRange:o,rowOffset:l,colOffset:u},c.rG={KG:e.rowViewportIndex,MG:e.colViewportIndex,sG:e.hitTestType},c.qG())))},GG:function(){var e,t,n,r,i,s,l,u,c,p,d,g,m,y,v,b,C,w,x,A,M=this;M._isWorking&&M.FG&&(e=M.fH(),t=M.gH(),e>=0&&t>=0&&(r=(n=M.K2).fromRange,i=n.rowOffset,s=n.colOffset,l=n.toRow,u=n.toCol,p=t,(c=e)===l&&p===u||(n.toRow=c,n.toCol=p,g=(d=M.kj).getRowCount(),m=d.getColumnCount(),y=r.row,v=r.col,b=r.rowCount,C=r.colCount,w=y<0?-1:f(0,h(g-b,e-i)),x=v<0?-1:f(0,h(m-C,t-s)),(A=a._rangeToString(d,o.kf(w,x,b,C)))&&M._oa()._repalceRange(n.paramRange.index,A,!0))),M.NG())},zH:function(){var e,t=this;t.RG(),t._isWorking=!1,t.FG=!1,t.K2=u,(e=t._oa()).onRangeMoved&&e.onRangeMoved()},jG:function(e){var t,n,o,r,i,s,l,u,c,f,h,p=this,d=p.kj,g=p._oa(),m=e.formulaRangeHitInfo;if(m&&g&&(g.MH&&g._stopAppending(),n=(t=m.paramRange)&&t.text,t&&n&&(o=a._stringToRange(d,n)))){if(p.Kka(),r=o.row,i=o.row<0?-1:o.row+o.rowCount-1,s=o.col,l=o.col<0?-1:o.col+o.colCount-1,m.inTopLeft)u=i,c=l,f=r,h=s;else if(m.inTopRight)u=i,c=s,f=r,h=l;else if(m.inBottomLeft)u=r,c=l,f=i,h=s;else{if(!m.inBottomRight)return;u=r,c=s,f=i,h=l}p._isWorking=!0,p.HG=!0,p.L2={paramRange:t,anchorRow:u,anchorCol:c,toRow:f,toCol:h},p.rG={KG:e.rowViewportIndex,MG:e.colViewportIndex,sG:e.hitTestType},p.qG()}},kG:function(e,t){var n=e._formulaTextBox;return n&&n.M0()?(this.D2(t),!0):!!this.F2(e)},IG:function(){var e,t,n,r,i,s,l,u,c,p,d,g,m,y,v,b,C,w,x,A=this;A._isWorking&&A.HG&&(e=A.fH(),t=A.gH(),e>=0&&t>=0&&(r=(n=A.L2).anchorRow,i=n.anchorCol,s=n.toRow,l=n.toCol,c=t,(u=e)===s&&c===l||(n.toRow=u,n.toCol=c,d=(p=A.kj).getRowCount(),g=p.getColumnCount(),y=i<0?g-1:i,v=h(m=r<0?d-1:r,u),b=h(y,c),C=f(m,u)-v+1,w=f(y,c)-b+1,0===v&&C===d&&(v=-1,C=-1),0===b&&w===g&&(b=-1,w=-1),(x=a._rangeToString(p,o.kf(v,b,C,w)))&&A._oa()._repalceRange(n.paramRange.index,x,!0))),A.NG())},AH:function(){var e,t,n=this;n.RG(),n._isWorking=!1,n.HG=!1,n.L2=u,(e=n._oa())._isSelectMode&&(e.W0=1,-1!==(t=e.text().lastIndexOf(",",e.caret()))&&(e.W0=t+1)),e.onRangeResized&&e.onRangeResized()},vr:function(e,t,n){var o,r,i,l,c,f,h,p,d,g,m,y=this.kj,v=this._oa(),b=v&&v.l1();if(!b||0===b.length||!v.UQa)return u;if(o=e.rowViewportIndex,r=e.colViewportIndex,this.qH(o,r,t,n))return u;for(f=b.length-1;f>=0;f--)if(!1!==(i=b[f]).allowDrag&&((!(h=s.G0.H0)||!h._text)&&(l=a._stringToRange(y,i.text)))){if(5,p=(c=y.getRangeRect(o,r,l)).x-2,d=c.x+c.width+1-5,g=c.y-2,m=c.y+c.height+1-5,p+5<=t&&t<d&&(g+1<=n&&n<=g+3||m+1<=n&&n<=m+3))return{paramRange:i,inBorder:!0};if(g+5<=n&&n<m&&(p+1<=t&&t<=p+3||d+1<=t&&t<=d+3))return{paramRange:i,inBorder:!0};if(d<=t&&t<d+5&&m<=n&&n<m+5)return{paramRange:i,inBottomRight:!0};if(p<=t&&t<p+5&&m<=n&&n<m+5)return{paramRange:i,inBottomLeft:!0};if(d<=t&&t<d+5&&g<=n&&n<g+5)return{paramRange:i,inTopRight:!0};if(p<=t&&t<p+5&&g<=n&&n<g+5)return{paramRange:i,inTopLeft:!0}}return u},_oa:function(){var e=this.kj;return e._formulaTextBox||e._formulaTextBoxForChart},ly:function(){var e,t,n,o,a,s,l,c,f,h,p,d,g=this,m=g.kj,y=m._formulaTextBox;if(y)if(e=m.Jl,t=m.Kl,o=(n=m.parent)&&1===n.options.referenceStyle,a=new i.SheetParserContext(m,o,r._createCellIdentity(e,t)),s=new r.Parser,y.MH)for(f=y.u1(),h=0;h<f.length;h++){l=f[h];try{c=s.parse(a,l.text)}catch(e){c=u}c&&1===c.type&&(g.M2(c,e,t,!0,!0),y._repalceRange(l.index,s.unparse(a,c)))}else{if(!(l=y.m1()))return;try{c=s.parse(a,l.text)}catch(e){c=u}if(!c)return;1!==c.type||c.sf()?1===c.type&&(g.N2(c,e,t),y._repalceRange(l.index,s.unparse(a,c))):(p=l.textOffset+l.text.lastIndexOf(":"),y.caret()<=p?(g.M2(c,e,t,!0,!1),d=s.unparse(a,c),y._repalceRange(l.index,d),y.caret(l.textOffset+d.lastIndexOf(":"))):(g.M2(c,e,t,!1,!0),y._repalceRange(l.index,s.unparse(a,c))))}},M2:function(e,t,n,o,r){var i,a,s=e.rowRelative,l=e.columnRelative;o&&(s&&l?(e.rowRelative=!1,e.columnRelative=!1,e.row+=t,e.column+=n):s?(e.columnRelative=!0,e.column-=n):l?(e.rowRelative=!0,e.columnRelative=!1,e.row-=t,e.column+=n):(e.columnRelative=!0,e.column-=n)),i=e.endRowRelative,a=e.endColumnRelative,r&&(i&&a?(e.endRowRelative=!1,e.endColumnRelative=!1,e.endRow+=t,e.endColumn+=n):i?(e.endColumnRelative=!0,e.endColumn-=n):a?(e.endRowRelative=!0,e.endColumnRelative=!1,e.endRow-=t,e.endColumn+=n):(e.endColumnRelative=!0,e.endColumn-=n))},N2:function(e,t,n){var o=e.rowRelative,r=e.columnRelative;o&&r?(e.rowRelative=!1,e.columnRelative=!1,e.row+=t,e.column+=n):o?(e.columnRelative=!0,e.column-=n):r?(e.rowRelative=!0,e.columnRelative=!1,e.row-=t,e.column+=n):(e.columnRelative=!0,e.column-=n)},Kka:function(){var e,t=this.kj._formulaTextBox;t&&((e=t._host)&&t.Cia(e)&&t.Jka())}})},"./dist/plugins/formulaTextbox/formulatextbox-render.js":function(e,t,n){"use strict";var o,r,a,s,l,u,c;function f(e,t,n,o,u,f){var h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L=e.kj,z=L._eventHandler,V=f&&f.l1(),G=V&&V.length,W=i&&i._legacyWynbi&&i._legacyWynbi.spreadChartEditState&&i._legacyWynbi.spreadChartEditState.pivotTableManager,U=[];if(W&&(h=W.getPivotTableBySheet(e.kj))){if(G=0,!(p=h.text2Ranges(f.text(),L.name()))||!p.length)return;U=p}if(!(G<=0&&U.length<=0)&&(d=e.VI(n,o,u))){for(t.save(),t.rect(d.x,d.y,d.width,d.height),t.clip(),t.beginPath(),e.XI(n,o,U,d).forEach((function(e,n){e&&0!==e.width&&0!==e.height&&(t.beginPath(),t.lineWidth=2,t.strokeStyle=l.DEFAULT_RANGE_COLORS[n%l.DEFAULT_RANGE_COLORS.length],t.rect(e.x+1,e.y+1,e.width-3,e.height-3),t.stroke())})),g=[],m=z.isFormulaRangeHoving,y=z.tH,v=z.FG,b=z.K2,C=z.HG,w=z.L2,N=0;N<G;N++)if(A=(x=V[N]).text,M=x.ranges&&x.ranges.length>0?x.ranges:[a._stringToRange(L,A)]){if((I=s.G0.H0)&&I.kj)if(c.Bb(A,"!")){if(R=c.Ib(A,"!"),L.name()!==R&&"'"+L.name()+"'"!==R)continue}else if(k=c.Ib(A,"["),E=L.tables,!(L.getCustomNames()[k]||E&&E.findByName(k)))continue;for(S=e.XI(n,o,M,d),D=0;D<S.length;D++)(j=S[D])&&j.width>0&&j.height>0&&(T=f.o1(N),f.t1(x)?(m&&y.paramRange.index===N&&(t.beginPath(),t.lineWidth=2,t.strokeStyle=T,t.rect(j.x+1,j.y+1,j.width-3,j.height-3),t.stroke()),e.fJ(t,j,T)):m&&y.paramRange.index===N||v&&b.paramRange.index===N||C&&w.paramRange.index===N?(t.beginPath(),t.lineWidth=2,t.strokeStyle=T,t.rect(j.x+1,j.y+1,j.width-3,j.height-3),t.stroke()):(t.beginPath(),t.lineWidth=2,t.strokeStyle=T,t.rect(j.x,j.y,j.width-1,j.height-1),t.stroke()),f.n1(x)&&((_=r.Common.pc.ec(T)).a=.1,t.beginPath(),t.fillStyle=r.Common.pc.bc(_),t.fillRect(j.x+1,j.y+1,j.width-3,j.height-3)),g.push({rect:j,color:T,allowDrag:x.allowDrag}))}if(g.length>0&&f.UQa)for(O=g.length,N=0;N<O;N++)j=g[N].rect,T=g[N].color,5,F=j.x-2,P=j.x+j.width+1-5,H=j.y-2,B=j.y+j.height+1-5,!1!==g[N].allowDrag&&((I=s.G0.H0)&&I._text||(t.beginPath(),t.fillStyle=T,t.fillRect(F,H,5,5),t.fillRect(P,H,5,5),t.fillRect(F,B,5,5),t.fillRect(P,B,5,5)));t.beginPath(),t.restore()}}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("@grapecity/js-sheets-common"),a=n("./dist/plugins/formulaTextbox/formulatextbox.js"),s=n("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),l=n("./dist/plugins/formulaTextbox/formulatextbox.js"),u=o.GC$.extend,c=r.Common.u,u(o.oJ.prototype,{_paintFormulaTextBox:function(){var e,t,n=this,o=n.kj;o.Xq>0||(e=o.am(),t=n.bm(),n.Mx(e.x,e.y,e.width,e.height),n.Pw(t))}}),o.Worksheet.$n("formulatextboxrender",{paintAdornment:function(e){var t,n,o,r=this,i=e.ctx,a=e.clipRect,s=r._render,l=r.am(),u=r._eventHandler._oa();if(u)for(n=0;n<=2;n++)for(o=0;o<=2;o++)(t=l.Ft(n,o))&&0!==t.width&&0!==t.height&&f(s,i,n,o,a,u)}})},"./dist/plugins/formulaTextbox/formulatextbox.js":function(e,t,n){"use strict";var o,r,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B;function L(e){return e.getActiveSheet()}function z(e){var t,n=[];return s.GC$.each(e,(function(e,o){(t=o.description())&&(t.name=e,n.push(t))})),n}function V(e){var t=o.getMapping()&&o.getMapping().builtInFunctionsMapping;return t&&t[e]&&t[e].alias||e}function G(e,t,n){var r,i,a,l,u,c=e.parent,f=c&&c.options;(t&&f&&f.allowUserEditFormula&&f.enableFormulaTextbox||n)&&(e._formulaTextBox&&e._formulaTextBox.destroy(),e._formulaTextBox=new B(t,null,c),r=e._formulaTextBox.text(),i=e.getFormulaInformation(e.Jl,e.Kl),"="!==r[0]||i&&i.hasFormula||(r="'"+r,e._formulaTextBox.text(r)),a=e._formulaTextBox,l=e._eventHandler,u=e._render,a.bind("AppendStarted",(function(){a.close();var t=e._editorStatus;1!==t&&(e._editorStatus=1,e._raiseEditorStatusChanged(t,1))})),a.bind("AppendEnded",(function(){u._paintFormulaTextBox()})),a.bind(I,(function(t,n){if(!e.Js){if(n&&n.type!==M){l._updateEditingEditor(n);var o=e.Jl,r=e.Kl,i=e.getCellType(o,r);e.Wq(s.Events.EditChange,{sheet:e,sheetName:e.name(),row:o,col:r,editingText:i.getEditorValue(e._editor)})}u._paintFormulaTextBox(),e.Wq(s.Events.FormulaTextBoxTextChanged,{sheet:e,sheetName:e.name(),text:a.text()})}})),a.bind("CaretChanged",(function(){u._paintFormulaTextBox(),e.Wq(s.Events.FormulaTextBoxCaretChanged,{sheet:e,sheetName:e.name(),caret:a.caret()})})),a.add(function(){var e=[];return s.GC$.each(o.sR()._h,(function(t,n){o.Functions.bi[t]&&(n.name=t,e.push(n))})),e}()),a.add(z(o.Functions.ci)),a.add(z(e._functions).concat(z(c._functions))),u._paintFormulaTextBox())}function W(e){e._formulaTextBox&&(e._formulaTextBox.destroy(),e._formulaTextBox=u,e._render._paintFormulaTextBox());var t=e.parent&&e.parent.CF;m.activeElement===(t&&t._host)&&e._eventHandler.Qq()}function U(e){var t,n=["FILTER","RANDARRAY","SEQUENCE","SORT","SORTBY","UNIQUE"];for(t=0;t<n.length;t++)if(e===n[t])return!0}function Z(e){return"gcAttachedFormulaTextBox"===e.target.getAttribute("gcuielement")}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-calc"),r=n("SheetsCalc"),a=n("@grapecity/js-sheets-common"),s=n("Core"),l=n("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),u=null,c=void 0,f=Math.max,h=Math.min,p=s.GC$.extend,d=s.Ul.Nl,g=window,m=document,y=a.Common.u,v=s.Ul.nl,b=s.Ul.Ml,C=b.msie&&parseInt(b.version,10)<10,w=y.Nb,x="formulatextbox",A="gcUIElement",M="input",S="",T=".gcFormulaTextBoxInternal",N=".gcFormulaTextBox",I="TextChanged",R="CaretChanged",k={left:37,right:39,up:38,down:40,tab:9,enter:13,pup:33,pdn:34,end:35,home:36,esc:27},t.DEFAULT_RANGE_COLORS=["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"],E='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJSSURBVDhPY3hILqBYZ/eqV81LXpbNfp7S/yS0+Z5p+olD5x5OWXGyYcaBmql7yifuLOnbBkRFPVuACKIFqjNzwv2Qhhue5ReByK/qYlDtxb///n35+efd1z/PP/wB6vn2+/f7b79ffgIhiBaoTlPP5I2bN2/asmX7jh3Hjh+ft3wLUOfX779ef/h+6+nHtXsuffrx+/bj16euvwQiiBaETiAy904NTasGantRkvA8wetpsO0NJ839htKb9l/Jal6T3rgytX4FEEG0QHXuOnbr55+/P379AyIg40m8x8uZ3U+aC49bKn64eHzX0es4Xds0Y9ejl++vPXx3+f77Nx9/3PU3e5YR/CTM4WGs53pVPqBrgX6+8+QNFtdmNq0q6NpU1LOpe/6+o+fvH3fR36XCc9dE/KG3EdDNQPaF7VunLTuY0bA0omg2RAtUZ1LNUohjgCEJDJVtdlpPty6dr8x3yUDsvoPqRm2hqcp8Jy+9WbH/7cQ1EB0wnXEVCyBBt+fc8+NXXy9Yf/znz5/31swFaliiKjBZme/yrSe7z36YsuZBy4KbEC1QnRFFcxKqFgP1A1Fq7ZKcpqU1EzYuWX/kxIa1/WBtizYcAwqG5E71SZsA0QLVGZI3A+Lax+/+ACMwvHDmsn1v1xx8e+jSp83HXgP1ALmztryYsv4ZEEG0QHUGZk+FuHbHqadABORO3fC8Z/mdvmU3Oxdd9cuY1LX0VsOci/WzQQiiBaET4lQgii1fEFU6F4iAXgC6JShnakDWZKBmoDshCKIFqpMMQK7Ohw8BTajNa73pg9oAAAAASUVORK5CYII=")',D="background",j="background-repeat",_="text-before",O="caret-before",t._rangeToString=function(e,t){var n,o,a,c,f,h,p,d,g,m,y,v,b;return t?(n=i&&i._legacyWynbi&&i._legacyWynbi.spreadChartEditState&&i._legacyWynbi.spreadChartEditState.pivotTableManager)&&(o=n.getPivotTableBySheet(e))?1===t.colCount&&1===t.rowCount?o.rangeToFormula(t.row,t.col):"":(a=e._formulaTextBox,h=(f=(c=l.G0.H0)&&c.kj||e).Jl,p=f.Kl,g=(d=e.parent)&&1===d.options.referenceStyle,m=15,e._formulaTextBox&&e._formulaTextBox.Nfa&&(m=0),t.row<0&&t.col<0&&(t=new s.Range(0,-1,e.getRowCount(),-1)),v=(y=e.tables)&&y.find(t.row,t.col),c&&c.Nfa&&(m=0),a&&!a._isSelectMode&&function(e,t){if(!e)return!1;var n=!1,o=!1;if(1===t.rowCount){if(e.hasHeadersRow()&&t.row===e.startRow())return!0;if(e.hasTotalsRow()&&t.row===e.endRow())return!0}else e.hasHeadersRow()&&t.row===e.startRow()&&(t.rowCount===e.dataRange().rowCount+1&&(n=!0),e.hasTotalsRow()&&t.rowCount===e.dataRange().rowCount+1+1&&(n=!0)),t.row===e.dataRange().row&&(t.rowCount===e.dataRange().rowCount&&(n=!0),e.hasTotalsRow()&&t.rowCount===e.dataRange().rowCount+1&&(n=!0));return t.col+t.colCount<=e.startColumn()+e.dataRange().colCount&&(o=!0),n&&o}(v,t)?(c&&c._text&&c.kj!==e&&(h=p=-1),r.rangeToFormulaWithStructReference(e,t,h,p,m,g,v)):(b=r.rangeToFormula(t,h,p,m,g),(c&&c._text||e._formulaTextBox&&e._formulaTextBox._isSelectMode&&e._formulaTextBox._needSheetName)&&(b=function(e){var t=e.name();return r.jma(t.split(""),!1)?t:"'"+function(e){return e.replace(/'/g,"''")}(t)+"'"}(e)+"!"+b),b)):u},s.Events.FormulaTextBoxTextChanged="FormulaTextBoxTextChanged",s.Events.FormulaTextBoxCaretChanged="FormulaTextBoxCaretChanged",g.Yl.km.push((function(e,t){var n,o=l.G0;!t&&e.endEdit&&o&&((n=o.H0)&&n.I0&&e._formulaTextBox&&(e._formulaTextBox&&e._formulaTextBox.destroy(),e._formulaTextBox=u,n.$b()))})),t._attachFormulaTextBox=G,t._detachFormulaTextBox=W,t._stringToRange=function(e,t){var n,o,i,a;if(!t)return u;i=(o=(n=l.G0.H0)&&n.kj||e).Jl,a=o.Kl;try{return r.formulaToRange(e,t,i,a)}catch(e){}return u},p(s.DC.prototype,{bE:function(e){return!(e&&e._formulaTextBox&&e._formulaTextBox.M0())}}),s.Worksheet.$n(x,{startEdit:function(e){G(this,e.element)},endEdit:function(){W(this)}}),F=s.DC.prototype,P=F.dE,s.DC.$n(x,{preProcessMouseDbClick:function(e){var t=L(this.OC),n=t?t._formulaTextBox:void 0,o=n&&n.M0(),r=l.G0.H0;o?e.r=!1:r&&r.I0&&r.$b()}}),F.dE=function(){var e=L(this.OC)._formulaTextBox,t=l.G0.H0,n=t&&t._text;return P.call(this)&&!n&&!e},H=1,B=function(){function e(e,t,n){var o,r,i,a=this,u=e;if(a._isSelectMode=!1,a.Nfa=!1,a._needSheetName=!0,a.Ac=[],a.Bc=[],a._gc=[],t&&t.rangeSelectMode&&(!0===t.absoluteReference&&(a.Nfa=!0),!1===t.needSheetName&&(a._needSheetName=!1),a._isSelectMode=!0,a.D5=!1,a.E5=!1,a.cga=e,o=function(e,t){var n,o,r,i,a,l,u,c,f,h,p=s.GC$(e);return p.attr("contenteditable","false"),n=d("table"),s.GC$(n).css("border-spacing","0"),s.GC$(n).css("width","100%"),p.append(n),o=d("tbody"),n.appendChild(o),r=document.createElement("tr"),o.appendChild(r),i=document.createElement("td"),s.GC$(i).css("padding-right","0px"),r.appendChild(i),a=document.createElement("td"),s.GC$(a).css("width","23px"),s.GC$(a).css("padding-right","0px"),r.appendChild(a),l=p.width()-s.GC$(a).width(),u=d("div"),c=d("div"),s.GC$(c).width(l),s.GC$(c).css({"overflow-y":"auto","overflow-x":"hidden",height:"20px"}),c.appendChild(u),i.appendChild(c),f=d("div"),a.appendChild(f),s.GC$(u).css({display:"inline-block",float:"left",height:"auto",outline:"none"}),s.GC$(u).width(l),s.GC$(u).attr("contenteditable","true"),s.GC$(u).attr("spellcheck","false"),(h=s.GC$(f)).css({display:"block",float:"right",width:"23px",height:"23px",background:E,"background-repeat":"no-repeat"}),h.bind("click",(function(){t.D5?(t.OC.Wq("RangeSelectEnding",t),t.endSelectMode()):t.startSelectMode()})),{contentDiv:u,button:f}}(e,a),u=o.contentDiv,a.sia=o.button,a.tia=e,a.C5=H,H++),a.UQa=!0,a.ad(n&&n.getHost()||m.body),u&&a.N0(u),n&&(a.O0=!0,a.P0(n),a.OC._unbind(s.Events.FormulatextboxActiveSheetChanging,l.G0.Q0),a.OC._bind(s.Events.FormulatextboxActiveSheetChanging,l.G0.Q0),a.OC._unbind(s.Events.FormulatextboxActiveSheetChanged,l.G0.R0),a.OC._bind(s.Events.FormulatextboxActiveSheetChanged,l.G0.R0)),r=a.text(),a._tokens=a.T0(r),a.Cia(u)){a.V0(a._tokens);try{(i=g.getSelection()).selectAllChildren(u),i.rangeCount>0&&i.collapseToEnd()}catch(e){}s.GC$(a._host).data(_,r)}}return e.prototype.j5=function(e){var t,n,o,r,i,a,s=this;s._startingEdit(),s._startEdit(),s.E5=!0,t=l._createEditorElement(s.OC._host),(n=s.a1()).suspendPaint(),G(n,t,!0),(o=n._formulaTextBox)._isSelectMode=!0,o.C5=s.C5,o.Nfa=s.Nfa,o._needSheetName=s._needSheetName,e&&(s.text(e),s.caret(e.length)),r=s.text(),(i=s.caret())<=0&&(i=r.length),s.focus(),s.caret(i),s.MH=!0,s.W0=1,-1!==(a=r.lastIndexOf(",",i))&&(s.W0=a+1),r||(s.text("="),r="=",s.caret(1),i=1),0!==r.indexOf("=")&&(r="="+r,i++),o.text(r),o.caret(i),o.MH=s.MH,o.W0=s.W0,n.resumePaint()},e.prototype.startSelectMode=function(e){var t,n=e;n&&0!==n.indexOf("=")&&(n="="+n),(t=this)._isSelectMode=!0,t.D5=!0,s.GC$(t.sia).css([D,j],['url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAItSURBVDhPY3hILqBYZ/eqVxDUuvRl/cKXZbNf5E59ntT3DIgi2p/6NT5xq35iV/YYiCyLHkG0IHQuOvR/1t6/03b+mbD1d/eGXy2rf9Yu/wFE5Yu+Fc79mjXza+rUz0BkmHoWogXFTqCFVfNfQmwLa3vqVfsYiBzA9sCRftIJiBaozuYZO+89eAREt+4+AKIbt+9fvXkPiC5du3P28s0T564dOnV579Hz2w6cSaqcDdEC1Vk/ZQtQQ2vv7MaumbUd0+o6ZzT3zmnunQ1kF9T0pZe2J+U3x+U0bNx9MqZ4CkQLVGdB6xKgDaX1/b/+/PnyE4E+ff/z8uPvR29/3X35MzCxfPW2o2HZPRAtUJ2lXSuADkstann/9febz7/ff/3zLDP4Spj9Pjs1oE6gthvPfnpEFS7deDAwrRWiBaozv3kh0D8RadVAlFvZvWLDrjvRrk+bCrdpCS1ZsyOpoMU9ssA5NBeo0zuhDqIFqjO9Zubhk1eA6MT5G+eu3H78/PVFX/OnxQnrNQTuPnyx9+hFoA+B2uav2ecaVQ7RAtUZVzQBKH3g+KXTl24fdjE44mp4yFbtSYrfGg3+yQocQLTryEWgzgVr9zmEFkK0QHWGZbbvPHQOiI6cvnb5wMENhjJPE30eB1k9dFIDaruy/wAwPoA6563eaxOQDdEC1YkG1hvKrNKVuOEA0nYr2Pp5qA1UAglg1wkEW03lF2kI3wy1xaoNCHDqJAjI1fnwIQDHT83/UVFPcQAAAABJRU5ErkJggg==")',"no-repeat"]),t.j5(n)},e.prototype.endSelectMode=function(){this.D5=!1,this.H5(),s.GC$(this.sia).css([D,j],[E,"no-repeat"])},e.prototype.H5=function(){var e=this.a1();e&&(e._endEditImp(!0,c,!0),e.repaint())},e.prototype.rgc=function(e){this._gc=[e]},e.prototype.ahc=function(){return this._gc},e.prototype.destroy=function(){var e=this;e.D5&&e.H5(),e._gc=u,e.MH=!1,e.W0=-1,e.X0(),e.Y0(),s.GC$(e._funcsPopup).remove(),s.GC$(e.$0).remove(),s.GC$(e._0).remove()},e.prototype.bind=function(e,t,n){var o=this._host;o&&e&&(e=e.split(/\s+/).join(N+" "),s.GC$(o).bind(e+N,t,n))},e.prototype.unbind=function(e,t){var n=this._host;n&&e&&(e=e.split(/\s+/).join(N+" "),s.GC$(n).unbind(e+N,t))},e.prototype.unbindAll=function(){var e=this._host;e&&s.GC$(e).unbind(N)},e.prototype.caret=function(e){var t,n,o=this,r=o._host;if(r)return t=m.activeElement===r,n=s.GC$(r),0===arguments.length?t?o.b1(r).end:n.data(O):void(e!==o.caret()&&(t?(o.c1(r,e),n.data(O,o.b1(r).end)):n.data(O,e),o.Wq(R,{})))},e.prototype.b1=function(e){var t,n,o,r=-1,i=-1;return this.d1(e)?(r=e.selectionStart,i=e.selectionEnd):this.Cia(e)&&((t=g.getSelection()).rangeCount>0&&((o=(n=t.getRangeAt(0)).cloneRange()).selectNodeContents(e),o.setEnd(n.endContainer,n.endOffset),i=(""+o).length,(o=n.cloneRange()).selectNodeContents(e),o.setEnd(n.startContainer,n.startOffset),r=(""+o).length,o.detach())),{start:r,end:i}},e.prototype.c1=function(e,t){var n,o,r,i;this.d1(e)?e.setSelectionRange(t,t):this.Cia(e)&&((r=this.e1(e,t))&&(n=g.getSelection(),o=m.createRange(),(i=r.node)&&1===i.childNodes.length?o.setStart(i.firstChild,r.offset):i.lastChild&&i.lastChild.length&&o.setStart(i.lastChild,i.lastChild.length),o.collapse(!0),n.removeAllRanges(),n.addRange(o),this._isSelectMode&&(e.parentElement.scrollTop=e.parentElement.scrollHeight)))},e.prototype.text=function(e){var t,n,o,r,i,a,u,c=this,f=c._host,h=c.a1();if(!f||!h||h.Js)return"";if(t=c.d1(f),n=c.Cia(f),0===arguments.length){if(o="",t)o=f.value;else if(n){if(f.getElementsByClassName("gcsj-func-gray-formula").length>0)return"";(o=(o=C?s.Ul.Woa(f):f.innerText).replace(/\r\n?/g,"\n")).indexOf(S)>=0&&(o=s.Ul.Ika(o,S," "))}return o}null!=e||(e=""),e!==c.text()&&(r=c.mLb(e),c._tokens=r?c.T0(r):c.T0(e),t?f.value=e:n&&(i=c.nLb(c._tokens,e),c.V0(i),c.caret(e.length)),a={},(u=l.G0.H0)&&u._text&&(a={sheet:u.kj,editor:u.I0&&u.I0.firstChild.firstChild,canvasOffset:u.f1}),c.Wq(I,a)),c.oLb&&c.pLb()},e.prototype.autoComplete=function(e){return 0===arguments.length?this.g1:void(this.g1=e)},e.prototype.showHelp=function(e){return 0===arguments.length?this.h1:void(this.h1=e)},e.prototype.add=function(e){var t,n;if(e)if(s.GC$.isArray(e))for(t=e.length,n=0;n<t;n++)this.Sb(e[n]);else this.Sb(e)},e.prototype.Sb=function(e){var t,n,o,r,i=e&&w(V(e.name));if(i){for(n=(t=this.i1).length,o=0;o<n;o++){if((r=w(t[o].name))===i)return;if(r>i)break}t.splice(o,0,e)}},e.prototype.remove=function(e){var t,n,o;if(e)for(e=w(e),n=(t=this.i1).length,o=0;o<n;o++)if(w(t[o].name)===e){t.splice(o,1);break}},e.prototype.workbook=function(e){var t=this;return 0===arguments.length?t.OC:void(e===u?t._isSelectMode&&t.H5():(t.P0(e),t.j1()))},e.prototype.P0=function(e){var t;e&&((t=this).OC&&t.Y0(),t._host&&(t.OC=e))},e.prototype.l1=function(){var e,t,n,o=[],r=this._tokens,i=r&&r.length,a=0,s=0;if(i>0)for(n=0;n<i;n++)t=(e=r[n]).text,11===e.type&&(o.push({textOffset:a,text:t,ranges:e.ranges,index:s,allowDrag:e.allowDrag}),s++),a+=t.length;return o},e.prototype.m1=function(){var e,t,n,o,r,i=this._host,a=this.l1();if(i&&a&&a.length>0)for(e=this.caret(),t=a.length,n=void 0,o=void 0,r=0;r<t;r++){if((o=(n=a[r]).textOffset)<e&&e<=o+n.text.length)return n;if(o>=e)break}return u},e.prototype.n1=function(e){var t,n,o;return!!e&&(t=this.caret(),n=e.text,(o=e.textOffset)<t&&t<=o+n.length)},e.prototype.o1=function(e){var n,o,r,i,a,s,l,u=this.l1(),c=u.length;if(e<0||c<=e)return"";for(n=[],r=0,i=0;i<c;i++){for(o=u[i],a=!1,s=0;s<n.length;s++)if(n[s].text.replace(/\s+/g,"").toUpperCase()===o.text.replace(/\s+/g,"").toUpperCase()){a=!0;break}if(a){if(e===i){r=s;break}}else if(n.push(o),e===i){r=n.length-1;break}}return(l=t.DEFAULT_RANGE_COLORS)[r%l.length]},e.prototype.M0=function(){var e,t,n;return!!this.MH||!!this._isSelectMode||!!(e=this.s1(this.caret()))&&(t=e.type,n=e.text,1===t||8===t||7===t&&"%"!==n||5===t||9===t||15===t)},e.prototype.t1=function(e){if(!e||!this.MH)return!1;var t=this.W0,n=this.caret(),o=e.textOffset;return t<=o&&o<n},e.prototype.u1=function(){var e,t,n=[],o=this.l1(),r=o.length;if(r>0)for(t=0;t<r;t++)e=o[t],this.t1(e)&&n.push(e);return n},e.prototype._appendRange=function(e,t,n){var o,r,i,s,u,c,f,h,p,d,g,m=this,y=m._host;if(e&&y){if(!m.MH){if(!m.M0())return;t=!1,m.MH=!0,m.W0=m.caret(),m.Wq("AppendStarted",{})}o=m.W0,r=m.text(),i=m.caret(),r||(r="=",o=m.W0=1,i=1),s=i,n&&(t=!1,r=r.substr(0,o)+r.substr(i),m._tokens=m.T0(r),s=i=o),u=m.s1(i),t?(c=(c=r.substr(0,i)).substr(0,c.length-u.text.length)).length>=o&&(u.text=e,s=c.length+e.length):(f=m._tokens,h=a.Common.k.Cb(f,u),p=m._isSelectMode&&f.length>1&&h===f.length-1&&11===u.type,i>o||p?(f.splice(h+1,0,{text:this.w1(),type:8}),f.splice(h+2,0,{text:e,type:11}),e=","+e):f.splice(h+1,0,{text:e,type:11}),s=i+e.length),m.z1(),d={},(g=l.G0.H0)&&g._text&&(d={sheet:g.kj,editor:g.I0&&g.I0.firstChild.firstChild,canvasOffset:g.f1}),m.Wq(I,d),m.caret(s)}},e.prototype._stopAppending=function(){var e=this;e.MH&&(e.MH=!1,e.W0=-1,e.Wq("AppendEnded",{}))},e.prototype.B1=function(){this.MH=!0,this.W0=this.caret()},e.prototype.C1=function(e){return void 0!==e&&(this.W0=e),this.W0},e.prototype._repalceRange=function(e,t,n){var o,r,i,a,s,l,u,c=this;if(c._host&&!(e<0)&&t){for(o="",r=!1,a=(i=c._tokens)&&i.length,l=0,u=0;u<a;u++){if(11===(s=i[u]).type&&l++===e){i[u]={text:t,type:11},r=!0;break}o+=s.text}r&&(c.z1(),c.Wq(I,{}),n?c.caret(c.text().length):c.caret(o.length+t.length))}},e.prototype.j1=function(){var e,t,n=this;n.OC&&(e=n._host,n.OC&&e&&(e.setAttribute(A,"gcAttachedFormulaTextBox"),n._isSelectMode||(n.OC.CF=n),n.OC._bind(s.Events.FormulatextboxEditStarted,n,n.E1),n.OC._bind(s.Events.FormulatextboxEnterCell,n,n.F1),n.OC._bind(s.Events.FormulatextboxEditEnded,n,n.G1),n.OC._bind(s.Events.FormulatextboxActiveSheetChanged,n,n.H1),n.OC._bind(s.Events.FormulatextboxRangeChanged,n,n.I1),n.OC._bind(s.Events.FormulaTextBoxTextChanged,n,n.J1),n.OC._bind(s.Events.FormulaTextBoxCaretChanged,n,n.K1),n.OC._bind(s.Events.ValueChanged,n,n.qLb),(t=L(n.OC))&&!n._isSelectMode&&n.text(n._getEditText(t,t.Jl,t.Kl)),n._bind(I,n,n.M1),n._bind(R,n,n.N1)))},e.prototype.refresh=function(e){var t,n=this.OC,o=this;n&&((t=L(n))&&!o._isSelectMode&&(o._isWorking=!!e||o._isWorking,o.text(o._getEditText(t,t.Jl,t.Kl)),o._isWorking=!1))},e.prototype.Y0=function(){var e=this,t=e.OC;!e.O0&&t&&(e._isSelectMode||(t.CF=null,t._unbind(s.Events.FormulatextboxEditStarted,e.E1),t._unbind(s.Events.FormulatextboxEnterCell,e.F1),t._unbind(s.Events.FormulatextboxEditEnded,e.G1),t._unbind(s.Events.FormulatextboxActiveSheetChanged,e.H1),t._unbind(s.Events.FormulatextboxRangeChanged,e.I1),t._unbind(s.Events.FormulaTextBoxTextChanged,e.J1),t._unbind(s.Events.FormulaTextBoxCaretChanged,e.K1),t._unbind(s.Events.ValueChanged,e.qLb),e._unbind(I,e.M1),e._unbind(R,e.N1)),e.text("")),e.OC=null},e.prototype._startingEdit=function(){var e,t,n=this;n._isWorking||(n._isWorking=!0,(t=(e=this.OC)&&L(e))&&!t.isEditing()?(n._isSelectMode||t.EF(null,t.Jl,t.Kl,null,null,!1,null),n.Q1=!0):n.Q1=!1,n._isWorking=!1,n._isFuncsShown||n._openFuncHelp())},e.prototype.rLb=function(){var e=this,t=e._host,n=e.sLb;t.insertBefore(n,t.firstChild),n.innerText=e.oLb},e.prototype.tLb=function(e,t){e&&(this.uLb!==t&&(this.uLb=t,e.style.display=t?"":"none"))},e.prototype.pLb=function(){var e,t=this,n=t._host;t.Cia(n)?((e=t.sLb)||((e=t.sLb=d("span")).className="gcsj-func-gray-formula"),t.tLb(e,!0),t.rLb()):n.placeholder=t.oLb},e.prototype.vLb=function(){var e,t=this;t.oLb&&(t.oLb="",e=t._host,t.Cia(e)?t.tLb(t.sLb,!1):e.placeholder="")},e.prototype._startEdit=function(){var e,t,n,o,r,i,a=this,s=a.OC,l=s&&L(s);l&&(e=l._formulaTextBox,a.Q1&&e&&(t=e.text(),(n=a.text())!==t&&(o=a.caret(),r=l.getFormulaInformation(l.getActiveRowIndex(),l.getActiveColumnIndex()),a.text(t),r.isArrayFormula&&(o>=n.length&&(o-=1),o=f(0,o-1)),a.caret(o))),(a.Q1&&e||a._isSelectMode)&&(2!==(i=l._editorStatus)&&(l._editorStatus=2,l._raiseEditorStatusChanged(i,2))))},e.prototype._getEditText=function(e,t,n){var o,r,i,a,l,u="";if(e){if(r=(o=e.parent)&&o.options,(i=e.getFormulaInformation(t,n))&&i.hasFormula){if(u="="+i.formulaWithCulture,i.isDynamicArray)return this.oLb=u,"";this.oLb="",i.isArrayFormula&&(u="{"+u+"}")}else a=e.getActualStyle(t,n),u="string"==typeof(l=e.getValue(t,n))&&a.quotePrefix||u.length>0&&"="===u[0]&&r&&r.allowUserEditFormula?"'"+l:s.Ul.Il(a,l,e)||"";this.vLb()}return u},e.prototype.H1=function(e,t){var n,o,r=e.data;r._isWorking||(n=t.newSheet,r._isSelectMode||(r._isWorking=!0,r.close(),t&&(o=n,r.text(r._getEditText(o,o.Jl,o.Kl))),r._isWorking=!1))},e.prototype.E1=function(e){var t,n,o,r=e.data;r._isWorking||(o=(n=(t=r.OC)&&L(t))&&n._formulaTextBox)&&r._isSelectMode===o._isSelectMode&&r.C5===o.C5&&(r.vLb(),r._isWorking=!0,r.text(o.text()),r._isWorking=!1)},e.prototype.F1=function(e,t){var n=e.data;n._isSelectMode||n._isWorking||(n._isWorking=!0,t&&n.text(n._getEditText(t.sheet,t.row,t.col)),n._isWorking=!1)},e.prototype.I1=function(e,t){var n,o,r,i,a,l=e.data;l._isWorking||l._isSelectMode||(l._isWorking=!0,t&&(n=t.sheet,o=t.row,r=t.col,i=t.rowCount,a=t.colCount,new s.Range(o,r,i,a).contains(n.Jl,n.Kl)&&l.text(l._getEditText(n,n.Jl,n.Kl))),l._isWorking=!1)},e.prototype.G1=function(e,t){var n=e.data;return n._isSelectMode&&n.D5&&n.E5?void(t.ignore=!0):void(n._isWorking||(n._isWorking=!0,n.close(),t&&t.sheet._formulaTextBox&&!t.sheet._formulaTextBox._isSelectMode&&!n._isSelectMode&&n.text(n._getEditText(t.sheet,t.row,t.col)),n._isWorking=!1))},e.prototype.qLb=function(t,n){var o=n.sheet,r=o&&o.parent&&o.parent.CF;r&&r.e2()===n.row&&r.f2()===n.col&&r.a1()===o&&t.data instanceof e&&(n.text=o.getText(n.row,n.col),t.data.J1(t,n))},e.prototype.J1=function(e,t){var n,o=e.data;o._isWorking||(!t.sheet._formulaTextBox||o._isSelectMode===t.sheet._formulaTextBox._isSelectMode&&o.C5===t.sheet._formulaTextBox.C5)&&(o._isWorking=!0,t&&(n=o.caret(),o.text(t.text),o.caret(n)),o._isWorking=!1)},e.prototype.K1=function(e,t){var n=e.data;n._isWorking||(!t.sheet._formulaTextBox||n._isSelectMode===t.sheet._formulaTextBox._isSelectMode&&n.C5===t.sheet._formulaTextBox.C5)&&(n._isWorking=!0,t&&n.caret(t.caret),n._isWorking=!1)},e.prototype.M1=function(e){var t,n,o,r,i,a,s,l,u=e.data;if(!u._isWorking&&(n=(t=u.OC)&&L(t))){if(n.isEditing()||(u._startingEdit(),u.focus()),u._isWorking=!0,o=n.Jl,r=n.Kl,i=n._formulaTextBox,a=n.getCellType(o,r),i){if(u._isSelectMode!==i._isSelectMode||u.C5!==i.C5)return;s=i.caret(),i.text(u.text()),i.caret(s)}else l={sheet:n,row:o,col:r,sheetArea:3},a.setEditorValue(n._editor,u.text(),l);u._isWorking=!1}},e.prototype.N1=function(e){var t,n,o,r=e.data;r._isWorking||(n=(t=r.OC)&&L(t))&&n.isEditing()&&((!(o=n._formulaTextBox)||r._isSelectMode===o._isSelectMode&&r.C5===o.C5)&&(r._isWorking=!0,o&&(o.caret(r.caret()),r._openFuncHelp()),r._isWorking=!1))},e.prototype.ad=function(e){var t,n,o,r=this;r.T1=!1,r.U1=!1,r.MH=!1,r.W0=-1,r.i1=[],r.g1=!0,r.h1=!0,r.V1=!0,(t=d("div")).className="gcsj-func-ac-popup",t.style.display="none",t.setAttribute(A,"gcFuncACPopup"),e.insertBefore(t,u),r._funcsPopup=t,r._isFuncsShown=!1,(n=d("div")).className="gcsj-func-help-popup",n.style.display="none",n.setAttribute(A,"gcFuncHelpPopup"),e.insertBefore(n,u),r.$0=n,r._isFuncHelpShown=!1,s.GC$(t).bind("mouseover",(function(){r.V1=!1})).bind("mouseout",(function(){r.V1=!0})),s.GC$(n).bind("mouseover",(function(){r.V1=!1})).bind("mouseout",(function(){r.V1=!0})),s.GC$(t).bind("scroll",(function(){r.X1&&clearTimeout(r.X1),r.X1=g.setTimeout((function(){r._host&&r._host.focus()}),100)})),(o=d("div")).style.display="none",o.setAttribute(A,"gcFuncHelpDiv"),e.insertBefore(o,u),r._0=o,r.OC=null,r._isWorking=!1,r.Q1=!1,r.O0=!1},e.prototype.N0=function(e){var t,n,o;e&&(n=(t=this).Cia(e),(t.d1(e)||n)&&(o=s.GC$(e),t._host&&t.X0(),t._host=e,b&&(b.msie||b.chrome)?n||C||b.chrome?(t._bind("focus",(function(){o.data(_,t.text())})),t._bind("click",(function(){o.focus()})),"input keydown keyup cut paste".split(" ").forEach((function(e){t._bind(e,(function(){t.Y1()}))}))):t._bind(M,(function(){t.Z1()})):t._bind(M,(function(){if(n){var e=t._host.lastChild;b.chrome&&e&&"BR"===e.tagName&&t._host.removeChild(e)}t.Z1()})),t._bind("keydown",(function(e){var o,r,i,a=e.ctrlKey,l=e.shiftKey,u=e.altKey,c=e.metaKey,f=a||l||u||c,h=e.keyCode;!f&&t._isFuncsShown&&(h===k.down?(t._1(1),v(e)):h===k.up?(t._1(-1),v(e)):h===k.tab&&(t._completeFunc(),v(e))),h===k.esc&&t.close(),t.b2(e),r=(o=L(t.OC))._eventHandler.LH(e),t._isSelectMode&&r&&((i=o._formulaTextBox)&&i.MH&&i._stopAppending()),n&&(r?(8===h?Z(e)&&s.uHb.processBackspaceAndLeftArrowKeyEvent(e,!0):46===h&&Z(e)&&s.uHb.processDeleteAndRightArrowKeyEvent(e,!0),t.Jka()):13===h&&(a||u)?(Z(e)&&function(){var e,t,n,o=g.getSelection();o.rangeCount>0&&(e=o.getRangeAt(0),(t=m.createElement("span")).innerHTML="<br/>",e.insertNode(t),(n=m.createRange()).setStartAfter(t),n.setEndAfter(t),n.collapse(!1),o.removeAllRanges(),o.addRange(n))}(),t.Jka(!0)):37===h?Z(e)&&s.uHb.processBackspaceAndLeftArrowKeyEvent(e,!1):39===h&&Z(e)&&s.uHb.processDeleteAndRightArrowKeyEvent(e,!1),n&&a&&(90===h||89===h)&&v(e))})),t._bind("keyup",(function(e){var o,r,i,a;t.b2(e),o=t.text(),n&&(r=void 0,i=e.keyCode,(a=e.ctrlKey)&&90===i?(r=t.Ac.pop()||"",t.text(r),t.Bc.push(o)):a&&89===i&&((r=t.Bc.pop())&&(t.text(r),t.Ac.push(o))))})),t._bind("focus",(function(e){b&&b.mozilla&&!t._host.innerText&&(t._host.innerText=""),t.b2(e),t._isSelectMode&&t.D5&&(t.E5=!0,t.j5())})),t._bind("blur",(function(){t.V1&&t.close(),t._isSelectMode&&(t.H5(),t.E5=!1)})),t._bind("mousedown",(function(){t.E5=!0,t.uLb&&(t.vLb(),t.wLb=!0),t._startingEdit()})),t._bind("mouseup",(function(){if(t.wLb){t.wLb=!1;var e=t._host,n=g.getSelection();e!==n.anchorNode&&n.selectAllChildren(e)}t._startEdit()})),t._bind("click",(function(e){var n,o,r;t.MH&&t._stopAppending(),(r=(o=(n=t.OC)&&L(n))&&o._formulaTextBox)&&r.MH&&!r._isSelectMode&&r._stopAppending(),t.b2(e)})),t._bind("compositionstart",(function(){t.T1=!0})),t._bind("compositionend",(function(){t.T1=!1,(b.edge||b.chrome)&&t.Y1()}))))},e.prototype.X0=function(){var e,t=this,n=t._host;n&&((e=s.GC$(n)).removeData(_),e.removeData(O),e.removeAttr(A),t.nu(),t.unbindAll(),t._isSelectMode&&(s.GC$(t.cga).empty(),t.cga=u),t._host=u)},e.prototype.Y1=function(){var e=this,t=s.GC$(e._host),n=e.text();t.data(_)!==n&&(e.T1||t.data(_,n),e.Z1())},e.prototype.b2=function(e){if(b&&b.msie){setTimeout(function(e,t){return function(){e.d2(e,t)}}(this,e),10)}else this.d2(this,e)},e.prototype.d2=function(e,t){var n,o,r,i,a,l=t.keyCode,u=l===k.left||l===k.right||l===k.home||l===k.end||l===k.pdn||l===k.pup||l===k.tab||l===k.enter;if(e.g1||(u=u||l===k.up||l===k.down),n=void 0!==t.button,u||n){if(o=e._host,r=s.GC$(o),(i=e.b1(o)).start!==i.end)return;a=i.end,r.data(O)!==a&&(r.data(O,a),e.Wq(R,{}),e._openFuncHelp())}},e.prototype.e2=function(){return this.OC?L(this.OC).Jl:c},e.prototype.f2=function(){return this.OC?L(this.OC).Kl:c},e.prototype.a1=function(){if(this.OC)return L(this.OC)},e.prototype.parseInternal=function(e,t,n,i){var a,s,l=[];return e&&"="===e[0]&&function(e,t){var n,o=0;for(n=0;n<e.length;n++)e[n]===t&&o++;return o}(e,'"')%2!=1?(a=new o.Parser,s=r.qzb(a,e,t,n,i,!0),l=this.i2(s)):(l.push({text:e,type:17}),l)},e.prototype.T0=function(e){return this.parseInternal(e,this.a1(),this.e2(),this.f2())},e.prototype.Z1=function(){var e,t,n,o=this,r=o.text();return"\n"!==r&&r.indexOf("\n")>=0?void o.Wq(I,{type:M}):(e=o._host,t=s.GC$(e),o.U1=!0,o._tokens=o.T0(r),o.Cia(e)?o.T1||("\n"===r?(t.empty(),o.Wq(I,{type:M})):(n=o.caret(),o.V0(o._tokens),o.Wq(I,{type:M}),o.caret(n))):o.Wq(I,{type:M}),n=o.caret(),t.data(O)!==n&&(t.data(O,n),o.Wq(R,{})),o._openFuncs(),void(o._isFuncsShown||o._openFuncHelp()))},e.prototype.j2=function(){return a.Common.CultureManager.q4().NumberFormat},e.prototype.h2=function(){var e=this.j2();return e&&e.arrayGroupSeperator||";"},e.prototype.l2=function(){var e=this.j2();return e&&e.arrayListSeparator||","},e.prototype.w1=function(){var e=this.j2();return e&&e.listSeparator||","},e.prototype.g2=function(){var e=this.j2();return e&&e.numberDecimalSeparator||"."},e.prototype.i2=function(e){var t,n,o,r,i=[],s=[],l=this.h2(),u=this.l2(),c=!1;for(t=0;t<e.length;t++)t>0&&t<e.length-1&&";"===e[t-1].text&&","===e[t].text&&"ARRAYROW"===e[t+1].text||(n=e[t],o=this.m2(n,s),r=n.text,2===o?i.push({text:r,type:o}):c&&8===o&&","===r?i.push({text:u,type:9}):c&&8===o&&";"===r?i.push({text:l,type:10}):8===o?i.push({text:r,type:o}):3===o?("ARRAY"===r&&(c=!0),i.push({text:"{",type:3})):4===o?"ARRAY"===r?(c=!1,i.push({text:"}",type:4})):i.push({text:r,type:4}):6===o?i.push({text:")",type:o}):13===o?i.push({text:a.Common.o.nb(r),type:o,ranges:n.ranges,allowDrag:n.canDrag}):null!==o&&i.push({text:r,type:o,ranges:n.ranges,allowDrag:n.canDrag}));return i},e.prototype.m2=function(e,t){var n,o=e.type,r=e.subType,i=e.text,a=e.value;if(1===o){if(1===r)return"ARRAY"===i||"ARRAYROW"===i?(t.push(3),3):(t.push(5),"@"===a||"("===a.trim()?5:2);if(2===r){if(")"===a.trim())return 6;if(t.length>0){if(3===(n=t[t.length-1]))return t.pop(),4;if(5===n)return t.pop(),6}}if("="===a.trim())return 1}else if(3===o){if(0===r)return 8}else{if(5===o||6===o||4===o)return 7;if(0===o)return 7===r||0===r?11:5===r?12:4===r?13:3===r?14:6===r?16:14;if(7===o)return 15;if(8===o)return 17}return 17},e.prototype.z1=function(){var e,t=this,n=t._host,o=t._tokens,r="",i=o&&o.length;for(e=0;e<i;e++)r+=o[e].text;t.d1(n)?n.value=r:t.Cia(n)&&t.V0(o)},e.prototype.d1=function(e){var t=e&&e.tagName;return"TEXTAREA"===t||"INPUT"===t},e.prototype.Cia=function(e){return e&&"DIV"===e.tagName&&"true"===e.contentEditable},e.prototype.Dia=function(e){return"gcEditingInput"===s.GC$(e).attr(A)},e.prototype.bW=function(e){return e&&"="===e[0]},e.prototype._bind=function(e,t,n){var o=this._host;o&&e&&(e=e.split(/\s+/).join(T+" "),s.GC$(o).bind(e+T,t,n))},e.prototype._unbind=function(e,t){var n=this._host;n&&e&&(e=e.split(/\s+/).join(T+" "),s.GC$(n).unbind(e+T,t))},e.prototype.nu=function(){var e=this._host;e&&s.GC$(e).unbind(T)},e.prototype.Wq=function(e,t){var n=this._host;n&&s.GC$(n).trigger(e,t)},e.prototype.s1=function(e){var t,n,o,r,i;if(e<=0)return u;if((n=(t=this._tokens)&&t.length)>0)for(o=0,r=void 0,i=0;i<n;i++)if((o+=(r=t[i]).text.length)>=e)return r;return u},e.prototype.n2=function(){var e,t,n,o,r,i=this.OC;if(i&&((e=L(i))&&(t=e.getCalcService().allowDynamicArray,n=e._formulaTextBox))){for(r=(o=[].concat(n.i1)).length-1;r>=0;r--)!t&&o[r]&&U(o[r].name)?o.splice(r,1):o[r].isFunc=!0;return o.concat(this.o2(i,e)).concat(this.q2(i.sheets))}return this.i1},e.prototype.o2=function(e,t){var n,o=[],r=t.getCustomNames();return r&&s.GC$.each(r,(function(e,t){o.push({name:t.Cj,description:t.kT})})),(n=e.getCustomNames())&&s.GC$.each(n,(function(e,t){o.push({name:t.Cj,description:t.kT})})),o},e.prototype.q2=function(e){var t=[];return e.forEach((function(e){var n,r,i=e.tables;if(i&&(n=i.all()))for(r=0;r<n.length;r++)t.push({name:n[r].name(),description:o.sR().Fbx_TableName_Description+n[r].name()})})),t},e.prototype.s2=function(e,t){var n,o,r,i;for(e=w(e),y.Bb(e,"[")&&(e=e.substr(e.lastIndexOf("[")+1),e=y.Gb(e,"@","")),n=[],o=t&&t.length,i=0;i<o;i++)r=t[i],0===w(V(r.name)).indexOf(e)&&n.push(r);return n},e.prototype.t2=function(){var e,t,n,o,r,i=this.caret();if(i<=0)return"";if((t=(e=this._tokens)&&e.length)>0)for(n=0,o=void 0,r=0;r<t;r++){if(n+(o=e[r]).text.length>=i)return o.text.substring(0,i-n);n+=o.text.length}return""},e.prototype.u2=function(){var e,t,n,o,r,i,a,s,l,c=this.caret(),f=this._tokens,h=f&&f.length,p=[],d=0;for(t=0;t<h;t++){if(e=f[t],p.push(e),6===e.type)for(n=0;p.length>0;)if(6===(o=p.pop()).type&&n++,5===o.type&&n--,0===n){p.length>0&&((o=p[p.length-1])&&2===o.type&&p.pop());break}if((d+=e.text.length)>=c)break}if(p.length>0)for(r=0;p.length>0;)if(8===(e=p.pop()).type)r++;else if(2===e.type){for(i=w(e.text),s=(a=this.n2())&&a.length,l=void 0,t=0;t<s;t++)if(l=a[t],w(V(l.name))===i)return{func:l,activeParamterIndex:r,isFunc:l.isFunc};break}return u},e.prototype._openFuncs=function(){var e,t,n,o,r,i,a,l,u=this,c=u.v2();if(u.g1&&u.bW(u.text())&&c&&c.length>0&&!u.MH&&!u.T1&&!u._isSelectMode){for(u._closeFuncHelp(),e=u._funcsPopup,c.length>8?(e.style.height="204px",e.style.overflowY="scroll"):(e.style.height="auto",e.style.overflowY=""),t="",n=c.length,o=void 0,r=0;r<n;r++)t+="<div class='gcsj-func-ac-row'><div class='gcsj-func-ac-row-name' isFunc="+(o=c[r]).isFunc+">"+V(o.name)+"</div><div class='gcsj-func-ac-row-description'>"+(o.description||"")+"</div></div>";(i=s.GC$(u._funcsPopup)).html(t).show(),u._isFuncsShown=!0,(a=i.find(".gcsj-func-ac-row")).length>0&&(l="gcsj-ac-row-active",s.GC$(a[0]).addClass(l),a.bind("mouseover",(function(){a.removeClass(l),s.GC$(this).addClass(l)})),a.bind("click",(function(){u._completeFunc()}))),u._position()}else u._closeFuncs()},e.prototype.v2=function(){var e,t,n,r,i,a,s,l=this,u=l.s1(l.caret()),c=u&&u.text,f=[],h=l._tokens.indexOf(u);if(u&&14===u.type)return f;if((e=l.A2(h)).length>0){for(i in t=JSON.parse(JSON.stringify(o.sR().B2)),n=o.getMapping()&&o.getMapping().tableFunctionsMapping,r=[],t)(a=n&&n[t[i].name])&&(t[i].name=a),r.push(t[i]);if(f=f.concat(e).concat(r),y.jb(c,"[")||y.jb(c,"[@"))return f}else f=this.n2();return s=[],(c=l.t2())&&(s=l.s2(c,f)),s},e.prototype.A2=function(e){var t,n,o,r,i,a,s,l,c=[],f=this._tokens,h=f&&f.length;if(e<0||e>=f.length)return c;if(n=(t=this.OC)&&L(t),o={},void 0!==e&&e!==u||(e=h),n&&(r=f[e],void 0!==(a=(i=n.tables)&&i.findByName(y.Ib(r.text,"[")))&&a!==u&&!o[a])){for(o[a]=!0,s=0,l="";l!==u;)l=a.getColumnName(s),s++,l!==u&&c.push({name:l,description:""});if(c.length>0)return c}return c},e.prototype._closeFuncs=function(){s.GC$(this._funcsPopup).hide(),this._isFuncsShown=!1},e.prototype._1=function(e){var t,n,o,r,i,a,l=s.GC$(this._funcsPopup).find(".gcsj-func-ac-row"),u=l.length;if(0!==u){if(t="gcsj-ac-row-active",n=0,e)for(o=0;o<u;o++)if(s.GC$(l[o]).hasClass(t)){n=o+e;break}r=s.GC$(this._funcsPopup).scrollTop(),l.removeClass(t),i=0,u>0&&(i=l[0].offsetHeight),n=f(n,0),a=l[n=h(n,u-1)],s.GC$(a).addClass(t),a.offsetTop+a.offsetHeight>s.GC$(this._funcsPopup).scrollTop()+s.GC$(this._funcsPopup).height()?s.GC$(this._funcsPopup).scrollTop(s.GC$(this._funcsPopup).scrollTop()+i):a.offsetTop<s.GC$(this._funcsPopup).scrollTop()?s.GC$(this._funcsPopup).scrollTop(a.offsetTop):s.GC$(this._funcsPopup).scrollTop(r)}},e.prototype._completeFunc=function(){var e,t,n,o,r,i,a,l,c,f,h,p,d,g,m,v=this,b=s.GC$(v._funcsPopup).find(".gcsj-ac-row-active .gcsj-func-ac-row-name"),C=b.text(),w="true"===b.attr("isFunc");if(C){for(e=v.caret(),n=(t=v._tokens)&&t.length,o=0,r=0,i=0,a=u;i<n&&!(o+(r=(a=t[i]).text.length)>=e);)i++,o+=r;l=e-o,c=a.text,f=0,h=0,y.Bb(c,"[")?-1===(f=c.lastIndexOf("[",l-1))?(f=c.indexOf("["),a.text=-1===f?C:C+c.substr(f),f=0):(f++,"@"===c.charAt(f)&&(f+=1),-1===(h=c.indexOf("]",l))&&(h=c.length),a.text=c.substring(0,f)+C+c.substr(h)):(a.text=C,(p=c.substr(l))&&((d=v.T0("="+p)).length>1&&t.splice(i+1,0,d[1]))),a.type=w?2:11,m=t[g=i+1],!w||m&&5===m.type||t.splice(g,0,{text:"(",type:5}),v._closeFuncs(),v._host.focus(),v.z1(),v.caret(o+C.length+f+(w?1:0)),v._openFuncHelp(),v._tokens=v.T0(v.text()),v.Wq(I,{})}},e.prototype._openFuncHelp=function(){var e,t,n,r,i,a,l,c,f,p,d,g,m=this;if(m._isFuncsShown&&m._closeFuncs(),(e=m.u2())!==u&&!0===e.isFunc)if(t=m.w1(),m.h1&&m.bW(m.text())&&e&&!m.MH&&!m.T1&&!m._isSelectMode){for(i=(r=(n=e.func).parameters)&&r.length,a=h(i-1,e.activeParamterIndex),l=void 0,c="",f=0;f<i;f++)p=(l=r[f]).name,l.repeatable&&(p+=t+"..."),l.optional&&(p="["+p+"]"),d=f===i-1?"":t+" ",c+=p=f===a?"<span class='gcsj-func-help-paramter gcsj-func-help-paramter-active'>"+p+"</span>"+d:"<span class='gcsj-func-help-paramter'>"+p+"</span>"+d;g="<div class='gcsj-func-help-title'><div class='gcsj-func-help-formula'><span class='gcsj-func-help-formula-name'>"+V(n.name)+"</span><span class='gcsj-func-help-paramter-paren'>(</span>"+c+"<span class='gcsj-func-help-paramter-paren'>)</span></div></div>"+("<div class='gcsj-func-help-body'>"+("<div class='gcsj-func-help-section-content'>"+("<div class='gcsj-func-help-section'><div class='gcsj-func-help-section-title'>"+o.sR().Fbx_Summary+"</div><div class='gcsj-func-help-section-content'>"+(n.description||"")+"</div></div>")+"</div>")+"</div>"),s.GC$(m.$0).html(g).show(),m._isFuncHelpShown=!0,m._position()}else m._closeFuncHelp();else m._closeFuncHelp()},e.prototype._closeFuncHelp=function(){s.GC$(this.$0).hide(),this._isFuncHelpShown=!1},e.prototype.close=function(){this._closeFuncs(),this._closeFuncHelp()},e.prototype.BH=function(e,t){var n,o,r,i,a,s;return!this.MH&&(n=e.ctrlKey||e.shiftKey||e.altKey||e.metaKey,o=e.keyCode,r=e.ctrlKey,i=e.altKey,a=e.metaKey,(s=e.srcElement||e.target)&&t&&t.isEditing&&"gcAttachedFormulaTextBox"===s.getAttribute("gcUIElement")?67===o&&(r||a)&&!i||88===o&&(r||a)&&!i:this._isFuncsShown&&!n&&(o===k.down||o===k.up||o===k.tab))},e.prototype._position=function(){var e,t,n,o,r,i,a,c,f,h,p,d,g,y,v=this,b=u;if(v._isFuncsShown?b=v._funcsPopup:v._isFuncHelpShown&&(b=v.$0),b){if(e=s.GC$(v._host),t=s.GC$(b),(n=l.G0.H0)&&n.kj)return o=n.kj.getCellRect(n.nT,n.Mk),r=n.f1,void t.css("top",o.y+o.height+r.top).css("left",o.x+r.left);i=e.parent(),a=e.outerHeight(),v.Dia(v._host)&&(a=(i=i.parent()).outerHeight()),c=i.css("top"),f=parseFloat(c),isNaN(f)||(c=f),h=i.css("left"),"auto"===c&&(c=e.offset().top,h=e.offset().left),p=c+a,d=s.GC$(m.body).outerHeight(),p+(g=t.outerHeight())>d&&((y=c-g)>=0&&(p=y)),t.css("top",p).css("left",h)}},e.prototype.focus=function(){s.GC$(this._host).focus()},e.prototype.V0=function(e){var t,n,o,r,i=this,a="",s="",l=e&&e.length,u=0;for(n=0;n<l;n++)o="",11===(t=e[n]).type&&(o=" style='color: "+i.o1(u)+"'",u++),i._0.innerText=t.text,a+="<span"+o+" class='gcsj-func-color-text'>"+i._0.innerHTML+"</span>",s+=t.text;if(s||i.text())if(r=i._host,a)r.innerHTML="<span class='gcsj-func-color-content'>"+a+"</span>";else for(;r.firstChild;)r.removeChild(r.firstChild)},e.prototype.e1=function(e,t){var n,o,r,i=s.GC$(e).find(".gcsj-func-color-content .gcsj-func-color-text"),a=i.length;for(t=f(0,t),r=0;r<a;r++)if((t-=(o=(n=i[r]).innerText).length)<=0)return{node:n,offset:o.length+t};return o?{node:n,offset:o.length}:u},e.prototype.iIb=function(e,t){var n=g.getSelection(),o=this._host.children[0],r=document.createRange();r.setStart(o,e),r.setEnd(o,t),n.removeAllRanges(),n.addRange(r)},e.prototype.Jka=function(e){var t=this,n=t._host,o=t.Cia(n),r=t.text();o&&r&&(r=e?r.substr(0,r.length-2):r,t.Ac.push(r))},e.prototype.nLb=function(e,t){var n,o,r,i,a,s,l;if(t)for(n=0,o=0,r=0,i=t.length,a=0;a<e.length;a++){for(s=e[a].text;o<i;o++)if((l=t[o].toUpperCase())===(s[r]?s[r].toUpperCase():void 0))r+=1;else{if("\n"!==l)break;o+1<i&&""===t[o+1]&&(o+=1)}e[a].text=t.substring(n,o),n=o,r=0}return e},e.prototype.mLb=function(e){var t,n,o,r,i;if("="===e[0]&&-1!==e.indexOf("\n")){for(t=[],n=e.length,o=!1,r=0;r<n;r++)'"'===(i=e[r])&&(o=!o),o||"\n"!==i?t.push(i):r+1<n&&""===e[r+1]&&(r+=1);return t.join("")}},e}(),t.FormulaTextBox=B},"./dist/plugins/sheetsCalc/calc-spreadjs.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function D(e,t,n,o,r){var i=t.getSpan(n,o,r),a=p;return i.row===n&&i.col===o&&(a=e.getValue(n,o,r)),a}function j(e){return e.indexOf("LET(")>-1&&"LET"}function _(e,t,n,r,i,a){var l,u=e&&e instanceof o.Worksheet&&e,c=new s.Parser;return n=n===d?0:n,r=r===d?0:r,l=new I(u,!!i,s._createCellIdentity(n,r)),a&&(l.culture=!0),c.parse(l,t)}function O(e,t,n,o,r){var i,a,l=e.Cf();return n===d&&(n=e.getActiveRowIndex()),o===d&&(o=e.getActiveColumnIndex()),i=!0,r&&r.convertNullToZero!==d&&(i=r.convertNullToZero),a=e.yj(),l._evaluateParsedFormula(a,t,s._createCellIdentity(n,o),!1,i)}function F(e,t,n,o,r){var i,u,c,f=e.row,h=e.col,d=e.row+e.rowCount-1,g=e.col+e.colCount-1,m=!1,y=!1,v=!1,b=!1;return arguments.length>=4&&(f-=(m=0!=(1&o))?t:0,d-=(y=0!=(4&o))?t:0,h-=(v=0!=(2&o))?n:0,g-=(b=0!=(8&o))?n:0),r&&(u=P(e,r,t),c=H(e,r,t),u&&c)?i=a.StructureReferenceResolver.create(r,u,c,e.col-r.dataRange().col,e.col+e.colCount-r.dataRange().col-1):(1===e.rowCount&&1===e.colCount?i=s.rf(p,p,f,h,m,v):(e.row<0&&(f=d=l.BAND_INDEX_CONST),e.col<0&&(h=g=l.BAND_INDEX_CONST),i=s.uf(p,p,f,h,d,g,m,v,y,b,t,n)),i)}function P(e,t,n){if(1===e.rowCount){if(t.hasHeadersRow()&&e.row===t.startRow())return 2;if(t.hasTotalsRow()&&e.row===t.endRow())return 8;if(n===e.row)return 1}else{if(t.hasHeadersRow()&&e.row===t.startRow()){if(e.rowCount===t.dataRange().rowCount+1)return 6;if(t.hasTotalsRow()&&e.rowCount===t.dataRange().rowCount+1+1)return 14}if(e.row===t.dataRange().row){if(e.rowCount===t.dataRange().rowCount)return 3;if(t.hasTotalsRow()&&e.rowCount===t.dataRange().rowCount+1)return 12}}return d}function H(e,t,n){return e.col===t.startColumn()&&e.colCount===t.dataRange().colCount?1:1===e.colCount?2:e.col>=t.startColumn()&&e.col+e.colCount-1<=t.endColumn()?4:d}function B(e,t,n,r){var i,a,s,l,u,c,f,h;if(!t)return null;if(n=n||0,r=r||0,i=e.Cf().parse(e.yj(),t,n,r,!0,!0))if((a=i.source)&&13===i.type);else if(1===i.type&&i.endSource){for(s=i.source,l=i.endSource,u=s.getSources(l),c=!1,f=0;f<u.length;f++)if(u[f]===e.yj()){c=!0;break}i=c&&i}return!i||!i.getRange||a&&a!==e.yj()?null:(h=i.getRange(n,r))?new o.Range(h.row,h.col,h.rowCount,h.colCount):null}function L(e,t,n,o,r,i){var a,s,l,u="";for(a=0;a<n.length;a++)s=F(n[a],o,r,i),l=e.unparse(t,s),u+=a>0?", "+l:l;return u}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("Core"),i=n("@grapecity/js-sheets-common"),a=n("./dist/plugins/sheetsCalc/parser-sheets.js"),s=n("@grapecity/js-calc"),l=n("./dist/plugins/sheetsCalc/calc.ns.js"),u=i.Common.j,c=i.Common.u,f=u.Ia,h=u.za,p=null,d=void 0,g=["v","n","s","b","d","sn"],m=s.Errors.Value,s.Errors.Calc,y=i.Formatter&&i.Formatter.GeneralFormatter,v=s.Convert.vf,s.Convert._isReference,s.Convert.Ca,s.Errors.Reference,s.Errors.NotAvailable,s.Errors.Name,i.Common.A,i.Common.B,b=u.Fa,C=function(e){return s.Convert.Na(e,!0)},w=o.Range.prototype.contains,x=c.Nb,A="number",(M=s.CalcSource.prototype).referenceToArray=function(e,t,n,o,r,i,a,l){var u,c,f,h,g,y,v,b,C,w,x,A,M=this,S=1,T=1,N=[],I=e.getRangeCount();if(0===I)return N.isError=!0,N;for(v=M.getRowCount(),b=M.getColumnCount(),n=n===d||n,C=0;C<I;C++){if(n||(y=[],N.push(y)),0===(S=e.getRowCount(C)))return N.isError=!0,N;if(0===(T=e.getColumnCount(C)))return N.isError=!0,N;if(f=e.getRow(C),h=e.getColumn(C),f>=v||h>=b)return(N=[p]).rowCount=1,N.colCount=1,N.rangeCount=1,N;for(f+S>v&&(S=v-f),h+T>b&&(T=b-h),w=void 0,x=0;x<S;x++)for(u=f+x,n||(w=[],y.push(w)),A=0;A<T;A++){if(c=h+A,g=M.getValue(u,c),o&&s.Convert.vf(g))return(N=[g]).isError=!0,N;if(g=s.Convert.wf(g,t,!s.ExcelCompatibleCalcMode,i,l),r&&g===s.Convert.CalcConvertedError)return(N=[m]).isConvertError=!0,N;g===p&&i||(n?N.push(g):w.push(g))}}return n||1!==I||(N=N[0]),N.rowCount=S,N.colCount=T,N.rangeCount=I,N},M.getSheetReference=function(){var e=this;return e.Df=e.Df||new s.CalcReference(e),e.Df},function(e){e[e.a1=0]="a1",e[e.r1c1=1]="r1c1"}(S=t.ReferenceStyle||(t.ReferenceStyle={})),r.ReferenceStyle=S,T=function(){function e(e,t,n,o,r){var i=this;i.Cj=e,i.Uu=n,i.Vu=o,i.Lf=t,b(r)||(i.kT=r)}return e.prototype.getName=function(){return this.Cj},e.prototype.getRow=function(){return this.Uu},e.prototype.getColumn=function(){return this.Vu},e.prototype.getExpression=function(){return this.Lf},e.prototype.getComment=function(){return this.kT},e.prototype.fg=function(e,t){t&&t.push({type:"customName",nameInfo:this,expr:this.Lf}),this.Lf=e},e}(),t.NameInfo=T,r.NameInfo=T,s.CalcSource.prototype.createSourceModel=function(e){return new s.CalcSourceModel(e,this)},N=function(e){function t(t){var n=e.call(this,p)||this;return n.references=t,n}return E(t,e),t.prototype.toArray=function(e,t,n,o,r){var i,a,s=this.references,l=[];for(i=0;i<s.length;i++){if((a=s[i]._source.referenceToArray(s[i],e,t,n,o,r)).isError&&n)return a;t?Array.prototype.push.apply(l,a):l.push(a[0]),i||(l.rowCount=a.rowCount,l.colCount=a.colCount)}return l.rangeCount=s.length,l},t}(s.CalcReference),t.SheetRangeReference=N,I=function(e){function t(t,n,r,i){var s,l,u,c=e.call(this,t&&t.yj(),n,r,i)||this;for(t||(t=new o.Worksheet),c.kj=t,c.row=r&&r.row||0,c.column=r&&r.col||0,l=(s=t.getCalcService()).getResolvers(),u=0;u<l.length;u++)if(l[u]instanceof a.SheetReferenceResolver)return c;return s.addResolver(new a.SheetReferenceResolver(t)),s.addResolver(new a.StructureReferenceResolver(t)),c}return E(t,e),t.prototype.getExternalSource=function(e,t){var n,o,r,i=this,a=i.kj.parent;if(e&&(!a||a.name!==e))return p;if(!a)return c.Mb(i.kj.name(),t)?i.kj.yj():p;if((n=a.sheets)&&n.length>0)for(o=0;o<n.length;o++)if(r=n[o],c.Mb(r.name(),t))return r.yj();return s.ParserContext.prototype.getExternalSource.call(this,e,t)},t.prototype.getExternalSourceToken=function(e){return e.getName()},t.prototype.getTableByName=function(e){var t,n,o=this.kj.tables,r=o?o.findByName(e):p;if(!r&&(t=this.kj.parent&&this.kj.parent.sheets))for(n=0;n<t.length&&(!(o=t[n].tables)||!(r=o.findByName(e)));n++);return r},t.prototype.getTableByIndex=function(e,t){var n=this.kj.tables;return n?n.find(e,t):p},t.prototype.setSource=function(e){this.source=e;var t=e;t&&t.getSheet&&(this.kj=t.getSheet())},t.prototype.no=function(){this.kj&&this.kj.no()},t}(s.ParserContext),t.SheetParserContext=I,new i.Common.ResourceManager(o.SR),R=function(e){function t(n,o){var r=e.call(this,p)||this;return r.getCalcSourceModel=function(){return this.Bf},r.createSourceModel=function(e){return new s.CalcSourceModel(e,this)},r.getRangeKey=function(e,t){return e.id+","+t.row+","+t.col+","+t.rowCount+","+t.colCount},r.getSheetRangeReference=function(e){var n,o,r,i,a,s=this.kj,l=s&&s.parent;if(e.endSource&&l&&l.sheets&&e.endSource instanceof t){for(n=l.sheets,o=!1,r=void 0,i=[],a=0;a<n.length;a++){if((r=n[a].yj())===this)o=!0;else if(r===e.endSource){i.push(r.getReference(e));break}o&&i.push(r.getReference(e))}return new N(i)}},r.kj=n,r.Wz=o||3,r}return E(t,e),t.prototype.startCalculation=function(){this.Hu||this.xLb()},t.prototype.endCalculation=function(){this.Hu=p,this.zIc(),this.Iu=p;var e=this.Bf.ug(!1);e&&e.clearListenersCache(),this._service.calcOnDemand&&this.kj.repaint()},t.prototype.zIc=function(){var e,t=this.Iu;t&&t.length>0&&(e=this.kj).Wq(o.Events.RangeChanged,{isUndo:!1,sheet:e,sheetName:e.name(),row:0,col:0,rowCount:e.getRowCount(),colCount:e.getColumnCount(),changedCells:t,action:6},e.vxb)},t.prototype.clearValueCache=function(){this.xLb()},t.prototype.xLb=function(){var e=this.getRowCount(),t=this.getColumnCount();this.Hu={rowCount:e,colCount:t,arrayInfo:[]},this.Iu=[]},t.prototype.OHb=function(){this.Hu=p,this.Iu=p},t.prototype.getValue=function(e,t){var n,r,i,a,l,u,c,f,h,y,v,b,C,w=[];for(n=2;n<arguments.length;n++)w[n-2]=arguments[n];if(i=(r=this).kj,typeof e===A)a=arguments[0],l=arguments[1],t=arguments[2];else if((e=e).row!==d)a=e.row,l=e.col;else if(e.name)return null;return u=r.Wz,t=t||0,a<0||l<0?m:i.Ju&&i.Ku===a&&i.Lu===l?i.Mu:(c=r.Hu,f=g[t],c?(h=c.rowCount,y=c.colCount,v=void 0,b=void 0,C=void 0,a>=h||l>=y?p:((v=c[a])||(v=c[a]={}),(b=v[l])||(b=v[l]={v:i.getValue(a,l,u)}),(C=b[f])===d&&(C=s.Convert.wf(b.v,t,!s.ExcelCompatibleCalcMode),b[f]=C),C=o.Ul.w0a(C))):a>=r.getRowCount()||l>=r.getColumnCount()?p:r.kj.getValue(a,l,u))},t.prototype.getIdentity=function(e,t){var n=this,o=t.row,r=t.rowCount||1,i=t.column,a=t.columnCount||1;return-1===o&&(o=0,r=n.getRowCount()),-1===i&&(i=0,a=n.getColumnCount()),n.getName()+"."+o+"."+r+"."+i+"."+a},t.prototype.getReference=function(e){var t,n,o,r,i,a,l=this,u=e.row,c=e.col;if(-1===u&&(e.row=0,e.rowCount=l.getRowCount()),-1===c&&(e.col=0,e.colCount=l.getColumnCount()),t=!1,e.spillRef)if(n=l.yLb().getAnchorCell(u,c))e.rowCount=n.rowCount,e.colCount=n.colCount,t=!n.isValid;else{if(r=(o=l.getCalcSourceModel()).Qf(u,c))return r.row===u&&r.col===c?(e.rowCount=r.rowCount,e.colCount=r.colCount,new s.CalcReference(l,[e])):void 0;if(!(i=o.Kf(u,c))||33!==i.type)return i&&("@"===i.functionName||i instanceof s.ReferenceExpression)?(e.rowCount=1,e.colCount=1,new s.CalcReference(l,[e])):void 0;t=!0,e.rowCount=1,e.colCount=1}return a=new s.CalcReference(l,[e]),t&&(a.isSpillError=!0),a},t.prototype.getSources=function(e){var n,o,r,i,a;if(this.kj&&this.kj.parent&&this.kj.parent.sheets&&e instanceof t){for(n=this.kj.parent.sheets,o=!1,r=void 0,i=[],a=0;a<n.length;a++){if((r=n[a].yj())===this&&(o=!0),r===e){i.push(r);break}o&&i.push(r)}return i}},t.prototype.Ppb=function(e,t){var n,o=this.Hu,r=o&&o.arrayInfo;r&&(n=!1,r.forEach((function(i,a){if(i){var s=i.reference,l=i.key;w.call(s._identities[0],e,t)&&(delete o[l],r[a]=d,n=!0)}})),n&&(o.arrayInfo=[],r.forEach((function(e){e&&o.arrayInfo.push(e)}))))},t.prototype.referenceToArray=function(e,t,n,o,r,i,a,l){var c,f,v,b,C,w,x,A,M,S,T,N,I,R,k,E,j,_=this,O=1,F=1,P=[],H=_.kj,B=_.Hu,L=g[t],z=H._modelManager,V=e.getRangeCount();if(0===V)return P.isError=!0,P;if(B&&(C=B[A=e.getRangeCount()+"_"+e.getRow(0)+"_"+e.getColumn(0)+"_"+e.getRowCount(0)+"_"+e.getColumnCount(0)+"_"+t+"_"+n]))return _.zLb(C);for(M=this.getRowCount(),S=this.getColumnCount(),n=n===d||n,T=0;T<V;T++){if(n||(w=[],P.push(w)),0===(O=e.getRowCount(T)))return P.isError=!0,_.zLb(P);if(0===(F=e.getColumnCount(T)))return P.isError=!0,_.zLb(P);if(v=e.getRow(T),b=e.getColumn(T),v>=M||b>=S)return(P=n?[p]:[[p]]).rowCount=1,P.colCount=1,P.rangeCount=1,_.zLb(P);for(v+O>M&&(O=M-v),b+F>S&&(F=S-b),N=void 0,I=void 0,R=H.Ju,k=0;k<O;k++)for(c=v+k,n||(N=[],w.push(N)),B&&(B[c]||(B[c]={}),x=B[c]),E=0;E<F;E++){if(f=b+E,R&&H.Ku===c&&H.Lu===f)C=H.Mu,R=!1;else{if(B?(I=x[f])?C=I.v:(C=D(H,z,c,f,_.Wz),I=x[f]={v:C}):C=D(H,z,c,f,_.Wz),a&&(void 0,"@"===((j=H.getFormatter())instanceof y?j.formatString():j)?C=H.getText(c,f):C instanceof Date&&(C=u.Pa(C)),h(I)||(I=x[f]={v:C})),o&&s.Convert.vf(C))return(P=[C]).isError=!0,_.zLb(P);if(I&&I[L]!==d)C=I[L];else if(C=s.Convert.wf(C,t,!s.ExcelCompatibleCalcMode,i,l),I&&(I[L]=C),r&&I===C)return(P=[m]).isConvertError=!0,_.zLb(P)}s.Convert.j$a(C,i)||(n?P.push(C):N.push(C))}}return n||1!==V||(P=P[0]),P.rowCount=O,P.colCount=F,P.rangeCount=V,B&&!isNaN(V)&&!isNaN(O)&&!isNaN(F)&&V*O*F<2500&&B.arrayInfo.length<50&&(B[A]=P,B[A].rowCount=O,B[A].colCount=F,B[A].rangeCount=V,B.arrayInfo.push({reference:e,key:A})),_.zLb(P)},t.prototype.zLb=function(e){var t=[];return(t=t.concat(e)).rowCount=e.rowCount,t.colCount=e.colCount,t.rangeCount=e.rangeCount,t.isError=e.isError,t.isArray=e.isArray,t.isReference=e.isReference,t.isConvertError=e.isConvertError,t},t.prototype.getColumnCount=function(){var e=this.kj;return e.Js?0:e.getColumnCount(this.Wz)},t.prototype.getRowCount=function(){var e=this.kj;return e.Js?0:e.getRowCount(this.Wz)},t.prototype.isHiddenRow=function(e,t){var n=this.kj;return!(!(n.Nu&&n.Nu())&&t)&&0===n.getRowHeight(e)},t.prototype.getName=function(){var e=this.Wz;return e===o.SheetArea.colHeader?this.kj.name()+"CH":e===o.SheetArea.rowHeader?this.kj.name()+"RH":this.kj.name()},t.prototype.yLb=function(){var e=this,t=e.ZHb;return t||(t=e.ZHb=e.kj._modelManager.ZHb),t},t.prototype.setArray=function(e,t,n,o,r){return this.yLb().setArray(this,e,t,n,o,r)},t.prototype.updateItem=function(e,t,n){return this.yLb().updateItem(this,e,t,n)},t.prototype.GIb=function(e,t){this.yLb().GIb(e,t)},t.prototype.HIb=function(){this.yLb().HIb()},t.prototype.setValue=function(e){var t,n,r,i,a,s,l,u,c,h,p,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k=[];for(t=1;t<arguments.length;t++)k[t-1]=arguments[t];if(r=(n=this).kj,s=n.Wz,(e=e).row!==d)i=e.row,a=e.col,l=1;else{if(e.name)return;i=arguments[0],a=arguments[1],l=2}u=arguments[l],c=arguments[l+1],(h=n.Hu)&&((p=h[i])&&((g=p[a])&&(g.v=u,g.b!==d&&(g.b=d),g.d!==d&&(g.d=d),g.n!==d&&(g.n=d),g.s!==d&&(g.s=d),g.sn=d))),m=o.Ul.x0a(u),y=r._modelManager,v=!1,C=(b=r.tables)&&b.find(i,a),3===s&&C&&(w=C.showHeader()&&i===C.headerIndex(),x=C.showFooter()&&i===C.footerIndex(),w||x||(v=C.yq(i,a,m))),A=r.wq,3===s&&!v&&A&&A.Ou&&((M=A.getValue(i,a)).hasBinding&&(S=void 0,h?(S=(T=h.bindingRows=h.bindingRows||{})[i])||(S=T[i]=f({},r.getDataItem(i))):S=f({},r.getDataItem(i)),y.Cp(i,a,{Dp:S,Ep:M.value}),A.setValue(i,a,m,y.zTa)),v=M.hasBinding),v||(N="hyperlink",I="__proto__","string"==typeof m&&m[N]&&(R={url:m[N]},y.setHyperlink&&y.do("setHyperlink",i,a,R),delete m[I].hyperlink),y.do("setValue",i,a,m,s,!0,!0,arguments[l+2])),this.Iu?this.Iu.push({row:i,col:a}):this.kj.Wq(o.Events.CellChanged,{sheet:this.kj,sheetName:this.kj.name(),row:i,col:a,sheetArea:s,propertyName:"value",oldValue:c,newValue:u})},t.prototype.getCustomFunction=function(e){return this.kj?this.kj.Pu(e):p},t.prototype.getCustomName=function(e){e=x(e);var t=this.kj?this.kj.getCustomName(e):p;return t?t.getExpression():p},t.prototype.getSheet=function(){return this.kj},t.prototype.setFormula=function(e,t,n){},t.prototype.setArrayFormula=function(e,t,n,o,r){},t.prototype.setFormulaByName=function(e,t){},t.prototype.refresh=function(){this.kj.repaint()},t.prototype.toJSON=function(e,t,n,o,r){var i,a,s,l,u,c,f,p,d,g,m,y,v,C,w,x=t,A=e.data||{},M=!0,S=this.Cf();for(S.UIc=!0,c=0;c<=n;c++)if(i=A.dataTable||{},a=x[c]){for(M=!(l=i[c]),l=l||{},f=0;f<=o;f++)if((s=a[f])&&s.Lf){u=l[f]||{};try{d=j(p=S.unparse(this,s.Lf,c,f,!1,!0)),g=void 0,d&&(b(u.prefix)&&(u.prefix={}),p=(g=p).replace(/_xlpm\./g,"")),!s.Pf&&p&&0===p.indexOf("@")&&B(this.kj,p.slice(1,p.length),0,0)&&(p=p.slice(1,p.length),d&&(g=g.slice(1,g.length))),s.Pf?s.Pf.row===c&&s.Pf.col===f&&(u.arrayInfo=s.Pf,u.formula=p,d&&(u.prefix[d]=g)):(u.formula=p,d&&(u.prefix[d]=g)),M=!1,l[f]=u}catch(e){}}if(M){if(i!==A.dataTable)continue}else i[c]=l;A.dataTable=i}if(r){for(m=A.columnDataArray||[],y=0;y<r.length;y++)(v=r[y])&&v.Lf&&(C=this.Cf().unparse(this,v.Lf,0,y,!1,!0),(w=m[y]||{}).formula=C,m[y]=w);m.length>0&&(A.columnDataArray=m)}h(A)||(e.data=A),delete S.UIc},t}(s.CalcSource),t.SheetSource=R,R.prototype.getParserContext=function(e,t,n){return t=t||s._createCellIdentity(0,0),new I(this.kj,e,t,n)},k=function(e){function t(t){var n=e.call(this,p)||this;return n.createSourceModel=function(e){return new s.CalcSourceModel(e,this)},n.Qu=t,n}return E(t,e),t.prototype.getCustomFunction=function(e){return this.Qu?this.Qu.getCustomFunction(e):p},t.prototype.getCustomName=function(e){var t=this.Qu?this.Qu.getCustomName(e)||this.Qu.aJb(e):p;return t?t.getExpression():p},t}(s.CalcSource),t.SpreadSource=k,t.formulaToExpression=_,t.expressionToFormula=function(e,t,n,r,i,a){var l,u=e&&e instanceof o.Worksheet&&e,c=new s.Parser;return n=n===d?0:n,r=r===d?0:r,(l=new I(u,!!i,s._createCellIdentity(n,r))).YSa=a,c.unparse(l,t)},t.evaluateFormula=function(e,t,n,o,r){return n===d&&(n=0),o===d&&(o=0),O(e,_(e,t,n,o,r,!0),n,o)},t.evaluateExpression=O,t.rangeToExpression=F,t.rangeToFormula=function(e,t,n,o,r){var i=F(e,t,n,o),a=new I(p,!!r,s._createCellIdentity(t,n)),l=(new s.Parser).unparse(a,i);return a.no(),l},t.rangeToFormulaWithStructReference=function(e,t,n,o,r,i,a){var l=F(t,n,o,r,a),u=new I(e,!!i,s._createCellIdentity(n,o));return(new s.Parser).unparse(u,l)},t.formulaToRange=B,t.formulaToRanges=function(e,t,n,r,i){var l,u,c,f,p,g,m,y,v,b,C=[],w=[];if(!t)return C;for(l={},n=n||0,r=r||0,u=new s.Parser,c=a.qzb(u,t,e,n,r,d,i),f=0;f<c.length;f++)if((p=c[f].sheetRanges)&&!h(p))for(g=0;g<p.sheets.length;g++)for((w=l[m=p.sheets[g]])||(l[m]=w=[],C.push({sheetName:m,ranges:w})),y=p[m],v=0;v<y.length;v++)b=y[v],w.push(new o.Range(b.row,b.col,b.rowCount,b.colCount));return C},t.rangesToFormula=function(e,t,n,o,r){var i=new s.Parser,a=new I(p,!!r,s._createCellIdentity(t,n)),l=L(i,a,e,t,n,o);return a.no(),l},t.ALb=L,t.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15},t.goalSeek=function(e,t,n,o,r,a,s){var l,u,c,f,h=o.getValue(t,n),p=!1,d=.01,g=(C(h)?+h:0)-s,m=o.getValue(r,a),y=(C(m)?+m:0)-s;if(C(m)&&Math.abs(y)<.001)p=!0;else if(v(m))p=!1;else for(l=g+(0===g?d:d*g),c=0;!p&&c<100;c++)l=i.Common.o.Lma(l,13),e.setValue(t,n,l),m=o.getValue(r,a),u=(C(m)?+m:0)-s,C(m)&&Math.abs(u)<.001?p=!0:v(m)?l=(g+l)/2:g-l==0?l=g+(0===g?d:d*g):y-u==0?l=g+2*(l-g):(f=l-u*(g-l)/(y-u),g=l,y=u,l=f);return p||e.setValue(t,n,h),p}},"./dist/plugins/sheetsCalc/calc.ns.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BAND_INDEX_CONST=-2147483648,t.MAX_ROW_COUNT=1048576,t.MAX_COLUMN_COUNT=16384},"./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v;function b(e,t){var n,o,r,i;return t||(t=this),n=f(e.row,t.row),o=f(e.column,t.column),r=c(e.row+e.rowCount,t.row+t.rowCount),i=c(e.column+e.columnCount,t.column+t.columnCount),n>=r||o>=i?p:{row:n,column:o,rowCount:r-n,columnCount:i-o,intersectWith:b}}function C(e,t,n,o){return(!o||e<t)&&n}function w(e){return[e.row,e.col,e.rowCount,e.colCount].join(",")}function x(e,t,n,o){var r=e[t];r||(r=e[t]={}),r[n]=o}function A(e,t,n){var o=e[t];return!!o&&o[n]}function M(e,t,n,o,r,i,a,s,l,u,c,f){var h,p,d,g;return n>=0||!r?(h=o+(r?n:0),p=i+(a?n:0),d=c&&O(s,e,c),g=!c&&O(s,e,c),(d||g)&&(!f&&l+u<=n||f&&l<=n)&&(h-=r?u:0,p-=a?u:0),d=c&&O(s,t,c),g=!c&&O(s,t,c),(d||g)&&(!f&&l<=h||f&&(r&&n+o>=l||!r&&o>=l)?(h+=u,p+=u):(!f&&l<=p||f&&(a&&n+i>=l||!a&&i>=l))&&(p+=u)),h-=r?n:0,p-=a?n:0,f&&l+u<=n&&(h+=r?u:0,p+=a?u:0),{index:h,endIndex:p}):{index:o,endIndex:i}}function S(e,t,n,r,i,a,s,l,u,c,f,h){if(t&&!h){var p=u?i.row:i.column,g=u?i.rowRelative:i.columnRelative,m=void 0;if(u&&n>=0||!u&&r>=0||!g){if(c)m=M(e,t,u?n:r,p,g,-1,!1,a,s,l,u,f).index;else if(m=_(e,t,u?n:r,p,g,a,s,l,u,f),d(m))return o.Hh(m);m!==p&&(i=i.offset(u?m-p:0,u?0:m-p,!0))}}return i}function T(e,t,n,r,i,a,s,l,u,c,f,h){var p,g,m,y,v,b,C,w;if(t&&!h){if(3===(p=i.tf())||u&&2===p||!u&&1===p)return i;if(g=u?i.rowRelative:i.columnRelative,m=u?i.endRowRelative:i.endColumnRelative,y=u?i.row:i.column,v=u?i.endRow:i.endColumn,b=void 0,u&&n>=0||!u&&r>=0||!g||!m){if(c)b=M(e,t,u?n:r,y,g,v,m,a,s,l,u,f);else if(b=F(e,t,u?n:r,y,g,v,m,a,s,l,u,f),d(b))return o.Hh(b);C=b.index,w=b.endIndex,C===y&&w===v||(i=i.offset2(u?C-y:0,u?0:C-y,u?w-v:0,u?0:w-v,n,r))}}return i}function N(e,t,n,r,i,a,s,l,u,c,f,d){var g,m,y,v,b,C,w,x,A=N,M=r;if(r){if(1===r.type&&r.sf()||33===r.type)M=S(e,r.source||e,t,n,r,i,a,s,l,u,f,d);else if(1===r.type)M=T(e,r.source||e,t,n,r,i,a,s,l,u,f,d);else if(10===r.type)(g=A(e,t,n,r.value,i,a,s,l,u,h,f,d))!==r.value&&(M=o.Lh(g));else if(9===r.type)m=A(e,t,n,r.value,i,a,s,l,u,h,f,d),y=r.value2&&A(e,t,n,r.value2,i,a,s,l,u,h,f,d),m===r.value&&y===r.value2||(M=o.Kh(r.operatorType,m,y));else if(7===r.type){for(v=p,b=void 0,C=void 0,x=(w=r).arguments.length,C=0;C<x;C++)if((g=A(e,t,n,b=w.arguments[C],i,a,s,l,u,h,f,d))!==b){(v=[])[C]=g;break}if(v){for(C=0;C<x;C++)b=w.arguments[C],v[C]!==h&&v[C]!==p||(v[C]=A(e,t,n,b,i,a,s,l,u,h,f,d));M=o.Jh(w,v)}}else f||l||13!==r.type||(M=function(e,t,n,o,r,i,a,s,l){if(t){if(r)return r.offsetWhenInsertRemoveColumn(a,s,l)}return r}(0,e,0,0,r,0,a,s,u));return M}}function I(e,t,n,o,r,i,a,s,l,u){var c=e.getSheet(),f=c.uja&&(c.parent||c).tja(),h=c._modelManager&&c._modelManager.dUa();R(f,(function(r,i,a,s){return t.call(this,r,a,s,i,e,n,o,l,u)}),l,h)}function R(e,t,n,o){var r,i,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A;if(e)for(u=0;u<e.length;u++){for(c=!0,f=!0,h=a.maxRowCount-1,p=a.maxColumnCount-1,g=0,m=(d=(r=e[u].validator).n5).length;g<m&&(v=(y=d[g]).rowCount,b=y.colCount,s=y.row,l=y.col,-1!==v&&(f=!1,h=h>s?s:h),-1!==b&&(c=!1,p=p>l?l:p),c||f);g++);if(!(n&&f||!n&&c)&&(C=e[u].sheet.yj(),(w=(i=r.condition()).getExpressions())&&w.length>0)){for(x=0;x<w.length;x++)A=w[x],w[x]=t(C,A,h,p);i.setExpressions(w,o)}}}function k(e){var t=[],n=e.parent;return(n&&n.sheets||[e]).forEach((function(e){var n=e.conditionalFormats,o=n&&n.getRules();o&&o.length&&o.forEach((function(n){n.xyb&&t.push({rule:n,sheet:e})}))})),t}function E(e,t,n,o,r,i){var a=e.getSheet();D(k(a),(function(a,s,l,u){return t.call(this,a,l,u,s,e,n,o,r,i)}),a._modelManager&&a._modelManager.dUa(),r,i)}function D(e,t,n,o,r){var i,a,s,l,u,c,f,h,p,d,g,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j;if(e)for(i=0,a=e.length;i<a;i++){if(l=(s=e[i].rule).ranges(),c=(u=m(l)).r,f=u.c,p=(h=e[i].sheet).yj(),d=s.condition(),(g=h.tables)&&l&&1===l.length&&(v=(y=l[0]).row,b=y.col,C=y.rowCount,w=y.colCount,x=void 0,r&&o?x=g.KFc(v,b,C,w):h.dJb&&h.zFc&&(x=[h.zFc]),x&&x.length)){for(A=!1,M=0,S=x.length;M<S;M++)if(N=(T=x[M]).row,I=T.col,R=T.rowCount,k=T.colCount,v===N&&C===R&&b>=I&&b+w<=I+k){A=!0;break}if(A)continue}if(d||(s.initCondition(),d=s.condition()),(E=d&&d.getExpressions())&&E.length>0){for(D=0;D<E.length;D++)j=E[D],E[D]=t(p,j,c,f);d.setExpressions(E,n)}}}function j(e,t,n){var o=e.getSheet();D(k(o),(function(e,o,r,i){return Z.call(this,e,r,i,o,t,n)}),o._modelManager.dUa())}function _(e,t,n,o,r,i,a,s,l,u){var c,f,h,p,d;if(n>=0||!r){if(c=o+(r?n:0),f=l&&O(i,e,l),h=!l&&O(i,e,l),(f||h)&&a<=n&&(c+=r?s:0),f=l&&O(i,t,l),h=!l&&O(i,t,l),f||h)if(p=n+o,d=n+s+o,!u&&a+s<=c||u&&p>=a+s)c-=s;else if(!u&&a<=c||u&&p>=a&&a<=d&&d<=a+s)return g;return c-=r?n:0,u&&a<=n&&(c-=r?s:0),c}return o}function O(e,t,n){var o=n?{2:!0}:{1:!0};return e===t||e.kj===t.kj&&(3===e.Wz&&o[t.Wz]||o[e.Wz]&&3===t.Wz)}function F(e,t,n,o,r,i,a,s,l,u,c,f){var h,p,d,m,y,v,b;if(n>=0||!r){if(h=o+(r?n:0),p=i+(a?n:0),d=l+u-1,m=c&&O(s,e,c),y=!c&&O(s,e,c),(m||y)&&l<=n&&(h+=r?u:0,p+=a?u:0),m=c&&O(s,t,c),y=!c&&O(s,t,c),m||y)if(v=n+o,b=n+i,!f&&d<h||f&&d<v)h-=u,p-=u;else{if(!f&&l<=h&&d>=p||f&&l<=v&&d>=b)return g;!f&&l>p||f&&l>b||(!f&&d<=p||f&&d<=b?(h=!f&&l>=h||f&&l>=v?h:l,p-=u):p=l-1)}return h-=r?n:0,p-=a?n:0,f&&l<=n&&(h-=r?u:0,p-=r?u:0),{index:h,endIndex:p}}return{index:o,endIndex:i}}function P(e,t,n){var r,i,a,s,l,c,f,d,g,m,y,v,b,C,w,x=P,A=t;if(t)if(t.source)if(s=t.source,(l=t.endSource)&&s!==l){if(!(c=s.kj&&s.kj.parent))return o.Ih;l===n?(f=n.VDc,A.endSource=c.getSheet(f-1).yj()):s===n&&(d=n.VDc,A.source=c.getSheet(d).yj()),delete n.VDc,A.source===A.endSource&&delete A.endSource}else(e!==n&&s===n||e===n&&s!==n)&&(A=o.Ih);else if(10===t.type)(r=x(e,t.value,n))!==t.value&&(A=o.Lh(r));else if(9===t.type)g=x(e,t.value,n),m=t.value2&&x(e,t.value2,n),g===t.value&&m===t.value2||(A=o.Kh(t.operatorType,g,m));else if(7===t.type){for(y=p,v=t.arguments.length,a=0;a<v;a++)if((r=x(e,i=t.arguments[a],n))!==i){(y=[])[a]=r;break}if(y){for(a=0;a<v;a++)i=t.arguments[a],y[a]!==h&&y[a]!==p||(y[a]=x(e,i,n));A=o.Jh(t,y)}}else 8===t.type&&(b=e||n,C=u(t.value),(w=b.getCustomName(C))&&w.source?s=w.source:(w=(b._service.getGlobalSourceModel()||b.getCalcSourceModel()).getSource().getCustomName(C))&&w.source&&(s=w.source),s&&(e!==n&&s===n||e===n&&s!==n)&&(A=o.Ih));return A}function H(e,t,n,o,r){return P(e,o,r)}function B(e,t,n,r,i,a,s,l){return s?o.BLb(l,e,t,n,r,i,a):o.rf(e,t,n,r,i,a)}function L(e,t){if(!(t=e.getIntersect(t,0,0)))return p;var n=e.row,o=e.col,r=e.rowCount,i=e.colCount;return e.rowCount===t.rowCount&&e.colCount===t.colCount||(e.rowCount===t.rowCount?(e.col===t.col&&(o=e.col+t.colCount),i=e.colCount-t.colCount):e.colCount===t.colCount&&(e.row===t.row&&(n=e.row+t.rowCount),r=e.rowCount-t.rowCount)),s.kf(n,o,r,i)}function z(e,t,n,o){var r,i=L(e,t);return i?(r=i.union(n),o?(r.col=e.col,r.colCount=e.colCount):(r.row=e.row,r.rowCount=e.rowCount)):r=n,{startRow:r.row,endRow:r.row+r.rowCount-1,startColumn:r.col,endColumn:r.col+r.colCount-1}}function V(e,t,n,o,r){var i,a=L(e,t),s=e.getIntersect(t,0,0);return s?(s.row+=o,s.col+=r,{startRow:(i=a?a.union(s):n).row,endRow:i.row+i.rowCount-1,startColumn:i.col,endColumn:i.col+i.colCount-1}):p}function G(e,t){var n=e.row,o=e.col,r=e.rowCount,i=e.colCount,a=t.row,s=t.col,l=t.rowCount,u=t.colCount;return 1===r&&1!==i?s<o&&o<=s+u-1||s<=o+i-1&&o+i-1<s+u-1:1!==i||1===r||a<n&&n<=a+l-1||a<=n+r-1&&n+r-1<a+l-1}function W(e,t,n,o,r,i){var a,l,u,c,f=function(e,t,n){var o=e.getRange(t,n);return s.kf(o.row,o.col,o.rowCount,o.colCount)}(o,r,i),h=f.row,p=f.row+f.rowCount-1,d=f.col,g=f.col+f.colCount-1,m=e.Vj,y=m+e.Xj-1,v=e.Wj,b=v+e.Yj-1,C=e.Tj,w=e.Uj,x=s.kf(m,v,e.Xj,e.Yj),A=s.kf(C,w,e.Xj,e.Yj),M=f.getIntersect(A,0,0);if(function(e,t,n,o,r){var i;return!(!t||!e||(i=t.getIntersect(e,0,0),(i||!t.getIntersect(n,0,0))&&(!i||i.rowCount!==t.rowCount||0===r)&&(!i||i.colCount!==t.colCount||0===o)))}(x,f,A,t,n))if(u=void 0,c=void 0,l=0!==t)if(c=p>=m&&p<=y,(u=h>=m&&h<=y)&&c)h+=t,p+=t;else if(u&&!c)if(t<=0)h+=t;else if(m+t>p);else{if(!(y+t<p))return V(f,x,A,t,n);if(m===h)return z(f,x,A,l);h+=t}else if(!u&&c)if(t>=0)p+=t;else if(y+t<h);else{if(!(C>h))return V(f,x,A,t,n);if(y===p)return z(f,x,A,l);p+=t}else M&&!M.equals(A)&&G(f,A)&&(h=(a=L(f,M)).row,p=a.row+a.rowCount-1,d=a.col,g=a.col+a.colCount-1);else if(c=g>=v&&g<=b,(u=d>=v&&d<=b)&&c)d+=n,g+=n;else if(u&&!c)if(n<0)d+=n;else if(v+n>g);else{if(!(b+n<g))return V(f,x,A,t,n);if(v===d)return z(f,x,A,l);d+=n}else if(!u&&c)if(n>0)g+=n;else if(b+n<d);else{if(!(w>d))return V(f,x,A,t,n);if(b===g)return z(f,x,A,l);g+=n}else M&&!M.equals(A)&&G(f,A)&&(h=(a=L(f,M)).row,p=a.row+a.rowCount-1,d=a.col,g=a.col+a.colCount-1);return{startRow:h,endRow:p,startColumn:d,endColumn:g}}function U(e,t,n,r,a,s){var l,u,c,f,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,U,Z,q,J,Q,Y,K,$=!!r.source,X=$?r.source:e,ee=r.tf(),te=a.Nj(),ne=a.Oj(),oe=s&&s.isDataValidator,re=function(e,t){return e.Qj===e.Rj&&t!==e.Qj}(a,e),ie=!1;if(0===ee)if(l=r.rowRelative,u=r.columnRelative,c=r.endRowRelative,f=r.endColumnRelative,t>=0||!l||!c||n>=0||!u||!f){if(d=r.row+(l?t:0),g=r.endRow+(c?t:0),m=r.column+(u?n:0),v=g-d+1,b=(y=r.endColumn+(f?n:0))-m+1,!oe&&re){if(a.Sj(a.Rj,d,m,v,b))return r.offset(te,ne,!0);if(a.Pj(X,d,m,v,b))return o.Ih;if(X!==a.Rj||X!==a.Qj||0!==te&&0!==ne)return r;ie=!0}if(s&&s.isNameID||e===a.Rj&&(e===a.Qj?A=a.Pj(a.Qj,t,n,1,1):(M=t,S=n,s&&s.crossSheetMoved&&(M-=te,S-=ne),A=a.Sj(a.Rj,M,S,1,1))),(ie||e===X&&e===a.Rj&&e===a.Qj)&&(T=t,N=n,A&&(T-=te,N-=ne),0===te||0===ne)){if(!(I=W(a,te,ne,r,T,N)))return o.Ih;if(0===ne&&te&&I.endColumn>=y&&I.startColumn<=m||0===te&&ne&&I.endRow>=g&&I.startRow<=d)return R=I.startRow,k=I.startColumn,E=I.endRow,D=I.endColumn,R===d&&E===g&&k===m&&D===y?r:(l&&(R-=t),c&&(E-=t),u&&(k-=n),f&&(D-=n),o.uf(r.source,p,R,k,E,D,l,u,c,f,t,n))}if(A&&(j=a.Tj-a.Vj,_=a.Uj-a.Wj,v+=(l?-j:0)+(c?j:0),b+=(u?-_:0)+(f?_:0)),X===a.Qj&&a.Pj(X,d,m,v,b)&&!b&&(!l&&!u&&!c&&!f||!A))return o.Ih;if(x=($&&X===a.Rj||!$&&e===a.Rj)&&(!A&&a.Sj(a.Rj,d,m,v,b)||A&&a.Pj(a.Qj,l?d:d+te,u?m:m+ne,v,b)),A&&(d-=l?te:0,g-=c?te:0,m-=u?ne:0,y-=f?ne:0),O=!1,x)d+=C=te,g+=C,m+=w=ne,y+=w;else if(a.Pj(X,d,m,v,b)){if(!(F=a.intersectWith(X,d,m,v,b))||F.rowCount!==v&&F.colCount!==b)return o.Ih;d=F.row+te,m=F.col+ne,g=d+F.rowCount,y=m+F.colCount,O=!0}if(d-=l?t:0,g-=c?t:0,m-=u?n:0,y-=f?n:0,a.Rj===a.Qj?X=$?r.source:h:(X=r.source,x&&A&&$?X=a.Qj:x&&A||(x?X=a.Qj:A&&!$&&(X=a.Rj))),d!==r.row||m!==r.column||g!==r.endRow||y!==r.endColumn||O||X!==r.source)return o.uf(X,p,d,m,g,y,l,u,c,f,t,n)}else if(!(t>=0)&&l&&c||-1!==n){if(-1===t&&(n>=0||!u||!f)){if((m=r.column+(u?n:0))>(y=r.endColumn+(f?n:0)))return o.Ih;if(a.Pj(e,t,n,1,1)&&(m-=u?ne:0,y-=f?ne:0),b=y-m+1,a.Sj(X,-1,m,-1,b))m+=w=ne,y+=w;else if(a.Pj(X,-1,m,-1,b))return o.Ih;if(y-=f?n:0,(m-=u?n:0)!==r.column||y!==r.endColumn)return o.uf(r.source,p,r.row,m,r.endRow,y,r.rowRelative,u,r.endRowRelative,f,t,n)}}else{if((d=r.row+(l?t:0))>(g=r.endRow+(c?t:0)))return o.Ih;if(a.Pj(e,t,n,1,1)&&(d-=l?te:0,g-=c?te:0),v=g-d+1,a.Sj(X,d,-1,v,-1))d+=C=te,g+=C;else if(a.Pj(X,d,-1,v,-1))return o.Ih;if(g-=c?t:0,(d-=l?t:0)!==r.row||g!==r.endRow)return o.uf(r.source,p,d,r.column,g,r.endColumn,l,r.columnRelative,c,r.endColumnRelative,t,n)}else if(1===ee){if(l=r.rowRelative,c=r.endRowRelative,t>=0||!l||!c){if((d=r.row+(l?t:0))>(g=r.endRow+(c?t:0)))return o.Ih;if(A=e===a.Rj&&e===a.Qj&&a.Pj(a.Qj,t,n,1,1),X===a.Rj&&X===a.Qj&&0===a.Wj&&0===a.Uj&&a.Yj===X.getColumnCount()){if(P=a.Vj,H=a.Tj,A&&(d-=te,g-=te),L=P+(B=a.Xj),V=g>=P&&L>g,(z=d>=P&&L>d)&&V)return A?r:r.offset(te,ne,!0);if(G=H+B,z&&H<=g?(d+=te,G>g&&g>=H&&(g=G-1,d=L)):V&&G>=d&&(g+=te,H<=d&&m<G&&(d=H,g=P-1)),g-=c?t:0,(d-=l?t:0)!==r.row||g!==r.endRow)return o.uf(r.source,r.endSource,d,i.BAND_INDEX_CONST,g,i.BAND_INDEX_CONST,l,u,c,f,t,n)}if(A)return r.offset(-te,ne,!0)}}else if(2===ee){if(u=r.columnRelative,f=r.endColumnRelative,(m=r.column+(u?n:0))>(y=r.endColumn+(f?n:0)))return o.Ih;if(A=e===a.Rj&&e===a.Qj&&a.Pj(a.Qj,t,n,1,1),X===a.Rj&&X===a.Qj&&0===a.Vj&&0===a.Tj&&a.Xj===X.getRowCount()){if(U=a.Wj,Z=a.Uj,A&&(m-=ne,y-=ne),J=U+(q=a.Yj),Y=y>=U&&J>y,(Q=m>=U&&J>m)&&Y)return A?r:r.offset(te,ne,!0);if(K=Z+q,Q&&Z<=y?(m+=ne,K>y&&y>=Z&&(y=K-1,m=J)):Y&&K>=m&&(y+=ne,Z<=m&&m<K&&(m=Z,y=U-1)),y-=f?n:0,(m-=u?n:0)!==r.column||y!==r.endColumn)return o.uf(r.source,r.endSource,i.BAND_INDEX_CONST,m,i.BAND_INDEX_CONST,y,l,u,c,f,t,n)}if(A)return r.offset(te,-ne,!0)}return r}function Z(e,t,n,r,i,a,s){var l,u,c,f,d,g,m,y=Z,v=r;if(1===r.type&&r.sf()||33===r.type)v=a?function(e,t,n,r,i,a){var s,l,u,c,f,h,d=!!r.source,g=r.source||e,m=r.rowRelative,y=r.columnRelative,v=i.Nj(),b=i.Oj(),C=33===r.type,w=C&&r.contextSource;if((t>=0||!m)&&(n>=0||!y)){if(s=r.row+(m?t:0),l=r.column+(y?n:0),a&&a.isNameID||e===i.Rj&&(e===i.Qj?c=i.Pj(i.Qj,t,n,1,1):(f=t,h=n,a&&a.crossSheetMoved&&(f-=v,h-=b),c=i.Sj(i.Rj,f,h,1,1))),g===i.Qj&&i.Pj(g,s,l,1,1)&&!i.Sj(g,s,l,1,1)&&(!m&&!y||!c))return o.Ih;if(u=(d&&g===i.Rj||!d&&e===i.Rj)&&(!c&&i.Sj(i.Rj,s,l,1,1)||c&&i.Pj(i.Qj,m?s:s+v,y?l:l+b,1,1)),c&&(s-=m?v:0,l-=y?b:0),u&&(s+=v,l+=b),s-=m?t:0,l-=y?n:0,g=r.source,i.Rj!==i.Qj&&(u&&c?d&&(g=i.Qj):u?g=i.Qj:c&&!d&&(g=i.Rj)),s!==r.row||l!==r.column||g!==r.source)return B(g,p,s,l,m,y,C,w)}else if((t>=0||!m)&&-1===n){if(s=r.row+(m?t:0),i.Pj(e,t,n,1,1)&&(s-=m?v:0),i.Sj(g,s,-1,1,-1))s+=v;else if(i.Pj(g,s,-1,1,-1))return o.Ih;if((s-=m?t:0)!==r.row)return B(r.source,p,s,r.column,m,r.columnRelative,C,w)}else if(-1===t&&n>=0&&!y){if(l=r.column+(y?n:0),i.Pj(e,t,n,1,1)&&(l-=y?b:0),i.Sj(g,s,l,1,1))l+=b;else if(i.Pj(g,s,l,1,1))return o.Ih;if(l-=y?n:0,s!==r.row||l!==r.column)return B(r.source,r.endSource,r.row,l,r.rowRelative,y,C,w)}return r}(e,t,n,r,i,s):function(e,t,n,o,r){var i,a,s=o.source||e,l=o.rowRelative,u=o.columnRelative,c=r.Nj(),f=r.Oj(),h=33===o.type,d=h&&o.contextSource;if((t>=0||!l)&&(n>=0||!u)){if(i=o.row+(l?t:0),a=o.column+(u?n:0),r.Pj(e,t,n,1,1)?(i-=l?c:0,a-=u?f:0):r.Sj(e,i,a,1,1)&&(i+=l?c:0,a+=u?f:0),r.Sj(s,i,a,1,1)?(i+=c,a+=f):r.Pj(s,i,a,1,1)&&(i-=c,a-=f),a-=u?n:0,(i-=l?t:0)!==o.row||a!==o.column)return B(o.source,p,i,a,l,u,h,d)}else if((t>=0||!l)&&-1===n){if(i=o.row+(l?t:0),r.Pj(e,t,-1,1,-1)?i-=l?c:0:r.Sj(e,i,-1,1,-1)&&(i+=l?c:0),r.Sj(s,i,-1,1,-1)?i+=c:r.Pj(s,i,-1,1,-1)&&(i-=c),(i-=l?t:0)!==o.row||a!==o.column)return B(o.source,p,i,o.column,l,o.columnRelative,h,d)}else if(-1===t&&n>=0&&!u&&(a=o.column+0,r.Pj(e,-1,n,-1,1)?a-=0:r.Sj(e,-1,a,-1,1)&&(a+=0),r.Sj(s,-1,a,-1,1)?a+=f:r.Pj(s,-1,a,-1,1)&&(a-=f),a-=0,i!==o.row||a!==o.column))return B(o.source,p,o.row,a,o.rowRelative,u,h,d);return o}(e,t,n,r,i);else if(1===r.type)v=a?U(e,t,n,r,i,s):J(e,t,n,r,i);else if(10===r.type)(l=y(e,t,n,r.value,i,a,s))!==r.value&&(v=o.Lh(l));else if(9===r.type)u=y(e,t,n,r.value,i,a,s),c=r.value2&&y(e,t,n,r.value2,i,a,s),u===r.value&&c===r.value2||(v=o.Kh(r.operatorType,u,c));else if(7===r.type){for(f=p,d=void 0,g=void 0,m=r.arguments.length,g=0;g<m;g++)if((l=y(e,t,n,d=r.arguments[g],i,a,s))!==d){(f=[])[g]=l;break}if(f){for(g=0;g<m;g++)d=r.arguments[g],f[g]!==h&&f[g]!==p||(f[g]=y(e,t,n,d,i,a,s));v=o.Jh(r,f)}}return v}function q(e,t,n){var o,r,i,a,s,l,u,c,f,h,p,d=t.Rj.getSheet()._modelManager.dUa();for(o=0;o<e.length;o++)if(i=(r=e[o].validator).n5,s=(a=m(i)).r,l=a.c,u=e[o].sheet.yj(),(f=(c=r.condition()).getExpressions())&&f.length>0){for(h=0;h<f.length;h++)p=f[h],f[h]=Z(u,s,l,p,t,n,{isDataValidator:!0});c.setExpressions(f,d)}}function J(e,t,n,r,a){var s,l,u,c,f,h,d,g,m,y,v,b,C=r.source||e,w=r.tf(),x=a.Nj(),A=a.Oj();if(0===w){if(d=r.rowRelative,g=r.columnRelative,m=r.endRowRelative,y=r.endColumnRelative,!(t>=0)&&d&&m||!(n>=0)&&g&&y)if(!(t>=0)&&d&&m||-1!==n){if(-1===t&&(n>=0||!g||!y)){if((u=r.column+(g?n:0))<(c=r.endColumn+(y?n:0)))return o.Ih;if(a.Pj(e,-1,n,-1,1)?(u-=g?A:0,c-=y?A:0):a.Sj(e,-1,n,-1,1)&&(u+=g?A:0,c+=y?A:0),h=c-u,a.Sj(C,-1,u,-1,h)?(u+=b=A,c+=b):a.Pj(C,-1,u,-1,h)&&(u-=b=A,c-=b),c-=y?n:0,(u-=g?n:0)!==r.column||c!==r.endColumn)return o.uf(r.source,p,u,r.endRow,c,r.rowRelative,g,r.endRowRelative,y,t,n)}}else{if((s=r.row+(d?t:0))<(l=r.endRow+(m?t:0)))return o.Ih;if(a.Pj(e,t,-1,1,-1)?(s-=d?x:0,l-=d?x:0):a.Sj(e,t,-1,1,-1)&&(s+=d?x:0,l+=d?x:0),f=l-s,a.Sj(C,s,-1,f,-1)?(s+=v=x,l+=v):a.Pj(C,s,-1,f,-1)&&(s-=v=x,l-=v),l-=m?t:0,(s-=d?t:0)!==r.row||l!==r.endRow)return o.uf(r.source,p,s,r.column,l,r.endColumn,d,r.columnRelative,m,r.endColumnRelative,t,n)}else if(s=r.row+(d?t:0),l=r.endRow+(m?t:0),u=r.column+(g?n:0),f=l-s,h=(c=r.endColumn+(y?n:0))-u,a.Pj(e,t,n,1,1)?(s-=d?x:0,l-=m?x:0,u-=g?A:0,c-=y?A:0):a.Sj(e,s,u,f,h)&&(s+=d?x:0,l+=m?x:0,u+=g?A:0,c+=y?A:0),a.Sj(C,s,u,f,h)?(s+=v=x,l+=v,u+=b=A,c+=b):a.Pj(C,s,u,f,h)&&(s-=v=x,l-=v,u-=b=A,c-=b),l-=m?t:0,u-=g?n:0,c-=y?n:0,(s-=d?t:0)!==r.row||u!==r.column||l!==r.endRow||c!==r.endColumn)return o.uf(r.source,p,s,u,l,c,d,g,m,y,t,n)}else if(1===w){if(d=r.rowRelative,m=r.endRowRelative,t>=0||!d||!m){if((s=r.row+(d?t:0))<(l=r.endRow+(m?t:0)))return o.Ih;if(a.Pj(e,t,-1,1,-1)?(s-=d?x:0,l-=m?x:0):a.Sj(e,t,-1,1,-1)&&(s+=d?x:0,l+=m?x:0),f=l-s,a.Sj(C,s,-1,f,-1)?(s+=v=x,l+=v):a.Pj(C,s,-1,f,-1)&&(s-=v=x,l-=v),l-=m?t:0,(s-=d?t:0)!==r.row||l!==r.endRow)return o.uf(r.source,p,s,i.BAND_INDEX_CONST,l,i.BAND_INDEX_CONST,d,!1,m,!1,t,n)}}else if(2===w){if(g=r.columnRelative,y=r.endColumnRelative,(u=r.column+(g?n:0))>(c=r.endColumn+(y?n:0)))return o.Ih;if(a.Pj(e,-1,n,-1,1)?(u-=g?A:0,c-=y?A:0):a.Sj(e,-1,n,-1,1)&&(u+=g?A:0,c+=y?A:0),h=c-u,a.Sj(C,-1,u,-1,h)?(u+=b=A,c+=b):a.Pj(C,-1,u,-1,h)&&(u-=b=A,c-=b),c-=y?n:0,(u-=g?n:0)!==r.column||c!==r.endColumn)return o.uf(r.source,p,i.BAND_INDEX_CONST,u,i.BAND_INDEX_CONST,c,!1,g,!1,y,t,n)}return r}function Q(e,t,n,o,r,i){e._g(t,n,o,r,!0,!1,i)}function Y(e,t,n){var r,i,a,s,l,u,c,f=Y,d=t;if(8===t.type){if(t.value===n&&(!t.source||t.source===e.getSource()))return o.Hh(g,t.source)}else if(10===t.type)(r=f(e,t.value,n))!==t.value&&(d=o.Lh(r));else if(9===t.type)s=f(e,t.value,n),l=t.value2&&f(e,t.value2,n),s===t.value&&l===t.value2||(d=o.Kh(t.operatorType,s,l));else if(7===t.type){for(u=p,c=t.arguments.length,a=0;a<c;a++)if((r=f(e,i=t.arguments[a],n))!==i){(u=[])[a]=r;break}if(u){for(a=0;a<c;a++)i=t.arguments[a],u[a]!==h&&u[a]!==p||(u[a]=f(e,i,n));d=o.Jh(t,u)}}return d}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-calc"),r=n("@grapecity/js-sheets-common"),i=n("./dist/plugins/sheetsCalc/calc.ns.js"),a=n("./dist/plugins/sheetsCalc/parser-sheets.js"),s=n("Core"),l=r.Common.u,u=l.Nb,c=Math.min,f=Math.max,h=void 0,p=null,d=o.Convert.vf,g=o.Errors.Reference,m=s.util.l_a,y=function(){function e(e,t,n,o,r,i,a,s){var l=this;l.Rj=e,l.Vj=t,l.Wj=n,l.Qj=o,l.Tj=r,l.Uj=i,l.Xj=a,l.Yj=s}return e.prototype.Nj=function(){return this.Tj-this.Vj},e.prototype.Oj=function(){return this.Uj-this.Wj},e.prototype.Sj=function(e,t,n,o,r){var i=this;return i.Rj===e&&(-1===i.Vj||i.Vj<=t&&t+o<=i.Vj+i.Xj)&&(-1===i.Wj||i.Wj<=n&&n+r<=i.Wj+i.Yj)},e.prototype.Pj=function(e,t,n,o,r){var i=this;return i.Qj===e&&(-1===i.Tj||i.Tj<=t&&t+o<=i.Tj+i.Xj)&&(-1===i.Uj||i.Uj<=n&&n+r<=i.Uj+i.Yj)},e.prototype.intersectWith=function(e,t,n,o,r){var i,a=this;return a.Qj!==e?p:(i=a.Zj(e,t,n,o,r),a.Zj(e,a.Vj,a.Wj,o,r).intersectWith(i))},e.prototype.Zj=function(e,t,n,o,r){return{row:-1===t?0:t,column:-1===n?0:n,rowCount:-1===t||-1===o?e.rowCount:o,columnCount:-1===n||-1===r?e.colCount:r,intersectWith:b}},e}(),t.MoveSwapInfo=y,v=function(){function e(){}return e.zj=function(t,n,r,a,s,l,u,f,h,p,d){var m,y,v,b,C,w,x=r,A=e,M=this.zj;if(!r)return x;if(10===(v=r.type))x=o.Lh(M.call(A,t,n,r.value,a,s,l,u,f,h,p,d));else if(1===v&&r.sf()||33===v){if(m=c((r.source||n).getRowCount(),i.MAX_ROW_COUNT),y=c((r.source||n).getColumnCount(),i.MAX_COLUMN_COUNT),r.rowRelative&&(r.row+a<0||r.row+a>=m)||r.columnRelative&&(r.column+s<0||r.column+s>=y))return o.Hh(g,r.source);x=r.offset(0,0,!1)}else if(1===v){if(m=c((r.source||n).getRowCount(),i.MAX_ROW_COUNT),y=c((r.source||n).getColumnCount(),i.MAX_COLUMN_COUNT),(b=r).rowRelative&&!r.isFullColumn&&(b.row+a<0||b.row+a>m)||b.columnRelative&&!r.isFullRow&&(b.column+s<0||b.column+s>y)||b.endRowRelative&&!r.isFullColumn&&(b.endRow+a<0||b.endRow+a>m)||b.endColumnRelative&&!r.isFullRow&&(b.endColumn+s<0||b.endColumn+s>y))return o.Hh(g,r.source,r.endSource);x=r.offset(0,0,!1,a,s)}else if(9===r.type)x=o.Kh(r.operatorType,M.call(A,t,n,r.value,a,s,l,u,f,h,p,d),r.value2&&M.call(A,t,n,r.value2,a,s,l,u,f,h,p,d));else if(7===v){if(C=[],r.arguments&&r.arguments.length>0)for(w=0;w<r.arguments.length;w++)C[w]=M.call(A,t,n,r.arguments[w],a,s,l,u,f,h,p,d);x=o.Jh(r,C)}else 13===v&&(x=r.offsetWhenCopy(t,n,a,s,l,u,f,h,p,d));return x},e.copyFormula=function(t,n,r,i,a,s,l,u,f){var p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L=t,z=i,V=t.getSource(),G=i.getSource(),W=e;if(L&&z){for(p=G&&G.getSheet()._modelManager.dUa(),d=n,g=r,m=a,y=s,v=l,b=u,n<0&&(d=0,v=c(t.rC(),i.rC())),r<0&&(g=0,b=c(t.cC(),i.cC())),a<0&&(m=0),s<0&&(y=0),C=new o.CalcSourceModel(t.Cf(),V),w=0;w<v;w++)for(x=0;x<b;x++)L.Uf(C,w+d,x+g,w,x);for(A={},M=i.Cf(),w=0;w<v;w++)if(!f||!G.isHiddenRow(w+m,!0))for(S=w+m,x=0;x<b;x++)if(T=x+y,N=C.Kf(w,x)){if(N===A)continue;if(N=W.zj(V,G,C.Kf(w,x),S,T,a-n,s-r,a,s,v,b),I=C.Qf(w,x),G)if(I&&!I.isDynamicArray){for(R=I.rowCount,k=I.colCount,(E=d-I.row)>0&&(R-=E),(D=v-w)<R&&(R=D),(j=g-I.col)>0&&(k-=j),(_=b-x)<k&&(k=_),O=0;O<R;O++)for(F=0;F<k;F++)C.Rf(w+O,x+F,A);i.setArrayFormula(S,T,R,k,M.unparse(G,N,S,T),h,p)}else P=N?M.unparse(G,N,S,T):h,G.setFormula(S,T,P),(H=C.Mf(w,x))&&(B=new o.EvaluateContext(G,o._createCellIdentity(S,T),!1),H=(H=o.Mh(B,N,!1,0,0))===N?h:H),z.ig(S,T,N,H,I,p);else z.Rf(w+m,x+y,N),z.Xf(w+m,x+y,I)}else z&&z.Kf(S,T)&&z.Sf(S,T,p)}},e.moveFormula=function(e,t,n,o,r,i,a,l){var u,f,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k=e.Bj(),E=o.Bj(),D=k.Cf();if(k&&E){for(u=k.dUa(),f=E.dUa(),d=D.ih(),t<0&&(t=0,a=c(e.getRowCount(),o.getRowCount())),r<0&&(r=0),n<0&&(n=0,l=c(e.getColumnCount(),o.getColumnCount())),i<0&&(i=0),g=!(e===o&&e.name()===o.name()),k.Sg(t,n,a,l),Q(k,t,n,a,l),E.Sg(r,i,a,l),Q(E,r,i,a,l),m=[],y=0;y<a;y++)for(v=0;v<l;v++)b=k.Kf(y+t,v+n),C=k.Qf(y+t,v+n),w=k.Mf(y+t,v+n),b?(m.push({Lf:b,Pf:C,Nf:w}),k.Sf(y+t,v+n,u)):m.push(p);for(A=g?{}:null,y=0;y<a;y++)for(M=y+r,v=0;v<l;v++)T=v+i,(S=m[y*l+v])?(b=S.Lf,C=S.Pf,D&&C&&!C.isDynamicArray&&C.row===t+y&&C.col===n+v&&(x=s.kf(M,T,C.rowCount,C.colCount)),N=C&&!C.isDynamicArray?x:h,w=S.Nf,E.FTa(f,M,T),E.Rf(M,T,b),E.Xf(M,T,N),E.Wf(M,T,w),g&&(A[M+", "+T]=b)):(E.FTa(f,M,T),E.Rf(M,T,h),E.Xf(M,T,h));d.Dj(k,t,n,a,l),d.Dj(E,r,i,a,l),R=(I=k.getSource().getSheet()).uja&&(I.parent||I).tja(),d.Ej(R,k.getSource(),t,n,E.getSource(),r,i,a,l,!0,A),!0===g&&d.Ej(R,k.getSource(),t,n,E.getSource(),r,i,a,l,!0,A)}},e.prototype.isAdjustCell=function(e){return e.preAdj||this.imb&&e===this.imb[0]},e.prototype.isAdjust=function(e){return e.preAdj||this.imb&&e===this.imb[0]},e.prototype.hh=function(e,t){var n,o,r=this;isNaN(t)||(r.imb||(r.imb={},r.jmb={}),n=r.imb[t],o=r.jmb[t],e&&!e.preAdj&&e!==n&&(n?o.nextAdj=e:r.imb[t]=e,e.preAdj=o,e.nextAdj=p,r.jmb[t]=e))},e.prototype.Fj=function(e,t){var n,o,r,i=this;isNaN(t)||(n=i.imb&&i.imb[t],e&&(e.preAdj||e===n)&&(o=e.preAdj,r=e.nextAdj,o?o.nextAdj=r:i.imb[t]=r,r?r.preAdj=o:i.jmb[t]=o,e.preAdj=p,e.nextAdj=p))},e.prototype.Gj=function(e,t,n,o,r,i,a){this.Hj(e,N,t,n,o,r,i,a);var s=0,l=0,u=0,c=0;0===t&&(o&&r?u=n:o?s=n:r?c=n:l=n),I(e,N,t,n,s,l,u,c,o,r),E(e,N,t,n,o,r)},e.prototype.Hj=function(e,t,n,o,r,i,a,s){var l,u,c,f,p,d,g,m,y,v,b,w,M,S,T,N,I,R,k,E=this,D=E.imb;if(D){for(m={};D[0];)if(g=(l=(p=D[0]).ah).dUa(),d=l.getSource(),A(m,u=p.row,c=p.column))E.Fj(p,0);else{if(f=l.Kf(u,c))if(f=t.call(E,d,u,c,f,e,n,o,r,i,h,a,s),y=l.Qf(u,c)){if(d===e&&(v=i?o:-o,r?n<=y.row&&(y.row+=v):n<=y.col&&(y.col+=v)),u===y.row&&c===y.col)if(y.isDynamicArray)l.fg(u,c,f,y,!0,C(r?u:c,n,g,e.id===d.id));else for(b=u;b<u+y.rowCount;b++)for(m[b]||(m[b]={}),w=c;w<c+y.colCount;w++)l.fg(b,w,f,y,b===u&&w===c,C(r?b:w,n,g,e.id===d.id)),x(m,b,w,!0)}else l.fg(u,c,f,y,!0,C(r?u:c,n,g,e.id===d.id));else(l.getRowExpression&&l.getRowExpression(u)||l.getColumnExpression&&l.getColumnExpression(c))&&l.Ag(u,c,1,1);E.Fj(p,0)}for(;D[1];)g=(l=(p=D[1]).ah).dUa(),u=p.row,l.getRowExpression&&((f=l.getRowExpression(u))&&l.fg&&(d=l.getSource(),l.fg(u,-1,t.call(E,d,u,-1,f,e,n,o,r,i),h,!0,C(u,n,g,e.id===d.id)))),E.Fj(p,1);for(;D[2];)g=(l=(p=D[2]).ah).dUa(),c=p.column,l.getColumnExpression&&((f=l.getColumnExpression(c))&&l.fg&&(d=l.getSource(),l.fg(-1,c,t.call(E,d,-1,c,f,e,n,o,r,i),h,!0,C(c,n,g,e.id===d.id)))),E.Fj(p,2);for(;D[3];)S=(M=D[3]).name,f=(l=M.ah).DTa(S),T=t.call(E,l.getSource(),0,0,f,e,n,o,r,i,{isNameID:!0}),l.gg(S,T),E.Fj(M,3);for(N in D)if((I=+N)>3&&D.hasOwnProperty(N))for(;D[N];)k=(R=D[N]).ah,f=t.call(E,k,0,0,R.expression,e,n,o,r,i),k.setExpression(R.id,R.name,f),E.Fj(R,I)}},e.prototype.ph=function(e){Q(e.getCalcSourceModel(),0,0,e.getRowCount(),e.getColumnCount()),this.Hj(e,H),I(e,H,0,0,0,0,0,0,!0,!1),E(e,H,0,0,!0,!1)},e.prototype.Ej=function(e,t,n,o,r,i,a,s,l,u,c){var f,p,d,g,m,v,b,C,M,S,T,N,I,R,k,E,D,_,O,F,P,H,B=this,L=Z,z=new y(t,n,o,r,i,a,s,l),V={};if(e&&q(e,z,u),j(t,z,u),M={},b=B.imb){for(;b[0];)if(f=(p=b[0]).ah,d=p.row,g=p.column,v=f.dUa(),A(V,d,g))B.Fj(p,0);else{if(m=f.Kf(d,g),C=f.getSource(),m)if(S=h,c&&c[d+", "+g]&&(C=t,S={crossSheetMoved:!0}),m=L.call(B,C,d,g,m,z,u,S),N=void 0,(T=f.Qf(d,g))&&!T.isDynamicArray)if(N=w(T),d===T.row&&g===T.col)for(M[N]=!0,I=d;I<d+T.rowCount;I++)for(V[I]||(V[I]={}),R=g;R<g+T.colCount;R++)f.fg(I,R,m,T,I===d&&R===g,v),x(V,I,R,!0);else M[N]||(f.fg(d,g,m,T,!1,v),x(V,d,g,!0));else f.fg(d,g,m,T,!0,v);else(f.getRowExpression&&f.getRowExpression(d)||f.getColumnExpression&&f.getColumnExpression(g))&&f.Ag(d,g,1,1);B.Fj(p,0)}for(;b[1];)f=(p=b[1]).ah,d=p.row,v=f.dUa(),f.getRowExpression&&((m=f.getRowExpression(d))&&f.jg&&f.jg(d,L.call(B,C,d,-1,m,z,u),h,v)),B.Fj(p,1);for(;b[2];)f=(p=b[2]).ah,g=p.column,v=f.dUa(),f.getColumnExpression&&((m=f.getColumnExpression(g))&&f.kg&&f.kg(g,L.call(B,C,-1,g,m,z,u),h,v)),B.Fj(p,2);for(;b[3];)E=(k=b[3]).name,m=(f=k.ah).DTa(E),D=L.call(B,C,0,0,m,z,u),f.gg(E,D),B.Fj(k,3);for(_ in b)if((O=+_)>3&&b.hasOwnProperty(_))for(;b[_];)H=(P=(F=b[_]).ah).getSource(),m=L.call(B,H,0,0,F.expression,z,u),P.setExpression(F.id,F.name,m),B.Fj(F,O)}},e.prototype.Dj=function(e,t,n,o,r){var i,a,s,l,u,c=t+o,f=n+r;for(s=t;s<c;s++)for(l=n;l<f;l++)i=e.Yf(s,l),a=e.Kf(s,l),(i||a)&&(this.Fj(i,0),e.Q3(s,l,0),u=e.qg(s,l,!0),this.hh(u,0))},e.prototype.Ij=function(e,t,n){var o,r;for(o=t;-1!==o&&o<t+n;o++)(e.Yf(-1,o)||e.Kf(-1,o))&&(e.Q3(-1,o,2),r=e.sg(o,!0),this.hh(r,2))},e.prototype.Jj=function(e,t,n){var o,r;for(o=t;-1!==o&&o<t+n;o++)(e.Yf(o,-1)||e.Kf(o,-1))&&(e.Q3(o,-1,1),r=e.rg(o,!0),this.hh(r,1))},e.prototype.Kj=function(e){var t,n,r,i,a,s=e.Cf().getAllSourceModels();for(r=0;r<s.length;r++)if((i=s[r]).lmb)for(t=i.lmb(),a=0;a<t.length;a++)(n=t[a])&&n.isVolatile&&n instanceof o.CellCalc&&!this.isAdjustCell(n)&&this.hh(n,0)},e.prototype.onBeforeAddRemoveRows=function(e,t,n){[e,n].forEach((function(e){if(e){var n=e.rC(),o=e.cC();e.Sg(t,0,n-t,o),e.Ug(t,n-t),Q(e,t,-1,n-t,-1,!0)}}))},e.prototype.onAfterAddRemoveRows=function(e,t,n,o,r,i){var a=this;[e,i].forEach((function(e){if(e){var r=e.rC(),i=e.cC();o?e.Ag(t,0,n,i):r+=n,a.Dj(e,t,0,r-t,i),a.Jj(e,t,r-t),a.Kj(e)}})),a.Gj(e.getSource(),t,n,!0,o,h,r),e.Cf().autoCalculation&&e.Cf().recalculateAll(!1)},e.prototype.onAfterAddRemoveColumns=function(e,t,n,o,r,i){var a=this;[e,i].forEach((function(e){if(e){var r=e.rC(),i=e.cC();o?e.Ag(0,t,r,n):i+=n,a.Dj(e,0,t,r,i-t),a.Ij(e,t,i-t),a.Kj(e)}})),a.Gj(e.getSource(),t,n,!1,o,h,r),e.Cf().autoCalculation&&e.Cf().recalculateAll(!1)},e.prototype.onBeforeAddRemoveColumns=function(e,t,n){[e,n].forEach((function(e){if(e){var n=e.rC(),o=e.cC();e.Sg(0,t,n,o-t),e.Wg(t,o-t),Q(e,-1,t,-1,o-t,!0)}}))},e.prototype.onAfterRemoveName=function(e,t){var n=e.wg(t,!1);n&&(n.updateListening(!0,!1),n.fh(),n.updateListeningOnRemoved())},e.prototype.adjustFormulaOnRemoveName=function(e,t,n){return Y(e,t,n)},e.prototype.invalidName=function(e,t){var n;t&&((n=e.getCalcSourceModel().wg(t.toUpperCase(),!0))&&n.Yg())},e.prototype.onAfterRemoveTable=function(t,n){var o,r,i,a,l,u,c,f,h,p,d,g,m=this;for(l=0;l<t.length;l++)Q((u=t[l]).source().getCalcSourceModel(),u.startRow(),u.startColumn(),u.endRow()-u.startRow()+1,u.endColumn()-u.startColumn()+1);if(c=m.imb)for(f={};c[0];)if(o=(h=c[0]).ah,A(f,r=h.row,i=h.column))m.Fj(h,0);else{if(a=o.Kf(r,i))if(a=e.adjustExpressionOnRemoveTable(a,t,r,i,n),(p=o.Qf(r,i))&&!p.isDynamicArray)for(p=s.kf(r,i,p.rowCount,p.colCount),d=r;d<r+p.rowCount;d++)for(f[d]||(f[d]={}),g=i;g<i+p.colCount;g++)o.fg(d,g,a,p,d===r&&g===i),x(f,d,g,!0);else o.fg(r,i,a,p,!0);else(o.getRowExpression&&o.getRowExpression(r)||o.getColumnExpression&&o.getColumnExpression(i))&&o.Ag(r,i,1,1);m.Fj(h,0)}},e.adjustExpressionOnRemoveTable=function(t,n,r,i,a){var s,l,u,c,f,h,d,g,m,y,v,b,C,w,x,A,M=e.adjustExpressionOnRemoveTable;if(9===t.type){if(s=t.value,l=t.value2,u=M(s,n,r,i,a),c=l&&M(l,n,r,i,a),s!==u||l!==c)return o.Kh(t.operatorType,u,c)}else if(7===t.type){for(f=!1,h=[],d=0;d<t.arguments.length;d++)m=M(g=t.arguments[d],n,r,i,a),f=f||g!==m,h.push(m);if(f)return o.Jh(t,h)}else if(10===t.type){if((y=t.value)!==(v=M(y,n,r,i,a)))return o.Lh(v)}else if(13===t.type)for(b=t,d=0;d<n.length;d++)if(b.baseTable===n[d])return a?o.Ih:(C=b.getRange(-1===r?0:r,-1===i?0:i,!0),w=-1===r||1===b.referencePortions(),x=1===C.rowCount&&1===C.columnCount,A=b.source,x?o.rf(A,p,C.row,C.col,w,!1):o.uf(A,p,C.row,C.col,C.row+C.rowCount-1,C.col+C.colCount-1,w,!1,w,!1));return t},e}(),t.CalcOperatorAdjustor=v,o.CalcService.prototype.uzb=function(){return new v},t.adjustFormulaOnMoveSwap=Z},"./dist/plugins/sheetsCalc/parser-sheets.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function T(e){return u(e+1).split("")}function N(e,t){var n=t+1;return e<0?e%n+n:e>t?e%n:e}function I(e){return new i.ErrorSource(e)}function R(e,t,n,o,r){var a,l,u=s.BAND_INDEX_CONST,c={cj:u,dj:u,ej:!0,fj:!0,gj:!1,li:0,Vka:!0},f=t?D(e,n,o,0):E(e,0,r);return f.hj?(c.cj=f.ij,c.ej=f.jj):(c.dj=f.ij,c.fj=f.jj),c.li=f.li,c.gj=f.gj,!f.gj||f.li>=e.length?c:!t&&f.hj||t&&!f.hj?{gj:!1}:(a=e[c.li],!t&&(i.isNumber(a)||"$"===a)||t&&("C"===a||"c"===a)?(l=t?D(e,n,o,c.li):E(e,c.li,r),c.li=l.li,!l.gj||!t&&!l.hj||t&&l.hj?(c.gj=!1,c):(l.CLb&&(c.CLb=!0),c.li<e.length&&(c.Vka=!1),t?(c.dj=l.ij,c.fj=l.jj):(c.cj=l.ij,c.ej=l.jj),c.gj=!0,c)):{gj:!1})}function k(e){return i.ei(e)||95===e.charCodeAt(0)}function E(e,n,o){var r,a,s,l,u,c,f,p,d,g={jj:!0,gj:!1},m=e.length;if(n>=m)return g;if("$"===e[n]&&(g.jj=!1,n++),n>=m)return g;if(a=0,s=e[r=n],l=!1,i.isNumber(s)&&"0"!==s){for(g.hj=!0;r<m&&i.isNumber(s);)++r<m&&(s=e[r]);if(r+1===m&&"#"===s&&o&&(l=!0),r-n>7)return g;for(u=r-1,c=0;u>=n;u--,c++)a+=(e[u].charCodeAt(0)-48)*y[c];if(a<=t.maxRowCount)return g.ij=a-1,g.li=l?m:r,g.CLb=l,g.gj=!0,g}else if(i.ei(s)){for(g.hj=!1;r<m&&i.ei(s);)++r<m&&(s=e[r]);if(r-n>3)return g;if(function(e,t,n){for(var o=e,r=t[e],i=!1;o<n&&!k(r);)++o<n&&(r=t[o]);if(o<n){for(;o<n&&k(r);)++o<n&&(r=t[o]);o<n&&(i=!0)}return i}(r,e,m))return g;for(a=0,p=f=r-1;p>=n;p--){if(!((d=e[p].charCodeAt(0))>=65&&d<=90||d>=97&&d<=122))return g;a+=((32|d)-96)*h[f-p]}if(a<=t.maxColumnCount)return g.ij=a-1,g.li=r,g.gj=!0,g}return g}function D(e,n,o,r){var a,l,u,c,f,h={li:r,ij:s.BAND_INDEX_CONST,hj:!0,jj:!1,gj:!1},p=e.length;if(r>=p)return h;if("R"===(l=e[a=r])||"r"===l)h.hj=!0,u=n;else{if("C"!==l&&"c"!==l)return h;h.hj=!1,u=o}if(a++,++r>=p)return h.li=r,h.ij=u,h.jj=!0,h.gj=!0,h;if("["===(l=e[a])&&(r++,a++,h.jj=!0),r>=p)return h;if(c=!1,l=e[a],h.jj&&"-"===l&&(r++,a++,c=!0),r>=p)return h;if(l=e[a],!i.isNumber(l))return h.jj||(h.li=r,h.ij=u,h.jj=!0,h.gj=!0),h;for(;a<p&&i.isNumber(l);)++a<p&&(l=e[a]);if(f=parseInt(e.slice(r,a).join(""),10),h.jj){if(a>=p||"]"!==e[a])return h;a++}return f<(h.hj?t.maxRowCount:t.maxColumnCount)?(h.jj?(f=c?-f:f,h.ij=f+u):h.ij=f-1,h.li=a,h.gj=!0,h):void 0}function j(e,t,n,o){var r,a,s,l,u,c=e.source&&e.source._service,f=e.row||0,h=e.column||0,d=e.Eh;if(n.source===i.BangSource)o.push("!");else if(n.source&&!F(e,o,n.source,n.endSource))return void o.push("#","R","E","F","!");if(a=33===(r=n.type),8===r||5===r)o.push(""+n.value);else if(100===r)s="_xlpm.",n.bhc&&c.UIc?o.push(s+""+n.value):o.push(""+n.value);else if(n.value&&n._error)o.push(""+n.value);else if(a||n.sf()){if(l=void 0,s=void 0,u=void 0,a&&(s=(l=v[d?0:1]).prefix,u=l.surfix,o.push(s),n.isReferenceError))return o.push("#REF!"),void o.push(u);!n.source&&e.addSheetName&&e.source&&F(e,o,e.source,p),_(e.useR1C1,f,h,n.row,n.column,n.rowRelative,n.columnRelative,o),a&&o.push(u)}else!n.source&&e.addSheetName&&e.source&&F(e,o,e.source,p),O(e.source,e.useR1C1,f,h,n.row,n.column,n.endRow,n.endColumn,n.rowRelative,n.columnRelative,n.endRowRelative,n.endColumnRelative,o,n.tf())}function _(e,n,o,r,a,s,l,u,c){var f,h;if(c=c||0,f=t.maxRowCount-1,(0===c||1===c)&&r>-f&&r<=2*f&&(r=N(r+=s?n:0,f)),h=t.maxColumnCount-1,(0===c||2===c)&&a>-h&&a<=2*h&&(a=N(a+=l?o:0,h)),function(e,t,n,o,r,i,a){return 3===a||n>=0&&o>=0||1===a&&n>=0||2===a&&o>=0}(0,0,r,a,0,0,c))if(e){if(2!==c&&(u.push("R"),r>=0&&(n!==r||!s)&&(s?u.push("["+(r-n)+"]"):(r++,u.push(r+""))),a<0))return;1!==c&&(u.push("C"),o===a&&l||(l?u.push("["+(a-o)+"]"):(a++,u.push(a+""))))}else{if(a>=0&&(l||u.push("$"),u.push.apply(u,T(a))),r<0)return;r++,s||u.push("$"),u.push(r+"")}else u.push(""+i.Errors.Reference)}function O(e,n,o,r,i,a,l,u,c,f,h,p,d,g){3===(g=g||0)&&(i=0,l=e?e.getRowCount():t.maxRowCount-1,g=1),_(n,o,r,i,a,c,f,d,g);var m=s.BAND_INDEX_CONST;(!n||i!==l||a!==u||l!==m&&u!==m)&&(l===m&&u===m||(d.push(":"),_(n,o,r,l,u,h,p,d,g)))}function F(e,t,n,o){if(e.getExternalSourceToken){if(n!==i.BangSource){var r=function(e,t,n){if(!t||0===t.length||P(e,t)||P(e,n))return[];var o,r=t;if(B(t,!1)||n&&B(n,!1)){for(r=["'"],o=0;o<t.length;o++)"'"===t[o]&&r.push("'"),r.push(t[o]);if(n)for(r.push(":"),o=0;o<n.length;o++)"'"===n[o]&&r.push("'"),r.push(n[o]);r.push("'")}else if(n)for(r.push(":"),o=0;o<n.length;o++)r.push(n[o]);return r}(e,e.getExternalSourceToken(n).split(""),o&&e.getExternalSourceToken(o).split(""));if(!(r.length>0))return!1;t.push.apply(t,r)}return t.push("!"),!0}return!1}function P(e,t){if(!t||0===t.length||!e.Eh)return!1;var n="'"===t[0]?1:0;return"["===t[n]&&t.indexOf("]")>n}function H(e,t){var n,o,r;if(!e||0===e.length)return!0;if(!t){if(i.isNumber(e[0]))return!1;if((n=function(e){var t=R(e,!1,0,0);return t.gj||(t=R(e,!0,0,0)),t}(e)).gj&&n.li<=e.length)return!1}for(r=0;r<e.length;r++)if(o=e[r],t){if("*"===o||":"===o||"["===o||"]"===o||"?"===o||"\\"===o||"/"===o)return!1}else if(m[o]||i.operaterTypesMap[o])return!1;return!0}function B(e,t){var n,o,r;return!!i.isDigit(+e[0])||(n=[],o=e,"["===e[0]&&((r=e.lastIndexOf("]"))>0&&(n=e.slice(1,r),o=e.slice(r+1))),!function(e,t){var n,o;if(!e||0===e.length)return!0;for(o=0;o<e.length;o++)if(n=e[o],t){if("*"===n||":"===n||"["===n||"]"===n||"?"===n)return!1;if("'"===n&&(0===o||o>=e.length-1||"'"!==e[o+1]))return!1}else if("'"===n||"["===n||"]"===n||"?"===n||"%"===n||i.operaterTypesMap[n])return!1;return!0}(n)||!H(o,t))}function L(e){var t=new i.Expression(8);return t.value=e,t}function z(e){var t=e;return e&&e.length>=3&&"["===e[0]&&"0"===e[1]&&"]"===e[2]&&(t=3===e.length?"":e.substring(3)),t}function V(e,t,n,o,r){return 0===t.Nc&&0===t.hi||!o&&0===t.Nc&&4===t.hi&&(!r||n<e.length-2&&":"===e[n+1].ni&&0===e[n+2].Nc&&4===e[n+2].hi)}function G(e,t,n,o,r){return t<=e.startRow()&&n<=e.startColumn()&&t+o>e.endRow()&&n+r>e.endColumn()}function W(e,t,n){var o,r,i,a,s,u,c,f,h,p=n,d=0,g=t[d],m=function(e,t,n,o){for(var r,i,a,s=t.length;"["!==o&&n<s;)n++,o=t[n];return(a=n)>0?(i=U(t,0,a),r=e.getTableByName(i)):r=e.getTableByIndex(e.row,e.column),{sj:r,tj:n,uj:o}}(e,t,d,g),y=m.sj;for(y||$(),p.baseTable=y,d=m.tj,g=t[++d],o=d;" "===g;)g=t[++d];for("@"!==g&&"["!==g&&(g=t[d=o]),r=1,i=!1,a=!1,s=t.length;0!==r&&d<s;)if("["===g&&(r++,g=t[++d]),"#"===g)i&&r<=1&&$(),c=(u=K(t,d,g,r)).vj,d=u.tj,g=u.uj,r=u.wj,i?2===p.qj&&3===c||2===c&&3===p.qj?p.qj=6:3===p.qj&&8===c||3===c&&8===p.qj?p.qj=12:$():p.qj=c,i=!0;else if("@"===g){for((r>1||i)&&$(),i=!0,p.qj=1,g=t[++d];" "===g;)g=t[++d];","===g&&$()}else{for(f=d;!l.isNullOrUndefined(g)&&"]"!==g&&"["!==g;)if("'"===g&&d++,","===g){for(g=t[++d],h=d;" "===g;)g=t[++d];if("["===g){d=h,g=",";break}}else g=t[++d];if(d>f&&((a||"["===g&&r>1)&&$(),d=(u=Z(p,t,d,g,r,f)).tj,g=u.uj,r=u.wj,a=!0),"]"===g){if(0===--r)break;d>=t.length&&$(),g=t[++d]}","===g&&(g=t[++d])}i||(p.qj=e.DLb?1:16),a||(p.oj=0,p.pj=p.lj.endColumn()-p.lj.startColumn(),p.rj=1)}function U(e,t,n){return e.slice(t,n).join("")}function Z(e,t,n,o,r,i){var a,s,l,u,c,f,h=e,d=[],g="",m=!1,y=!1;if(r>1)m=!0,r--,d=t.slice(i,n),":"===(o=t[++n])&&(y="["===(o=t[++n]),g=(s=Q(t,n,o,r)).xj,n=s.tj,o=s.uj,r=s.wj);else if("["===o){for(y=!0,o=t[a=n-1];" "===o;)o=t[--a];":"!==o&&$(),d=function(e){for(var t=e.length-1;t>=0&&" "===e[t];)t--;for(;t>=0&&" "!==e[t];)t--;return t>=0?e.slice(t+1,e.length-t-1):e}(d=t.slice(i,a)),g=(s=Q(t,n,o=t[n],r)).xj,n=s.tj,o=s.uj,r=s.wj}else h.qj!==p&&16!==h.qj||(m=!0),(a=(l=t.slice(i,n)).indexOf(":"))>0?(d=l.slice(0,a),"["!==(g=l.slice(a+1))[0]&&$()):d=l;if(u=q(h,d,m),g?(c=q(h,g,y),h.rj=4):(c=u,h.rj=2),u>c&&(f=u,u=c,c=f),h.oj=u,h.pj=c,++n<t.length)for(o=t[n];" "===o;)o=t[++n];return{tj:n,uj:o,wj:r}}function q(e,t,n){var o,r,i,a;if(t&&function(e,t){var n,o,r;if(t)return!0;if(n="",n=e[0],o=n,"#"===n||"@"===n||" "===n||","===n||":"===n||"["===n||"]"===n)return!1;for(r=1;r<e.length;r++){if(","===(n=e[r])||":"===n||"["===n&&"'"!==o||"]"===n&&"'"!==o||"@"===n&&"'"!==o||"#"===n&&"'"!==o)return!1;o=n}return!0}(t,n)){for(o=[],r=0,i=t.length;r<i;r++)"'"===t[r]&&r<i-1&&r++,o.push(t[r]);return t=o,(a=e.lj.getColumnIndexInTable(t.join("")))<0&&$(),a}return-1}function J(e){var t,n,o=[];for(n=0;n<e.length;n++)"["!==(t=e[n])&&"]"!==t&&"@"!==t&&"#"!==t&&"'"!==t||o.push("'"),o.push(t);return o}function Q(e,t,n,o){var r,i,a=!1;if("["===n)for(a=!0,o++,n=e[++t];" "===n;)n=e[++t];for(r=t;"]"!==n&&(","!==n||o>1);)"'"===n&&t++,n=e[++t];return t<=r&&$(),i=e.slice(r,t),o>1&&o--,a||(i=function(e){for(var t,n=0,o=e.length;n<o&&" "===e[n];)n++;for(t=n,n=o-1;n>t&&" "===e[n];)n++;return n>=t?e.slice(t,n+1):e}(i)),{xj:i,tj:t,uj:n,wj:o}}function Y(e){var t,n=i.getMapping()&&i.getMapping().tableFunctionsMapping;if(!l.isNullOrUndefined(n))for(t in n)if(n[t].toLowerCase()===e)return t.toLowerCase();return e}function K(e,t,n,o){for(var r,i,a,s=14,l=t;"]"!==n;)"'"===n&&t++,n=e[++t];for(r=Y(r=U(e,l,t).toLowerCase().trim()),i=!1,a=0;a<g.length;a++)if(r===g[a]){s=M[r],i=!0;break}if(i||$(),++t>=e.length)o--;else{for(n=e[t];" "===n;)n=e[++t];if(","===n){for(o<=1&&$(),n=e[++t];" "===n;)n=e[++t];"["===n&&(o++,n=e[++t])}o>1&&o--}return{vj:s,tj:t,uj:n,wj:o}}function $(){throw f().Exp_FormulaInvalid}function X(e){return 1===e.Nc&&"ARRAY"===e.ni?1:0===e.Nc&&3===e.hi?(e.HTa||e.ni).length+2:0===e.Nc&&12===e.hi?e.ni.length+3:e.ni.length}function ee(e,t,n){var o,r;e&&t&&((r=e[o=t.getName&&t.getName()||"!"])||(r=e[o]=[],e.sheets||(e.sheets=[]),e.sheets.push(o)),r.push(n))}function te(e,t,n,o,r,a){var s,l,u;if(e){for(;10===e.type;)e=e.value;if(12===e.type&&(e=e.value),e.type>=2&&e.type<=6);else if(1===e.type)s=e.getRange(r,a),!o.source||e.source&&e.source!==o.source||t.push(s),ee(n,e.source||o.source,s);else if(13===e.type)s=e.getRange(r,a),e.source===o.source&&s&&t.push(s),ee(n,e.source||o.source,s);else if(8===e.type)l=d,e.source?e.source.Cf()&&(l=new i.EvaluateContext(e.source,i._createCellIdentity(r,a))):l=o,te(l.getName(e.value),t,n,l,r,a);else if(9===e.type)te(e.value,t,n,o,r,a),e.value2&&te(e.value2,t,n,o,r,a);else if(7===e.type)for(u=0;u<e.arguments.length;u++)te(e.arguments[u],t,n,o,r,a)}}function ne(e,t,n,o,r,s,l){var u,c,f,h,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k=p,E=o.yj(),D=o.Cf();for(D?(u=new a.SheetParserContext(o,!l&&D.useR1C1,i._createCellIdentity(r,s)),k=new i.EvaluateContext(E,i._createCellIdentity(r,s),!1)):u=new i.ParserContext(d,!1,i._createCellIdentity(0,0)),u.ignoreError=!0,c=[],h=0;h<t.length;h++)try{if("["===(f=t[h]).ni||"#"===f.Qb[0]||3===f.hi){c.push({text:f.HTa||f.ni,type:f.Nc,subType:f.hi,canDrag:!1,ranges:f.ranges,value:f.ni});continue}if(h=oe(e,u,t,h,g=[]),m=void 0,g.length>0){for(y=0;y<g.length;y++)if((v=g[y])instanceof i.FormulaToken)c.push({text:n.slice(v.mi,v.li+1).join(""),type:v.Nc,subType:v.hi,canDrag:m,ranges:[],value:v.ni});else if(v.Lf){if(C=(b=v.Lf).type,w=b.source,x=n.slice(v.mi,v.li+1).join(""),A=[],M={},m=!0,S=b.getRange&&b.getRange(r,s),8===C)m=!1,k&&(T=k,b.source&&(T=new i.EvaluateContext(b.source,i._createCellIdentity(r,s),!1)),te(T.getName(b.value),A,M,k,r,s));else if(13===C)m=!1,w===E&&S?A.push(S):A=null,ee(M,w,S);else if(33===C)(w||b.contextSource)===E&&(S||(S=i.getRangeForReference(b,r,s)),A.push(S),w||(w=E)),ee(M,w,S);else if(1===C)if(b.endSource)for(N=w,I=b.endSource,R=N.getSources(I),y=0;y<R.length;y++){if(R[y]===E){A.push(S);break}ee(M,R[y],S)}else ee(M,w||E,S),w&&w!==E||A.push(S);else A=null;A&&A.length>0?c.push({text:x,type:0,subType:7,canDrag:m,ranges:A,value:x,sheetRanges:M}):c.push({text:x,type:f.Nc,subType:f.hi,canDrag:m,ranges:A,value:x,sheetRanges:M})}}else c.push({text:f.ni,type:f.Nc,subType:f.hi,canDrag:!1,ranges:f.ranges,value:f.ni})}catch(e){c.push({text:f.ni,type:f.Nc,subType:f.hi,canDrag:!1,ranges:f.ranges,value:f.ni})}return c}function oe(e,t,n,o,r){var i,a,s,l,u,c,f=n[o];return f&&"function"!=typeof f&&0===f.Nc?(i=[],a=e.resolveToken(t,n,i,o)-1,1===(l=(s=i[0]).type)||13===l||33===l||8===l||5===l&&s.source?(u=n[a],c={mi:f.mi,li:u.li,Lf:s},r.push(c),a):o):o}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("@grapecity/js-sheets-common"),i=n("@grapecity/js-calc"),a=n("./dist/plugins/sheetsCalc/calc-spreadjs.js"),s=n("./dist/plugins/sheetsCalc/calc.ns.js"),l=n("./node_modules/util/util.js"),u=o.util.xq,c=new r.Common.ResourceManager(o.SR),f=c.getResource.bind(c),i.Errors.Reference,t.maxRowCount=1048576,t.maxColumnCount=16384,h=[1,26,676],p=void 0,d=null,g=["#all","#data","#headers","#totals","#this row"],m={" ":!0,"'":!0,"[":!0,"]":!0,"?":!0,"\\":!0,"%":!0,'"':!0,"(":!0,")":!0,"|":!0,"{":!0,"}":!0,"#":!0,"@":!0,"!":!0,$:!0,"^":!0,"":!0,"":!0,".":!0,";":!0},y=[1,10,100,1e3,1e4,1e5,1e6,1e6],v=[{prefix:"ANCHORARRAY(",surfix:")"},{prefix:"",surfix:"#"}],t.jma=H,t.validateSheetName=H,b=function(e){function t(t){var n=e.call(this,8e3)||this;return n.kj=t,n}return S(t,e),t.prototype.resolveToken=function(e,t,n,o){var r,a,u,c,f,h,p,g,m,y,v,b,C,w,x,A,M,S,T=e.useR1C1,N=e.row||0,k=e.column||0,E=n.length,D=n[o],j=D.ni,_=D.Nc,O=D.hi;if(0!==_&&6!==O)return!1;if(0===_&&0===O&&o<E-2&&":"===n[o+1].ni&&12===n[o+2].hi&&n[o+2].ni.indexOf(":")<0||0===_&&12===O){if(f=void 0,h=void 0,j&&(j.indexOf(":")>0?(p=j.indexOf(":"),f=j.substring(1,p-1),h=j.substring(p+1,j.length-2)):("'"===(f=j).charAt(0)&&(f=f.substring(1,f.length-1)),0===O&&("'"===(h=n[o+2].ni).charAt(0)&&(h=h.substring(1,h.length-1))))),o++,c=!!f,(f=z(f))&&(a=(a=j?e.getExternalSource("",f):i.BangSource)||I(f),(h=z(h))&&(u=(u=e.getExternalSource("",h))||I(h),o+=2)),!(D=n[o]))return L(j);j=D.ni}if(g=o===E-1?d:n[o+1],V(n,D,o,T,!0)){if(m=e&&e.source&&e.source._service&&e.source._service.allowDynamicArray,!(y=R(D.Qb,T,N,k,m)).gj&&!c)return!1;if(D.hi=7,y.gj&&y.Vka){if(v=y.cj,b=y.dj,C=y.ej,w=y.fj,x=y.CLb,o<E-2&&5===g.Nc&&":"===g.ni&&(V(n,g=n[o+2],o+2,T,!1)&&((A=R(g.Qb,T,N,k)).gj&&v===s.BAND_INDEX_CONST==(A.cj===s.BAND_INDEX_CONST)&&b===s.BAND_INDEX_CONST==(A.dj===s.BAND_INDEX_CONST))))return N=v===s.BAND_INDEX_CONST?0:N,k=b===s.BAND_INDEX_CONST?0:k,{index:o+3,expr:i.uf(a,u,v-(C?N:0),b-(w?k:0),A.cj-(A.ej?N:0),A.dj-(A.fj?k:0),C,w,A.ej,A.fj,N,k)};if(v===s.BAND_INDEX_CONST||b===s.BAND_INDEX_CONST){if(T)return v-=v!==s.BAND_INDEX_CONST&&C?N:0,b-=b!==s.BAND_INDEX_CONST&&w?k:0,{index:o+1,expr:i.uf(a,u,v,b,v,b,C,w,C,w,N,k)};if(!a)return!1;r=L(j)}if(!r)return l.isNullOrUndefined(a)&&(a=function(e,t,n){var o,r,i,a,s=e.source;return s&&(r=s.q$a,i=s.cDc,a=s.dDc,r&&((t>=0&&t<i&&n>=a||t>=i&&n>=0&&n<a)&&(o=s))),o}(e,N,k)),M=v-(C?N:0),S=b-(w?k:0),{index:o+1,expr:r=x?i.BLb(e.source,a,u,M,S,C,w):i.rf(a,u,M,S,C,w)}}else r=L(j)}else if(6===D.hi)(r=new i.Expression(5)).value=i.CalcError.parse(D.ni);else{if(!a)return!1;r=L(j)}return a&&(r.source=a),u&&(r.endSource=u),{index:o+1,expr:r}},t.prototype.unparse=function(e,t,n,o){var r=n&&n.type;return(1===r||8===r||5===r||33===r||100===r)&&(j(e,0,n,o),!0)},t}(i.TokenResolver),t.SheetReferenceResolver=b,function(e){e[e.ThisRow=1]="ThisRow",e[e.Headers=2]="Headers",e[e.Data=3]="Data",e[e.Totals=8]="Totals",e[e.HeadersAndData=6]="HeadersAndData",e[e.DataAndTotals=12]="DataAndTotals",e[e.All=14]="All",e[e.NotSpecific=16]="NotSpecific"}(C=t.StructReferencePortions||(t.StructReferencePortions={})),function(e){e[e.All=1]="All",e[e.NotSpecific=1]="NotSpecific",e[e.SingleColumn=2]="SingleColumn",e[e.ColumnRange=4]="ColumnRange"}(w=t.StructReferenceColumnSpecifier||(t.StructReferenceColumnSpecifier={})),x=function(e){function t(){return e.call(this,13)||this}return S(t,e),t.prototype.tableName=function(){return this.lj.tableName()},Object.defineProperty(t.prototype,"baseTable",{get:function(){return this.lj},set:function(e){this.lj=e,this.source=e.source()},enumerable:!0,configurable:!0}),t.prototype.JUa=function(){this.vzb=this.lj.startColumn()},t.prototype.columnReferenceStart=function(){return this.oj+this.lj.startColumn()},t.prototype.columnReferenceEnd=function(){return this.pj+this.lj.startColumn()},t.prototype.referencePortions=function(){return this.qj},t.prototype.referenceColumnSpecifier=function(){return this.rj},t.prototype.getRange=function(e,t,n){var o,r,a,s,l,u,c,f,h,p,g,m=this,y=m.lj;switch(m.JUa(),c=y.startRow(),f=y.endRow(),h=y.hasTotalsRow(),p=y.hasHeadersRow(),m.qj){case 3:case 16:o=p?c+1:c,a=h?f-1:f;break;case 2:if(p)o=c,a=c;else{if(!n)return d;o=c-1,a=c-1}break;case 8:if(h)o=f,a=f;else{if(!n)return d;o=f+1,a=f+1}break;case 1:o=e,a=e;break;case 6:o=c+(n&&!p?-1:0),a=h?f-1:f;break;case 12:o=p?c+1:c,a=f+(n&&!h?1:0);break;case 14:default:o=c+(n&&!p?-1:0),a=f+(n&&!h?1:0)}return r=m.columnReferenceStart(),s=m.columnReferenceEnd(),g=y.endColumn(),1===m.rj&&(s=g),r>g||s>g?(m._error=!0,d):a<o||!n&&o<c||!n&&a>f?d:(l=a-o+1,u=s-r+1,i.qf(o,r,l,u))},t.prototype.offsetWhenInsertRemoveColumn=function(e,n,o,r){var a,s,l=this,u=l.vzb;return e<u||e===u&&o&&!r||e>l.pj+u?l:(n=o?n:-n,a=e-u,(s=new t).baseTable=l.lj,s.pj=l.pj+n,s.oj=l.oj,e<=u+l.oj&&(s.oj+=n,s.oj<a&&(s.oj=a)),s.rj=l.rj,s.qj=l.qj,s.pj<s.oj?i.Ih:s)},t.prototype.offsetWhenCopy=function(e,t,n,o,r,s,l,u,c,f){var h,p,d,g,m,y=new a.SheetParserContext(t.kj,t._service.useR1C1,i._createCellIdentity(n,o)),v=y.getTableByIndex(n,o),b=this.offset();return v&&(h=n-r,p=o-s,d=l-r,g=u-s,m=void 0,e===t?m=y.getTableByIndex(h,p):m=new a.SheetParserContext(e.kj,e._service.useR1C1,i._createCellIdentity(h,p)).getTableByIndex(h,p),m!==v&&m===this.lj&&G(m,d,g,c,f)&&G(v,l,u,c,f)&&(b.baseTable=v)),b},t.prototype.Jma=function(e){var n,o=this,r=new t;return r.baseTable=o.lj,r.pj=o.pj,r.oj=o.oj,2===o.rj&&e&&(e%=n=o.lj.endColumn()-o.lj.startColumn()+1,r.oj+=e,r.oj<0&&(r.oj+=n),r.pj=r.oj),r.rj=o.rj,r.qj=o.qj,r},t.prototype.offset=function(e,n,o){var r=this,i=new t;return i.baseTable=r.baseTable,i.qj=r.qj,i.oj=r.oj,i.pj=r.pj,i.rj=r.rj,i},t.prototype.Kma=function(e,t){var n=this.lj;return e>=n.startRow()&&t>=n.startColumn()&&e<=n.endRow()&&t<=n.endColumn()},t.prototype.tzb=function(e,t,n){this.lj.wzb(e,t,n)},t}(i.Expression),t.xzb=x,A=function(e){function t(t){var n=e.call(this,7900)||this;return n.kj=t,n}return S(t,e),t.prototype.resolveToken=function(e,n,o,r){var i,a,s,l=o[r];if(0===l.Nc&&(0===l.hi||7===l.hi))if("]"===(i=l.ni).charAt(i.length-1))try{return a=new x,W(e,i.split(""),a),a}catch(e){}else if(s=e.getTableByName&&e.getTableByName(i))return t.create(s);return d},t.prototype.unparse=function(e,t,n,o){var r,a,s,l,u,c,f;return 13===n.type&&(r=n,e.YSa?(a=r.getRange(e.row,e.column,!0),j(e,0,i.uf(r.source,d,a.row,a.col,a.row+a.rowCount-1,a.col+a.colCount-1,!1,!1,!1,!1),o),!0):16===r.qj&&1===r.rj?(o.push(r.lj.tableName()),void(e.Eh&&o.push("[]"))):(l=o.length,e.source===r.lj.source()&&r.Kma(e.row,e.column)&&!e.Eh||o.push(r.lj.tableName()),o.push("["),16!==r.qj&&(u=function(e,t,n){var o=i.getMapping()&&i.getMapping().tableFunctionsMapping,r=i.sR().B2,a=o?o["#All"]:r.All.name,s=o?o["#This row"]:r.thisRow.name,l=o?o["#Headers"]:r.Headers.name,u=o?o["#Data"]:r.Data.name,c=o?o["#Totals"]:r.Totals.name;switch(e){case 1:return n?"["+s+"]":"@";case 2:return t?"["+l+"]":l;case 3:return t?"["+u+"]":u;case 8:return t?"["+c+"]":c;case 6:return"["+l+"], ["+u+"]";case 12:return"["+u+"], ["+c+"]"}return t?"["+a+"]":a}(r.qj,1!==r.rj,e.Eh),o.push(u)),1!==r.rj&&(1===r.qj&&!e.Eh||16===r.qj||o.push(", "),(c=r.lj.getColumnName(r.oj))?c=J(c.split("")).join(""):s=!0,s||(4===r.rj?(f=r.lj.getColumnName(r.pj))?(f=J(f.split("")).join(""),o.push("[",c,"]:[",f,"]")):s=!0:1===r.qj&&!e.Eh&&!function(e){var t,n="";if("#"===(n=e[0])||" "===n||"@"===n||" "===n||","===n||":"===n||"["===n||"]"===n)return!0;for(t=1;t<e.length;t++)if(" "===(n=e[t])||","===n||":"===n||"["===n||"]"===n||"@"===n||"#"===n)return!0;return!1}(c)||16===r.qj?o.push(c):o.push("[",c,"]"))),s?(o.length=l,o.push("#REF!")):o.push("]"),!0))},t.create=function(e,t,n,o,r){void 0===t&&(t=C.NotSpecific),void 0===n&&(n=w.NotSpecific),void 0===o&&(o=0),void 0===r&&(r=e.endColumn()-e.startColumn());var i=new x;return i.baseTable=e,i.qj=t,i.oj=o,i.pj=r,i.rj=n,i},t}(i.TokenResolver),t.StructureReferenceResolver=A,M={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1},t.qzb=function(e,t,n,o,r,a,s){var l,u,c;e.setParserOption(a),l=[],u=t.split("");try{c=n.yj().getParserContext(!s&&n.Cf().useR1C1,i._createCellIdentity(o,r),d),l=e.parseToTokens(c,u,!1)}catch(e){}return l=function(e,t){var n,o,r,a,s,l,u,c,f,h;for(e.unshift(new i.FormulaToken("=",1,0,0,0)),a=[],s=0,r=e.length-1;r>0;r--)e[r].mi===e[r-1].mi&&e[r].ni===e[r-1].ni||(a[s]=e[r],s++);for(a[s]=e[r],a.reverse(),l=[],u=0,c=0;c<a.length-1;c++,u++)o=X(a[c]),l[u]=a[c],a[c+1].mi-a[c].mi-o>0&&(n=new i.FormulaToken(t.slice(a[c].mi+o,a[c+1].mi),7,a[c].mi+o),l[++u]=n);for(l[u]=a[c],o=X(l[u]),l.length>0&&t.length>l[u].mi+o&&(n=new i.FormulaToken(t.slice(l[u].mi+o,t.length),7,l[u].mi+o),l[u+1]=n),f=0;f<l.length;f++)h=l[f].ni.trim(),3===l[f].hi?l[f].ni='"'+l[f].ni+'"':"("===h||"{"===h?(l[f].Nc=1,l[f].hi=1):")"!==h&&"}"!==h||(l[f].Nc=1,l[f].hi=2);return l}(l,u),ne(e,l,u,n,o,r,s)}},"./dist/plugins/sheetsCalc/sheetsCalc.entry.js":function(e,t,n){"use strict";function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),o(n("./dist/plugins/sheetsCalc/calc.ns.js")),o(n("./dist/plugins/sheetsCalc/parser-sheets.js")),o(n("./dist/plugins/sheetsCalc/calc-spreadjs.js")),o(n("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js")),o(n("./dist/plugins/sheetsCalc/worksheet-formula.js")),n("./dist/plugins/sheetsCalc/workbook-formula.js")},"./dist/plugins/sheetsCalc/workbook-formula.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d;Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("Core"),i=n("@grapecity/js-sheets-common"),a=n("@grapecity/js-calc"),s=n("./dist/plugins/sheetsCalc/calc-spreadjs.js"),l=n("./dist/plugins/sheetsCalc/calc-spreadjs.js"),u=s.SpreadSource,c=i.Common.u.Nb,f=new i.Common.ResourceManager(o.SR),h=f.getResource.bind(f),p=void 0,i.Common.j.Fa,(d=o.Workbook.prototype).qv=function(e){var t=this,n=t.Wu;t.Wu=new a.CalcService,t.Wu.useR1C1=1===t.options.referenceStyle,t.Wu.allowDynamicArray=t.options.allowDynamicArray,t.Wu.iterativeCalculation=t.options.iterativeCalculation,t.Wu.iterativeCalculationMaximumIterations=t.options.iterativeCalculationMaximumIterations,t.Wu.iterativeCalculationMaximumChange=t.options.iterativeCalculationMaximumChange,e&&n&&t.Wu.cloneFrom(n),t.yv=new u(t),t.zv=t.Wu.getGlobalSourceModel(t.yv)},d.addCustomFunction=function(e){this.Xu(e)},d.Xu=function(e){if(!(e&&e instanceof a.Functions.Function))throw Error(h().Exp_InvalidCustomFunction);this._functions[c(e.name)]=e},d.getCustomFunction=function(e){return e?this._functions[c(e)]:p},d.removeCustomFunction=function(e){e&&(delete this._functions[c(e)],this.iK())},d.clearCustomFunctions=function(){this._functions={}},d.addCustomName=function(e,t,n,o,r){this.Yu(this.Tu,e,t,n,o,!1,r)},d.H$a=function(e){return!this.Tu[c(e)]},d.isValidCustomName=function(e){return e&&o.Ul.G$a(e)&&this.H$a(e)},d.Yu=function(e,t,n,o,r,i,a){var s,u,f,p,d=this;if(!t||!n||!i&&!d.isValidCustomName(t))throw Error(h().Exp_InvalidCustomName);if(d.Wu){if(u=(s=this.getActiveSheet())?s.yj():null,f=void 0,i)try{f=d.Wu.parse(u,n,o,r,!1,!1,!0)}catch(e){}else f=d.Wu.parse(u,n,o,r);e[c(t)]=new l.NameInfo(t,f,o,r,a),i||((p={})[t]=t,this.Zu(p,!0))}},d.getCustomName=function(e){return e?this.Tu[c(e)]:p},d.aJb=function(e){return e?this.QHb[c(e)]:p},d.getCustomNames=function(){var e=[];return o.GC$.each(this.Tu,(function(t,n){e.push(n)})),e},d.ELb=function(){var e=[];return o.GC$.each(this.QHb,(function(t,n){e.push(n)})),e},d.removeCustomName=function(e){if(e){delete this.Tu[c(e)];var t={};t[e]=e,this.Zu(t,!1)}},d.RHb=function(e){if(e){delete this.QHb[c(e)];var t={};t[e]=e,this.Zu(t,!1)}},d.clearCustomNames=function(){var e=this.Tu;this.Tu={},this.Zu(e,!1)},d.FLb=function(){var e=this.QHb;this.QHb={},this.Zu(e,!1)},d.Zu=function(e,t){var n,o;if(e){for(o in n=this.zv,e)n&&n.updateNameCalc(o,t);this.iK()}},d.iK=function(){if(this.Wu&&!this.Wu.IsSuspended()){var e=this.getActiveSheet();e&&(e.suspendPaint(),this.Wu.recalculateAll(),e.resumePaint())}},d.getCalcService=function(){return this.Wu},d.Cf=function(){return this.Wu},d.suspendCalcService=function(e){this.Wu&&this.Wu.suspend(e)},d.resumeCalcService=function(e){this.Wu&&this.Wu.resume(e)},d.getCircularReference=function(){var e,t,n,o=this.chc();for(t in e=[],o=this.dhc(o))Object.prototype.hasOwnProperty.call(o,t)&&(n=t.split("\\"),e.push({row:+n[1],col:+n[2],rowCount:1,colCount:1,sheetName:n[0]}));return e},d.chc=function(){var e={};return this.sheets.forEach((function(t){var n,o,r,i,a,s,l,u=t.Bj(),c=t.getRowCount(),f=t.getColumnCount(),h=t.name();if(u)for(n=0;n<c;n++)for(o=0;o<f;o++)for(r=h+"\\"+n+"\\"+o,i=t.getDependents(n,o),!e[r]&&i.length>0&&(e[r]={from:[],to:[]}),a=0;a<i.length;a++)l=(s=i[a]).sheetName+"\\"+s.row+"\\"+s.col,e[l]||(e[l]={from:[],to:[]}),e[l].from.push(r),e[r].to.push(l)})),e},d.dhc=function(e){var t,n,o;function r(e,t){e.splice(e.indexOf(t),1)}for(t=!0;Object.keys(e).length>0&&t;)for(o in t=!1,n=function(n){if(Object.prototype.hasOwnProperty.call(e,n)){var o=e[n];0===o.from.length?(o.to.forEach((function(t){r(e[t].from,n)})),delete e[n],t=!0):0===o.to.length&&(o.from.forEach((function(t){r(e[t].to,n)})),delete e[n],t=!0)}},e)n(o);return e},o.Workbook.$n("calc",{priority:1e3,init:function(){this._functions={},this.Tu={},this.QHb={}},toJson:function(e){var t,n,r,i,a,s,l,u=this,c=u._functions;o.GC$.isEmptyObject(c)||(e.customFunctions=c),t=[],n=[],r=u.getCustomNames(),i=u.ELb(),a=u.Wu,s=this.getActiveSheet(),l=s?s.yj():null,r&&a&&(o.GC$.each(r,(function(e,n){var o,r=n.getName(),i=n.getRow(),s=n.getColumn(),u=n.getExpression(),c=n.getComment();u&&(o={name:r,formula:a.unparse(l,u,i,s,!1,!0),row:i,col:s},c&&(o.comment=c),t.push(o))})),o.GC$.each(i,(function(e,t){var o,r=t.getName(),i=t.getRow(),s=t.getColumn(),u=t.getExpression(),c=t.getComment();u&&(o={name:r,formula:a.unparse(l,u,i,s,!1,!0),row:i,col:s},c&&(o.comment=c),n.push(o))})),t.length>0&&(e.names=t),n.length>0&&(e.formatStringNames=n))},fromJson:function(e,t,n){var o,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A=this,M=A.Wu;if(M&&M.suspend(),A.clearCustomNames(),o=e.names)for(i=0;i<o.length;i++)a=o[i],A.Yu(this.Tu,a.name,a.formula,a.row,a.col,!0,a.comment);if(A.FLb(),s=e.formatStringNames)for(i=0;i<s.length;i++)a=s[i],A.Yu(this.QHb,a.name,a.formula,a.row,a.col,!0,a.comment);if(A.clearCustomFunctions(),l=e.customFunctions)for(u in l)l.hasOwnProperty(u)&&(c=l[u],(f=r.getTypeFromString(c.typeName))&&((h=new f).fromJSON(c,t),A.Xu(h)));if(m=[],g=e.sheets){for(v in p=0,g)"string"==typeof v&&(b=g[v],d=A.getSheetFromName(b.name||v),m.push(d),d.nameFunctionsFromJSON(b,t,n),p++);for(y=m.length,p=0;p<y;p++)(d=m[p]).yj().q$a=!0,d.formulaFromJSON(g[d.name()],t,n)}for(M&&(e.noRecalc||n&&n.doNotRecalculateAfterLoad?M.resumeWithoutCalc():M.resume(!0)),C=0,w=m;C<w.length;C++)(x=(d=w[C]).yj()).HIb(),delete x.q$a},egc:function(e,t,n){var o,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b=this,C=b.Wu;if(C&&C.suspend(),b.clearCustomNames(),o=e.names)for(i=0;i<o.length;i++)a=o[i],b.Yu(this.Tu,a.name,a.formula,a.row,a.col,!0,a.comment);if(b.clearCustomFunctions(),s=e.customFunctions)for(l in s)s.hasOwnProperty(l)&&(u=s[l],(c=r.getTypeFromString(u.typeName))&&((f=new c).fromJSON(u,t),b.Xu(f)));if(d=e.sheets,g=[],d){for(y in h=0,d)"string"==typeof y&&(v=d[y],p=b.getSheetFromName(v.name||y),g.push(p),p.nameFunctionsFromJSON(v,t,n),h++);for(m=g.length,h=0;h<m;h++)(p=g[h]).yj().q$a=!0,p.formulaFromJSON(d[p.name()],t,n)}n.incrementLoadTask.addTask((function(t,o,r){var i,a,s;for(C&&(e.noRecalc||n&&n.doNotRecalculateAfterLoad?C.resumeWithoutCalc():C.resume(!0)),i=0,a=g;i<a.length;i++)(s=(p=a[i]).yj()).HIb(),delete s.q$a}),[C,e,n])}})},"./dist/plugins/sheetsCalc/worksheet-formula.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y;function v(e){return e.Cf()}function b(){var e=this;return e.Ru?void(e.Ru=!1):(e._functions={},e.Tu={},e.eDc?e.eDc.clearAll():e.fDc=new s.SheetSource(e,o.SheetArea.colHeader),e.gDc?e.gDc.clearAll():e.hDc=new s.SheetSource(e,o.SheetArea.rowHeader),void(e.et?e.et.clearAll():e.ft=new s.SheetSource(e,o.SheetArea.viewport)))}function C(e,t,n,o,r,i){var a=e.Ms(t,n,o,r,i),s=a&&a.formulas;return s&&s.length>0}function w(e,t,n,o,r,i){var a,s=o.yj(),l=e&&e.formula;l&&(l=l.replace(/ANCHORARRAY\(([A-Z]+[0-9]+)\)/gi,"$1#").replace(/SINGLE\((.*)\)/gi,"@$1").replace(/ANCHORARRAY\((#[A-Z]+[\?!])\)/gi,"$1#"),(a=e.arrayInfo)&&!a.isDynamicArray?o.bv(t,n,m(a.rowCount,10),m(a.colCount,10),l,!0,i):(a&&a.isInvalid&&s.GIb(t,n),o._u(t,n,l,u,!0,i,!0,!a)))}function x(e,t,n,o,r,i,a){var s,l,u,c,f,h,p,d=r&&r.incrementLoadTask;if(d&&!d.isTerminated){for(s=d.isBusyFunc,l=i=i||0,e.suspendPaint(),30,u=new Date;l<n;){if(c=t[l])for(f=0;f<o;f++)w(c[f],l,f,e,0,a);if(l++,s&&s())break;if(new Date-u>30)break}e.resumePaint(),r||(r={}),(h=r&&r.incrementalLoading)&&h.loading&&(h.loadStatus.formulaLoad+=l-i,p=function(e,t){var n=e.formulaLoad/e.total;return t?.4*n+.5:.3*n+.4}(h.loadStatus,r.doNotRecalculateAfterLoad),h.loading(p)),l<n&&r.incrementLoadTask.pushTask(x,[e,t,n,o,r,l])}}function A(e,t,n,r){var i=o.Worksheet._features;i&&f(i,(function(o,i){var a=i.fromJsonAfterFormula;a&&a.call(e,t,n,r)}))}function M(e,t,n,o,r){var i,a,s,l,u,c,h,p;if(e.parent&&e.parent.sheets)for(l=e.parent.sheets,u=e.parent.getCustomNames(),c=e.parent.ELb(),u&&f(u,(function(i,l){a=l.getExpression(),(s=S(null,e,t,n,o,r,a))!==a&&l.fg(s)})),c&&f(c,(function(i,l){a=l.getExpression(),(s=S(null,e,t,n,o,r,a))!==a&&l.fg(s)})),h=function(u){(i=l[u].getCustomNames())&&f(i,(function(i,c){a=c.getExpression(),(s=S(l[u],e,t,n,o,r,a))!==a&&c.fg(s)}))},p=0;p<l.length;p++)h(p);else(i=e.getCustomNames())&&f(i,(function(i,l){a=l.getExpression(),(s=S(e,e,t,n,o,r,a))!==a&&l.fg(s)}))}function S(e,t,n,o,r,i,s){var l,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,T,N,I,R,k,E,D,j,_,O,F,P,H=t.yj(),B=a.Hh(a.Errors.Reference,H);if(9===s.type){if(c=s.value,f=s.value2,h=S(e,t,n,o,r,i,c),p=f&&S(e,t,n,o,r,i,f),c!==h||f!==p)return a.Kh(s.operatorType,h,p)}else if(7===s.type){for(d=!1,g=[],m=void 0,y=0;y<s.arguments.length;y++)v=S(e,t,n,o,r,i,m=s.arguments[y]),d=d||m!==v,g.push(v);if(d)return a.Jh(s,g)}else if(1===s.type&&s.sf()){if(l=s.source||e&&e.yj(),w=b=s.row,x=C=s.column,l&&l===H&&(i&&!s.rowRelative||!i&&!s.columnRelative)){if(i&&r)b+=b>=n?o:0;else if(!i&&r)C+=C>=n?o:0;else if(i){if(b>=n+o)b-=o;else if(b>=n)return B}else if(C>=n+o)C-=o;else if(C>=n)return B;if(b!==w||C!==x)return a.rf(H,u,b,C,s.rowRelative,s.columnRelative)}}else if(1===s.type){if(l=s.source||e&&e.yj(),A=s.row,M=s.column,T=s.endRow,N=s.endColumn,I=s.rowRelative,R=s.columnRelative,k=s.endRowRelative,E=s.endColumnRelative,D=A,j=M,_=T,O=N,l&&l===H){if(i&&r)A+=!I&&A>=n?o:0,T+=!k&&T>=n?o:0;else if(!i&&r)M+=!R&&M>=n?o:0,N+=!E&&N>=n?o:0;else if(i&&!r){if(!I&&A>=n&&!k&&T<n+o)return B;if(I&&k||T<n)return s;if(!I)if(A>=n+o)A-=o;else if(A<n);else{if(k)return B;A>n&&(A=n)}if(!k)if(T>=n+o)T-=o;else{if(I)return B;T<n+o&&(T=n-1)}}else{if(!R&&M>=n&&!E&&N<n+o)return B;if(R&&E||N<n)return s;if(!R)if(M>=n+o)M-=o;else if(M<n);else{if(E)return B;M>n&&(M=n)}if(!E)if(N>=n+o)N-=o;else{if(R)return B;N<n+o&&(N=n-1)}}if(M!==j||N!==O||A!==D||T!==_)return a.uf(H,u,A,M,T,N,I,R,k,E)}}else if(10===s.type){if((F=s.value)!==(P=S(e,t,n,o,r,i,F)))return a.Lh(P)}else 13===s.type&&((l=s.source||e&&e.yj())&&l===H&&!i&&(s=s.offsetWhenInsertRemoveColumn(n,o,r)));return s}function T(e,t){var n,o,r,i,a,s,l,u=t.ah,c=u.getSource(),f=-1,h=-1;t.name?(o=t.name,i=t.id,g(i)?n=u.getNodeByName(o):(n={Lf:t.expression},r=!0)):(f=void 0===(f=t.row)?-1:f,h=void 0===(h=t.column)?-1:h,n=u.getNode(f,h)),a=n.Lf,s=n.Pf,l=e.unparse(c,a,f<0?0:f,h<0?0:h),s&&(!0!==e.allowDynamicArray||!0===e.allowDynamicArray&&!s.isDynamicArray)?f===s.row&&h===s.col&&u.setArrayFormula(s.row,s.col,s.rowCount,s.colCount,l):o?r?u.setFormula(i,o,l):u.setFormulaByName(o,l):u.setFormula(f,h,l,null,!0,!0),n.Lf.ehc=a.ehc}function N(e){var t,n,r,i,s,l,u,c,f,h,p=v(e),d=[p.getSourceModel(e.yj(o.SheetArea.colHeader)),p.getSourceModel(e.yj(o.SheetArea.rowHeader)),p.getSourceModel(e.yj())];for(t=0;t<d.length;t++){if(!(n=d[t]))return;for(r=n.getAllNodes(),i=0;i<r.length;i++)if(s=r[i].calc)for(l=s.Ze,u=void 0,c=0;c<l.length;c++)if(f=s[l[c]])for(h in f)(u=f[h])&&u instanceof a.PathCalc&&T(p,u)}}function I(e,t){var n=e.offset(0,0,!1,0,0);return n.rowRelative=n.endRowRelative=n.columnRelative=n.endColumnRelative=t,n}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("Core"),i=n("@grapecity/js-sheets-common"),a=n("@grapecity/js-calc"),s=n("./dist/plugins/sheetsCalc/calc-spreadjs.js"),l=n("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),u=null,c=void 0,f=o.GC$.each,h=i.Common.u.Nb,p=new i.Common.ResourceManager(o.SR),d=p.getResource.bind(p),g=i.Common.j.Fa,m=parseInt,(y=o.Worksheet.prototype).resetCalc=function(){b.call(this),this.Ru=!0},y.recalcAll=function(e){var t,n,o,r,i,a,s,l,u,c,f,h,p,d,g=v(this);if(g){if(this.suspendPaint(),g.suspend(!0),e)for(void 0,n=(t=this.parent)&&t.sheets||[this],o=0;o<n.length;o++){if(i=(r=n[o]).Tu,a=r.yj(),i)for(s in i)u=(l=i[s]).Lf,c=g.unparse(a,u,0,0),l.Lf=g.parse(a,c,0,0);for(f=a.getCalcSourceModel().getAllNodes(),h=0;h<f.length;h++)(d=(p=f[h]).calc)&&p.Lf&&T(g,d)}g.resume(!0),this.resumePaint()}},y.recalcRange=function(e,t,n,o){var r=v(this);r&&r.recalcRange(this.yj(),e,t,n,o)},y.recalcRows=function(e){var t,n=v(this);if(n&&!n.ignoreDirty()){for(n.suspend(),t=0;t<e.length;t++)n.recalculate(this.ft,e[t],-1);n.resume(!1)}},y.recalcCols=function(e){var t,n=v(this);if(n&&!n.ignoreDirty()){for(n.suspend(),t=0;t<e.length;t++)n.recalculate(this.ft,-1,e[t]);n.resume(!1)}},y.zq=function(e,t,n){var o,r=v(this);r&&!r.ignoreDirty()&&(o=this.ft,1===n?o=this.fDc:2===n&&(o=this.hDc),r.recalculate(o,e,t))},y.getCalcService=function(){return this.Wu||(this.Wu=new a.CalcService,this.yj(o.SheetArea.colHeader).setCalcService(this.Wu),this.yj(o.SheetArea.rowHeader).setCalcService(this.Wu),this.yj().setCalcService(this.Wu),this.Wu.initParserContext(this.yj())),this.Wu},y.Cf=function(){return this.getCalcService()},y.suspendCalcService=function(e){var t=v(this);t&&t.suspend(e)},y.resumeCalcService=function(e){var t=v(this);t&&t.resume(e)},y.yj=function(e){return g(e)||3===e?this.ft:1===e?this.fDc:2===e?this.hDc:u},y.Bj=function(e){var t=this;return 1===e?(!t.eDc&&t.fDc&&(t.eDc=t.Cf().getSourceModel(t.fDc)),t.eDc):2===e?(!t.gDc&&t.hDc&&(t.gDc=t.Cf().getSourceModel(t.hDc)),t.gDc):(!t.et&&t.ft&&(t.et=t.Cf().getSourceModel(t.ft)),t.et)},y.iDc=function(e,t,n,o,r){var i=this.Bj(r);return i&&i.tg(e,t,n,o,!0,!0)},y.Ns=function(e,t,n,o,r,i){var a=this.iDc(e,t,n,o,3);return!a&&r&&(o=this.getColumnCount(2),a=this.iDc(e,0,n,o,2)),!a&&i&&(n=this.getRowCount(1),a=this.iDc(0,t,n,o,1)),a},y.Ms=function(e,t,n,o,r){var i=this.Bj(r);return i&&i.tg(e,t,n,o,!1,!0)},y.Vq=function(e,t,n,o,r,i,a){var s,l;return void 0===r&&(r=!0),s=r&&this.Ns(e,t,n,o,i,a),l=!r&&function(e,t,n,o,r,i,a){var s=C(e,t,n,o,r,3);return!s&&i&&(r=e.getColumnCount(2),s=C(e,t,0,o,r,2)),!s&&a&&(o=e.getRowCount(1),s=C(e,0,n,o,r,1)),s}(this,e,t,n,o,i,a),!s&&!l||(this.Os(4,d().Exp_ChangePartOfArray),!1)},y.addCustomFunction=function(e){this.Xu(e),this.recalcAll()},y.Xu=function(e){if(!(e&&e instanceof a.Functions.Function))throw Error(d().Exp_InvalidCustomFunction);this._functions[h(e.name)]=e},y.getCustomFunction=function(e){return e?this._functions[h(e)]:u},y.removeCustomFunction=function(e){e&&(delete this._functions[h(e)],this.recalcAll())},y.clearCustomFunctions=function(){this._functions={},this.recalcAll()},y.Pu=function(e){var t,n;return e?(this,t=this.parent,!(n=this.getCustomFunction(e))&&t&&t.getCustomFunction&&(n=t.getCustomFunction(e)),n):u},y.addCustomName=function(e,t,n,o,r){this.Yu(e,t,n,o,!1,r)},y.getCustomName=function(e){return e?this.Tu[h(e)]:c},y.getCustomNames=function(){var e=[];return f(this.Tu,(function(t,n){e.push(n)})),e},y.removeCustomName=function(e){var t,n;e&&(t=h(e),delete this.Tu[t],(n={})[t]=t,this.Zu(n,!1))},y.clearCustomNames=function(){var e=this.Tu;this.Tu={},this.Zu(e,!1)},y.createNameInfo=function(e,t,n,o,r){var i,a=v(this),l=this.yj();return a&&l?(i=a.parse(l,t,o,r),new s.NameInfo(e,i,o,r,n)):u},y.H$a=function(e){var t,n=!this.Tu[h(e)];return n&&((t=this.tables)&&(n=!t.findByName(e))),n},y.isValidCustomName=function(e){return e&&o.Ul.G$a(e)&&this.H$a(e)},y.Yu=function(e,t,n,o,r,i){var a,l,u,c,f=this;if(!e||!t||!r&&!f.isValidCustomName(e))throw Error(d().Exp_InvalidCustomName);if(a=v(f),l=f.yj(),a&&l){if(u=void 0,r)try{u=a.parse(l,t,n,o,!1,!1,!0)}catch(e){}else u=a.parse(l,t,n,o);f.Tu[h(e)]=new s.NameInfo(e,u,n,o,i),r||((c={})[e]=e,this.Zu(c,!0))}},y.Zu=function(e,t){var n,o=this.Bj();if(o){for(n in e)o.updateNameCalc(n,t);this.recalcAll()}},y.$u=function(e){var t,n;return e?(this,t=this.parent,!(n=this.getCustomName(e))&&t&&t.getCustomName&&(n=t.getCustomName(e)),n):u},y.setFormula=function(e,t,n,o){this._u(e,t,n,u,!1,o)},y._u=function(e,t,n,o,r,i,a,s,l){var f,h,p,m,y,v,b,C,w=this;return g(i)&&(i=3),e<0||e>=w.getRowCount(i)||t<0||t>=w.getColumnCount(i)?void w.Os(0,d().Exp_IndexOutOfRange):(f=e>=0?e:0,h=t>=0?t:0,p=w.yj(i),o=o||(n&&w.Wu?w.Wu.parse(p,n,f,h,!1,r,r):u),s&&(o.ensureSingle=!0),m=w.tables,void(3===i&&e>=0&&t>=0&&m&&!m.Hma(e,t,1,1,n,o)||(y=w.Bj(i),v=w.conditionalFormats,y&&(b=y.getFormula(e,t),C=w._modelManager,y.setFormula(e,t,n,o,r,c,C.dUa(),l),v&&v.Nm(),a||w.Bq("formula",e,t,i,b,n)),w.t4&&w.t4(e,t,1,1,i),w.$p())))},y.setArrayFormula=function(e,t,n,o,r,i){this.bv(e,t,n,o,r,!1,i)},y.bv=function(e,t,n,o,r,i,a,s){var l,u,c,f,h,p,g;if(void 0===a&&(a=3),l=this,e<0||e+n>l.getRowCount()||t<0||t+o>l.getColumnCount())l.Os(0,d().Exp_IndexOutOfRange);else if(l._modelManager.MTa(e,t,n,o))l.Os(0,d().Exp_ArrayFormulaSpan);else if(u=l.tables,!(3===a&&e>=0&&t>=0&&u)||u.Hma(e,t,n,o,r)){if(c=l.Bj(a),f=l.conditionalFormats,c&&(l.suspendEvent(),c.setArrayFormula(e,t,n,o,r,i,l._modelManager.dUa(),s),l.resumeEvent(),f&&f.Nm(),l.jm<1)){for(h=[],p=e;p<e+n;p++)for(g=t;g<t+o;g++)h.push({row:p,col:g});l.Bu(e,t,n,o,h,5,a,r)}l.$p()}},y.getFormula=function(e,t,n,o){var r=this.Bj(n);return r?r.getFormula(e,t,o):u},y.Ima=function(e,t,n){var o=this.Bj(n);return o?o.Kf(e,t):u},y.getFormulaInformation=function(e,t){var n,r,i,a,s,l={},u=this.Bj();return u&&((n=u.Kf(e,t))?(r=u.Qf(e,t),l.hasFormula=!0,r&&!r.isDynamicArray&&(l.baseRange=new o.Range(r.row,r.col,r.rowCount,r.colCount)),l.isArrayFormula=r&&!r.isDynamicArray,e=r?r.row:e,t=r?r.col:t,l.formula=this.Wu.unparse(this.ft,n,e,t),l.formulaWithCulture=this.Wu.unparse(this.ft,n,e,t,!0),l.hasFormula=!!l.formula):(i=this._modelManager.getDynamicArrayInfo(e,t))&&i.isValid&&(a=i.row,s=i.col,e===a&&t===s||(n=u.Kf(a,s),l.formulaWithCulture=this.Wu.unparse(this.ft,n,a,s,!0),l.hasFormula=!0,l.isDynamicArray=!0))),l},y.ngc=function(e,t,n,o,r,i){var a,s,l,u,c,f,h,p,d,g,m,y;for(n||(n=this,o=e,r=t,i=[]),a=n.getDependents(o,r),s=this.name(),l=0;l<a.length;l++){if(i[c=(u=a[l]).sheetName+"_"+u.row+"_"+u.col+"_"+u.rowCount+"_"+u.colCount])return!1;if(i[c]=!0,(u.row<=e&&e<u.row+u.rowCount||-1===u.rowCount)&&(u.col<=t&&t<u.col+u.colCount||-1===u.colCount)&&s===u.sheetName)return!0;for(f=u.sheetName===s?n:n.parent.getSheetFromName(u.sheetName),h=u.rowCount,p=u.row,d=u.colCount,g=u.col,-1===h&&(h=f.getRowCount(),p=0),-1===d&&(d=f.getColumnCount(),g=0),m=p;m<h+p;m++)for(y=g;y<d+g;y++)if(this.ngc(e,t,f,p,g,i))return!0}return!1},y.getPrecedents=function(e,t){var n,o,r,i,a=[],s=this.Bj();return s&&(n=s.Mf(e,t)||s.Kf(e,t),r=(o=this.getFormulaInformation(e,t).baseRange)?o.row:e,i=o?o.col:t,this.VGb(n,r,i,a),a=function(e){var t,n,o,r=[],i=[];for(t=0;t<e.length;t++)o=""+(n=e[t]).row+n.col+n.rowCount+n.colCount+n.sheetName,r.indexOf(o)<0&&(r.push(o),i.push(n));return i}(a)),a},y.getDependents=function(e,t){var n,o,r,i,a,s,l,u=[],c=this.Bj().qg(e,t),f=this.Bj().ug();if(c)for(o in n=c[0])n.hasOwnProperty(o)&&(a=(i=(r=n[o]).ah._source)?i.kj.name():this.name(),u.push({row:r.row,col:r.column,rowCount:1,colCount:1,sheetName:a}));if(f)for(o in s=f[0])s.hasOwnProperty(o)&&((-1===(l=s[o]).row||l.row<=e&&e+1<=l.row+l.rowCount)&&(-1===l.col||l.col<=t&&t+1<=l.col+l.colCount)&&(a=(i=(r=l[0]).ah._source)?i.kj.name():this.name(),u.push({row:r.row,col:r.column,rowCount:1,colCount:1,sheetName:a})));return u},y.VGb=function(e,t,n,o){var r,i,s,l,u;if(e)switch(e.type){case a.ExpressionType.reference:case a.ExpressionType.structReference:case a.ExpressionType.spillReference:r=e.getRange(t,n),o.push({row:r.row,col:r.col,rowCount:r.rowCount,colCount:r.colCount,sheetName:e.source&&e.source.kj?e.source.kj.name():this.name()});break;case a.ExpressionType.operator:this.VGb(e.value,t,n,o),this.VGb(e.value2,t,n,o);break;case a.ExpressionType.expand:case a.ExpressionType.parentheses:this.VGb(e.value,t,n,o);break;case a.ExpressionType.name:i=this.$u(e.value),this.VGb(i.getExpression(),t,n,o);break;case a.ExpressionType.function:for(s=e.arguments,l=0;l<s.length;l++)u=s[l],this.VGb(u,t,n,o)}},y.hasFormula=function(e,t){var n=this.Bj();return!!n&&n.hasFormula(e,t)},y.dv=function(){var e,t,n,o,r,i=this.Bj();if(i)for(e=0,t=i.rC(),n=i.cC();e<t;){for(o=0;o<n;)(r=i.qg(e,o))&&(r.ng(),r.og()),o++;e++}},y.clearFormula=function(e,t,n,o,r){var i,a,s=this;for(e<0&&(e=0,n=s.getRowCount()),t<0&&(t=0,o=s.getColumnCount()),i=0;i<n;i++)if(r(s,i+e))for(a=0;a<o;a++)s.setFormula(i+e,a+t,u)},y.nameFunctionsFromJSON=function(e,t,n,o){var i,a,s,l,u,c,f,h,p;if(e){if(i=this,a=e.customFunctions)for(s in a)a.hasOwnProperty(s)&&(l=a[s],(u=r.getTypeFromString(l.typeName))&&((c=new u).fromJSON(l,t),i.Xu(c)));if((f=e.names)&&f.length>0){for(h=0;h<f.length;h++)p=f[h],i.Yu(p.name,p.formula,p.row,p.col,!0,p.comment);i.dv()}o&&o()}},y.formulaFromJSON=function(e,t,n){var o,r,i;e&&(o=this,r=n&&n.ignoreFormula,i=n&&n.incrementalLoading,[e.colHeaderData,e.rowHeaderData,e.data].forEach((function(e,t){var a,s,l,u;e&&!r&&e.dataTable&&(a=t+1,s=e.dataTable,l=o.getRowCount(a),u=o.getColumnCount(a),i?x(o,s,l,u,n,0,a):function(e,t,n,o,r){var i,a,s;for(i=0;i<n;i++)if(a=t[i])for(s=0;s<o;s++)w(a[s],i,s,e,0,r)}(o,s,l,u,a))})),i?n.incrementLoadTask.pushTask(A,[o,e,t,n]):A(o,e,t,n))},y.ev=function(e){var t=this,n=t.Wu;n&&!e||(t.Wu=e||new a.CalcService,t.yj(o.SheetArea.colHeader).setCalcService(t.Wu),t.yj(o.SheetArea.rowHeader).setCalcService(t.Wu),t.yj(o.SheetArea.viewport).setCalcService(t.Wu),t.Wu.initParserContext(t.yj()),n?(e.setSourceModel(t.fDc,n.getSourceModel(t.fDc)),e.setSourceModel(t.hDc,n.getSourceModel(t.hDc)),e.setSourceModel(t.ft,n.getSourceModel(t.ft))):(t.eDc=t.Wu.getSourceModel(t.fDc),t.gDc=t.Wu.getSourceModel(t.hDc),t.et=t.Wu.getSourceModel(t.ft)))},y.setCalc=function(e,t){this.Wu=e,this.ft=t||this.ft,this.et=e.getSourceModel(this.ft),this.parent&&(this.parent.Wu=e)},y.fv=function(){this._endEditImp(!1,1)},y.mUa=function(e,t){var n,r,i,a,s,l,u,c,f=this,h=e.changeType,p=e.row,d=e.rowCount,g=e.col,m=e.colCount,y=f.Bj();y&&(r=(n=f._modelManager).dUa(),i=v(y),a=y._source,s=i.ih(),l=i.lh.asyncManager,"addingRows"===h?f.Vq(p,0,0,f.getColumnCount(),void 0,!0,!1)?(u=f.Bj(2),s.onBeforeAddRemoveRows(y,p,u),t||o.clearSpillValuesOnAddRemove(n,p,d,!0,!0),M(f,p,d,!0,!0),[y,u].forEach((function(e){e.addRows(p,d)})),l.addRows(a,p,d)):e.canAdd=!1:"addRows"===h?(i.suspend(),u=f.Bj(2),s.onAfterAddRemoveRows(y,p,d,!0,t,u),i.resume(!1),r&&r.push({type:"addRows",row:p,rowCount:d})):"deletingRows"===h?f.Vq(p,0,d,f.getColumnCount(),void 0,!0,!1)?(u=f.Bj(2),s.onBeforeAddRemoveRows(y,p,u),t||o.clearSpillValuesOnAddRemove(n,p,d,!1,!0),M(f,p,d,!1,!0),[y,u].forEach((function(e){e.deleteRows(p,d)})),l.deleteRows(a,p,d)):e.canDelete=!1:"deleteRows"===h?(i.suspend(),u=f.Bj(2),s.onAfterAddRemoveRows(y,p,d,!1,t,u),i.resume(!1),r&&r.push({type:"deleteRows",row:p,rowCount:d})):"addingColumns"===h?f.Vq(0,g,f.getRowCount(),0,void 0,!1,!0)?(c=f.Bj(1),s.onBeforeAddRemoveColumns(y,g,c),t||o.clearSpillValuesOnAddRemove(n,g,m,!0,!1),M(f,g,m,!0,!1),[y,c].forEach((function(e){e.addColumns(g,m)})),l.addColumns(a,p,d)):e.canAdd=!1:"addColumns"===h?(i.suspend(),c=f.Bj(1),s.onAfterAddRemoveColumns(y,g,m,!0,t,c),i.resume(!1),r&&r.push({type:"addColumns",col:g,colCount:m})):"deletingColumns"===h?f.Vq(0,g,f.getRowCount(),m,void 0,!1,!0)?(c=f.Bj(1),s.onBeforeAddRemoveColumns(y,g,c),t||o.clearSpillValuesOnAddRemove(n,g,m,!1,!1),M(f,g,m,!1,!1),[y,c].forEach((function(e){e.deleteColumns(g,m)})),l.deleteColumns(a,p,d)):e.canDelete=!1:"deleteColumns"===h&&(i.suspend(),c=f.Bj(1),s.onAfterAddRemoveColumns(y,g,m,!1,t,c),i.resume(!1),r&&r.push({type:"deleteColumns",col:g,colCount:m})))},y.nUa=function(e,t,n){var o=n.type,r=this;"addRows"===o?(n.changeType="deletingRows",r.mUa(n,!0),n.changeType="deleteRows",r.mUa(n,!0)):"deleteRows"===o?(n.changeType="addingRows",r.mUa(n,!0),n.changeType="addRows",r.mUa(n,!0)):"addColumns"===o?(n.changeType="deletingColumns",r.mUa(n,!0),n.changeType="deleteColumns",r.mUa(n,!0)):"deleteColumns"===o?(n.changeType="addingColumns",r.mUa(n,!0),n.changeType="addColumns",r.mUa(n,!0)):"customName"===o?n.nameInfo.fg(n.expr):"condition"===o&&n.condition.setExpressions(n.expressions)},y.gUa=function(e){var t,n=v(this),o=this.Bj();for(n.suspend();e.length;)(t=e.pop()).type?this.nUa(n,o,t):o.$Va.apply(o,t);n.resume(!1)},y.getReferenceRange=function(e){var t,n=this.yj(),r=this.getCalcService().evaluate(n,e,0,0,!0);if(r instanceof a.CalcReference&&(t=r.getSource().getName(),r.getRangeCount()>0))return 0,{sheetName:t,range:o.kf(r.getRow(0),r.getColumn(0),r.getRowCount(0),r.getColumnCount(0))}},t.kDc=M,t.vyb=function(e,t,n,o,r,i,a,s,u){l.CalcOperatorAdjustor.copyFormula(e.Bj(),t,n,o.Bj(),r,i,a,s,u)},t.uyb=function e(t,n,o,r,i,s,u,c,f,h){var p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,R,k,E;if(9===h.type){if(p=h.value,d=h.value2,g=e(t,n,o,r,i,s,u,c,f,p),m=d&&e(t,n,o,r,i,s,u,c,f,d),p!==g||d!==m)return a.Kh(h.operatorType,g,m)}else if(7===h.type){for(y=!1,v=[],b=void 0,C=0;C<h.arguments.length;C++)w=e(t,n,o,r,i,s,u,c,f,b=h.arguments[C]),y=y||b!==w,v.push(w);if(y)return a.Jh(h,v)}else if(1===h.type){if(x=!function(e){return e.rowRelative}(h)&&!function(e){return e.columnRelative}(h),A=!function(e){return e.endRowRelative}(h)&&!function(e){return e.endColumnRelative}(h),M=n.yj(),(!h.source||h.source===M)&&x&&A)return S=i.yj(),T=new l.MoveSwapInfo(M,o,r,S,s,u,c,f),N=I(h,!0),(R=l.adjustFormulaOnMoveSwap(M,0,0,N,T,!0))===N?h:1===R.type&&I(R,!1)||R}else if(10===h.type&&(k=h.value)!==(E=e(t,n,o,r,i,s,u,c,f,k)))return a.Lh(E);return h},o.Worksheet.$n("calc",{priority:1e3,init:b,dispose:function(e){var t,n,o,r=this;!1!==e.clearCache&&(r.ft=u,r.hDc=u,r.fDc=u,r.Wu=u,(t=r.et)&&(!0===e.isSheetDestroy?t.eHb():t.rzb(),r.et=u),(n=r.gDc)&&(!0===e.isSheetDestroy?n.eHb():n.rzb(),r.gDc=u),(o=r.eDc)&&(!0===e.isSheetDestroy?o.eHb():o.rzb(),r.eDc=u))},attach:function(e){e instanceof o.Workbook?this.ev(e.Wu):this.ev()},onLayoutChanged:function(e){this.Cf().isAdjustSuspended()||this.mUa(e)},toJson:function(e,t){var n,r,i,a,s=this,l=s._functions;o.GC$.isEmptyObject(l)||(e.customFunctions=l),n=[],r=s.getCustomNames(),i=v(s),r&&i&&(f(r,(function(e,t){var o,r=t.getName(),a=t.getRow(),l=t.getColumn(),u=t.getExpression(),c=t.getComment();u&&(o={name:r,formula:i.unparse(s.yj(),u,a,l,!1,!0,!0),row:a,col:l},c&&(o.comment=c),n.push(o))})),n.length>0&&(e.names=n)),t&&t.ignoreFormula||(a=[s.et,s.eDc,s.gDc],[e.data,e.colHeaderData,e.rowHeaderData].forEach((function(e,t){var n=a[t];n&&n.toJSON({data:e})})))},fromJson:function(e,t,n,o){var r=this;n&&n.incrementalLoading||(r.clearCustomFunctions(),r.clearCustomNames()),o&&(r.nameFunctionsFromJSON(e,t,n),r.formulaFromJSON(e,t,n))},setName:function(e){N(this),v(this.Bj()).lh.asyncManager.changeSourceName(e.oldName,e.newName)},beforeSetName:function(){this.uja&&(this.parent||this).tja()}})},"./dist/plugins/sparkline/functions-sparkline.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function re(e){return 0===e}function ie(e){return 0===e||2===e}function ae(e){return ie(e)||8===e}function se(e,t){var n,o,r,i,a,s,l,u,h,p,d=[];if(c(e))for(n=0,o=e.getRangeCount();n<o;n++)for(r=e.getRowCount(n),i=e.getColumnCount(n),a=0;a<r;a++)for(s=0;s<i;s++)d.push(e.getValue(n,a,s));else if(t&&f(e))for(l=e.getRowCount(),u=e.getColumnCount(),h=0;h<l;h++)for(p=0;p<u;p++)d.push(e.getValue(h,p));return d}function le(e,t){var n,o,r,i,a=[];if(c(e)&&e.getRangeCount()>t)for(n=e.getRowCount(t),o=e.getColumnCount(t),r=0;r<n;r++)for(a[r]=[],i=0;i<o;i++)a[r].push(e.getValue(t,r,i));return a}function ue(e){var t;return c(e)?t=e.getValue(0,0,0):d(e)||(t=e),t}function ce(e,t){function n(e){return new r.Range(e.getRow(0),e.getColumn(0),e.getRowCount(0),e.getColumnCount(0))}var o=new h(e,2,5);return o.evaluate=function(e){var o,r,i,s,l,u,f,h,p,g,m,y,v=e[0];if(c(v)&&v.getRangeCount()>0){for(g in o=n(v),r=v.getSource().getSheet().name(),i=e[1],s=e[2],l=void 0,u=void 0,f=void 0,c(s)&&(f=s.getSource().getSheet().name(),s.getRangeCount()>0&&(l=n(s),u=e[3])),h=function(e){var t,n,o,r,i,a={},s=!1,l=!0,u="",c="";if(e){for(t=0,n=(e=e.substr(1,e.length-2)).length;t<n;t++)":"===(o=e.charAt(t))?l=!1:","!==o||s?"'"===o||'"'===o||("("===o?s=!0:")"===o&&(s=!1),l?u+=o:c+=o):(a[u]=c,u="",c="",l=!0);for(r in u&&(a[u]=c),a)a.hasOwnProperty(r)&&(i=a[r],d(i)||("TRUE"===i.toUpperCase()?a[r]=!0:"FALSE"===i.toUpperCase()?a[r]=!1:!C(i)&&isFinite(i)&&(a[r]=w(i))))}return a}(e[4]||"{}"),p={ac:"axisColor",fmc:"firstMarkerColor",hmc:"highMarkerColor",lastmc:"lastMarkerColor",lowmc:"lowMarkerColor",mc:"markersColor",nc:"negativeColor",sc:"seriesColor",deca:"displayEmptyCellsAs",rtl:"rightToLeft",dh:"displayHidden",dxa:"displayXAxis",sf:"showFirst",sh:"showHigh",slast:"showLast",slow:"showLow",sn:"showNegative",sm:"showMarkers",mmax:"manualMax",mmin:"manualMin",maxat:"maxAxisType",minat:"minAxisType",lw:"lineWeight"})p.hasOwnProperty(g)&&h.hasOwnProperty(g)&&(h[p[g]]=h[g]);return 1===(y=(m=new a.SparklineSetting(h)).options).maxAxisType&&(y.maxAxisType=0),1===y.minAxisType&&(y.minAxisType=0),{data:o,dataSheetName:r,dataOrientation:i,dateAxisData:l,dateAxisDataSheetName:f,dateAxisOrientation:u,sparklineType:t,displayDateAxis:l&&!d(u),setting:m,values:le(v,0),dateValues:le(s,0)}}},o.acceptsReference=ie,o}function fe(e,t,n,o,i,s,l){var u,c,f=a.Sparkline.cT,h=l.sheet,p=h.parent.getSheetFromName(t.dataSheetName),d=h.parent.getSheetFromName(t.dateAxisDataSheetName),g=t.setting;g&&g.options||(g=new a.SparklineSetting(g)),u=g.options.displayHidden,c={sparklineType:t.sparklineType,displayDateAxis:t.displayDateAxis,zoomFactor:l.zoomFactor,values:f(t.values,p||h,u,t.data,t.dataOrientation),dateValues:f(t.dateValues,d||h,u,t.dateAxisData,t.dateAxisOrientation,!0),settings:g,getColor:function(e){if(h&&e){var t=r.Rm.Om(h,e);if(t)return t}return e}},(new y).paint(e,c,n,o,i,s)}function he(e){e&&(ne[e.name()]=e)}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-calc"),r=n("Core"),i=n("@grapecity/js-sheets-common"),a=n("./dist/plugins/sparkline/sparkline-wrapper.js"),c=o.Convert._isReference,f=o.Convert.Ca,h=o.Functions&&o.Functions.Function,p=o.Functions&&o.Functions.bi,d=i.Common.j.Fa,(g=r.GC$).inherit,m=g.extend,y=i.Sparklines.SparklineRender,v=i.Sparklines.SparklineExRenders,b=null,C=isNaN,w=parseFloat,x="PIESPARKLINE",A="AREASPARKLINE",M="SCATTERSPARKLINE",S="BULLETSPARKLINE",T="SPREADSPARKLINE",N="STACKEDSPARKLINE",I="HBARSPARKLINE",R="VBARSPARKLINE",k="VARISPARKLINE",E="BOXPLOTSPARKLINE",D="CASCADESPARKLINE",j="PARETOSPARKLINE",_="MONTHSPARKLINE",O="YEARSPARKLINE",F=function(){function e(e,t){this.name=e,this.value=t,this.typeName="SparklineExValue"}return e.prototype.toString=function(){return""},e}(),t.SparklineExValue=F,P=function(){function e(){var e,t,n=this.createFunction();n&&(e=n.name,t=n.evaluate,n.evaluate=function(){var n=t.call(this,arguments);return n instanceof o.CalcError?n:n?new F(e,n):b},this.Cj=e,e&&!o.Functions.findGlobalFunction(e)&&(o.Functions.ci[e]=n)),this.typeName=""}return e.prototype.name=function(){return this.Cj},e.prototype.createFunction=function(){return b},e.prototype.paint=function(e,t,n,o,r,i,a){},e.prototype.toJSON=function(){var e,t={};for(e in this)this.hasOwnProperty(e)&&(t[e]=this[e]);return t},e.prototype.fromJSON=function(e){if(e)for(var t in e)d(e[t])||(this[t]=e[t])},e}(),t.SparklineEx=P,H=function(e){function t(){return e.call(this)||this}return oe(t,e),t}(P),t.PieSparkline=H,m(H.prototype,{createFunction:function(){var e=new h(x,1,255);return e.evaluate=function(e){var t=e[0],n=se(t);return n.length<=0&&!d(t)&&n.push(t),{values:n,colors:Array.prototype.slice.call(e,1)}},e.acceptsReference=re,e},paint:v[x]}),B=function(e){function t(){return e.call(this)||this}return oe(t,e),t}(P),t.AreaSparkline=B,m(B.prototype,{createFunction:function(){var e=new h(A,1,7);return e.evaluate=function(e){return{points:se(e[0]),mini:e[1],maxi:e[2],line1:e[3],line2:e[4],colorPositive:e[5],colorNegative:e[6]}},e.acceptsReference=re,e},paint:v[A]}),L=function(e){function t(){return e.call(this)||this}return oe(t,e),t}(P),t.ScatterSparkline=L,m(L.prototype,{createFunction:function(){var e=new h(M,1,18);return e.evaluate=function(e){return{points1:le(e[0],0),points2:le(e[1],0),minX:e[2],maxX:e[3],minY:e[4],maxY:e[5],hLine:e[6],vLine:e[7],xMinZone:e[8],xMaxZone:e[9],yMinZone:e[10],yMaxZone:e[11],tags:e[12],drawSymbol:e[13],drawLines:e[14],color1:e[15],color2:e[16],dash:e[17]}},e.acceptsReference=function(e){return 0===e||1===e},e},paint:v[M]}),z=function(e){function t(){return e.call(this)||this}return oe(t,e),t}(P),t.BulletSparkline=z,m(z.prototype,{createFunction:function(){var e=new h(S,3,17);return e.evaluate=function(e){return{measure:ue(e[0]),target:ue(e[1]),maxi:ue(e[2]),good:ue(e[3]),bad:ue(e[4]),forecast:ue(e[5]),tickUnit:ue(e[6]),colorScheme:e[7],vertical:e[8],measureColor:e[9],targetColor:e[10],maxiColor:e[11],goodColor:e[12],badColor:e[13],forecastColor:e[14],allowMeasureOverMaxi:e[15],barSize:e[16]}},e.acceptsReference=function(e){return 0<=e&&e<=6},e},paint:v[S]}),V=function(e){function t(){return e.call(this)||this}return oe(t,e),t}(P),t.SpreadSparkline=V,m(V.prototype,{createFunction:function(){var e=new h(T,1,7);return e.evaluate=function(e){var t,n,o,r,i,a,s,l,u=se(e[0]),c=[];if(!d(u)&&(c=function(e){var t,n,o,r,i,a={};for(t=0,n=void 0,o=e.length;t<o;t++)a[n=e[t]]?a[n]++:a[n]=1;for(i in r=[],a)a.hasOwnProperty(i)&&r.push({key:w(i),value:a[i]});return r.sort((function(e,t){return e.key-t.key}))}(u=function(e){var t,n,o,r,i=[];for(n=0,o=0,r=e.length;n<r;n++)t=w(e[n]),!C(t)&&isFinite(t)&&(i[o]=t,o++);return i}(u)),3===(t=e[4])))for(n=0,o=c.length;n<o;n++){for(i=(r=c[n]).value,a=[],s=Math.max(100,10*i),l=0;l<s+i-1;l++)a.push(Math.random());r.randomNumbers=a}return{spreadData:c,showAverage:e[1],scaleStart:e[2],scaleEnd:e[3],style:t,colorScheme:e[5],vertical:e[6]}},e.acceptsReference=re,e},paint:v[T]}),G=function(e){function t(){return e.call(this)||this}return oe(t,e),t}(P),t.StackedSparkline=G,m(G.prototype,{createFunction:function(){var e=new h(N,1,13);return e.evaluate=function(e){return{points:se(e[0]),colorRange:se(e[1]),labelRange:se(e[2]),maximum:e[3],targetRed:e[4],targetGreen:e[5],targetBlue:e[6],targetYellow:e[7],color:e[8],highlightPosition:e[9],vertical:e[10],textOrientation:e[11],textSize:e[12]}},e.acceptsReference=function(e){return 0<=e&&e<=2},e},paint:v[N]}),W=function(e){function t(){return e.call(this)||this}return oe(t,e),t}(P),t.HBarSparkline=W,m(W.prototype,{createFunction:function(){var e=new h(I,1,4);return e.evaluate=function(e){return{value:ue(e[0]),colorScheme:e[1],axisVisible:e[2],barHeight:e[3]}},e.acceptsReference=re,e},paint:v[I]}),U=function(e){function t(){return e.call(this)||this}return oe(t,e),t}(P),t.VBarSparkline=U,m(U.prototype,{createFunction:function(){var e=new h(R,1,4);return e.evaluate=function(e){return{value:ue(e[0]),colorScheme:e[1],axisVisible:e[2],barWidth:e[3]}},e.acceptsReference=re,e},paint:v[R]}),Z=function(e){function t(){return e.call(this)||this}return oe(t,e),t}(P),t.VariSparkline=Z,m(Z.prototype,{createFunction:function(){var e=new h(k,1,10);return e.evaluate=function(e){return{variance:ue(e[0]),reference:ue(e[1]),mini:ue(e[2]),maxi:ue(e[3]),mark:ue(e[4]),tickUnit:ue(e[5]),legend:e[6],colorPositive:e[7],colorNegative:e[8],vertical:e[9]}},e.acceptsReference=function(e){return 0<=e&&e<=5},e},paint:v[k]}),q=function(e){function t(){return e.call(this)||this}return oe(t,e),t}(P),t.BoxPlotSparkline=q,m(q.prototype,{createFunction:function(){function e(e,t){return c(e)&&!C(t)&&0<=t&&t<=100?p.PERCENTILE.evaluate(e,t/100):NaN}function t(e){return c(e)?p.STDEVP.evaluate(e):NaN}var n=new h(E,1,10);return n.evaluate=function(n){var o=n[0];return{points:se(o),boxPlotClass:n[1],showAverage:n[2],scaleStart:ue(n[3]),scaleEnd:ue(n[4]),acceptableStart:ue(n[5]),acceptableEnd:ue(n[6]),colorScheme:n[7],style:n[8],vertical:n[9],perc02:e(o,2),perc09:e(o,9),perc10:e(o,10),perc90:e(o,90),perc91:e(o,91),perc98:e(o,98),q1:e(o,25),q3:e(o,75),median:e(o,50),stDev:t(o)}},n.acceptsReference=re,n},paint:v[E]}),J=function(e){function t(){return e.call(this)||this}return oe(t,e),t}(P),t.CascadeSparkline=J,m(J.prototype,{createFunction:function(){var e=new h(D,1,10);return e.evaluate=function(e){return{points:se(e[0]),pointIndex:ue(e[1]),labels:se(e[2]),minimum:ue(e[3]),maximum:ue(e[4]),colorPositive:e[5],colorNegative:e[6],vertical:e[7],itemTypeRange:se(e[8],!0),colorTotal:e[9]}},e.acceptsReference=ae,e.acceptsArray=ae,e},paint:v[D]}),Q=function(e){function t(){return e.call(this)||this}return oe(t,e),t}(P),t.ParetoSparkline=Q,m(Q.prototype,{createFunction:function(){var e=new h(j,1,12);return e.evaluate=function(e){return{points:se(e[0]),pointIndex:ue(e[1]),colorRange:se(e[2],!0),target:ue(e[3]),target2:ue(e[4]),highlightPosition:ue(e[5]),label:e[6],vertical:e[7],targetColor:e[8],target2Color:e[9],labelColor:e[10],barSize:e[11]}},e.acceptsReference=ie,e.acceptsArray=ie,e},paint:v[j]}),Y=function(e){function t(){return e.call(this)||this}return oe(t,e),t}(P),t.MonthSparkline=Y,m(Y.prototype,{createFunction:function(){var e=new h(_,3,7);return e.evaluate=function(e){var t,n,o,r,i,a,s,l,u,f=e[0],h=e[1],p=e[2],d=p;for(c(p)&&(d=le(p,0)),t=e[3],n=[],c(t)&&(n=le(t,0)),o=[],r=[],i=0,a=d.length;i<a;i++)(s=d[i])&&((l=s[0])&&l.getFullYear()===f&&l.getMonth()+1===h&&(o[u=l.getDate()-1]=s[1],n.length>0&&(r[u]=n[i][0])));return n.length>0?{year:f,month:h,values:o,colors:r}:{year:f,month:h,values:o,emptyColor:t,startColor:e[4],middleColor:e[5],endColor:e[6]}},e.acceptsReference=function(e){return 2===e||3===e},e},paint:v[_]}),K=function(e){function t(){return e.call(this)||this}return oe(t,e),t.daysOfMonth=function(e,t){switch(t){case 2:return e%4==0&&e%100!=0||e%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}},t.dayInYear=function(e){var n,o=e.getFullYear(),r=e.getMonth(),i=e.getDate();for(n=1;n<r+1;n++)i+=t.daysOfMonth(o,n);return i},t}(P),t.YearSparkline=K,m(K.prototype,{createFunction:function(){var e=new h(O,2,6);return e.evaluate=function(e){var t,n,o,r,i,a,s,l,u,f=e[0],h=e[1],p=h;for(c(h)&&(p=le(h,0)),t=e[2],n=[],c(t)&&(n=le(t,0)),o=[],r=[],i=0,a=p.length;i<a;i++)(s=p[i])&&((l=s[0])&&l.getFullYear()===f&&(o[u=K.dayInYear(l)-1]=s[1],n.length>0&&(r[u]=n[i][0])));return n.length>0?{year:f,values:o,colors:r}:{year:f,values:o,emptyColor:t,startColor:e[3],middleColor:e[4],endColor:e[5]}},e.acceptsReference=function(e){return 1===e||2===e},e},paint:v[O]}),$=function(e){function t(){return e.call(this)||this}return oe(t,e),t}(P),t.LineSparkline=$,m($.prototype,{createFunction:function(){return ce("LINESPARKLINE",0)},paint:fe}),X=function(e){function t(){return e.call(this)||this}return oe(t,e),t}(P),t.ColumnSparkline=X,m(X.prototype,{createFunction:function(){return ce("COLUMNSPARKLINE",1)},paint:fe}),ee=function(e){function t(){return e.call(this)||this}return oe(t,e),t}(P),t.WinlossSparkline=ee,m(ee.prototype,{createFunction:function(){return ce("WINLOSSSPARKLINE",2)},paint:fe}),te=function(e){function t(){return e.call(this)||this}return oe(t,e),t}(P),t.RangeBlockSparkline=te,m(te.prototype,{createFunction:function(){var e=new h("RANGEBLOCKSPARKLINE",2,2);return e.evaluate=function(e){var t=e[0],n=t.getSource().getSheet(),o=t.getRow(0),r=t.getColumn(0),i=t.getRowCount(0),a=t.getColumnCount(0);return{templateSheetName:n.name(),templateRange:{row:o,col:r,rowCount:i,colCount:a},bindingObject:e[1]}},e.acceptsReference=re,e},paint:function(e,t,o,r,i,a,c){var f,h,p,d,g,m=t.templateSheetName,y=t.templateRange;m&&((h=(f=c.sheet.parent)&&f.getSheetFromName(m))&&(l||(p=n("CellTypes"),l=p.Xgc,s=p.Wgc,u=p.paintRangeTemplate),d=(new l).YE(h,y),g=(new s).YE(h,y),u(e,{x:o,y:r,width:i,height:a},t.bindingObject,c,d,g.NJb)))}}),ne={},t.w_a=ne,h&&(he(new H),he(new B),he(new L),he(new z),he(new V),he(new G),he(new W),he(new U),he(new Z),he(new q),he(new J),he(new Q),he(new Y),he(new K),he(new $),he(new X),he(new ee),he(new te)),m(r.Workbook.prototype,{addSparklineEx:function(e){this.dT||(this.dT={});var t=this.dT;e&&(t[e.name()]=e)},getSparklineEx:function(e){var t,n=ne[e];return n||(t=this.dT)&&t[e]},removeSparklineEx:function(e){var t=this.dT;t&&(t[e]=void 0)}}),r.Workbook.$n("sparklineEx",{toJson:function(e){var t,n,o=this.dT,r=[];if(o){for(t in o)o.hasOwnProperty(t)&&((n=o[t].toJSON())&&n.typeName&&r.push(n));r.length>0&&(e.sparklineExs=r)}},fromJson:function(e){var t,n,o,i,a=e.sparklineExs;if(a)for(t=0;t<a.length;t++)n=a[t],(o=r.getTypeFromString(n.typeName))&&((i=new o).fromJSON(n),this.addSparklineEx(i))}})},"./dist/plugins/sparkline/sparkline-wrapper.entry.js":function(e,t,n){"use strict";var o,r;Object.defineProperty(t,"__esModule",{value:!0}),o=n("./dist/plugins/sparkline/functions-sparkline.js"),t.w_a=o.w_a,t.PieSparkline=o.PieSparkline,t.AreaSparkline=o.AreaSparkline,t.ScatterSparkline=o.ScatterSparkline,t.BulletSparkline=o.BulletSparkline,t.SpreadSparkline=o.SpreadSparkline,t.StackedSparkline=o.StackedSparkline,t.HBarSparkline=o.HBarSparkline,t.VBarSparkline=o.VBarSparkline,t.VariSparkline=o.VariSparkline,t.BoxPlotSparkline=o.BoxPlotSparkline,t.CascadeSparkline=o.CascadeSparkline,t.ParetoSparkline=o.ParetoSparkline,t.MonthSparkline=o.MonthSparkline,t.YearSparkline=o.YearSparkline,t.LineSparkline=o.LineSparkline,t.ColumnSparkline=o.ColumnSparkline,t.WinlossSparkline=o.WinlossSparkline,t.RangeBlockSparkline=o.RangeBlockSparkline,t.SparklineEx=o.SparklineEx,t.SparklineExValue=o.SparklineExValue,r=n("./dist/plugins/sparkline/sparkline-wrapper.js"),t.EmptyValueStyle=r.EmptyValueStyle,t.SparklineAxisMinMax=r.SparklineAxisMinMax,t.SparklineSetting=r.SparklineSetting,t.SparklineType=r.SparklineType,t.DataOrientation=r.DataOrientation,t.Sparkline=r.Sparkline},"./dist/plugins/sparkline/sparkline-wrapper.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I;function R(e,t){var n=a.formulaToRanges(e,t,0,0)[0],o=n&&n.ranges&&n.ranges[0];return o?{range:o,sheetName:n.sheetName}:m}function k(e,t,n,o){var r=this.ZA;r.JUa(e,t,o),o&&r.add(o.group()),this.Bq("sparkline",e,t,3,n,o)}function E(e,t){return e+"_"+t}function D(e,t,n){return n?e>n.row+n.rowCount-1?n:e>n.row?l(n.row,n.col,n.rowCount+t,n.colCount):l(n.row+t,n.col,n.rowCount,n.colCount):m}function j(e,t,n){return n?e>n.col+n.colCount-1?n:e>n.col?l(n.row,n.col,n.rowCount,n.colCount+t):l(n.row,n.col+t,n.rowCount,n.colCount):m}function _(e,t,n,r,i){var a,s,l,u,c,f,h,p,d,g,y,v,b=new o.KTa;for(a=0;a<e.length;a++)for(l=(s=e[a]).PS,s.displayDateAxis&&(void 0,c=s.dateAxisData(),u=r?D(t,n,c):j(t,n,c),s.dateAxisData(u)),f=0;f<l.length;f++)h=l[f],t<=(r?h.row:h.column)&&(b.set(a,f,h),i.JUa(h.row,h.column,m),r?h.row+=n:h.column+=n),void 0,d=h.data(),p=r?D(t,n,d):j(t,n,d),h.data(p);for(g=0;g<e.length;g++)for(y=e[g].PS,v=0;v<y.length;v++)i.SUa(b.get(g,v))}function O(e,t,n,o,r,i){var a,s,l,u,c,f,h,p,d,g,m,v,b,C;for(a=0;a<o.length;a++)(s=o[a]).displayDateAxis&&(u=(l=s.OW())._modelManager,c=!1,i&&!u.zTa&&(u.zTa=[],c=!0),void 0,h=s.dateAxisData(),f=n?D(e,t,h):j(e,t,h),s.dateAxisData(f),c&&(i.push({sheetName:l.name(),changes:u.zTa}),u.zTa=y));for(p=0;p<r.length;p++)m=(g=(d=r[p]).bT())._modelManager,v=!1,i&&!m.zTa&&(m.zTa=[],v=!0),void 0,C=d.data(),b=n?D(e,t,C):j(e,t,C),d.data(b),v&&(i.push({sheetName:g.name(),changes:m.zTa}),m.zTa=y)}function F(e,t,n){var o=H(n.col,n.col+n.colCount-1,e,e+t-1);return o?l(n.row,o.start,n.rowCount,o.end-o.start+1):m}function P(e,t,n){var o=H(n.row,n.row+n.rowCount-1,e,e+t-1);return o?l(o.start,n.col,o.end-o.start+1,n.colCount):m}function H(e,t,n,o){var r,i,a,s,l,u=-1;if(o<e)return{start:u=e-(i=o-n+1),end:t-i};if(n>t)return{start:u=e,end:t};if(n<=e){for(a=t-e+1,s=0,r=e;r<=o&&r<=t;r++)s++;return{start:u=n,end:u+a-s-1}}for(l=0,r=e;r<=t;r++)-1===u&&(r<n||r>o)&&(u=r),(r<n||r>o)&&l++;return-1!==u&&l>0?{start:u,end:u+l-1}:m}function B(e,t,n,r,i){var a,s,l,c,f,p,d,g,y,b,C,w,x,A,M=new o.KTa,S=e.length,T=0;for(a=S-1;a>-1;a--){if((s=e[a]).displayDateAxis){if(void 0,c=s.dateAxisData(),l=r?P(t,n,c):F(t,n,c),u(l)){s.clear(),i.remove(s);continue}s.dateAxisData(l)}for(f=(f=[]).concat(s.PS),p=h(f),T=v(p,T),d=p-1;d>-1;d--)g=f[d],(y=r?g.row:g.column)>=t&&y<t+n?(s.remove(g),i.JUa(g.row,g.column,m)):(t<=y&&(i.JUa(g.row,g.column,m),r?g.row-=n:g.column-=n,M.set(a,d,g)),void 0,C=g.data(),b=r?P(t,n,C):F(t,n,C),u(b)?s.remove(g):g.data(b));s.count()<=0&&i.remove(s)}for(x=0;x<S;x++)for(A=0;A<T;A++)(w=M.get(x,A))&&i.SUa(w)}function L(e,t,n,o,r,i){var a,s,l,c,f,h,p,d,g,m,v,b,C,w,x;for(a=o.length-1;a>-1;a--)(s=o[a]).displayDateAxis&&(c=(l=s.OW())._modelManager,f=!1,i&&!c.zTa&&(c.zTa=[],f=!0),void 0,p=s.dateAxisData(),h=n?P(e,t,p):F(e,t,p),u(h)?(s.clear(),s.ZA.remove(s)):s.dateAxisData(h),f&&(i.push({sheetName:l.name(),changes:c.zTa}),c.zTa=y));for(d=r.length-1;d>-1;d--)v=(m=(g=r[d]).bT())._modelManager,b=!1,i&&!v.zTa&&(v.zTa=[],b=!0),void 0,w=g.data(),C=n?P(e,t,w):F(e,t,w),u(C)?((x=g.group()).remove(g),x.count()<=0&&x.ZA.remove(x)):g.data(C),b&&(i.push({sheetName:m.name(),changes:v.zTa}),v.zTa=y)}function z(e,t){var n=!1;return"setting"===e||"axisReference"===e?n=t===m:"displayDateAxis"===e?n=!1===t:"axisOrientation"===e?n=1===t:"sparklines"===e&&(n=0===t.length),n}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("@grapecity/js-sheets-common"),i=n("@grapecity/js-calc"),a=n("SheetsCalc"),s=o.GC$.isEmptyObject,l=o.kf,u=r.Common.j.Fa,c=r.Common.k,f=c.Fb,h=c.ac,p=c.Bb,d=r.Sparklines.Vd,g=r.Sparklines.SparklineRender,m=null,y=void 0,v=Math.max,b=Number.MAX_VALUE,o.GC$.extend(o.lUa.prototype,{FUa:function(e){var t,n,o,r=this,i=r.zTa,a=arguments[1];if(i){switch(i.GUa||(i.GUa=[]),t={type:e},e){case 0:o=void 0,o=(n=a)&&n.sparkline?n.sparkline:m,t.HUa={row:n.row,col:n.col,sparkline:o};break;case 12:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:t.HUa=a}i.GUa.push(t)}},IUa:function(e){var t,n,o,r,i,a,s,u,c,p,d,g=this,y=e.HUa;switch(e.type){case 12:y.sparkline?(y.sparkline.row=y.row,y.sparkline.column=y.col,g.ZA.JUa(y.row,y.col,y.sparkline)):g.ZA.JUa(y.row,y.col,m);break;case 0:g.ZA.JUa(y.row,y.col,y.sparkline),y.sparkline&&!g.ZA.contains(y.sparkline.group())&&g.ZA.add(y.sparkline.group());break;case 1:for(t=void 0,n=void 0,o=void 0,r=h(y),i=0;i<r;i++)t=y[i].row,n=y[i].col,o=g.ZA.KUa(t,n),0===i&&o.cb.count()===r&&g.ZA.remove(o.cb),this.ZA.add(o.group(y[i].group).cb);break;case 2:for(a=[],s=0;s<h(y);s++)a.push(g.ZA.KUa(y[s].row,y[s].col));g.ZA.kj.groupSparkline(a);break;case 3:g.ZA.KUa(y.row,y.col).sparklineType(y.sparklineType);break;case 4:g.ZA.KUa(y.row,y.col).setting(y.setting);break;case 5:y.sparkline.data(y.data);break;case 15:g.ZA.KUa(y.row,y.col).dataSheetName(y.dataSheetName);break;case 6:g.ZA.KUa(y.row,y.col).dataOrientation(y.dataOrientation);break;case 7:g.ZA.KUa(y.row,y.col).displayDateAxis(y.displayDateAxis);break;case 8:void 0,u=(c=y.rangeInfo)?l(c.row,c.col,c.rowCount,c.colCount):c,y.group.dateAxisData(u);break;case 16:y.group.dateAxisDataSheetName(y.dateAxisDataSheetName);break;case 9:y.group.dateAxisOrientation(y.dateAxisOrientation);break;case 10:for(y.group.PS.forEach((function(e){g.ZA.vZa(e)})),y.group.PS=y.PS,p=y.group.PS,d=0;d<h(p);d++)p[d].group(y.group);p.forEach((function(e){g.ZA.tZa(e)}));break;case 11:g.ZA.KUa(y.row,y.col).group(y.group);break;case 13:f(g.ZA.groups(),y),g.ZA.yZa(y);break;case 14:g.ZA.groups().push(y),g.ZA.zZa(y)}},LUa:function(e){var t;for(t=h(e)-1;t>=0;t--)this.IUa(e[t])},MUa:function(e,t){this.ZA.rI(e,t)},NUa:function(e,t){this.ZA.GR(e,t)},OUa:function(e,t){this.ZA.tI(e,t)},PUa:function(e,t){this.ZA.HR(e,t)},QUa:function(e,t,n,o){this.ZA.clear(e,t,n,o)},wZa:function(){var e=this.zTa;return e?(e.xZa||(e.xZa=[]),e.xZa):m}}),o.lUa.$n("sparkline",{init:function(){var e=this.kj;this.ZA=new x(e)},undo:function(e){var t,n,o=e.GUa;o&&this.LUa(o),t=this.kj,(n=e.xZa)&&n.forEach((function(e){t.parent.getSheetFromName(e.sheetName)._modelManager.undo(e.changes)}))}}),C={init:function(){this.ZA=this._modelManager.ZA},dispose:function(e){if(!1!==e.clearCache){var t=this;t.ZA&&(t.ZA.kj=m,t.ZA.evaluator=m,t.ZA=m),t._modelManager&&(t._modelManager.ZA=m)}},onLayoutChanged:function(e){var t,n=e.changeType,o=e.row,r=e.rowCount,i=e.col,a=e.colCount,s=this._modelManager;"addRows"===n?s.MUa(o,r):"deleteRows"===n?s.NUa(o,r):"addColumns"===n?s.OUa(i,a):"deleteColumns"===n?s.PUa(i,a):"clear"===n&&(t=e.type,3===e.sheetArea&&16==(16&t)&&s.QUa(o,i,r,a))},toJson:function(e,t){t&&t.ignoreStyle||(e.sparklineGroups=this.ZA.toJSON())},fromJson:function(e,t,n){var o=n&&n.ignoreStyle,r=this.ZA,i=e.sparklineGroupManager,a=t?i&&i.groups:e.sparklineGroups;a&&!o&&r.RUa(a,t)},setName:function(e){var t=e.oldName,n=e.newName;this.ZA.jOa(t,n)}},o.Worksheet.$n("sparkline",C),w={getSparkline:function(e,t){return this.ZA?this.ZA.KUa(e,t):m},setSparkline:function(e,t,n,o,r,i,a,s){var l,c,f,h,p,d,g=this;if(!g.ZA)return m;if("string"==typeof n){if(!(c=R(g,n)))return m;n=c.range,l=c.sheetName}if(f=new I(e,t,n,o,r,i),l&&l!==g.name()&&f.dataSheetName(l),a&&!u(s)){if(h=void 0,"string"==typeof a){if(!(p=R(g,a)))return m;a=p.range,h=p.sheetName}f.dateAxisData(a),h&&h!==g.name()&&f.dateAxisDataSheetName(h),f.dateAxisOrientation(s),f.group().displayDateAxis=!0}return d=g.getSparkline(e,t),g.removeSparkline(e,t),k.call(g,e,t,d,f),g.$p(),f},WLb:function(e,t,n){var o=this.getSparkline(e,t);k.call(this,e,t,o,n)},removeSparkline:function(e,t){var n,o,r,i=this,a=i.ZA;a&&(o={row:e,col:t,sparkline:n=i.getSparkline(e,t)},i._modelManager.FUa(0,o),n&&((r=n.group()).remove(n),r.count()<=0&&a.remove(r),k.call(i,e,t,n,m)),i.$p())},groupSparkline:function(e){var t,n,o,r,i,a,s=this,l=s.ZA;if(!l)return m;for(t=m,n=[],o=s._modelManager.zTa!==y,r=0;r<e.length;r++)(i=e[r])&&(o&&n.push({group:i.group().clone(),row:i.row,col:i.column}),t?((a=i.group()).remove(i),t.add(i),a.count()<=0&&l.remove(a)):t=i.group());return s.$p(),s._modelManager.FUa(1,n),t},ungroupSparkline:function(e){var t,n,o,r,i,a,s=this,l=s.ZA;if(l&&e){for(t=[],n=[],o=s._modelManager.zTa!==y,t=t.concat(e.PS),r=0;r<t.length;r++)(i=t[r])&&(o&&n.push({row:i.row,col:i.column}),e.remove(i),(a=e.clone()).add(i),l.add(a));l.remove(e),s._modelManager.FUa(2,n),s.$p()}}},o.GC$.extend(o.Worksheet.prototype,w),x=function(){function e(e){this.Ub=[],this.kj=e,this.xn={},this.qZa=[],this.rZa=[]}return e.prototype.RUa=function(e,t){var n=this;n.fromJSON(e,t),n.groups().forEach((function(e){e.PS.forEach((function(e){n.SUa(e)}))}))},e.prototype.SUa=function(e){e&&this.JUa(e.row,e.column,e)},e.prototype.JUa=function(e,t,n){if(this.kj._modelManager.zTa){var o={row:e,col:t,sparkline:this.KUa(e,t)};this.kj._modelManager.FUa(12,o)}n?this.xn[E(e,t)]=n:delete this.xn[E(e,t)]},e.prototype.KUa=function(e,t){return this.xn[E(e,t)]||m},e.prototype.groups=function(e){return 0===arguments.length?this.Ub:void(this.Ub=e)},e.prototype.add=function(e){var t=this;t.kj._modelManager.FUa(13,e),t.groups().push(e),e.ZA=t,e.QS(),t.zZa(e)},e.prototype.zZa=function(e){var t=this;t.sZa(e),e.all().forEach((function(e){t.tZa(e)}))},e.prototype.remove=function(e){var t=this;t.kj._modelManager.FUa(14,e),f(t.groups(),e),t.yZa(e)},e.prototype.yZa=function(e){var t=this;t.uZa(e),e.all().forEach((function(e){t.vZa(e)}))},e.prototype.contains=function(e){return p(this.groups(),e)},e.prototype.count=function(){return this.groups().length},e.prototype.rI=function(e,t){_(this.Ub,e,t,!0,this),O(e,t,!0,this.rZa,this.qZa,this.kj._modelManager.wZa())},e.prototype.tI=function(e,t){_(this.Ub,e,t,!1,this),O(e,t,!1,this.rZa,this.qZa,this.kj._modelManager.wZa())},e.prototype.GR=function(e,t){B(this.Ub,e,t,!0,this),L(e,t,!0,this.rZa,this.qZa,this.kj._modelManager.wZa())},e.prototype.HR=function(e,t){B(this.Ub,e,t,!1,this),L(e,t,!1,this.rZa,this.qZa,this.kj._modelManager.wZa())},e.prototype.jOa=function(e,t){this.rZa.forEach((function(n){n.dateAxisDataSheetName()===e&&n.dateAxisDataSheetName(t)})),this.qZa.forEach((function(n){n.dataSheetName()===e&&n.dataSheetName(t)}))},e.prototype.tZa=function(e){var t,n,o=this.kj,r=e.dataSheetName();r&&r!==o.name()&&((t=o.parent.getSheetFromName(r))&&((n=t.ZA.qZa).indexOf(e)<0&&n.push(e)))},e.prototype.vZa=function(e){var t,n,o,r=e.dataSheetName();r&&((t=this.kj.parent.getSheetFromName(r))&&((o=(n=t.ZA.qZa).indexOf(e))>=0&&n.splice(o,1)))},e.prototype.sZa=function(e){var t,n,o=this.kj,r=e.dateAxisDataSheetName();r&&r!==o.name()&&((t=o.parent.getSheetFromName(r))&&((n=t.ZA.rZa).indexOf(e)<0&&n.push(e)))},e.prototype.uZa=function(e){var t,n,o,r=e.dateAxisDataSheetName();r&&((t=this.kj.parent.getSheetFromName(r))&&((o=(n=t.ZA.rZa).indexOf(e))>=0&&n.splice(o,1)))},e.prototype.clear=function(e,t,n,o){var r,i,a,s,l,u,c,f,p,d=this;if(0===arguments.length){for(r=d.Ub,i=h(r)-1;i>-1;i--)if(a=r[i]){for(s=a.count()-1;s>-1;s--)l=a.PS[s],d.JUa(l.row,l.column,m),a.remove(l);d.remove(a)}}else for(u=e;u<e+n;u++)for(c=t;c<t+o;c++)(f=d.RS(u,c))&&(d.JUa(f.row,f.column,m),(p=f.group()).remove(f),0===p.count()&&d.remove(p))},e.prototype.RS=function(e,t){var n,o,r,i,a=this.Ub;for(n=0;n<a.length;n++)for(o=a[n],r=0;r<o.count();r++)if((i=o.PS[r])&&i.row===e&&i.column===t)return i;return m},e.prototype.Zz=function(e,t,n,r,i,a,s){var l,c,f,h,p,d,g,m,y,v,b,C,w=this,x=w.kj;if(x){for(l=new o.KTa,c=n-e,f=r-t,d=x.getRowCount(),g=x.getColumnCount(),m=x.ZA,h=0;h<i;h++)if(!(s&&x.Ps&&x.Ps(n+h)))for(p=0;p<a;p++)(y=x.getSparkline(e+h,t+p))&&((v=y.clone()).row=n+h,v.column=r+p,b=v.dateAxisData(),!u(b)&&w.SS(b,c,f,d,g)&&v.dateAxisData(b.offset(f,c)),C=v.data(),!u(C)&&w.SS(C,c,f,d,g)&&v.data(C.offset(f,c)),w.add(v.group()),l.set(h,p,v));for(h=0;h<i;h++)if(!(s&&x.Ps&&x.Ps(n+h)))for(p=0;p<a;p++)m.JUa(n+h,r+p,l.get(h,p))}},e.prototype.SS=function(e,t,n,o,r){var i,a,s,l,u=this.TS(e);return!(!u||(i=v(u.row,0),a=v(u.col,0),s=u.row<0?o:u.rowCount,l=u.col<0?r:u.colCount,i+t<0||a+n<0||i+s+t>o||a+l+n>r))},e.prototype.aB=function(e,t,n,r,i,a){var s,l,u,c,f,h=this.kj;if(h){for(this.US(e,t,n,r,i,a),s=h.ZA,l=new o.KTa,u=0;u<i;u++)for(c=0;c<a;c++)(f=h.getSparkline(e+u,t+c))&&(f.row=n+u,f.column=r+c,l.set(u,c,f)),s.JUa(e+u,t+c,m);for(u=0;u<i;u++)for(c=0;c<a;c++)h.removeSparkline(n+u,r+c),s.JUa(n+u,r+c,l.get(u,c))}},e.prototype.US=function(e,t,n,o,r,i){var a,s,u,c,f,h,p,d,g=this,m=l(e,t,r,i),y=n-e,v=o-t,b=g.Ub;for(a=0;a<b.length;a++)for(s=b[a].PS,u=0;u<s.length;u++)(c=s[u])&&(f=c.dateAxisData(),(h=g.TS(f))&&m.containsRange(h)&&m.contains(c.row,c.column)&&c.dateAxisData(f.offset(v,y)),p=c.data(),(d=g.TS(p))&&m.containsRange(d)&&m.contains(c.row,c.column)&&c.data(p.offset(v,y)))},e.prototype.TS=function(e){return e},e.prototype._A=function(e,t,n,o,r,i,a,s){var l,c,f,h,p,d,g,y,v,b,C,w=this,x=w.kj;if(x){if(e===x)return void w.Zz(t,n,o,r,i,a);for(l=o-t,c=r-n,f=x.ZA,h=x.getRowCount(),p=x.getColumnCount(),d=0;d<i;d++)if(!(s&&x.Ps&&x.Ps(o+d)))for(g=0;g<a;g++)(y=e.getSparkline(t+d,n+g))?((v=y.clone()).row=o+d,v.column=r+g,b=v.dateAxisData(),!u(b)&&w.SS(b,l,c,h,p)&&v.dateAxisData(b.offset(c,l)),C=v.data(),!u(C)&&w.SS(C,l,c,h,p)&&v.data(C.offset(c,l)),w.add(v.group()),f.JUa(o+d,r+g,v)):f.JUa(o+d,r+g,m)}},e.prototype.$A=function(e,t,n,o,r,i,a){var s,l,u,c,f,h,p,d=this,g=d.kj;if(g){if(e===g)return void d.aB(t,n,o,r,i,a);for(s=e.ZA,l=g.ZA,d.VS(e,t,n,o,r,i,a),u=0;u<i;u++)for(c=0;c<a;c++)(f=e.getSparkline(t+u,n+c))?(f.row=o+u,f.column=r+c,p=(h=f.group()).clone(),h.remove(f),h.count()<=0&&s.remove(h),p.add(f),d.add(p),l.JUa(o+u,r+c,f)):l.JUa(o+u,r+c,m),s.JUa(t+u,n+c,m)}},e.prototype.VS=function(e,t,n,o,r,i,a){var s,u,c,f,h,p,d,g,m,y,v,b,C=this,w=C.kj;if(e&&w){if(e===w)return void C.US(t,n,o,r,i,a);for(s=l(t,n,i,a),u=o-t,c=r-n,f=e.ZA.Ub,h=0;h<f.length;h++)for(p=f[h],d=0;d<p.PS.length;d++)(g=p.PS[d])&&(m=g.dateAxisData(),(y=C.TS(m))&&s.containsRange(y)&&s.contains(g.row,g.column)&&g.dateAxisData(m.offset(c,u)),v=g.data(),(b=C.TS(v))&&s.containsRange(b)&&s.contains(g.row,g.column)&&g.data(v.offset(c,u)))}},e.prototype.toJSON=function(){var e,t=this.Ub,n=[];for(e=0;t&&e<t.length;e++)n.push(t[e].toJSON());return 0===n.length?y:n},e.prototype.fromJSON=function(e,t){var n,o,r;for(this.Ub.length=0,this.xn={},n=0;e&&n<e.length;n++)o=e[n],(r=new N).fromJSON(o,t),this.add(r)},e}(),function(e){e[e.gaps=0]="gaps",e[e.zero=1]="zero",e[e.connect=2]="connect"}(t.EmptyValueStyle||(t.EmptyValueStyle={})),function(e){e[e.individual=0]="individual",e[e.group=1]="group",e[e.custom=2]="custom"}(t.SparklineAxisMinMax||(t.SparklineAxisMinMax={})),A=r.Common.pc.bc(255,149,179,215),M=r.Common.pc.bc(255,36,64,98),S={axisColor:"black",firstMarkerColor:A,highMarkerColor:"Blue",lastMarkerColor:A,lowMarkerColor:"Blue",markersColor:M,negativeColor:"Brown",seriesColor:M,displayEmptyCellsAs:0,rightToLeft:!1,displayHidden:!1,displayXAxis:!1,showFirst:!1,showHigh:!1,showLast:!1,showLow:!1,showNegative:!1,showMarkers:!1,manualMax:0,manualMin:0,maxAxisType:0,minAxisType:0,lineWeight:1},T=function(){function e(e){var t,n=this;for(t in n.options={},S)S.hasOwnProperty(t)&&(n.options[t]=e&&e[t]?e[t]:S[t]);n.WS=m}return e.prototype.clone=function(){return new e(this.options)},e.prototype.toJSON=function(){var e,t=this.options,n={};for(e in t)S[e]!==t[e]&&(n[e]=t[e]);return s(n)?y:n},e}(),t.SparklineSetting=T,function(e){e[e.line=0]="line",e[e.column=1]="column",e[e.winloss=2]="winloss"}(t.SparklineType||(t.SparklineType={})),function(e){e[e.vertical=0]="vertical",e[e.horizontal=1]="horizontal"}(t.DataOrientation||(t.DataOrientation={})),N=function(){function e(e,t){var n=this;n.displayDateAxis=!1,n.ZA=m,n.PS=[],n.XS=m,n.YS=1,n.setting=t,n.sparklineType=e}return e.prototype.OW=function(){var e;return this.ZA&&(e=this.ZA.kj),e},e.prototype.TUa=function(){var e,t=this,n=t.OW();n&&n._modelManager.zTa&&(e={group:t,PS:t.PS.concat()},n._modelManager.FUa(10,e))},e.prototype.add=function(e){var t,n=this;e&&(n.TUa(),n.PS.push(e),e.group(n),n.QS(),(t=n.ZA)&&t.tZa(e),n.onGroupChanged())},e.prototype.clear=function(){this.TUa();var e=this.ZA;e&&this.PS.forEach((function(t){e.vZa(t)})),this.PS=[]},e.prototype.all=function(){return this.PS},e.prototype.remove=function(e){var t,n=this,o=n.PS;return n.TUa(),f(o,e),e.onSparklineChanged(),e.cb=n.clone(),n.QS(),(t=n.ZA)&&t.vZa(e),n.onGroupChanged(),o},e.prototype.contains=function(e){return p(this.PS,e)},e.prototype.onGroupChanged=function(){var e,t,n=this.PS;if(n)for(e=0;e<n.length;e++)(t=n[e])&&t.onSparklineChanged()},e.prototype.clone=function(){var t=this,n=t.setting?t.setting.clone():m,o=new e(t.sparklineType,n);return o.displayDateAxis=t.displayDateAxis,o.XS=t.XS,o.nZa=t.nZa,o.YS=t.YS,o},e.prototype.dateAxisData=function(e){var t,n,o,r=this;return 0===arguments.length?r.XS:((t=r.OW())&&t._modelManager.zTa&&(void 0,n={group:r,rangeInfo:r.XS?{row:r.XS.row,col:r.XS.col,rowCount:r.XS.rowCount,colCount:r.XS.colCount}:m},t._modelManager.FUa(8,n)),o=r.XS,r.XS=e,void(o!==e&&r.onGroupChanged()))},e.prototype.dateAxisDataSheetName=function(e){var t,n,o,r=this;return 0===arguments.length?r.nZa:(t=r.nZa,(n=r.OW())&&n._modelManager.zTa&&(o={group:r,dateAxisDataSheetName:t},n._modelManager.FUa(16,o)),t!==e&&(t&&n&&n.ZA.uZa(r),r.nZa=e,e&&n&&n.ZA.sZa(r),r.onGroupChanged()),r)},e.prototype.dateAxisOrientation=function(e){var t,n,o,r=this;return 0===arguments.length?r.YS:((t=r.OW())&&t._modelManager.zTa&&(n={group:r,dateAxisOrientation:r.YS},t._modelManager.FUa(9,n)),o=r.YS,r.YS=e,void(o!==e&&r.onGroupChanged()))},e.prototype.count=function(){return this.PS.length},e.prototype.QS=function(){var e,t,n,o,r,i,a,s,l=this,u=l.setting,c=l.PS;if(u&&((e=u.options).groupMaxValue=-b,e.groupMinValue=b,t=1===e.maxAxisType,n=1===e.minAxisType,t||n))for(o=0;o<c.length;o++)r=c[o],a=(i=l.ZS(r)).min,s=i.max,t&&e.groupMaxValue<s&&(e.groupMaxValue=s),n&&e.groupMinValue>a&&(e.groupMinValue=a)},e.prototype.ZS=function(e){var t,n,o,r,i,a,s=-b,l=b,u=e.data();if(u)for(n=(t=e.bT())&&t.parent.getSheetFromName(e.dataSheetName()),o=e.$S(u,e.dataOrientation(),!1,n||t),r=0;r<o.length;r++)(i=o[r])===d&&(i=0),"number"==typeof i&&(s=s<(a=i)?a:s,l=l>a?a:l);return{min:l,max:s}},e.prototype.toJSON=function(){var e,t,n,o=this,r={setting:o.setting?o.setting.toJSON():m,displayDateAxis:o.displayDateAxis,sparklineType:o.sparklineType,axisOrientation:o.YS,sparklines:o.PS.map((function(e){return e.toJSON()}))},i=o.XS;for(t in i&&(r.axisReference={row:i.row,col:i.col,rowCount:i.rowCount,colCount:i.colCount,sheetName:o.nZa}),e={},r)r.hasOwnProperty(t)&&(z(t,n=r[t])||(e[t]=n));return s(e)?y:e},e.prototype.fromJSON=function(e,t){var n,o,r,i,a,s,c,f,h;if(e&&(n=this,o=e.displayDateAxis,r=e.sparklineType,i=e.axisReference,a=e.axisOrientation,s=e.sparklines,n.setting=new T(e.setting),u(o)||(n.displayDateAxis=o),u(r)||(n.sparklineType=r),u(i)||(n.XS=l(i.row,i.col,i.rowCount,i.colCount),n.nZa=i.sheetName),u(a)||(n.YS=a),s))for(n.PS=[],c=0,f=s.length;c<f;c++)(h=new I).fromJSON(s[c]),n.add(h)},e}(),I=function(){function e(e,t,n,o,r,i){var a=this;a.row=e,a.column=t,a._S=o,a.aT=n,a.cb=new N(r,i),a.cb.add(a)}return e.prototype.group=function(e){var t,n,o,r,i=this;return 0===arguments.length?((t=i.cb)||((t=new N).add(i),i.cb=t),t):(n=i.cb,(o=i.bT())&&o._modelManager.zTa&&(r={row:i.row,col:i.column,group:n},o._modelManager.FUa(11,r)),e!==n&&(n&&n.remove(i),i.cb=e,e&&!e.contains(i)&&e.add(i),i.onSparklineChanged()),o&&o.$p(),i)},e.prototype.sparklineType=function(e){var t,n,o,r,i=this;return 0===arguments.length?i.group().sparklineType:((n=(t=i.group()).sparklineType)!==e&&(t.sparklineType=e,(o=i.bT())&&o._modelManager.zTa&&(r={row:i.row,col:i.column,sparklineType:n},o._modelManager.FUa(3,r)),i.onSparklineChanged(),o&&o.$p()),i)},e.prototype.onSparklineChanged=function(){var e=this.bT();e&&e.Wq(o.Events.SparklineChanged,{sheet:e,sheetName:e.name(),sparkline:this})},e.prototype.setting=function(e){var t,n=this,r=n.group(),i=n.bT(),a=i&&i._modelManager.zTa;return 0===arguments.length?(void 0,a?o.GC$.extend(!0,{},r.setting):r.setting):(a&&(t={row:n.row,col:n.column,setting:o.GC$.extend(!0,{},r.setting)},i._modelManager.FUa(4,t)),r.setting=e,i&&i.$p(),n)},e.prototype.data=function(e){var t,n,r=this;return 0===arguments.length?r.aT:((t=r.bT())&&t._modelManager.zTa&&(n={row:r.row,col:r.column,sparkline:r,data:o.GC$.extend(!0,{},r.aT)},t._modelManager.FUa(5,n)),r.aT!==e&&(r.aT=e,r.onSparklineChanged()),t&&t.$p(),r)},e.prototype.dataSheetName=function(e){var t,n,o,r=this;return 0===arguments.length?r.oZa:(t=r.oZa,(n=r.bT())&&n._modelManager.zTa&&(o={row:r.row,col:r.column,dataSheetName:t},n._modelManager.FUa(15,o)),t!==e&&(t&&n&&n.ZA.vZa(r),r.oZa=e,e&&n&&n.ZA.tZa(r),r.onSparklineChanged()),r)},e.prototype.dataOrientation=function(e){var t,n,o=this;return 0===arguments.length?o._S:((t=o.bT())&&t._modelManager.zTa&&(n={row:o.row,col:o.column,dataOrientation:o._S},t._modelManager.FUa(6,n)),o._S!==e&&(o._S=e,o.onSparklineChanged()),t&&t.$p(),o)},e.prototype.dateAxisData=function(e){var t=this,n=t.group();return 0===arguments.length?n.dateAxisData():(n.dateAxisData(e),t)},e.prototype.dateAxisDataSheetName=function(e){var t=this,n=t.group();return 0===arguments.length?n.dateAxisDataSheetName():(n.dateAxisDataSheetName(e),t)},e.prototype.dateAxisOrientation=function(e){var t=this,n=t.group();return 0===arguments.length?n.dateAxisOrientation():(n.dateAxisOrientation(e),t)},e.prototype.displayDateAxis=function(e){var t,n,o=this,r=o.group();return 0===arguments.length?r.displayDateAxis:((t=o.bT())&&t._modelManager.zTa&&(n={row:o.row,col:o.column,displayDateAxis:r.displayDateAxis},t._modelManager.FUa(7,n)),r.displayDateAxis=e,o)},e.prototype.clone=function(){var t=this,n=new e;return n.row=t.row,n.column=t.column,n.data(t.data()),n.dataSheetName(t.dataSheetName()),n.dataOrientation(t.dataOrientation()),n.group(t.group().clone()),n},e.prototype.paintSparkline=function(e,t,n,r,i){var a,s,l,u=this,c=u.bT();c&&c.parent&&(a=c.parent.getSheetFromName(u.dataSheetName()),s=c.parent.getSheetFromName(u.dateAxisDataSheetName())),this.lKb&&(c=this.lKb),l={sparklineType:u.sparklineType(),displayDateAxis:u.displayDateAxis(),zoomFactor:c.zoom(),values:u.hKb||u.$S(u.data(),u.dataOrientation(),!1,a||c),dateValues:u.jKb||u.$S(u.dateAxisData(),u.dateAxisOrientation(),!0,s||c),settings:u.setting(),getColor:function(e){if(c&&e){var t=o.Rm.Om(c,e);if(t)return t}return e}},(new g).paint(e,l,t,n,r,i)},e.prototype.iKb=function(e){var t=this;return t.$S(t.data(),t.dataOrientation(),!1,e)},e.prototype.kKb=function(e){var t=this;return t.$S(t.dateAxisData(),t.dateAxisOrientation(),!0,e)},e.prototype.$S=function(t,n,o,r){var i=this.setting().options.displayHidden;return e.cT(y,r,i,t,n,o)},e.prototype.bT=function(){var e=this.group(),t=e&&e.ZA;return t?t.kj:m},e.prototype.toJSON=function(){var e=this;return{row:e.row,col:e.column,orientation:e._S,data:{row:e.aT.row,rowCount:e.aT.rowCount,col:e.aT.col,colCount:e.aT.colCount,sheetName:e.oZa}}},e.prototype.fromJSON=function(e){var t,n,o,r,i,a;e&&(t=this,n=e.row,o=e.col,r=e.orientation,i=e.data,u(n)||(t.row=n),u(o)||(t.column=o),u(r)||(t._S=r),i&&(a=i,t.aT=l(a.row,a.col,a.rowCount,a.colCount),t.oZa=a.sheetName))},e.cT=function(e,t,n,o,a,s){var l,c,f,h,p,g="number",m=[],y=1===a;if(t&&o)for(l=0,c=y?o.colCount:o.rowCount;l<c;l++)f=y?0:l,h=y?l:0,(p=e?e[f][h]:t.getValue(o.row+f,o.col+h))instanceof i.CalcError||(!n&&(t.getRowHeight(o.row+f)<=0||t.getColumnWidth(o.col+h)<=0)?p=NaN:u(p)||(s?p=typeof p===g?r.Common.l.Xb(p):Date.parse(p):typeof p!==g&&(p=d)),m.push(p));return m},e}(),t.Sparkline=I},"./dist/plugins/table/table-action.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("@grapecity/js-sheets-common"),i=n("./dist/plugins/table/table-util.js"),a=i.Util.$Lb,s=i.Util.PIb,l=i.Util.QIb,u=i.Util._getTable,c=i.Util._Mb,f=o.Commands.ActionBase,h=r.Common.j.Fa,p="tableResize",d="tableInsertRows",g="tableDeleteRows",m="tableInsertColumns",y="tableDeleteColumns",v="tableToRange",b="tableTotalRowFormula",C="DoInsertRows",w="tableShowFooter",x="tableInsertRowsAboveForContextMenu",A="tableInsertRowsBelowForContextMenu",M="tableDeleteRowsForContextMenu",S="tableInsertColumnsLeftForContextMenu",T="tableInsertColumnsRightForContextMenu",N="tableDeleteColumnsForContextMenu",I=void 0,R=function(e){function t(t,n){var o=e.call(this,t)||this;return o._Lb=n,o.aMb=n.tableName,o.bMb=n.resizeToRange,o}return H(t,e),t.prototype.execute=function(){var e,t,n,r,i,s,l,u=this,c=!1;if(u.canExecute()){t=(e=u.kj)._modelManager,n=u.aMb,r=u._Lb,t.startTransaction(),u.Lz(e,!0);try{(i=e.tables.findByName(n))&&(s=i.range(),l=u.bMb,e.tables.resize(i,l),a(e,i,s,l),c=!0)}finally{u.Mz(e),r[o.Commands.bWa(e.name())]=t.endTransaction()}}return c},t.prototype.undo=function(){var e,t,n,r,i=this,s=i.kj,l=i.aMb,u=!1;if(i.canUndo()){i.Lz(s,!0);try{e=i._Lb,t=s._modelManager,n=s.tables.findByName(l),(r=e[o.Commands.bWa(s.name())])&&(t.undo(r),a(s,n,e.resizeToRange,n.range()),t.wVa(r.uVa),u=!0)}finally{i.Mz(s,!0)}}return u},t}(f),o.Commands[p]={canUndo:!0,execute:function(e,t,n){return o.Commands.h4(e,R,t,n)}},k=function(e){function t(t,n){var o=e.call(this,t)||this;return o.cMb=n,o.aMb=n.tableName,o.cj=n.row,o.Jb=n.count,o.dMb=n.isAfter,o}return H(t,e),t.prototype.execute=function(){var e,t,n,r,i,a,l,u,c,f=this,h=!1;if(f.canExecute()){t=(e=f.kj)._modelManager,n=f.aMb,r=f.cj,i=f.Jb,a=f.dMb,t.startTransaction(),f.Lz(e,!0);try{(l=e.tables.findByName(n))&&(u=l.Xj,l.Nia(r,i,a),h=!0,l.Xj-u===i&&s(e,l,d,r,i,a))}finally{f.Mz(e),c=o.Commands.bWa(e.name()),f.cMb[c]=t.endTransaction()}}return h},t.prototype.undo=function(){var e,t,n,r,i,a,l,u,f=this,h=f.kj,p=!1;if(f.canUndo()){f.Lz(h,!0);try{e=f.cMb,t=h._modelManager,n=e[o.Commands.bWa(h.name())],r=e.row,i=e.count,a=e.isAfter,n&&(t.undo(n),t.wVa(n.uVa),(l=h.tables.findByName(f.aMb))&&(u=a?r+1:r,l.ihc(u,i),l.NAb(),l.WNb(u,i,c(!0)),s(h,l,g,r,i,I,l.nKb())),p=!0)}finally{f.Mz(h,!0)}}return p},t}(f),o.Commands[d]={canUndo:!0,execute:function(e,t,n){return o.Commands.h4(e,k,t,n)}},E=function(e){function t(t,n){var o=e.call(this,t)||this;return o.cMb=n,o.aMb=n.tableName,o.cj=n.row,o.Jb=n.count,o.dMb=n.isAfter,o}return H(t,e),t.prototype.execute=function(){var e,t,n,r,i,a,l,u,c=this,f=!1;if(c.canExecute()){t=(e=c.kj)._modelManager,n=c.aMb,r=c.cj,i=c.Jb,a=c.dMb,t.startTransaction(),c.Lz(e,!0);try{(l=e.tables.findByName(n))&&(l.eMb(r,i,a,!1),s(e,l,d,r,i,a),c.cMb.row=r,c.cMb.count=i,f=!0)}finally{c.Mz(e),u=o.Commands.bWa(e.name()),c.cMb[u]=t.endTransaction()}}return f},t.prototype.undo=function(){var e,t,n,r,i,a,l,u,f=this,h=f.kj,p=!1;if(f.canUndo()){f.Lz(h,!0);try{e=f.cMb,t=h._modelManager,n=e[o.Commands.bWa(h.name())],r=e.row,i=e.count,a=e.isAfter,n&&(t.undo(n),t.wVa(n.uVa),(l=h.tables.findByName(f.aMb))&&(u=a?r+1:r,l.ihc(u,i),l.NAb(),l.WNb(u,i,c(!0)),s(h,l,g,r,i,l.nKb())),p=!0)}finally{f.Mz(h,!0)}}return p},t}(f),o.Commands[C]={canUndo:!0,execute:function(e,t,n){return o.Commands.h4(e,E,t,n)}},D=function(e){function t(t,n){var o=e.call(this,t)||this;return o.fMb=n,o.aMb=n.tableName,o.cj=n.row,o.Jb=n.count,o}return H(t,e),t.prototype.execute=function(){var e,t,n,r,i,a,l,u,c=this,f=!1;if(c.canExecute()){t=(e=c.kj)._modelManager,n=c.aMb,r=c.cj,i=c.Jb,t.startTransaction(),c.Lz(e,!0);try{(a=e.tables.findByName(n))&&(l=a.Xj,a.STa(r,i),f=!0,l-a.Xj===i&&s(e,a,g,r,i,I,a.nKb()))}finally{c.Mz(e),u=o.Commands.bWa(e.name()),c.fMb[u]=t.endTransaction()}}return f},t.prototype.undo=function(){var e,t,n,r,i,a,l=this,u=l.kj,c=!1;if(l.canUndo()){l.Lz(u,!0);try{e=l.fMb,t=u._modelManager,n=e[o.Commands.bWa(u.name())],r=e.row,i=e.count,n&&(t.undo(n),t.wVa(n.uVa),(a=u.tables.findByName(l.aMb))&&a.NAb(),c=!0,s(u,a,d,r,i,!1))}finally{l.Mz(u,!0)}}return c},t}(f),o.Commands[g]={canUndo:!0,execute:function(e,t,n){return o.Commands.h4(e,D,t,n)}},j=function(e){function t(t,n){var o=e.call(this,t)||this;return o.gMb=n,o.aMb=n.tableName,o.dj=n.col,o.Jb=n.count,o.dMb=n.isAfter,o}return H(t,e),t.prototype.execute=function(){var e,t,n,r,i,a,s,u,c,f=this,h=!1;if(f.canExecute()){t=(e=f.kj)._modelManager,n=f.aMb,r=f.dj,i=f.Jb,a=f.dMb,t.startTransaction(),f.Lz(e,!0);try{(s=e.tables.findByName(n))&&(u=s.OZ,s.hMb(r,i,a),h=!0,s.OZ-u===i&&l(e,s,m,r,i,a))}finally{f.Mz(e),c=o.Commands.bWa(e.name()),f.gMb[c]=t.endTransaction()}}return h},t.prototype.undo=function(){var e,t,n,r,i,a,s=this,u=s.kj,c=!1;if(s.canUndo()){s.Lz(u,!0);try{e=s.gMb,t=u._modelManager,n=e[o.Commands.bWa(u.name())],r=e.col,i=e.count,n&&(t.undo(n),t.wVa(n.uVa),(a=u.tables.findByName(s.aMb))&&a.NAb(),c=!0,l(u,a,y,r,i))}finally{s.Mz(u,!0)}}return c},t}(f),o.Commands[m]={canUndo:!0,execute:function(e,t,n){return o.Commands.h4(e,j,t,n)}},_=function(e){function t(t,n){var o=e.call(this,t)||this;return o.iMb=n,o.aMb=n.tableName,o.dj=n.col,o.Jb=n.count,o}return H(t,e),t.prototype.execute=function(){var e,t,n,r,i,a,s,u,c=this,f=!1;if(c.canExecute()){t=(e=c.kj)._modelManager,n=c.aMb,r=c.dj,i=c.Jb,t.startTransaction(),c.Lz(e,!0);try{(a=e.tables.findByName(n))&&(s=a.OZ,a.TTa(r,i),f=!0,s-a.OZ===i&&l(e,a,y,r,i))}finally{c.Mz(e),u=o.Commands.bWa(e.name()),c.iMb[u]=t.endTransaction()}}return f},t.prototype.undo=function(){var e,t,n,r,i,a,s=this,u=s.kj,c=!1;if(s.canUndo()){s.Lz(u,!0);try{e=s.iMb,t=u._modelManager,n=e[o.Commands.bWa(u.name())],r=e.col,i=e.count,n&&(t.undo(n),t.wVa(n.uVa),(a=u.tables.findByName(s.aMb))&&a.NAb(),c=!0,l(u,a,m,r,i,!1))}finally{s.Mz(u,!0)}}return c},t}(f),o.Commands[y]={canUndo:!0,execute:function(e,t,n){return o.Commands.h4(e,_,t,n)}},O=function(e){function t(t,n){var o=e.call(this,t)||this;return o.jMb=n,o.aMb=n.tableName,o}return H(t,e),t.prototype.execute=function(){var e,t,n,r,i,a=this,s=!1;if(a.canExecute()){t=(e=a.kj)._modelManager,n=a.aMb,t.startTransaction(),a.Lz(e,!0);try{(r=e.tables.findByName(n))&&(e.tables.remove(r,3),s=!0)}finally{a.Mz(e),i=o.Commands.bWa(e.name()),a.jMb[i]=t.endTransaction()}}return s},t.prototype.undo=function(){var e,t,n,r,i=this,a=i.kj,s=!1;if(i.canUndo()){i.Lz(a,!0);try{e=i.jMb,t=a._modelManager,(n=e[o.Commands.bWa(a.name())])&&(t.undo(n),t.wVa(n.uVa),(r=a.tables.findByName(i.aMb))&&r.NAb(),s=!0)}finally{i.Mz(a,!0)}}return s},t}(f),o.Commands[v]={canUndo:!0,execute:function(e,t,n){return o.Commands.h4(e,O,t,n)}},F=function(e){function t(t,n){var o=e.call(this,t)||this,r=o;return r.kMb=n,r.cj=n.row,r.dj=n.col,r.Yw=n.newValue,o}return H(t,e),t.prototype.execute=function(){var e,t,n,r,i,a,s=this,l=!1;if(s.canExecute()){(t=(e=s.kj)._modelManager).startTransaction(),s.Lz(e,!0);try{n=s.cj,r=s.dj,i=s.Yw,e.setFormula(n,r,i),i||e.setValue(n,r,null),l=!0}finally{s.Mz(e),a=o.Commands.bWa(e.name()),s.kMb[a]=t.endTransaction()}}return l},t.prototype.undo=function(){var e,t,n,r=this,i=r.kj,a=!1;if(r.canUndo()){r.Lz(i,!0);try{e=r.kMb,t=i._modelManager,(n=e[o.Commands.bWa(i.name())])&&(t.undo(n),t.wVa(n.uVa),a=!0)}finally{r.Mz(i,!0)}}return a},t}(f),o.Commands[b]={canUndo:!0,execute:function(e,t,n){return o.Commands.h4(e,F,t,n)}},P=function(e){function t(t,n){var o=e.call(this,t)||this;return o.lMb=n,o.aMb=n.tableName,o}return H(t,e),t.prototype.execute=function(){var e,t,n,r,i,a=this,s=!1;if(a.canExecute()){t=(e=a.kj)._modelManager,n=a.aMb,t.startTransaction(),a.Lz(e,!0);try{(r=e.tables.findByName(n))&&(r.showFooter(!0),s=!0)}finally{a.Mz(e),i=o.Commands.bWa(e.name()),a.lMb[i]=t.endTransaction()}}return s},t.prototype.undo=function(){var e,t,n,r=this,i=r.kj,a=!1;if(r.canUndo()){r.Lz(i,!0);try{e=r.lMb,t=i._modelManager,(n=e[o.Commands.bWa(i.name())])&&(t.undo(n),t.wVa(n.uVa),a=!0)}finally{r.Mz(i,!0)}}return a},t}(f),o.Commands[w]={canUndo:!0,execute:function(e,t,n){return o.Commands.h4(e,P,t,n)}},o.Commands[x]={canUndo:!0,execute:function(e,t,n){var r,i,a,s,l,c,f;return t.cmd=x,h(t.row)&&h(t.count)?(r=o.Commands.bT(e,t),a=void 0,s=void 0,l=void 0,c=void 0,1===(i=t.selections).length&&(a=i[0],(s=u(r,a))&&(l=a.row,c=a.rowCount,f=s.footerIndex()===l,t.row=f?l-1:l,t.count=c,t.tableName=s.name(),t.isAfter=f),o.Commands.h4(e,k,t,n))):o.Commands.h4(e,k,t,n)}},o.Commands[A]={canUndo:!0,execute:function(e,t,n){if(t.cmd=A,h(t.row)&&h(t.count)){var r=o.Commands.bT(e,t),i=t.selections,a=void 0,s=void 0,l=void 0,c=void 0;return 1===i.length&&(a=i[0],(s=u(r,a))&&(l=a.row,c=a.rowCount,t.row=l,t.count=c,t.tableName=s.name(),t.isAfter=!0),o.Commands.h4(e,k,t,n))}return o.Commands.h4(e,k,t,n)}},o.Commands[M]={canUndo:!0,execute:function(e,t,n){if(t.cmd=M,h(t.row)&&h(t.count)){var r=o.Commands.bT(e,t),i=t.selections,a=void 0,s=void 0,l=void 0,c=void 0;return 1===i.length&&(a=i[0],(s=u(r,a))&&(l=a.row,c=a.rowCount,t.row=l,t.count=c,t.tableName=s.name()),o.Commands.h4(e,D,t,n))}return o.Commands.h4(e,D,t,n)}},o.Commands[S]={canUndo:!0,execute:function(e,t,n){if(t.cmd=S,h(t.col)&&h(t.count)){var r=o.Commands.bT(e,t),i=t.selections,a=void 0,s=void 0,l=void 0,c=void 0;return 1===i.length&&(a=i[0],(s=u(r,a))&&(l=a.col,c=a.colCount,t.col=l,t.count=c,t.tableName=s.name(),t.isAfter=!1),o.Commands.h4(e,j,t,n))}return o.Commands.h4(e,j,t,n)}},o.Commands[T]={canUndo:!0,execute:function(e,t,n){if(t.cmd=T,h(t.col)&&h(t.count)){var r=o.Commands.bT(e,t),i=t.selections,a=void 0,s=void 0,l=void 0,c=void 0;return 1===i.length&&(a=i[0],(s=u(r,a))&&(l=a.col,c=a.colCount,t.col=l,t.count=c,t.tableName=s.name(),t.isAfter=!0),o.Commands.h4(e,j,t,n))}return o.Commands.h4(e,j,t,n)}},o.Commands[N]={canUndo:!0,execute:function(e,t,n){if(t.cmd=N,h(t.col)&&h(t.count)){var r=o.Commands.bT(e,t),i=t.selections,a=void 0,s=void 0,l=void 0,c=void 0;return 1===i.length&&(a=i[0],(s=u(r,a))&&(l=a.col,c=a.colCount,t.col=l,t.count=c,t.tableName=s.name()),o.Commands.h4(e,_,t,n))}return o.Commands.h4(e,_,t,n)}},o.Commands.mMb=function(e){e.register(p,o.Commands[p]),e.register(d,o.Commands[d]),e.register(C,o.Commands[C]),e.register(g,o.Commands[g]),e.register(m,o.Commands[m]),e.register(y,o.Commands[y]),e.register(v,o.Commands[v]),e.register(b,o.Commands[b]),e.register(w,o.Commands[w]),e.register(x,o.Commands[x]),e.register(A,o.Commands[A]),e.register(M,o.Commands[M]),e.register(S,o.Commands[S]),e.register(T,o.Commands[T]),e.register(N,o.Commands[N])}},"./dist/plugins/table/table-event.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g;Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("@grapecity/js-sheets-common"),i=n("./dist/plugins/table/table.js"),a=n("./dist/plugins/table/table.ns.js"),s=n("./dist/plugins/table/table-util.js"),l=r.Common.j.Fa,u=null,c=Math.abs,f=new r.Common.ResourceManager(a.SR),h=f.getResource.bind(f),p=s.Util.nMb,d=s.Util.oMb,g=s.Util.pMb,o.GC$.extend(o.iI.prototype,{oIb:function(e,t){var n=this.qgc(e,t);n&&t.setSelection(n.row,n.col,n.rowCount,n.colCount)},qgc:function(e,t){var n,r,a,s,c,f,h,p,d=t.getSelections(),g=e.tableSelectInfo;if(!t.isEditing()||t.getActiveRowIndex()===e.row&&t.getActiveColumnIndex()===e.col||t.endEdit(),r=0,a=0,(n=g.table).NZ&&(r=1),n.MZ&&(a=1),s=u,c=g.action,f=t._formulaTextBox&&t._formulaTextBox.ahc(),!l(f)&&f.length>0&&(d=f),c===i.TableSelectionType.TABLE_ROW_SELECT)s=o.kf(e.row,n.dj,1,n.OZ);else if(c===i.TableSelectionType.TABLE_COL_SELECT){for(h=0;h<d.length;h++)if((p=d[h]).col===e.col&&p.row===n.cj+a&&1===p.colCount&&p.rowCount===n.Xj-a-r){s=o.kf(n.cj,e.col,n.Xj,1);break}l(s)&&(s=o.kf(n.cj+a,e.col,n.Xj-a-r,1))}else if(c===i.TableSelectionType.TABLE_CORNER_SELECT){for(h=0;h<d.length;h++)if((p=d[h]).col===n.dj&&p.row===n.cj+a&&p.colCount===n.OZ&&p.rowCount===n.Xj-a-r){s=o.kf(n.cj,n.dj,n.Xj,n.OZ);break}l(s)&&(s=o.kf(n.cj+a,n.dj,n.Xj-a-r,n.OZ))}else c===i.TableSelectionType.TABLE_SELECT&&(s=o.kf(n.cj,n.dj,n.Xj,n.OZ));return s},iJb:function(e,t){var n,o,r,i,a,s,l,c,f,h,g,m,y,v,b=this.kj,C=u;return b&&!b.options.isProtected&&!b.isEditing()&&t&&t.showResizeHandle()?(n=e.row,o=e.col,r=e.x,i=e.y,a=e.rowViewportIndex,s=e.colViewportIndex,l=p(b,t),c=d(b,t),n===l&&o===c&&(h=(f=b.getCellRect(n,o,a,s)).x,g=f.y,m=f.width,v=g+f.height,r>=(y=h+m)-10&&r<=y&&i>=v-10&&i<=v&&(C={x:r,y:i,table:t})),C):C},pIb:function(e){var t,n,o,r,i,a=this;!0!==a.qIb&&!0!==a._isWorking&&(t=a.kj,(o=(n=e.resizeTableHitInfo)&&n.table)&&!o.hJb()&&(a.qIb=!0,a._isWorking=!0,a.qMb=o,a.rMb=o.cj,a.sMb=o.dj,a.tMb=o.Xj,a.uMb=o.OZ,r=a.rMb+a.tMb-1,i=a.sMb+a.uMb-1,a.vMb=t.getCellRect(r,i),a.wMb=o.range(),a.rG={KG:e.rowViewportIndex,MG:e.colViewportIndex,sG:e.hitTestType},a.qG()))},rIb:function(){var e,t=this,n=t.kj;t.rG&&t.qIb&&t._isWorking&&t.qMb&&(t.xMb(),t.yMb()&&(t.zMb=t.AMb(),t.BMb(),t.CMb(),(e=t.DMb)||(e=t.EMb()),e.equals(t.FMb)||(t.DMb=o.kf(t.FMb.row,t.FMb.col,t.FMb.rowCount,t.FMb.colCount),g(n,t.qMb,t.EMb(),t.FMb))),t.NG())},wIb:function(){var e,t=this,n=t.kj;return t.RG(),t.qIb&&t._isWorking&&t.FMb&&t.qMb?(t.qIb=!1,t._isWorking=!1,void(t.HMb()?(e=t.EMb(),t.IMb(),e.equals(t.FMb)?n._render.JMb():n.wu().execute({cmd:"tableResize",sheetName:n.name(),tableName:t.qMb.name(),resizeToRange:t.FMb}),t.GMb()):(t.GMb(),n._render.JMb()))):void t.GMb()},EMb:function(){var e=this.qMb;return o.kf(e.cj,e.dj,e.Xj,e.OZ)},xMb:function(){var e=this,t=e.fH(),n=e.gH();e.KMb=t,e.LMb=n},yMb:function(){var e=this,t=e.rMb,n=e.sMb,o=e.KMb,r=e.LMb;return o>=(e.qMb.MZ?t+1:t)&&r>=n},AMb:function(){var e=this.$F,t=this.vMb,n=t.x+t.width,o=t.y+t.height,r=e.x,i=e.y;return c(o-i)>=c(n-r)?i<o?2:3:r<n?0:1},BMb:function(){var e=this,t=e.rMb,n=e.sMb,r=e.KMb,i=e.LMb,a=e.zMb,s=e.tMb,l=e.uMb;switch(a){case 0:case 1:l=c(i-n)+1;break;case 2:case 3:s=c(r-t)+1}e.FMb?(e.FMb.rowCount=s,e.FMb.colCount=l):e.FMb=o.kf(t,n,s,l)},CMb:function(){var e=this;e.kj._render.JMb(),e.wMb=e.MMb()},MMb:function(){var e=this.FMb,t=e.row,n=e.col,r=e.rowCount,i=e.colCount;return o.kf(t,n,r,i)},IMb:function(){var e=this,t=e.qMb;2===e.zMb&&t.NZ&&(e.FMb.rowCount+=1)},HMb:function(){var e=this,t=e.kj,n=!1,o=t._modelManager,r=t.tables,i=e.qMb,a=e.FMb,s=a.row,l=a.col,u=a.rowCount,c=a.colCount,f=e.KMb,g=e.LMb,m=p(t,i),y=d(t,i),v=e.zMb,b=i.xr;return m&&y?(o.MTa(s,l,u,c)||o.qu(s,l,u,c)?t.Os(6,h().Exp_TableResizeToSpan):b&&b.isFiltered()?2===v?t.Os(6,h().Exp_TableResizeWithHidden):3===v&&i.NZ?t.Os(6,h().Exp_TableResizeWithFilter):n=!0:2===v&&e.NMb(m,f)||0===v&&e.OMb(y,g)?t.Os(6,h().Exp_TableResizeWithHidden):1===v&&(r.rn(s,y+1,u,g-y)||r.HZ(s,y+1,u,g-y))||3===v&&(r.rn(m+1,l,f-m,c)||r.HZ(m+1,l,f-m,c))?t.Os(6,h().Exp_TableResizeToTable):n=!0,n):n},NMb:function(e,t){var n,o=this.kj,r=!1;for(n=e;n>t;n--)if(o.getRowHeight(n)<=0){r=!0;break}return r},OMb:function(e,t){var n,o=this.kj,r=!1;if(!r)for(n=e;n>t;n--)if(o.getColumnWidth(n)<=0){r=!0;break}return r},GMb:function(){var e=this;e.qIb=!1,e._isWorking=!1,e.rG=u,e.FMb=u,e.DMb=u}})},"./dist/plugins/table/table-render.js":function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),(0,(o=n("Core")).GC$.extend)(o.oJ.prototype,{JMb:function(){this.kj.Xq>0||this.im()}}),o.Worksheet.$n("tableRender",{paintAdornment:function(e){var t=e.ctx,n=this._eventHandler;n&&n.rG&&n.qIb&&function(e,t,n,o){var r=e._eventHandler.FMb,i=e.getRangeRect(n,o,r);t.strokeStyle=e.getSelectionBorderColor(),t.strokeRect(i.x,i.y,i.width,i.height)}(this,t,n.iH(),n.jH())}})},"./dist/plugins/table/table-theme.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H;function B(e,t){return isNaN(t)?t:new o.LineBorder(e,t)}function L(e,t,n,o,r,i,a,s,l,u){var c=new j;return t&&(c.backColor=t),n&&(c.foreColor=n),o&&(c.font="bold 11pt calibri"),r&&(c.borderLeft=B(e,r)),i&&(c.borderTop=B(e,i)),a&&(c.borderRight=B(e,a)),s&&(c.borderBottom=B(e,s)),l&&(c.borderHorizontal=B(e,l)),u&&(c.borderVertical=B(e,u)),c}function z(e){return 0===e?"Text 1":"Accent "+e}function V(e){var t,n=e-1,o=h,r=c(n/7);return r>=0&&r<3&&(t="Light"+e,(o=[G,W,U][r](n%7)).name&&o.name(t),o.builtInName&&o.builtInName(t)),o}function G(e){var t=z(e),n=t+" 80",o=new _;return o[p](L(t,0,t,1,0,0,0,1)),o[g](L(t,0,t,0,0,1,0,1)),o[v](L(t,n)),o[y](L(t,0,t,1)),o[m](L(t,0,t,1)),o[C](L(t,n)),o[d](L(t,0,t,1,0,1)),o}function W(e){var t=z(e),n=new _;return n[p](L(t,t,O,1)),n[g](L(t,0,0,0,1,1,1,1)),n[v](L(t,0,0,0,0,1)),n[b](L(t,0,0,0,0,1)),n[C](L(t,0,0,0,1)),n[w](L(t,0,0,0,1)),n[y](L(t,0,0,1)),n[m](L(t,0,0,1)),n[d](L(t,0,0,1,0,6)),n}function U(e){var t=z(e),n=t+" 80",o=new _;return o[p](L(t,0,0,1,0,0,0,2)),o[g](L(t,0,0,0,1,1,1,1,1,1)),o[v](L(t,n)),o[C](L(t,n)),o[y](L(t,0,0,1)),o[m](L(t,0,0,1)),o[d](L(t,0,0,1,0,6)),o}function Z(e){var t,n=e-1,o=h,r=c(n/7);return r>=0&&r<4&&(t="Medium"+e,(o=[q,J,Q,Y][r](n%7)).name(t),o.builtInName(t)),o}function q(e){var t=z(e),n=t+" 20",o=t,r=t+" 80",i=new _;return i[p](L(n,o,O,1)),i[g](L(n,0,0,0,1,1,1,1,1)),i[v](L(n,r)),i[C](L(n,r)),i[y](L(n,0,0,1)),i[m](L(n,0,0,1)),i[d](L(n,0,F,1,0,6)),i}function J(e){var t=z(e),n=O,o=t,r=t+" 60",i=t+" 80",a=new _;return a[p](L(n,o,O,1,0,0,0,2,0,1)),a[g](L(n,i,0,0,0,0,0,0,1,1)),a[v](L(n,r)),a[C](L(n,r)),a[y](L(n,o,O,1)),a[m](L(n,o,O,1)),a[d](L(n,o,O,1,0,2,0,0,0,1)),a}function Q(e){var t="#D3D3D3",n=z(e),r=t,i=0===e?F:t,a=new _;return a[p](L(F,n,O,1,0,2,0,2)),a[g](L(i,0,0,0,1,new o.LineBorder(F,2),1,new o.LineBorder(F,2),0===e?1:0,1)),a[v](L(i,r)),a[C](L(i,r)),a[y](L(i,n,O)),a[m](L(i,n,O)),a[x](L(i,n,O,1)),a[A](L(i,n,O,1)),a[d](L(F,0,F,0,0,6)),a}function Y(e){var t=z(e),n=t,r=t+" 40",i=t+" 80",a=t+" 60",s=t+" 80",l=new _;return l[p](L(r,i,F,1,1,1,1,1,0,1)),l[g](L(r,i,0,0,1,1,1,1,1,1)),l[v](L(r,a)),l[C](L(r,a)),l[y](L(r,0,0,1)),l[m](L(r,0,0,1)),l[d](L(r,s,F,1,1,new o.LineBorder(n,2),1,1,0,1)),l}function K(e){var t,n=e-1,o=h,r=c(n/7);return r>=0&&r<2&&(t="Dark"+e,(o=[$,X][r](n%7)).name(t),o.builtInName(t)),o}function $(e){var t=z(e),n=0===e?t+" 25":t+" -25",o=0===e?t+" 50":t,r=0===e?t:t+" -50",i=new _;return i[p](L(O,"black",O,1,0,0,0,2)),i[g](L(t,o,O)),i[v](L(t,n)),i[C](L(t,n)),i[y](L(O,n,O,1,0,0,2)),i[m](L(O,n,O,1,2)),i[d](L(O,r,O,1,0,2)),i}function X(e){var t,n,o,r,i,a;function s(e,t){if(e<0||e>3)return"";return{tableBackground:["Background 1 -15","Accent 1 80","Accent 3 80","Accent 5 80"],stripColor:["Background 1 -35","Accent 1 60","Accent 3 60","Accent 5 60"],headerColor:["Text 1","Accent 2","Accent 4","Accent 6"]}[t][e]}return t=z(e),n=s(e,"headerColor"),o=s(e,"stripColor"),i=r=s(e,"tableBackground"),(a=new _)[p](L(t,n,O)),a[g](L(t,r)),a[v](L(t,o)),a[C](L(t,o)),a[y](L(t,0,0,1)),a[m](L(t,0,0,1)),a[d](L(F,i,0,1,0,6)),a}for(Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=o.GC$.each,i=o.GC$.isEmptyObject,a=o.Ul.Ol,s=JSON.stringify,l=JSON.parse,u=o.Ul.Pl,c=Math.floor,f=void 0,h=null,"firstHeaderCellStyle","lastHeaderCellStyle",M=[p="headerRowStyle",d="footerRowStyle",g="wholeTableStyle",m="highlightLastColumnStyle",y="highlightFirstColumnStyle",v="firstRowStripStyle",b="secondRowStripStyle",C="firstColumnStripStyle",w="secondColumnStripStyle","firstHeaderCellStyle","lastHeaderCellStyle",x="firstFooterCellStyle",A="lastFooterCellStyle"],"firstRowStripSize","secondRowStripSize","firstColumnStripSize","secondColumnStripSize",S=["firstRowStripSize","secondRowStripSize","firstColumnStripSize","secondColumnStripSize"],"name","bold 11pt calibri",D=["backColor","foreColor","font",T="borderLeft",N="borderTop",I="borderRight",R="borderBottom",k="borderHorizontal",E="borderVertical","textDecoration"],j=function(){function e(e,t,n,o,i,a,s,l,u,c){var f=this,h=arguments;r(D,(function(e,t){f[t]=h[e]}))}return e.prototype.Yo=function(e,t,n,o,i){var s=this;r(D,(function(r,l){l.indexOf("border")>=0?(n&&a(s[T])&&!a(e[T])&&(e[T]=s[T],e[T].level=20),t&&a(s[N])&&!a(e[N])&&(e[N]=s[N],e[N].level=20),i&&a(s[I])&&!a(e[I])&&(e[I]=s[I],e[I].level=20),o&&a(s[R])&&!a(e[R])&&(e[R]=s[R],e[R].level=20),o||!a(s[k])||a(e[R])||(e[R]=s[k],e[R].level=20),i||!a(s[E])||a(e[I])||(e[I]=s[E],e[I].level=20)):a(s[l])&&!a(e[l])&&(e[l]=s[l])}))},e.prototype.Uo=function(){var t=new e,n=s(this.toJSON());return t.fromJSON(l(n)),t},e.prototype.toJSON=function(){var e=this,t={};return r(D,(function(n,o){var r=e[o],a=r&&r.toJSON?r.toJSON():r;t[o]=i(a)?f:a})),t},e.prototype.fromJSON=function(e,t){if(e){var n=this;r(D,(function(r,i){var s,l=e[i];a(l)&&(i.indexOf("border")>=0?((s=new o.LineBorder).fromJSON(l,t),n[i]=s):n[i]=l)}))}},e}(),t.TableStyle=j,_=function(){function e(){}return e.prototype.toJSON=function(){var e,t,n=this,o=n.builtInName();return o?{buildInName:o}:(e={name:n.name()},r(M,(function(o,r){(t=n[r]())&&(e[r]=t.toJSON())})),r(S,(function(o,r){1!==(t=n[r]())&&(e[r]=t)})),i(e)?f:e)},e.prototype.fromJSON=function(e,t){var n,o,i,s;if(e){if(n=this,o=e.buildInName)return void function(e,t){e.name(t.name()),r(S,(function(n,o){e[o](t[o]())})),r(M,(function(n,o){var r=t[o]();e[o](r?r.Uo():h)})),e.builtInName(t.builtInName(),!1)}(n,P[o.toLowerCase()]);i=e.name,s=a(i)?i:e.Cj,a(s)&&n.name(s,!1),r(S,(function(t,o){var r=e[o]!==f?e[o]:e["_"+o];r&&n[o](r,!1)})),r(M,(function(o,r){var i,a=e[r]!==f?e[r]:e["_"+r];a&&((i=new j).fromJSON(a,t),n[r](i,!1))}))}},e}(),t.TableTheme=_,_.prototype.name=u("name"),_.prototype.builtInName=u("builtInName"),r(M,(function(e,t){_.prototype[t]=u(t)})),r(S,(function(e,t){_.prototype[t]=u(t,1)})),O="white",F="black",P=function(){},t.TableThemes=P,H=1;H<=28;H++)H<=21&&(P["light"+H]=V(H)),H<=11&&(P["dark"+H]=K(H)),P["medium"+H]=Z(H)},"./dist/plugins/table/table-util.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g;function m(e){throw Error(e)}function y(e){e.suspendPaint()}function v(e){e.resumePaint()}function b(e){i&&e.suspendCalcService()}function C(e,t){i&&e.resumeCalcService(t)}function w(e){return e&&!(/\d/.test(e[0])||/[\s\+\-\*\\:%!\[\]]/.test(e)||-1!==["C","c","R","r"].indexOf(e)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(e)||/^[Rr]\d*[Cc]\d*$/.test(e)||e.length>=255)}function x(e,t,n,o,r){return r=r===c||r,e.Wu.unparse(e.yj(),t,n,o,!1,r)}function A(e,t,n){var o=e.getValue(t,n);return!(o===u||!l(o))||!!(e.getSparkline&&e.getSparkline(t,n))||M(e.Iq(t,n))}function M(e){return!(!e||!(e.backColor||e.backgroundImage||e.borderBottom||e.borderLeft||e.borderRight||e.borderTop||e.diagonalDown||e.diagonalUp))}function S(e,t,n,o,r,i,a,s){return e>=r&&!(t===a&&t+o-1===s)&&(t<a&&t+o>=a||t>=a&&t<=s&&t+o-1>s)}function T(e,t,n,o,r,i,a,s){return t>=a&&!(e===r&&e+n-1===i)&&(e<r&&e+n>=r||e>=r&&e<=i&&e+n-1>i)}function N(e){var t,n,o,r,i=e._modelManager,a=i._getSheetModel(3).dataTable,s=i.getLastNonNullRow(3,!0),l=e.getRowCount(),u=e.getColumnCount();for(o=l-1;o>-1;o--)if(t=a[o])for(r=0;r<u;r++)if((n=t[r])&&!h(n.value))return f(o,s);return f(-1,s)}function I(e){var t,n,o,r,i=e._modelManager,a=i._getSheetModel(3).dataTable,s=i.getLastNonNullCol(3,!0),l=e.getRowCount();for(o=e.getColumnCount()-1;o>-1;o--)for(r=0;r<l;r++)if((n=(t=a[r])&&t[o])&&!h(n.value))return f(o,s);return f(-1,s)}function R(e,t){var n=e.cj;return t-(e.MZ?n+1:n)}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("SheetsCalc"),i=n("@grapecity/js-calc"),a=n("@grapecity/js-sheets-common"),s=n("./dist/plugins/table/table.ns.js"),l=o.Ul.Ol,u=null,c=void 0,f=Math.max,h=a.Common.j.Fa,p=0,d=new a.Common.ResourceManager(s.SR),g=d.getResource.bind(d),t.Util={throwError:m,setFormulaToSheet:function(e,t,n,o,r){!o&&r&&(o=x(e,r,t,n)),i&&e._u(t,n,o,r)},setValue:function(e,t,n,o){e.setValue(t,n,o)},suspendPaint:y,resumePaint:v,ih:function(e){return e.Cf().ih()},suspendCalcService:b,resumeCalcService:C,RMb:function(e){e&&(y(e),e.suspendEvent(),b(e))},SMb:function(e){e&&(C(e),e.resumeEvent(),v(e))},getRowCount:function(e){return e.rowCount},getColCount:function(e){return e.colCount},isValidTableName:w,formulaToExpression:function(e,t,n,o,r){var i,a=e.yj();return a.DLb=r,i=e.Wu.parse(a,t,n,o,!1,!1,!1),delete a.DLb,i},expressionToFormula:x,checkTableName:function(e){var t,n,o,r;return!(!e||(w(e)||m(g().Exp_TableNameInvalid),t=this,n=t.name(),o=t.tc,e===n||o&&(r=o.findByName(e),r&&t!==r)))},TMb:function(e,t,n){return{col:t,leadingCellRow:n,row:e}},nMb:function(e,t,n){var o=u,r=t.cj,i=t.endRow();for(n&&(i-=t.NZ?1:0);i>=r&&e.getRowHeight(i)<=0;)i--;return i>=r&&(o=i),o},oMb:function(e,t){for(var n=u,o=t.dj,r=t.endColumn();r>=o&&e.getColumnWidth(r)<=0;)r--;return r>=o&&(n=r),n},UMb:function(e,t){var n,r,i,a=t.tc,s=t.cj+t.Xj-1,l=t.dj,u=l+t.OZ-1,c=N(e),h=a?a.PMb():-1;return n=s,(c=f(c,h))>s&&(r=s+1,i=new o.Range(r,l,c-s,u-l+1),n=f(function(e,t,n,o,r){var i,a,s;for(i=n;i>=t;i--)for(a=o;a<=r;a++){if(M(e.Iq(i,a)))return i;if(A(e,i,a))return i;if(s=e._modelManager.findSpan(i,a))return s.row+s.rowCount-1}return-1}(e,r,c,l,u),a.PMb(i))),n},VMb:function(e,t){var n,r,i,a=t.tc,s=t.cj,l=s+t.Xj-1,u=t.dj+t.OZ-1,c=I(e),h=a?a.QMb():-1;return n=u,(c=f(c,h))>u&&(r=u+1,i=new o.Range(s,r,l-s+1,c-u),n=f(function(e,t,n,o,r){var i,a,s;for(a=r;a>=o;a--)for(i=t;i<=n;i++){if(M(e.Iq(i,a)))return a;if(A(e,i,a))return a;if(s=e._modelManager.findSpan(i,a))return s.col+s.colCount-1}return-1}(e,s,l,r,c),a.QMb(i))),n},WMb:function(e,t,n,o,r,i,a,s,l,u){var c,f,h=e.getRowCount()-1,p=e.getColumnCount()-1,d=e._modelManager.getSpans(),y=t.tc&&t.tc.l$;return!s&&(!l&&h-o<a||l&&p-i<a)?(u||m(g().Exp_TableAddRowNoEnoughRoom),!0):(c=l?T:S,(f=d.some((function(e){var t=e.row,a=e.col,s=e.rowCount,l=e.colCount;return c(t,a,s,l,n,o,r,i)})))?u||m(g().Exp_TableAddRowIntersectSpan):y&&((f=y.some((function(e){var t=e.cj,a=e.dj,s=e.Xj,l=e.OZ;return c(t,a,s,l,n,o,r,i)})))&&!u&&m(g().Exp_TableAddRowIntersectTable)),f)},XMb:function(e,t,n){var r,i,a,s=t.row,l=t.col,u=s+t.rowCount,f=l+t.colCount;for(r=s;r<u;r++)for(i=l;i<f;i++)if((a=e.getCell(r,i)).value()||e._modelManager.findSpan(r,i)){if(n&&n.equals(new o.Range(a.row,a.col,1,1)))continue;return new o.Range(r,i,1,1)}return c},YMb:function(e,t){return{action:t,table:e}},ZMb:R,$Mb:function(e,t){return t-e.dj},_Mb:function(e){var t=p;return e&&p++,t},aNb:function(e){return"string"==typeof e},pMb:function(e,t,n,r){var i={sheet:e,table:t,oldRange:n,newRange:r};e.Wq(o.Events.TableResizing,i)},$Lb:function(e,t,n,r){var i={sheet:e,table:t,oldRange:n,newRange:r};e.Wq(o.Events.TableResized,i)},PIb:function(e,t,n,r,i,a,s){var l={sheet:e,table:t,propertyName:n,row:R(t,r),count:i};h(a)||(l.isAfter=a),s&&(l.deletedItem=s),e.Wq(o.Events.TableRowsChanged,l)},QIb:function(e,t,n,r,i,a){var s={sheet:e,table:t,propertyName:n,col:r-t.dj,count:i};h(a)||(s.isAfter=a),e.Wq(o.Events.TableColumnsChanged,s)},bNb:function(e,t,n){var o=0;if(e.VZ(t,n))for(o=2;e.VZ(t+o,o);)o++;return o>0&&(t+=o),t},bW:function(e){return e&&"="===e[0]},cNb:function(e){var t,n,o=-1;if(e)for(t=e.arguments,void 0,n=0;n<t.length;n++)if(t[n]instanceof r.xzb){o=n;break}return o},dNb:function(e,t,n){var o=e.dataRange(),r=o.row,i=o.col;return(n?r:i)+t},eNb:function(e){var t=e;return e&&"="===e[0]&&(t=e.slice(1)),t},fNb:function(e,t){var n,o;for(o=0;o<e.length;o++)if((n=e[o])&&t===n.col)return n;return u},_getTable:function(e,t){var n,o,r;if(!t)return null;for(n=t.row;n<t.row+t.rowCount;n++)for(o=t.col;o<t.col+t.colCount;o++)if(e.tables&&(r=e.tables.find(n,o)))return r;return null},Pda:function(e,t){return t?e.tables.s$(t.row,t.col,t.rowCount,t.colCount):null},jhc:function(e){return h(e)||("string"!=typeof e&&(e+=""),e=e.replace(/\r\n?/g,"\n")),e},gNb:function(e){return e===c}}},"./dist/plugins/table/table.entry.js":function(e,t,n){"use strict";function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),n("./dist/plugins/table/table.interface.js"),n("./dist/plugins/table/table-event.js"),n("./dist/plugins/table/table-render.js"),n("./dist/plugins/table/table-action.js"),n("./dist/plugins/table/table-util.js"),o(n("./dist/plugins/table/table-theme.js")),o(n("./dist/plugins/table/table.js")),o(n("./dist/plugins/table/table.ns.js"))},"./dist/plugins/table/table.interface.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"./dist/plugins/table/table.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe,re,ie,ae,se,le,ue,ce,fe,he,pe,de,ge,me,ye,ve,be,Ce,we,xe,Ae,Me,Se,Te,Ne,Ie,Re,ke,Ee,De,je,_e,Oe,Fe,Pe,He,Be,Le,ze,Ve,Ge,We,Ue,Ze,qe,Je,Qe,Ye,Ke,$e=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Xe=this&&this.__assign||function(){return(Xe=Object.assign||function(e){var t,n,o,r;for(n=1,o=arguments.length;n<o;n++)for(r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function et(e,t){for(var n=e.length-1;n>t;n--)e[n]=e[n-1]}function tt(e,t){var n={position:o.ButtonPosition.right,imageType:o.ButtonImageType.dropdown,visibility:o.ButtonVisibility.onSelected,useButtonStyle:!1,command:"openList"},r={items:[{text:Ue().Table_None,value:null},{text:Ue().Table_Average,value:"=SUBTOTAL(101,["+t+"])"},{text:Ue().Table_Count,value:"=SUBTOTAL(103,["+t+"])"},{text:Ue().Table_Count_Numbers,value:"=SUBTOTAL(102,["+t+"])"},{text:Ue().Table_Max,value:"=SUBTOTAL(104,["+t+"])"},{text:Ue().Table_Min,value:"=SUBTOTAL(105,["+t+"])"},{text:Ue().Table_Sum,value:"=SUBTOTAL(109,["+t+"])"},{text:Ue().Table_StdDev,value:"=SUBTOTAL(107,["+t+"])"},{text:Ue().Table_Var,value:"=SUBTOTAL(110,["+t+"])"}]},i=new o.Style;return i.cellButtons=[n],i.dropDowns=[{type:o.DropDownType.list,option:r,submitCommand:"tableTotalRowFormula"}],i}function nt(e){return function(t,n){var o=this.kj;o&&t!==n&&o._modelManager.pVa(this,e,n)}}function ot(e,t,n,o,r){var i,a,s=0===r,l=s?e.Ts:e.nNb,u=-1;for(a=0;a<l.length;a++)if((i=l[a])&&i.key===o){u=a;break}u>-1&&l.splice(u,v(n)?1:n),s&&e.phc()}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("SheetsCalc"),i=n("@grapecity/js-sheets-common"),a=n("@grapecity/js-calc"),s=n("Filters"),l=n("Bindings"),u=n("./dist/plugins/table/table.ns.js"),c=n("./dist/plugins/table/table-theme.js"),f=n("./dist/plugins/table/table-util.js"),h=o.Ul.Pl,p=o.Ul.Ol,d=o.Ul.bc,g=o.GC$.inArray,m=o.GC$.each,y=o.GC$.isEmptyObject,v=i.Common.j.Fa,b=i.Common.l,C=i.Common.k.Bb,w=i.Common.D,x=f.Util.throwError,A=f.Util.setFormulaToSheet,M=f.Util.setValue,S=f.Util.suspendPaint,T=f.Util.resumePaint,N=f.Util.ih,I=f.Util.suspendCalcService,R=f.Util.resumeCalcService,k=f.Util.getRowCount,E=f.Util.getColCount,D=f.Util.checkTableName,j=f.Util.isValidTableName,_=f.Util.formulaToExpression,O=f.Util.expressionToFormula,F=f.Util.TMb,P=f.Util.nMb,H=f.Util.oMb,B=f.Util.UMb,L=f.Util.VMb,z=f.Util.WMb,V=f.Util.XMb,G=f.Util.YMb,W=f.Util.ZMb,U=f.Util.$Mb,Z=f.Util._Mb,q=f.Util.aNb,J=f.Util.RMb,Q=f.Util.SMb,Y=f.Util.PIb,K=f.Util.QIb,$=f.Util.bNb,X=f.Util.bW,ee=f.Util.cNb,te=f.Util.dNb,ne=f.Util.eNb,oe=f.Util.fNb,re=f.Util.Pda,ie=f.Util.jhc,ae=f.Util.gNb,se=null,le=void 0,ue=Math.min,ce=Math.ceil,fe=Math.max,he=JSON.stringify,pe=JSON.parse,ye="highlightFirstColumn",ve="highlightLastColumn",be="bandRows",Ce="bandColumns",we="autoGenerateColumns",xe=".table",Ae="Column",Ie="footerRowStyles",Re=["id",de="name",ge="cellType","value",me="formatter",Me="dataField",Se="footerFormula",Te="dataAreaFormula",Ne="footerValue"],ke="table",Ee="tableInsertRows",De="tableDeleteRows",je="tableInsertColumns",_e="tableDeleteColumns",Oe="collection",Fe="tableColumn",Pe="property",He="dataSource",Be="rowsChange",Le="range",ze="columns",Ve="tableExpression",Ge="sheetExpression",We=new i.Common.ResourceManager(u.SR),Ue=We.getResource.bind(We),function(e){e.TABLE_ROW_SELECT="tableRowSelect",e.TABLE_COL_SELECT="tableColSelect",e.TABLE_CORNER_SELECT="tableCornerSelect",e.TABLE_SELECT="tableSelect"}(Ze=t.TableSelectionType||(t.TableSelectionType={})),function(e){e[e.deleted=0]="deleted",e[e.dirty=1]="dirty"}(qe||(qe={})),o.Worksheet.$n(ke,{priority:2e3,init:function(){var e=this;e.tables=e._modelManager.noa,e.unbind(xe),e.bind(o.Events.BeforeDragDrop+xe,(function(t,n){var o,r=e,i=e.tables,a=Ue().Exp_DragDropChangePartOfTable,s=n.fromRow,l=n.fromColumn,u=k(n),c=n.columnCount,f=r._eventHandler.gA,h=f.row,p=f.col,d=n.isDragInsert,g=n.isDragCopy,m=se;!d||-1!==s&&-1!==l||(l>=0?(e.isDragCopy&&(p<=l||p>=l+c)||!g&&(p<l||p>l+c))&&(o=!1,i.HZ(-1,p,-1,1)&&(o=!0,m=Ue().Exp_DragDropShiftTableCell),o||g||!i.HZ(-1,l,-1,c)||(m=a)):s>=0&&l<0&&(g&&(h<=s||h>=s+u)||!g&&(h<s||h>s+u))&&!g&&i.HZ(s,-1,u,-1)&&(m=a)),n.invalidMessage=m})),e.bind(o.Events.RowChanged+xe,(function(t,n){var o=e.tables,r=o.$m,i=n.propertyName;"isVisible"===i?(!1===n.newValue?r[n.row]=0:r[n.row]=le,o.hNb(n.row)):"height"===i&&(r[n.row]=le,o.hNb(n.row))})),e.bind(o.Events.RowHeightChanged+xe,(function(t,n){var o,r,i,a=e.tables,s=a.$m;for(o=0,r=n.rowList;o<r.length;o++)s[i=r[o]]=le,a.hNb(i)})),e.bind(o.Events.ColumnChanged+xe,(function(t,n){var o=e.tables,r=o.an;"isVisible"===n.propertyName?(!1===n.newValue?r[n.col]=0:r[n.col]=le,o.iNb(n.col)):"width"===n.propertyName&&(r[n.col]=le,o.iNb(n.col))})),e.bind(o.Events.ColumnWidthChanged+xe,(function(t,n){var o,r,i,a=e.tables,s=a.an;for(o=0,r=n.colList;o<r.length;o++)s[i=r[o]]=le,a.iNb(i)})),e.bind(o.Events.RangeFiltered+xe,(function(t,n){var o,r=e.tables,i=r.$m,a=n.sheet.xr.range;for(o=0;o<a.rowCount;o++)i[a.row+o]=le,r.hNb(a.row+o)})),e.bind(o.Events.TableFiltered+xe,(function(t,n){var o,r=e.tables,i=r.$m,a=n.table.range();for(o=0;o<a.rowCount;o++)i[a.row+o]=le,r.hNb(a.row+o)})),e.bind(o.Events.TableFilterCleared+xe,(function(t,n){e.tables.Nm()}))},resetBinding:function(e){this.tables.IZ()},initBinding:function(e){var t,n,o,r,i=this,a=i.tables;for(a.IZ(),I(i),n=0,o=(t=a.all()).length;n<o;n++)(r=t[n])&&r.JZ();R(i)},dispose:function(e){!1!==e.clearCache&&(this.unbind(xe),this.tables&&(this.tables.no(),this.tables=null))},clearPendingChanges:function(){var e=this.tables;e&&e.Xec()},onGroupChanged:function(e){var t,n,o=this.tables;if(e.fromSetCollapsed)for(t=e.isRow?o.$m:o.an,n=e.start;n<=e.end;n++)t[n]=le,e.isRow?o.hNb(n):o.iNb(n)},onLayoutChanged:function(e){var t,n=e.changeType,o=e.row,r=e.rowCount,i=e.col,a=e.colCount,s=this.tables;"addRows"===n?(s.rI(o,r),s.Nm()):"addRows2"===n?s.KZ(o,r):"deleteRows"===n?(s.GR(o,r),s.Nm()):"addColumns"===n?(s.tI(i,a),s.Nm()):"deleteColumns"===n?(s.HR(i,a),s.Nm()):"addColumns2"===n||"deleteColumns2"===n?s.khc(i):"clear"===n?(t=e.sheetArea,e.ignoreTable||3!==t&&!v(t)||s.$b(o,i,r,a,e.type)):("setRowCount"===n||"setColumnCount"===n)&&s.Nm()},toJson:function(e,t){var n,o;n=this.tables,t&&t.ignoreStyle||(n&&(e.tables=n.toJSON()),t&&t.includeBindingSource&&((o=e.data).dataTable=o.dataTable||{},function(e,t){var n,o,r,i,a,s,l,u,c,f,h,p,d,g=e.tables.all();for(n=0,o=g.length;n<o;n++)if(i=(r=g[n]).LZ(),s=(a=r.dataRange()).row,l=a.col,u=s+k(a)-1,c=l+E(a)-1,i)for(f=s;f<=u;f++)for(h=l;h<=c;h++)(p=r.ge(f,h)).gt&&(d=p.Qb,b.Ska(d)&&(d=b.Daa(d)),e.qI(t,f,h,d))}(this,o.dataTable)))},fromJson:function(e,t,n){var o=this.tables,r=e.tableManager,i=t?r&&r.tables:e.tables,a=n&&n.ignoreStyle;p(i)&&!a&&o&&o.fromJSON(i,t)},fromJsonAfterFormula:function(e,t,n){this.tables.all().forEach((function(e){e.formulaFromJSON()}))},lastNonNullRowAndCol:function(){var e,t,n,o,r,i,a=-1,s=-1,l=this.tables.all();if(l)for(e=0,t=l.length;e<t;e++)(n=l[e])&&((r=(o=n.range()).row+k(o)-1)>a&&(a=r),(i=o.col+E(o)-1)>s&&(s=i));return{lastNonNullRow:a,lastNonNullCol:s}},paintCell:function(e){var t,n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b=this;e.isPrinting||e.sheetArea!==o.SheetArea.viewport||b.options.isProtected||(t=b.tables,n=e.ctx,i=(r=e.cell).row,a=r.col,(s=t.find(i,a))&&s.showResizeHandle()&&!s.hJb()&&(l=P(b,s),u=H(b,s),i===l&&a===u&&(c=r.x,f=r.y,h=r.width,p=r.height,d=b.zoom(),g=ce(4*d),m=ce(2*d),y=c+h,v=f+p,n&&h>0&&p>0&&(n.save(),n.rect(c,f,h,p),n.clip(),n.fillStyle="#485DB1",n.beginPath(),n.moveTo(y-g,v),n.lineTo(y,v),n.lineTo(y,v-m),n.lineTo(y-g,v-m),n.fill(),n.beginPath(),n.moveTo(y,v-m),n.lineTo(y-m,v-m),n.lineTo(y-m,v-g),n.lineTo(y,v-g),n.fill(),n.restore()))))},composeTableFooterList:function(e){var t=e.table,n=e.row,o=e.col,r=e.style;t.jNb(n,o,r)}}),o.Worksheet.prototype.PIb=function(e,t,n,o,r,i){var a=i?le:e.nKb();Y(this,e,t,n,o,r,a)},o.Worksheet.prototype.QIb=function(e,t,n,o,r){K(this,e,t,n,o,r)},o.Workbook.prototype.jga=function(e){var t,n,o,r=this.sheets;if(r)for(o=0;o<r.length;o++)if((n=r[o].tables)&&(t=n.findByName(e)))return t;return se},Je=function(){function e(e,t,n,o,r,i,a){var s,l=this;for(l.MZ=!a||a.showHeader===le||a.showHeader,l.NZ=!(!a||a.showFooter===le)&&a.showFooter,l.kNb=!(!a||a.useFooterDropDownList===le)&&a.useFooterDropDownList,l.lNb=!(!a||a.showResizeHandle===le)&&a.showResizeHandle,l.mNb=[],l.wq=se,l.xr=se,l.tc=se,l.lhc=!1,p(e)&&l.name(e),l.cj=p(t)?t:-1,l.dj=p(n)?n:-1,l.Xj=p(o)?o:-1,l.OZ=p(r)?r:-1,p(i)&&l.style(i),l.Nz=[],s=0;s<l.OZ;s++)l.Nz.push(new Ye(s+1));l.ZX=se,l.LAb={},l.Bec=[],l.Ts=[],l.nNb=[],l.mhc=[],l.oNb=[],l.pNb=[],l.qNb=!0}return e.prototype.no=function(){var e=this;e.Nz=[],e.mNb=[],e.Ts=[],e.nNb=[],e.mhc=[],e.LAb={},e.Bec=[],e.kj=se,e.tc=se,e.xr&&(e.xr.no(),e.xr=se),e.Nm()},e.prototype.Nm=function(){this.oNb=[],this.pNb=[]},e.prototype.range=function(){var e=this;return o.kf(e.cj,e.dj,e.Xj,e.OZ)},e.prototype.dataRange=function(){var e=this,t=e.MZ?e.cj+1:e.cj,n=e.MZ?e.Xj-1:e.Xj;return e.NZ&&n--,o.kf(t,e.dj,n,e.OZ)},e.prototype.headerIndex=function(){return this.MZ?this.cj:-1},e.prototype.footerIndex=function(){return this.NZ?this.cj+this.Xj-1:-1},e.prototype.showHeader=function(e){var t,n=this;return 0===arguments.length?n.MZ:(n.MZ!==e&&((t=n.kj)&&t.suspendPaint(),n.qVa(e),t&&t.resumePaint()),n)},e.prototype.qVa=function(e){var t,n=this,o=n.kj;o&&o._modelManager.pVa(n,"showHeader",n.MZ),(n.MZ=e)?(n.cj>0&&(n.cj=n.cj-1,n.Xj+=1),n.PZ()):(t=n.cj,n.cj=n.cj+1,n.Xj-=1,n.QZ(t),n.RZ()),o&&a&&o.recalcRange(n.cj+(e?0:-1),n.dj,1,n.OZ)},e.prototype.showFooter=function(e,t){var n,o=this;if(0===arguments.length)return o.NZ;if(o.NZ!==e){(n=o.kj)&&n.suspendPaint();try{o.rVa(e,!!t&&t)}finally{n&&n.resumePaint()}}return o},e.prototype.expandBoundRows=function(e){var t=this;return 0===arguments.length?t.lhc:(t.lhc!==e&&(t.lhc=e),t)},e.prototype.rVa=function(e,t){var n,o,r,i,s,l,u,c,f,h,p,d=this,g=d.kj;if(g&&g._modelManager.pVa(d,"showFooter",d.NZ),n=d.Xj,e){if((!g||d.cj+n<g.getRowCount())&&(!t||d.rNb(!0,n)))for(d.NZ=e,d.Xj+=1,r=(o=d.Nz).length,i=d.footerIndex(),s=d.dj,l=0;l<r;l++)f=s+l,(c=(u=o[l])&&u.footerFormula())&&((h=O(g,c,i,f))&&(c=_(g,h,i,f),u.footerFormula(c)));d.SZ()}else d.NZ=e,p=d.cj+n-1,d.Xj-=1,d.QZ(p),d.NAb(),d.Cec(0),t&&d.rNb(!1,n);g&&a&&g.recalcRange(d.cj+d.Xj+(e?-1:0),d.dj,1,d.OZ)},e.prototype.rNb=function(e,t){var n,r=this,i=r.kj,a=r.cj+t,s=r.dj,l=r.OZ,u=s+l-1,c=B(i,r),f=c>=a,h=V(i,new o.Range(a,s,c-a+1,u-s+1)),p=(h&&h.row)===a;return!(p&&z(i,r,a,c,s,u,1)||(p&&f&&(n=e?a+1:a-1,i.moveTo(a,s,n,s,c-a+1,l,1023)),0))},e.prototype.sNb=function(e){var t,n,o,r=this,i=r.Nz,a=i.length,s=r.dj,l=[],u=r.name();for(t=0;t<a;t++)n=s+t,o=r.getColumnName(t),l.push(tt(0,o)),e||(0===t?r.j$(n,Ue().Table_Total,!0):t===a-1&&(i[t].footerFormula()||(r.tNb(n)?r.i$(t,"=SUBTOTAL(109,"+u+"["+o+"])"):r.i$(t,"=SUBTOTAL(103,"+u+"["+o+"])"))));r.mNb=l},e.prototype.tNb=function(e){var t,n,o=this.kj,r=this.dataRange(),i=!0,a=r.rowCount,s=r.row;for(t=0;t<a;t++)if(n=o.getValue(s+t,e),!v(n)&&"number"!=typeof n){i=!1;break}return i},e.prototype.uNb=function(){return this.mNb&&this.mNb.length>0},e.prototype.vNb=function(e,t,n){var o=this,r=this.kj;o.uNb()&&(r&&r._modelManager.pVa(o,Ie,o.wNb()),t>=0&&(n?o.mNb.splice(e,t,n):o.mNb.splice(e,t)))},e.prototype.wNb=function(){var e=this.mNb,t=[];return e.forEach((function(e){e&&t.push(e.clone())})),t},e.prototype.xNb=function(e,t,n){var o=this,r=p(n)?tt(o.name(),n):se;o.uNb()&&o.vNb(e,t,r)},e.prototype.useFooterDropDownList=function(e){var t=this,n=t.kj;return 0===arguments.length?t.kNb:(n&&(n.suspendPaint(),t.kNb!==e&&(n._modelManager.pVa(t,"useFooterDropDownList",t.kNb),t.kNb=e,t.kNb&&!t.uNb()&&(t.sNb(),t.e$())),n.resumePaint()),t)},e.prototype.showResizeHandle=function(e){var t=this,n=t.kj;return 0===arguments.length?t.lNb:(n&&(n.suspendPaint(),t.lNb!==e&&(n._modelManager.pVa(t,"showResizeHandle",t.lNb),t.lNb=e),n.resumePaint()),t)},e.prototype.rowFilter=function(){var e=this;return!e.xr&&t.MAb&&(e.xr=new t.MAb(e),e.xr.EZ(e.dataRange())),e.xr},e.prototype.bindColumns=function(e){var t,n,o,r,i,a,s,l,u,c,f=this,h=[];if(e)for(t=ue(f.OZ,e.length),n=0;n<t;n++)(o=f.Nz[n])||(o=new Ye(f.TZ()),f.Nz[n]=o),i=(r=e[n]).id(),a=r.name(),s=r.dataField(),l=r.value(),u=$(f,a,n),o.id(i),o.name(u),o.dataField(s),o.value(l),o.cellType(r.cellType()),o.formatter(r.formatter()),c={name:u,value:l,dataField:s},s&&h.push(c),f.xNb(n,1,u);f.yNb=h,f.wq&&(f.wq.qia=h)},e.prototype.bindingPath=function(e){var t=this;return 0===arguments.length?t.UZ:(t.UZ=e,t.JZ(),t)},e.prototype.bind=function(e,t,n){var o=this,r=n;return v(e)||o.bindColumns(e),v(n)&&(r=o.LZ()),t&&(o.UZ=t,r=l.LL(r,t)),l.qL&&r&&o.zNb(r),o},e.prototype.getColumnName=function(e){var t,n,o=this.Nz;return o&&0<=e&&e<o.length&&(t=o[e])?((n=t.name())!==se&&(n=d(n)),n):se},e.prototype.setColumnName=function(e,t){var n,o,r,i,a=this;return a.VZ(t)||(n=a.Nz)&&0<=e&&e<n.length&&((o=n[e])||(o=a.Nz[e]=new Ye(a.TZ())),r=o.name(),i=a.kj,r!==t&&i&&(i._modelManager.sVa(o,"name",r),o.name(t)),a.MZ&&i&&i.setText(a.headerIndex(),a.dj+e,t),a.WZ(r,o.name(),e)),a},e.prototype.WZ=function(e,t,n){var o,r=this.Nz[n];this.xNb(n,1,r.name()),(o=this.ZX)&&o.onColumnNameChanged(e,t)},e.prototype.setColumnDataField=function(e,t){var n,o,r,i=this,a=i.Nz;return a&&0<=e&&e<a.length&&((n=a[e])||(n=i.Nz[e]=new Ye(i.TZ())),o=i.kj,r=n.dataField(),o&&t!==r&&o._modelManager.sVa(n,"dataField",r),n.dataField(t)),i},e.prototype.getColumnDataField=function(e){var t,n,o=this.Nz;return o&&0<=e&&e<o.length&&(t=o[e])?((n=t.dataField())!==se&&(n=d(n)),n):se},e.prototype.getColumnFormula=function(e){var t,n,o,r,i=this.Nz,a=this.kj;return i&&a&&0<=e&&e<i.length&&(t=i[e])?(n=this.footerIndex(),o=this.dj+e,(r=t.footerFormula())&&O(a,r,n,o,!1)):se},e.prototype.setColumnFormula=function(e,t){return this.i$(e,t),this},e.prototype.setColumnDataFormula=function(e,t){var n,o,r,i,s,l,u,c,f,h;if(a){if((o=(n=this).Nz)&&0<=e&&e<o.length&&(r=o[e])){for(i=n.kj,I(i),s=e+n.dj,l=n.cj,u=n.Xj,n.showHeader()&&(l++,u--),n.showFooter()&&u--,c=_(i,t,l,s,!0),f=r.dataAreaFormula(),i&&c!==f&&i._modelManager.sVa(r,"dataAreaFormula",f),r.ANb(t),r.dataAreaFormula(c),h=l;h<l+u;h++)A(i,h,s,t,c);R(i,!1)}return n}},e.prototype.getColumnValue=function(e){var t,n,o=this,r=o.Nz;return r&&0<=e&&e<r.length&&(t=r[e])?o.NZ&&t.footerFormula()&&(n=o.kj)?n.getValue(o.footerIndex(),o.dj+e):t.footerValue():se},e.prototype.setColumnValue=function(e,t){var n,o,r=this,i=r.Nz,a=r.kj;return i&&0<=e&&e<i.length&&((n=i[e])&&(o=n.footerValue(),a&&t!==o&&a._modelManager.sVa(n,"footerValue",o),n.footerValue(t)),r.NZ&&a&&M(a,r.footerIndex(),r.dj+e,t)),r},e.prototype.filterButtonVisible=function(e,t){var n,o,r,i,a=this,s=a.kj,l=a.rowFilter();if(!(e<0||e>=a.OZ))switch(n=arguments,n.length){case 0:return l&&l.filterButtonVisible();case 1:if("number"===(r=typeof(o=n[0])))return l&&l.filterButtonVisible(o);if("boolean"===r&&l){for(S(s),i=0;i<a.OZ;i++)l.filterButtonVisible(i,o);T(s)}return a;case 2:return l&&l.filterButtonVisible(e,t),a}},e.prototype.allowAutoExpand=function(e){var t=this,n=t.kj;return 0===arguments.length?t.qNb:(t.qNb!==e&&(n._modelManager.pVa(t,"allowAutoExpand",t.qNb),t.qNb=e),t)},e.prototype.Aq=function(){return!!this.ZX},e.prototype.Yv=function(e){var t=this,n=t.tc;t.BNb(e),t.kj&&t.kj._modelManager&&t.kj._modelManager.CNb(t,n)},e.prototype.BNb=function(e){var t,n=this;n.tc=e,n.kj=e&&e.kj,t=n.xr,e&&t&&t.kj!==e.kj&&t.table(n)},e.prototype._bind=function(e){var t,n,o,r,i,a,s,l,u,c=this,f=c.autoGenerateColumns(),h=c.xr&&c.xr.qZ;if(c.RZ(),(t=c.kj)&&(n=c.dataRange(),f?t.cg(n.row,n.col,k(n),E(n),3,17,!1,!0):m(c.Nz,(function(e,o){o.dataField()&&t.cg(n.row,n.col+e,k(n),1,3,17,!1,!0)}))),f&&(o=c.range(),c.$b(o.row,o.col,k(o),E(o))),e.qia=c.yNb,c.wq=e,e)if(t&&t._modelManager.pVa(c,Le,{row:c.cj,col:c.dj,rowCount:c.Xj,colCount:c.OZ}),r=e.getRowCount(),i=e.getColumnCount(),c.MZ&&r++,c.NZ&&r++,c.Xj=r,f)for(c.OZ=i,c.Nz=[],a=e.rL(),s=0;s<c.OZ;s++)l=new Ye(s+1),c.Nz[s]=l,a&&(l.name(a[s]),l.dataField(a[s]));else u=[],c.Nz.forEach((function(e){var t=e.dataField();t&&u.push(t)})),e.Nka(u);c.xr&&(c.xr.EZ(c.dataRange()),c.xr.qZ=h)},e.prototype.XZ=function(e){var t,n,o,r,i,a=this,s=a.wq;if(s&&(t=s.rL()))for(o=(n=a.Nz[e-a.startColumn()])&&n.dataField(),r=0,i=t.length;r<i;r++)if(t[r]===o)return r;return-1},e.prototype.ge=function(e,t){var n,o=!1,r=le,i=this,a=i.wq,s=e-i.dataRange().row;return a&&s<a.getRowCount()&&((n=i.XZ(t))>=0&&(o=!0,r=a.getValue(s,n).value)),{gt:o,Qb:r}},e.prototype.yq=function(e,t,n,o){var r,i,a,s,l,u,c=this,f=c.wq,h=W(c,e),p=c.xr,d=!1;return f&&((r=c.XZ(t))>=0&&(o&&p&&p.isRowFilteredOut(e)||(i=(a=f.getValue(h,r)).value,(l=(s=c.kj)&&s._modelManager)&&a.hasBinding&&i!==n&&(u=Z(!0),c.DNb(e,h,u),l.ENb(c,e,se,u,qe.dirty),l.Cp(e,t,{Ep:i})),f.setValue(h,r,n,l&&l.zTa)),d=!0)),d},e.prototype.Gq=function(e,t,n){var r=new o.Style;return this.Yo(e,t,r,n),r},e.prototype.D3=function(e){var t,n=this.tc.$m,o=n[e];return o!==le?o:(t=this.kj,o=n[e]=t.getRowHeight(e))},e.prototype.C3=function(e){return this.kj.getColumnWidth(e)},e.prototype.Yo=function(e,t,n,r){var i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q=this,J=q.style();if(J){if(i=q.kj,a=q.MZ,s=q.NZ,l=q.Nz,u=q.highlightLastColumn(),c=q.highlightFirstColumn(),f=q.headerIndex(),h=q.footerIndex(),p=a?e===q.cj+1:e===q.cj,d=s?e===q.cj+q.Xj-2:e===q.cj+q.Xj-1,g=t===q.dj,m=t===q.dj+q.OZ-1,y=a?e===f:e===q.cj,v=s?e===h:e===q.cj+q.Xj-1,b=J.highlightLastColumnStyle(),C=J.highlightFirstColumnStyle(),w=new o.Style,f===e)x=J.lastHeaderCellStyle(),m&&u&&x&&x.Yo(w,!0,!0,!0,!0),A=J.firstHeaderCellStyle(),g&&c&&A&&A.Yo(w,!0,!0,!0,!0),(M=J.headerRowStyle())&&M.Yo(w,!0,g,!0,m),m&&u&&b&&b.Yo(w,!0,!0,!1,!0),g&&c&&C&&C.Yo(w,!0,!0,!1,!0);else if(h===e)S=J.lastFooterCellStyle(),m&&u&&S&&S.Yo(w,!0,!0,!0,!0),T=J.firstFooterCellStyle(),g&&c&&T&&T.Yo(w,!0,!0,!0,!0),(N=J.footerRowStyle())&&N.Yo(w,!0,g,!0,m),m&&u&&b&&b.Yo(w,!1,!0,!0,!0),g&&c&&C&&C.Yo(w,!1,!0,!0,!0);else{if(m&&u&&b&&b.Yo(w,y,!0,v,!0),g&&c&&C&&C.Yo(w,y,!0,v,!0),I=a?e-q.cj-1:e-q.cj,R=t-q.dj,k=void 0,E=void 0,D=void 0,j=void 0,_=void 0,O=void 0,F=void 0,P=!r||"cellType"!==r&&"formatter"!==r,q.bandRows()&&P&&(E=(k=J.firstRowStripSize())+J.secondRowStripSize())>0){if(void 0===(D=q.oNb[e])){if(o.mn.nn&&o.mn.sn){for(H=o.mn.sn,B=q.dataRange().row;-1===H[B];)B++;if(B>e)return;I=H[e]-H[B]}else if(i){for(L=0,B=q.dataRange().row;B<e;B++)q.D3(B)>0&&L++;I=L}D=q.oNb[e]=I%E}j=J.firstRowStripStyle(),_=J.secondRowStripStyle(),D<k&&j?(O=0===D,F=d||D===k-1,j.Yo(w,O,g,F,m)):D>=k&&_&&(O=D===k,F=d||D===E-1,_.Yo(w,O,g,F,m))}if(q.bandColumns()&&P&&(E=(k=J.firstColumnStripSize())+J.secondColumnStripSize())>0){if(void 0===(D=q.pNb[t])){if(z=0,i)for(V=q.dj;V<t;V++)q.C3(V)>0&&z++;D=q.pNb[t]=z%E}j=J.firstColumnStripStyle(),_=J.secondColumnStripStyle(),D<k&&j?(O=0===D,F=m||D===k-1,j.Yo(w,p,O,d,F)):D>=k&&_&&(O=D===k,F=m||D===E-1,_.Yo(w,p,O,d,F))}l&&l.length>0&&((G=l[R])&&(W=G.cellType(),U=G.formatter(),W&&(w.cellType=W),U&&(w.formatter=U)))}(Z=J.wholeTableStyle())&&Z.Yo(w,y,g,v,m),q.Oka(n,w)}},e.prototype.jNb=function(e,t,n){var o,r,i,a=this,s=a.NZ,l=a.kNb;a.footerIndex()===e&&s&&a.uNb()&&((o=a.mNb[t-a.dj])&&l&&(r=n.cellButtons,i=n.dropDowns,v(r)&&(r=[]),n.cellButtons=r.concat(o.cellButtons),v(i)&&(i=[]),n.dropDowns=i.concat(o.dropDowns)))},e.prototype.Oka=function(e,t){var n,o,r,i,a=e;v(a.backColor)&&(a.backColor=t.backColor),ae(a.foreColor)&&(a.foreColor=t.foreColor),v(a.themeFont)&&v(a.font)?(a.themeFont=t.themeFont,a.font=t.font):!v(a.themeFont)&&v(a.font)&&(a.font=t.font),v(a.borderLeft)&&(n=t.borderLeft,a.borderLeft=n&&n.Uo()||n,a.borderLeft&&(a.borderLeft.level=20)),v(a.borderTop)&&(o=t.borderTop,a.borderTop=o&&o.Uo()||o,a.borderTop&&(a.borderTop.level=20)),v(a.borderRight)&&(r=t.borderRight,a.borderRight=r&&r.Uo()||r,a.borderRight&&(a.borderRight.level=20)),v(a.borderBottom)&&(i=t.borderBottom,a.borderBottom=i&&i.Uo()||i,a.borderBottom&&(a.borderBottom.level=20)),v(a.textDecoration)&&(a.textDecoration=t.textDecoration),v(a.cellType)&&(a.cellType=t.cellType),v(a.formatter)&&(a.formatter=t.formatter)},e.prototype.YZ=function(e,t){var n,o,r,i,a,s=this;if((e!==s.cj||t!==s.dj)&&(n=s.kj)){if((e<0||n.getRowCount()<e+s.Xj||t<0||n.getColumnCount()<t+s.OZ)&&x(Ue().Exp_TableMoveOutOfRange),r=void 0,i=void 0,o=s.tc)for(i=0,a=(r=o.l$).length;i<a;i++)if(r[i]===s){r.splice(i,1),s.ZZ();break}n.moveTo(s.cj,s.dj,e,t,s.Xj,s.OZ,3),r&&i<=a&&(s.$Z(e,t),r.splice(i,0,s),s._Z()),this.Cec(1)}},e.prototype.$Z=function(e,t){var n=this,o=n.kj;o&&o._modelManager.pVa(n,Le,{row:n.cj,col:n.dj,rowCount:n.Xj,colCount:n.OZ}),n.cj=e,n.dj=t,n.a$(),n.Nm()},e.prototype.ZZ=function(e,t,n){var o,r,i,s,l,u,c,f,h,p,d,g,m,y,b=this,C=b.kj;if(C&&a){for(o=b.Nz,r=b.footerIndex(),i=b.range(),l=(s=b.dataRange()).row,u=k(s),v(e)&&(e=0,t=o.length);e<t;e++)if(c=o[e],f=i.col+e,c){for(c.footerFormula()&&r>=0&&(A(C,r,f,se),M(C,r,f,se)),h=c.ANb(),p=ne(h),d=void 0,g=void 0,m=0;m<u;m++)g=l+m,d=C.getFormula(g,f),v(d)||(v(b.FNb)&&(b.FNb=[]),b.FNb.push({row:g,col:f,formula:d})),v(d)||!v(p)&&O(C,_(C,p,b.cj,f),g,f)===d||(v(b.GNb)&&(b.GNb=[]),y=oe(b.GNb,f),v(y)?((y={}).col=f,y.rowIndexes=[],y.rowIndexes.push(g),b.GNb.push(y)):y.rowIndexes.push(g));if(c.ANb(le),c.dataAreaFormula())for(m=0;m<u;m++)A(C,g=l+m,f,se),M(C,g,f,se)}!0===n&&(b.FNb=[])}},e.prototype.HNb=function(e,t,n){var o,r,i,a,s,l,u=this,c=u.kj,f=u.FNb;if(f){for(i=0;i<f.length;i++)o=!0,(r=f[i])&&(a=r.row,s=r.col,l=r.formula,a>=e&&(!0===n&&(a+=t),!1===n&&(a<e+t?o=!1:a-=t)),o&&A(c,a,s,l));u.FNb=[]}u.Gj(e,t,!0,n)},e.prototype.INb=function(e,t,n){var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,M=this,S=M.kj,T=M.FNb;if(T){for(i=0;i<T.length;i++)o=!0,(r=T[i])&&(a=r.row,s=r.col,l=r.formula,s>=e&&(!0===n&&(s+=t),!1===n&&(s<e+t?o=!1:s-=t)),o&&A(S,a,s,l));for(u=M.GNb||[],c=void 0,i=0;i<u.length;i++)(c=u[i])&&((f=c.col)>=e&&(!0===n&&(c.col+=t),!1===n&&f>=e+t&&(c.col-=t)));for(M.Gj(e,t,!1,n),p=(h=M.Nz).length,g=(d=M.dataRange()).row,m=d.col,y=d.rowCount,v=void 0,b=void 0,void 0,C=void 0,w=void 0,i=0;i<p;i++)if(w=m+i,(b=h[i])&&b.dataAreaFormula()){for(v=g,x=0;x<u.length;x++)if((c=u[x])&&c.col===w){for(;c.rowIndexes.indexOf(v)>-1&&v<g+y;)v++;break}v<g+y&&((C=S.getFormula(v,w))&&b.dataAreaFormula(_(S,C,g,w)))}M.FNb=[],M.GNb=[]}},e.prototype.Gj=function(e,t,n,o,r){var i,a,s,l,u,c,f=this,h=f.kj,p=f.Nz,d=f.footerIndex(),g=f.dataRange(),m=g.row,y=g.col,v=g.rowCount,b=g.colCount,C=h.Bj(),w=h.Wu;if(w&&C&&((i=w.ih())&&(r||(i.Dj(C,m,y,v,b),i.Gj(C._source,e,t,n,o,!0)),f.NZ)))for(r||(i.Dj(C,d,y,1,b),i.Gj(C._source,e,t,n,o,!1)),c=0;c<b;c++)(a=p[c])&&(u=y+c,(s=a.footerFormula())&&((l=h.getFormula(d,u))&&(h&&h._modelManager.sVa(a,"footerFormula",s),a.footerFormula(_(h,l,d,u)))))},e.prototype._Z=function(){var e,t,n,o=this,r=o.kj;r&&a&&(e=o.footerIndex(),t=o.range(),n=o.dataRange(),m(o.Nz,(function(o,i){var a,s,l,u=t.col+o,c=i.footerFormula(),f=i.dataAreaFormula();if(c&&e>=0&&A(r,e,u,se,c),f)for(a=0,s=k(n);a<s;a++)l=n.row+a,A(r,l,u,se,f)})))},e.prototype.b$=function(e){var t,n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,A,M,S,T,N,I,R,D,j=this,_=j.dataRange();if(!e.equals(j.range())){if(t=e.row,n=e.col,r=k(e),i=E(e),a=j.MZ,s=j.NZ,l=j.kNb,u=0,1,a&&(u+=1),s&&(u+=1),(c=j.kj)&&((r<u||i<1||t+r>c.getRowCount()||n+i>c.getColumnCount())&&x(Ue().Exp_TableResizeOutOfRange),t===j.cj&&e.intersect(j.cj,j.dj,j.Xj,j.OZ)||x(Ue().Exp_TableResizeInvalidRange),c._modelManager.pVa(j,Le,{row:j.cj,col:j.dj,rowCount:j.Xj,colCount:j.OZ}),c._modelManager.pVa(j,ze,j.Nz.slice())),f=j.Nz,h=n,p=n+i-1,d=j.dj,g=j.dj+j.OZ-1,m=j.OZ,j.dj=n,j.OZ=i,h<d){for(y=0,v=h;v<d;v++)b=new Ye(j.TZ()),f.splice(y,0,b),y++;a&&j.PZ(0,d-h),s&&j.SZ(0,d-h)}else h<=g&&(j.ZZ(d,h),f.splice(0,h-d));if(p>g){for(v=g+1;v<=p;v++)b=new Ye(j.TZ()),f.push(b);a&&j.PZ(m,p-g),s&&j.SZ(m,p-g),l&&j.JNb(m)}else p>=d&&(j.ZZ(p,g),f.splice(f.length-(g-p),g-p));r!==j.Xj&&(C=j.wq,A=(w=j.dataRange()).row,M=k(w),C?r>j.Xj?(S=A+M-1,T=r-j.Xj,c&&(N=S+T+1,(I=V(c,new o.Range(N,h,c.getRowCount()-N,p)))&&I.row<N||j.eMb(S,T,!0,!1))):c&&(R=j.Xj-r,j.STa(A+M-R,R)):(D=void 0,s&&(j.SZ(),D=j.footerIndex()),j.Xj=r,j.LNb(),s&&(j.e$(),j.QZ(D)))),j.a$(),j.f$(_,j.dataRange()),j.NAb(),j.Cec(0)}},e.prototype.f$=function(e,t){var n,o,r,i,a,s,l,u,c,f,h=this.ZX;h&&(n=e.col,o=k(e),r=E(e),i=t.col,a=k(t),s=E(t),l=e.row+o,u=n+r,f=i+s,(c=t.row+a)<l&&h.onRowsRemoved(a,l-c),c>l&&h.onRowsAdded(o,c-l),i>n&&h.onColumnsRemoved(0,i-n),f<u&&h.onColumnsRemoved(s,u-f),i<n&&h.onColumnsAdded(0,n-i),f>u&&h.onColumnsAdded(n+r-i,f-u))},e.prototype.a$=function(){var e=this.xr;e&&(e.EZ(this.dataRange()),e.reFilter())},e.prototype.RZ=function(){var e=this.xr;e&&(e.unfilter(),e.reset())},e.prototype.VZ=function(e,t){var n;for(e!==se&&(e=d(e)),n=0;n<this.OZ;n++)if(n!==t&&e===this.getColumnName(n))return!0;return!1},e.prototype.g$=function(e){var t,n,o,r=this,i=r.Nz;return r.MZ&&i?0<=(t=e-r.dj)&&t<i.length&&(n=i[t])?(o=n.name(),v(o)||(o=d(o)),o):se:se},e.prototype.h$=function(e,t){var n,o,r,i,a,s=this,l=s.Nz;s.MZ&&l&&(n=l.length,0<=(o=e-s.dj)&&o<n&&((r=l[o])&&(i=r.name(),(a=s.kj)&&t!==i&&a._modelManager.sVa(r,"name",i),r.name(t),s.WZ(i,r.name(),o))))},e.prototype.i$=function(e,t,n){var o,r,i=this,s=i.Nz,l=i.footerIndex(),u=i.dj+e,c=i.kj;a&&0<=e&&e<s.length&&(o=s[e],t&&!n&&c&&(n=_(c,t,l,u),i.NZ&&A(c,l,u,t,n)),o&&(r=o.footerFormula(),c&&n!==r&&c._modelManager.sVa(o,"footerFormula",r),o.footerFormula(n)))},e.prototype.j$=function(e,t,n){var o,r,i,a,s=this,l=s.Nz;(n||s.NZ)&&l&&(0<=(o=e-s.dj)&&o<l.length&&((r=l[o])&&(t!==(i=r.footerValue())&&((a=s.kj)&&(a._modelManager.sVa(r,"footerValue",i),a._modelManager.Cp(s.cj+s.Xj-1,e,{Ep:r.footerValue()}))),r.footerValue(t))))},e.prototype.TZ=function(){var e,t,n=this.Nz,o=n&&n.length,r=[];for(t=0;t<o;t++)(e=n[t])&&e.k$()&&r.push(e.id());if(r.sort((function(e,t){return e-t})),(o=r.length)>0){for(t=0;t<o;t++)if(r[t]!==t+1)return t+1;return o+1}return 1},e.prototype.dga=function(e,t){var n,o,r,i;if(e&&!this.VZ(e,t))return e;if(o=Ae,r=0,e)o=e,r=1;else if(t>0&&(e=this.Nz[t-1].name(),i=/[0-9]+$/.exec(e))){if(n=(o=e.substr(0,i.index))+((r=parseInt(e.substr(i.index),10))+1),!this.VZ(n))return n;o=e,r=1}for(;;)if(n=o+ ++r,!this.VZ(n))return n},e.prototype.PZ=function(e,t,n){var o,r,i,s,l,u,c,f,h,p,d=this,m=d.Nz,y=d.kj;if(d.MZ&&m&&y)for(o=m.length,r=d.headerIndex(),i=d.dj,v(e)&&(e=0),v(t)&&(t=o),l=ue(o,e+t),c=e;c<l;c++)(s=m[c])&&(f=d.tc.l$,(h=g(d,f))>-1&&f.splice(h,1),u=ie(y.getValue(r,i+c)),h>-1&&f.splice(h,0,d),A(y,r,i+c,se),u&&!n?(a&&y.zq(r,i+c),(p=d.dga(u,c))===u?(y._modelManager.sVa(s,"name",s.name()),s.name(u)):y.setText(r,i+c,p)):(d.KNb=n,y.setText(r,i+c,s.name()),delete d.KNb))},e.prototype.JNb=function(e){var t,n,o=this.Nz;for(t=e;t<o.length;t++)n=tt(this.name(),o[t].name()),this.mNb.push(n)},e.prototype.SZ=function(e,t,n){var o,r,i,a,s,l,u,c,f,h,p=this,d=p.Nz,g=p.kj;if(p.NZ&&d&&g)for(p.useFooterDropDownList()&&!p.uNb()&&p.sNb(),o=d.length,r=p.footerIndex(),i=p.dj,v(e)&&(e=0),v(t)&&(t=o),v(n)&&(n=p.nhc),s=ue(o,e+t),c=e;c<s;c++)(a=d[c])&&(u=g.getValue(r,i+c),v(u)||n?(p.KNb=n,M(g,r,i+c,a.footerValue()),delete p.KNb):(u!==(f=a.footerValue())&&g._modelManager.sVa(a,"footerValue",f),a.footerValue(u)),(l=g.Ima&&g.Ima(r,i+c))&&!n?(l!==(h=a.dataAreaFormula())&&g._modelManager.sVa(a,"dataAreaFormula",h),a.footerFormula(l)):p.S3||(p.KNb=n,A(g,r,i+c,se,a.footerFormula()),delete p.KNb))},e.prototype.m$=function(e,t){var n,o,r,i,a,s,l=this,u=l.Nz;if(l.MZ&&u)for(n=u.length,v(e)&&(e=0),v(t)&&(t=n),r=ue(n,e+t),i=e;i<r;i++)(o=u[i])&&(a=o.name(),(s=l.kj)&&a!==se&&s._modelManager.sVa(o,"name",a),o.name(se),l.WZ(a,o.name(),i))},e.prototype.n$=function(e){var t,n,o,r,i,a,s,l,u=this,c=u.dataRange();if(c.containsRange(e)){for(t=e.row,n=e.col,o=k(e),r=E(e),i=[],a=0;a<o;a++)for(s=0;s<r;s++)u.yq(t+a,n+s,se,!0),i.push({columnName:u.getColumnName(n+s-c.col),row:t+a-c.row,data:""});(l=u.ZX)&&l.onDataChanged(i)}},e.prototype.o$=function(e,t){var n,o,r,i,a,s,l=this,u=l.Nz;if(l.NZ&&u)for(v(e)&&(e=0),v(t)&&(t=u.length),o=ue(u.length,e+t),r=e;r<o;r++)(n=u[r])&&(i=l.kj,a=n.footerFormula(),i&&se!==a&&i._modelManager.sVa(n,"footerFormula",a),n.footerFormula(se),s=n.footerValue(),i&&se!==s&&i._modelManager.sVa(n,"footerValue",s),n.footerValue(se))},e.prototype.e$=function(){var e,t,n,o,r,i,a,s=this,l=s.Nz;if(s.NZ&&l&&(e=s.kj))for(t=l.length,o=s.dj,i=s.footerIndex(),a=0;a<t;a++)(n=l[a])&&(M(e,i,r=o+a,n.footerValue()),A(e,i,r,se,n.footerFormula()))},e.prototype.QZ=function(e){var t,n,o,r,i=this,a=i.kj;if(a&&!(e<0||a.getRowCount()<=e))for(t=i.dj,n=i.OZ,r=0;r<n;r++)A(a,e,o=t+r,se),M(a,e,o,se)},e.prototype.rI=function(e,t,n,o,r){var i,a,s,l=this,u=!1,c=n?1:0;return e>=l.cj+l.Xj+c||((i=l.kj)&&i._modelManager.pVa(l,Le,{row:l.cj,col:l.dj,rowCount:l.Xj,colCount:l.OZ}),l.ohc(e,t,!1),a=l.cj,s=l.cj+l.Xj-1+c,e<=a&&!r?l.cj+=t:e<=s&&(o||(u=l.c$(e,t)),l.Xj+=t)),u},e.prototype.KZ=function(e,t,n){var o,r,i,a=this,s=a.cj+a.Xj-1;!n&&e>=a.cj&&e<=s&&a.LNb(e,t),n||(a.Gj(e,t,!0,!0,!0),a.MNb()),o=a.ZX,r=a.dataRange().row,i=a.endRow(),e>=r&&e<=i&&o&&o.onRowsAdded(e-r,t),a.xr&&a.xr.rI(e,t)},e.prototype.c$=function(e,t){var n,o,r,i=this.wq;return!!i&&(r=void 0,(o=(n=this.kj)&&n._modelManager.zTa)&&((r=o.uVa)||(r=[])),i.uL(W(this,e),t,r),!0)},e.prototype.LNb=function(e,t){if(a){var n=this,o=n.kj,r=n.dataRange();v(e)&&(e=r.row),v(t)&&(t=r.rowCount),I(o),m(n.Nz,(function(r,i){var a,s,l=i.dataAreaFormula();if(l)for(a=r+n.dj,s=e;s<e+t;s++)A(o,s,a,se,l)})),R(o,!1)}},e.prototype.MNb=function(){if(a){var e,t,n=this,o=n.kj,r=o.Bj(),i=n.dataRange();v(e)&&(e=i.row),v(t)&&(t=i.rowCount),I(o),m(n.Nz,(function(o,i){var a,s,l,u,c=i.NNb();if(c&&c.isArrayFormula)for(a=c.isDynamicArray,s=o+n.dj,l=e;l<e+t;l++)v(r.Qf(l,s))&&(u={row:l,col:s,rowCount:1,colCount:1,isDynamicArray:a},r.Xf(l,s,u))})),R(o,!1)}},e.prototype.tI=function(e,t,n,o,r){var i,a,s,l,u,c,f,h,p,d,g=this,m=n?1:0;if(!(e>=g.dj+g.OZ+m)){if(i=g.dj,(a=g.kj)&&(a._modelManager.pVa(g,Le,{row:g.cj,col:g.dj,rowCount:g.Xj,colCount:g.OZ}),a._modelManager.pVa(g,ze,g.Nz.slice())),e<=g.dj&&!r)g.dj+=t;else if(e<g.dj+g.OZ+m&&(g.OZ+=t,s=g.Nz)){for(l=e-g.dj,u=0;u<t;u++)c=g.TZ(),f=l+u,(h=new Ye(c)).name(g.dga(se,f)),s.splice(f,0,h),p=g.getColumnName(f),g.xNb(f,0,p);o&&g.PZ(l,le,!0)}g.xr&&g.xr.tI(e,t),e>=i&&((d=g.ZX)&&d.onColumnsAdded(e-i,t))}},e.prototype.khc=function(){var e,t,n,o,r=this,i=r.kj.Bj();i&&r.NZ&&(e=r.Nz,t=r.footerIndex(),n=r.dj,e.forEach((function(e,r){o=i.Kf(t,n+r),v(o)||e.footerFormula(o)})))},e.prototype.GR=function(e,t,n,o){var r,i,a,s,l,u,c,f,h,p,d,g=this,m=!1;return e>=g.cj+g.Xj||(i=(r=g.dataRange()).row,a=k(r),s=g.cj,l=g.cj+g.Xj-1,u=g.kj,c=g.wq,u&&((h=u._modelManager).pVa(g,Le,{row:g.cj,col:g.dj,rowCount:g.Xj,colCount:g.OZ}),(f=h.zTa)&&((p=f.uVa)||(p=[]))),g.ohc(e,t,!0),e<s?e+t<=s&&(g.cj-=t):e===s?g.MZ||(g.Xj-=ue(l-e+1,t),!n&&c&&(h&&h.ENb(g,e,t,o,qe.deleted),c.wL(W(g,e),ue(l-e+1,t),p),m=!0)):e<=l&&(g.Xj-=ue(l-e+1,t),!n&&c&&(h&&h.ENb(g,e,t,o,qe.deleted),c.wL(W(g,e),ue(l-e+1,t),p),m=!0),e===l&&g.NZ&&(u&&u._modelManager.pVa(g,"showFooter",g.NZ),g.NZ=!1)),g.xr&&g.xr.GR(e,t),e>=i&&e<i+a&&((d=g.ZX)&&d.onRowsRemoved(e-i,t))),m},e.prototype.HR=function(e,t){var n,o,r,i,a,s=this,l=s.Nz;e>=s.dj+s.OZ||((n=s.kj)&&(n._modelManager.pVa(s,Le,{row:s.cj,col:s.dj,rowCount:s.Xj,colCount:s.OZ}),n._modelManager.pVa(s,ze,s.Nz.slice())),o=s.dj,r=s.dj,i=s.dj+s.OZ-1,e<r?e+t<=r?s.dj-=t:(s.dj=e,s.OZ-=e+t-r,l&&(l.splice(0,e+t-r),s.xNb(0,e+t-r))):(s.OZ-=ue(i-e+1,t),l&&(l.splice(e-r,ue(i-e+1,t)),s.xNb(e-r,ue(i-e+1,t)))),s.xr&&s.xr.HR(e,t),e>=o&&((a=s.ZX)&&a.onColumnsRemoved(e-o,t)))},e.prototype.$b=function(e,t,n,r){var i,a,s,l,u,c,f,h,p,d,g,m,y=this,v=n,b=r,C=y.kj;C&&(v=C.getRowCount(),b=C.getColumnCount()),i=e<0?0:e,a=t<0?0:t,s=e<0?v:n,l=t<0?b:r,u=o.kf(i,a,s,l),c=y.headerIndex(),y.MZ&&i<=c&&c<i+s&&(f=o.kf(c,y.dj,1,y.OZ),(h=u.getIntersect(f,v,b))&&y.m$(h.col-y.dj,E(h))),p=y.dataRange(),(d=u.getIntersect(p,v,b))&&y.n$(d),g=y.footerIndex(),y.NZ&&i<=g&&g<i+s&&(m=o.kf(g,y.dj,1,y.OZ),(h=u.getIntersect(m,v,b))&&y.o$(h.col-y.dj,E(h))),y.xr&&y.xr.$b(e,t,n,r)},e.prototype.toJSON=function(){var e,t,n,o,r,i,a,s=this,l=s.style(),u=s.xr,c="columns",f={name:[s.name(),se],row:[s.cj,-1],col:[s.dj,-1],rowCount:[s.Xj,-1],colCount:[s.OZ,-1],showHeader:[s.MZ,!0],showFooter:[s.NZ,!1],useFooterDropDownList:[s.kNb,!1],showResizeHandle:[s.lNb,!1],highlightFirstColumn:[s.highlightFirstColumn(),!1],highlightLastColumn:[s.highlightLastColumn(),!1],bandRows:[s.bandRows(),!0],expandBoundRows:[s.expandBoundRows(),!1],bandColumns:[s.bandColumns(),!1],style:[l?l.toJSON():se,se],autoGenerateColumns:[s.autoGenerateColumns(),!0],bindingPath:[s.bindingPath(),le],rowFilter:[u?u.toJSON():se,se],reservedElement:[s.ONb,se],allowAutoExpand:[s.qNb,!0],columns:[[]]};for(e=0;e<s.Nz.length;e++)n=(t=s.Nz[e].toJSON())[Se],o=t[Te],n&&(t[Se]=O(s.kj,n,s.footerIndex(),e+s.dj)),o&&(t[Te]=O(s.kj,o,s.dataRange().row,e+s.dj)),f[c][0][e]=t;for(i in f[c][1]=se,r={},f)(a=f[i])[0]!==a[1]&&(r[i]=a[0]);return y(r)?le:r},e.prototype.fromJSON=function(e,n){var o,r,i,a,s,u,f,h,d,g,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P;if(e){if(o=this,m([de,ye,ve,be,Ce,we],(function(t,n){p(e[n])&&o[n](e[n],!1)})),r=e.row,p(r)&&(o.cj=r),i=e.col,p(i)&&(o.dj=i),a=e.rowCount,p(a)&&(o.Xj=a),s=e.colCount,p(s)&&(o.OZ=s),u=e.showHeader,p(u)&&(o.MZ=u),f=e.showFooter,p(f)&&(o.NZ=f),h=e.expandBoundRows,p(h)&&(o.lhc=h),d=e.useFooterDropDownList,p(d)&&(o.kNb=d),g=e.showResizeHandle,p(g)&&(o.lNb=g),(y=e.style)&&((v=new c.TableTheme).fromJSON(y,n),o.style(v)),b=e.dataSource,C=e.dataBinding,w=e.bindingPath,n?(b&&l.qL&&(o.wq=new l.qL,o.wq.bind(b)),C&&l.qL&&(o.wq=new l.qL,o.wq.fromJSON(C))):w&&(o.UZ=w,A=(x=o.kj)&&x.getDataSource&&x.getDataSource(),l.CellBindingSource&&A instanceof l.CellBindingSource&&((M=l.LL(A.getSource(),w))&&(o.wq=new l.qL,o.wq.bind(M)))),S=e.columns){for(N=(T=S).length,I=o.Nz=[],R=void 0,k=void 0,E=0;E<N;E++)k=T[E],(R=new Ye(o.TZ())).fromJSON(k),D=R.name(),j=o.dga(D,E),I.push(R),j!==D&&o.setColumnName(E,j);o.Qdc()}o.kNb&&o.sNb(!0),(_=e.rowFilter)&&((O=t.MAb&&new t.MAb)&&(O.table(o),O.fromJSON(_,n),o.xr=O,o.xr.reFilter())),(F=e.reservedElement)&&(o.ONb=F),P=e.allowAutoExpand,p(P)&&(o.qNb=P)}},e.prototype.formulaFromJSON=function(){var e,t,n,o,r,i,a=this,s=a.kj,l=s.Bj(),u=a.Nz,c=a.footerIndex(),f=a.dataRange().row,h=a.dj;for(n=0;n<u.length;n++)t=n+h,(o=(e=u[n]).footerFormula())&&"string"==typeof o&&e.footerFormula(_(s,o,c,t)),(r=e.dataAreaFormula())&&l&&(i=l.Qf(f,t),v(i)||e.NNb({isArrayFormula:!0,isDynamicArray:i.isDynamicArray})),r&&"string"==typeof r&&e.dataAreaFormula(_(s,r,f,t))},e.prototype.Qdc=function(){var e,t,n=this.Nz,o=n.length;for(t=0;t<o;t++)(e=n[t]).id()<1&&e.id(this.TZ())},e.prototype.startRow=function(){return this.cj},e.prototype.startColumn=function(){return this.dj},e.prototype.endRow=function(){return this.cj+this.Xj-1},e.prototype.endColumn=function(){return this.dj+this.OZ-1},e.prototype.hasHeadersRow=function(){return this.MZ},e.prototype.hasTotalsRow=function(){return this.NZ},e.prototype.tableName=function(){return this.name()},e.prototype.getColumnIndexInTable=function(e){e=e.toLowerCase().replace(/\u00A0/g," ");var t=-1,n=i.Common.u.Gb(e,"\r\n","\n");return v(e)||m(this.Nz,(function(o,r){var i=(""+r.name()).toLowerCase().replace(/\u00A0/g," ");if(i===e||i===n)return t=o,!1})),t},e.prototype.source=function(){var e=this.kj;return e&&e.yj&&e.yj()},e.prototype.JZ=function(){var e,t,n,o=this,r=o.kj;r&&((e=o.bindingPath())&&(t=r.getDataSource&&r.getDataSource(),l.CellBindingSource&&t instanceof l.CellBindingSource&&(n=l.LL(t.getSource(),e),o.zNb(n))))},e.prototype.zNb=function(e){var t,n,o,r,i,s,u,c=this,f=c.kj;if(e){n=(t=c.dataRange()).row,o=k(t),(r=new l.qL).bind(e,f._modelManager.zTa),i=r.getRowCount();try{S(f),i>o?c.lhc?f.addRows(n+o,i-o):((s=f.wq)&&s.aLb&&(s.bLb=!0),c.PNb=!0,0===o?c.Nia(n,i):c.Nia(n+o-1,i-o,!0),delete c.PNb):i<o&&(c.lhc?f.deleteRows(n+i,o-i):(c.PNb=!0,c.STa(n+i,o-i),delete c.PNb)),c.wq=se,c._bind(r),(u=a&&f.Cf())&&!u.IsSuspended()&&f.recalcAll()}finally{T(f)}}},e.prototype.clone=function(){var t=new e,n=he(this.toJSON());return t.Yv(this.tc),t.fromJSON(pe(n)),t},e.prototype.p$=function(e){var t=new l.qL;t.bind(e),this.wq=t},e.prototype.Az=function(e){if(e&&!e.bindingPath()){var t=e.wq;t&&this.p$(t.getSource())}},e.prototype.LZ=function(){var e=this.wq;return e?e.getSource():se},e.prototype.q$=function(){var e=this.wq;return e?e.getRowCount():0},e.prototype.Eec=function(e,t){var n,o=this.Bec;t?o.push(e):-1!==(n=o.indexOf(e))&&o.splice(n,1)},e.prototype.Cec=function(e){var t=this;t.Bec.forEach((function(n){n.Jec(t,e)})),2===e&&(t.Bec=[])},e.prototype.wzb=function(e,t,n){var o,r;this.OAb||((r=(o=this.LAb)[n])||(r=o[n]={}),r[[e,t].join(",")]=!0)},e.prototype.NAb=function(e,t,n){var o,r,i,a,s,l,u,c,f,h,p=this,d=p.kj,g=d&&d.getCalcService&&d.getCalcService();if(p.OAb=!0,g)for(r in r=void 0,o=p.LAb)if(i=g.jh[r])for(l in a=i.dUa(),s=o[r])c=+(u=l.split(","))[0],f=+u[1],(h=i.Kf(c,f))?(p.QNb(c,f)||p.RNb(h,e,t,n,!1,c,f),i.fg(c,f,h,void 0,!1,a)):delete s[l];else delete o[r];delete p.OAb},e.prototype.SNb=function(e,t,n){var o,r,i,a,s,l,u,c,f,h=this,p=h.kj,d=p&&p.getCalcService();if(h.OAb=!0,d)for(r in r=void 0,o=h.LAb)for(a in i=d.jh[r],o[r])l=+(s=a.split(","))[0],u=+s[1],(c=i.Kf(l,u))&&e===l&&t===u&&((f=ee(c))>-1&&(c.arguments[f]=n));delete h.OAb},e.prototype.QNb=function(e,t){var n,o,r=this,i=r.footerIndex(),a=!1;return i>-1&&e===i&&(o=(n=r.dj)+r.OZ,a=t>=n&&t<o),a},e.prototype.sort=function(e,t){var n=this,o=n.kj,r=n.dataRange(),i=n.rowFilter();o&&0<=e&&e<r.colCount&&(o.suspendPaint(),o.sortRange(r.row,r.col,r.rowCount,r.colCount,!0,[{index:e+r.col,ascending:t}]),i&&(i.zZ={index:e+r.col,ascending:t}),o.resumePaint())},e.prototype.hJb=function(){return!!this.wq},e.prototype.eMb=function(e,t,n,o,r){var i,a,s,l,u,c,f=this,h=f.kj,p=f.cj,d=f.dj,g=f.Xj,m=f.OZ,y=p+g-1,v=n?e+1:e,b=v+t,C=f.dataRange();J(h);try{f.eJb(!1),f.TNb(),f.rI(v,t,n,!1,!0),f.NAb(),o&&!f.UNb&&(a=(i=y+1)+t,s=r-i+1,h.moveTo(i,d,a,d,s,m,1023)),l=y-v+1,(!n||e!==y)&&l>0&&(h.dJb=!0,h.zFc=C,h.moveTo(v,d,b,d,l,m,1023),delete h.zFc,delete h.dJb),u=h._modelManager,c=f.dataRange(),u._Ua&&u._Ua(v,t,[c]),u.CVa&&u.CVa(v,t,[c]),f.VNb(),f.KZ(v,t,!0),f.LNb(),f.HNb(v,t,!0),f.MNb(),f.tc.Nm()}finally{f.eJb(!0),Q(h),f.Cec(0),h.recalcAll(!0)}},e.prototype.eJb=function(e){this.kj.eJb(e)},e.prototype.insertRows=function(e,t,n){if(!(v(e)||v(t)||t<=0)){e=te(this,e,!0),this.Nia(e,t,n)}},e.prototype.Nia=function(e,t,n){var o,r,i,a,s,l,u,c,f,h,p;v(e)||v(t)||t<=0||(r=(o=this).kj,a=(i=o.dataRange()).row,0===(s=i.rowCount)&&e===a||!(e<a||e>=a+s)||x(Ue().Exp_RowParamOutOfRange),l=o.cj,u=o.dj,c=l+o.Xj-1,f=u+o.OZ-1,p=(h=B(r,o))>c,z(r,o,c+1,h,u,f,t)||o.eMb(e,t,n,p,h))},e.prototype.deleteRows=function(e,t){if(!(v(e)||v(t)||t<=0)){e=te(this,e,!0),this.STa(e,t)}},e.prototype.STa=function(e,t){var n,o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,b,C,w;if(!(v(e)||v(t)||t<=0||(n=this,o=n.kj,r=n.dataRange(),i=r.row,a=r.rowCount,(e<i||e>=i+a)&&x(Ue().Exp_RowParamOutOfRange),s=n.cj,l=n.dj,u=n.Xj,c=n.OZ,f=s+u-1,h=l+c-1,(u<=1||e===i&&!n.MZ&&!n.NZ&&t>=a)&&x(Ue().Exp_TableDeleteCountInvalid),p=B(o,n),d=p>f,z(o,n,f+1,p,l,h,t,!0)))){J(o);try{n.eJb(!1),g=n.hJb(),m=void 0,g&&(m=Z(!0),n.WNb(e,t,m)),n.TNb(),n.GR(e,t,le,m),n.NAb(),y=ue(t,f-e+1),o.clear(e,l,y,c,3,127),e+t<=f&&!g&&o.moveTo(e+t,l,e,l,f-t-e+1,c,1023),d&&(C=(b=f+1)-y,w=p-b+1,o.moveTo(b,l,C,l,w,c,1023)),n.VNb(),n.LNb(),n.HNb(e,t,!1),n.tc.Nm()}finally{n.eJb(!0),Q(o),n.Cec(0),o.recalcAll(!0)}}},e.prototype.insertColumns=function(e,t,n){if(!(v(e)||v(t)||t<=0)){e=te(this,e,!1),this.hMb(e,t,n)}},e.prototype.hMb=function(e,t,n){var o,i,a,s,l,u,c,f,h,p,d,g,m,y,b,C,w,A,M,S,T,N,I,R;if(!(v(e)||v(t)||t<=0||(o=this,i=o.kj,a=o.dataRange(),s=a.row,l=a.col,u=a.rowCount,c=a.colCount,(e<l||e>=l+c)&&x(Ue().Exp_ColParamOutOfRange),f=o.cj,h=o.dj,p=o.Xj,d=o.OZ,g=f+p-1,m=h+d-1,y=L(i,o),b=y>m,z(i,o,f,g,m+1,y,t,!1,!0)))){w=(C=n?e+1:e)+t,J(i);try{o.eJb(!1),o.TNb(),A=!o.hJb(),S=(M=m+1)+t,T=y-M+1,b&&i.moveTo(f,M,f,S,p,T,1023),o.tI(C,t,n,A,!0),o.XNb(C,t,!0),o.NAb(C,t,!0),n&&e===m||!A||(i.dJb=!0,N=o.NZ?1:0,i.moveTo(s,C,s,w,u+N,m-C+1,1023),delete i.dJb),I=i._modelManager,R=o.dataRange(),I.bVa&&I.bVa(C,t,[R]),I.EVa&&I.EVa(C,t,[R]),o.VNb(),o.LNb(),o.INb(C,t,!0),r.kDc(i,C,t,!0,!1),o.tc.Nm()}finally{o.eJb(!0),Q(i),o.Cec(0),i.recalcAll(!0)}}},e.prototype.deleteColumns=function(e,t){if(!(v(e)||v(t)||t<=0)){e=te(this,e,!1),this.TTa(e,t)}},e.prototype.TTa=function(e,t){var n,o,i,a,s,l,u,c,f,h,p,d,g,m,y,b,C,w;if(!(v(e)||v(t)||t<=0||(n=this,o=n.kj,i=n.dataRange(),a=i.col,s=i.colCount,(e<a||e>=a+s)&&x(Ue().Exp_ColParamOutOfRange),l=n.cj,u=n.dj,c=n.Xj,f=n.OZ,h=l+c-1,p=u+f-1,d=n.NZ?1:0,(f<=1||e===u&&t>=f)&&x(Ue().Exp_TableDeleteCountInvalid),g=L(o,n),m=g>p,z(o,n,l,h,p+1,g,t,!0,!0)))){J(o);try{n.eJb(!1),n.TNb(),n.HR(e,t),n.XNb(e,t,!1),n.NAb(e,t,!1),y=ue(t,p-e+1),o.clear(l,e,c,y,3,127),e+t<=p&&o.moveTo(l,e+t,l,e,c-d,p-t-e+1,1023),m&&(C=(b=p+1)-y,w=g-b+1,o.moveTo(l,b,l,C,c,w,1023)),n.VNb(!0),n.LNb(),n.INb(e,t,!1),r.kDc(o,e,t,!1,!1),n.tc.Nm()}finally{n.eJb(!0),Q(o),n.Cec(0),o.recalcAll(!0)}}},e.prototype.TNb=function(){var e=this,t=e.kj,n=e.tc.l$;t&&t._modelManager.tVa([e]),n.splice(n.indexOf(e),1),e.ZZ()},e.prototype.VNb=function(e){var t=this;t.PNb=!0,t.nhc=e,t.tc.Cz(t),delete t.nhc,delete t.PNb},e.prototype.XNb=function(e,t,n){var o,r,i,a=this,s=a.Nz,l=s.length,u=U(a,e);for(r=u;r<l;r++)i=void 0,n?r>u+t-1&&(i=r-t):r>=u&&(i=r+t),(o=s[r].footerFormula())&&a.RNb(o,e,t,n,!0,i)},e.prototype.RNb=function(e,t,n,o,i,a,s){var l,u,c,f,h,p,d,g=this.kj;if(n>0&&e&&e.arguments)for(l=e.arguments,u=void 0,c=void 0,f=0;f<l.length;f++)(u=l[f])instanceof r.xzb&&(g&&(i?(h=a,g._modelManager.YNb(this,u,h)):(p=a,d=s,g._modelManager.ZNb(this,u,p,d))),u.JUa(),c=u.offsetWhenInsertRemoveColumn(t,n,o,i),l[f]=c)},e.prototype.ru=function(e){var t,n,o,r,i,a,s,l=this,u=l.wq,c=l.kj,f=l.MZ?1:0,h=l.cj+f+e,p=l.dj;if(!u||0===u.getRowCount())return se;if(t=l.OZ,n={},o=u.ru(e))for(r in o)w(o,r)&&"function"!=typeof r&&(n[r]=o[r]);for(i=0;i<t;i++)s=(a=l.Nz[i])&&a.dataField(),a&&s&&s.length>0&&v(n[s])&&(n[s]=c.getValue(h,p+i));return n},e.prototype.WNb=function(e,t,n){var o,r,i,a,s=this,l=[],u=s.wq;if(u)for(r=u.getRowCount(),i=0;i<t;i++)a=se,(o=W(s,e+i))<r&&(a=s.ru(o)),l.push({key:n,data:a});s.Ts=l},e.prototype.nKb=function(){var e=[],t=this.Ts;return t&&m(t,(function(t,n){n&&!o.GC$.isFunction(n)&&e.push(n.data)})),e},e.prototype.DNb=function(e,t,n){var o,r,i,a,s=this;s.kj.gga>0||(o=s.nNb,(r=s.wq)&&(i=se,t<r.getRowCount()&&(i=s.ru(t)),a={key:n,data:i},o[e]=a))},e.prototype.ohc=function(e,t,n){var o,r,i,a=this;if(!(a.kj.gga>0))if(o=a.nNb,n)r=o.splice(e,t),a.mhc.push({rowIndex:e,count:t,deletedDirtyItems:r});else for(i=0;i<t;i++)o.splice(e,0,se)},e.prototype.ihc=function(e,t){this.nNb.splice(e,t)},e.prototype.phc=function(){var e,t,n=this.mhc.pop(),o=n.rowIndex,r=n.count,i=n.deletedDirtyItems;for(e=0;e<r;e++)t=i[e],this.nNb[o+e]=Xe({},t)},e.prototype.getDirtyRows=function(){var e,t,n,o=this,r=o.nNb,i=[];for(n=0;n<r.length;n++)e=r[n],v(e)||(t=W(o,n),i.push({row:t,originalItem:e.data,item:o.ru(t)}));return i},e.prototype.clearPendingChanges=function(){this.nNb=[]},e.prototype.footerRowDropDowns=function(e,t){var n,o,r,i,a=this,s=a.mNb[e];if(s){if(1===arguments.length)return s.dropDowns&&s.dropDowns.slice();if(n=s.dropDowns[0],t)return o=t.listOption,r=t.submitCommand,i=t.type,o&&(n.option=o),r&&(n.submitCommand=r),p(i)&&(n.type=i),a}},e.prototype.checkTableLastRow=function(e){var t=this.dataRange();return this.headerIndex()===e||t.row+t.rowCount-1!==e},e.prototype.checkTableLastCol=function(e){var t=this.dataRange();return t.col+t.colCount-1!==e},e.prototype.PIb=function(e,t,n,o,r){var i,a,s,l=this,u=l.kj;Y(u,l,n?De:Ee,e,t,o,r),i=u._modelManager,a=n?Ee:De,s=!n&&le,i&&i.ZVa(["tableRowsChanged",l,a,e,t,s,n])},e.prototype.QIb=function(e,t,n,o){var r,i,a,s=this,l=s.kj;K(l,s,n?_e:je,e,t,o),r=l._modelManager,i=n?je:_e,a=!n&&le,r&&r.ZVa(["tableColumnsChanged",s,i,e,t,a])},e}(),t.Table=Je,Je.prototype.name=h(de,"",nt(de),D),Je.prototype.bandRows=h(be,!0,nt(be)),Je.prototype.bandColumns=h(Ce,!1,nt(Ce)),Je.prototype.highlightFirstColumn=h(ye,!1,nt(ye)),Je.prototype.highlightLastColumn=h(ve,!1,nt(ve)),Je.prototype.style=h("style",le,nt("style")),Je.prototype.autoGenerateColumns=h(we,!0,nt(we)),s&&s.HideRowFilter&&(Qe=function(e){function t(t){var n=e.call(this)||this;return n.table(t),n}return $e(t,e),t.prototype.oZ=function(){return 0},t.prototype.pZ=function(){return this.range.colCount},t.prototype.table=function(e){var t=this;return 0===arguments.length?t.sj:(t.sj=e,void(e&&(t.kj=e.kj)))},t.prototype.rI=function(t,n){var o=this.sj;e.prototype.rI.call(this,t,n),o&&this.BZ(o.dataRange())},t.prototype.GR=function(t,n){var o=this.sj;e.prototype.GR.call(this,t,n),o&&this.BZ(o.dataRange())},t.prototype.no=function(){this.sj=se,this.kj=se},t}(s.HideRowFilter),t.MAb=Qe),Ye=function(){function e(e,t,n,o,r,i){var a=this;a.id(e),a.dataField(t),a.name(n||t||Ae+a.id()),a.formatter(o),a.cellType(r),a.value(i)}return e.prototype.k$=function(){return this.id()>0},e.prototype.toJSON=function(){var e=this,t={};return m(Re,(function(n,o){var r=e[o]();v(r)||(o===ge&&r.toJSON&&"function"==typeof r.toJSON?t[o]=r.toJSON():t[o]=r)})),y(t)?le:t},e.prototype.fromJSON=function(e){if(e){var t=this;m(Re,(function(n,r){var i,a,s,l,u=e[r]!==le?e[r]:e["_"+r];v(u)||r===ge&&(i=u.typeName,(s=(a=o.CellTypes&&o.CellTypes._o)&&a[i]||a[u.type]||o.getTypeFromString(i))&&((l=new s).fromJSON(u,!1),u=l)),v(u)||t[r](u,!1)}))}},e}(),t.TableColumn=Ye,Ye.prototype.id=function(e){var t=h("id",le,(function(e){this.name()||this.name(Ae+e)}));return 0===arguments.length?t.call(this):v(e)?this:t.call(this,e)},Ye.prototype.name=h(de,le,(function(e){if(!e){this.name(Ae+this.id())}})),Ye.prototype.formatter=h(me),Ye.prototype.cellType=h(ge),Ye.prototype.value=h("value"),Ye.prototype.dataField=h(Me),Ye.prototype.footerValue=h(Ne),Ye.prototype.dataAreaFormula=h(Te),Ye.prototype.footerFormula=h(Se),Ye.prototype.ANb=h("dataAreaFormulaStr"),Ye.prototype.NNb=h("isArrayFormula"),Ke=function(){function e(e){this.kj=e,this.l$=[],this.$m=[],this.an=[]}return e.prototype.no=function(){var e,t,n=this,o=n.l$,r=o.length;for(t=0;t<r;t++)(e=o[t])&&e.no();n.l$=[],n.Nm(),n.kj=se},e.prototype.Nm=function(){var e,t,n,o=this;for(o.$m=[],o.an=[],t=(e=o.l$).length,n=0;n<t;n++)e[n].Nm()},e.prototype.hNb=function(e){var t,n,o=this.l$,r=o.length;for(n=0;n<r;n++)et((t=o[n]).oNb,e),t.oNb[e]=le},e.prototype.iNb=function(e){var t,n,o=this.l$,r=o.length;for(n=0;n<r;n++)et((t=o[n]).pNb,e),t.pNb[e]=le},e.prototype.add=function(e,t,n,o,r,i,a){var s=this;return s.LA(s.kj,e,t,n,o,r,!0),s.Cz(new Je(e,t,n,o,r,i||c.TableThemes.medium2,a))},e.prototype.addFromDataSource=function(e,t,n,o,r,i){var a,s,u,c,f;if(o||x(Ue().Exp_TableDataSourceNullError),l.qL)return this,(a=this.kj).suspendPaint(),(s=new l.qL).bind(o),u=s.getRowCount()+1,c=s.getColumnCount(),(f=this.add(e,t,n,u,c,r,i))._bind(s),a.clearPendingChanges(),a.resumePaint(),f},e.prototype.find=function(e,t){var n,o,r,i=this.l$,a=i.length;for(o=0;o<a;o++)if((r=(n=i[o]).range()).row<=e&&e<r.row+k(r)&&r.col<=t&&t<r.col+E(r))return n;return se},e.prototype.findByName=function(e){var t,n,o=this.l$,r=o.length;for(n=0;n<r;n++)if((t=o[n]).name().toLowerCase()===e.toLowerCase())return t;return se},e.prototype.pJb=function(e,t,n,r){var i,a,s=this.l$,l=s.length,u=o.kf(e,n,t,r),c=[];for(a=0;a<l;a++)i=s[a],u.containsRange(i.range())&&c.push(i);return c},e.prototype.s$=function(e,t,n,o){var r,i,a=this.l$,s=a.length,l=[];for(i=0;i<s;i++)(r=a[i]).range().intersect(e,t,n,o)&&l.push(r);return l},e.prototype.KHb=function(){var e=this.kj,t=this.find(e.Jl,e.Kl);if(t)return e.cm(new o.Range(-1,t.dj,-1,t.OZ))},e.prototype.Cz=function(e,t){var n,o;if(e)return(n=this).findByName(e.name())&&x(Ue().Exp_TableHasSameNameError),(o=n.kj).suspendPaint(),e.Yv(n),o._modelManager.tVa([]),n.l$.push(e),e.PNb||e.JZ(),e.showHeader()&&e.PZ(),!t&&e.showFooter()&&e.SZ(),n.t$(e),o.resumePaint(),e},e.prototype.vV=function(e){var t,n=this,o=g(e,n.l$);return o>-1?((t=n.kj)&&t._modelManager.tVa([e]),n.l$.splice(o,1),n.u$([e],!1),e):se},e.prototype.remove=function(e,t){var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,b,C=this;if(q(e)&&(e=C.findByName(e)),e&&(t=t||0,e.RZ(),e=C.vV(e))){n=e.range(),r=C.kj;try{if(S(r),i=n.row,a=n.row+k(n),s=n.col,l=n.col+E(n),u=void 0,c=void 0,f=e.showHeader(),h=e.headerIndex(),1!=(1&t))for(u=i;u<a;u++)for(c=s;c<l;c++)A(r,u,c,se),M(r,u,c,se);else if(e.hJb()){if(f)for(u=h,c=s;c<l;c++)r.setValue(u,c,e.getColumnName(c-n.col));for(g=(d=(p=e.dataRange()).row)+k(p),void 0,m=void 0,y=void 0,u=d;u<g;u++)for(c=s;c<l;c++)(m=e.Nz[U(e,c)])&&(y=e.ru(W(e,u))[m.dataField()],v(y)||r.setValue(u,c,y))}else if(f)for(u=h,c=s;c<l;c++)r.setValue(u,c,e.getColumnName(c-n.col));if(2==(2&t))for(u=i;u<a;u++)for(c=s;c<l;c++)b=r.getStyle(u,c)||new o.Style,e.Yo(u,c,b),r.setStyle(u,c,b)}finally{T(r)}e.Cec(2)}return e},e.prototype.move=function(e,t,n){var o,r,i,a=this,s=a.kj;if(q(e)&&(e=a.findByName(e)),e&&t>=0&&n>=0&&(o=e.range(),0===(i=(r=a.s$(t,n,k(o),E(o))).length)||1===i&&r[0]===e)){S(s);try{e.YZ(t,n)}finally{T(s)}}},e.prototype.resize=function(e,t){var n,r,i,a,s,l,u,c,f,h=this,p=h.kj;if(q(e)&&(e=h.findByName(e)),e&&(n=e.range(),r=e.dataRange(),a=t,3===(i=arguments).length&&(a=o.kf(n.row,n.col,i[1],i[2])),a&&(s=k(a),l=E(a),s>=0&&l>=0&&h.s$(a.row,a.col,s,l).length<=1))){J(p);try{e.b$(a),!e.hJb()&&n.rowCount<a.rowCount&&(u=p._modelManager,c=n.row+n.rowCount,f=a.rowCount-n.rowCount,e.showFooter()&&c--,u._Ua&&u._Ua(c,f,[r]),u.CVa&&u.CVa(c,f,[r]))}finally{Q(p)}}},e.prototype.all=function(){var e=[];return m(this.l$,(function(t,n){e.push(n)})),e},e.prototype.Xec=function(e){var t,n=e||this.l$,o=n.length;for(t=0;t<o;t++)n[t].clearPendingChanges()},e.prototype.Nec=function(e,t,n,o){var r,i,a=[],s=this.l$,l=s.length;for(r=0;r<l;r++)(i=s[r]).cj>=e&&i.dj>=t&&i.cj+i.Xj<=e+n&&i.dj+i.OZ<=t+o&&a.push(i);return a},e.prototype.Oec=function(e,t,n,o){var r=this.s$(e,t,n,o),i=this.Nec(e,t,n,o),a=[];return i.length>0?r.forEach((function(e){-1===i.indexOf(e)&&a.push(e)})):a=r,a},e.prototype.Pec=function(e,t,n){var o,r,i=e.length;for(o=0;o<i;o++)if((r=e[o].range()).row<=t&&t<r.row+k(r)&&(n<0||r.col<=n&&n<r.col+E(r)))return!0;return!1},e.prototype.LA=function(e,t,n,o,r,i,s){var l,u,c,f;return t?j(t)?n<0||r<1||n+r>e.getRowCount()?(s&&x(Ue().Exp_TableInvalidRow),!1):o<0||i<1||o+i>e.getColumnCount()?(s&&x(Ue().Exp_TableInvalidColumn),!1):(l=e.tables).rn(n,o,r,i)?(s&&x(Ue().Exp_TableIntersectError),!1):l.findByName(t)?(s&&x(Ue().Exp_TableHasSameNameError),!1):(c=(u=a&&e.Ms(n,o,r,i))&&u.ranges,f=!0,c&&m(u,(function(e,t){if(k(t)>1||E(t)>1)return s&&x(Ue().Exp_ArrayFormulaTable),f=!1,!1})),f):(s&&x(Ue().Exp_TableNameInvalid),!1):(s&&x(Ue().Exp_TableEmptyNameError),!1)},e.prototype.$Hb=function(e,t,n,o){var r,i,a=[],s=this.l$;for(r=0;r<s.length;r++)(i=s[r]).cj>=e&&i.dj>=t&&i.cj+i.Xj<=e+n&&i.dj+i.OZ<=t+o&&a.push(i.name());return a},e.prototype.HZ=function(e,t,n,r){var i,a,s,l,u=this.all();if(u)for(i=o.kf(e,t,n,r),a=u.length,s=void 0,l=0;l<a;l++)if(s=u[l].range(),i.intersect(s.row,s.col,k(s),E(s))&&!i.containsRange(s))return!0;return!1},e.prototype.rn=function(e,t,n,o){var r,i=this.l$,a=i.length;for(r=0;r<a;r++)if(i[r].range().intersect(e,t,n,o))return!0;return!1},e.prototype._getTable=function(e,t,n,o,r){var i,a,s,l=e.tables.all(),u=l.length,c=[];for(a=0;a<u;a++)(s=(i=l[a]).range()).row>=t&&s.col>=n&&s.row+s.rowCount<=t+o&&s.colCount+s.col<=n+r&&c.push({table:i,index:a});return c},e.prototype.zxb=function(e,t,n,o,r){var i,a,s,l,u,c,f,h,p=n.tables.all(),d=p.length;if(!v(t)&&(a=o.row-t.row,s=o.col-t.col,0!==(l=this._getTable(e,t.row,t.col,t.rowCount,t.colCount)).length))for(u=0;u<d;u++)for(i=p[u],c=0;c<l.length;c++)if(f=l[c],(!r||u!==f.index)&&(h=f.table.range(),i.range().intersect(h.row+a,h.col+s,h.rowCount,h.colCount)))return n.Os(6,Ue().Exp_TableIntersectError),!0;return!1},e.prototype.KZ=function(e,t){var n,o,r=this.l$;for(n=0,o=r.length;n<o;n++)r[n].KZ(e,t)},e.prototype.rI=function(e,t){var n,r,i,a,s,l,u,c,f,h,p=this.l$,d=[];for(n=0,r=p.length;n<r;n++)a=(i=p[n]).LZ(),C(d,a)?i.rI(e,t,!0):i.rI(e,t)&&d.push(a);s=this.kj;try{for(S(s),l=void 0,u=void 0,n=0,r=p.length;n<r;n++)l=(i=p[n]).q$(),u=i.dataRange(),l>0&&l!==k(u)&&(c=l,i.showHeader()&&(c+=1),i.showFooter()&&(c+=1),f=i.range(),h=o.kf(f.row,f.col,c,E(u)),i.b$(h))}finally{T(s)}},e.prototype.tI=function(e,t){var n,o=this.l$,r=o.length;for(n=0;n<r;n++)o[n].tI(e,t)},e.prototype.khc=function(e){var t,n,o,r,i=this.l$,a=i.length;for(r=0;r<a;r++)n=(t=i[r]).dj,o=t.endColumn(),n<=e&&o>=e&&t.khc()},e.prototype.GR=function(e,t){var n,r,i,a,s,l,u,c,f,h,p,d=this,g=d.l$,m=[],y=[],v=[];for(n=0,r=g.length;n<r;n++)a=(i=g[n]).LZ(),e<=(s=i.range()).row&&s.row+k(s)<=e+t?v.push(i):(C(m,a)?i.GR(e,t,!0):(i.hJb()&&i.WNb(e,t,Z(!0)),i.GR(e,t)&&m.push(a)),y.push(i));d.kj._modelManager.tVa(v),d.l$=y,d.u$(v,!0),l=d.kj;try{for(S(l),g=d.l$,u=void 0,c=void 0,n=0,r=g.length;n<r;n++)u=(i=g[n]).q$(),c=i.dataRange(),u>0&&u!==k(c)&&(f=u,i.showHeader()&&(f+=1),i.showFooter()&&(f+=1),h=i.range(),p=o.kf(h.row,h.col,f,E(c)),i.b$(p))}finally{T(l)}},e.prototype.HR=function(e,t){var n,o,r,i=this,a=i.l$,s=[],l=[],u=a.length;for(o=0;o<u;o++)e<=(r=(n=a[o]).range()).col&&r.col+E(r)<=e+t?l.push(n):(n.HR(e,t),s.push(n));i.kj._modelManager.tVa(l),i.l$=s,i.u$(l,!0)},e.prototype.$b=function(e,t,n,r,i){var a,s,l,u,c,f=this,h=o.kf(e,t,n,r),p=[],d=f.kj;if(1==(1&i)){for(u=[],s=(a=f.l$).length,c=0;c<s;c++)l=a[c],h.containsRange(l.range())?p.push(l):u.push(l);for(s=u.length,c=0;c<s;c++)(l=u[c]).$b(e,t,n,r);d&&d._modelManager.tVa(p),f.l$=u}if(2==(2&i))for(s=(a=f.l$).length,c=0;c<s;c++)l=a[c],h.containsRange(l.range())&&(d&&d._modelManager.pVa(l,"style",l.style()),l.style(se));return f.u$(p,!0),p},e.prototype.u$=function(e,t){if(e&&0!==e.length){var n=this.kj;o.GC$.each(e,(function(e,t){t.Aq()&&t.getSlicerData().onTableRemoved(t),t.uNb()&&(n&&n._modelManager.pVa(t,Ie,t.wNb()),t.mNb=[])})),a&&function(e,t,n){var o=e.parent,i=N(e);function a(t,o){m(t,(function(t,a){var s=a.getExpression(),l=r.CalcOperatorAdjustor.adjustExpressionOnRemoveTable(s,o,-1,-1,n);l!==s&&(a.fg(l),i.invalidName(e.yj(),a.getName()))}))}o?(a(o.getCustomNames(),t),m(o.sheets,(function(e,n){a(n.getCustomNames(),t)}))):a(e.getCustomNames(),t),i.onAfterRemoveTable(t,n)}(this.kj,e,t)}},e.prototype.t$=function(e){e&&e.Aq()&&e.getSlicerData().onTableAdded(e)},e.prototype.v$=function(e){for(var t=1;this.findByName(e);)e=ke+t,t++;return e},e.prototype.ge=function(e,t){var n=!1,o=se,r=this.find(e,t);return r&&(r.showHeader()&&e===r.headerIndex()?(o=r.g$(t),v(o)||(o=d(o)),n=!0):(n=(o=r.ge(e,t)).gt,o=o.Qb)),{gt:n,Qb:o}},e.prototype.yq=function(e,t,n){var o=!1,r=!0,i=this.find(e,t);return i&&!0!==i.KNb&&(i.showHeader()&&e===i.headerIndex()?i.VZ(n)?r=!1:(n=v(n)?n:d(n),i.h$(t,n)):i.showFooter()&&e===i.footerIndex()?i.j$(t,n):o=i.yq(e,t,n)),o||!r},e.prototype.Hma=function(e,t,n,o,r,i){var s=this.find(e,t);if(a&&s){if(n>1||o>1)return this.kj.Os(0,Ue().Exp_ArrayFormulaTable),!1;if(s.showHeader()&&e===s.headerIndex()&&r)return!1;!s.KNb&&s.showFooter()&&e===s.footerIndex()&&(v(r)||s.j$(t,se),s.i$(t-s.dj,r,i))}return!0},e.prototype.IZ=function(){var e,t,n,o=this.all();for(e=0,t=o.length;e<t;e++)(n=o[e]).bindingPath()&&(n.wq=se)},e.prototype.dB=function(e,t){var n,o,r,i=[],a=this;if(a&&(n=a.all()))for(r=n.length-1;r>=0;r--)o=n[r],e.containsRange(o.range())&&(t&&(this.kj&&this.kj._modelManager.tVa([o]),a.l$.splice(r,1),o.ZZ(le,le,t)),i.push(o));return i},e.prototype.eB=function(e,t,n,o,r,i){var a,s,l,u,c,f,h,p=this,d=[];for(a=0,s=e.length;a<s;a++)l=e[a],u=void 0,c=void 0,i?c=l:(u=l.bindingPath()?le:l.LZ(),(c=new Je).Yv(p),c.fromJSON(pe(he(l.toJSON()))),c.name(p.v$(c.name())),d.push(c)),f=c.range(),c.S3=!0,c.$Z(o+f.row-t,r+f.col-n),p.Cz(c,i),i?(h=c.ZX)&&(h.kj=p.kj,h.refresh()):u&&c.p$(u),c.S3=!1;for(a=0;a<d.length;a++)d[a].formulaFromJSON()},e.prototype.R3=function(e){for(var t=0,n=e.length;t<n;t++)e[t]._Z()},e.prototype.toJSON=function(){var e,t=this.l$,n=[];if(t)for(e=0;e<t.length;e++)n.push(t[e].toJSON());return 0===n.length?le:n},e.prototype.fromJSON=function(e,t){var n,o,r,i;if(e)for(this.l$=[],this.Nm(),n=0,o=e.length;n<o;n++)r=e[n],(i=new Je).Yv(this),this.l$.push(i),i.fromJSON(r,t)},e.prototype.containTableHeaderTotalRowForSheet=function(){var e,t,n,o,r,i,a,s,l,u,c,f,h=this.kj;if(h&&(e=h.getSelections(),n=void 0,o=void 0,r=void 0,(t=h.tables)&&e))for(i=t.l$,a=void 0,s=void 0,l=void 0,u=void 0,c=0;c<e.length;c++)for(r=(o=(n=e[c]).row)+n.rowCount-1,f=0;f<i.length;f++)if(s=(a=i[f]).range(),l=a.headerIndex(),u=a.footerIndex(),!n.containsRange(s)&&(l>=o&&l<=r||u>=o&&u<=r))return!0;return!1},e.prototype.containTableHeaderTotalRow=function(){var e,t,n,o,r,i,a,s,l=this.kj,u=!1;if(l&&(e=l.getSelections(),t=void 0,n=void 0,l.tables&&e)){if(e.length>1)return u;o=e[0],i=void 0,a=void 0,s=void 0,(r=re(l,o))&&1===r.length&&(n=(t=o.row)+o.rowCount-1,a=(i=r[0]).headerIndex(),s=i.footerIndex(),(a>=t&&a<=n||s>=t&&s<=n)&&(u=!0))}return u},e.prototype.noRoomToInsertColumn=function(){var e,t,n,o,r,i,a,s,l=this.kj;return!!(l&&(e=l.getSelections(),t=l.tables,t&&e&&1===e.length&&(n=e[0],o=n.row,r=n.col,i=n.colCount,a=t.find(o,r),s=l.getColumnCount(3),a&&a.endColumn()+i>=s)))},e.prototype.noRoomToInsertRow=function(){var e,t,n,o,r,i,a,s,l=this.kj;return!!(l&&(e=l.getSelections(),t=l.tables,t&&e&&1===e.length&&(n=e[0],o=n.row,r=n.col,i=n.rowCount,a=t.find(o,r),s=l.getRowCount(3),a&&a.endRow()+i>=s)))},e.prototype.checkTableRow=function(){var e,t,n,o,r,i,a,s=this.kj;return!!(s&&(e=s.getSelections(),t=s.tables,t&&e&&1===e.length&&(n=e[0],o=n.row,r=n.col,i=t.find(o,r),a=i&&i.range(),i&&a&&!i.MZ&&!i.NZ&&1===a.rowCount)))},e.prototype.checkTableCol=function(){var e,t,n,o,r,i,a,s=this.kj;return!!(s&&(e=s.getSelections(),t=s.tables,t&&e&&1===e.length&&(n=e[0],o=n.row,r=n.col,i=t.find(o,r),a=i&&i.range(),a&&1===a.colCount)))},e.prototype.isAcrossTables=function(){var e,t,n,o=this.kj,r=!1;if(o&&(e=o.getSelections(),o.tables&&e)){if(e.length>1)return r;t=e[0],(n=re(o,t))&&(r=n.length>1)}return r},e.prototype.isWholeTableCol=function(){var e,t,n,o,r,i,a,s,l=this.kj,u=!1;return l&&(e=l.getSelections(),l.tables&&e&&(e.length>1?u=!0:(t=e[0],1===(n=re(l,t)).length&&(r=(o=n[0]).dj,i=o.OZ,a=t.col,s=t.colCount,u=r===a&&i===s)))),u},e.prototype.containTableHeader=function(){var e,t,n,o,r,i,a=this.kj,s=!1;if(a&&(e=a.getSelections(),t=void 0,n=void 0,a.tables&&e)){if(e.length>1)return s;o=e[0],(r=re(a,o))&&1===r.length&&(i=r[0].headerIndex(),n=(t=o.row)+o.rowCount-1,t<=i&&n>=i&&(s=!0))}return s},e.prototype.mKb=function(){var e,t,n,o,r,i,a,s,l=this.kj,u=!1;if(l&&(e=l.getSelections(),(t=l.tables)&&e)){if(n=l.getActiveRowIndex(),o=l.getActiveColumnIndex(),e.length>1||!t.find(n,o))return u;for(r=t.l$,i=e[0],a=void 0,s=0;s<r.length;s++)a=r[s],i&&i.intersect(a.cj,a.dj,a.Xj,a.OZ)&&(u=!0)}return u},e.prototype.PMb=function(e){var t,n,o,r,i=-1,a=this.l$;if(a)for(t=a.length,n=void 0,void 0,void 0,o=void 0,r=0;r<t;r++)n=a[r].range(),e&&!n.intersect(e.row,e.col,e.rowCount,e.colCount)||i<(o=n.row+n.rowCount-1)&&(i=o);return i},e.prototype.QMb=function(e){var t,n,o,r,i=-1,a=this.l$;if(a)for(t=a.length,n=void 0,void 0,void 0,o=void 0,r=0;r<t;r++)n=a[r].range(),e&&!n.intersect(e.row,e.col,e.rowCount,e.colCount)||i<(o=n.col+n.colCount-1)&&(i=o);return i},e.prototype.fIb=function(e,t,n,o){var r,i,a,s,l,u,c=this;if(!c.kj.options.isProtected&&0!==(r=c.all()).length)for(s=0;s<r.length;s++)(i=r[s]).qNb&&(a=i.range(),l=t&&t.equals(a),u=t&&0!==c.kj._modelManager.getSpans(t,3).length,t&&(l||u)||(i.UNb=o,c.$Nb(i,a,e,n),delete i.UNb))},e.prototype.$Nb=function(e,t,n,r){var i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x=this.kj,A=null,M=!1,S=t.row+t.rowCount-1,T=new o.Range(t.row,t.col,t.rowCount,t.colCount);if(e.showFooter()){if(i=new o.Range(t.row+t.rowCount-1,t.col,1,t.colCount),n.row===i.row&&n.col>=t.col&&n.col+n.colCount<=t.col+t.colCount)return;M=!0,T.rowCount--}if(a=n.row,s=n.col,l=n.row+n.rowCount-1,u=n.col+n.colCount-1,c=t.row+t.rowCount-1,f=t.col+t.colCount-1,h=le,p=x.getRowCount(),d=T.contains(a-1,s)&&!T.contains(a,s),M||(d=d&&u<=f&&s>=t.col),g=T.contains(a,s-1)&&!T.contains(a,s)&&l<=S&&a>=t.row,T.contains(a,s)&&!T.contains(l,u)){if(m=fe(c,l)-t.row+1,y=fe(f,u)-t.col+1,u>f&&((v=V(x,new o.Range(t.row,f+1,t.rowCount,u-f)))&&u>v.col&&(y=t.colCount)),A=new o.Range(t.row,t.col,m,y),M&&(A.rowCount++,l++),l>c&&(h=V(x,new o.Range(c+1,t.col,A.row+A.rowCount-1,t.colCount))),h&&(b=l-h.row+1)>0){if(V(x,new o.Range(p-Math.abs(b),t.col,Math.abs(b),t.colCount)))return void x.Os(6,Ue().Exp_TableAddRowNoEnoughRoom);x.moveTo(h.row,t.col,A.row+A.rowCount,t.col,p-A.row-A.rowCount,t.colCount,1)}}else if(d&&!M){if(A=new o.Range(a,t.col,n.rowCount,t.colCount),(C=V(x,A,n))&&!n.containsRange(C))return}else if(g&&(A=new o.Range(t.row,s,t.rowCount,n.colCount),(C=V(x,A,n))&&!n.containsRange(C)))return;if(d&&!M&&X(r)&&(e.useFooterDropDownList(!0),function(e,t){e.wu().execute({cmd:"tableShowFooter",sheetName:e.name(),tableName:t.name()})}(x,e)),A){if(t.containsRange(A))return;w=t.union(A),this._Nb(e,t,w)}},e.prototype._Nb=function(e,t,n){var o=this.kj,r=o.getParent();r&&r.commandManager().execute({cmd:"tableResize",sheetName:o.name(),tableName:e.name(),resizeToRange:n})},e.prototype.gJb=function(e,t,n){var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y=this,v=this.kj,b=n.col,C=n.row,w=Ze.TABLE_SELECT,x=Ze.TABLE_CORNER_SELECT,A=Ze.TABLE_COL_SELECT,M=Ze.TABLE_ROW_SELECT,S=v.getActiveRowIndex(),T=v.getActiveColumnIndex();if(-1===n.rowViewportIndex&&(o=v.getCellRect(C,b,n.rowViewportIndex,n.colViewportIndex),(r=y.find(S,T))instanceof Je&&r.showHeader()&&S>=r.cj&&S<r.cj+r.Xj&&T>=r.dj&&T<r.dj+r.OZ&&r.cj<v.lq&&r.cj+r.Xj>v.lq&&n.col<r.dj+r.OZ&&n.col>=r.dj))if(e>o.x+5&&e<o.x+o.width-18&&t<o.height-5){for(i=v.getSelections(),a=0;a<i.length;a++)if(!((s=i[a]).col===n.col&&1===s.colCount&&s.row===r.cj&&s.rowCount===r.Xj||s.col===n.col&&1===s.colCount&&-1===s.row&&s.rowCount===v.getRowCount()))return G(r,A)}else if(e>o.x+18)return G(r,"default");if(l=v.getCellRect(C,b),y.find(C,b)instanceof Je&&-1!==n.colViewportIndex&&-1!==n.rowViewportIndex){if(u=!1,r=y.find(C,b),c=y.find(S,T),f=!0,1===(i=v.getSelections()).length&&((h=i[0]).row<=C&&h.row+h.rowCount>C&&h.col<=b&&h.col+h.colCount>b&&(f=!1)),r===c&&(u=!0),b===r.dj&&C===r.cj){if(f&&u&&(e<=l.x+2||t<=l.y+2))return G(r,w);if(e>l.x+2&&e<l.x+18&&t>l.y+2&&t<l.y+6)return G(r,x);if(e>l.x+18&&t>l.y+2&&t<l.y+6)return G(r,A);if(e>l.x+2&&e<l.x+18&&t>l.y+6)return G(r,M)}if(b===r.dj+r.OZ-1&&C===r.cj){if(f&&u&&(e>=l.x+v.getColumnWidth(b)-2||t<=l.y+2))return G(r,w);if(e<l.x+v.getColumnWidth(b)-2&&t>l.y+2&&t<l.y+6)return G(r,A)}if(b===r.dj&&C===r.cj+r.Xj-1){if(f&&u&&(e<=l.x+2||t>=l.y+v.getRowHeight(C)-2))return G(r,w);if(e>l.x+2&&e<l.x+18&&t<l.y+v.getRowHeight(C)-2)return G(r,M)}if(f&&u&&b>r.dj&&b<r.dj+r.OZ&&C===r.cj&&t<=l.y+2)return G(r,w);if(b>r.dj&&b<r.dj+r.OZ&&C===r.cj&&t>l.y+2&&t<l.y+6)return G(r,A);if(f&&u&&C>r.cj&&C<r.cj+r.Xj&&b===r.dj&&e<=l.x+2)return G(r,w);if(C>r.cj&&C<r.cj+r.Xj&&b===r.dj&&e>l.x+2&&e<l.x+18)return G(r,M);if(p=v.getColumnWidth(r.dj+r.OZ-1),d=v.getRowHeight(r.cj+r.Xj-1),g=l.x+p,m=l.y+d,u&&(C>r.cj&&C<r.cj+r.Xj&&b===r.dj+r.OZ-1&&e>=g-2&&e<=g||b>r.dj&&b<r.dj+r.OZ&&C===r.cj+r.Xj-1&&t>=m-2&&t<=m)){if(b===r.dj+r.OZ-1&&C===r.cj+r.Xj-1&&t>=m-10&&e>=g-10)return se;if(f)return G(r,w)}}return se},e.prototype.bJb=function(e,t){var n,o,r,i,a=this,s=a.kj;if(a.find(e,t)instanceof Je){for(o=0,(n=a.find(e,t)).NZ&&(o=1),r=0,n.MZ&&(r=1);e>0&&0===s.getRowHeight(e-1);)e--;if(1===r&&t===n.dj&&e===n.cj)return i=P(s,n,!0),F(i,n.dj+n.OZ-1,i);if(t===n.dj&&e===n.cj)return i=P(s,n,!0),F(i,n.dj+n.OZ-1,i);if(e>n.cj&&e<n.cj+n.Xj-o&&t===n.dj)return e===n.cj+r?(e=P(s,n,!0),F(e,n.dj+n.OZ-1,e)):F(e-1,n.dj+n.OZ-1,e-1)}return null},e.prototype.cJb=function(e,t){var n,r,i,a,s,l,u,c,f,h,p,d,g=this,m=g.kj;if(g.find(e,t)instanceof Je){for(r=0,(n=g.find(e,t)).NZ&&(r=1),i=0,n.MZ&&(i=1),a=m.getRowCount()-1;e+1<m.getRowCount()&&0===m.getRowHeight(e+1);)e++;if(a!==e&&t===n.dj+n.OZ-1&&e<n.cj+n.Xj-r)return s=n.cj+n.Xj,u=(l=n.dj)+n.OZ-1,c=F(e+1,n.dj,e+1),e===s-r-1&&(n.qNb?(f=B(m,n),1===r&&z(m,n,s,f,l,u,1,!0,!1,!0)||(p=((h=V(m,new o.Range(s,l,f-s+1,u-l+1)))&&h.row)===s,s!==m.getRowCount()&&(p?function(e,t,n,o,r){e.wu().execute({cmd:Ee,sheetName:e.name(),tableName:t.name(),row:n,count:o,isAfter:r})}(m,n,e,1,!0):function(e,t,n,o,r){e.wu().execute({cmd:"DoInsertRows",sheetName:e.name(),tableName:t.name(),row:n,count:o,isAfter:r})}(m,n,e,1,!0)))):c=F(e,u+1,e)),c;if(m.getRowCount()-1===e&&t===n.dj+n.OZ-1&&0===r){for(d=n.cj+i;d+1<m.getRowCount()&&0===m.getRowHeight(d);)d++;return d+1===m.getRowCount()&&0===m.getRowHeight(d)?F(n.cj,n.dj,n.cj):F(d,n.dj,d)}}return null},e.prototype.fg=function(){var e,t=this.l$,n=t.length;for(e=0;e<n;e++)t[e].e$()},e.prototype.Cec=function(e,t){var n,o,r,i,a,s,l=this.l$,u=l.length;for(n=0;n<u;n++)o=l[n],e?(r=o.cj,i=o.cj+o.Xj-1,r<=t&&t<=i&&o.Cec(0)):(a=o.dj,s=o.dj+o.OZ-1,a<=t&&t<=s&&o.Cec(0))},e.prototype.KFc=function(e,t,n,o,r){var i,a,s,l=this.s$(e,t,n,o),u=[];for(i=0,a=l.length;i<a;i++)s=l[i].dataRange(),r?s.rowCount+=n:s.colCount+=o,u.push(s);return u},e}(),t.TableManager=Ke,function(e){e[e.none=0]="none",e[e.keepData=1]="keepData",e[e.keepStyle=2]="keepStyle"}(t.TableRemoveOptions||(t.TableRemoveOptions={})),o.GC$.extend(o.lUa.prototype,{CNb:function(e,t){var n=this.zTa;n&&(n.uVa||(n.uVa=[]),n.uVa.push({type:"changeTableManager",table:e,oldTableManager:t}))},pVa:function(e,t,n){var o=this.zTa;o&&(o.uVa||(o.uVa=[]),o.uVa.push({type:Pe,table:e,name:t,value:n}))},tVa:function(e){var t,n,o=this.zTa;o&&(o.uVa||(o.uVa=[]),t=o.uVa,n=this.noa,t.push({type:Oe,tableList:n.l$.slice(),changedTables:e}))},sVa:function(e,t,n){var o=this.zTa;o&&(o.uVa||(o.uVa=[]),o.uVa.push({type:Fe,tableColumn:e,name:t,value:n}))},vVa:function(e,t,n){var o=e.getValue(t,n).value,r=this.zTa;r&&(r.uVa||(r.uVa=[]),r.uVa.push({type:He,bindingManager:e,row:t,col:n,oldValue:o}))},ENb:function(e,t,n,o,r){var i=this.zTa;i&&(i.uVa||(i.uVa=[]),i.uVa.push({type:Be,table:e,key:o,row:t,count:n,stateType:r}))},YNb:function(e,t,n){var o=this.zTa;o&&(o.aOb||(o.aOb=[]),o.aOb.push({type:Ve,table:e,expression:t,col:n}))},ZNb:function(e,t,n,o){var r=this.zTa;r&&(r.bOb||(r.bOb=[]),r.bOb.push({type:Ge,table:e,expression:t,row:n,col:o}))},wVa:function(e){var t,n,o,r,i,a,s,l;if(e)for(function(e){var t,n;if(e)for(t=e.length-1;t>=0;t--)(n=e[t]).bindingManager.sUa(n)}(e.rUa),t=e.length-1;t>=0;t--)switch(n=e[t],o=void 0,n.type){case Oe:r=this.noa,i=n.changedTables,r.l$=n.tableList,i&&i.length>0&&i.forEach((function(e){e&&(e.e$(),e.JZ())}));break;case Fe:n.tableColumn[n.name](n.value);break;case Pe:o=n.table,a=n.name,s=n.value,a===Le?(o.cj=s.row,o.dj=s.col,o.Xj=s.rowCount,o.OZ=s.colCount):a===ze?o.Nz=s:a===Ie?o.mNb=s:o[a](s),o.Cec(0);break;case"changeTableManager":o=n.table,l=n.oldTableManager,o.BNb(l);break;case He:n.bindingManager.setValue(n.row,n.col,n.oldValue);break;case Be:ot(n.table,n.row,n.count,n.key,n.stateType)}},cOb:function(e){var t,n,o,r,i,a,s;if(e){for(t=void 0,n=e.length-1;n>=0;n--)(o=e[n]).type===Ve&&(t=o.table,r=o.expression,i=o.col,a=void 0,(a=t.Nz[i].footerFormula())&&((s=ee(a))>-1&&(a.arguments[s]=r)));t&&t.e$()}},dOb:function(e){var t,n,o,r,i;if(e)for(t=e.length-1;t>=0;t--)(n=e[t]).type===Ge&&(o=n.expression,r=n.row,i=n.col,n.table.SNb(r,i,o))}}),o.lUa.$n(ke,{priority:7e3,init:function(){this.noa=new Ke(this.kj)},clearPendingChanges:function(e){var t=this.tables;t&&t.Xec(e.tableList)},undoAddRows:function(e){var t=this.kj,n=e.row,o=e.rowCount;t.tables.s$(n,-1,o,-1).forEach((function(e){e.WNb(n,o,Z(!0))}))},getValue:function(e){var t,n=e.row,o=e.col,r=e.sheetArea,i=this.kj.tables;3===r&&i&&(i.find(n,o)&&(t=i.ge(n,o),e.isValueGet=t.gt,e.value=t.Qb))},setValue:function(e){var t,n=e.row,o=e.col,r=e.value,i=e.sheetArea,a=this.kj.tables;3===i&&a&&(a.find(n,o)&&(void 0,(t=e.changes)&&(t.uVa||(t.uVa=[])),e.isValueSet=a.yq(n,o,r)))},undo:function(e){var t=e.uVa,n=e.aOb,o=e.bOb;t&&this.wVa(t),n&&this.cOb(n),o&&this.dOb(o),this.noa.Nm()}}),o.Workbook.$n(ke,{init:function(){o.Commands.mMb(this.commandManager())}})},"./dist/plugins/table/table.ns.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("./dist/plugins/table/table.res.en.js");t.SR={en:o}},"./dist/plugins/table/table.res.en.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_DragDropShiftTableCell="This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet.",t.Exp_DragDropChangePartOfTable="Cannot complete operation: You are attempting to change a portion of a table row or column in a way that is not allowed.",t.Exp_TableEmptyNameError="The table name cannot be empty.",t.Exp_TableNameInvalid="The table name is not valid.",t.Exp_TableInvalidRow="Invalid row index or row count.",t.Exp_TableInvalidColumn="Invalid column index or column count.",t.Exp_TableIntersectError="The tables cannot be intersected.",t.Exp_TableHasSameNameError="The current worksheet already exists in a table with the same name.",t.Exp_TableDataSourceNullError="Table datasource cannot be null.",t.Exp_TableMoveOutOfRange="The table cannot be moved out of the sheet.",t.Exp_TableResizeOutOfRange="The invalid row count, column count, and table cannot be resized out of the sheet.",t.Exp_ArrayFormulaTable="multi-cell array formulas are not allowed in tables.",t.Exp_TableResizeInvalidRange="The headers must remain in the same row, and the resulting table range must overlap the original table range.",t.Exp_TableResizeToSpan="Cannot complete operation: A table cannot overlap with a table or merged cells.",t.Exp_TableResizeWithFilter="Cannot shift cells in a filtered range or table.",t.Exp_TableResizeWithHidden="Cannot resize a table that's adjacent to a hidden row or column.",t.Exp_TableResizeToTable="Cannot complete operation: Operations that include cells both inside and outside a table range, and operation that affect cells that overlap multiple tables are not allowed.",t.Exp_RowParamOutOfRange="The param row out of data range of table.",t.Exp_ColParamOutOfRange="The param col out of data range of table.",t.Exp_TableDeleteCountInvalid="The param count to delete will cause empty table.",t.Exp_TableAddRowIntersectSpan="This won't work because it would move cells in a span on your worksheet.",t.Exp_TableAddRowIntersectTable="This won't work because it would move cells in a table on your worksheet.",t.Exp_TableAddRowNoEnoughRoom="Cannot insert new cells because it would push non-empty cells of the end of worksheet. These cells might appear empty but have blank values, some formatting, or a formula. Delete enough rows or columns to make room for what you want to insert and then try again.",t.Table_Total="Total",t.Table_None="None",t.Table_Average="Average",t.Table_Count="Count",t.Table_Count_Numbers="Count Numbers",t.Table_Max="Max",t.Table_Min="Min",t.Table_Sum="Sum",t.Table_StdDev="StdDev",t.Table_Var="Var"},"./dist/plugins/touch/touch.entry.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n("./dist/plugins/touch/touch.js"))},"./dist/plugins/touch/touch.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe,re,ie,ae,se,le,ue,ce,fe,he,pe,de,ge,me,ye,ve,be,Ce,we,xe,Ae,Me,Se,Te,Ne,Ie,Re,ke,Ee,De,je,_e,Oe,Fe,Pe,He,Be,Le,ze,Ve=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function Ge(e){return e.height}function We(e){return e.width}function Ue(e){clearInterval(e)}function Ze(){return(new Date).valueOf()}function qe(e,t){var n,o;return!(!e||!t)&&(13,15,13,13,15,15,n=e.X-t.X,o=e.Y-t.Y,b(n)<13&&b(o)<13&&T(n*n+o*o)<C(15,15))}function Je(e){return e.getActiveSheet()}function Qe(e){return e.getSelections()}function Ye(e){return e.frozenTrailingColumnCount()}function Ke(e){return e.frozenTrailingRowCount()}function $e(e,t){return e.getColumnCount(t)}function Xe(e,t){return e.getRowCount(t)}function et(e){var t=l(e).offset(),n=Z.body,o=0,r=0;return t&&(o=t.top+n.clientTop||0,r=t.left+n.clientLeft||0),{FB:o,EB:r}}function tt(e,t){var n=A(t.Y,t.X)-A(e.Y,e.X);return n>M?n-=2*M:n<-M&&(n+=2*M),n}function nt(e,t){return T((t.X-e.X)*(t.X-e.X)+(t.Y-e.Y)*(t.Y-e.Y))}function ot(e){return b(e)<=2220446049250313e-31}function rt(e){return new te(e?S(e.X):-1,e?S(e.Y):-1)}function it(e,t){var n=e*t;return n>4?n=4:n<.5&&(n=.5),n}function at(e,t){return G(-t/(e/t+1)+t+"")}function st(e,t){return G(t*(-t/(e-t)-1)+"")}function lt(e,t,n,o,r,i){e.fillStyle=t,e.fillRect(n,o,r,i)}function ut(e,t,n,o,i){var a,s,l,u,c,f=r.Im.Km(0,"gc-columnHeader-normal"),h=f&&f.backgroundImage,p=f&&f.backgroundColor;if(h&&-1!==h.indexOf("linear-gradient"))for(s=r.Ul.wl(h),a=e.createLinearGradient(t+o/2,n,t+o/2,n+i),l=0,u=s.length;l<u;l++)c=s[l],a.addColorStop(c.point,c.color);else p&&(a=p);return a}function ct(){var e=r.Im.Km(0,"gc-rowHeader-normal");return e&&e.backgroundColor}function ft(e,t,n,o,r,i){e.beginPath(),e.strokeStyle=t,e.moveTo(n,o),e.lineTo(r,i),e.stroke()}function ht(e){var t=e.options.sheetAreaOffset;return e.Gt&&e.Gt()||{x:t.left,y:t.top,width:0,height:0}}function pt(e,t){var n,o,r,i,a,s=e.am(),l=e._render.bm(),u=e.jt(1),c=ht(e),f=e.Rt(-1),h=u.findRow(f),d=p("gc-group").color;h&&(n=s.qt,h.y-n>0&&t&&c.width>0&&0===s.Br&&ft(l,d,s.kt-.5,n,s.kt-.5,h.y)),o=e.it(1),r=e.Ot(-1),(i=o.findCol(r))&&(a=s.pt,i.x-a>0&&t&&c.height>0&&0===s.Cr&&ft(l,d,a,s.nt-.5,i.x,s.nt-.5))}function dt(e,t){var n=0;return e||(n|=1),t||(n|=2),n}function gt(e,t,n,o){var r,i,s,l,u,c,f,h,p;if(0===e.selectionPolicy())return y;for(r=t.hitTestType,i=xt(e),s=Qe(e),l=3,e.CH&&s.length>0&&(-1!==(u=s[s.length-1]).row&&-1!==u.col?l=3:-1!==u.row?l=2:-1!==u.col&&(l=1)),c=0;c<i.length;c++)if((f=i[c])&&(f.x-=We(f),f.y-=Ge(f),f.width*=3,f.height*=3,f.contains(n,o)))return a(t.row)&&((h=e.jt(1))&&h.length>0&&(t.row=h[h.length-1].row)),a(t.col)&&((p=e.it(1))&&p.length>0&&(t.col=p[p.length-1].col)),{x:n,y:o,type:l,isHeader:!1,isFirstIndicator:0===c};return 1===r?{x:n,y:o,type:1,isHeader:!0}:2===r?{x:n,y:o,type:2,isHeader:!0}:y}function mt(e,t,n,o){var r,i,s,l,u,c,f,h,p,d,g,m,v=y,b=t.rowViewportIndex,C=t.colViewportIndex;if(a(b)||a(C))return v;if(r=e.parent,i=e._getActiveSelectedRange(),b>=0&&C>=0&&1===e._modelManager.getSelections().length){if(s=e.Tq(i),l=Ye(e),u=Ke(e),c=$e(e)-l,f=Xe(e)-u,1===C&&l>0&&s.col<c&&s.col+s.colCount>c&&((h=e.Hr(C))&&h.length>0&&n>(p=h[h.length-1]).x+We(p)))return v;if(1===b&&u>0&&s.row<f&&s.row+s.rowCount>f&&((d=e.Gr(b))&&d.length>0&&o>(g=d[d.length-1]).y+Ge(g)))return v}return(m=bt(e))&&(v||(m.x-=We(m),m.y-=Ge(m),m.width*=3,m.height*=3,m.contains(n,o)&&(v={action:"drag",side:"corner"})),r&&r.options.allowUserDragFill||v&&"corner"===v.side&&(v.side=y)),v}function yt(e,t,n,o,i){t===o&&n===i||(e._modelManager.setCellState(t,n,r.CellStatesType.active,!1,r.SheetArea.viewport),e.xIb&&e.xIb(r.CellStatesType.active,t,n,r.SheetArea.viewport),e._modelManager.setCellState(o,i,r.CellStatesType.active,!0,r.SheetArea.viewport),e.xIb&&e.xIb(r.CellStatesType.active,o,i,r.SheetArea.viewport))}function vt(e,t,n,o){var r=e.vu();r.ko(t)?n.drawImage(r.lo(t),o.x,o.y,We(o),Ge(o)):r.fo(t)}function bt(e){var t,n,o=y,i=Qe(e),a=i.length;return e.CH&&a>0&&(t=i[a-1],n=e.cm(t),17,20,o=new r.Rect(n.x+We(n)-17,n.y+Ge(n),17,20)),o}function Ct(e,t,n){var o=e.Er(t),i=e.Fr(n),a=e.jt(o),s=e.it(i),l=0,u=0,c=0,f=0;return a.length>0&&(l=a[0].row,u=a[a.length-1].row),s.length>0&&(c=s[0].col,f=s[s.length-1].col),r.kf(l,c,u-l+1,f-c+1)}function wt(e,t,n,o,r,i){var a=e.Er(t),s=e.Fr(n),l=e.am().Ft(a,s),u=Ct(e,t,n),c=u.row<=t&&t<=u.row+u.rowCount-1&&l.y<=r&&r<=l.y+Ge(l),f=u.col<=n&&n<=u.col+u.colCount-1&&l.x<=o&&o<=l.x+We(l);return i&&i.colCheck?f:(i&&i.rowCheck||f)&&c}function xt(e){var t,n,o,i,a,s,l,u,c,f,h,p,d,g,m,v,b,C,w,x,A,M=Qe(e),S=[];if(e.CH&&M.length>0)for(t=M[M.length-1],n=e.cm(t),8,o=e.am(),i=t.row,a=t.row+t.rowCount-1,s=t.col,l=t.col+t.colCount-1,-1!==t.row&&-1!==t.col?(wt(e,i,s,n.x,n.y)&&(S[0]=new r.Rect(n.x-8,n.y-8,16,16)),wt(e,a,l,n.x+We(n),n.y+Ge(n))&&(S[1]=new r.Rect(n.x+We(n)-8,n.y+Ge(n)-8,16,16))):-1!==t.row?(u=o.Ft(1,0),c=o.Ft(1,1),f=u.x+(We(u)+We(c))/2-8,h=$e(e)-1-Ye(e),(d=(p=e.it(1)).findCol(h))&&((g=e.it(0)[0]||p[0])&&(f=g.x+(d.x+We(d)-g.x)/2-8)),wt(e,i,s,f+8,n.y,{rowCheck:!0})&&(S[0]=new r.Rect(f,n.y-8,16,16)),wt(e,a,l,f+8,n.y+Ge(n),{rowCheck:!0})&&(S[1]=new r.Rect(f,n.y+Ge(n)-8,16,16))):-1!==t.col&&(u=o.Ft(0,1),c=o.Ft(1,1),m=u.y+(Ge(u)+Ge(c))/2-8,v=Xe(e)-1-Ke(e),(C=(b=e.jt(1)).findRow(v))&&((w=e.jt(0)[0]||b[0])&&(m=w.y+(C.y+Ge(C)-w.y)/2-8)),wt(e,i,s,n.x,m+8,{colCheck:!0})&&(S[0]=new r.Rect(n.x-8,m,16,16)),wt(e,a,l,n.x+We(n),m+8,{colCheck:!0})&&(S[1]=new r.Rect(n.x+We(n)-8,m,16,16))),x=void 0,A=S.length-1;A>=0;A--)(!(x=S[A])||x.x<0||x.y<0)&&(S[A]=y);return S}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("Core"),i=n("./dist/plugins/touch/touch.res.en.js"),t.SR={en:i},a=o.Common.j.Fa,s=r.Go,(l=r.GC$).extend,u=l.isEmptyObject,c=r.Ul.Nl,f=r.Ul.nl,h=r.Ul.Ml.mozilla,p=r.Im.Lm,d=r.Ul.rl(),g=d.ipad,m=g||d.iphone,y=null,v=void 0,b=Math.abs,C=Math.min,w=Math.max,x=Math.pow,A=Math.atan2,M=Math.PI,S=Math.round,T=Math.sqrt,N=Math.atan,I=Math.log,R=Math.floor,k="touch",E="none",D="MSPointerDown",j="MSPointerMove",_="MSPointerUp",O="pointerdown",F="pointermove",P="pointerup",H="touchstart",B="touchmove",L="touchend",z="MSPOINTER_TYPE_TOUCH",V=isNaN,G=parseInt,W=parseFloat,U=window,Z=document,q=U.Yl,J="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB",Q="AAAAAElFTkSuQmCC",r.Rxb.touch=!0,Y=new o.Common.ResourceManager(t.SR),K=Y.getResource.bind(Y),$=function(){function e(){var e=this;e.rM=[],e.sM={length:0},e.tM=new X,e.uM=new ee}return e.prototype.vM=function(e){this.tM.vM=e},e.prototype.wM=function(e){this.tM.wM=e},e.prototype.xM=function(e){var t=this;t.tM.xM=function(n){if(e){e(n);var o=t.yM;o&&o.zM()}}},e.prototype.AM=function(e){this.tM.AM=e},e.prototype.BM=function(e){this.tM.BM=e},e.prototype.CM=function(e){this.uM.CM=e},e.prototype.DM=function(e){this.uM.DM=e},e.prototype.EM=function(e){this.uM.EM=e},e.prototype.FM=function(e){this.GM=e},e.prototype.HM=function(e){this.IM=e},e.prototype.JM=function(e,t){var n=t?t.KM:this.LM.KM;return r.Ul.Z3(e,n)},e.prototype.MM=function(e,t){var n,o,r,i,a,s=this,l=t.pointerType,u=t.target,c=t.offsetX,h=t.offsetY;l!==t[z]&&l!==k||(o=(n=s.JM(u,e)).EB,r=n.FB,s.NM(e,u,t.pointerId,new te(c+o,h+r),t.timeStamp)&&f(t),"sheet"===s.LM.OM&&(i=t.pageX-(c+o),a=t.pageY-(h+r),s.LM.KM.canvasOffset={top:a,left:i}))},e.prototype.PM=function(e){var t,n=this,o=e.pointerType,r=e.pointerId;if(o===e[z]||o===k){if(n.sM[r]===v)return!1;t=n.JM(e.target),n.aB(r,new te(e.offsetX+t.EB,e.offsetY+t.FB),e.timeStamp)&&f(e)}},e.prototype.QM=function(e){var t,n=this,o=e.pointerType,r=e.pointerId;if(o===e[z]||o===k){if(n.sM[r]===v)return!1;t=n.JM(e.target),n.RM(r,new te(e.offsetX+t.EB,e.offsetY+t.FB))&&f(e)}},e.prototype.SM=function(e){var t,n=this,o=e.pointerType,r=e.pointerId;if(o===e[z]||o===k){if(n.sM[r]===v)return!1;t=n.JM(e.target),n.TM(r,new te(e.offsetX+t.EB,e.offsetY+t.FB))&&f(e)}},e.prototype.UM=function(e,t){var n,o,r,i=et(e.KM),a=t.changedTouches,s=!1;for(n=0;n<a.length;n++)o=a[n],r=h?Ze():t.timeStamp,s=this.NM(e,t.target,o.identifier,new te(o.pageX-i.EB,o.pageY-i.FB),r)||s;s&&f(t)},e.prototype.VM=function(e){var t,n,o,r=et(this.LM.KM),i=e.changedTouches,a=!1;for(t=0;t<i.length;t++)n=i[t],o=h?Ze():e.timeStamp,a=this.aB(n.identifier,new te(n.pageX-r.EB,n.pageY-r.FB),o)||a;a&&f(e)},e.prototype.WM=function(e){var t,n,o=et(this.LM.KM),r=e.changedTouches,i=!1;for(t=0;t<r.length;t++)n=r[t],i=this.RM(n.identifier,new te(n.pageX-o.EB,n.pageY-o.FB))||i;i&&f(e)},e.prototype.XM=function(e){var t,n,o=et(this.LM.KM),r=e.changedTouches,i=!1;for(t=0;t<r.length;t++)n=r[t],i=this.TM(n.identifier,new te(n.pageX-o.EB,n.pageY-o.FB))||i;i&&f(e)},e.prototype.YM=function(e){var t,n,o=this.LM,r=this.ZM;o!==r&&(t=l(o.KM).offset(),n=l(r.KM).offset(),e.X+=t.left-n.left,e.Y+=t.top-n.top)},e.prototype.$M=function(e,t){var n,o,r,i,a,s=this,l=s.rM;for(s.ZM=y,s.yM=y,o=0;o<l.length;o++)if(l[o]===e){if(r=l[o],i=y,a=y,r._M&&!r._M()){for(o=0;o<l.length;o++)if((n=l[o])!==r&&n.aN>=0&&n.aN<r.aN&&(!n._M||n._M())){i=n;break}if(i===y)return!1}if(r.bN&&!r.bN()){for(o=0;o<l.length;o++)if((n=l[o])!==r&&n.aN>=0&&n.aN<r.aN&&(!n.bN||n.bN())){a=n;break}if(a===y)return!1}i===y&&(i=r),a===y&&(a=r),s.LM=r,s.ZM=i,s.cN=a,s.vM(a.dN||y),s.wM(i.eN||y),s.BM(i.fN||y),s.AM(i.gN||y),s.xM(i.hN||y),s.CM(a.iN||y),s.DM(a.jN||y),s.EM(a.kN||y),s.FM(i.GM||y),s.HM(i.IM||y),i.lN&&(s.yM=r.lN);break}return!0},e.prototype.NM=function(e,t,n,o,r){var i=this;return!(i.sM[n]!==v||0===i.sM.length&&!i.$M(e,t)||!i.ZM||!(i.sM.length>=i.ZM.mN)&&(i.yM&&i.yM.nN()||(i.YM(o),i.yM&&0===i.sM.length&&i.yM.oN(),i.sM[n]={id:n,time:Ze(),position:o},i.sM.length++,i.tM.pN(t,n,o,r),i.tM.qN(n,o,i.sM.length,r),1===i.sM.length&&i.uM.qN(o),1===i.sM.length&&i.GM&&i.GM({rN:o}),0)))},e.prototype.aB=function(e,t,n){var o=this;return!(o.sM[e]===v||o.yM&&o.yM.sN()||(o.YM(t),o.sM[e]={id:e,time:Ze(),position:t},o.tM.tN(e,t,n),0))},e.prototype.RM=function(e,t){var n=this;return n.sM[e]!==v&&(delete n.sM[e],n.sM.length--,!(n.yM&&n.yM.uN()||(n.YM(t),n.tM.vN(e),n.tM.wN(),0===n.sM.length&&(n.uM.vN(t),n.uM.wN()),0===n.sM.length&&n.IM&&n.IM({rN:t}),n.yM&&0===n.sM.length&&0===n.tM._process&&n.yM.zM(),0)))},e.prototype.TM=function(e,t){return this.RM(e,t)},e.prototype.xN=function(e,t){var n,i,s,u,c,f=this,h="."+e.OM,p=".gcSheet",d=D+p,g=j+p+h,m=_+p+h,y="MSPointerCancel"+p+h,v="MSLostPointerCapture"+p+h,b=O+p,C=F+p+h,w=P+p+h,x="LostPointerCapture"+p+h,A="pointercancel"+p+h,M=H+p,S=B+p,T=L+p,N="touchcancel"+p;function I(){l(Z).unbind(g).unbind(C).unbind(m).unbind(w).unbind(y).unbind(A).unbind(v).unbind(x)}function R(t){l(Z).bind(g,k).bind(m,z).bind(C,k).bind(w,z).bind(y,V).bind(v,V).bind(x,V).bind(A,V),f.MM(e,t)}function k(e){f.PM(e)}function z(e){f.QM(e),0===f.sM.length&&I()}function V(e){f.SM(e),0===f.sM.length&&I()}n=e.KM,i=f.rM,(s=o.Common.k.Cb(i,e))>=0&&t||s<0&&!t||(u=r.Ul._Va(),t?u?(c=n.style,a(c.msTouchAction)||(c.msTouchAction=E),a(c.touchAction)||(c.touchAction=E),l(n).bind(d,R).bind(b,R)):(l(n).bind(M,(function(t){f.UM(e,t)})),l(n).bind(S,(function(e){f.VM(e)})).bind(T,(function(e){f.WM(e)})).bind(N,(function(e){f.XM(e)}))):u?l(n).unbind(d).unbind(b):l(n).unbind(M).unbind(S).unbind(T).unbind(N),t?i.push(e):i.splice(s,1))},e.prototype.no=function(){var e,t=this.rM;for(e=t.length-1;e>=0;e--)this.xN(t[e],!1)},e}(),t.TouchEventProvider=$,X=function(){function e(){var e=this;e.AN=0,e.BN=0,e.CN=1,e.DN=0,e.EN=0,e._process=0,e.FN=511,e.GN=new le,e.HN=20,e.IN=new ne}return e.prototype.pN=function(e,t,n,o){var r,i=this;3===i._process&&i.JN(!0),i.KN=2===i._process&&1===i.GN.MN(),i.NN=e,(r={}).Np=t,r.ON=n,r.PN=n,i.GN.QN(r),i.RN=o,i.GN.MN()>1&&(i.SN=!1,i.TN=!1,1===i._process&&i.UN())},e.prototype.qN=function(e,t,n,o){0===this._process&&1===n&&this.VN(this.GN.WN(0).PN)},e.prototype.tN=function(e,t,n){var o,r,i,a,s,l,u,c=this;if(0!==c.FN&&c.GN.XN(e)){if(1===c._process&&1===c.GN.MN()){if(o=c.YN(),!c.ZN(1)&&!c.ZN(2)&&!o)return;if(qe(t,r=c.GN.$N(e).PN))return;i=b(t.X-r.X),a=b(t.Y-r.Y),c._N(i,a)}if(!(n-c.RN<20)){if(c.GN.$N(e).aO=t,(s=c.GN.MN())>1)for(l=0;l<s;l++)if(!(u=c.GN.WN(l)).aO)return;for(c.bO(n),c.RN=n,s=c.GN.MN(),l=0;l<s;l++)(u=c.GN.WN(l)).ON=u.aO,u.aO=y}}},e.prototype.wN=function(){var e=this;e.cO&&(e.dO(e.cO),e.cO=y)},e.prototype.vN=function(e){var t=this;t.GN.XN(e)&&(t.GN.eO(e),2===t._process?0===t.GN.MN()&&(t.ZN(64)||t.ZN(256)||t.ZN(128)?t.fO():t.JN(!0)):3===t._process?t.JN(!0):1===t._process&&t.JN(!1))},e.prototype.bO=function(e){var t,n,o,r,i=this,a=i.gO(),s=a.hO,l=a.iO,u=a._position,c=i.jO(),f=c.kO,h=c.eb,p=c.lO;if(i.AN+=s,i.BN+=l,i.CN*=h,i.DN+=f,i.EN+=p,(t={}).lO=p,t.kO=f,t.mO=e-i.RN,t.hO=s,t.iO=l,i.IN.nO(t),i.oO=u,1===i._process||2===i._process){if(1===i._process&&i.UN())return;if((n=new se).pO=p,n.qO=f,n.rO=h,n.sO=new te(s,l),o=new oe(i.IN),r=new fe(i.NN,i.tO(),n,!1,u,o),i.uO(r),r.vO)return void i.JN(!0)}},e.prototype.UN=function(){var e,t=this;return t._process=2,e=new pe(t.NN,t.GN.MN(),t.tO(),t.GN.WN(0).PN),t.wO(e),!!e.vO&&(t.JN(!0),!0)},e.prototype._N=function(e,t){var n=function(e,t){var n,o=!1,r=!1;return 0!==e&&((n=N(t/e)/M*180)<20&&(o=!0)),0===e?r=!0:(n=N(t/e)/M*180)>75&&n<105&&(r=!0),{yN:o,zN:r}}(e,t);this.SN=n.yN,this.TN=n.zN},e.prototype.gO=function(){var e=this.xO(),t=e.yO,n=e.zO,o=new te(t.X,t.Y);return{hO:t.X-n.X,iO:t.Y-n.Y,_position:o}},e.prototype.jO=function(){var e,t=this,n=0,o=1,r=0;return t.ZN(16)&&1===t.GN.MN()&&t.YN()&&(n=function(e,t,n){var o=new te(n._Center.X,n._Center.Y),r=new te(t.X-o.X,t.Y-o.Y),i=new te(e.X-o.X,e.Y-o.Y),a=C(1,x(nt(t,o)/n._Radius,4)),s=tt(r,i);return V(s)?0:s*a}(t.GN.WN(0).aO,t.GN.WN(0).ON,t.AO)),t.GN.MN()>1&&(n=(e=t.BO()).kO,o=e.eb,r=e.lO),{kO:n=n/M*180,eb:o,lO:r}},e.prototype.BO=function(){var e,t,n,o,r,i,a,s,l,u,c=this,f=c.xO(),h=f.yO,p=f.zO,d=c.YN(),g=d?c.AO._Center:new te(0,0),m=0,y=1,v=0,b=0,C=0,w=0,x=0,A=c.GN.MN();for(e=0;e<A;e++)n=(t=c.GN.WN(e)).aO,o=t.ON,r=nt(n,h),i=nt(o,p),a=d?new te(o.X-g.X,o.Y-g.Y):new te(o.X-p.X,o.Y-p.Y),s=d?new te(n.X-g.X,n.Y-g.Y):new te(n.X-h.X,n.Y-h.Y),l=nt(o,g),u=nt(n,g),i>=c.HN&&r>=c.HN&&(C++,w+=r,x+=i,(!d||l>=c.HN)&&u>=c.HN&&(m+=tt(a,s),b++));return b>0&&c.ZN(16)?m/=b:m=0,C>0&&c.ZN(32)?(c.KN||(y=w/x),v=(w-x)/C,c.CO=w/C):c.CO=0,{kO:m,eb:y,lO:v}},e.prototype.ZN=function(e){return 0!=(this.FN&e)},e.prototype.xO=function(){var e,t,n,o,r,i=0,a=0,s=0,l=0,u=this.GN,c=u.MN();for(e=0;e<c;e++)n=(t=u.WN(e)).ON,o=t.aO,i+=n.X,a+=n.Y,s+=o.X,l+=o.Y;return r=new te(i/c,a/c),{yO:new te(s/c,l/c),zO:r}},e.prototype.YN=function(){var e=this.AO;return e&&!V(e._Radius)},e.prototype.VN=function(e){var t=this,n=new de(t.NN,t.FN,y,e);return n.DO=511,t.EO(n),t.FO=n.DO,0===n.DO?(t.JN(!1),!1):(t.FN=n.DO,t.AO=n.GO,t._process=1,!0)},e.prototype.JN=function(e){var t,n=this,o=3===n._process;n._process=0,n.HO&&(Ue(n.HO),n.HO=y),e&&(t=new ce(n.NN,n.tO(),o,rt(n.oO),new oe(n.IN)),3===n._process?n.cO=t:n.dO(t)),n.IN.IO(),n.GN.IO(),n.AO=y,n.AN=0,n.BN=0,n.CN=1,n.DN=0,n.EN=0,n.SN=!1,n.TN=!1,n.FN=0},e.prototype.fO=function(){var e,t,n=this,o={},r=new oe(n.IN);return o.JO=n.ZN(64)?r.KO().X:0,o.LO=n.ZN(64)?r.KO().Y:0,o.MO=n.ZN(256)?r.pO():0,o.NO=n.ZN(128)?r.OO():0,0===o.JO&&0===o.LO&&0===o.MO&&0===o.NO?void n.JN(!0):(o.PO=new ae(o.JO,o.LO),o.QO=new re(o.MO),o.RO=new ie(o.NO),r=new oe(y,o.JO,o.LO,o.NO,o.MO),e=new he(n.NN,n.tO(),new se,r,o.QO,o.RO,o.PO),n.SO(e),o.PO=e.TO,o.QO=e.QO,o.RO=e.RO,o.PO.UO<=0&&o.PO.VO<=0&&o.PO.WO(.003),o.QO.XO()<=0&&o.QO.WO(.002),o.RO.XO()<=0&&o.RO.WO(.003),t=Ze(),o.YO=t,o.ZO=t,o.$O=0,o._O=0,n._process=3,void(n.HO=U.setInterval((function(){try{n.aP(o)}catch(e){}}),20)))},e.prototype.aP=function(e){var t,n,o,r,i,a,s,l,u,c,f,h,p,d=this,g=Ze(),m=g-e.ZO;if(0!==m){if(t=e.JO,n=e.LO,o=e.MO,r=e.NO,e.JO=d.bP(m,e.PO.UO,e.JO),e.LO=d.bP(m,e.PO.VO,e.LO),e.MO=d.bP(m,e.QO.XO(),e.MO),e.NO=d.bP(m,e.RO.XO(),e.NO),t=(t+e.JO)/2,n=(n+e.LO)/2,o=(o+e.MO)/2,r=(r+e.NO)/2,e.ZO=g,i=!1,ot(t)&&ot(n)&&ot(o)&&ot(r)&&(i=!0),a=m*t,s=m*n,l=m*o,u=m*r,c=1,d.CO>0&&(d.CO+2*l<0&&(l=-d.CO/2+1),0!==d.CO&&(c=(d.CO+2*l)/d.CO)),d.EN+=l,d.DN+=u,d.AN+=a,d.BN+=s,d.CN*=c,d.CO+=l,d.oO=new te(d.oO.X+a,d.oO.Y+s),e.$O+=a,e._O+=s,i){if(a=S(e.$O),s=S(e._O),ot(a)&&ot(s))return void d.JN(!0)}else b(e.$O)>=1&&(a=e.$O,e.$O-=a),b(e._O)>=1&&(s=e._O,e._O-=s);return(f=new se).sO=new te(a,s),f.rO=c,f.pO=l,f.qO=u,h=new oe(y,e.JO,e.LO,e.NO,e.MO),p=new fe(d.NN,d.tO(),f,!0,rt(d.oO),h),d.uO(p),p.vO?void d.JN(!0):void(i&&d.JN(!0))}},e.prototype.bP=function(e,t,n){return ot(n)?0:(((o=n<0?n+t*e:n-t*e)<0&&n>0||o>0&&n<0)&&(o=0),o);var o},e.prototype.tO=function(){var e=this,t=new se;return t.pO=e.EN,t.qO=e.DN,t.rO=e.CN,t.sO=new te(e.AN,e.BN),t},e.prototype.cP=function(e,t,n,o){var r,i=this,a=new se,s=new se,l=0,u=0,c=0,f=0,h=i.ZN(4)&&i.SN,p=i.ZN(8)&&i.TN;return!i.ZN(1)||p||e&&!i.ZN(64)||(a.sO.X=t.sO.X,s.sO.X=n.sO.X,l=o.KO().X),!i.ZN(2)||h||e&&!i.ZN(64)||(a.sO.Y=t.sO.Y,s.sO.Y=n.sO.Y,u=o.KO().Y),!i.ZN(32)||e&&!i.ZN(256)?(a.rO=t.rO,s.rO=1):(a.rO=t.rO,a.pO=t.pO,s.rO=n.rO,s.pO=n.pO,f=o.pO()),!i.ZN(16)||e&&!i.ZN(128)||(a.qO=t.qO,s.qO=n.qO,c=o.OO()),r=new oe(y,l,u,c,f),new ue(a,s,r)},e.prototype.EO=function(e){this.vM&&e&&this.vM(e)},e.prototype.wO=function(e){this.wM&&e&&this.wM(e)},e.prototype.dO=function(e){var t,n=this;n.xM&&e&&(t=n.cP(!1,e.dP,e.dP,e.eP),e.dP=t.dP,e.eP=t.eP,n.xM(e))},e.prototype.SO=function(e){var t,n=this;n.AM&&e&&(t=n.cP(!1,e.dP,e.fP,e.eP),e.dP=t.dP,e.fP=t.fP,e.eP=t.eP,n.AM(e))},e.prototype.uO=function(e){var t,n=this;n.BM&&e&&(t=n.cP(e.gP,e.dP,e.fP,e.eP),e.dP=t.dP,e.fP=t.fP,e.eP=t.eP,n.BM(e))},e}(),ee=function(){function e(){}return e.prototype.qN=function(e){var t,n=this;n._pointerCount++,n._pointerCount>1||(t=Ze(),n.hP&&qe(e,n.hP)&&t-n.iP<400?n.Jb++:(n.hP=e,n.Jb=1),n.jP=e,n.iP=t)},e.prototype.wN=function(){var e=this;e.cO&&(e.cO instanceof ge?e.kP(e.cO):e.cO instanceof me&&e.lP(e.cO),e.cO=y)},e.prototype.vN=function(e){var t,n=this;n._pointerCount--,n._pointerCount>0||(t=Ze(),qe(e,n.jP)?t-n.iP>1e3?n.cO=new me(n.jP):n.Jb>1?(n.Jb=0,n.mP(new ye(n.hP)),n.hP=y):n.cO=new ge(n.jP):n.hP=y)},e.prototype.nP=function(){this.hP=y},e.prototype.kP=function(e){this.CM&&e&&this.CM(e)},e.prototype.mP=function(e){this.DM&&e&&this.DM(e)},e.prototype.lP=function(e){this.EM&&e&&this.EM(e)},e}(),te=function(e,t){this.X=e,this.Y=t},t.oP=te,ne=function(){function e(){var e=this;e.Jb=0,e.oI=0,e.pP=10,e.qP=[]}return e.prototype.rP=function(e){var t,n,o,r,i,a,s=this;if(0===s.Jb)return 0;for(t=0,n=(1+s.Jb)*s.Jb/2,o=s.Jb-1;o>=0;o--)r=0,i=s.sP(o),0===e?r=i.hO:1===e?r=i.iO:2===e?r=i.lO:3===e&&(r=i.kO),a=s.tP(r,i.mO),t+=a*=o+1;return t/n},e.prototype.tP=function(e,t){return e/t},e.prototype.sP=function(e){return this.qP[this.uP(e)]},e.prototype.vP=function(){return this.qP[this.Jb-1]},e.prototype.nO=function(e){var t,n,o=this;for(10===o.Jb&&o.wP(),o.Jb++,o.qP[o.uP(o.Jb-1)]=e,t=20*o.pP,n=0;n<o.Jb;n++)e.mO-o.qP[n].mO>t&&(o.wP(),n--)},e.prototype.wP=function(){var e=this;e.oI++,e.oI===e.pP&&(e.oI=0),e.Jb--},e.prototype.IO=function(){this.Jb=0},e.prototype.uP=function(e){return(this.oI+e)%this.pP},e}(),oe=function(){function e(e,t,n,o,r){var i=this;e?i.qP=e:(i.xP=new te(t,n),i.yP=o,i.lO=r)}return e.prototype.KO=function(){var e=this;return e.xP||(e.xP=new te(e.qP.rP(0),e.qP.rP(1))),e.xP},e.prototype.OO=function(){var e=this;return a(e.yP)&&(e.yP=e.qP.rP(3)),e.yP},e.prototype.pO=function(){var e=this;return a(e.lO)&&(e.lO=e.qP.rP(2)),e.lO},e}(),re=function(){function e(e){this.zP=e,this.AP=0}return e.prototype.XO=function(){var e=this,t=e._DesiredExpansion,n=e._DesiredDeceleration,o=e.zP;return V(t)||0===t?V(n)?e.AP:n:.5*o*o/t},e.prototype.WO=function(e){this.AP=e},e}(),ie=function(){function e(e){this.zP=e,this.AP=0}return e.prototype.XO=function(){var e=this,t=e._DesiredRotation,n=e._DesiredDeceleration,o=e.zP;return V(t)||0===t?V(n)?e.AP:n:.5*o*o/t},e.prototype.WO=function(e){this.AP=e},e}(),ae=function(){function e(e,t){var n=this;n.BP=e,n.CP=t,n.UO=0,n.VO=0,n.AP=0,n.DP=T(e*e+t*t)}return e.prototype.EP=function(){var e=this,t=e._DesiredDisplacement,n=e.DP,o=e.BP,r=e.CP,i=e.XO();V(t)||0===t?V(i)||0===i?(e.UO=0,e.VO=0):(e.UO=i*b(o)/n,e.VO=i*b(r)/n):(e.UO=.5*n*b(o)/t,e.VO=.5*n*b(r)/t)},e.prototype.XO=function(){var e=this,t=e._DesiredDeceleration;return V(t)&&V(e._DesiredDisplacement)?e.AP:t},e.prototype.WO=function(e){this.AP=e,this.EP()},e}(),se=function(){var e=this;e.sO=new te(0,0),e.rO=0,e.qO=0,e.pO=0},le=function(){function e(){this.FP=[]}return e.prototype.XN=function(e){var t,n=this.FP;for(t=0;t<n.length;t++)if(n[t].Np===e)return!0;return!1},e.prototype.QN=function(e){this.FP.push(e)},e.prototype.eO=function(e){var t,n=this.FP;for(t=0;t<n.length;t++)if(n[t].Np===e){n.splice(t,1);break}},e.prototype.MN=function(){return this.FP.length},e.prototype.WN=function(e){return this.FP[e]},e.prototype.$N=function(e){var t,n,o=this.FP;for(t=0;t<o.length;t++)if((n=o[t]).Np===e)return n;return y},e.prototype.IO=function(){var e=this.FP;e.splice(0,e.length)},e}(),ue=function(e,t,n){var o=this;o.dP=e,o.fP=t,o.eP=n},ce=function(e,t,n,o,r){var i=this;i.GP=e,i.dP=t,i.gP=n,i.rN=o,i.eP=r},t.ManipulationCompletedEventArgs=ce,fe=function(e,t,n,o,r,i){var a=this;a.GP=e,a.dP=t,a.fP=n,a.gP=o,a.rN=r,a.eP=i},t.ManipulationDeltaEventArgs=fe,he=function(e,t,n,o,r,i,a){var s=this;s.GP=e,s.dP=t,s.fP=n,s.eP=o,s.QO=r,s.RO=i,s.TO=a},pe=function(e,t,n,o){var r=this;r.GP=e,r.HP=t,r.dP=n,r.rN=o},t.ManipulationStartedEventArgs=pe,de=function(e,t,n,o){var r=this;r.GP=e,r.DO=t,r.GO=n,r.rN=o},t.ManipulationStartingEventArgs=de,ge=function(e){this.rN=e},me=function(e){this.rN=e},ye=function(e){this.rN=e},ve=function(){function e(e){this.kj=e}return e.prototype.IP=function(e,t){var n=this.Xs;return n?e===r.En.Nn(n)&&t===r.En.On(n)||r.En.Pn(n,e,t):(n=c("canvas"),r.En.Kn(n,y,this.kj),r.En.Pn(n,e,t)),n},e.prototype.JP=function(e,t,n,o){var i=this,a=r.En.Nn(e),s=r.En.On(e),l=i.IP(a,s),u=l.getContext("2d"),c=r.En.Ln(l),f=r.En.Mn(l);r.Bn.Cn(u,1,1),u.drawImage(e,0,0,We(l),Ge(l),0,0,We(l),Ge(l)),r.Bn.Cn(u,c,f),i.Xs=l,i.KP=t,i.LP=n,i.MP=o},e.prototype.NP=function(e,t,n){var o,i,a,s,l,u,c,f,h,p,d=this,g=d.kj,m=r.En.Nn(e),v=r.En.On(e),b=Ye(g),C=Ke(g),w=b>0?1:0,x=C>0?1:0,A=d.LP,M=ht(g),S=d.KP,T=g.am(),N=t/d.MP,I=e.getContext("2d"),R=r.En.Ln(e),k=r.En.Mn(e),E=d.Xs;I.save(),I.fillStyle=n,I.fillRect(0,0,m,v),h=g.rowOutlines,p=g.columnOutlines,h&&h.jp(g,I,y,!0),p&&p.jp(g,I,y,!1),o=A.x+We(A),i=A.y+Ge(A),a=S.lt-o-w,s=S.ot-i-x,l=M.x+We(M),u=M.y+Ge(M),c=a*N,f=s*N,o*=R,i*=k,a*=R,s*=k,l*=R,u*=k,c*=R,f*=k,r.Bn.Cn(I,1,1),I.drawImage(E,o,i,a,s,l,u,c,f),b>0&&(o=S.lt-w,i=A.y+Ge(A),a=S.js+w,s=S.ot-i-x,l=T.lt-w,u=M.y+Ge(M),c=T.js+w,f=s*N,o*=R,i*=k,a*=R,s*=k,l*=R,u*=k,c*=R,f*=k,I.drawImage(E,o,i,a,s,l,u,c,f)),C>0&&(o=A.x+We(A),i=S.ot-x,a=S.lt-o-w,s=S.gs+x,l=M.x+We(M),u=T.ot-x,c=a*N,f=T.gs+x,o*=R,i*=k,a*=R,s*=k,l*=R,u*=k,c*=R,f*=k,I.drawImage(E,o,i,a,s,l,u,c,f)),b>0&&C>0&&(o=S.lt-w,i=S.ot-x,a=S.js+w,s=S.gs+x,l=T.lt-w,u=T.ot-x,c=T.js+w,f=T.gs+x,o*=R,i*=k,a*=R,s*=k,l*=R,u*=k,c*=R,f*=k,I.drawImage(E,o,i,a,s,l,u,c,f)),r.Bn.Cn(I,R,k),I.restore()},e.prototype.OP=function(){var e=this.kj,t=e.zoom(),n=e._render.vI();n&&this.JP(n.canvas,e.am(),ht(e),t)},e.prototype.PP=function(e){var t,n,o,i,a,s,l=this,u=l.kj;if(u.endEdit()&&(t=it(e,l.MP),n=u.zoom(),o=u.name(),n!==t)){if(i={sheet:u,sheetName:o,oldZoomFactor:n,newZoomFactor:t,cancel:!1},u.Wq(r.Events.ViewZooming,i),i&&!0===i.cancel)return;t=i.newZoomFactor,u.XSa(t),u.Wq(r.Events.UserZooming,{sheet:u,sheetName:o,oldZoomFactor:n,newZoomFactor:t}),u.Wq(r.Events.ViewZoomed,{sheet:u,sheetName:o,oldZoomFactor:n,newZoomFactor:t}),u.invalidateLayout(),(s=(a=u._render).bm())&&l.NP(s.canvas,t,a.zI(!1)),u.QP&&u.QP(y,t),u.RP&&u.RP(y)}},e.prototype.SP=function(e){var t,n=this.kj,o=n.name(),i=it(e,this.MP),a=n.zoom();if(i!==a){if(t={sheet:n,sheetName:o,oldZoomFactor:a,newZoomFactor:i,cancel:!1},n.Wq(r.Events.ViewZooming,t),t&&!0===t.cancel)return;i=t.newZoomFactor,n.XSa(i),n.Wq(r.Events.UserZooming,{sheet:n,sheetName:o,oldZoomFactor:a,newZoomFactor:i}),n.Wq(r.Events.ViewZoomed,{sheet:n,sheetName:o,oldZoomFactor:a,newZoomFactor:i})}n.oq=!0,n.jq=!0,n.$p()},e}(),t.TP=ve,be=200,Ce=function(){function e(e){this.kj=e}return e.prototype.VP=function(e){this.kj.eCb=e},e.prototype.WP=function(e){this.kj.cCb=e},e.prototype.XP=function(){this.kj.invalidateLayout()},e.prototype.ju=function(e,t,n,o){var r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,w,x=this,A=x.kj,M=A.options,S=function(e,t,n){var o,r,i=n,a=0,s=0,l=e.ss,u=e.am().qt,c=e.jt(1).findRow(i);if(c)if(t>0){for(o=e.Rt(-1),a=u-c.y;i>o&&a<t;)i--,a+=l.Sl(i);s=t-a}else if(t<0){for(r=e.ns(),a=-(c.y+Ge(c)-u);i<r&&a>t;)i++,a-=l.Sl(i);s=t-a}return{cj:i,UP:s}}(A,e,A.lq),T=S.cj,N=S.UP;if(A.lq=T,A.Xq>0)return!1;if(r=A.Dr(),a=(i=A.am()).qt,s=i.jr,l=r?r.x:i.x,u=We(i),u+=(p=M.sheetAreaOffset).left,e<0)x.YP=0,x.ZP=0,d=void 0,g=void 0,(m=A.jt(1))&&m.length>0&&(d=m.findRow(T)),d&&((g=m[m.length-1]).row>=T&&(c=2+p.top,f=a+b(e),(h=C(a+s,g.y+Ge(g))-f)>=0&&(h-=c,x.WP(N-Ge(d)),n.x=l,n.y=f,n.width=u,n.height=h,n.tx=l,n.ty=a,o.x=l,o.y=a+h,o.width=u,o.height=s-h)));else if(e>0){if(y=A.Rt(-1),v=void 0,w=void 0,A.parent&&A.parent.options.scrollByPixel&&N>0&&(e-=N,N=0),T===y&&N>0)if(x.YP>0&&x.ZP>0){if(N=w=at(v=x.YP+e,be),(e=w-x.ZP)<=0)return t;if(t&&w>=20)return!0;x.YP=v,x.ZP=w}else{if(N>=be&&(e-=N-199,N=199,e<=0))return t;if(v=st(N,be),w=N,t&&w>=20)return!0;x.YP=v,x.ZP=w}else x.YP=0,x.ZP=0;e<s&&(c=2+p.top,f=a,h=s-e,Ke(A)>0&&(h-=1),x.WP(N),n.x=l,n.y=f,n.width=u,n.height=h,n.tx=l,n.ty=f+e,o.x=l,o.y=f,o.width=u,o.height=e+c)}return!1},e.prototype.lu=function(e,t,n,o){var r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,w,x=this,A=x.kj,M=function(e,t,n){var o,r,i=n,a=0,s=0,l=e.ss,u=e.am().pt,c=e.it(1).findCol(i);if(c)if(t>0){for(o=e.Ot(-1),a=u-c.x;i>o&&a<t;)i--,a+=l._m(i);s=t-a}else if(t<0){for(r=e.ps(),a=-(c.x+We(c)-u);i<r&&a>t;)i++,a-=l._m(i);s=t-a}return{dj:i,UP:s}}(A,e,A.qq),S=M.dj,T=M.UP;if(A.qq=S,A.Xq>0)return!1;if(r=A.Dr(),a=(i=A.am()).pt,s=i.er,l=r?r.y:i.y,u=Ge(i),u+=(g=A.options.sheetAreaOffset).top,e<0)x.$P=0,x._P=0,m=void 0,y=void 0,(v=A.it(1))&&v.length>0&&(m=v.findCol(S)),m&&((y=v[v.length-1]).col>=S&&(c=2+g.left,f=a+b(e),(h=C(a+s,y.x+We(y))-f)>=0&&(h-=c,x.VP(T-We(m)),n.x=f,n.y=l,n.width=h,n.height=u,n.tx=a,n.ty=l,o.x=a+h,o.y=l,o.width=s-h,o.height=u)));else if(e>0){if(w=A.Ot(-1),A.parent&&A.parent.options.scrollByPixel&&T>0&&(e-=T,T=0),S===w&&T>0)if(x.$P>0&&x._P>0){if(T=d=at(p=x.$P+e,be),(e=d-x._P)<=0)return t;if(t&&d>=20)return!0;x.$P=p,x._P=d}else{if(T>=be&&(e-=T-199,T=199,e<=0))return t;if(p=st(T,be),d=T,t&&d>=20)return!0;x.$P=p,x._P=d}else x.$P=0,x._P=0;e<s&&(c=2+g.left,f=a,h=s-e,Ye(A)>0&&(h-=1),x.VP(T),n.x=f,n.y=l,n.width=h,n.height=u,n.tx=f+e,n.ty=l,o.x=f,o.y=l,o.width=e+c,o.height=u)}return!1},e.prototype.aQ=function(e,t,n,o){var i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,x,A,M,S,T=this,N=T.kj,I=!0,R=!0,k=N._render,E=k.bm(),D=0!=(2&n),j=0!=(1&n);if(j||D)return u=N.Dr(),c=N.am(),f=u?u.y:c.y,h=Ge(c),p=u?u.x:c.x,d=We(c),D&&(a={},i={},I=T.ju(t,o,i,a),k.Ow(i.x,i.y,We(i),Ge(i),i.tx,i.ty)),j&&(s={},l={},R=T.lu(e,o,s,l),k.Ow(s.x,s.y,We(s),Ge(s),s.tx,s.ty),D||(a=l)),(g=N.parent)&&!g.options.scrollbarShowMax&&(j&&(N.oq=!0),D&&(N.jq=!0)),T.XP(),m=N.rowOutlines&&!N.rowOutlines.iT()?1:0,y=N.columnOutlines&&!N.columnOutlines.iT()?1:0,j&&D?k._l(E,new r.Rect(a.x,a.y,We(a),Ge(a)+m),new r.Rect(l.x,l.y,We(l)+y,Ge(l))):k._l(E,new r.Rect(a.x,a.y,We(a)+y,Ge(a)+m)),v=new r.Rect(p,f,d,h),(b=N.getSelections())&&b.length>0&&(x=N.getRangeRect(1,1,b[0]),A=w(v.x+v.width,x.x+x.width),M=w(v.y+v.height,x.y+x.height),v.x=C(v.x,x.x),v.y=C(v.y,x.y),v.width=A-v.x+1,v.height=M-v.y+1),k.Pw(E,v),function(e,t){var n,o,i,a,s,l=e.am(),u=e._render,c=e.options.gridline.color,f=r.Im.Km(0,"gc-columnHeader-normal"),h=f&&f.borderBottomColor,p=u.bm(),d=e.jt(1),g=ht(e),m=l.zr,y=We(l),v=e.Rt(-1),b=d.findRow(v);b&&(n=l.qt,(o=b.y-n)>0&&(ft(p,c,m,b.y-.5,m+y-g.width,b.y-.5),t&&(0===g.width&&ft(p,c,l.zr-.5,n,l.zr-.5,b.y),ft(p,h,l.kt-.5,n,l.kt-.5,b.y)))),i=e.it(1),n=l.Ar,o=Ge(l),a=e.Ot(-1),(s=i.findCol(a))&&(m=l.pt,(y=s.x-m)>0&&(ft(p,c,s.x-.5,n,s.x-.5,n+o-g.height),t&&(0===g.height&&ft(p,c,m,l.Ar-.5,s.x,l.Ar-.5),ft(p,h,m,l.nt-.5,s.x,l.nt-.5))))}(N,!0),function(e,t){var n,o,r,i,a,s,l,u,c,f,h,p,d,g=e.am(),m=e._render,y=e.options.sheetAreaOffset,v=y.left,b=y.top,C=m.zI(!1),w=m.bm(),x=m.vI(),A=e.jt(1),M=ht(e),S=g.zr,T=v>=1?1:0,N=b>=1?1:0,I=We(g),R=e.Rt(-1),k=A.findRow(R);k&&(n=g.qt,(o=k.y-n-1-N)>0&&(t?(r=g.Br,lt(w,i=ct(),S,n,r-1,o+1),lt(x,i,S,n,r-1,o+1),lt(w,C,S+r,n,I-r-M.width,o),lt(x,C,S+r,n,I-r-M.width,o)):(lt(w,C,S,n,I,o),lt(x,C,S,n,I,o)))),a=e.Rt(Xe(e),!0),(s=A.findRow(a))&&(n=s.y+Ge(s),(o=g.ot-n-1-N)>0&&(lt(w,C,S,n,I,o),lt(x,C,S,n,I,o))),l=e.it(1),n=g.Ar,o=Ge(g),u=e.Ot(-1),(c=l.findCol(u))&&(S=g.pt,(I=c.x-S-1-T)>0&&(t?(lt(w,h=ut(w,S,n,I+1,(f=g.Cr)-1),S,n,I+1,f-1),lt(x,h,S,n,I+1,f-1),lt(w,C,S,n+f,I,o-f-M.height),lt(x,C,S,n+f,I,o-f-M.height)):(lt(w,C,S,n,I,o),lt(x,C,S,n,I,o)))),p=e.Ot($e(e),!0),(d=l.findCol(p))&&(S=d.x+We(d),(I=g.lt-S-1-T)>0&&(lt(w,C,S,n,I,o),lt(x,C,S,n,I,o)))}(N,!0),T.bQ(j,D),pt(N,!0),S=N.options.sheetAreaOffset,N.options.rowHeaderVisible||k.B0a(E,new r.Rect(p,f,2,h+S.top)),N.options.colHeaderVisible||k.B0a(E,new r.Rect(p,f,d+S.left,2)),I&&R},e.prototype.bQ=function(e,t){var n,o=this.kj;t&&o.os(),e&&o.qs(),o._eventHandler._updateEditingEditor(),(n=o._modelManager.Ky)&&n.cQ()},e.prototype.dQ=function(e,t,n){function o(e,t,n,o){return x(.75,e/=n)*o*(t?1:-1)}function r(e,t,n){return e=b(e),I(e/=n)/I(.75)*t}var i=this,a=i.kj,s=be,l=100,u=r(e,10,s),c=r(t,10,s),f=e,h=t,p=0,d=0,g=!1,m=!1;i.jI=U.setInterval((function(){var r,v,b,C,w;return g&&m?(a.ss.jn(),(r=a.parent)&&!r.options.scrollbarShowMax&&(a.oq=!0,a.jq=!0),a.ss.kn(),a.cCb=0,a.eCb=0,a.$p(),a.qs(),a.os(),Ue(i.jI),void(i.jI=y)):(c+=20,void((u+=20)>l&&c>l?(i.aQ(e-p,t-d,dt(g,m),n),g=!0,m=!0):(u>l&&!g&&(i.aQ(e-p,0,1,n),g=!0),c>l&&!m&&(i.aQ(0,t-d,2,n),m=!0),v=o(u,e>0,10,s),b=o(c,t>0,10,s),C=R(f-v),w=R(h-b),i.aQ(C,w,dt(g,m),n),f=v,h=b,p+=C,d+=w)))}),20)},e.prototype.qG=function(e){var t=this,n=t.kj,o=n.ss;t.jI&&(o.kn(),Ue(t.jI),t.jI=y),t.$P=0,t._P=0,t.YP=0,t.ZP=0,t.eQ=n.lq,t.fQ=n.qq,e&&o.hn()},e.prototype.NG=function(e,t){var n=this.kj.parent,o=n.options.scrollbarAppearance===r.ScrollbarAppearance.mobile,i=n.St,a=n.Pt,s=n.ku,l=G(e.X+""),u=G(e.Y+""),c=function(e,t){var n=0;return(n|=0!==e?1:0)|(0!==t?2:0)}(l,u);return o&&(0!==u&&(i.Jwa(r.ScrollbarState.show),s.Rdc(!0)),0!==l&&(a.Jwa(r.ScrollbarState.show),s.Rdc(!1))),this.aQ(l,u,c,t)},e.prototype.gQ=function(e){var t,n,o,r,i,a,s,l,u,c,f,h,p,d,g,m=this,y=m.kj;return y.parent&&y.parent.options.scrollByPixel?(y.ss.kn(),void y.$p()):(n=(t=y.am()).pt,o=t.qt,r=y.lq,i=y.qq,a=y.it(1),l=y.ps(),u=1,a&&a.length>0&&(s=a.findCol(i),i<l&&s&&s.x+We(s)-n<We(s)/2?i++:u=-1),c=y.jt(1),h=y.ns(),p=1,c&&c.length>0&&(f=c.findRow(r),r<h&&f&&f.y+Ge(f)-o<Ge(f)/2?r++:p=-1),d=0,g=0,a&&a.length>0&&(d=n-(s=a.findCol(i)).x),c&&c.length>0&&(g=o-(f=c.findRow(r)).y),r!==m.eQ&&y.mq(r,0,!0),i!==m.fQ&&y.rq(i,0,!0),d*=u,g*=p,void m.dQ(d,g,e))},e}(),we=function(){function e(e){var t=this;t.KN=!1,t.hQ=new ve(e),t.iQ=new Ce(e),t.kj=e}return e.prototype.jQ=function(e){var t=this.kj,n=t.am(),o=n.pt,r=n.qt,i=n.lt,a=n.ot,s=e.rN,l=0,u=this.kQ(s.X,s.Y),c=u.dragInfo,f=u.x,h=u.y;u&&(u.resizeInfo||c&&"corner"===c.side||u.selectionHitInfo)?(l|=2,l|=1):(r<=h&&h<a&&(l|=2),o<=f&&f<i&&(l|=1),l|=96,t.parent&&(l|=12)),e.DO=l},e.prototype.lQ=function(t){var n,o,r,i,a,s,l,u,c,f,h,p,d=this,g={e:t,r:y};if(e.ao(d,"preProcessManipulationStarted",g),!g.r)if(n=t.rN,r=(o=d.kj).parent,i=o._eventHandler,a=o._render,l=(s=d.kQ(n.X,n.Y)).dragInfo,u=s.selectionHitInfo,o.yt=s,s.resizeInfo){if(!o.endEdit())return;i.fG(s)}else if(l&&"corner"===l.side)i.hG&&i.hG(s);else if(u){if(!o.endEdit())return;c=u.isHeader,f=u.isFirstIndicator,h=u.type,c&&i.ZG(s,!0),p=s.hitTestType,s.hitTestType=h,i.bH(s),s.hitTestType=p,function(e,t,n,o){var r,i,a,s;t||(i=(r=Qe(e))[r.length-1],a=e.Jl,s=e.Kl,n?3===o?(e.Jl=i.row+i.rowCount-1,e.Kl=i.col+i.colCount-1):2===o?(e.Jl=i.row+i.rowCount-1,e.Kl=0):1===o&&(e.Jl=0,e.Kl=i.col+i.colCount-1):3===o?(e.Jl=i.row,e.Kl=i.col):2===o?(e.Jl=i.row,e.Kl=0):1===o&&(e.Jl=0,e.Kl=i.col),yt(e,a,s,e.Jl,e.Kl))}(o,c,f,h),o.mQ=!1,a.DH()}else o.nQ&&(o.nQ().oQ=!1),o.mQ=!1,a.DH(),t.HP>1&&r&&r.options.allowUserZoom?(d.KN=!1,d.hQ.OP()):(d.KN=!0,d.iQ.qG(1===t.HP))},e.prototype.pQ=function(t){var n,o,r,i,a,s,l,u,c,f,h=this,p={e:t,r:y};if(e.ao(h,"preProcessManipulationDelta",p),!p.r&&(n=t.rN,r=(o=h.kj)._eventHandler,i=o.yt,a=n.X,s=n.Y,i))if(l=i.dragInfo,u=i.selectionHitInfo,i.resizeInfo)r.$F={e:t,x:a,y:s},r.WG();else if(l&&"corner"===l.side)r.$F={e:t,x:a,y:s},r.CG&&r.CG();else if(u||r.xG){if(u){if(!r.rG||!r._isWorking)return;if(!0===r.DA)return;c=u.type,r.$F={e:t,x:a,y:s},3===c?r.cH():2===c?r.dH():1===c&&r.eH()}}else h.KN?t.vO=h.iQ.NG(t.fP.sO,t.gP):(f=t.dP.rO,h.hQ.PP(f))},e.prototype.qQ=function(t){var n,o,r,i,a,s=this,l={e:t,r:y};e.ao(s,"preProcessManipulationCompleted",l),l.r||(o=(n=s.kj)._eventHandler,n.mQ=!0,i=(r=n.yt).selectionHitInfo,r.resizeInfo?o.YG():r.dragInfo&&o.BG?(o.xH&&o.xH(),n.parent.touchToolStrip.rQ()):i||o.xG?(o.hH(),i&&function(e,t,n,o){var r,i,a,s;t||(i=(r=Qe(e))[r.length-1],a=e.Jl,s=e.Kl,n&&(3===o?(e.Jl=i.row,e.Kl=i.col):2===o?(e.Jl=i.row,e.Kl=0):1===o&&(e.Jl=0,e.Kl=i.col)),yt(e,a,s,e.Jl,e.Kl))}(n,i.isHeader,i.isFirstIndicator,i.type),n._render.im()):(n.nQ&&(n.nQ().oQ=!0),s.KN?s.iQ.gQ(t.gP):(a=t.dP.rO,s.hQ.SP(a))))},e.prototype.sQ=function(t){var n,o,i,s,l,u,c,f,h,p,d,m,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H=this,B={e:t,r:y};if(e.ao(H,"preProcessTapped",B),B.r)H.kj.repaint();else if(n=t.rN,o=H.kj,i=o.parent,s=!1,o.Uja=v,H.tQ(),o.uQ&&o.uQ(),(l=o._modelManager.Ky)&&l.vQ(),u=o._eventHandler,f=(c=H.kQ(n.X,n.Y,!0)).filterButtonHitInfo,h=c.hitTestType,p=c.row,d=c.col,m=c.outlineHitInfo)o.isEditing()||(b=m.what,C=o.rowOutlines,w=o.columnOutlines,"rg"===b||"rgh"===b?C&&C.UL(o,m):"cg"!==b&&"cgh"!==b||w&&w.UL(o,m));else if(o.yt=c,f){if(!o.endEdit())return;(x=f.rowFilter)&&x.openFilterDialog(f)}else if(c.resizeInfo);else if(o.Qs(c.rowViewportIndex<0?-1:p,c.colViewportIndex<0?-1:d)){if(o.wQ&&!u.BG&&i.touchToolStrip.rQ(),A=o.getActiveRowIndex(),M=o.getActiveColumnIndex(),S=c.cellTypeHitInfo){if(T=o.getCellType(S.row,S.col,h),S.sheet||(S.sheet=o),H.Sia(T,S))if(N=S.sheetArea,!a(N)&&3!==N||p===A&&d===M)o._render.DH();else{if(o.suspendPaint(),!o.endEdit())return;if(I={sheet:o,sheetName:o.name(),row:A,col:M,cancel:!1},o.Wq(r.Events.LeaveCell,I),I&&!0===I.cancel)return;R=o._modelManager.getSelections(),k=o._modelManager.getSpan(p,d),E=[r.kf(k.row,k.col,k.rowCount,k.colCount)],o.yu(R,E),o.Wq(r.Events.FloatingElementSelected,{type:"worksheet"}),D=S.isReservedLocation&&S.isFocusAware,o.Sr(p,d,v,v,D?0:1),j={sheet:o,sheetName:o.name(),row:p,col:d},o.Wq(r.Events.EnterCell,j),o.Wq(r.Events.FormulatextboxEnterCell,j),o.Au(R),o.Uja=!0,u.cs&&u.cs(p,d),o.resumePaint(),s=!0}T.processCellAndPaddingMouseDown(S),T.XGb(S)}if(S&&S.isReservedLocation)return!0;S&&S.cellButtonHitInfo&&(s=!0),o.Wq(r.Events.CellClick,{sheet:o,sheetName:o.name(),sheetArea:h,row:c.row,col:c.col});try{if(u.mG=c,_=o.isEditing(),O=o.endEdit(),o.CH&&g&&_&&O&&(u.shift=!1),_&&A===o.getActiveRowIndex()&&M===o.getActiveColumnIndex()&&!O)return}finally{u.mG=y}if(a(p)||a(d))return;3===h&&u.cs&&u.cs(p,d),function(e,t,n,o){var r,i,s,l,u,c,f,h,p=!1,d=e._modelManager.getSelections();for(r=0,i=d.length;r<i;r++){if(s=d[r],(l=3===o||a(o))&&(s=e.Tq(s)),u=s.row,c=s.col,f=s.rowCount,h=s.colCount,l)p=u<=t&&t<u+f&&c<=n&&n<c+h;else if(2===o)p=-1===c&&u<=t&&t<u+f;else if(1===o)p=-1===u&&c<=n&&n<c+h;else if(0===o)return p;if(p)break}return p}(o,p,d,h)&&!s?H.xQ=U.setTimeout((function(){var e={x:c.x,y:c.y,handled:!1},t=i.touchToolStrip;o.Wq(r.Events.TouchToolStripOpening,e),e.handled||t.open(c.x,c.y-100),H.tQ()}),420):(o.Wq(r.Events.FloatingElementSelected,{type:"worksheet"}),F=o._modelManager.getSelections(),u.ZG(c),P=o._modelManager.getSelections(),o.yu(F,P),u.hH())}},e.prototype.Sia=function(e,t){return!(e&&e.activedOnClick&&!e.activedOnClick()&&t.isReservedLocation)},e.prototype.yQ=function(t){var n,o,i,a,s,l,u,c,f,h,p,d,g,m,v,b,C=this,w={e:t,r:y};if(e.ao(C,"preProcessDoubleTapped",w),!w.r)if(n=C.kj,o=t.rN,C.tQ(),(s=n.yt)&&(n.Wq(r.Events.CellDoubleClick,{sheet:n,sheetName:n.name(),sheetArea:s.hitTestType,row:s.row,col:s.col}),l=s.resizeInfo))if(u=n._modelManager.getSelections(),"sizeRow"===l.action||"sizeHiddenRow"===l.action){if(c=[],n.tp(l.index)){for(i=0;i<u.length;i++)if(-1===(a=u[i]).col)for(a=n.Tq(a),f=0;f<a.rowCount;f++)c.push({row:a.row+f})}else c.push({row:l.index});n.wu().execute({cmd:"autoFitRow",sheetName:n.name(),rows:c,columnHeader:1===l.sheetArea})}else{if(h=[],n.sp(l.index)){for(i=0;i<u.length;i++)if(-1===(a=u[i]).row)for(a=n.Tq(a),p=0;p<a.colCount;p++)h.push({col:a.col+p})}else h.push({col:l.index});n.wu().execute({cmd:"autoFitColumn",sheetName:n.name(),columns:h,rowHeader:2===l.sheetArea})}else!((d=C.kQ(o.X,o.Y,!0))&&d.row>=0&&d.col>=0&&d.rowViewportIndex>=0&&d.colViewportIndex>=0)||d.resizeInfo||n.options.isProtected&&n.tq(d.row,d.col,"locked")||((g=n.isCtrlPressed(d.hitTestType))||n.Tr(),m=n.Er(d.row),v=n.Fr(d.col),b=!0,n.Jl===d.row&&n.Kl===d.col||(b=!1),n.Kr(d.row,d.col,m,v,b),g?n.$p():n.addSelection(d.row,d.col,1,1),n._eventHandler.dI(!1,!0),n.EF(n.Ws(),d.row,d.col))},e.prototype.zQ=function(e){var t,n=this,o=n.kj,r=e.rN,i=n.kQ(r.X,r.Y);o.isEditing()?i.row===o.Jl&&i.col===o.Kl||o._eventHandler.cI(i):(n._target=i,(t=n.kQ(r.X,r.Y,!0))&&t.cellTypeHitInfo&&t.cellTypeHitInfo.isEditting||o._eventHandler.cI(t))},e.prototype.AQ=function(e){var t,n,o,r,i=this.kj;i.isEditing()||(n=!0,(t=this._target)&&((o=t.cellTypeHitInfo)&&o.isReservedLocation?n=!1:(r=i.getCellType(t.row,t.col))&&r.isEditting()&&(n=!1)),n&&i._eventHandler.dI(!0))},e.prototype.kQ=function(e,t,n){var o,r,i,a,s,l,u,c,f,h,p,d,g,m,b,C=this.kj;return C.am(),o={x:e,y:t,rowViewportIndex:y,colViewportIndex:y,row:-1,col:-1,resizeInfo:y,hitTestType:y,outlineHitInfo:y,filterButtonHitInfo:y,dragInfo:y,cellTypeHitInfo:y,selectionHitInfo:y},r=C.rowOutlines,i=C.columnOutlines,r&&(a=r.hitTest(C,e,t)),!a&&i&&(a=i.hitTest(C,e,t)),a?o.outlineHitInfo=a:(void 0,void 0,s=C.nr(t),l=C.or(e),o.rowViewportIndex=s,o.colViewportIndex=l,o.row=C.pr(t,s),o.col=C.qr(e,l),s>=0&&s<=2&&l>=0&&((u=C.rr(s,l,v,o.row,o.col))&&(o.row=u.row,o.col=u.col)),o.hitTestType=C.sr(s,l),void 0,f=void 0,h=void 0,p=void 0,d=void 0,c=function(e,t,n,o,r){var i,a,s,l,u,c=e.parent,f=e._eventHandler,h=e.options,p=t.rowViewportIndex,d=t.colViewportIndex,g=Qe(e),m=y;return e.CH&&g.length>0&&(a=(i=g[g.length-1]).row,s=i.row+i.rowCount-1,l=i.col,u=i.col+i.colCount-1,c&&!c.options.allowUserResize||(-1!==a&&-1===l&&p>=0&&d<0&&h.rowHeaderVisible?!(m=f.mH(e,t,r,2,o))||"sizeRow"!==m.action&&"sizeHiddenRow"!==m.action||2!==m.sheetArea||m.index===s||(m=y):-1===a&&-1!==l&&p<0&&d>=0&&h.colHeaderVisible&&(!(m=f.oH(e,t,r,1,n))||"sizeCol"!==m.action&&"sizeHiddenCol"!==m.action||1!==m.sheetArea||m.index===u||(m=y)))),m}(C,o,e,t,10),(p=(h=C.xr)&&h.hitTest(o,e,t))||(p=(b=(m=(g=C.tables)&&g.find(o.row,o.col))&&m.xr)&&b.hitTest(o,e,t)),C.wQ?(f=mt(C,o,e,t),o.dragInfo=f):c?o.resizeInfo=c:p?o.filterButtonHitInfo=p:n?o.cellTypeHitInfo=C.yr(o,e,t):(d=gt(C,o,e,t),o.selectionHitInfo=d)),o},e.prototype.tQ=function(){var e=this.xQ;e&&(clearTimeout(e),this.xQ=y)},e}(),t.TouchEventHandler=we,r.Zn(we),xe=function(){function e(e,t,n){var o=this;o.BQ=n,o.yM=new Oe(t),o.CQ=new we(t),o.DQ=new Fe(e,"sheet",o.yM,100,10),o.BQ.xN(o.DQ,!0)}return e.prototype.EQ=function(){var e=this.CQ,t=this.DQ;t.dN=function(t){return e.jQ(t)},t.eN=function(t){return e.lQ(t)},t.fN=function(t){return e.pQ(t)},t.hN=function(t){return e.qQ(t)},t.iN=function(t){return e.sQ(t)},t.jN=function(t){return e.yQ(t)},t.GM=function(t){return e.zQ(t)},t.IM=function(t){return e.AQ(t)}},e.prototype.FQ=function(){var e=this,t=e.DQ;t&&(e.BQ.xN(t,!1),t.dN=y,t.eN=y,t.fN=y,t.gN=y,t.hN=y,t.iN=y,t.jN=y,t.kN=y,t.GM=y,t.IM=y,e.DQ=y)},e.prototype.GQ=function(e){return this.yM.GQ()},e.prototype.HQ=function(e){return this.yM.HQ()},e.prototype.IQ=function(e){return this.yM.IQ()},e}(),Ae="gc-toolstrip-button",Me="gc-toolstrip-text",Se="gc-toolstrip-image",Te="gc-toolstrip-item",Ne="gc-touch-sperate-line",Ie="height",Re="width",ke="px",Ee="button",De=function(e){function t(t,n){var o,i=e.call(this,n,r.Ul.vl(t._host))||this,a=i;return a.JQ=32,a.KQ=45,a.LQ={},a.MQ=!1,a.OC=t,o=a.yo(),a.NQ=o,o.addClass("gc-toolstrip-default ui-state-default well"),o.appendTo(a.zo()),o.hide(),a.OQ(),a.PQ(),a.QQ(),i}return Ve(t,e),t.prototype.open=function(e,t){var n,o,i,a=this;if(Je(a.OC)&&(r.Vl.Zl(y,!0),a.NQ.css({left:e,top:t}),a.Ao(),a.MQ=!0,a.Do(),!u(a.LQ)))for(o in n=a.LQ)n.hasOwnProperty(o)&&(!(i=n[o]).RQ||i.RQ.call(a)?l("#"+o).show():l("#"+o).hide())},t.prototype.add=function(e){var t,n,o,r;e&&(n=(t=this).LQ,e instanceof _e?(o=e.name())&&(n[o]=e,t.SQ(e.TQ(Ne,t.KQ+ke))):e instanceof je&&(r=e.name(),t.getItem(r)||(n[r]=e,t.SQ(e.TQ(Se,t.JQ+ke,Me,Ae)))))},t.prototype.getItem=function(e){return this.LQ[e]},t.prototype.getItems=function(){var e,t=[],n=this.LQ;if(!u(n)){for(e in n)n.hasOwnProperty(e)&&t.push(n[e]);return t}return y},t.prototype.remove=function(e){var t,n=this;return n.getItem(e)?(l("#"+e).parent().remove(),t=n.LQ[e],delete n.LQ[e],t):y},t.prototype.clear=function(){var e=this;e.NQ&&(e.NQ.find("td."+Te).remove(),e.LQ={})},t.prototype.close=function(){var e,t,n=this;q.Hm(),n.NQ&&n.NQ.hide(),n.MQ=!1,n.Eo(),(e=Je(n.OC))&&(e.zt(),(t=Qe(e)).length>0&&!e.wQ&&-1===t[0].row&&-1===t[0].col&&e.Tr())},t.prototype.imageAreaHeight=function(e){var t=this;return 0===arguments.length?t.JQ:(e>0&&(t.JQ=e,t.NQ.find("span."+Se).css(Ie,e+ke)),t)},t.prototype.itemHeight=function(e){var t=this,n=t.NQ.find("button."+Ae);return 0===arguments.length?W(n.css(Ie)):(e>0&&n.css(Ie,e+ke),t)},t.prototype.itemWidth=function(e){var t,n=this,o=n.NQ.find("button."+Ae);return 0===arguments.length?W(o.css(Re)):(e>0&&(t="min-width",W(o.css(t))>e&&o.css(t,e+ke),o.css(Re,e+ke)),n)},t.prototype.separatorHeight=function(e){var t=this;return 0===arguments.length?t.KQ:(e>0&&(t.KQ=e,t.NQ.find("div."+Ne).css(Ie,e+ke)),t)},t.prototype.OQ=function(){var e="table",t=l(c(e)).css({padding:0,display:e}).attr({cellspacing:0,cellpadding:0});this.UQ=l(c("tr")).appendTo(t),t.appendTo(this.NQ)},t.prototype.no=function(){var e=this,t=e.NQ;t&&(e.MQ&&q.Hm(),t.unbind("click"),t.remove(),e.Eo(),e.NQ=y)},t.prototype.QQ=function(){var e=this;e.NQ.bind("click",(function(t){var n,o,r,i=t.target;i.tagName.toLowerCase()===Ee?n=i.id:(o=i.parentElement)&&o.tagName.toLowerCase()===Ee&&(n=o.id),r=e.LQ[n],n&&r&&r.VQ.call(e)}))},t.prototype.SQ=function(e){this.NQ&&e&&l(c("td")).append(e).appendTo(this.UQ).addClass(Te)},t.prototype.PQ=function(){var e,t,n,o,r,i,a;function s(e){for(var t=0,n=e+t;Z.getElementById(n);)n=e+ ++t;return n}o=(t={0:J+(e="gAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAA")+"A8ElEQVRIS92VwQ3CMAxFe+qZERiHY8dgDI4cYYNOhDhwY4ayQviW4q/Eddu0KRe+9CQ72P8rEpAmhPBT3ENLd76EiPv5HO5hSmK+KYTFsz+04A4G9NZ0hAizn7jTos2MFRYYugFZQlscoFzRZsYKCwwNulAqnZddtJmxwiIZ3oT6WFh4S2tQHwsLb2kN6mNh4S2tQX0sLLwly4IyY4WFZ2gReV/ZhBOQH2ddgKcYwBAc7R/weL0ZgqO6gGPXE1E0JlBdwJx2CUhvkCL63xvw33QKUc0N+B5MIaq5gb5o8kotBszJDShFlkvQ+ZHBvoTmC+fiVfoq/m86"+Q,1:J+e+"BkklEQVRIS7WTUXECQRBEcYCFOIiESAAH/OYPCcQBEogDJCABCUhAwqXf1QzVM0cojko+Xt3ObG/33t7eYhiGf6UU68+vneD5Mu4HpZDgKja+YCYH94NSSHAUg3glZC9k8zgAYwLmhuS6o/tBKUJ8CTGsoveIsin3g1LEAkxzAd/kXbihwxwatGys+EEpEAT5LR6FuDmMb+t+UAoEwVL44h7CvB8lGxrn3A9KkaLAj8pDMD9HL/v0ZgfAQfSAk/WgXAT3g1K4MPCj2AoPhNvRJO4HpejigF1jxtjNy9Ek7gel6GIjfzoP+Ihewf2gFPcWNNL817/c/aAUKXpbfy/FXlzFIM6gOYy3Gp+iz/xBPHeLQGLAMI2PNmYOw1uojZfdCyYNCXexiGcGpiljdp9hsBGjvnvBpCHhRbgBZChjAgj0eXrX7gWThoR992lAMGOOLMfJuIHuBZMGQuE75KN66Cpq14xH2L1g0kixyLNm3I8sNbwJulHfvWDSkJArmou4hlxXeh4AvBEBuZnnbtHfMix+AHqkr6wgQ4Q7"+Q,2:J+e+"A3UlEQVRIS72PwQ3CMAxFOwrjcOyZCTgyAjfWYCJO3JiCCVL/iFSO9W0MDTzpqYob+ztTKeWn0uJIadE6H8/ljXsR96q6tzt4YogH/olPcQ2R8mp3CHRBwO3+6EKkvNodcDkSgyyoAx0iRz/AA/8Op0sdtJuv1Va3Ct8FYHgL8dgUAGxIe41+kRAH6CbdaGW86nFAhnaXLSLEAbqJCbxlUgEZ2DIgFaCbmMBbJhWQgS0DUgG6iQm8ZVIBGTYFsK21oN3F1yrEARnsIM/u8JeAT9S9nrQ4UlocKS2Os0wLtkPMdu9POt0AAAAASUVORK5CYII=",3:J+"UAAAAXCAIAAABrvZPKAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAIdJREFUOE/tzEEKgCAQheEOWLdx351adYc8Qgs3rbuAUC9nkkF0BKNN9CMy0Xx25llf8Edr7d57j/tlP4wTHf4W/b7gsT0vLs7Sz9bFWfM9nrDXE9ITphlVPO512wkkM++FNF86vBfKeKR43rjLe5QwOvxPVPSoipHmkY5RxSMFo7rXY9+eMSdet07b6c/bnwAAAABJRU5ErkJggg=="})[0],r=t[1],i=t[2],a=t[3],(n=this).WQ=new je(s("wijspread_toolstrip_paste"),K().ToolStrip_PasteText,o,n.XQ),n.YQ=new je(s("wijspread_toolstrip_cut"),K().ToolStrip_CutText,r,n.ZQ),n.$Q=new je(s("wijspread_toolstrip_copy"),K().ToolStrip_CopyText,i,n._Q),n.aR=new je(s("wijspread_toolstrip_autofill"),K().ToolStrip_AutoFillText,a,n.bR,n.cR),n.add(n.WQ),n.add(n.YQ),n.add(n.$Q),n.add(new _e(n.cR)),n.add(n.aR)},t.prototype.cR=function(){var e,t,n,o=Je(this.OC);if(!o)return!1;for(e=Qe(o),t=0;t<e.length;t++)if(-1===(n=e[t]).row&&-1===n.col)return!1;return!0},t.prototype.bR=function(){var e;this.close(),(e=Je(this.OC))&&(Qe(e).length<=1&&(e.wQ=!0,e._render.im()))},t.prototype.rQ=function(){var e=Je(this.OC);e&&(e.wQ=!1,e._render.im())},t.prototype._Q=function(){var e=Je(this.OC);e&&(this.dR=e.ux(!0)),this.close()},t.prototype.ZQ=function(){var e=Je(this.OC);e&&(this.dR=e.sx(!0)),this.close()},t.prototype.XQ=function(){var e=this,t=e.dR,n=Je(e.OC);n&&!a(t)&&n.vx({pasteHtml:t.copyHtml,pasteText:t.copyText}),e.close()},t.prototype.eR=function(){var e=this,t="span."+Me;l("#"+e.WQ.Cj).find(t).text(K().ToolStrip_PasteText),l("#"+e.YQ.Cj).find(t).text(K().ToolStrip_CutText),l("#"+e.$Q.Cj).find(t).text(K().ToolStrip_CopyText),l("#"+e.aR.Cj).find(t).text(K().ToolStrip_AutoFillText)},t}(s),t.TouchToolStrip=De,je=function(){function e(e,t,n,o,r){this._font="normal 12px Arial";var i=this;i.Cj=e,i._text=t,i.fR=n,o&&(i.VQ=o),r&&(i.RQ=r)}return e.prototype.name=function(e){var t=this;return 0===arguments.length?t.Cj:(l("#"+t.Cj).attr("id",e),l("#"+t.Cj+"Text").attr("id",e+"Text"),l("#"+t.Cj+"Image").attr("id",e+"Image"),t.Cj=e,t)},e.prototype.text=function(e){var t=this;return 0===arguments.length?t._text:(t._text=e,l("#"+t.name()+"Text").text(e),t)},e.prototype.font=function(e){var t=this,n=l("#"+t.name()+"Text");return 0===arguments.length?t._font:(t._font=e,n.css("font",e),t)},e.prototype.foreColor=function(e){var t=this,n=l("#"+t.name()+"Text");return 0===arguments.length?t.Nra?t.Nra:n.css("color"):(n.css("color",e),t)},e.prototype.image=function(e){var t=this;return 0===arguments.length?t.fR:(t.fR=e,l("#"+t.name()+"Image").css("background-image","url("+e+")"),t)},e.prototype.TQ=function(e,t,n,o){var r,i,a,s,u=this,f=u.name(),h=u.font(),p=u.text(),d=l(c("span"));return d.attr("id",f+"Image"),d.addClass(e),d.css({"background-image":"url("+u.image()+")","background-repeat":"no-repeat",display:"block",height:t,"background-position-x":"50%"}),(r=l(c("span"))).attr("id",f+"Text"),r.addClass(n),r.css("font",h),r.text(p),(i=function(e,t,n){var o,r=c("span"),i=Z.body;return r.className=n,r.style.font=e,r.style.cssFloat="left",r.textContent=t,i.insertBefore(r,y),o=l(r).width(),i.removeChild(r),o}(h,p,n))>(a=60)&&(a=i),(s=l(c(Ee))).attr("type",Ee),s.attr("id",f),s.addClass(o+" gc-toolstrip-button-style ui-state-default ui-widget btn btn-default"),s.css({"box-sizing":"content-box",border:"0px",padding:"4px",margin:"3px",width:a+ke}),s.append(d),s.append(r),s[0]},e}(),t.TouchToolStripItem=je,_e=function(){function e(e){this.Cj=function(){for(var e="separator",t=0,n=e+""+t;Z.getElementById(n);)n=e+""+ ++t;return n}(),e&&(this.RQ=e)}return e.prototype.name=function(){return this.Cj},e.prototype.TQ=function(e,t){var n=l(c("div"));return n.attr("id",this.name()),n.addClass(e),n.css({width:"1px",height:t,display:"inline-block;","background-color":"#CCC","margin-left":"5px","margin-right":"5px",opacity:.6}),n[0]},e}(),t.TouchToolStripSeparator=_e,Oe=function(){function e(e){this.tc=e}return e.prototype.oN=function(){this.gR=2,this.tc.CH=!0},e.prototype.zM=function(){this.gR=0,this.hR=Ze()},e.prototype.nN=function(){return 1===this.gR},e.prototype.uN=function(){return 1===this.gR},e.prototype.sN=function(){return 1===this.gR},e.prototype.GQ=function(){var e=this;if(2===e.gR)return!0;if(e.hR){if(Ze()-e.hR<=200)return e.iR++,!0;e.hR=0,e.iR=0,e.gR=1}else e.gR=1;return e.tc.CH=!1,!1},e.prototype.HQ=function(){var e=this;return e.iR?(e.iR--,!0):2===e.gR||(e.gR=0,!1)},e.prototype.IQ=function(){return 2===this.gR},e}(),t.jR=Oe,Fe=function(e,t,n,o,r){var i=this;i.KM=e,i.lN=n,i.OM=t,i.mN=o,i.aN=r},t.kR=Fe,Pe=function(){function e(){}return e.prototype.lR=function(e,t){var n,o,r=e,i=r.touches,s=r.targetTouches,l=r.changedTouches;!1!==r.isPrimary&&(i&&i.length>=1&&s&&s.length>=1&&(i[0].clientX!==s[0].clientX||i[0].clientY!==s[0].clientY)||(f(e),n=a(l)?r:l[0],(o=Z.createEvent("MouseEvents")).initMouseEvent(t,!0,!0,U,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,y),e.target.dispatchEvent(o)))},e.prototype.NM=function(e){var t,n=e.pointerType;if(!n||n===e[z]||n===k){if((t=e.data).mR)return;t.mR=!0,t.nR=!1,t.lR(e,"mouseover"),t.lR(e,"mousemove"),t.lR(e,"mousedown")}},e.prototype.aB=function(e){var t,n=e.pointerType;if(!n||n===e[z]||n===k){if(!(t=e.data).mR)return;t.nR=!0,t.lR(e,"mousemove")}},e.prototype.RM=function(e){var t,n=e.pointerType;if(!n||n===e[z]||n===k){if(!(t=e.data).mR)return;t.lR(e,"mouseup"),t.lR(e,"mouseout"),t.nR||t.lR(e,"click"),t.mR=!1}},e.prototype.oR=function(e,t,n){var o,i,s,u,c,f,h,p,d,g,m,y=this;"."!==n.charAt(0)&&(n="."+n),o=D+n,i=j+n,s=_+n,u=O+n,c=F+n,f=P+n,h=H+n,p=B+n,d=L+n,g=r.Ul._Va(),t?g?(m=e.style,a(m.msTouchAction)||(m.msTouchAction=E),a(m.touchAction)||(m.touchAction=E),l(e).bind(o,y,y.NM).bind(u,y,y.NM),l(Z).bind(i,y,y.aB).bind(c,y,y.aB).bind(s,y,y.RM).bind(f,y,y.RM)):l(e).bind(h,y,y.NM).bind(p,y,y.aB).bind(d,y,y.RM):g?(l(e).unbind(o).unbind(u),l(Z).unbind(i).unbind(c).unbind(s).unbind(f)):l(e).unbind(h).unbind(p).unbind(d)},e}(),t.pR=Pe,He="newSheet",Be=function(){function e(e){this.hq=e}return e.prototype.lQ=function(e){var t,n,o,i,a,s,l,u,c=this,f=e.rN,h=c.hq,p=Je(h.OC);h.FD&&h.GD(p,!1),"resize"===(t=h.hitTest(f.X,f.Y).element)?(h.HD=!0,h.ID=f.X):"tab"!==t&&t!==He&&""!==t||(n=h.Xs,o=r.En.Nn(n),i=r.En.On(n),s=(a=c.IP(o,i)).getContext("2d"),l=r.En.Ln(a),u=r.En.Mn(a),r.Bn.Cn(s,1,1),s.drawImage(n,0,0,We(a),Ge(a),0,0,We(a),Ge(a)),r.Bn.Cn(s,l,u),c.Xs=a,c.qR=h.gq,c.rR=h.VC(),c.sR=h.UC(),c.KC=h.TC(),h.SC=!0),c.tR=h.jw(-1),c.uR=h.rD(h.sD())},e.prototype.pQ=function(e){var t,n,o,i,s,l,u,c,f,h,p,d,g,m,y,v,C,w,x,A,M,S,T,N,I,R,k=this,E=e.rN.X,D=k.hq;if(D.HD)t=E-D.ID,o=(n=D.OC).options,i=n.xs.clientWidth,o.tabStripRatio=n.Iv()+t/i,s=D.kw/i,1,n.Iv()<s?(o.tabStripRatio=s,D.ID=D.kw):n.Iv()>=1?(o.tabStripRatio=1,D.ID=i):D.ID=E;else{if(l=k.Xs,u=k.qR,!l||a(u))return;c=k.tR,f=k.uR,h=k.KC,p=k.rR,d=k.sR,g=e.dP.sO.X,m=k.vR(g,u),D.gq=m.gq,y=m.Vo,(g>0&&u===c&&D.gq===c||g<0&&u===f&&D.gq===f)&&(y=0),g>0&&g>y+h?g=y+h:g<0&&g<y-h&&(g=y-h),0!==g&&(C=(v=D.Xs).getContext("2d"),w=r.En.Ln(v),x=r.En.Mn(v),C.save(),C.clearRect(0,0,r.En.Nn(v),r.En.On(v)),A=D.Dr(),D.dD(C,A),M=void 0,0,S=void 0,T=Ge(A),N=void 0,I=void 0,g>0?((S=d-(N=(M=p)+g))>0&&(r.Bn.Cn(C,1,1),C.drawImage(l,M*w,0,S*w,T*x,N*w,0,S*w,T*x),r.Bn.Cn(C,w,x)),I=g-y,d-p<=g&&(I=0),M=p,(S=y)>0&&(r.Bn.Dn(C,I,0),D.iE(C,new r.Rect(M,0,S,T)),r.Bn.Dn(C,-I,0))):g<0&&((S=d-(M=(N=p)+b(g)))>0&&(r.Bn.Cn(C,1,1),C.drawImage(l,M*w,0,S*w,T*x,N*w,0,S*w,T*x),r.Bn.Cn(C,w,x)),I=g-y,d-p<=b(g)&&(I=0),M=d-(S=b(y)),S>0&&(r.Bn.Dn(C,I,0),D.iE(C,new r.Rect(M,0,S,T)),r.Bn.Dn(C,-I,0))),r.Bn.Cn(C,1,1),M=0,S=p,C.drawImage(l,M*w,0,S*w,T*x,M*w,0,S*w,T*x),R=r.Im.Lm(""),G(R.zIndex)>2007&&(M=d,S=A.x+We(A)-D.kw-M,C.drawImage(l,M*w,0,S*w,T*x,M*w,0,S*w,T*x)),M=We(A)-D.kw,S=D.kw,C.drawImage(l,M*w,0,S*w,T*x,M*w,0,S*w,T*x),r.Bn.Cn(C,w,x),C.restore())}},e.prototype.qQ=function(e){var t=this.hq;t.HD?(t.HD=!1,t.OC.aq()):(t.SC=v,t.repaint())},e.prototype.sQ=function(e){var t,n,o,r,i=this.hq,a=i.OC,s=e.rN,l=Je(a);i.FD&&i.GD(l,!1),t=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],o=(n=i.hitTest(s.X,s.Y)).element,a.mv=!0;try{t.indexOf(o)>=0?i.JD(n.index,!0):"tab"===o?i.KD(n.index,n.position):o===He&&i.MD(n.position)}finally{a.mv=!1,(r=Je(a))!==l&&(r.CH=!0,r.zt())}},e.prototype.yQ=function(e){return this.hq.cE(e.rN.X,e.rN.Y)},e.prototype.IP=function(e,t){var n=this.Xs;return n?e===r.En.Nn(n)&&t===r.En.On(n)||r.En.Pn(n,e,t):(n=c("canvas"),r.En.Kn(n,this.hq.OC),r.En.Pn(n,e,t)),n},e.prototype.vR=function(e,t){var n=this,o=n.hq.WC,r=n.tR,i=n.uR,a=t,s=0;if(e>0){for(;a>=r&&!(s>e);)s+=o[a],a--;a<r&&(a=r)}else if(e<0&&-1!==i){for(;a<=i&&!(s<e);)s-=o[a],a++;a>i&&(a=i)}return{gq:a,Vo:s}},e}(),Le=function(){function e(e,t,n){var o,r,i=this;i.yM=new Oe(i),i.DQ=new Fe(e,"tabStrip",i.yM,1,-1),i.BQ=n,i.CQ=new Be(t),o=i.CQ,(r=i.DQ).eN=function(e){return o.lQ(e)},r.fN=function(e){return o.pQ(e)},r.hN=function(e){return o.qQ(e)},r.iN=function(e){return o.sQ(e)},r.jN=function(e){return o.yQ(e)}}return e.prototype.EQ=function(){var e=this.BQ;e&&e.xN(this.DQ,!0)},e.prototype.FQ=function(){var e=this.BQ;e&&e.xN(this.DQ,!1)},e.prototype.GQ=function(e){return this.yM.GQ()},e.prototype.HQ=function(e){return this.yM.HQ()},e.prototype.IQ=function(e){return this.yM.IQ()},e}(),r.oJ.prototype.DH=function(){var e=this.kj,t=Qe(e),n=t.length;e.Xq<=0&&n>0&&this.im(t[n-1],v,v,!0)},r.Worksheet.$n(k,{init:function(){this.wQ=!1,this.mQ=!0},setHost:function(e){var t=this,n=t.parent,o=n&&n.BQ||new $,r=new xe(e[0],t,o);r.EQ(),t.wR=r},dispose:function(e){var t=this;t.wR&&t.wR.FQ(),!1!==e.clearCache&&(t.wR=y)},startEdit:function(){this._render.DH()},paintAdornment:function(e){var t=this,n=e.ctx;t.CH&&(t.options.isProtected||function(e,t){var n,o,i,a,s,l,u,c,f,h,p,d,g,m=e.am(),y=16,v=Qe(e);e.CH&&v.length>0&&(l=(s=v[v.length-1]).row,u=s.row+s.rowCount-1,c=s.col,f=s.col+s.colCount-1,p="AAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADs",(h=e.parent)&&!h.options.allowUserResize||(-1!==l&&-1===c&&e.getRowResizable(u)?(d=e.Er(u),n=J+p+"MAAA7DAcdvqGQAAABaSURBVDhPY/z//z8DLsDIyAiWBKphBAtgAUxQGgPANIMAMhsdYDUAmwZchtDOC8SCgTcA5DfcgUAEoNwFo7GAPQxwJVtsYYHVBdgU4gpInF5A1oBLMwMDAwMApuAtD6Z7YxQAAAAASUVORK5CYII=",o=e.getCellRect(u,$e(e,2)-1,d,-1),(a=m.fm(d)).y<=o.y&&o.y+Ge(o)<=a.y+Ge(a)&&(i=new r.Rect(m.kt-y,o.y+Ge(o)-8,y,y))):-1===l&&-1!==c&&e.getColumnResizable(f)&&(g=e.Fr(f),n=J+p+"IAAA7CARUoSoAAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAE1JREFUOE/ljtEKACAIA/v/nzZ9mFhsJPRocLEuGS4zk/iJyyP/D6gE0wrYoCqoLoUafPl8fEBln3ulSscfErk65TMjMFRBhUowosDWBoHpba8+C7w0"+Q,o=e.getCellRect(Xe(e,1)-1,f,-1,g),(a=m.gm(g)).x<=o.x&&o.x+We(o)<=a.x+We(a)&&(i=new r.Rect(o.x+We(o)-8,m.nt-y,y,y))),n&&i&&vt(e,n,t,i)))}(t,n),t.wQ?function(e,t){var n=bt(e);n&&(J+"EAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1"+Q,vt(e,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1AAAAAElFTkSuQmCC",t,n))}(t,n):function(e,t,n){var o,i,a,s;if(r.needPaintSelection(e)){if(e.isEditing()||!t||0===e.selectionPolicy())return;if(a=void 0,(i=(o=xt(e)).length)>0){for(n.save(),n.fillStyle=e.m_a()||"white",n.strokeStyle=e.getSelectionBorderColor(),s=0;s<i;s++)(a=o[s])&&(n.beginPath(),n.arc(a.x+We(a)/2,a.y+Ge(a)/2,We(a)/2,0,2*Math.PI,!1),n.fill(),n.stroke());n.restore()}}}(t,t.mQ,n))},preProcessMouseDown:function(e){var t=e.e,n=this.wR;(m||n.GQ(t))&&(f(t),e.r=!0)},preProcessMouseMove:function(e){var t=e.e,n=this.wR;(m||n.IQ(t))&&(f(t),e.r=!0)},preProcessMouseUp:function(e){var t=e.e,n=this.wR;(m||n.HQ(t))&&(f(t),e.r=!0)},preProcessMouseDbClick:function(e){(m||this.CH)&&(e.r=!0)},preProcessMouseOut:function(e){m&&(e.r=!0)},preProcessMouseWheel:function(e){m&&(e.r=!0)}}),r.Workbook.$n(k,{init:function(){this.BQ=new $},setHost:function(){var e=this;e.touchToolStrip=new De(e,e.xv())},dispose:function(){var e=this,t=e.BQ,n=e.touchToolStrip;t&&t.no(),n&&(n.no(),e.touchToolStrip=y)},onCultureChanged:function(){var e=this.touchToolStrip;e&&e.eR()}}),r.DC.$n(k,{setHost:function(){var e=this,t=new Le(e.Xs,e,e.OC.BQ);t.EQ(),e.wR=t},dispose:function(){var e=this.wR;e&&(e.FQ(),this.wR=y)},preProcessMouseDown:function(e){var t=this.wR,n=e.e;(m||t.GQ(n))&&(f(n),e.r=!1)},preProcessMouseMove:function(e){var t=this.wR,n=e.e;(m||t.IQ(n))&&(f(n),e.r=!1)},preProcessMouseUp:function(e){var t=this.wR,n=e.e;(m||t.HQ(n))&&(f(n),e.r=!1)},preProcessMouseDbClick:function(e){var t=Je(this.OC);(m||t&&t.CH)&&(e.r=!1)},preProcessMouseOut:function(e){m&&(e.r=!1)}}),ze=".gcScrollbar",r.hv.$n(k,{initEvents:function(e){(this.xR=new Pe).oR(e,!0,ze)},dispose:function(e){var t=this.xR;t&&t.oR(e,!1,ze)}})},"./dist/plugins/touch/touch.res.en.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ToolStrip_PasteText="Paste",t.ToolStrip_CutText="Cut",t.ToolStrip_CopyText="Copy",t.ToolStrip_AutoFillText="AutoFill"},"./dist/plugins/validation/datavalidation-event.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E;Object.defineProperty(t,"__esModule",{value:!0}),o=n("Core"),r=n("@grapecity/js-sheets-common"),i=n("@grapecity/js-calc"),a=n("./dist/plugins/validation/datavalidation.js"),s=r.Common.j.Fa,l=r.Common.l,u=r.Common.u,c=o.Ul,f=o.kf,h=c.rl(),p=c.Ml,d=o.GC$,g=c.Nl,m=c.hZa,y=c.nl,v=document,b=Math.max,C=Math.min,w="position",x="absolute",A="border",M="font",S="background-color",T="top",N="left",I="z-index",R="auto",k="white",E="gcUIElement",d.extend(o.iI.prototype,{cs:function(e,t){var n,o,r,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe,re,ie,ae,se,le,ue,ce,fe,he,pe,de,ge,me,ye,ve,be;function Ce(e,t){if(e&&e[t])return"function"==typeof e[t]?e[t]():e[t]}if((r=(o=(n=this).kj)&&o.parent)&&(o.hm()&&((D=r.getActiveSheet())&&o.name()===D.name()&&((j=o.getDataValidator(e,t))&&(_=o.getCellRect(e,t),!n.oG(_)&&(O=r.xv(),F=r.getHost(),P=c.vl(F),Ce(j,"showInputMessage")&&Ce(j,"inputMessage")&&(L=(H=u.Gb)((B=u.Ob)(Ce(j,"inputTitle")),"\n","<br/>"),z=H(B(Ce(j,"inputMessage")),"\n","<br/>"),V=g("span"),d(V).css(w,x).css(A,"1px #C0C0C0 solid").css("padding","3px 8px 3px 8px").css(S,"#FFFFFF").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(M,"normal normal normal 12px/normal Arial").width(R).height(R).css(T,_.y+_.height+5).css(N,_.x+_.width/2).css(I,P).html("<b>"+L+"</b><br/>"+z).attr(E,"gcValidationInputMessage").appendTo(O),o.KH=V),j&&3===Ce(j,"type")&&Ce(j,"inCellDropdown")&&Ce(j,"condition"))))))){for(G=Ce(j,"condition").getValidListImp(o,e,t),W=Ce(j,"condition").CIc(),U=G.length,Z=g("select"),q=o.getText(e,t),J=-1,Q=v.createDocumentFragment(),Y=RegExp(String.fromCharCode(32),"g"),K=String.fromCharCode(160),$=0;$<U;$++)X=G[$].text,s(X)||i&&X instanceof i.CalcError||(J<0&&X===q&&(J=$),X instanceof Date&&(X=l.Vb(X,"M/d/yyyy h:mm:ss")),(ee=g("option")).value=X,ee.text=X.replace(Y,K),Q.appendChild(ee));Z.appendChild(Q),Z.selectedIndex=J>0?J:0,te=o.getActualStyle(e,t),ne=o._render,oe=te&&te.font?te.font:ne.Bl(),o.zoom()>1&&(oe=ne.Cl(oe)),ie=1,(re=o._modelManager.getSpans(f(e,t,1,1)))&&re.length>0&&re[0]&&(ie=re[0].colCount),ae=t+ie-1==o.getColumnCount()-1,se=o.Sl(e),le=o.parent&&o.parent.options.useTouchLayout,se=C(le?50:15,se),ue=h,ce=p.safari&&(ue.ipad||ue.iphone),fe=ue.android,he=void 0,pe=void 0,de=void 0,ge=void 0,me=void 0,ce?(he=_.width+3,pe=_.height+3,de=_.y-1.5,ge=_.x-1.5,me=k):(he=b(_.width+(ae?0:se),o.defaults.colWidth),pe=U>8?140:R,de=_.y+_.height,ge=_.x+_.width+(ae?0:se)-he,me=""),ye=d(Z).css("outline","none").css(w,x).css(M,m(oe)).css(I,P).css(S,me).width(he).height(pe).css(N,ge).attr(E,"gcValidationSelect").appendTo(O).attr("size",U>2?U:2).hide().bind("click",(function(){fe||(n.pG(Z,e,t,G,W),ce&&d(o.y$).show())})).bind("keydown",(function(r){13!==r.keyCode||r.ctrlKey||r.shiftKey||r.altKey?27!==r.keyCode||r.ctrlKey||r.shiftKey||r.altKey||d(Z).hide():n.pG(Z,e,t,G,W),ce&&d(o.y$).show()})).bind("change",(function(){fe&&n.pG(Z,e,t,G,W)})),ve=d(F).height(),(pe=ye.outerHeight()+1)+de>ve&&de>pe&&(ce||(de=_.y-pe)),ye.css(T,de),ce&&ye.bind("blur",(function(){n.pG(Z,e,t,G,W),d(o.y$).show()})),o.lm=Z,(be=g("input")).type="image",be.src=a.zW(),be.alt="v",d(be).css(w,x).width(se).height(se).css(T,_.y+_.height-(se+3)).css(N,_.x+_.width-(ae?se:0)).css(I,P).css(S,k).css(A,"1px solid gray").attr(E,"gcValidationButton").appendTo(O).bind("click",(function(e){o.isEditing()&&!o.endEdit()||(d(o.lm).toggle().focus(),ce&&d(o.y$).toggle(),y(e))})),o.y$=be}}})},"./dist/plugins/validation/datavalidation.entry.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n("./dist/plugins/validation/datavalidation-event.js");var o=n("./dist/plugins/validation/datavalidation.js");t.CriteriaType=o.CriteriaType,t.DataValidationResult=o.DataValidationResult,t.ErrorStyle=o.ErrorStyle,t.DefaultDataValidator=o.DefaultDataValidator,t.HighlightType=o.HighlightType,t.HighlightPosition=o.HighlightPosition,t.zW=o.zW,t.bW=o.bW,t.createNumberValidator=o.createNumberValidator,t.createDateValidator=o.createDateValidator,t.createTimeValidator=o.createTimeValidator,t.createTextLengthValidator=o.createTextLengthValidator,t.createFormulaValidator=o.createFormulaValidator,t.createFormulaListValidator=o.createFormulaListValidator,t.createListValidator=o.createListValidator},"./dist/plugins/validation/datavalidation.js":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j;function _(e){var t,n,r,i;if(e instanceof Date)return e;if("string"==typeof e){if(!(t=o.Common.l.Qa(e)))if(isNaN(e)){if(t=new Date(e),isNaN(t.valueOf()))return d;try{if(n=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,r=o.Common.u.ib(o.Common.u.Db(e.replace(/ |\n/g,"")," ")," "),(i=n.exec(r))&&4===i.length&&(-1===i.indexOf(""+t.getFullYear())||-1===i.indexOf(""+t.getMonth())||-1===i.indexOf(""+t.getDate())))return d}catch(e){return d}}else if(!(t=o.Common.l.Xb(parseFloat(e))))return d;return t}return d}function O(e){return l&&e&&"="===e[0]}function F(e,t,n,o){var r,i,a,s,l=d,f=d,h=d,p=d;return O(t)?l=c(t,"="):f=t,O(n)?h=c(n,"="):p=n,r=d,6===e&&((i=u(1,3,f,l)).integerValue(o),(a=u(1,5,p,h)).integerValue(o),r=u(0,1,d,d,d,d,d,i,a)),7===e&&((i=u(1,4,f,l)).integerValue(o),(a=u(1,2,p,h)).integerValue(o),r=u(0,0,d,d,d,d,d,i,a)),e>=0&&e<=5&&(r=u(1,e,f,l)).integerValue(o),(s=new E(r)).type(o?1:2),s.comparisonOperator(e),s}function P(e,t,n,o,r){var i,a,s,l,f,h=d,p=d,g=d,m=d;if(O(t)?h=c(t,"="):p=t,O(n)?g=c(n,"="):m=n,i=d,6===e&&(a=u(o,5,p,h),s=u(o,3,m,g),i=u(0,1,d,d,d,d,d,a,s)),7===e&&(a=u(o,2,p,h),s=u(o,4,m,g),i=u(0,0,d,d,d,d,d,a,s)),e>=0&&e<=5){switch(e){case 0:l=0;break;case 1:l=1;break;case 2:l=4;break;case 3:l=5;break;case 4:l=2;break;case 5:l=3}i=u(o,l,p,h)}return(f=new E(i)).type(r),f.comparisonOperator(e),f}function H(e,t,n){return P(e,t,n,5,4)}function B(e,t,n){return P(e,t,n,13,5)}function L(e,t,n){var o,r,i,a,s=d,l=d,f=d,h=d;return O(t)?s=c(t,"="):l=t,O(n)?f=c(n,"="):h=n,o=d,6===e&&(r=u(7,3,l,s),i=u(7,5,h,f),o=u(0,1,d,d,d,d,d,r,i)),7===e&&(r=u(7,4,l,s),i=u(7,2,h,f),o=u(0,0,d,d,d,d,d,r,i)),e>=0&&e<=5&&(o=u(7,e,l,s)),(a=new E(o)).type(6),a.comparisonOperator(e),a}function z(e){if(!l)return d;var t=new E(u(4,d,d,c(e,"="),4));return t.type(7),t}function V(e){if(!l)return d;var t=new E(i.Condition.fromFormula(e));return t.type(3),t}function G(e){var t=new E(i.Condition.fromSource(e));return t.type(3),t}function W(e){return this.Tq(e)}function U(e,t){var n=e.getRowCount(),o=e.getColumnCount();return t.map((function(e){return function(e,t,n){var o=e.rowCount,r=e.colCount,i=C(e.row,e.col,o,r);return 0===e.row&&o===t&&(i.row=-1),0===e.col&&r===n&&(i.col=-1),i}(e,n,o)}))}function Z(e,t){var n,o,r,i,a,s,l,u,c=t.Eja;for(o=0,r=e.row,i=e.rowCount;o<i;o++,r++)if(n=c[r])for(a=0,s=e.col,l=e.colCount;a<l;a++,s++)(u=n[s])&&u.IW(e,t),n[s]=g}function q(e){var t,n,o=[];if(e)for(t in e)(n=e[t])&&o.push(n);return o}Object.defineProperty(t,"__esModule",{value:!0}),o=n("@grapecity/js-sheets-common"),r=n("Core"),i=n("ConditionalFormatting"),a=n("SheetsCalc"),s=n("@grapecity/js-calc"),l=!!s,u=i.$V,c=o.Common.u.Db,f=o.Common.j.Fa,h=o.Common.j.C4,p=r.GC$,d=null,g=void 0,y=(m=r.Ul).Pl,v=m.Ol,b=m.T$a,C=r.kf,w=Math.min,x=Math.max,A=o.Common.l,M=".validator",T={type:0,color:S="red"},N={type:1,color:S,position:1},I={type:2,color:S,position:5,image:null},R=window,function(e){e[e.anyValue=0]="anyValue",e[e.wholeNumber=1]="wholeNumber",e[e.decimalValues=2]="decimalValues",e[e.list=3]="list",e[e.date=4]="date",e[e.time=5]="time",e[e.textLength=6]="textLength",e[e.custom=7]="custom"}(t.CriteriaType||(t.CriteriaType={})),function(e){e[e.forceApply=0]="forceApply",e[e.discard=1]="discard",e[e.retry=2]="retry"}(t.DataValidationResult||(t.DataValidationResult={})),function(e){e[e.stop=0]="stop",e[e.warning=1]="warning",e[e.information=2]="information"}(t.ErrorStyle||(t.ErrorStyle={})),function(e){e[e.circle=0]="circle",e[e.dogEar=1]="dogEar",e[e.icon=2]="icon"}(t.HighlightType||(t.HighlightType={})),function(e){e[e.topLeft=0]="topLeft",e[e.topRight=1]="topRight",e[e.bottomRight=2]="bottomRight",e[e.bottomLeft=3]="bottomLeft",e[e.outsideLeft=4]="outsideLeft",e[e.outsideRight=5]="outsideRight"}(t.HighlightPosition||(t.HighlightPosition={})),k=["errorStyle","ignoreBlank","inCellDropdown","showInputMessage","showErrorMessage","inputTitle","errorTitle","inputMessage","errorMessage","comparisonOperator","type","condition"],E=function(){function e(t){var n=this;n.id=e.w$,e.w$++,n.QAb=h(T),t&&(n.condition(t),n.condition().ignoreBlank(n.ignoreBlank())),n.n5=[]}return e.prototype.value1=function(e,t){var n,o=this.condition(),r=o&&o.item1()?o.item1():o;return r?(n=r.formula(e,t))&&n.length>0?"="+c(p.trim(""+n),"="):r.expected():d},e.prototype.value2=function(e,t){var n,o=this.condition(),r=o&&o.item2()?o.item2():o;return r?(n=r.formula(e,t))&&n.length>0?"="+c(p.trim(""+n),"="):r.expected():d},e.prototype.isValid=function(e,t,n,o){var r,i,a,s=this,l=s.condition();if(l){if(s.ignoreBlank()&&(f(o)||""===o))return!0;if(r=o,i=void 0,!f(o))switch(s.type()){case 0:return!0;case 2:case 1:i=function(e){if(f(e))return 0;if("number"==typeof e)return e;if("string"==typeof e){var t=parseFloat(e);if(!isNaN(t)&&""+t===e)return t}return d}(o),f(i)||(r=i);break;case 4:case 5:i=_(o),f(i)||(r=i)}e&&(e.lRa=!0),a=void 0;try{a=l.evaluate(e,t,n,r,r)}catch(e){a=!0}finally{e&&(e.lRa=!1)}return a}return!0},e.prototype.reset=function(){var e=this;e.errorStyle(0),e.ignoreBlank(!0),e.inCellDropdown(!0),e.showInputMessage(!0),e.showErrorMessage(!0),e.inputTitle(""),e.errorTitle(""),e.inputMessage(""),e.errorMessage(""),e.comparisonOperator(6),e.type(0),e.condition(d),e.n5.length=0},e.prototype.getValidList=function(e,t,n){var o=this.condition();return o!==d&&3===this.type()&&12===o.conType()?o.getValidList(e,t,n):d},e.prototype.highlightStyle=function(e){var t,n,o=this;if(0===arguments.length)return o.QAb;if(!f(e)){if(o.QAb.type!==e.type)switch(e.type){case 1:o.QAb=h(N);break;case 2:o.QAb=h(I);break;default:o.QAb=h(T)}for(n in t=o.QAb)t.hasOwnProperty(n)&&e.hasOwnProperty(n)&&(t[n]=e[n]);return o.kj&&o.kj.repaint(),o}},e.prototype.toJSON=function(e){var t,n=this,o={};return k.forEach((function(t){var r=n[t]();n[t].isDefault(r)||(o[t]=r&&r.toJSON?r.toJSON(e):r)})),t=n.n5.map((function(e){return-1===e.row&&-1===e.col?C(-1,0,e.rowCount,e.colCount):e})),o.ranges=a.rangesToFormula(t,0,0,15,!1),o.highlightStyle=JSON.stringify(n.QAb),p.isEmptyObject(o)?g:o},e.prototype.fromJSON=function(e,t,n){var o,r,i,s,l;e&&!p.isEmptyObject(e)&&(o=this,e.ranges&&(o.n5=a.formulaToRanges(n,e.ranges,0,0,!0)[0].ranges),e.highlightStyle&&(o.QAb=JSON.parse(e.highlightStyle)),k.forEach((function(r){var i,a,s=e[r];v(s)&&("condition"===r?((i=u()).fromJSON(e.condition,n,t),o.condition(i,!1),(a=i.ranges())&&a.length?o.n5=a:i.ranges(o.n5),i.context(n)):o[r](s,!1))})),(r=e.validatorInfo)&&(i=n.Wu.useR1C1,s=function(e,t){var n,o,r;if(!f(e))return 1===e||2===e?n=F(t.operator,t.value1,t.value2,1===e):3===e?t.value?n=G(t.value):t.formula&&(n=V(t.formula)):4===e||5===e?(o=t.value1,r=t.value2,o&&"/OADate("===o.substr(0,8)&&(o=A.Rka(o)),r&&"/OADate("===r.substr(0,8)&&(r=A.Rka(r)),n=5===e?B(t.operator,o,r):H(t.operator,o,r)):6===e?n=L(t.operator,t.value1,t.value2):7===e&&void 0!==t.formula&&(n=z(t.formula)),n?n.condition():void 0}(e.type,r),l=r.operator,s&&(s.ranges(o.n5),s.ignoreBlank(o.ignoreBlank()),s.context(n),i&&b(s),o.condition(s)),f(l)||o.comparisonOperator(l)))},e.prototype.clone=function(t){var n,o;return this.Nja?((n=this.condition())&&n.initExpression(),this):((o=new e).fromJSON(this.toJSON(t),!1,t||this.kj),o.n5=[],o)},e.prototype.context=function(e){if(e){this.xc=e;var t=this.condition();t&&(t.ranges(this.n5),t.context(e))}return this.xc},e.prototype.xja=function(e){var t,n;if(e){for(t=this.n5,n=0;n<t.length;n++)if(t[n].containsRange(e))return;t.push(e)}},e.prototype.IW=function(e,t){var n,o,r,i,a,s,l,u,c=this,f=c.n5;e&&f.length&&(n=e.row,o=e.col,r=e.rowCount,i=e.colCount,a=[],s=!1,l=c.kj,u=l&&[l.getRowCount(),l.getColumnCount()],f.forEach((function(e){var t=function(e,t,n,o,r,i){var a,s,l,u,c,f,h,p,d,g,m,y,v,b,A,M,S,T,N,I,R,k;return e.intersect(t,n,o,r)?(a=e.rowCount,s=e.colCount,l=x(0,e.row),u=x(0,e.col),c=!1,f=!1,h=!1,t=x(0,t),n=x(0,n),i||(i=[-1,-1]),p=i[0],d=i[1],-1===a&&(a=p-l,f=!0),-1===s&&(s=d-u,c=!0),-1===o&&(o=p-t),-1===r&&(r=d-n,h=!0),m=l+a-1,y=u,v=u+s-1,b=t,A=t+o-1,M=n,S=n+r-1,T=[],-1!==(g=l)&&-1!==y&&-1!==b&&-1!==M&&(M-y>0&&(N=C(g,y,f?-1:a,M-y),T.push(N)),v-S>0&&(I=C(g,S+1,f?-1:a,v-S),T.push(I)),b-g>0&&(R=C(g,x(M,y),b-g,c&&h?-1:w(S,v)-x(M,y)+1),T.push(R)),m-A>0&&(k=C(A+1,x(M,y),m-A,c&&h?-1:w(S,v)-x(M,y)+1),T.push(k))),T.PAb=!0,T):[e]}(e,n,o,r,i,u);t.PAb&&(s=!0),a.push(t)})),c.n5=[].concat.apply([],a),s&&t.RAb(c))},e.prototype.l1=function(){return this.n5},e.prototype.rI=function(e,t,n){var o,r,i,a,s,l,u;if(!(e<0||t<=0)){for(this.condition()&&this.condition().initExpression(),o=0;o<this.n5.length;o++){if(i=(r=this.n5[o]).row,n&&n.length>0){for(a=!1,s=0,l=n.length;s<l;s++)if((u=n[s])&&u.row===r.row&&u.row+u.rowCount-t===r.row+r.rowCount&&r.row===e){r.rowCount+=t,a=!0;break}if(a)break}e<=i?r.row+=t:e<=i+r.rowCount&&(r.rowCount+=t)}this.condition()&&this.condition().ranges(this.n5)}},e.prototype.GR=function(e,t){if(!(e<0||t<=0)){this.condition()&&this.condition().initExpression();var n=[];this.n5.forEach((function(o){var r,i=o.row,a=o.rowCount;e<i?((r=e+t-i)<=0?i-=t:(i-=r,o.rowCount-=r),i<0&&(o.rowCount+=i,i=0),o.row=i):i<=e&&e<i+a&&(o.rowCount-=w(t,i+a-e)),(o.rowCount>0||-1===o.row&&-1===o.rowCount)&&n.push(o)})),this.n5=n,this.condition()&&this.condition().ranges(this.n5)}},e.prototype.tI=function(e,t,n){var o,r,i,a,s,l,u,c;if(!(e<0||t<=0)){for(this.condition()&&this.condition().initExpression(),o=0;o<this.n5.length;o++){if(r=this.n5[o],n&&n.length>0){for(i=!1,a=!1,s=0,l=n.length;s<l;s++)if(!(u=n[s])||u.containsRange(r)){if(u&&u.col===r.col&&u.col+u.colCount-t===r.col+r.colCount&&u.col===e){r.colCount+=t,a=!0;break}}else i=!0;if(i)continue;if(a)break}e<=(c=r.col)?r.col+=t:e<=c+r.colCount&&(r.colCount+=t)}this.condition()&&this.condition().ranges(this.n5)}},e.prototype.HR=function(e,t){if(!(e<0||t<=0)){this.condition()&&this.condition().initExpression();var n=[];this.n5.forEach((function(o){var r,i=o.col,a=o.colCount;e<i?((r=e+t-i)<=0?i-=t:(i-=r,o.colCount-=r),i<0&&(o.colCount+=i,i=0),o.col=i):i<=e&&e<i+a&&(o.colCount-=w(t,i+a-e)),(o.colCount>0||-1===o.col&&-1===o.colCount)&&n.push(o)})),this.n5=n,this.condition()&&this.condition().ranges(this.n5)}},e.w$=1,e}(),t.DefaultDataValidator=E,D={errorStyle:y("errorStyle",0),ignoreBlank:y("ignoreBlank",!0,(function(e){this.condition()&&this.condition().ignoreBlank(e)})),inCellDropdown:y("inCellDropdown",!0),showInputMessage:y("showInputMessage",!0),showErrorMessage:y("showErrorMessage",!0),inputTitle:y("inputTitle",""),errorTitle:y("errorTitle",""),inputMessage:y("inputMessage",""),errorMessage:y("errorMessage",""),comparisonOperator:y("comparisonOperator",6),condition:y("condition",d),type:y("type",0)},p.extend(E.prototype,D),t.zW=function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg=="},t.bW=O,t.createNumberValidator=F,t.createDateValidator=H,t.createTimeValidator=B,t.createTextLengthValidator=L,t.createFormulaValidator=z,t.createFormulaListValidator=V,t.createListValidator=G,p.extend(r.Worksheet.prototype,{getDataValidator:function(e,t,n){return f(n)&&(n=3),3===n?this.uja.Aja(e,t)[0]:g},setDataValidator:function(e,t,n,o,r,i){var a,s,l,u,c=this,h=c.uja;if(arguments.length<5&&(r=n,i=o,n=-1===e?-1:1,o=-1===t?-1:1),f(i)&&(i=3),3===i){if(a=c.getDataValidator(e,t,i),(s=1===n&&1===o)&&a===r)return;c._modelManager.zVa(),l=C(e,t,n,o),h.Cja(l),r&&h.Bja(r,l),u="validator",s&&(c.Bq(u,e,t,i,a,r),-1!==e&&-1===t?c.kq(e,i,u,r,a):-1===e&&-1!==t&&c.pq(t,i,u,r,a)),c.$p()}},isValid:function(e,t,n){var o,r=this;try{if(r.Ku=e,r.Lu=t,r.Mu=n,r.Ju=!0,o=r.getDataValidator(e,t))return o.isValid(r,e,t,n)}finally{r.Ku=-1,r.Lu=-1,r.Mu=d,r.Ju=!1}return!0},hm:function(){var e,t,n,o,r=this;return!r.x$&&(r.x$=!0,(e=r.KH)&&((t=e.parentNode)&&t.removeChild(e),r.KH=d),(n=r.y$)&&(p(n).unbind("click"),(t=n.parentNode)&&t.removeChild(n),r.y$=d),(o=r.lm)&&(p(o).unbind("keydown").unbind("blur").unbind("click").unbind("change"),(t=o.parentNode)&&t.removeChild(o),r.lm=d),r.x$=!1,!0)},tja:function(){var e,t,n,o=[],r=this.uja,i=r&&r.Dja;if(i)for(e in i)(n=(t=i[e])&&t.condition())&&n.getExpressions&&n.getExpressions().length>0&&o.push({validator:t,sheet:this});return o}}),p.extend(r.Workbook.prototype,{tja:function(){var e=[];return this.sheets.forEach((function(t){var n=t.tja();n&&n.length&&n.forEach((function(t){e.push(t)}))})),e}}),p.extend(r.CellRange.prototype,{validator:function(e){var t=this,n=t.sheet,o=t.sheetArea,r=t.row,i=t.col,a=t.rowCount,s=t.colCount;return 0===arguments.length?n.getDataValidator(r,i,o):(n.setDataValidator(r,i,a,s,e,o),t)}}),j=function(){function e(e){this.WS=e,this.Dja={},this.Eja={},this.SAb=[]}return e.prototype.no=function(){this.WS=d},e.prototype.UV=function(e){return function(e,t){if(e&&t&&t.length)return t.map(W.bind(e))}(this.WS,e)},e.prototype.EW=function(e){return U(this.WS,e)},e.prototype.QV=function(e){var t,n,o=this,r=o.Dja;if(o.Eja={},r)for(t in r)(n=r[t])&&(e&&delete n.yja,o.FW(n,!0));o.Fja()},e.prototype.RAb=function(e){var t=this.SAb;-1===t.indexOf(e)&&t.push(e)},e.prototype.FW=function(e,t){var n=this,o=n.UV(e.l1()),r=n.WS,i=r.getRowCount(),a=r.getColumnCount();o&&(n.SAb.length=0,o.forEach((function(t){!function(e,t,n,o,r){var i,a,s,l,u,c,f=o.Eja,h=e.row,p=e.col,d=e.rowCount,g=e.colCount;for(h+d-1>=t&&(d=t-h),p+g-1>=n&&(g=n-p),i=0,a=h;i<d;i++,a++)for((s=f[a])||(f[a]=s={}),l=0,u=p;l<g;l++,u++)(c=s[u])&&c!==r&&c.IW(e,o),s[u]=r}(t,i,a,n,e)})),t||n.Fja())},e.prototype.GW=function(e){var t=this,n=t.UV(e.l1());t.SAb.length=0,n.forEach((function(e){Z(e,t)})),t.Fja()},e.prototype.HW=function(e){var t=this;e&&Z(t.WS.Tq(e),t),t.Fja()},e.prototype.Fja=function(){var e,t=this.SAb;t.length&&(e=this.Dja,t.forEach((function(t){t.l1().length?t.condition()&&t.condition().ranges(t.l1()):(delete e[t.id],delete t.kj)})),t.length=0)},e.prototype.Bja=function(e,t){var n=this,o=n.WS;if(t&&(e.kj&&o!==e.kj&&(e=e.clone(o)),e.kj=o,e.xja(t)),o)return e.context(o),n.Dja[e.id]=e,n.FW(e),e},e.prototype.Cja=function(e){if(e){var t=this.WS;this.HW(e),t.$p()}},e.prototype.$b=function(){var e=this;e.WS&&(e.Dja={},e.QV())},e.prototype.Aja=function(e,t){var n,o,r,i=this,a=i.Dja;return 0===arguments.length?q(a):(n=[],o=i.Eja,e===g&&(e=-1),t===g&&(t=-1),-1===e&&-1===t?q(a):(-1!==e&&-1!==t?(r=o[e])&&r[t]&&n.push(r[t]):-1===e?p.each(o,(function(e,o){var r=o[t];r&&-1===n.indexOf(r)&&n.push(r)})):(r=o[e])&&p.each(r,(function(e,t){t&&-1===n.indexOf(t)&&n.push(t)})),n))},e.prototype._V=function(e,t,n,o){var r,i,a=this.Dja;if(a)for(r in a)(i=a[r])&&(n?i.rI(e,t,o):i.tI(e,t,o));this.QV()},e.prototype.rI=function(e,t,n){this._V(e,t,!0,n)},e.prototype.tI=function(e,t,n){this._V(e,t,!1,n)},e.prototype.aW=function(e,t,n){var o,r,i=this.Dja;if(i)for(o in i)(r=i[o])&&(n?r.GR(e,t):r.HR(e,t),0===r.n5.length&&(i[o]=g));this.QV()},e.prototype.GR=function(e,t){this.aW(e,t,!0)},e.prototype.HR=function(e,t){this.aW(e,t,!1)},e.prototype.toJSON=function(e){var t,n,o=this.Dja,r=[];for(t in o)(n=o[t])&&r.push(n.toJSON(e));return r},e.prototype.fromJSON=function(e,t,n){var o=this,r=o.WS;o.Dja={},e&&e.length&&(e.forEach((function(e){var i=new E;i.fromJSON(e,t,n),i.kj=r,o.Dja[i.id]=i})),o.QV())},e.prototype.vja=function(e,t,n){this.WS.setDataValidator(e,t,n)},e}(),p.extend(r.lUa.prototype,{zVa:function(){var e,t,n,o,r,i=this.zTa;if(i&&!i.AVa){for(n in t=[],e=this.uja.Dja)(o=e[n])&&(r=o.n5.map((function(e){return C(e.row,e.col,e.rowCount,e.colCount)})),t.push({validator:o,ranges:r}));i.AVa=t}},BVa:function(e){var t,n;e&&(t=this.uja,n={},e.forEach((function(e){var t=e.validator;t.n5=e.ranges,t.condition()&&t.condition().ranges(t.n5),n[t.id]=t})),t.Dja=n,t.QV(!1))},CVa:function(e,t,n){this.zVa(),this.uja.rI(e,t,n)},DVa:function(e,t){this.zVa(),this.uja.GR(e,t)},EVa:function(e,t,n){this.zVa(),this.uja.tI(e,t,n)},FVa:function(e,t){this.zVa(),this.uja.HR(e,t)},GVa:function(e){this.zVa(),this.uja.HW(e)},HVa:function(){this.zVa(),this.uja.QV()}}),r.lUa.$n("validator",{init:function(){this.uja=new j(this.kj)},undo:function(e){var t=e.AVa;t&&this.BVa(t)},dispose:function(e){!1!==(e&&e.clearCache)&&this.uja&&(this.uja.no(),this.uja=d)}}),r.Worksheet.$n("validator",{init:function(){var e=this;e.uja=e._modelManager.uja,e._unbind(r.Events.FloatingElementSelected+M),e._bind(r.Events.FloatingElementSelected+M,(function(t,n){"worksheet"!==n.type&&e.hm()}))},dispose:function(e){var t=this;t.hm(),e.clearCache&&t.uja.$b(),!1!==e.clearCache&&t._unbind(r.Events.FloatingElementSelected+M)},onLayoutChanged:function(e){var t=e.changeType,n=e.row,o=e.rowCount,r=e.col,i=e.colCount,a=e.sheetArea,s=this._modelManager,l=this.tables;"addRows"===t?s.CVa(n,o,l&&l.KFc(n,-1,o,-1,!0)):"deleteRows"===t?s.DVa(n,o):"addColumns"===t?s.EVa(r,i,l&&l.KFc(-1,r,-1,i,!1)):"deleteColumns"===t?s.FVa(r,i):"clear"===t?3===a&&2==(2&e.type)&&s.GVa(C(n,r,o,i)):"setColumnCount"!==t&&"setRowCount"!==t||3!==a&&1!==a||s.HVa()},toJson:function(e,t){var n,o=this.uja,r=t&&t.ignoreStyle;o&&!r&&((n=o.toJSON(this))&&n.length&&(e.validations=n))},fromJson:function(e,t,n){var o,r=n&&n.ignoreStyle;e&&e.validations&&!r&&(o=e.validations,this.uja.fromJSON(o,t,this))}}),r.Style.$n("validator",{fromJson:function(e){if("validator"===e.p){var t=new E;t.fromJSON(e.v,e.noSchema,e.context),this.validator=t,e.r=!0}}}),R.Yl.km.push((function(e,t){!t&&e.hm&&e.hm()}))},"./node_modules/process/browser.js":function(e,t){var n,o,r,i,a,s,l=e.exports={};function u(){throw Error("setTimeout has not been defined")}function c(){throw Error("clearTimeout has not been defined")}function f(e){if(n===setTimeout)return setTimeout(e,0);if((n===u||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function h(){i&&a&&(i=!1,a.length?r=a.concat(r):s=-1,r.length&&p())}function p(){var e,t;if(!i){for(e=f(h),i=!0,t=r.length;t;){for(a=r,r=[];++s<t;)a&&a[s].run();s=-1,t=r.length}a=null,i=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function g(){}!function(){try{n="function"==typeof setTimeout?setTimeout:u}catch(e){n=u}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(e){o=c}}(),r=[],i=!1,s=-1,l.nextTick=function(e){var t,n=Array(arguments.length-1);if(arguments.length>1)for(t=1;t<arguments.length;t++)n[t-1]=arguments[t];r.push(new d(e,n)),1!==r.length||i||f(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=g,l.addListener=g,l.once=g,l.off=g,l.removeListener=g,l.removeAllListeners=g,l.emit=g,l.prependListener=g,l.prependOnceListener=g,l.listeners=function(e){return[]},l.binding=function(e){throw Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(e){throw Error("process.chdir is not supported")},l.umask=function(){return 0}},"./node_modules/util/node_modules/inherits/inherits_browser.js":function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},"./node_modules/util/support/isBufferBrowser.js":function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},"./node_modules/util/util.js":function(e,t,n){(function(e){var o,r,i,a,s=Object.getOwnPropertyDescriptors||function(e){var t,n=Object.keys(e),o={};for(t=0;t<n.length;t++)o[n[t]]=Object.getOwnPropertyDescriptor(e,n[t]);return o},l=/%[sdj%]/g;function u(e,n){var o={seen:[],stylize:f};return arguments.length>=3&&(o.depth=arguments[2]),arguments.length>=4&&(o.colors=arguments[3]),y(n)?o.showHidden=n:n&&t.Ia(o,n),w(o.showHidden)&&(o.showHidden=!1),w(o.depth)&&(o.depth=2),w(o.colors)&&(o.colors=!1),w(o.customInspect)&&(o.customInspect=!0),o.colors&&(o.stylize=c),h(o,e,o.depth)}function c(e,t){var n=u.styles[t];return n?"["+u.colors[n][0]+"m"+e+"["+u.colors[n][1]+"m":e}function f(e,t){return e}function h(e,n,o){var r,i,a,s,l,u,c,f,y;if(e.customInspect&&n&&T(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n))return C(r=n.inspect(o,e))||(r=h(e,r,o)),r;if(i=p(e,n))return i;if(a=Object.keys(n),s=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(a),e.showHidden&&(a=Object.getOwnPropertyNames(n)),S(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return d(n);if(0===a.length){if(T(n))return l=n.name?": "+n.name:"",e.stylize("[Function"+l+"]","special");if(x(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(M(n))return e.stylize(Date.prototype.toString.call(n),"date");if(S(n))return d(n)}return u="",c=!1,f=["{","}"],m(n)&&(c=!0,f=["[","]"]),T(n)&&(u=" [Function"+(n.name?": "+n.name:"")+"]"),x(n)&&(u=" "+RegExp.prototype.toString.call(n)),M(n)&&(u=" "+Date.prototype.toUTCString.call(n)),S(n)&&(u=" "+d(n)),0!==a.length||c&&0!=n.length?o<0?x(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),y=c?function(e,t,n,o,r){var i,a,s=[];for(i=0,a=t.length;i<a;++i)k(t,i+"")?s.push(g(e,t,n,o,i+"",!0)):s.push("");return r.forEach((function(r){r.match(/^\d+$/)||s.push(g(e,t,n,o,r,!0))})),s}(e,n,o,s,a):a.map((function(t){return g(e,n,o,s,t,c)})),e.seen.pop(),function(e,t,n){return e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(y,u,f)):f[0]+u+f[1]}function p(e,t){if(w(t))return e.stylize("undefined","undefined");if(C(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return b(t)?e.stylize(""+t,"number"):y(t)?e.stylize(""+t,"boolean"):v(t)?e.stylize("null","null"):void 0}function d(e){return"["+Error.prototype.toString.call(e)+"]"}function g(e,t,n,o,r,i){var a,s,l;if((l=Object.getOwnPropertyDescriptor(t,r)||{value:t[r]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),k(o,r)||(a="["+r+"]"),s||(e.seen.indexOf(l.value)<0?(s=v(n)?h(e,l.value,null):h(e,l.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),w(a)){if(i&&r.match(/^\d+$/))return s;(a=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function m(e){return Array.isArray(e)}function y(e){return"boolean"==typeof e}function v(e){return null===e}function b(e){return"number"==typeof e}function C(e){return"string"==typeof e}function w(e){return void 0===e}function x(e){return A(e)&&"[object RegExp]"===N(e)}function A(e){return"object"==typeof e&&null!==e}function M(e){return A(e)&&"[object Date]"===N(e)}function S(e){return A(e)&&("[object Error]"===N(e)||e instanceof Error)}function T(e){return"function"==typeof e}function N(e){return Object.prototype.toString.call(e)}function I(e){return e<10?"0"+e.toString(10):e.toString(10)}function R(){var e=new Date,t=[I(e.getHours()),I(e.getMinutes()),I(e.getSeconds())].join(":");return[e.getDate(),i[e.getMonth()],t].join(" ")}function k(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function E(e,t){if(!e){var n=Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.format=function(e){var t,n,o,r,i,a;if(!C(e)){for(t=[],n=0;n<arguments.length;n++)t.push(u(arguments[n]));return t.join(" ")}for(n=1,r=(o=arguments).length,i=(e+"").replace(l,(function(e){if("%%"===e)return"%";if(n>=r)return e;switch(e){case"%s":return o[n++]+"";case"%d":return+o[n++];case"%j":try{return JSON.stringify(o[n++])}catch(e){return"[Circular]"}default:return e}})),a=o[n];n<r;a=o[++n])i+=v(a)||!A(a)?" "+a:" "+u(a);return i},t.deprecate=function(n,o){if(void 0!==e&&!0===e.noDeprecation)return n;if(void 0===e)return function(){return t.deprecate(n,o).apply(this,arguments)};var r=!1;return function(){if(!r){if(e.throwDeprecation)throw Error(o);e.traceDeprecation?console.trace(o):console.error(o),r=!0}return n.apply(this,arguments)}},o={},t.debuglog=function(n){if(w(r)&&(r=e.env.NODE_DEBUG||""),n=n.toUpperCase(),!o[n])if(RegExp("\\b"+n+"\\b","i").test(r)){var i=e.pid;o[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,i,e)}}else o[n]=function(){};return o[n]},t.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=m,t.isBoolean=y,t.isNull=v,t.isNullOrUndefined=function(e){return null==e},t.isNumber=b,t.isString=C,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=w,t.isRegExp=x,t.isObject=A,t.isDate=M,t.isError=S,t.isFunction=T,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n("./node_modules/util/support/isBufferBrowser.js"),i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t.log=function(){console.log("%s - %s",R(),t.format.apply(t,arguments))},t.inherits=n("./node_modules/util/node_modules/inherits/inherits_browser.js"),t.Ia=function(e,t){var n,o;if(!t||!A(t))return e;for(o=(n=Object.keys(t)).length;o--;)e[n[o]]=t[n[o]];return e},a="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0,t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(a&&e[a]){var t;if("function"!=typeof(t=e[a]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,a,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){var t,n,o,r=new Promise((function(e,o){t=e,n=o})),i=[];for(o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,o){e?n(e):t(o)}));try{e.apply(this,i)}catch(t){n(t)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),a&&Object.defineProperty(t,a,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,s(e))},t.promisify.custom=a,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){var n,o,r,i,a=[];for(n=0;n<arguments.length;n++)a.push(arguments[n]);if("function"!=typeof(o=a.pop()))throw new TypeError("The last argument must be of type Function");r=this,i=function(){return o.apply(r,arguments)},t.apply(this,a).then((function(t){e.nextTick(i,null,t)}),(function(t){e.nextTick(E,t,i)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,s(t)),n}}).call(this,n("./node_modules/process/browser.js"))},"./node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"./node_modules_local/@grapecity/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js":function(e,t,n){var o="object"==typeof o?o:{};o.Spread=o.Spread||{},o.Spread.CalcEngine=o.Spread.CalcEngine||{},o.Spread.CalcEngine.AdvancedFunctions=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){var o,r;if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;if(o=Object.create(null),n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/assets/",n(n.s="./src/advancedFunctions.entry.ts")}({"./src/advancedFunctions.entry.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("CalcEngine");t.Functions=o.Functions,n("./src/functions-db.ts"),n("./src/functions-eng.ts"),n("./src/functions-fin.ts"),n("./src/functions-lookup.ts"),n("./src/functions-stat.ts")},"./src/functions-db.ts":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x;function A(e,t,n,o){for(var r,i=0,a=new b(e,t,n);a.Pk();)r=a.Ok(),(r=o?s(r):r)&&i++;return u(i)}function M(e,t,n,o,r,i,h){for(var p,g,m,y,v=h?1:0,C=0,w=0,x=new b(e,t,n);x.Pk();)if(p=x.Ok(),s(p)){if(g=a(p),d(g))return f;v=h?v*g:v+g,C+=g*g,w++}else if(l(p))return p;return i||h?u(v):(m=Math.max(0,(w*C-v*v)/(w*(w-r))),y=o?Math.sqrt(m):m,w<=1?c:u(y))}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Common"),r=n("CalcEngine"),i=o.Common.q,a=r.Convert.Pa,s=r.Convert.Na,l=r.Convert.vf,u=r.Convert.Nh,c=r.Errors.DivideByZero,f=r.Errors.Value,h=r.Functions.ak,p=r.Functions.jk,d=isNaN,g=o.Common.u,m=g.kb,y=r.sR().Exp_InvalidCast,v=function(){function e(e,t,n){this.Gk=e,this.Hk=t,this.Wob=n}return e.prototype.Ik=function(e){var t=r.evaluateOperator({"=":9,"<>":10,"<":11,"<=":12,">":13,">=":14}[this.Gk],e,this.Hk);return!!r.Functions.ik(t)&&r.Convert.Vh(t)},e}(),b=function(){function e(e,t,n){var o=this;if(o.cj=0,o.Jk=e,o.Kk=n,o.Xob={},3===arguments.length){if(o.Lk=o.Mk(e,t),e.rowCount<2||e.colCount<1||n.rowCount<2||n.colCount<1||o.Lk<0||o.Jk.colCount<=o.Lk)throw y}else if(2===arguments.length&&(o.Lk=-1,e.rowCount<2||e.colCount<1||n.rowCount<2||n.colCount<1))throw y}return e.prototype.Mk=function(e,t){var n,o;if(p(t)){for(n=0;n<e.colCount;n++)if((o=r.Convert.bc(e[0][n]))&&this.Nk(o,t))return n;return-1}return r.Convert.Rh(t)-1},e.prototype.Ok=function(){var e=this;if(e.cj<=0||e.Jk.rowCount<=e.cj)throw r.sR().Exp_InvalidOperation;return e.Jk[e.cj][e.Lk]},e.prototype.Pk=function(){for(var e=this,t=!1,n=e.Jk.rowCount;!t&&e.cj<n;)e.cj++,e.cj<n&&(t=e.Qk());return t},e.prototype.Rk=function(e){var t,n,i,a,s;if(p(e)){for(t=["=","<>","<=",">=","<",">"],n=r.Convert.bc(e),i=void 0,a=void 0,i=0;i<t.length;i++)if(o.Common.u.kb(n,t[i]))return n=n.substring(t[i].length),s=o.Common.o.lb(n),d(s)?this.Nk("true",n)?e=!0:this.Nk("false",n)?e=!1:(e=n,a=0===i):e=s,new v(t[i],e,a);return new v("=",e)}return e?new v("=",e):null},e.prototype.Yob=function(e,t){var n,o=this,r=o.Xob,i=function(e,t){return[e,t].join(",")}(e,t),a=r[i];return a||(r[n="_"+i]||(a=r[i]=o.Rk(o.Kk[e][t]),r[n]=!0)),a},e.prototype.Qk=function(){var e,t,n,o,r,a,s,l,u,c=this,f=!1,h=c.Kk,d=c.cj,g=h.rowCount,y=h.colCount,v=c.Jk,b=c.Zob;if(!b){for(o=h[0],b=[],t=0;t<y;t++){if((n=c.Mk(v,o[t]))<0)return!1;b[t]=n}c.Zob=b}for(e=1;!f&&e<g;e++)for(f=!0,t=0;f&&t<y;t++)if(r=c.Yob(e,t)){if(a=v[d][b[t]],"="===r.Gk&&(s=r.Hk,p(s)&&p(a))){l=i.ub(s,!0),u=r.Wob,f=l?i.sb("^"+l+(u?"$":"")).test(a):u?a.toLowerCase()===s.toLowerCase():m(a,s,!0);continue}f=r.Ik(a)}return f},e.prototype.Nk=function(e,t){return e.toLowerCase()===t.toLowerCase()},e}(),h("DAVERAGE",(function(e,t,n){for(var o,i,a=0,h=0,p=new b(e,t,n);p.Pk();){if(o=p.Ok(),l(o))return o;if(s(o)){if(i={value:0},!r.Convert.Th(o,i))return f;a+=i.value,h++}}return 0===h?c:u(a/h)}),3,3,x=[w={Yi:!0,Hi:4,Ii:0},{Yi:!0},w],C="!= 1",C),h("DCOUNT",(function(e,t,n){return A(e,t,n,!0)}),3,3,x,C,C),h("DCOUNTA",(function(e,t,n){return A(e,t,n,!1)}),3,3,x,C,C),h("DGET",(function(e,t,n){var o,i=new b(e,t,n);return i.Pk()?(o=i.Ok(),i.Pk()?r.Errors.Number:o):f}),3,3,x,C,C),h("DMAX",(function(e,t,n){for(var o,i,c=!1,h=-r.Functions.hk,p=new b(e,t,n);p.Pk();){if(o=p.Ok(),l(o))return o;if(s(o)){if(i=a(o),d(i))return f;(!c||i>h)&&(h=i),c=!0}}return c?u(h):0}),3,3,x,C,C),h("DMIN",(function(e,t,n){for(var o,i,c=!1,h=r.Functions.hk,p=new b(e,t,n);p.Pk();){if(o=p.Ok(),l(o))return o;if(s(o)){if(i=a(o),d(i))return f;(!c||o<h)&&(h=o),c=!0}}return c?u(h):0}),3,3,x,C,C),h("DPRODUCT",(function(e,t,n){return M(e,t,n,!1,0,!1,!0)}),3,3,x,C,C),h("DSTDEV",(function(e,t,n){return M(e,t,n,!0,1)}),3,3,x,C,C),h("DSTDEVP",(function(e,t,n){return M(e,t,n,!0,0)}),3,3,x,C,C),h("DSUM",(function(e,t,n){return M(e,t,n,!1,0,!0)}),3,3,x,C,C),h("DVAR",(function(e,t,n){return M(e,t,n,!1,1)}),3,3,x,C,C),h("DVARP",(function(e,t,n){return M(e,t,n,!1,0)}),3,3,x,C,C)},"./src/functions-eng.ts":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe,re,ie,ae,se,le,ue,ce,fe,he,pe,de,ge,me,ye,ve,be,Ce,we,xe,Ae,Me,Se,Te,Ne,Ie,Re,ke,Ee,De,je,_e,Oe,Fe,Pe,He,Be,Le,ze;function Ve(e,t){return new r.Functions.Ui(e,t)}function Ge(e,t){return{Ld:e,Sk:t}}function We(e,t){var n,o=[];for(n=0;n<i(e);n++)o.push(Ge(e[n],t[n]));return o.push(Ge(null,0)),o}function Ue(e,t,n){var o,i,a,s,l,u,c,f=100,p=.5*e,d=p*p;for(p=h(p,m(t)),o=r.Functions.tk(t),i=1,a=0,s=m(t),u=.9*(l=p/o),c=!1;l!==u&&0!==f;)p*=d,o*=++a,i*=++s,u=l,l=n||c?l+p/o/i:l-p/o/i,f--,c=!c;return l}function Ze(e,t){var n=h(t,10),o=parseInt(e,t);return y(o)?b:n/2<=o?o-n:o}function qe(e,t,n){e<0&&(e+=h(t,10));var o,r=e.toString(t),a=n-i(r);for(o=0;o<a;o++)r="0"+r;return r.toUpperCase()}function Je(e,t){var n=Ze(e,t);return M(n)?b:n}function Qe(e,t,n){var o=qe(e,n,t.Qb);return 0<=o&&t.Qb<i(o)&&t.$i?b:o}function Ye(e,t,n,o,r){var a,s=Ze(e,n);return M(s)||r&&(s<-r||r-1<s)?b:(a=qe(s,o,t.Qb),0<=s&&t.Qb<i(a)&&t.$i?b:a)}function Ke(e,t){var n=Number.POSITIVE_INFINITY,o=e.Pi(),r=e.Qi();return y(o)||o===n||y(r)||r===n?b:e.bc(t)}function $e(e,t,n,o){var r=e,i=t,a=n.Pi(),s=n.Qi();return{Ri:e=o?r*a-i*s:r+a,Si:t=o?r*s+i*a:i+s}}function Xe(e,t){var n,o,a,s,l,u,c,f,h=t?1:0,p=0;for(o=0;o<i(e);o++)if(r.Convert.Ca(e[o]))for(c=e[o],a=0;a<c.rowCount;a++)for(s=0;s<c.columnCount;s++){if(!(n=N(c.getValue(a,s))))return b;h=(u=$e(h,p,n,t)).Ri,p=u.Si}else if(r.Convert._isReference(e[o]))for(f=e[o],l=0;l<f.getRangeCount();l++)for(a=0;a<f.getRowCount(l);a++)for(s=0;s<f.getColumnCount(l);s++){if(!(n=N(f.getValue(l,a,s))))return b;h=(u=$e(h,p,n,t)).Ri,p=u.Si}else{if(!(n=N(e[o])))return b;h=(u=$e(h,p,n,t)).Ri,p=u.Si}return Ke(Ve(h,p))}function et(e,t){var n=x(e*c(2)),o=2*n-1;return t.$i&&(o=2*(n=x(t.Qb*c(2)))-1-o),o}function tt(e){return 1-et(e,{$i:!1})}function nt(e){var t,n=["cup","mmHg","J","sec","cel","kel","hh","Wh","wh","flb","BTU"];for(t=0;n[t];t++)if(0===e.localeCompare(n[t]))return!1;return!0}function ot(e,t,n){var o,r,a=0,s=1;for(o=0;e[o].Ld;o++)if(0===n.localeCompare(e[o].Ld))return{Tk:!0,Uk:s,Vk:a=e[o].Sk};if(t)for(o=0;t[o].Ld;o++)n.substr(0,1)===t[o].Ld.substr(0,1)&&nt(n)&&(s=t[o].Sk);for(o=0;e[o].Ld;o++)if(r=i(e[o].Ld),n.substr(1,r)===e[o].Ld.substr(0,r)&&nt(n))return{Tk:!0,Uk:s,Vk:a=e[o].Sk};return{Tk:!1,Uk:s,Vk:a}}function rt(e){if(ke.indexOf(e)>=0)return!1;var t=[e.slice(0,1),e.slice(1)],n=t[0],o=t[1];return Ne.indexOf(n)>=0&&ke.indexOf(o)>=0}function it(e){for(var t=0;t<W.length;t++)if(e===W[t].Ld)return!0;return"sec"===e.slice(1)||"s"===e.slice(1)}function at(e){var t,n,o,r,i,a,s;if(e.indexOf(Ae.bit)>-1?(o=(t=[e.slice(0,-3),e.slice(-3)])[0],i=t[1]):e.indexOf(Ae.byte)>-1&&(o=(n=[e.slice(0,-4),e.slice(-4)])[0],i=n[1]),o)for(s=0;Re[s].Ld;s++)o===Re[s].Ld&&(r=Re[s].Sk);else r=1;return i===Ae.bit?a=xe[0].Sk:i===Ae.byte&&(a=xe[1].Sk),{Uk:r,Vk:a}}function st(e){var t,n,o=1;if(Me[e])return{unit:e,prefixNumber:o};if("K"===Me[e.slice(1)]||"kel"===Me[e.slice(1)]){for(t=e.slice(0,1),e=e.slice(1),n=0;Ie[n].Ld;n++)t===Ie[n].Ld&&(o=Ie[n].Sk);return{unit:e,prefixNumber:o}}return{unit:void 0,prefixNumber:o}}function lt(e,t,n,o){var r,i;if(""===e&&""===t)return C;if(i={value:0},!0===R(e,r={value:0})&&!0===R(t,i)){if(t=i.value,(e=r.value)<0||e>I||e%1!=0)return b;if("bitOperator"===n){if(t<0||t>I||t%1!=0)return b}else if("shiftOperator"===n&&0===e)return 0;return o(e,t)}return C}function ut(e,t){if(""===e)return b;if(!0===e||!1===e)return C;var n=N(e);return n?t(n):b}function ct(e){var t=e.Pi(),n=e.Qi();return Ve(l(t)*T(n,!1),u(t)*T(n,!0))}function ft(e){var t=e.Pi(),n=e.Qi();return Ve(u(t)*T(n,!1),-l(t)*T(n,!0))}function ht(e){var t=e.Pi(),n=e.Qi();return Ve(T(t,!0)*u(n),T(t,!1)*l(n))}function pt(e){var t=e.Pi(),n=e.Qi();return Ve(T(t,!1)*u(n),T(t,!0)*l(n))}function dt(e,t){var n,o,r=e.Pi(),i=e.Qi(),a=t.Pi(),s=t.Qi();return Math.abs(s)<Math.abs(a)?Ve((r+i*(n=s/a))/(a+s*n),(i-r*n)/(a+s*n)):Ve((i+r*(o=a/s))/(s+a*o),(i*o-r)/(s+a*o))}function gt(e,t){return e.Pi()===t.Pi()&&e.Qi()===t.Qi()}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Common"),r=n("CalcEngine"),i=o.Common.k.ac,a=void 0,s=Math.abs,l=Math.sin,u=Math.cos,c=Math.sqrt,f=Math.log,h=Math.pow,p=Math.exp,d=Math.E,g=Math.atan2,m=parseFloat,y=isNaN,v=r.Errors.NotAvailable,b=r.Errors.Number,C=r.Errors.Value,w=r.Functions.ak,x=r.Functions.qk,A=r.Convert.Nh,M=r.Convert.vf,S=r.Functions.MathHelper,T=S.Dk,N=r.Functions.Wi,I=0xffffffffffff,R=r.Convert.Th,k=Ve(1,0),E=.00220462262184878,O=We(["g","sg","lbm","u","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","ton","uk_ton","LTON","brton"],[1,685217658567918e-19,E,602214179421676e9,.0352739619495804,15.432358352941462,D=E/100,D,j=E/112,j,j,.00015747304441777001,110231131092439e-20,_=E/2240,_,_]),H=(P=(F=1e4/254)/12)/3,L=We(["m","mi","Nmi","in","ft","yd","ang","Pica","ell","ly","pc","pica","survey_mi","parsec","Picapt"],[1,.000621371192237334,1/1852,F,P,H,1e10,2834.64566929134,.8748906386701663,105700083402462e-30,B=324077928966473e-31,236.2204724409449,.00062136994949495,B,2834.64566929134]),W=We(["yr","day","hr","mn","sec","d","min","s"],[1,z=365.25,8766,V=525960,G=60*V,z,V,G]),U=We(["Pa","atm","mmHg","p","at","psi","Torr"],[1,986923266716013e-20,.007500637554192,1,986923266716013e-20,.000145037737730209,.0075006168270417]),Z=We(["N","dyn","lbf","dy","pond"],[1,1e5,.22480894309971,1e5,101.971621297793]),J=We(["HP","W","h","w","PS"],[1,q=745.69987158227,1,q,1.013869665424]),X=We(["J","e","c","cal","eV","HPh","Wh","flb","BTU","ev","hh","wh","btu"],[1,1e-7,$=.239005736137667,$,Q=624150964712042e4,Y=1/(3600*q),1/3600,.737562149277265,K=.000947817120313317,Q,Y,1/3600,K]),ee=We(["T","ga"],[1,1e4]),he=We(["tsp","tspm","tbs","oz","cup","pt","qt","uk_qt","gal","uk_gal","l","uk_pt","us_pt","lt","ang3","ang^3","barrel","bushel","ft3","ft^3","in3","in^3","ly3","ly^3","m3","m^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Pica3","Pica^3","Picapt3","Picapt^3","GRT","regton","MTON","L"],[1,.98578431875,1/3,1/6,1/48,1/96,1/192,.00433684471160932,1/768,.00108421117790233,te=.00492892159375,.00867368942321863,1/96,te,ne=492892159375e13,ne,1/32256,.000139870932189991,oe=.00017406322338,oe,re=.30078125,re,ie=82073596535e-54,ie,ae=492892159375e-17,ae,se=118251117638e-26,se,le=64467860511e-16,le,ue=775941468987e-27,ue,ce=112266,ce,ce,ce,fe=1740632233796e-18,fe,4351580584491e-18,te]),pe=We(["admkn","kn","m/h","m/hr","m/s","m/sec","mph"],[1,1.00063930885529,1853.184,1853.184,.514773333333333,.514773333333333,1.15151515151515]),we=We(["m2","m^2","ft2","ft^2","in2","in^2","yd2","yd^2","uk_acre","us_acre","ang2","ang^2","ar","ha","Morgen","mi2","mi2","Nmi2","Nmi^2","Pica2","Picapt2","Pica^2","Picapt^2","ly2","ly^2"],[1,1,de=10.7639104167097,de,ge=144*de,ge,me=de/9,me,.000247105381467165,.000247104393046628,1e20,1e20,.01,1e-4,4e-4,ye=me/3097600,ye,ve=2.91553349598123e-7,ve,be=8035216.07043214,be,be,be,Ce=111725076312873e-46,Ce]),xe=We(["bit","byte"],[1,.125]),Ae={bit:"bit",byte:"byte"},Me={K:"K",kel:"kel",cel:"cel",C:"C",F:"F",fah:"fah",Rank:"Rank",Reau:"Reau"},Se=273.15,Te=459.67,Ie=We(Ne=["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24]),Re=We(["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y","Yi","Zi","Ei","Pi","Ti","Gi","Mi","ki"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24,Math.pow(2,80),Math.pow(2,70),Math.pow(2,60),Math.pow(2,50),Math.pow(2,40),Math.pow(2,30),Math.pow(2,20),Math.pow(2,10)]),ke=["sg","lbm","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","uk_ton","lcwt","hweight","stone","uk_ton","LTON","brton","ton","mi","Nmi","in","ft","yd","ell","Pica","survey_mi","Picapt","psi","Torr","lbf","HP","h","PS","HPh","flb","BTU","hh","btu","tsp","tspm","tbs","oz","cup","pt","us_pt","uk_pt","qt","UK_qt","gal","uk_gal","barrel","bushel","ft3","ft^3","in3","in^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Picapt3","Picapt^3","Pica3","Pica^3","GRT","regton","MTON","kn","admkn","uk_acre","us_acre","ft2","ft^2","in2","in^2","ly2","ly^2","Morgen","mi2","mi^2","Nmi2","Nmi^2","Pica2","Picapt^2","Pica^2","Picapt^2","yd2","yd^2"],De={Hi:5},Fe={Hi:8},Pe={Hi:8,Oi:!0},Be=[{Hi:0,aj:"<= 0"},Oe={Hi:2,aj:"< 0"}],Le=[Ee={Hi:0},{Hi:0,_i:0}],ze=[je={Hi:5,aj:["checkLength 10"]},_e={Zi:!0,Hi:2,_i:1,aj:["< 1","> 10"]}],w("BESSELI",(function(e,t){return A(Ue(e,t,!0))}),2,2,He=[Ee,Oe]),w("BESSELJ",(function(e,t){return A(Ue(e,t,!1))}),2,2,He),w("BESSELK",(function(e,t){var n,o,r,i,a,l,u,c,h,p=17976931348623157e292,d=.5772156649015329,g=0,m=.25*e*e,y=1,v=0,b=1,C=2/e;if(t>0){for(v=-d,i=1;i<t;i++)v+=1/i,y*=i+1;if(b=C,1===t)g=1/e;else{for(l=1,u=1,n=a=y/t,i=1;i<t;i++){if(n+=o=(a/=t-i)*(u*=-m)/(l*=i),p-s(o)<s(n)||C>1&&p/C<b)return p;b*=C}if(o=s(n*=.5),b>1&&p/b<o||o>1&&p/o<b)return p;g=n*b}}h=-d,0===t?(v=h,o=1):(v+=1/t,o=1/y),n=(h+v-(c=2*f(e/2)))*o,r=1;do{n+=((h+=1/r)+(v+=1/(r+t))-c)*(o*=m/(r*(r+t))),r++}while(s(o/n)>11102230246251565e-32);return n=.5*n/b,0!=(1&t)&&(n=-n),A(g+=n)}),2,2,Be),w("BESSELY",(function(e,t){var n=[.0007969367292973471,.08283523921074408,1.239533716464143,5.447250030587687,8.74716500199817,5.303240382353949,1],o=[.0007621256162081731,.07313970569409176,1.1271960812968493,5.112079511468076,8.424045901417724,5.214515986823615,1],r=[.0009244088105588637,.08562884743544745,1.2535274390105895,5.470977403304171,8.761908832370695,5.306052882353947,1],i=[.0005713231280725487,.06884559087544954,1.105142326340617,5.073863861286015,8.399855543276042,5.209828486823619,1],a=[-.011366383889846916,-1.2825271867050931,-19.553954425773597,-93.20601521237683,-177.68116798048806,-147.07750515495118,-51.41053267665993,-6.050143506007285],s=[.05108625947501766,4.982138729512334,75.82382841325453,366.7796093601508,710.8563049989261,597.4896124006136,211.68875710057213,25.207020585802372],h=[64.3178256118178,856.4300259769806,3882.4018360540163,7240.467741956525,5930.727011873169,2062.0933166032783,242.0057402402914],p=[74.23732770356752,1056.4488603826283,4986.410583376536,9562.318924047562,7997.041604473507,2826.1927851763908,336.0936078106983],d=[15592.436785523574,-14663929.59039716,5435264770.518765,-982136065717.9115,87590639439536.7,-0xc5090e8ec6601,0x9d4a5b305a0018,-0x41b52d6418d9ec],g=[1263204747.9017804,-647355876379.1603,114509511541823.73,-8127702555013251,0x2cf35a16e6cd620,-0xacf20aeef158b80],y=[1041.2835366425984,626107.330137135,268919633.39381415,86400248710.3935,20297961275010.555,3171577528429750.5,0x37a4bf79f36ba00],v=[594.3015923461282,235564.09294306856,73481194.44597217,18760131610.870617,3882312774962.3857,620557727146953.8,0xf41f1e2a3d2440,0x3721e321ece8fe00],b=[-4794432209.782018,1956174919465.5657,-249248344360967.72,9708622510473064],C=[-899971225.7055594,452228297998.19403,-72749424522181.83,0xd15a1534be241],w=[499.563147152651,173785.4016763747,48440965.83399621,11185553704.535683,2112775201154.892,310518229857422.56,0x710505f9ecba70,0x17be34c7b662cc00],x=[620.8364781180543,256987.25675774884,83514679.14319493,22151159547.97925,4749141220799.914,784369607876235.9,89522233618462740,0x49de55d9c0a4e400],M=.7978845608028654,S=2.356194490192345,T=.7853981633974483;function N(e,t,n,o){var r=0,i=m(t[r++]),a=n;o&&(i+=e,a--);do{i=i*e+m(t[r++])}while(0!=--a);return i}function I(e,t){var f,d,g,m,y,v=t?n:o,A=t?r:i,I=t?a:s,R=t?h:p,k=t?w:x;return e<=5?(d=e*e,t&&e<1e-5?1-d/4:(g=(d-(t?5.783185962946784:14.681970642123893))*(d-(t?30.471262343662087:49.2184563216946)),g*=f=N(d,t?b:C,3)/N(d,k,8,!0),t?g:g*e)):(f=5/e,g=N(d=t?25/(e*e):f*f,v,6)/N(d,A,6),m=N(d,I,7)/N(d,R,7,!0),(g=g*u(y=e-(t?T:S))-f*m*l(y))*M/c(e))}function R(e,t){var m,b,C,w,x,A=t?n:o,R=t?r:i,k=t?a:s,E=t?h:p,D=t?y:v,j=t?7:8;return e<=5?(m=(t?1:e)*N(b=e*e,t?d:g,t?7:5)/N(b,D,j,!0),m+=.6366197723675814*(t?f(e)*I(e,!0):I(e,!1)*f(e)-1/e)):(m=5/e,C=N(b=t?25/(e*e):m*m,A,6)/N(b,R,6),w=N(b,k,7)/N(b,E,7,!0),(C=C*l(x=e-(t?T:S))+m*w*u(x))*M/c(e))}return A(function(e,t){var n,o=R(e,!0),r=R(e,!1),i=1,a=2*i;if(0===t)return o;if(1===t)return r;do{n=a*r/e-o,o=r,r=n,a+=2,++i}while(i<t);return n}(e,t))}),2,2,Be),w("BIN2DEC",(function(e){return Je(e,2)}),1,1,je),w("BIN2HEX",(function(e,t){return Ye(e,t,2,16)}),1,2,ze,a,a,{bk:1}),w("BIN2OCT",(function(e,t){return Ye(e,t,2,8)}),1,2,ze,a,a,{bk:1}),w("DEC2BIN",(function(e,t){return Qe(e,t,2)}),1,2,[{Hi:0,aj:["< -512","> 511"]},_e],a,a,{bk:1}),w("DEC2HEX",(function(e,t){return Qe(e,t,16)}),1,2,[{Hi:0,aj:["< -549755813888","> 549755813887"]},_e],a,a,{bk:1}),w("DEC2OCT",(function(e,t){return Qe(e,t,8)}),1,2,[{Hi:0,aj:["< -536870912","> 536870911"]},_e],a,a,{bk:1}),w("HEX2BIN",(function(e,t){return Ye(e,t,16,2,512)}),1,2,ze,a,a,{bk:1}),w("HEX2DEC",(function(e){return Je(e,16)}),1,1,je),w("HEX2OCT",(function(e,t){return Ye(e,t,16,8,536870912)}),1,2,ze,a,a,{bk:1}),w("OCT2BIN",(function(e,t){return Ye(e,t,8,2,512)}),1,2,ze,a,a,{bk:1}),w("OCT2DEC",(function(e){return Je(e,8)}),1,1,je),w("OCT2HEX",(function(e,t){return Ye(e,t,8,16,549755813888)}),1,2,ze,a,a,{bk:1}),w("ERF",et,1,2,[Ee,{Zi:!0,Hi:0}],a,a,{bk:1}),w("ERF.PRECISE",(function(e){return et(e,{$i:!1})}),1,1,Ee),w("ERFC",tt,1,1,Ee),w("ERFC.PRECISE",tt,1,1,Ee),w("DELTA",(function(e,t){return r.Zh.Yh(e,t)?1:0}),1,2,Le,a,a,{bk:1}),w("GESTEP",(function(e,t){return e>=t?1:0}),1,2,Le,a,a,{bk:1}),w("COMPLEX",(function(e,t,n){return"i"!==n&&"j"!==n?r.Errors.Value:Ke(Ve(e,t),n)}),2,3,[Ee,Ee,{Hi:5,_i:"i"}],a,a,{bk:2}),w("IMABS",(function(e){return A(c(e.Ri*e.Ri+e.Si*e.Si))}),1,1,Fe),w("IMAGINARY",(function(e){return A(e.Si)}),1,1,Fe),w("IMARGUMENT",(function(e){return 0===e.Ri&&0===e.Si?r.Errors.DivideByZero:A(g(e.Si,e.Ri))}),1,1,Fe),w("IMCONJUGATE",(function(e){return Ke(Ve(e.Ri,-e.Si))}),1,1,Fe),w("IMCOS",(function(e){return Ke(Ve(u(e.Ri)*T(e.Si,!1),-l(e.Ri)*T(e.Si,!0)))}),1,1,Fe),w("IMDIV",(function(e,t){var n=e.Ri,o=e.Si,r=t.Ri,i=t.Si;return Ke(Ve((n*r+o*i)/(r*r+i*i),(o*r-n*i)/(r*r+i*i)))}),2,2,[Fe,Pe]),w("IMEXP",(function(e){return Ke(Ve(p(e.Ri)*u(e.Si),p(e.Ri)*l(e.Si)))}),1,1,Fe),w("IMLN",(function(e){var t=e.Ri,n=e.Si;return Ke(Ve(f(c(t*t+n*n)),g(n,t)))}),1,1,Pe),w("IMLOG10",(function(e){var t=e.Ri,n=e.Si,o=S.Ek(d,10);return Ke(Ve(o*f(c(t*t+n*n)),o*g(n,t)))}),1,1,Pe),w("IMLOG2",(function(e){var t=e.Ri,n=e.Si,o=S.Ek(d,2);return Ke(Ve(o*f(c(t*t+n*n)),o*g(n,t)))}),1,1,Pe),w("IMREAL",(function(e){return A(e.Ri)}),1,1,Fe),w("IMSIN",(function(e){return Ke(Ve(l(e.Ri)*T(e.Si,!1),u(e.Ri)*T(e.Si,!0)))}),1,1,Fe),w("IMSQRT",(function(e){var t,n,o=e.Ri,r=e.Si;return 0===o&&0===r?"0":(t=c(o*o+r*r),n=g(r,o),Ke(Ve(c(t)*u(n/2),c(t)*l(n/2))))}),1,1,Fe),w("IMSUB",(function(e,t){return Ke(Ve(e.Ri-t.Ri,e.Si-t.Si))}),2,2,[Fe,Fe]),w("IMPOWER",(function(e,t){var n,o,r=e.Ri,i=e.Si;return 0===r&&0===i?t>0?"0":b:(n=c(r*r+i*i),o=g(i,r),Ke(Ve(h(n,t)*u(t*o),h(n,t)*l(t*o))))}),2,2,[Fe,{Hi:2}]),w("IMPRODUCT",(function(){return Xe(arguments,!0)}),1,255,a,-1,-1),w("IMSUM",(function(){return Xe(arguments,!1)}),1,255,a,-1,-1),w("CONVERT",(function(e,t,n){var o,r,a,s,l,u,c,f,h,p,d;if(st(t).unit&&st(n).unit)return function(e,t,n){var o,r=st(t);switch(r.unit){case Me.Rank:o=function(e,t){var n,o=st(t);switch(o.unit){case Me.Rank:return e;case Me.Reau:return.8*(e-Te-32)*5/9;case Me.C:case Me.cel:return 5*(e-Te-32)/9;case Me.F:case Me.fah:return e-Te;case Me.K:case Me.kel:return n=o.prefixNumber,(Se+5*(e-Te-32)/9)/n}}(e,n);break;case Me.Reau:o=function(e,t){var n,o=st(t);switch(o.unit){case Me.Rank:return 1.25*e*9/5+32+Te;case Me.Reau:return e;case Me.C:case Me.cel:return 1.25*e;case Me.F:case Me.fah:return 1.25*e*9/5+32;case Me.K:case Me.kel:return n=o.prefixNumber,(1.25*e+Se)/n}}(e,n);break;case Me.C:case Me.cel:o=function(e,t){var n,o=st(t);switch(o.unit){case Me.Rank:return 9*e/5+32+Te;case Me.Reau:return.8*e;case Me.cel:case Me.C:return e;case Me.F:case Me.fah:return 9*e/5+32;case Me.K:case Me.kel:return n=o.prefixNumber,(e+Se)/n}}(e,n);break;case Me.F:case Me.fah:o=function(e,t){var n,o=st(t);switch(o.unit){case Me.Rank:return e+Te;case Me.Reau:return 4*(e-32)/9;case Me.F:case Me.fah:return e;case Me.C:case Me.cel:return 5*(e-32)/9;case Me.K:case Me.kel:return n=o.prefixNumber,(5*(e-32)/9+Se)/n}}(e,n);break;case Me.K:case Me.kel:o=function(e,t){var n,o=st(t);switch(o.unit){case Me.Rank:return 9*e/5;case Me.Reau:return.8*(e-Se);case Me.C:case Me.cel:return e-Se;case Me.F:case Me.fah:return 9*(e-Se)/5+32;case Me.K:case Me.kel:return n=o.prefixNumber,e/n}}(e*r.prefixNumber,n)}return o}(e,t,n);if(1===(o=function(e,t){var n=e.indexOf("bit")>-1||e.indexOf("byte")>-1,o=t.indexOf("bit")>-1||t.indexOf("byte")>-1;return n&&o?2:o||n?1:0}(t,n)))return v;if(2===o)return function(e,t,n){var o=at(t),r=at(n);return e*o.Uk/o.Vk*r.Vk/r.Uk}(e,t,n);if(it(t)&&it(n))return function(e,t,n){var o=ot(W,Ie,t),r=ot(W,Ie,n);return e*o.Uk/o.Vk*r.Vk/r.Uk}(e,t,n);if(rt(t)||rt(n))return v;for(r=[O,L,U,Z,X,J,ee,he,ee,pe,we],a=0;a<i(r);a++)if(u=(l=ot(s=r[a],Ie,t)).Tk,c=l.Vk,f=l.Uk,h=(l=ot(s,Ie,n)).Tk,p=l.Uk,d=l.Vk,u&&h&&0!==c&&0!==p)return e*f/c*d/p;return v}),3,3,[{Hi:1},De,De]),w("BITAND",(function(e,t){return lt(e,t,"bitOperator",(function(e,t){return e&t}))}),0,2),w("BITLSHIFT",(function(e,t){return lt(e,t,"shiftOperator",(function(e,t){if(t>=48)return b;if(t<0&&e<1<<-t)return 0;var n=e<<t;return n>I?b:n}))}),0,2),w("BITOR",(function(e,t){return lt(e,t,"bitOperator",(function(e,t){return e|t}))}),0,2),w("BITRSHIFT",(function(e,t){return lt(e,t,"shiftOperator",(function(n,o){return o>53?b:t>=0?e>>t:e<<-t}))}),0,2),w("BITXOR",(function(e,t){return lt(e,t,"bitOperator",(function(e,t){return e^t}))}),0,2),w("IMCOSH",(function(e){return ut(e,(function(e){return Ke(pt(e),e.lja())}))}),1,1),w("IMCOT",(function(e){return ut(e,(function(e){return gt(ct(e),Ve(0,0))?b:Ke(dt(ft(e),ct(e)),e.lja())}))}),1,1),w("IMCSC",(function(e){return ut(e,(function(e){return gt(e,Ve(0,0))?b:Ke(function(e){return dt(k,ct(e))}(e),e.lja())}))}),1,1),w("IMCSCH",(function(e){return ut(e,(function(e){return gt(ht(e),Ve(0,0))?b:Ke(function(e){return dt(k,ht(e))}(e),e.lja())}))}),1,1),w("IMSEC",(function(e){return ut(e,(function(e){return gt(ft(e),Ve(0,0))?b:Ke(function(e){return dt(k,ft(e))}(e),e.lja())}))}),1,1),w("IMSECH",(function(e){return ut(e,(function(e){return gt(pt(e),Ve(0,0))?b:Ke(function(e){return dt(k,pt(e))}(e),e.lja())}))}),1,1),w("IMSINH",(function(e){return ut(e,(function(e){return Ke(ht(e),e.lja())}))}),1,1),w("IMTAN",(function(e){return ut(e,(function(e){return Ke(function(e){return dt(ct(e),ft(e))}(e),e.lja())}))}),1,1)},"./src/functions-fin.ts":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe,re,ie,ae,se,le,ue,ce,fe,he,pe,de,ge,me,ye,ve,be,Ce;function we(e){return e.getMonth()}function xe(e){return e.getDate()}function Ae(e){return e.getFullYear()}function Me(e){return e instanceof Date?o.Common.l.Ra(e):e}function Se(e,t,n){var o=Ae(t)-Ae(e),i=we(t)-we(e)+12*o,a=xe(t)-xe(e),s=-1;return 0===n?s=r.Functions.uk(e,t):u(n,[1,2,3])>=0?s=Me(t)-Me(e):4===n&&(s=30*i+a),s}function Te(e,t,n,o,r){var i,s=w(1+e,t),l=a(s)?s:E;return 0===e?t:d(l)||(i=a(s=(s-1)/e)?s:E,d(i))?E:a(s=(-n*l-o)/((1+e*r)*i))?s:E}function Ne(e,t,n,o){var r=Ae(t),i=we(t),a=xe(t),s=new Date(1,0,1),l=0,u=a===P(r,i),c=12/n,f=r-Ae(e);s.setFullYear(1),f>0&&(f=(f-1)*n);do{f++,(s=new Date(r,i,a)).setMonth(i-f*c),u&&(l=P(Ae(s),we(s)),s=new Date(Ae(s),we(s),l))}while(H(e,s)<0);return o&&(f--,(s=new Date(r,i,a)).setMonth(i-f*c),u&&(l=P(Ae(s),we(s)),s=new Date(Ae(s),we(s),l))),s}function Ie(e,t,n,o){return B(Ne(e,t,n,!1),e,o)}function Re(e,t,n,o){return u(o,[0,2,4,5])>=0?360/n:3===o?365/n:B(Ne(e,t,n,!1),Ne(e,t,n,!0),1)}function ke(e,t,n,o){return B(e,Ne(e,t,n,!0),o)}function Ee(e,t,n){var o=Ae(t),r=we(t),i=xe(t),a=new Date(o,r,i),l=r-we(e)+12*(o-Ae(e));if(a.setMonth(we(a)-l),i===P(o,r))for(;xe(a)!==P(Ae(a),we(a));)a.setDate(xe(a)+1);return xe(e)>=xe(a)&&l--,s(""+(1+l/(12/n)))}function De(e,t,n){return t>0?(n.Wk?n.Xk?x(e-n.Yk)<x(n.Zk-n.Yk)&&(n.Zk=e,n.$k=t):t<n.$k&&(n.Zk=e,n.$k=t):(n.Zk=e,n.$k=t,n.Wk=!0),[!1,n]):t<0?(n.Xk?n.Wk?x(e-n.Zk)<x(n.Zk-n.Yk)&&(n.Yk=e,n._k=t):-t<-n._k&&(n.Yk=e,n._k=t):(n.Yk=e,n._k=t,n.Xk=!0),[!1,n]):isNaN(t)?[!1,n]:(n.al=e,[!0,n])}function je(e,t,n,o,r){var i,a=Ne(e,n,o,!0),s=Ne(e,n,o,!1);if(H(a,t)>=0)return B(e,t,r)/Re(s,a,o,r);for(i=B(e,a,r)/Re(s,a,o,r);;){if(s=new Date(Ae(a),we(a),xe(a)),a.setMonth(we(a)+12/o),H(a,t)>=0)return i+B(s,t,r)/Re(s,a,o,r);i+=1}}function _e(e,t,n,o,r,i,a){var l,u=Ie(e,t,i,a),c=ke(e,t,i,a),f=Re(e,t,i,a),h=s(""+Ee(e,t,i)),p=0,d=100*n/i,g=1+o/i,m=c/f;for(l=0;l<h;l++)p+=d/w(g,m+l);return r/w(g,h-1+c/f)+p-u/f*d}function Oe(e,t,n,o,r,i,a,l,u){var c,f,h,p=B(l,e,a),d=B(e,u,a),g=B(l,u,a),m=Re(e,t,i,a),y=s(""+Ee(e,t,i)),v=100*n/i,b=1+o/i;if(d>m)switch(a){case 0:case 4:c=B(u,t,a),y=1+s(""+A(c/m));break;default:for(f=new Date(Ae(u),we(u),xe(u)),y=0;y<32767;y++)if(h=new Date(Ae(f),we(f),xe(f)),f.setMonth(we(f)+12/i),H(f,t)>=0){y+=s(""+A(B(h,t,a))/Re(h,f,i,a))+1;break}p=m*je(l,e,u,i,a),d=m*je(e,u,u,i,a),g=m*je(l,u,u,i,a)}return r/w(b,y-1+d/m)+v*(g/m/w(b,d/m)+w(b,-d/m)*(w(b,-y)-1/b)/(1/b-1)-p/m)}function Fe(e,t){var n=e.substr(0,3),o={ATS:13.7603,BEF:40.3399,DEM:1.95583,ESP:166.386,EUR:1,FIM:5.94573,FRF:6.55957,GRD:340.75,IEP:.787564,ITL:1936.27,LUX:40.3399,LUF:40.3399,NLG:2.20371,PTE:200.482,SIT:245.18};return o[n]?_(o[n],t):-1}function Pe(e,t,n,o,r){var i=w(1+e,t);return-(0===e?o+n*t:o*i+n*(r>0?1+e:1)*(i-1)/e)}function He(e,t,n,o,r,i,a){if(i<r||i>n||0!==a&&1!==a)return E;var s,l,u=function(e,t,n,o,r){var i,a=w(1+e,t);return 0===e?i=(n+o)/t:(i=o*e/(a-1)+n*e/(1-1/a),r>0&&(i/=1+e)),-i}(t,n,o,0,a),c=0;for(1===r&&(e&&(c=u),a<=0&&(c+=e?o*t:-o),r++),s=r;s<=i;s++)l=a>0?Pe(t,s-2,u,o,1)-u:Pe(t,s-1,u,o,0),c+=e?u-l*t:l;return e?c:c*t}function Be(e,t,n,o){var r=w(1+n,o),i=-(e*r*n+t*(r-1));return a(i)?i:E}function Le(e,t,n,o,r){return u(o,[1,2,4])<0||H(t,n)>=0?E:e(t,n,o,r)}function ze(e,t,n,o,r,i){if(u(i,[1,2,4])<0||H(t,n)>0)return E;var a=function(e,t,n,o){var r,i=0,a=0;for(e*=100/y(n),t/=n,t++,r=1;r<o;r++)i+=r*e/w(t,r);for(i+=o*(e+100)/w(t,o),r=1;r<o;r++)a+=e/w(t,r);return(i/=a+=(e+100)/w(t,o))/y(n)}(o,r,i,Ee(t,n,i));return e?a/(1+r/i):a}function Ve(e,t,n,o,r,i,a,s,l){var c,f,h,p;if(u(a,[1,2,4])<0||H(t,n)>0||H(o,t)>0)return E;c=new Date(Ae(o),we(o),xe(o));do{c.setMonth(we(c)+12/a)}while(H(c,n)<0);return f=je(o,t,c,a,s),h=je(o,n,c,a,s),p=je(t,n,c,a,s),e?(i*a+100*r*(h-f*(1+l*p/a)))/(l*p+a):(a*(i-l)+100*r*(h-f))/(p*l+100*r*f*p/a)}function Ge(e,t,n){var o,r,i;return 0===n?R:(o=t<0?A(t):T(t),r=w(10,A(j.Ek(n,10))),i=t-o,g(o+(e?i*r/n:i*n/r)))}function We(e,t,n,o){var r,i,a=h(t),s=0,l=1+e,u=0;if(l>=.75&&l<=1.25&&a>12&&o&&(u=2.5),n)for(r=0;r<a;r++){if(i=-(r-u)*t[r]*Math.pow(l,-(r-u)-1),isNaN(i))return s;s+=i}else for(r=0;r<a;r++){if(i=t[r]*Math.pow(l,-(r-u)),isNaN(i))return s;s+=i}return s}function Ue(e,t,n,o){var r,i,s=0,l=h(t);for(e<=-1&&(e=1e-10-1),r=0;r<l;r++){if((i=Me(o[r])-Me(o[0]))<0)return[!1,n];s+=t[r]/j.Ck(e,i/365)}return a(s)?n=isNaN(s)?5e-324:s:s===Number.POSITIVE_INFINITY?n=O:s===Number.NEGATIVE_INFINITY&&(n=-O),[!0,n]}function Ze(e,t,n,o){var r,i,a;return e>-1&&0!==e?(i=w(1+e,(r=n).bl-(o?1:0)),a=(w(1+e,r.bl)-1)/e,[!0,t=o?-r.cl*a/e+i*r.bl*(r.dl+r.cl*(r.Nc+1/e)):r.dl*i+r.cl*(1+e*r.Nc)*a+r.el,n]):[!1,t,n]}function qe(e,t,n,o,r,i,a,s,l,u,f,h,p,d,g){var m,y,v,b,C=0,w=0,x=n-r,A=n+r,M=2===e;if(x<i.fl&&(x=n),A>i.gl&&(A=n),x===A)return M?[!1,o,i,a]:[!1,o,i];if(0===e?(m=t(a,s,l,x,f,h,p,d,g)-u,y=t(a,s,l,A,f,h,p,d,g)-u):1===e?(m=t(x,a,C,s),y=t(A,a,w,s)):(m=Ze(x,C,a),y=Ze(A,w,a)),c(m)){if(b=m[2],C=m[1],!(v=m[0]))return M?[v,o,i,b]:[v,o,i]}else C=m;if(c(y)){if(b=y[2],w=y[1],!(v=y[0]))return M?[v,o,i,b]:[v,o,i]}else w=y;return o=(w-C)/(A-x),M?[!0,o,i,b]:[!0,o,i]}function Je(e,t,n,o,r,i,a,s,l,u,c,f,h){var p;return o<n.fl||o>n.gl?[!1,n]:(n=(p=De(o,e?We(o,r):t(r,i,a,o,l,u,c,f,h)-s,n))[1],[!!p[0],n])}function Qe(e,t,n){var o,r,i=0;return t<e.fl||t>e.gl?[!1,e,n]:(n=(o=Ze(t,i,n))[2],i=o[1],o[0]?(e=(r=De(t,i,e))[1],[!!r[0],e,n]):[o[0],e,n])}function Ye(e,t,n,o,r,i,a,s,l,u){var c,f,h,p,d=0,g=e?15:2;if(!n.Wk||!n.Xk)return e?[!1,n,o]:[!1,n];for(f=x(n.Zk-n.Yk)/(x(n.Zk)+x(n.Yk)),c=0;c<100+4*g;c++)if(0,0,void 0,h=c%4==0?1:c%4==2?2:3,void 0,n=(p=e?nt(n,o,f,d,0,h):t?ot(!0,n,d,0,0,h,Ue,f,r,o,qe):ot(!1,n,d,0,0,h,_e,f,i,a,s,o,r,l,u))[1],e&&(o=p[2]),d=e?p[3]:p[2],p[0])return e?[!0,n,o]:[!0,n];return e?[!1,n,o]:[!1,n]}function Ke(e,t,n,o,r,i,a,s,l,u,c){var h,p,d,g,m,y,v,w=0,A=e?15:2;if(!t.Wk||!t.Xk)return[!1,t];for(p=x(t.Zk-t.Yk)/(x(t.Zk)+x(t.Yk)),h=0;h<100+4*A;h++)if(d=0,g=0,void 0,m=h%4==0?1:h%4==2?2:3,t=(y=e?ot(!0,t,w,d,g,m,We,p,C,n,qe):ot(!1,t,w,d,g,m,Oe,p,a,s,l,n,o,u,c,r,i))[1],w=y[2],d=y[3],!(e&&y[0]===b||!e&&f(y[0]))){if(y[0])return[!0,t];if(t=(v=De(d,g=e?We(d,n):Oe(n,o,a,d,l,u,c,r,i)-s,t))[1],v[0])return[!0,t];if((p=x(t.Zk-t.Yk)/(x(t.Zk)+x(t.Yk)))<t.hl)return t._k<g&&(g=t._k,d=t.Yk),t.$k<g&&(d=t.Zk),t.al=d,[!0,t]}return[!1,t]}function $e(e,t,n,o,r,i,a,s,l,u,f,h,p){var d,g,m,y,v,b,C,w,A,M,S,T,N,I,R,k,E,D,j=n.hl/2,_=!1;for(g=0;g<20;g++){if(o<n.fl||o>n.gl){if(!e||n.Xk&&n.Wk||!(o<=-1))return[!1,n];o=-1,_=!0}if(v=e?Ue(o,r,0,i):t(r,i,a,o,l,u,f,h,p)-s,c(v)){if(y=v[1],!(m=v[0]))return[m,n]}else y=v;if(n=(b=De(o,y,n))[1],b[0])return[!0,n];if(_)return[!1,n];if(C=n.Xk&&n.Wk?x(n.Zk-n.Yk):n.gl-n.fl,w=(x(o)<1e-10?C:x(o))/1e6,A=0,n=(b=e?qe(1,Ue,o,A,w,n,r,i):qe(0,t,o,A,w,n,r,i,a,s,l,u,f,h,p))[2],A=b[1]<0?b[1]:-b[1],!(m=b[0]))return[m,n];if(0===A)return[!1,n];if((M=o-1.000001*y/A)===o)return n.al=o,[!0,n];if(e&&n.Xk&&n.Wk&&(M<(T=(S=[n.Zk,n.Yk])[0])==M<(N=S[1])&&(I=!0,T>N&&(T=(d=[N,T])[0],N=d[1],I=!1),k=(R=[n.$k,n._k])[0],E=R[1],M=T+x((I?k:E)/(E-k))*(N-T))),D=x(M-o)/(x(o)+x(M)),o=M,D<j)return n.al=o,[!0,n]}return[!1,n]}function Xe(e,t,n){for(var o,r,a,s,l,u,c,f=e.hl/2,h=0;0===t[h];)h++;for(o=t.slice(h),a=[!1,null],s=[n],.1!==n&&s.push(.1),s.push(-.1,.99*e.gl,e.fl+.01),l=0;!a[0]&&l<s.length;l++)et(a=tt(i(e),o,s[l],f),o);if(!a[0]){for(u=0,l=1,c=o.length;l<c;l++)u+=o[l];r=-u/o[0]-1,a=tt(i(e),o,r,f)}return a}function et(e,t){var n,r,i,a;e[0]&&(r=15,"number"==typeof(n=e[1].al)&&n>-10&&n<10&&(((i=""+n).indexOf("000000000000")>1||i.indexOf("999999999999")>1)&&(r=14)),((a=rt(n=o.Common.o.Lma(n,r),t))>.001||a<-.001)&&(e[0]=!1))}function tt(e,t,n,o){var r,i,a,s,l,u;for(r=0;r<32;r++){if(n<e.fl||n>e.gl)return[!1,e];if(e=(a=De(n,i=We(n,t,!1,!0),e))[1],a[0])return[!0,e];if(0===(s=We(n,t,!0,!0)))return[!1,e];if((l=n-1.0000001*i/s)===n)return e.al=n,[!0,e];if(u=x(l-n)/(x(n)+x(l)),n=l,u<o)return e.al=n,[!0,e]}return[!1,e]}function nt(e,t,n,o,r,i){var a,s,l,u,c,f,h;if(1===i){if(void 0,t=(s=Ze(a=(e.Zk+e.Yk)/2,r,t))[2],r=s[1],!s[0])return[b,e,t,o];if(0===r)return[!0,e=De(a,r,e)[1],t,o];if(0===S(r*r-e.$k*e._k))return[b,e,t,o]}else if(2===i){if(l=void 0,void 0,u=0,c=0,n>.1)return nt(e,t,n,o,r,i=3);if(0===(f=o++%4))l=e.Zk,u=e.$k;else if(2===f)l=e.Yk,u=e._k;else if(t=(s=Ze(l=(e.Zk+e.Yk)/2,u,t))[2],u=s[1],!s[0])return[b,e,t,o];if(t=(h=qe(2,void 0,l,c,x(e.Zk-e.Yk)/1e6,e,t))[3],e=h[2],c=h[1],!h[0]||0===c)return[b,e,t,o];if((a=l-1.01*u/c)<e.Zk&&a<e.Yk||a>e.Zk&&a>e.Yk)return[b,e,t,o]}return[!1,e,t,o]}function ot(e,t,n,o,r,i,a,s,l,u,f,h,p,d,g,m,y){var v,C,w,A,M,T,N,I;switch(i){case 0:o=t.Zk-t.$k*((t.Yk-t.Zk)/(t._k-t.$k));break;case 1:if(o=(t.Zk+t.Yk)/2,v=e?a(o,u,r,l):a(h,p,l,o,f,d,g,m,y)-u,c(v)){if(r=v[1],!v[0])return[b,t,n,o,r,i]}else r=v;if(0===r)return[!0,t=De(o,r,t)[1],n,o,r,i];if(0===(C=S(r*r-t.$k*t._k)))return[b,t,n,o,r,i];o+=(o-t.Zk)*r/C;break;case 3:o=(t.Zk+t.Yk)/2;break;case 2:if(w=void 0,A=0,void 0,T=0,s>.1)return ot(e,t,n,o,r,i=3,a,s,l,u,f,h,p,d,g);if(0===(N=n++%4))w=t.Zk,A=t.$k;else if(2===N)w=t.Yk,A=t._k;else if(w=(t.Zk+t.Yk)/2,v=e?a(w,u,A,l):a(h,p,l,w,f,d,g,m,y)-u,c(v)){if(A=v[1],!v[0])return[b,t,n,o,r,i]}else A=v;if(M=x(t.Zk-t.Yk)/1e6,t=(I=e?f(1,a,w,T,M,t,u,l):qe(0,a,w,T,M,t,h,p,l,u,f,d,g,m,y))[2],T=I[1],!I[0]||0===T)return[b,t,n,o,r,i];if((o=w-1.01*A/T)<t.Zk&&o<t.Yk||o>t.Zk&&o>t.Yk)return[b,t,n,o,r,i]}return v=e?a(o,u,r,l):a(h,p,l,o,f,d,g,m,y)-u,c(v)&&(r=v[1],!v[0])?[b,t,n,o,r,i]:De(o,r,t)[0]?[!0,t,n,o,r,i]:(s=x(t.Zk-t.Yk)/(x(t.Zk)+x(t.Yk)))<t.hl?(t._k<r&&(r=t._k,o=t.Yk),t.$k<r&&(r=t.$k,o=t.Zk),t.al=o,[!0,t,n,o,r,i]):[!1,t,n,o,r,i]}function rt(e,t){var n,o,r,i=arguments,a=0,s=1;for(o=1;o<h(i);o++){if((r=m(i[o],1,!0,!0,!1,!0)).isError)return r[0];for(n=0;n<h(r);n++)r[n]!==v&&(a+=r[n]/w(1+e,s++))}return a}function it(e,t,n){return Me(Ne(e,t,n,!0))}function at(e,t,n){return Me(Ne(e,t,n,!1))}function st(e,t,n,o){var r,i,a=o.hl,s=o.Xk&&o.Wk?[o.Zk,o.Yk]:function(e,t,n,o){for(var r=.5,i=n-r,a=n+r,s=0;Ue(i,e,0,t)[1]*Ue(a,e,0,t)[1]>0&&s++<o;)i-=r,a+=r;return s>=o?[0,0]:[i,a]}(e,t,n,100),l=s[0],u=s[1],c=Ue(l,e,0,t)[1],f=Ue(u,e,0,t)[1],h=0;for(r=0;r<100&&!(c*f>0);r++)if((i=Ue(h=(l+u)/2,e,0,t)[1])*c<0?(u=h,f=i):(l=h,c=i),x(l-u)<a)return[x(i)<1||x(c+f)<1,h];return[!1,h]}function lt(e,t,n,o,r){var i,a,s,l=r/n;return l>=1?(l=1,a=1===o?e:0):a=e*w(1-l,o-1),(i=a-((s=e*w(1-l,o))<t?t:s))<0?0:i}function ut(e,t,n,o,r,i){var a,s,l,u=0,c=0,f=A(r),h=f,p=e-t,d=!1;for(l=1;l<=h;l++)d?s=c:(c=p/(o-(l-1)))>(a=lt(e,t,n,l,i))?(s=c,d=!0):(s=a,p-=a),l===h&&(s*=r+1-f),u+=s;return u}function ct(e,t,n,o){var r,i,a;return""===e&&""===t&&""===n?k:(e=z(e,r={value:0}),t=z(t,i={value:0}),n=z(n,a={value:0}),!0===e&&!0===t&&!0===n?o(r,i,a):k)}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Common"),r=n("CalcEngine"),i=o.Common.j.C4,a=isFinite,s=parseInt,l=o.Common.j,u=l.Ea,c=l.Ca,f=l.Fa,h=o.Common.k.ac,p=r.Convert.Rh,d=r.Convert.vf,g=r.Convert.Nh,m=r.Convert.Ph,y=r.Convert.Pa,v=r.Convert.CalcConvertedError,b=null,C=void 0,w=Math.pow,x=Math.abs,A=Math.ceil,M=Math.log,S=Math.sqrt,T=Math.floor,N=Math.max,I=Math.min,R=r.Errors.DivideByZero,k=r.Errors.Value,E=r.Errors.Number,D=r.Functions.ak,j=r.Functions.MathHelper,_=j.Ak,O=r.Functions.hk,F=r.Functions.lk,P=r.Functions.nk,H=r.Functions.mk,B=r.Functions.pk,L=r.Functions.vk,z=r.Convert.Th,V=2.98023e-9,Z={Hi:0,aj:"< 1"},q={Hi:0,aj:"< 0"},J={_i:.1,Hi:0},Q={_i:2,Hi:0},Y={_i:1e3,Hi:0,aj:"<= 0"},$={Hi:5},X={_i:!1,Hi:7},oe={_i:0,Hi:2},ie={Hi:2,aj:"= 0",bj:R},se={Hi:4,Ii:1,Ji:!0,Ki:!0},le={Hi:4,Ii:1,Ji:!0,Mi:!0,Ki:!0},ue={Hi:4,Ii:4,Ji:!0,Ki:!0,Mi:!0,breakOnConvertError:!0},ce={Hi:4,Ii:1,Ji:!0,Ki:!0,breakOnConvertError:!0},fe={Hi:4,Ii:11,Ji:!0,Ki:!0,breakOnConvertError:!0},he=[K={Hi:6},K,ee={Hi:2},re={_i:0,Hi:2,aj:["< 0","> 4"]}],pe=[K,K,G={Hi:0},G,ee,re],de=[K,K,U={Hi:0,aj:"<= 0"}],ge=[G,K,K,G,ee,U,{_i:0,Hi:2,aj:["< 0","> 4","= 2"]}],ye=[K,K,U,U,re],ve=[U,te={Hi:2,aj:"<= 0"},U,ne={Hi:2,aj:"< 1"},ee,ee],be=[U,ne],Ce=[G,ae={Hi:2,aj:"< 0"}],D("FV",(function(e,t,n,o,r){r=r?1:0;var i=w(1+e,t);return g(-(i=0===e?n*t+o:o*i+n*(1+e*r)*(i-1)/e))}),3,5,me=[G,G,G,W={_i:0,Hi:0},W],C,C,{bk:[3,4]}),D("FVSCHEDULE",(function(e,t){for(var n=0;n<h(t);n++)t[n]!==v&&(e*=1+t[n]);return e}),2,2,[G,se],1,1),D("NPV",rt,2,C,G,"> 0","> 0"),D("PV",(function(e,t,n,o,r){if(r=r?1:0,0===e)return g(-(n*t+o));var i=w(1+e,t);return-1===e?R:g(-(o+n*(1+e*r)*(i-1)/e)/i)}),3,5,me,C,C,{bk:[3,4]}),D("RECEIVED",(function(e,t,n,o,r){var i,a,s;return H(e,t)>=0?E:(i=Se(e,t,r),a=F(e,r),i<=0||a<=0?E:(s=1-o*i/a)<=0?E:n/s)}),4,5,ye,C,C,{bk:3}),D("XNPV",(function(e,t,n){var o,r=h(t),i=0;if(r!==h(n))return E;if(t.some((function(e){return e===v})))return k;for(o=0;o<r;o++)i+=t[o]/w(1+e,(n[o]-n[0])/365);return i}),3,3,[G,ce,ce],"!= 0","!= 0"),D("CUMIPMT",(function(e,t,n,o,r,i){return He(!1,e,t,n,o,r,i)}),6,6,ve),D("CUMPRINC",(function(e,t,n,o,r,i){return He(!0,e,t,n,o,r,i)}),6,6,ve),D("IPMT",(function(e,t,n,o,r,i){return t>=n+1||0!==i&&1!==i?E:Be(o,Te(e,n,o,r,i),e,t-1)}),4,6,[G,Z,Z,G,W,oe],C,C,{bk:[4,5]}),D("ISPMT",(function(e,t,n,o){return g(o*e*(t/n-1))}),4,4,[G,ee,ie,G]),D("PMT",(function(e,t,n,o,r){r=r?1:0;var i=w(1+e,t);return g(-(i=0===e?(n+o)/t:(n*i+o)/((1+e*r)*(i-1)/e)))}),3,5,[G,{Hi:0,aj:"= 0",bj:R},G,W,W],C,C,{bk:[3,4]}),D("PPMT",(function(e,t,n,o,r,i){var a,s;return i=i?1:0,t>=n+1?E:(a=Te(e,n,o,r,i),d(a)||(s=Be(o,a,e,t-1),d(s))?E:a-s)}),4,6,[G,Z,G,G,W,W],C,C,{bk:[4,5]}),D("COUPDAYBS",(function(e,t,n,o){return Le(Ie,e,t,n,o)}),3,4,he,C,C,{bk:3}),D("COUPDAYS",(function(e,t,n,o){return Le(Re,e,t,n,o)}),3,4,he,C,C,{bk:3}),D("COUPDAYSNC",(function(e,t,n,o){return Le(ke,e,t,n,o)}),3,4,he,C,C,{bk:3}),D("COUPNCD",(function(e,t,n){return Le(it,e,t,n)}),3,4,he,C,C,{bk:3}),D("COUPNUM",(function(e,t,n){return Le(Ee,e,t,n)}),3,4,he,C,C,{bk:3}),D("COUPPCD",(function(e,t,n){return Le(at,e,t,n)}),3,4,he,C,C,{bk:3}),D("DURATION",(function(e,t,n,o,r){return ze(!1,e,t,n,o,r)}),5,6,pe,C,C,{bk:5}),D("MDURATION",(function(e,t,n,o,r){return o<0||n<0?E:ze(!0,e,t,n,o,r)}),5,6,pe,C,C,{bk:5}),D("NPER",(function(e,t,n,o,r){return r=r?1:0,0===e?0===t?R:g(-(n+o)/t):g(M((t*(1+e*r)-o*e)/(n*e+t*(1+e*r)))/M(1+e))}),3,5,[{Hi:0,aj:"<= -1"},G,G,W,W],C,C,{bk:[3,4]}),D("YIELD",(function(e,t,n,o,r,i,a){var s,l,c,f,h,p,d;if(u(i,[1,2,4])<0||H(e,t)>0)return E;if(Ee(e,t,i)<=1)return s=Ie(e,t,i,a),l=ke(e,t,i,a),(r/100+n/i-(o/100+s/(c=Re(e,t,i,a))*n/i))/(o/100+s/c*n/i)*(i*c/l);if(p=(d=$e(!1,_e,p={fl:0,gl:1e3,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0},h=.1,e,t,n,o,r,i,a))[1],!(f=d[0])){for(h=1e-10;h<p.gl;h*=2)p=Je(!1,_e,p,h,e,t,n,o,r,i,a)[1];p=(d=Ye(!1,!1,p,e,t,n,o,r,i,a))[1],f=d[0]}return f?p.al:E}),6,7,[K,K,q,U,U,ee,re],C,C,{bk:6}),D("YIELDDISC",(function(e,t,n,o,r){return H(e,t)>=0?E:(o/n-1)/L(e,t,r)}),4,5,[K,K,U,U,re],C,C,{bk:3}),D("YIELDMAT",(function(e,t,n,o,r,i){var a;return H(e,t)>=0?E:(a=1+L(n,t,i)*o,a/=r/100+L(n,e,i)*o,a--,a/=L(e,t,i))}),5,6,[K,K,K,q,U,re],C,C,{bk:5}),D("AMORDEGRC",(function(e,t,n,o,r,i,a){var s=1/i;return s>0&&s<1||s>1&&s<2||s>2&&s<3||s>4&&s<5||H(t,n)>0?E:function(e,t,n,o,r,i,a){var s,l,u,c,f,h=1/i;if(i*=h<3?1:h<5?1.5:h<=6?2:2.5,c=L(t,n,a),d(c))return 0;for(u=(e-=l=T(c*i*e+.5))-o,s=0;s<r;s++){if((u-=l=T(i*e+.5))<0)return 0===(f=r-s)||1===f?T(.5*e+.5):0;e-=l}return l}(e,t,n,o,r,i,a)}),6,7,ge,C,C,{bk:6}),D("AMORLINC",(function(e,t,n,o,r,i,a){return H(t,n)>0?E:function(e,t,n,o,r,i,a){var s,l,u,c=e*i,f=e-o,h=L(t,n,a);return d(h)?0:(l=(e-o-(s=h*i*e))/c,u=p((e-o-s)/c),0===r?s:r<=u?c*(l<1?l:1):r===u+1?f-c*u-s:0)}(e,t,n,o,r,i,a)}),6,7,ge,C,C,{bk:6}),D("ODDFYIELD",(function(e,t,n,o,r,i,a,s,l){var c,f,h,p=.1;if(u(s,[1,2,4])<0||H(n,e)>0||H(e,o)>0||H(o,t)>0)return E;if(c=(f=$e(!1,Oe,c={fl:0,gl:1e3,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0},p,e,t,r,i,a,s,l,n,o))[1],h=f[0]){for(p=1e-10;p<c.gl;p*=2)c=Je(!1,Oe,c,p,e,t,r,i,a,s,l,n,o)[1];c=(f=Ke(!1,c,e,t,n,o,r,i,a,s,l))[1],h=f[0]}return h?c.al:E}),8,9,[K,K,K,K,q,U,U,ee,re],C,C,{bk:8}),D("ODDLYIELD",(function(e,t,n,o,r,i,a,s){return Ve(!1,e,t,n,o,i,a,s,r)}),7,8,[K,K,K,q,U,U,G,re],C,C,{bk:7}),D("ODDLPRICE",(function(e,t,n,o,r,i,a,s){return Ve(!0,e,t,n,o,i,a,s,r)}),7,8,[K,K,K,q,q,U,ee,re],C,C,{bk:7}),D("TBILLEQ",(function(e,t,n){var o,r=Me(t)-Me(e);return H(e,t)>=0||r>365?E:0===(o=360-n*r)?R:o<0?E:g(365*n/o)}),3,3,de),D("TBILLYIELD",(function(e,t,n){var o=Me(t)-Me(e);return H(e,t)>=0||o>365?E:(100-n)/n*(360/o)}),3,3,de),D("IRR",(function(e,t){var n,o,r,i,a,s=h(e),l=[],u=!1,c=!1,f={fl:-1,gl:9999999,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0};for(x(t)>1&&(t=.1),n=-1,o=0,r=0;r<s;r++)(i=e[r])!==v&&(0!==i&&(o=l.length+1,-1===n&&(n=l.length)),l.push(i),i>0&&(u=!0),i<0&&(c=!0));return l=l.slice(n,o+1),!u||!c||h(l)<2?E:(f=(a=Xe(f,l,t))[1],a[0]?f.al:E)}),1,2,[le,J],0,0,{bk:1}),D("MIRR",(function(e,t,n){var o,r,i,a,s=0,l=0,u=0,c=0,f=0,p=[],d=h(e);if(d<2)return R;for(o=0;o<d;o++)(r=e[o])!==v&&(p.push(r),u++,0!==r&&(r>0?s++:l++));if(l<1||s<1)return R;for(i=0;i<u;i++)0!==(a=p[i])&&(a>0?c+=a/w(1+n,i):f+=a/w(1+t,i));return 0===f||0===c||n<=-1?R:w(-c*w(1+n,u)/(f*(1+n)),1/(u-1))-1}),3,3,[le,G,G],0,0),D("XIRR",(function(e,t,n){var o,r,i,a,s,l,u,c=h(e);if(c!==h(t))return E;for(i=c-1;i>=0;i--)o=e[i]>0||o,r=e[i]<0||r,t[i]===v&&(0!==e[i]?t[i]=0:(e.splice(i,1),t.splice(i,1)));return o&&r?0===e[0]?0===n?4.88281e-9:V:(a=(s=$e(!0,qe,a={fl:-1,gl:1e10,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0},n,e,t))[1],s[0]?(l=a.al,Math.abs(l)<a.hl?V:l):(u=st(e,t,n,a))[0]?u[1]:E):E}),2,3,[fe,ue,J],"!= 2","!= 2",{bk:2}),D("RATE",(function(e,t,n,o,r,i){var a,s,l,u,c,f;if(r=r?1:0,a=w(17976931348623157e282,1/e),u=function(e,t,n){var o,r,i,a,s,l,u,c,f=e.hl/2;for(o=0;o<100;o++){if(void 0,void 0,a=void 0,s=0,l=0,n<e.fl||n>e.gl)return[!1,e,t];if(t=(u=Ze(n,s,t))[2],s=u[1],!(a=u[0]))return[a,e,t];if(e=(c=De(n,s,e))[1],c[0])return[!0,e,t];if(t=(u=Ze(n,l,t,!0))[2],l=u[1],!(a=u[0]))return[a,e,t];if(0===l)return[!1,e,t];if((r=n-1.000001*s/l)===n)return e.al=n,[!0,e,t];if(i=x(r-n)/(x(n)+x(r)),n=r,i<f)return e.al=n,[!0,e,t]}return[!1,e,t]}(s={hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0,fl:N(-1e10,1-a),gl:I(1e10,a-1)},l={bl:e,cl:t,dl:n,el:o,Nc:r},i),l=u[2],s=u[1],!(c=u[0])){for(f=2;(!s.Xk||!s.Wk)&&f<100;f*=2)l=(u=Qe(s,i*f,l))[2],l=(u=Qe(s=u[1],i/f,l))[2],s=u[1];s=(u=Ye(!0,!1,s,l))[1],c=u[0]}return c?s.al:E}),3,6,[U,G,G,W,{_i:0,Hi:2,aj:"< 0",bj:k},J],C,C,{bk:[3,4,5]}),D("VDB",(function(e,t,n,o,r,i,a){return r<o?E:e<t&&0===o&&1===r?e-t:function(e,t,n,o,r,i,a){var s,l,u,c,f=T(o),h=f,p=A(r),d=p,g=0;if(a)for(s=h+1;s<=d;s++)l=lt(e,t,n,s,i),s===h+1?l*=I(r,f+1)-o:s===d&&(l*=r+1-p),g+=l;else u=n,c=void 0,o!==T(o)&&i>1&&o>=n/2&&(c=o-n/2,o=n/2,r-=c,u+=1),e-=ut(e,t,n,u,o,i),g=ut(e,t,n,n-o,r-o,i);return g}(e,t,n,o,r,i,a)}),5,7,[q,q,ae,q,q,Q,X],C,C,{bk:[5,6]}),D("ACCRINT",(function(e,t,n,o,r,i,a){var s,l,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S;if(u(i,[1,2,4])<0||H(e,n)>=0)return E;if(1===i||0===a||4===a)return function(e,t,n,o,r,i,a){var s=Se(e,n,a),l=F(e,a);return s<0||l<=0?E:r*o*(s/l)}(e,0,n,o,r,0,a);for(s=e.getFullYear(),l=e.getMonth(),c=e.getDate(),f=n.getFullYear(),h=n.getMonth(),p=n.getDate(),d=t.getMonth(),g=t.getDate(),m=[],y=[],v=[],b=[31,28,31,30,31,30,31,31,30,31,30,31],C=0;C<i;C++)m[C]=(d+12*C/i)%12,y[C]=g<=b[m[C]]?g:b[m[C]],2===a?v[C]=360/i:3===a&&(v[C]=365/i);for(C=0;C<i;C++)x=m[w=C===i-1?0:C+1]>m[C]?2001:2002,v[C]=Me(new Date(x,m[w],y[w]))-Me(new Date(2001,m[C],y[C]));for(A=0,M=Me(n);s<f||s===f&&l<h||s===f&&l===h&&c<p;){for(C=0;C<i&&(l<m[C]||l===m[C]&&c<y[C])&&(0===C||m[C]>m[C-1]);)C++;for(;C<i&&(l>m[C]||l===m[C]&&c>=y[C])&&(l!==m[++C-1]||c!==y[C-1]););w=--C===i-1?0:C+1,x=l+12/i>=12?s+1:s,S=Me(new Date(s,l,c)),A+=r*o/i*(Math.min(Me(new Date(x,m[w],y[w])),M)-S)/v[C],s=x,l=m[w],c=y[w]}return A}),6,8,[K,K,K,U,Y,ee,re],C,C,{bk:[4,6,7]}),D("ACCRINTM",(function(e,t,n,o,r){if(H(e,t)>0)return E;var i=Se(e,t,r),a=F(e,r);return i<0||a<=0?E:o*n*i/a}),3,5,[K,K,U,Y,re],C,C,{bk:[3,4]}),D("DISC",(function(e,t,n,o,r){if(H(e,t)>=0)return E;var i=F(e,r),a=Se(e,t,r);return a<=0||i<=0?E:(o-n)/o*(i/a)}),4,5,[K,K,U,U,re],C,C,{bk:3}),D("EFFECT",(function(e,t){return w(1+e/t,t)-1}),2,2,be),D("INTRATE",(function(e,t,n,o,r){if(H(e,t)>=0)return E;var i=Se(e,t,r),a=F(e,r);return i<=0||a<=0?E:(o-n)/n*(a/i)}),4,5,ye,C,C,{bk:3}),D("NOMINAL",(function(e,t){return t*(w(1+e,1/t)-1)}),2,2,be),D("DB",(function(e,t,n,o,r){var i,a,s,l;if(n+(r<12?1:0)<o)return E;if(0===e)return 0;for(i=_(1-w(t/e,1/n),3),a=0,s=0,l=1;l<=o;l++)a+=s=1===l?e*i*r/12:l===n+1?(e-a)*i*(12-r)/12:(e-a)*i;return s}),4,5,[q,G,ne,ne,{_i:12,Hi:2,aj:["< 1","> 12"]}],C,C,{bk:3}),D("DDB",(function(e,t,n,o,r){var i,a=0,s=0;if(n<o)return E;if(e<=t)return 0;for(i=1;i<=o;i++)a+=s=I(s=r/n*(e-a),e-a-t);return s}),4,5,[q,G,te,te,{_i:2,Hi:0,aj:"<= 0"}],C,C,{bk:3}),D("SLN",(function(e,t,n){return(e-t)/n}),3,3,[G,G,ie]),D("SYD",(function(e,t,n,o){return o>n?E:(e-t)*(n-o+1)*2/(n*(n+1))}),4,4,[G,q,ne,te]),D("DOLLARDE",(function(e,t){return t<1?R:Ge(!0,e,t)}),2,2,Ce),D("DOLLARFR",(function(e,t){return 0===t?R:Ge(!1,e,t)}),2,2,Ce),D("PRICE",(function(e,t,n,o,r,i,a){return u(i,[1,2,4])<0||H(e,t)>0?E:_e(e,t,n,o,r,i,a)}),6,7,[K,K,q,q,U,ee,re],C,C,{bk:6}),D("PRICEDISC",(function(e,t,n,o,r){if(H(e,t)>=0)return E;var i=Se(e,t,r),a=F(e,r);return i<=0||a<=0?E:o-n*o*i/a}),4,5,ye,C,C,{bk:3}),D("PRICEMAT",(function(e,t,n,o,r,i){var a,s,l,u,c;return H(e,t)>=0?E:(a=Se(e,t,i),s=Se(n,t,i),l=Se(n,e,i),u=F(e,i),l<=0||u<=0||a<=0||s<=0?E:0===(c=1+a/u*r)?E:(100+s/u*o*100)/c-l/u*o*100)}),5,6,[K,K,K,q,q,re],C,C,{bk:5}),D("ODDFPRICE",(function(e,t,n,o,r,i,a,s,l){return u(s,[1,2,4])<0||H(n,e)>0||H(e,o)>0||H(o,t)>0?E:Oe(e,t,r,i,a,s,l,n,o)}),8,9,[K,K,K,K,q,q,U,ee,re],C,C,{bk:8}),D("TBILLPRICE",(function(e,t,n){var o=Me(t)-Me(e);return H(e,t)>=0||o>365?E:100*(1-n*o/360)}),3,3,[K,K,U]),D("EURO",(function(e){var t=Fe(e,2);return t>=0?t:E}),1,1,$),D("EUROCONVERT",(function(e,t,n,o,r){var i,a,s,l;return i=0,o||(i=function(e){var t=e.substr(0,3);return u(t,["BEF","LUF","ESP","ITL","LUX"])>=0?0:2}(n)),r.$i||(r.Qb=function(e){var t=e.substr(0,3);return u(t,["BEF","LUF","ESP","ITL","PTE","GRD","LUX"])>=0?0:2}(t)),s=Fe(t,r.Qb),l=Fe(n,r.Qb),s>=0&&l>=0?(a=e*l/s,o||(a=_(a,i)),a):k}),3,5,[G,$,$,X,{Zi:!0,Hi:2,_i:3,aj:"< 3",bj:k}],C,C,{bk:[3,4]}),D("PDURATION",(function(e,t,n){return ct(e,t,n,(function(e,t,n){var o,r;return t.value>0&&e.value>0&&n.value>0?(o=(Math.log(n.value)-Math.log(t.value))/Math.log(1+e.value),(r=Math.abs(o))<=179769e303?r>=22250738585072014e-324?o:0:R):E}))}),3,3),D("RRI",(function(e,t,n){return ct(e,t,n,(function(t,n,o){if(n.value>0&&t.value>0&&o.value>=0){e=Math.pow(o.value/n.value,1/t.value)-1;var r=Math.abs(e);if(r<=179769e303)return r>=22250738585072014e-324?e:0}return E}))}),3,3)},"./src/functions-lookup.ts":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function U(e,t,n,o){return{row:e,col:t,rowCount:n,colCount:o}}function Z(e,t,n){var o,r;return f(e)?i:e.isArray||e.isReference?(t>(o=e.colCount)&&(r=t,t=n,n=r),e[n*o+t]):e[0]}function q(e,t,n){return!((!n||null!==e&&null!==t)&&(f(t)||!((f(e)||v(e,!0))&&v(t,!0)||R(e)&&R(t))&&(!k(e)||!k(t))))}function J(e,t,n,o,r){if(e<0||t<0||t<e||n<e||n>t)return-1;if(r)return E=e,D=t,_=n,O=o,F=o,j=n;if(O){if(++j>D){if(O!==F)return-1;j=_-1,O=!1}}else if(--j<E){if(O!==F)return-1;j=_+1,O=!0}return j}function Q(e,t,n){var o=c(e),r=n;return o===t?r=0:o>t?r=1:o<t&&(r=2),r}function Y(e,t,n){var r,i,a,s;if(e===t)return 0;if(k(e)){if(!t&&0===h(""+e))return 0;if(v(t)&&!v(e))return 1;if(R(t))return 2;if(k(t)){r=void 0;try{r=(i=o.Common.CultureManager.getCultureInfo()).localeCompare?n?i.localeCompare(""+e,""+t):i.localeCompare(e.toLowerCase(),t.toLowerCase()):n?(""+e).localeCompare(""+t):e.toLowerCase().localeCompare(t.toLowerCase())}catch(o){r=n?(""+e).localeCompare(""+t):e.toLowerCase().localeCompare(t.toLowerCase())}return r<0?r=2:r>0&&(r=1),r}return t instanceof Date?Q(e,t,1):-1}return k(t)?e||0!==h(""+t)?v(e)?2:R(e)?1:e instanceof Date?Q(e,t,2):-1:0:R(e)&&v(t)?1:R(t)&&v(e)?2:(a=b(e))===(s=b(t))?0:a<s?2:1}function K(e,t,n){var o=Z(e,t,n);return f(o)?0:o}function $(e,t,n,o){var r,a,s,l,u=-1,c=0,f=-1,h=-1,p=o?t.rowCount:t.colCount;if(--p<c)return-1;for(;c<=p;){for(r=i,void 0,s=e[0],n>=1!=(2===u)&&(f=h),a=h=J(c,p,h=m((c+p)/2),n>=0,!0);!q(s,r)&&-1!==h&&!q(s,r=o?Z(t,0,h):Z(t,h,0));)h=J(0,0,0,!1,!1),n>=0&&h<a?p=h:n<0&&h>a&&(c=h);if(-1===h&&n>=1!=(2===u))return f;if(-1===h)return-1;if(u=Y(s,r,!1),n>=1&&1===u)c=h+1;else if(n>=1&&2===u)p=h-1;else if(n<=-1&&1===u)p=h-1;else if(n<=-1&&2===u)c=h+1;else if(0===u){for(;n<=-1&&h>c||n>=0&&h<p;){if(0,l=n>=0?h+1:h-1,null===(r=o?K(t,0,l):K(t,l,0)))return-1;if(!q(s,r))break;if(0!==(u=Y(s,r,!1)))break;h=l}return h}}return n>=1!=(2===u)?h:f}function X(e,t,n,o,r,a){var l,u,c,f,h,p,d=i,g=-1,m=e[0],y=k(m),v=s.zb(m),b=o?t.rowCount:t.colCount;for(y&&v&&(c=s.sb(v)),u=0;u<b;u++)if(h=r?b-1-u:u,q(m,f=o?Z(t,0,h):Z(t,h,0),a))if(p=k(f),y&&p&&v?(c.lastIndex=0,l=c.test(f)?0:1):l=Y(m,f,!1),n>=1&&1===l)l=-1,g>=0&&(l=Y(f,d,!1)),(g<0||g>=0&&1===l)&&(g=h,d=f);else if(n<=-1&&2===l)l=-1,g>=0&&(l=Y(f,d,!1)),(g<0||g>=0&&2===l)&&(g=h,d=f);else if(0===l)return h;return g}function ee(e,t){var n,o;if(!t)for(n=h(e),o=void 0,o=1;o<n;o++)if(2===Y(e[o-1],e[o],!1))return!1;return!0}function te(e,t,n){var o,i,s,l,u;if(!e)return A;if(e.arrayFormulaMode,n?0:1,!(t=t!==a?t:e.getReference(e.source,U(e.row,e.column,e.rowCount,e.columnCount)))||1!==t.getRangeCount())return A;if(s=[],n){if(l=t.getRow(0)+1,(i=t.getRowCount(0))>1){for(o=0;o<i;o++)s.push([l+o]);return new r.CalcArray(s)}return l}if(u=t.getColumn(0)+1,(i=t.getColumnCount(0))>1){for(o=0;o<i;o++)s.push(u+o);return new r.CalcArray([s])}return u}function ne(e,t,n,o,r){if(r&&n>t.colCount||!r&&n>t.rowCount)return M;var i=o?$(e,t,1,r):X(e,t,0,r);return i>=0?r?K(t,n-1,i):K(t,i,n-1):S}function oe(e,t,n,o){return ne(e,t,n,o,!1)}function re(e,t,n,o){return ne(e,t,n,o,!0)}function ie(e,t,n,o){var r,i,a,l,u,c,h,p,d,g,m,y=t;if(!y.isArray&&!y.isReference)return S;if(r=y.colCount,i=y.rowCount,r>1&&i>1)return A;if(2===n&&(2===o||-2===o))return A;if(a=2===o&&!ee(y,!0),l=-2===o&&!ee(y,!1),a||l)return S;if(u=e,c=e&&e[0],h=-1,f(n)&&(n=0),(f(o)||0===o)&&(o=1),-1===o&&(p=!0),0!==n&&2!==n||(d=0),1===o||-1===o){if(1===n)d=-1;else if(-1===n){if(s.ub(c))return S;d=1}h=X(u,y,d,i>1,p,!0)}else if(2===o||-2===o){if(1===r&&1===i){if(0,!q(c,g=y[0]))return S;if(0===(m=Y(c,g,!1)))return 1;if(0===n)return 0===m?1:S;if(1===n)return 2===m?1:S;if(-1===n)return 1===m?1:S}h=$(u,y,d=2===o?1:-1,i>1)}return-1===h?S:0!==n||ge(c,y[h])?ge(c,y[h])?h+1:2===o&&1===n||-2===o&&-1===n?h+2:h+1:S}function ae(e,t,n,o){return e+=t,o?0!==n&&(e+="[",e+=""+n,e+="]"):e+=n,e}function se(e,t,n){n||(e+="$");for(var r=e.length;t>.1;t=parseInt(""+(t-1)/26,10))e=o.Common.u.Eb(e,r,String.fromCharCode("A".charCodeAt(0)+(t-1)%26));return e}function le(e,t){if(t&&0<h(t)){var n=void 0,o=!r.ei(t[0])&&"_"!==t[0];for(n=1;!o&&n<h(t);n++)o=!r.fi(t[n])&&"_"!==t[n];o?(e+="'",e+=t.replace("'","''"),e+="'"):e+=t,e+="!"}return e}function ue(e,t){var n;return void 0===t&&(t=!1),C(e)||w(e)?n=e.toArray(0,!1):e.length&&e[0].length&&(n=e),n?ce(n,t):g(e)?e:A}function ce(e,t){var n,o,r,i,a,s,l;if(void 0===t&&(t=!1),o=e.rowCount,r=e.colCount,o||r||(o=e.length,r=e[0].length),i=e,t){for(i=[],a=0;a<r;a++)for(s=[],i.push(s),l=0;l<o;l++)s.push(e[l][a]);o=(n=[r,o])[0],r=n[1]}return i.rowCount=o,i.colCount=r,i}function fe(e){return 1===e||-1===e}function he(e,t){var n=t.length;e.sort((function(e,o){var i,a,s,l;for(i=0;i<n;i++)if(s=(a=t[i])[0],0!==(l=r.gOb(e[s],o[s])))return a[1]?l:-l;return 0}))}function pe(e,t,n){if(n)e.forEach((function(e,n){e.push(t[n][0])}));else{var o=t[0];e.forEach((function(e,t){e.push(o[t])}))}}function de(e,t,n){var o,i,a,s,l,u,c,f,h,p,d,m,y,v,b,x,M,S,T,N,I,R,k,E,D;for(void 0===n&&(n=1),o=[],i=3;i<arguments.length;i++)o[i-3]=arguments[i];if(l=0,u=0,c=A,w(e)?a=e:C(e)&&(l=(s=e).getRow(),u=s.getColumn()),f=a||s){if(h=f.getColumnCount(),p=f.getRowCount(),g(e))return c;for(d=[],m=void 0,y=0,v=0,b=void 0,x=void 0,M=1,S=arguments.length;M<S;M+=2){if(N=ue(T=arguments[M]),g(N))return c;if(I=T.getRowCount(),R=T.getColumnCount(),y||(y=(m=1===R)?2:1,x=ue(e,!m)),!(!m&&1===I&&R===h||m&&1===R&&I===p))return c;if(k=w(T),C(T)&&(E=void 0,m?(E=u-T.getColumn())>=0&&E<h?b=E:k=!0:(E=l-T.getRow())>=0&&E<p?b=E:k=!0),k&&(v+=1,b=m?h++:p++,pe(x,N,m)),!fe(D=arguments[M+1]||1))return c;d.push([b,1===D])}return he(x,d),v&&x.forEach((function(e){e.length-=v})),new r.CalcArray(m?x:ce(x,!0))}return c}function ge(e,t){return!!(e===t||p(e)&&p(t)&&d(e)===d(t)||g(e)&&g(t)&&e._code===t._code)}function me(e,t){var n,o;for(n=0,o=e.length;n<o;n++)if(!ge(e[n],t[n]))return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Common"),r=n("CalcEngine"),i=null,a=void 0,s=o.Common.q,l=o.Common.j,u=o.Common.l,c=u.lb,f=l.Fa,l.G,h=o.Common.k.ac,p=u.Ska,d=u.Ra,g=r.Convert.vf,m=r.Convert.Rh,y=r.Convert.Sh,v=r.Convert.Na,b=r.Convert.Pa,C=r.Convert._isReference,w=r.Convert.Ca,x=r.Convert.bc,A=r.Errors.Value,M=r.Errors.Reference,S=r.Errors.NotAvailable,T=r.Errors.Null,N=r.Errors.Calc,I=r.Functions.ak,R=r.Functions.ik,k=r.Functions.jk,P=r.CalcReference.prototype,function(e){function t(t,n,o,r,i,a){var s,l=e.call(this,t,[U(n,o,r,i)])||this;return l.getValue=function(e,t,n){var o=this,r=o.Nc;return 0===r?o.getRow(0)+1+t:1===r?o.getColumn(0)+1+n:P.getValue.call(o,e,t,n)},(s=l).cj=n,s.Lk=o,s.Xj=r,s.Yj=i,s.Nc=a,l}W(t,e),t.prototype.type=function(){return this.Nc},t.prototype.toArray=function(e,t){var n,o,r,i,a,s,l=this,u=[],c=l.cj,f=l.Lk,h=l.Nc,p=l.getRangeCount(),d=l.Xj,g=l.Yj;for(n=0;n<p;n++)for(t||(r=[],u.push(r)),a=0;a<d;a++)for(t||(i=[],r.push(i)),s=0;s<g;s++)o=0===h?c+1+a:1===h?f+1+s:P.getValue.call(l,n,c+a,f+s),t?u.push(o):i.push(o);return t||1!==p||(u=u[0]),u.rowCount=d,u.colCount=g,u.rangeCount=p,u}}(r.CalcReference),H=function(e){function t(t){var n=e.call(this,a)||this;return n.il=t,n}return W(t,e),t.prototype.getRowCount=function(){return r.CalcArrayHelper.getColumnCount(this.il)},t.prototype.getColumnCount=function(){return r.CalcArrayHelper.getRowCount(this.il)},t.prototype.getValue=function(e,t){return r.CalcArrayHelper.getValue(this.il,t,e)},t}(r.CalcArray),z={Hi:2},V={Hi:2,aj:"<= 0",bj:A},G={Hi:4,Ii:0,Ji:!0},I("ADDRESS",(function(e,t,n,o,r){var i=3===n||4===n||7===n||8===n,a=2===n||4===n||6===n||8===n,s="";return e<1&&(o||!i)||e>1048576||t<1&&(o||!a)||t>16384||n<1||8<n?A:(s=le(s,r),o?s=function(e,t,n){return n||(e+="$"),e+t}(s=se(s,t,a),e,i):(s=ae(s,"R",e,i),s=ae(s,"C",t,a)),s)}),2,5,[L={Hi:2},L,{_i:1,Hi:2},B={_i:!0,Hi:7},{_i:"",Hi:5}],a,a,{bk:[2,3,4]}),I("INDEX",(function(e,t,n,o,s){var l,u,c,p,d,g,v,b,C,w,x,S,T;function N(e){return!f(e)&&!e._error}if(l=i,c=(u=e instanceof r.EvaluateContext?e:a)!==i&&u.acceptsReference,p=u!==i&&u.arrayFormulaMode,t instanceof r.CalcReference){if(d={value:-1},g=t,s===a&&(s=1),(s=N(s)&&y(s,d)?d.value-1:l)>=g.getRangeCount())return M;if(s===l||s<0)return A;if(v=g.getRowCount(s),b=g.getColumnCount(s),C=g.getRow(s),w=g.getColumn(s),x=void 0,S=void 0,3===h(arguments)){if(1!==v&&1!==b)return M;1!==b?(o=n,n=1):1!==v&&(o=1)}if(n===a&&(n=0),-1===(n=N(n)&&y(n,d)?d.value-1:l)){if(1!==v&&!c&&!p&&(C>u.row||u.row>=C+v))return A}else{if(n<-1||n===l)return A;if(v<=n)return M;x=n+C}if(o===a&&(o=0),-1===(o=N(o)&&y(o,d)?d.value-1:l)){if(1!==b&&!c&&!p&&(w>u.column||u.column>=w+b))return A}else{if(o<-1||o===l)return A;if(b<=o)return M;S=o+w}return-1===n&&-1===o?g.create([U(C,w,v,b)]):-1===n?g.create([U(C,S,v,1)]):-1===o?g.create([U(x,w,1,b)]):g.create([U(x,S,1,1)])}if(r.Convert.Ca(t))return v=(T=t).getRowCount(),n=n!==a?m(n):-1,o=o!==a?m(o):-1,1!==(s=s!==a?m(s)-1:1)?M:(-1===n&&-1===o?n=o=0:-1===o&&1===v&&(o=n,n=1),n=-1===n?0:n,o=-1===o?0:o,v=T.getRowCount(),b=T.getColumnCount(),n<0||o<0||s<0?A:(n>v&&1===v&&o===a&&(o=n,n=0),v<n||b<o?M:0===n&&0===o?T.slice(0,0,v,b):0===n?T.slice(0,o-1,v,1):0===o?T.slice(n-1,0,1,b):T.getValue(n-1,o-1)))}),2,4,a,0,0,{bk:[1,2,3],dk:!0,fk:3}),I("OFFSET",(function(e,t,n,o,i,s){var l,u,c,f,h,p,d,g,y;return e?t&&t instanceof r.CalcReference&&1===t.getRangeCount()?(i=i!==a?m(i):t.getRowCount(0),s=s!==a?m(s):t.getColumnCount(0),l=t.getRow(0)+n,u=t.getColumn(0)+o,i<=0||s<=0||l<0||u<0?M:(c=t.create([{row:l,col:u,rowCount:i,colCount:s}]),f=e.row,h=e.column,p=e.source.getCalcSourceModel().qg(f,h),c.ck=!0,d=t.getSource(),p&&d.getRangeKey&&(g={id:d.id,row:l,col:u,rowCount:i,colCount:s},y=d.getRangeKey(d,g),p.eOb||(p.eOb={}),p.eOb[y]=g),c)):A:S}),3,5,[{},L,L],0,0,{bk:[3,4],dk:!0,fk:2,returnReference:!0}),I("ROW",(function(e,t){return te(e,t,!0)}),0,1,a,-1,a,{dk:!0,ek:-1,expandColumns:!1}),I("COLUMN",(function(e,t){return te(e,t,!1)}),0,1,a,-1,a,{bk:0,dk:!0,ek:-1,expandRows:!1}),I("ROWS",(function(e){return r.CalcArrayHelper.getRowCount(e)}),1,1,a,-1,-1,{ek:-1,expandColumns:!1,ck:!0}),I("COLUMNS",(function(e){return r.CalcArrayHelper.getColumnCount(e)}),1,1,a,-1,-1,{ek:-1,expandRows:!1,ck:!0}),I("TRANSPOSE",(function(e){return new H(e)}),1,1,a,-1,-1),I("LOOKUP",(function(e,t,n){var o,i,s,l,u,c,h,p=[];if(t)for(o=0;o<t.length;o++)f(t[o])||p.push(t[o]);if(t.colCount<=t.rowCount?(p.colCount=t.colCount,p.rowCount=Math.ceil(p.length/p.colCount)):(p.rowCount=t.rowCount,p.colCount=Math.ceil(p.length/p.rowCount)),f(t.isReference)||(p.isReference=t.isReference),f(t.isArray)||(p.isArray=t.isArray),p.rangeCount=t.rangeCount,-1,l=p.colCount,u=p.rowCount,c=e,n===a)return h=l>u?oe(c,p,u,!0):re(c,p,l,!0),g(h)?S:h;if(s=r.Convert.Ph(n,0,!0,!1,!1)){if(s.colCount>1&&s.rowCount>1)return S}else s=p;return(i=$(c,p,1,!(l>u)))>=0?(l=s.colCount)>(u=s.rowCount)?K(s,i,u-1):K(s,l-1,i):S}),2,3,[G,{Hi:4,Ii:0,Ji:!0,xTa:!0}],"!= 0","!= 0",{fk:1}),I("HLOOKUP",oe,3,4,[G,G,V,B],1,1,{bk:3}),I("VLOOKUP",re,3,4,[G,G,V,B],1,1,{bk:3,TAb:!0}),I("XLOOKUP",(function(e,t,n,o,i,a){var s,l,u,c,f,h,p,d,g,m,y=n.getRowCount(),v=n.getColumnCount(),b=1===t.rowCount&&t.colCount>=1,C=1===y&&v>=1;if(b&&t.colCount!==v||!b&&t.rowCount!==y)return A;if((s=ie(e,t,i,a))===S)return"string"==typeof o?o:S;if(s===A)return A;if(s>0){if(s-=1,l=[],r.Convert.Ca(n)){if(b)for(u=0;u<y;u++)c=n.getValue(0,s),l.push([c]);else f=C?[n.getValue(0,s)]:[n.getValue(s,0)],l.push(f);return new r.CalcArray(l)}if(n instanceof r.CalcReference)return p=(h=n).getRow(),d=h.getColumn(),g=y,m=v,b?(d=h.getColumn()+s,m=1):(p=h.getRow()+s,g=1),h.create([{row:p,col:d,rowCount:g,colCount:m}])}}),3,6,[G,G,{},{Hi:5},{Hi:2,_i:0},{Hi:2,_i:1}],[1,2],[1,2],{bk:[3,4,5]}),I("CHOOSE",(function(e){var t=arguments;return e<1||h(t)<=e?A:f(t[e])?0:t[e]}),2,255,L,">= 1",">= 1",{gk:">= 1",isBranch:!0,findTestArgument:0,findBranchArgument:function(e){var t={value:-1};return g(e)?-1:(y(e,t),t.value)}}),I("MATCH",(function(e,t,n){var o,r,s,l=e,u=t;return u.isArray||u.isReference?(o=u.colCount,r=u.rowCount,s=-1,o>1&&r>1||1===n&&!ee(u,!0)||-1===n&&!ee(u,!1)?S:(n===a?n=1:n===i&&(n=0),1===n?s=$(l,u,1,r>1):0===n?s=X(l,u,0,r>1):-1===n&&(s=$(l,u,-1,r>1)),-1===s?S:s+1)):S}),2,3,[G,G,z],1,1,{}),I("XMATCH",ie,2,4,[G,G,z,z],1,1,{}),I("INDIRECT",(function(e,t,n){var o,i,a,s,u,c,f,h,p,d,g,m,y;return e?t?(a={row:o=e.row,col:i=e.column},(s=e.parser)||(s=e.parser=new r.Parser),(c=(u=e.source).parserContext)?(c.useR1C1=!n,c.row=a&&a.row||0,c.column=a&&a.col||0,c.baseIdentity=a,c.source=e.source):(u.parserContext=c=e.source?e.source.getParserContext(!n,a):new r.ParserContext(e.source,!n,a),c.onlyValidateSourceNameWithSpecial=!0),n?f=s.parse(c,t):((p=u.expressions)||(p=u.expressions={}),(f=p[t])||(f=s.parse(c,t),p[t]=f)),f?(8===f.type&&(f.source?f=(h=f.source).getCustomName(f.value):f=e.getName(f.value)),!f||l.Ea(f.type,[1,13])<0?M:(h=f.source||e.source,25===f.type||26===f.type?h.getValueByName(f.nameIdentity):(d=f.getRange(o,i),13===f.type&&(h=f.source),g=e.source.getCalcSourceModel().qg(o,i),m=null,1!==d.rowCount||1!==d.colCount||e.acceptsReference||e.arrayFormulaMode?((m=h.getReference(d)).ck=!0,d.id=h.id,g&&h.getRangeKey&&(y=h.getRangeKey(h,d),g.eOb||(g.eOb={}),g.eOb[y]=d)):(m=h.getValue(d.row,d.col),g&&(g.fOb||(g.fOb={}),g.fOb[t]=f)),m))):M):M:S}),1,2,[{Hi:5},B],a,a,{bk:2,dk:!0}),I("HYPERLINK",(function(e,t){var n,o="__proto__";return(n=x(2===arguments.length?t:e))[o].hyperlink=x(e),n}),1,2),I("AREAS",(function(){var e,t=0;for(e=0;e<h(arguments);e++){if(0===arguments[e].length)return T;arguments[e].isReference&&(t+=arguments[e].rangeCount)}return t}),1,a,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),I("FORMULATEXT",(function(e,t){var n=t.getRow(0),o=t.getColumn(0),r=t.getSource().getCalcSourceModel().getFormula(n,o);return r?"="+r:S}),1,1,a,-1,a,{dk:!0}),I("ISFORMULA",(function(e,t){var n=t.getRow(0),o=t.getColumn(0);return!!t.getSource().getCalcSourceModel().getFormula(n,o)}),1,1,a,-1,a,{dk:!0}),I("SORT",(function(e,t,n,o){var i,a,s,l,u,c,f,h,p,d,m,y,v,b,x,M,S,T,N,I,R;if(void 0===t&&(t=1),void 0===n&&(n=1),void 0===o&&(o=!1),i=ue(e,o),g(i))return i;if(a=i,s=[],C(t)||w(t)){if(h=(f=t.toArray(0,!1)).rowCount,p=f.colCount,d=0,C(n)||w(n)){if(d=(u=n.toArray(0,!1)).rowCount,1!==p){if(p<1||1!==u.colCount&&u.colCount!==p||1!==h||!function(e){if(e&&e.length&&e.length>=0){for(var t=0;t<e.length;t++)if("number"!=typeof e[t])return!1;return!0}return!1}(f[0]))return A;if((m=[]).push(e),o)for(a=ce(a,o),y=0;y<p;y++){for(v=[],b=0;b<a[0].length;b++)v.push(a[f[0][y]-1][b]);m.push(new r.CalcArray([v])),1===d?m.push(u[0][0]):m.push(u[y][0])}else for(y=0;y<p;y++){for(v=[],b=0;b<a.length;b++)v.push([a[b][f[0][y]-1]]);m.push(new r.CalcArray(v)),1===d?m.push(u[0][0]):m.push(u[y][0])}return de.apply(de,m)}if(1!==u.colCount||1!==d&&d!==h)return A;1===d&&(d=0,c=u[0][0])}else c=n;for(l=0;l<h;l++)s.push([f[l][0],l<d?u[l][0]:c])}else if(C(n)||w(n)){if(1!==(u=n.toArray(0,!1)).colCount||1!==u.rowCount)return A;s.push([t,u[0][0]])}else s.push([t,n]);for(x=a.colCount,M=[],S=0,T=s;S<T.length;S++){if(I=(N=T[S])[0],R=N[1],I<1||I>x||!fe(R))return A;M.push([I-1,1===R])}return he(a,M),new r.CalcArray(o?ce(a,o):a)}),1,4,a,[0,1,2],[0,1,2],{bk:[1,2,3]},!0),I("SORTBY",de,2,a,a,[0,"%= 1"],[0,"%= 1"],a,!0),I("UNIQUE",(function(e,t,n){var o,i,a,s;return void 0===t&&(t=!1),void 0===n&&(n=!1),o=ue(e,t),g(o)?o:(a=[],s=(i=o).rowCount,i.forEach((function(e,t){var o,r,l;if(!e.duplicated){for(o=0,r=t+1;r<s;r++)me(e,l=i[r])&&(l.duplicated=!0,o++);n&&0!==o||a.push(e)}})),new r.CalcArray(t?ce(a,t):a))}),1,3,a,[0],[0],{bk:[1,2]},!0),I("FILTER",(function(e,t,n){var o,i,a,s=ue(e);return g(s)?s:(o=s,i=[].concat(ue(t)),a=[],o.forEach((function(e,t){i[t][0]&&a.push(e)})),0===a.length?f(n)?N:n:new r.CalcArray(a))}),2,3,a,[0,1,2],[0,1,2],a,!0),I("@",(function(e,t){var n,o,r,i,a,s,l,u,c,f;return w(t)?t.getValue(0,0):C(t)?(o=(n=t).getColumn(),r=n.getRow(),i=n.getColumnCount(),a=n.getRowCount(),u=(s=e.row)-r,c=(l=e.column)-o,f=e.source===n.getSource(),1===a&&(!f||r!==s)&&c>=0&&c<i?n.getValue(0,0,c):1===i&&(!f||o!==l)&&u>=0&&u<a?n.getValue(0,u,0):1===a&&1===i?n.getValue(0,0,0):A):t}),1,1,a,[0],[0],{dk:!0},!0)},"./src/functions-stat.ts":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe,re,ie,ae,se,le,ue,ce,fe,he,pe,de,ge,me,ye,ve,be,Ce,we,xe,Ae,Me,Se,Te,Ne,Ie,Re,ke,Ee,De,je,_e,Oe,Fe,Pe,He,Be,Le,ze,Ve,Ge,We,Ue,Ze,qe,Je,Qe;function Ye(e){var t,n,o;return 0===e?t=0:(n=.5*Math.abs(e))>=3?t=1:n<1?t=((((((((.000124818987*(o=n*n)-.001075204047)*o+.005198775019)*o-.019198292004)*o+.059054035642)*o-.151968751364)*o+.319152932694)*o-.5319230073)*o+.797884560593)*n*2:t=(((((((((((((-45255659e-12*(n-=2)+.00015252929)*n-19538132e-12)*n-.000676904986)*n+.001390604284)*n-.00079462082)*n-.002034254874)*n+.006549791214)*n-.010557625006)*n+.011630447319)*n-.009279453341)*n+.005353579108)*n-.002141268741)*n+.000535310849)*n+.999936657524,e>0?.5*(t+1):.5*(1-t)}function Ke(e,t,n,o){var r,a,s=[];return pt(e,s),0===(r=i(s))||t<s[0]||t>s[r-1]?T:0!==(a=1===r?1:function(e,t,n){var o,r,a,s,l,u=i(e);if(t!==e[0]){for(a=0,s=e[0],r=1;r<u&&e[r]<t;r++)e[r]!==s&&(a=r,s=e[r]);e[r]!==s&&(a=r),t===e[r]?o=n?a/(u-1):(r+1)/(u+1):0===a?o=0:(l=(t-e[a-1])/(e[a]-e[a-1]),o=n?(a-1+l)/(u-1):(a+l)/(u+1))}else o=n?0:1/(u+1);return o}(s,t,o))?A(a*f(10,n))/f(10,n):a}function $e(e){return[22250738585072014e-324,17976931348623157e292,f(2,-53),f(2,-52),j.Ek(2,10)][e-1]||0}function Xe(e,t,n){var o,r=0,i=0;if(t<1)return 0;for(o=1;o<=t;o++)if((i+=C(D(e[r=t-o])))>n)return r;return r}function et(e,t,n){var o,r,i,a,s;if(n<1||n>1e3||e<-1.1||e>1.1)return NaN;for(o=2*e,i=r=0,a=0,s=1;s<=n;s++)i=r,a=o*(r=a)-i+D(t[n-s]);return.5*(a-i)}function tt(e){var t,n=[.16663894804518634,-1384948176067564e-20,9.81082564692473e-9,-1809129475572494e-26,6221098041892606e-29,-3399615005417722e-31,2683181998482699e-33,-2.868042435334643e-20,39628370610464347e-38,-6831888753985767e-39,14292273559424982e-41,-35475981581010704e-43,1025680058010471e-43,-3.401102254316749e-30,1276642195630063e-46],o=Xe(n,15,$e(3)),r=1/w($e(3)),i=b(p(x($e(2)/12),-x(12*$e(1))));return e<10?NaN:e>=i?4930380657631324e-47:e<r?et((t=10/e)*t*2-1,n,o)/e:1/(12*e)}function nt(e){var t=[1.037869356274377,-.13364301504908918,.019408249135520562,-.0030107551127535777,.0004869461479715485,-8105488189317536e-20,13778847799559525e-21,-2380221089435897e-21,4.1640416213865184e-7,-7.359582837807599e-8,1.3117611876241675e-8,-2.3546709317742423e-9,4.2522773276035e-10,-771908941348408e-25,1407574648135907e-26,-25769072058024682e-28,4734240666629442e-28,-8724901267474264e-29,1612461490274055e-29,-29875652015665774e-31,5548070120908289e-31,-10324619158271569e-32,19250239203049852e-33,-3595507346526515e-33,6726454253787686e-34,-1260262416873522e-34,2.364488440860621e-20,-44419377050807936e-37,8354659446403425e-37,-15731559416479563e-38,29653128740247425e-39,-5594958348181595e-39,1056635426883568e-39,-19972483680670205e-41,3778297781883936e-41,-7153158688908174e-42,13552488463674214e-43,-25694673048487566e-44,48747756066216946e-45,-9.254211253084972e-30,1.757859784176024e-30,-3341002667773101e-46,6353393618023618e-47],n=Xe(t,43,.1*$e(3));return e<=-1?NaN:C(e)<=.375?e*(1-e*et(e/.375,t,n)):x(e+1)}function ot(e){var t,n,o,r,i,a,s=1,l=[1,.5772156649015329,-.6558780715202538,-.0420026350340952,.1665386113822915,-.0421977345555443,-.009621971527877,.007218943246663,-.0011651675918591,-.0002152416741149,.0001280502823882,-201348547807e-16,-12504934821e-16,1133027232e-15,-2.056338417e-7,6.116095e-9,5.0020075e-9,-1.1812746e-9,1.043427e-10,77823e-16,-36968e-16,51e-14,-206e-16,-54e-16,14e-16];if(e>171)return 1e308;if(e===E(e))if(e>0)for(t=1,r=2;r<e;r++)t*=r;else t=1e308;else{if(C(e)>1){for(o=C(e),i=E(o),s=1,n=1;n<=i;n++)s*=o-n;o-=i}else o=e;for(a=l[24],n=23;n>=0;n--)a=a*o+l[n];t=1/(a*o),C(e)>1&&(t*=s,e<0&&(t=-y/(e*t*g(y*e))))}return t}function rt(e){var t,n,o,r,i,a=0,s=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059],l=e;if(e<=0)return 1e308;if(1===e||2===e)return 0;for(e<=7&&(l=e+(a=E(7-e))),n=1/(l*l),o=2*y,r=s[9],t=8;t>=0;t--)r=r*n+s[t];if(i=r/l+.5*x(o)+(l-.5)*x(l)-l,e<=7)for(t=1;t<=a;t++)i-=x(l-1),l-=1;return i}function it(e,t){var n,o,r,i=o=e;return t<i&&(i=t),t>o&&(o=t),i<0?NaN:0===i?U:i>=10?(n=tt(i)+tt(o)-tt(i+o),-.5*x(o)+.9189385332046728+n+(i-.5)*x(i/(i+o))+o*nt(-i/(i+o))):o>=10?(n=tt(o)-tt(i+o),r=un(i),P(r)?NaN:D(r)+n+i-i*x(i+o)+(o-.5)*nt(-i/(i+o))):x(ot(i)*(ot(o)/ot(i+o)))}function at(e,t,n){var o,r,i,a,s,l,u,c,f,g,m,y=$e(3),v=x(y),C=$e(1),w=x(C),A=e,M=t,S=n;if(M/(M+S)<e&&(A=1-A,M=n,S=t),(M+S)*A/(M+1)<y)o=0,(i=M*x(h(A,C))-x(M)-it(M,S))>w&&0!==A&&(o=b(i)),A===e&&M===t||(o=1-o);else{if(0===(l=S-d(S))&&(l=1),o=0,(i=M*x(A)-it(l,M)-x(M))>=w&&(r=(o=b(i))*M,1!==l))for(s=E(h(v/x(A),4)),u=1;u<=s;u++)o+=(r=r*((a=u)-l)*A/a)/(M+a);if(S>1){for(i=M*x(A)+S*x(1-A)-it(M,S)-x(S),c=E(h(i/w,0)),r=b(i-c*w),g=S*(f=1/(1-A))/(M+S-1),m=0,S===(s=E(S))&&(s-=1),u=1;u<=s&&!(g<=1&&r/y<=m);u++)(r=(S-(a=u)+1)*f*r/(M+S-a))>1&&(c-=1,r*=C),0===c&&(m+=r);o+=m}A===e&&M===t||(o=1-o),o=h(p(o,1),0)}return o}function st(e,t,n,o){var r,i,a,s,l,u,c,f,p,d,g,m;function y(e,t){return e<0&&t>0||e>0&&t<0}for(1e-307,222045e-21,r=e.ge(t),i=e.ge(n),s=0;s<1e3&&!y(r,i);s++)C(r)<=C(i)?(a=t,(t+=2*(t-n))<0&&(t=0),n=a,i=r,r=e.ge(t)):(a=n,n+=2*(n-t),t=a,r=i,i=e.ge(n));if(0===r)return t;if(0===i)return n;if(!y(r,i))return o.jl=!0,0;for(l=t,u=r,c=n,f=i,p=t,d=r,g=.5*(t+n),m=!0,s=0;s<500&&C(d)>1e-307&&n-t>222045e-21*h(C(t),C(n));)m&&(u!==f&&f!==d&&d!==u?m=t<(g=l*d*f/(d-u)/(f-u)+p*f*u/(f-d)/(u-d)+c*u*d/(u-f)/(d-f))&&g<n:m=!1),m||(g=.5*(t+n),c=n,f=i,m=!0),l=c,c=p,p=g,u=f,f=d,y(r,d=e.ge(g))?(n=p,i=d):(t=p,r=d),m=m&&2*C(d)<=C(f),++s;return p}function lt(e,t){var n,o,r,a,s=i(t);for(n=0;n<s;n++)a=(r=(o=D(t[n]))-e.M)/(e.N+1),e.M+=a,e.Q+=e.N*r*a,e.N++,e.kl+=o}function ut(e){var t,n=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],o=1.000000000190015,r=e,i=e+5.5;for(i-=(e+.5)*x(i),t=0;t<=5;t++)o+=n[t]/++r;return-i+x(2.5066282746310007*o/e)}function ct(e,t,n){var o,r,i,a,s,l,u,c,f,h,p,d,g,m=0===n||1===n?0:b(ut(e+t)-ut(e)-ut(t)+e*x(n)+t*x(1-n)),y=n>=(e+1)/(e+t+2);for(y&&(o=e,e=t,t=o,n=1-n),r=4450147717014403e-323,100,s=e-1,l=1,C(u=1-(i=e+t)*n/(a=e+1))<r&&(u=r),c=u=1/u,f=1,h=2;f<=100;f++,h+=2)if(C(u=1+(p=f*(t-f)*n/((s+h)*(e+h)))*u)<r&&(u=r),C(l=1+p/l)<r&&(l=r),c*=(u=1/u)*l,C(u=1+(p=-(e+f)*(i+f)*n/((e+h)*(a+h)))*u)<r&&(u=r),C(l=1+p/l)<r&&(l=r),c*=d=(u=1/u)*l,C(D(d-1))<5e-324)return g=m*c/e,y?1-g:g;return N}function ft(e,t){var n,o,r,a,s=i(t);for(n=0;n<s;n++)(o=t[n])!==Z&&(a=(r=o-e.M)/(e.N+1),e.M+=a,e.Q+=e.N*r*a,e.N++,e.kl+=o)}function ht(e){e.sort((function(e,t){return e-t}))}function pt(e,t){var n,o;for(n=0;n<i(e);n++)(o=e[n])!==Z&&t.push(o);ht(t)}function dt(e){var t,n=[];for(t=0;t<i(e);t++)pt(e[t],n);return n}function gt(e,t,n){var o,r,i,a,s,l,u,c,h=Math.expm1||function(e){return b(e)-1},p=Math.log1p||function(e){return x(1+e)};return e<=0?0:e>=1?1:1===n?f(e,t):1===t?-h(n*p(-e)):(r=.5-e+.5,i=p(-e),a=e,s=x(e),l=t,u=n,(c=e>t/(t+n))&&(l=n,u=t,a=r,r=e,s=i,i=x(e)),o=function(e,t,n){var o,r,i,a,s,l,u,c,f,h=1,p=1,d=1-(t+n)/(t+1)*e;0===d?(o=0,r=1,a=1):a=(o=1)*(r=1/d),i=1,s=1,5e4,l=!1;do{o=(h=(o+(c=s*(n-s)*e/(((u=t+2*s)-1)*u))*h)*r)+(f=-(t+s)*(t+n+s)*e/(u*(u+1)))*o*r,0!=(d=(p=(d+c*p)*r)+f*d*r)&&(l=C(a-(i=o*(r=1/d)))<222045e-21*C(a)),a=i,s+=1}while(s<5e4&&!l);return a}(a,l,u),o/=l,o*=l>1&&u>1&&l/(l+u)<.97&&u/(l+u)<.97?mt(a,l,u)*a*r:b(l*s+u*i-yt(!1,l,u)),c&&(o=.5-o+.5),o>1&&(o=1),o<0&&(o=0),o)}function mt(e,t,n){var o,r,i,a,s,l;return 1===t?1===n?1:2===n?-2*e+2:e<=.01?n+n*b((n-1)*x(1-e))-1:n*f(.5-e+.5,n-1):1===n?2===t?t*e:t*f(e,t-1):e<=0&&!(t<1&&0===e)||e>=1&&!(n<1&&1===e)?0:(o=x($e(2)),r=x($e(1)),i=x(e<.1?1+e:1-e),a=(t-1)*x(e),s=(n-1)*i,l=yt(!1,t,n),a<o&&a>r&&s<o&&s>r&&l<o&&l>r&&a+s<o&&a+s>r?f(e,t-1)*f(.5-e+.5,n-1)/yt(!0,t,n):b(a+s-l))}function yt(e,t,n){var o,r,i,a,s,l,u,c=n,f=t;return t>n&&(o=c,c=f,f=o),e&&c+f<171.624376956302?bt(c)/bt(c+f)*bt(f):(6.02468004077673,r=5.52468004077673,i=wt(c),i/=wt(c+f),i*=wt(f),a=c+f+r,s=e?i*w(a/(c+r)/(f+r)):x(i)+.5*(x(a)-x(c+r)-x(f+r)),l=c/(f+r),u=-c*x(1+f/(c+r))-f*x(1+l)-r,e?b(u)*s:u+s)}function vt(e){var t=wt(e),n=e+6.02468004077673-.5,o=f(n,e/2-.25);return t*=o,t/=b(n),t*=o,e<=20&&e===j.wk(e)&&(t=A(t)),t}function bt(e){var t,n=x(y),o=x($e(2));return e>171.624376956302?N:e>=1?vt(e):e>=.5?vt(e+1)/e:e>=-.5?vt(e+2)-x(e+1)-x(C(e))>=o?N:vt(e+2)/(e+1)/e:(t=vt(1-e)+x(C(g(y*e))))-n>=o?0:t<0&&n-t>o?N:b(n-t)*(g(y*e)<0?-1:1)}function Ct(e){return e>=171.624376956302?vt(e):e>=1?x(vt(e)):e>=.5?x(vt(e+1)/e):vt(e+2)-x(e+1)-x(e)}function wt(e){var t,n,o,r,i=[23531376880.41076,42919803642.6491,35711959237.35567,17921034426.03721,6039542586.352028,1439720407.3117216,248874557.86205417,31426415.585400194,2876370.6289353725,186056.26539522348,8071.672002365816,210.82427775157936,2.5066282746310002],a=[0,39916800,120543840,150917976,105258076,45995730,13339535,2637558,357423,32670,1925,66,1];if(e<=1)for(t=i[12],n=a[12],o=11;o>=0;--o)t*=e,t+=i[o],n*=e,n+=a[o];else for(r=1/e,t=i[0],n=a[0],o=1;o<=12;++o)t*=r,t+=i[o],n*=r,n+=a[o];return t/n}function xt(e,t){return e<=0?0:function(e,t){var n=e*x(t)-t-Ct(e),o=b(n);return t>e+1?1-o*function(e,t){var n=$e(3),o=.5*n,r=1/n,i=0,a=0,s=1-e,l=t+2-e,u=0,c=t+1,f=1,h=1,p=l*t,d=t,g=c/p,m=!1,y=0;do{u=c*(l+=2)-f*(a=(s+=1)*(i+=1)),0!=(h=p*l-d*a)&&(m=C((g-(y=u/h))/y)<=o,g=y),f=c,c=u,d=p,p=h,C(u)>r&&(f*=n,c*=n,d*=n,p*=n)}while(!m&&i<1e4);return m?g:S}(e,t):o*function(e,t){var n=.5*$e(3),o=e,r=1/e,i=r,a=1;do{i+=r=r*t/(o+=1),a+=1}while(r/i>n&&a<=1e4);return a>1e4?S:i}(e,t)}(t/2,e/2)}function At(e,t,n,o){var r,i,a,s=_(n,e);return P(s)?s:(r=D(s),s=_(o-n,t-e),P(s)?s:(i=D(s),s=_(o,t),P(s)?s:(a=D(s),R(r*i/a))))}function Mt(e,t,n){var o,r=gt(t/(t+e*e),t/2,.5);switch(n){case 1:return.5*r;case 2:return r;case 3:return f(1+e*e/t,-(t+1)/2)/(w(t)*yt(!0,.5,t/2));case 4:return o=.5*gt(t/(e*e+t),.5*t,.5),e<0?o:1-o}return S}function St(e,t,n){var o={jl:!1},r=st(function(e,t,n){return{ge:function(o){return e-Mt(o,t,n)}}}(e,t,n),.5*t,t,o);return o.jl?T:r}function Tt(e,t){var n,o,r,a,s,l=!1,u=0;for(o=0;o<i(t);o++)for(s=t[o],r=0;r<i(s);r++)if(a=s[r],F(a)||V(a)||G(a))n=G(a)?0:D(a),(!l||e&&n>u||!e&&n<u)&&(u=n),l=!0;else if(P(a))return a;return u}function Nt(e,t,n,o){var r,a,s,l=0,u=0,c=0;for(r=0;r<i(t);r++)(a=t[r])!==Z&&(a<n?l++:n<a?c++:u++);return 0===u?T:(s=(0===o?c:l)+1,e?s:s+(u-1)/2)}function It(e,t,n){var o,s,l,u,c,f,h,p;for(l=0;l<i(e);l++)for(f=!!(c=e[l]).isArray,h=!!c.isReference,u=0;u<i(c);u++)if((s=c[u])!==a)if(G(s)){if(r.ExcelCompatibleCalcMode){if(f)continue;if(h){t.n++;continue}}if(p={value:0},r.Convert.Th(s,p))o=p.value,t.ll+=o,t.ml+=o*o;else if(!c.isArray&&!c.isReference)return S;t.n++}else{if(P(s))return s;!F(s)||n&&"boolean"==typeof s&&c.isArray||(o=D(s),t.ll+=o,t.ml+=o*o,t.n++)}}function Rt(e,t,n,o){var r,i={ll:0,ml:0,n:0},a=It(e,i,o);return P(a)?a:i.n<=t?M:(r=h(0,(i.n*i.ml-i.ll*i.ll)/(i.n*(i.n-t))),r=n?w(r):r,R(r))}function kt(e,t,n){var o,r,a,s,l,u=0,c=0,f=0,h=0,p=i(t);if(p!==i(n))return T;for(a=0;a<p;a++)o=t[a],r=n[a],o!==Z&&r!==Z&&(u+=o,c+=r,h++);if(h<=1)return M;for(s=u/h,l=c/h,a=0;a<p;a++)o=t[a],r=n[a],o!==Z&&r!==Z&&(f+=(o-s)*(r-l));return R(e?f/h:f/(h-1))}function Et(e,t){var n,o,r,a,s=e?1:0,l=0;for(r=0;r<i(t);r++)for(n=t[r],a=0;a<i(n);a++)if((o=n[a])!==Z){if(o<=0)return N;s=e?s*o:s+1/o,l++}return e?l<=0?M:R(f(s,1/l)):0===s?M:R(l/s)}function Dt(e,t,n,o,i){var l,u,c,f,h,p,d,g,m,y,v,C,A,M,S,I,R,E,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y=t.rowCount,K=t.colCount;if(e?n=n!==s?k(n,1,!1,!0,!0):t:(l=n!==s?n:function(e,t){var n=[];for(u=0;u<e;u++)for(n[u]=[],c=0;c<t;c++)n[u][c]=u*t+c+1;return new r.CalcArray(n)}(Y,K),n=k(l,1,!1,!0,!0)),f=n.rowCount,h=n.colCount,Y===f&&K===h&&(o||!i)){for(g=e?f*h:D(f*h),E=0,j=0,_=0,O=0,F=0,P=void 0,u=0;u<f;u++)for(c=0;c<h;c++)m=n[u][c],y=t[u][c],e&&(y=x(y)),E+=m,j+=m*m,_+=y,O+=y*y,F+=m*y;return S=g*j-E*E,d=o?(g*F-E*_)/S:F/j,P=o?(_*j-E*F)/S:0,e&&(d=b(d),P=b(P)),A=[[d,P]],i&&(A[1]=[],A[2]=[],A[3]=[],A[4]=[],z=O-P*_-d*F,V=(L=g*F-E*_)*L/((H=g*j-E*E)*(B=g*O-_*_)),g<3?(A[1][0]=N,A[1][1]=N,A[2][1]=N,A[3][0]=N):(A[1][0]=w(z*g/(H*(g-2))),A[1][1]=w(z*j/(H*(g-2))),A[2][1]=w((B-L*L/H)/(g*(g-2))),A[3][0]=1===V?N:V*(g-2)/(1-V)),A[2][0]=V,A[3][1]=g-2,A[4][0]=B/g-z,A[4][1]=z),new r.CalcArray(A)}if(1===K&&Y===f||1===Y&&K===h){for(y=[],m=[],S=1===K,g=f,d=h,u=0;u<g;u++)y[u]=o?t[u][0]:t[0][u],e&&(y[u]=x(y[u]));for(u=0;u<g;u++)for(m[u]=[],c=0;c<d;c++)m[u][c]=S?n[u][c]:n[c][u];for(G=[],p=0;p<d+1;p++)G[p]=[];for(v=0;v<d+1;v++)for(C=0;C<d+2;C++)G[v][C]=0;for(W=[],v=0;v<d+2;v++)W[v]=0;for(U=i?[]:a,p=0;p<g;p++)for(W[d+1]+=y[p]*y[p],G[0][d+1]+=y[p],W[0]=G[0][d+1],u=0;u<d;u++)for(G[0][u+1]+=m[p][u],G[u+1][0]=G[0][u+1],G[u+1][d+1]+=m[p][u]*y[p],W[u+1]=G[u+1][d+1],c=u;c<d;c++)G[c+1][u+1]+=m[p][u]*m[p][c],G[u+1][c+1]=G[c+1][u+1];if(G[0][0]=g,i){for(v=0;v<d+1;v++)for(U[v]=[],C=0;C<d+1;C++)U[v][C]=0;for(u=0;u<d+1;u++)U[u][u]=1}for(Z=o?0:1,u=0;u<d+1;u++){if(0===G[u][u]){for(M=!1,c=u+1;!M&&c<d+1;c++)if(0!==G[c][u]){for(p=0;p<d+2;p++)S=G[u][p],G[u][p]=G[c][p],G[c][p]=S;if(i)for(p=0;p<d+1;p++)S=U[u][p],U[u][p]=U[c][p],U[c][p]=S;M=!0}if(!M)return N}for(I=1/G[u][u],p=Z;p<d+2;p++)G[u][p]*=I;if(i)for(p=Z;p<d+1;p++)U[u][p]*=I;for(c=Z;c<d+1;c++)if(c!==u){for(I=-G[c][u],p=Z;p<d+2;p++)G[c][p]+=I*G[u][p];if(i)for(p=Z;p<d+1;p++)U[c][p]+=I*U[u][p]}o||(G[0][d+1]=0)}for(A=e?[[],d+1]:[[]],u=0;u<d+1;u++)A[0][u]=e?b(G[d-u][d+1]):G[d-u][d+1];if(i){if(e)A[1]=[],A[2]=[],A[3]=[],A[4]=[];else for(v=1;v<5;v++)for(A[v]=[],C=0;C<d+1;C++)A[v][C]=0;for(q=void 0,void 0,void 0,J=W[d+1]-W[0]*W[0]/g,q=W[d+1],u=0;u<d+1;u++)q-=G[u][d+1]*W[u];if(Q=J-q,A[2][0]=0===J?N:Q/J,A[4][0]=Q,A[4][1]=q,0===(S=o?g-d-1:g-d)){for(u=0;u<d+1;u++)A[1][u]=N;A[2][1]=N}else{for(R=q/D(S),o||(A[1][d]=T),u=Z;u<d+1;u++)A[1][d-u]=w(R*U[u][u]);A[2][1]=w(R)}for(A[3][0]=0===q?N:D(S)*Q/(q*D(d)),A[3][1]=D(S),u=2;u<5;u++)for(c=2;c<d+1;c++)A[u][c]=T}return e||(A=[A[0]]),new r.CalcArray(A)}return N}function jt(e,t){var n,o,r,a,s,l=0,u=0,c=0,f=[];for(r=0;r<i(t);r++)for(s=t[r],f.push(s),a=0;a<i(s);a++)(n=s[a])!==Z&&(l+=n,c++);for(o=l/c,r=0;r<i(t);r++)for(s=f[r],a=0;a<i(s);a++)(n=s[a])!==Z&&(u+=e?(n-o)*(n-o):C(n-o));return e?R(u):0===c?M:R(u/c)}function _t(){return B(arguments,2,7)}function Ot(e,t){return L([e,t],16)}function Ft(e,t,n){var o,r,a,s=0,l=0,u=O(t);if(e.rowCount!==n.rowCount||e.colCount!==n.colCount)return S;for(o=0;o<i(e);o++)if(r=e[o],u&&u(r,!0)&&(a=n[o])!==Z){if(P(a))return a;s+=a,l++}return 0===l?M:R(s/l)}function Pt(e,t,n,o){var i,a,s,l=t,u=t,c=e?l.getRowCount():u.getRowCount(0),f=e?l.getColumnCount():u.getColumnCount(0),h=[];for(i=0;i<c;i++)for(h[i]=[],a=0;a<f;a++)s=e?l.getValue(i,a):u.getValue(0,i,a),h[i][a]=Ft(n,s,o);return new r.CalcArray(h)}function Ht(){return L(arguments,13)}function Bt(e,t,n){var o=r.CalcArrayHelper;if(r.Convert._isReference(e)){if(1!==o.getLength(e))return S;e=o.getValueByIndex(e,0)}return e=D(e),l(e)?S:Nt(!0,t,e,n)}function Lt(e,t,n){return Ke(e,t,n,!0)}function zt(e,t){return L([e,t],17)}function Vt(e,t){var n,o,r=0,s=0===t||"*"===t,l=O(t);for(n=0;n<i(e);n++)o=e[n],s&&o===a||!l||!l(o)||r++;return R(r)}function Gt(){return B(arguments,2,8)}function Wt(){return B(arguments,2,10)}function Ut(){return B(arguments,2,11)}function Zt(e,t){return kt(!0,e,t)}function qt(e,t,n){var o=pn(e/2);return P(o)?o:-D(o)*(t/w(n))}function Jt(e){var t,n=e,o=n+5.5;return o-=(n+.5)*x(o),t=1.000000000190015+76.18009172947146/(e+1),t-=86.50532032941678/(e+2),t+=24.01409824083091/(e+3),t-=1.231739572450155/(e+4),t+=.001208650973866179/(e+5),x(2.506628274631001*(t-=5395239384953e-18/(e+6))/n)-o}function Qt(e,t,n,o,r){var i,a,s,l,u,c,f;return e<o||r<e||o===r?N:(i=(e-o)/(r-o),a=Jt(t+n),s=Jt(t),l=Jt(n),u=x(i),c=x(1-i),f=b(a-s-l+t*u+n*c)*function(e,t,n){var o,r,i,a,s,l=1e-50,u=e+t,c=e+1,f=e-1,h=1,p=1-u*n/c;for(C(p)<l&&(p=l),o=p=1/p,r=1;r<=300&&(C(p=1+(a=(t-r)*r*n/((f+(i=r+r))*(e+i)))*p)<l&&(p=l),C(h=1+a/h)<l&&(h=l),o*=(p=1/p)*h,C(p=1+(a=0-(e+r)*(u+r)*n/((e+i)*(c+i)))*p)<l&&(p=l),C(h=1+a/h)<l&&(h=l),o*=s=(p=1/p)*h,!(C(s-1)<1e-20));r++);return o}(n,t,1-i)/n,R(i<(t+1)/(t+n+2)?f:1-f))}function Yt(e,t,n,o,r){var i,a,s,l,u,c,p,d,g,m,y,v,A,M,S,T,N,I,k,E=3e-308,D=E,j=1-222e-18,_=it(t,n);for(e<=.5?(l=e,d=t,m=n,i=0):(l=1-e,d=n,m=t,i=1),T=(y=w(-x(l*l)))-(2.30753+.27061*y)/(1+(.99229+.04481*y)*y),d>1&&m>1?(S=T*w((p=2/((v=1/(d+d-1))+(A=1/(m+m-1))))+(y=(T*T-3)/6))/p-(A-v)*(y+5/6-2/(3*p)),k=d/(d+m*b(S+S))):(A=(y=m+m)*f(1-(A=1/(9*m))+T*w(A),3))<=0?k=1-b((x((1-l)*m)+_)/m):k=(A=(4*d+y-2)/A)<=1?b((x(l*d)+_)/d):1-2/(A+1),y=1-d,A=1-m,N=0,u=1,k<D?k=D:k>j&&(k=j),I=h(1e-300,f(10,-13-2.5/(d*d)-.5/(l*l))),M=g=0,a=0;a<1e3;a++){for((T=((T=at(k,d,m))-l)*b(_+y*x(k)+A*x(1-k)))*N<=0&&(g=h(C(u),E)),c=1,s=0;s<1e3;s++){if(C(u=c*T)<g&&((M=k-u)>=0&&M<=1)){if(g<=I)return 0!==i&&(k=1-k),R((r-o)*k+o);if(C(T)<=I)return 0!==i&&(k=1-k),R((r-o)*k+o);if(0!==M&&1!==M)break}c/=3}if(M===k)return 0!==i&&(k=1-k),R((r-o)*k+o);k=M,N=T}return 0!==i&&(k=1-k),R((r-o)*k+o)}function Kt(e,t,n,o){var r,i,a,s;if(t<e)return N;if(!o){if(0===(i=f(r=1-n,t))){if(0===(i=f(n,t)))return N;for(a=0;a<t-e&&i>0;a++)i*=D(t-a)/D(a+1)*r/n;return i}for(a=0;a<e&&i>0;a++)i*=D(t-a)/D(a+1)*n/r;return i}if(t===e)return 1;if(0===(i=f(r=1-n,t))){if(0===(i=f(n,t)))return N;for(s=1-i,a=0;a<t-e&&i>0;a++)s-=i*=D(t-a)/D(a+1)*r/n;return s<0?0:s}for(s=i,a=0;a<e&&i>0;a++)s+=i*=D(t-a)/D(a+1)*n/r;return s}function $t(e,t,n){var o,r,i=1-t,a=f(i,e);if(0===a){if(0===(a=f(t,e)))return N;for(o=1-a,r=0;r<e&&o>=n;r++)o-=a*=D(e-r)/D((r+1)*i/t);return D(e-r)}for(o=a,r=0;r<e&&o<n;r++)o+=a*=D(e-r)/D((r+1)*t/i);return D(r)}function Xt(e,t){var n,o,r,i,a,s,l=x(w(y)),u=1/w(y),c=0,f=e,h=.5*f,p=t%2==0;if(t>1&&(c=b(-h)),a=z(-w(f)),P(a))return a;if(s=D(a),o=p?c:2*s,t>2){if(f=.5*(t-1),r=p?1:.5,h>20){for(n=p?0:l,i=x(h);r<=f;)n=x(r)+n,o+=b(i*r-h-n),r+=1;return o}for(n=p?1:u/w(h),i=0;r<=f;)i+=n*=h/r,r+=1;return i*c+o}return o}function en(e,t){var n=ln(1-e,.5*t,2);return D(n)}function tn(e,t){var n,o,r,a,s=0,l=e.rowCount,u=e.colCount;if(l!==t.rowCount||u!==t.colCount)return T;if(l>1&&u>1)n=(l-1)*(u-1);else if(l>1&&1===u)n=l-1;else{if(!(1===l&&u>1))return T;n=u-1}for(o=0;o<i(e);o++)if(r=e[o],a=t[o],r!==Z&&a!==Z){if(0===a)return M;s+=(r-a)*(r-a)/a}return s<0?N:Xt(s,n)}function nn(e,t,n){var o=b(-t*e);return R(n?1-o:t*o)}function on(e,t,n){var o=Qt(t*e/(t*e+n),.5*t,.5*n,0,1);return P(o)?o:1-D(o)}function rn(e,t,n){var o=Yt(1-(1-e),n/2,t/2,0,1);return P(o)?o:(1/D(o)-1)*(n/t)}function an(e,t){var n,o,r,i,a,s,l={N:0,M:0,Q:0,kl:0};return ft(l,e),i=l.N-1,1===l.N?M:0===(n=l.Q/(l.N-1))?M:(l.N=0,l.M=0,l.Q=0,l.kl=0,ft(l,t),a=l.N-1,1===l.N?M:0===(o=l.Q/(l.N-1))?M:(s=on(n/o,i,a),P(s)?s:((r=2*(1-D(s)))>1&&(r=2-r),r)))}function sn(e,t,n,o){var r,i,a,s,c,h,d,g,m,y,v,A,S,T,I,R;if(!1===o)return r=f(n,t),l(r)||!u(r)?M:1/(r*ot(t))*(f(e,t-1)*b(-e/n));if(1/3,1e8,R=1e37,1e3,-88,(e/=n)<=0)return N;if(t>1e3)return I=fn(i=3*w(t)*(f(e/t,1/3)+1/(9*t)-1),0,1,!0),P(I)?I:D(I);if(e>1e8)return 1;if(e<=1||e<t){if(I=un(t+1),P(I))return I;g=t*x(e)-e-D(I),m=1,T=1,v=t;do{T+=m=m*e/(v+=1)}while(m>2220446049250313e-31);g+=x(T),T=0,g>=-88&&(T=b(g))}else{if(I=un(t),P(I))return I;for(g=t*x(e)-e-D(I),m=0,i=1,a=e,T=(s=e+1)/(c=e*(A=(v=1-t)+e+1));;){if(h=(A+=2)*s-(S=(v+=1)*(m+=1))*i,C(d=A*c-S*a)>0){if(C(T-(y=h/d))<=p(2220446049250313e-31,2220446049250313e-31*y))break;T=y}i=s,a=c,s=h,c=d,C(h)>=R&&(i/=R,a/=R,s/=R,c/=R)}g+=x(T),T=1,g>=-88&&(T=1-b(g))}return T}function ln(e,t,n){var o,r,i,a,s,l,u,c,h,p,d,g,m,y;if(e<2e-6)return 0;if(e>.999998)return U;if(u=2*t,i=t-1,y=un(t),P(y))return y;if(s=D(y),u<-1.24*x(e)){if((a=f(e*t*b(s+.6931471805599453*t),1/t))<5e-7)return NaN}else if(u>.32){if(y=hn(e,0,1),P(y))return y;g=D(y),(a=u*f(g*w(l=.222222/u)+1-l,3))>2.2*u+6&&(a=-2*(x(1-e)-i*x(.5*a)+s))}else{a=.4,o=x(1-e)+s+.6931471805599453*i;do{h=a,d=(4.67+2*a)/(l=1+a*(4.67+a))-.5-(6.73+a*(13.32+3*a))/(c=a*(6.73+a*(6.66+a))),a-=(1-b(o+.5*a)*c/l)/d}while(C(h/a-1)>.01)}for(m=1;m<=20;m++){if(h=a,y=sn(l=.5*a,t,1,!0),P(y))return y;if(d=(c=e-D(y))*b(.6931471805599453*t+s+l-i*x(a)),C(h/(a+=d*(1+.5*d*(p=(210+(o=.5*d-(r=d/a)*i)*(140+o*(105+o*(84+o*(70+60*o)))))/420)-r*i*(p-r*((420+o*(735+o*(966+o*(1141+1278*o))))/2520-r*((210+o*(462+o*(707+932*o)))/2520-r*((252+o*(672+1182*o)+i*(294+o*(889+1740*o)))/5040-r*((84+2264*o+i*(1175+606*o))/2520-r*((120+i*(346+127*i))/5040))))))))-1)>5e-7)return.5*n*a}return.5*n*a}function un(e){return rt(e)}function cn(e,t,n){var o,r=pn(e);return P(r)?r:(o=D(r),R(b(t+n*o)))}function fn(e,t,n,o){return o?z((e-t)/n):R(b(-(e-t)*(e-t)/(2*n*n))/(w(2*y)*n))}function hn(e,t,n){var o,r,i,a,s,l=e-.5;if(C(l)<=.42)r=l*(((-25.44106049637*(o=l*l)+41.39119773534)*o-18.61500062529)*o+2.50662823884)/((((3.13082909833*o-21.06224101826)*o+23.08336743743)*o-8.4735109309)*o+1);else{if(o=e,l>0&&(o=1-e),!(o>2220446049250313e-31))return o>1e-300?(r=-2*x(e),o=x(6.283185307179586*r),r=w(r*(1-(o=o/r+(2-o)/(r*r)+(6*o-14-o*o)/(2*r*r*r)))),l<0?-r:r):l<0?-U:U;r=(((2.32121276858*(o=w(-x(o)))+4.85014127135)*o-2.29796479134)*o-2.78718931138)/((1.63706781897*o+3.54388924762)*o+1),l<0&&(r=-r)}return a=.3989422804014327*b(-.5*(i=(r-0)/1)*i)/1,s=fn(r,0,1,!0),P(s)?s:t+n*(r-=(s-e)/a)}function pn(e){return hn(e,0,1)}function dn(e,t,n){var o,i=0;if(n)for(o=0;o<=e;o++)i+=b(-t)*f(t,o)/r.Functions.tk(o);else i=b(-t)*f(t,e)/r.Functions.tk(e);return R(i)}function gn(e,t,n){var o,r,i,a,s,l,u,c,f,h;if(1!==n&&2!==n)return N;if(r=e/w(o=t),i=o/(o+e*e),a=o-2,s=o%2,l=1,u=1,o=1,f=c=2+s,a>=2)for(h=E(c);h<=a&&(l+=u=u*i*(f-1)/f)!==o;h+=2)o=l,f+=2;return 1!==s?n*(1-(.5+.5*r*w(i)*l)):(1===t&&(l=0),n*(1-(.5+.3183098862*(r*i*l+v(r)))))}function mn(e,t){var n,o,r,i,a,s,l,u,c,h,p=e/2,d=p;if(t>1e20)return pn(p);if(d<.5?(c=0,a=2*d):(c=1,a=2*(1-d)),C(t-2)<1e-12)s=a>0?w(2/(a*(2-a))-2):U;else if(D(t)<1+1e-12)a>0?s=-m(1.5707963267948966*(a+1)):s=U;else{if(i=((94.5/((o=48/((n=1/(t-.5))*n))+(r=((20700*n/o-98)*n-16)*n+96.36))-3)/o+1)*w(1.5707963267948966*n)*t,(u=f(i*a,2/t))>.05+n){if(h=pn(.5*a),P(h))return h;l=D(h),t<5&&(r+=.3*(t-4.5)*(l+.6)),u=(((((.4*(u=l*l)+6.3)*u+36)*u+94.5)/(r=(((.05*i*l-5)*l-7)*l-2)*l+o+r)-u-3)/o+1)*l,u=(u*=n*u)>.002?b(u)-1:.5*u*u+u}else u=((1/(((t+6)/(t*u)-.089*i-.822)*(t+2)*3)+.5/(t+4))*u-1)*(t+1)/(t+2)+1/u;s=w(t*u)}return 0!==c&&(s=-s),R(s)}function yn(e,t,n,o){var r,a,s,c,f,h,p,d,g,m,y,v,b,x,A,S,I,R,k,E,j={N:0,M:0,Q:0,kl:0};if(1!==n&&2!==n)return N;if(1===o){if(m=void 0,y=void 0,v=void 0,b=void 0,x=void 0,A=void 0,S=void 0,i(e)!==i(t))return T;for(I=i(e),S=0;S<I;S++)e[S]=e[S]-t[S];for(b=x=A=m=0,S=0;S<I;S++)b+=v=(y=(R=e[S])-b)/(A+1),x+=A*y*v,A++,m+=R;if(A-1==0||0===A)return M;if(c=w(x/(A-1)),l(c)||!u(c))return N;s=(r=m/A)/(c/w(A)),p=A-1}else j.N=0,j.M=0,j.Q=0,j.kl=0,lt(j,e),f=j.Q/(j.N-1),r=j.kl/j.N,d=j.N,j.N=0,j.M=0,j.Q=0,j.kl=0,lt(j,t),h=j.Q/(j.N-1),a=j.kl/j.N,g=j.N,2!==o?p=1/((k=f/d/(f/d+h/g))*k/D(d-1)+(1-k)*(1-k)/D(g-1)):p=D(d+g-2),s=(r-a)/w(f/D(d)+h/D(g));return E=ct(.5*p,.5,p/(p+(s=C(s))*s)),P(E)?E:.5*n*D(E)}function vn(e,t,n,o){var r=b(-f(e/n,t));return R(o?1-r:t/f(n,t)*f(e,t-1)*r)}function bn(e,t,n){var o,r,a,u,c,f,h=0,p=0,d=0,g=0;if(n!==s&&(h=D(n),l(h)))return S;for(u=0;u<i(e);u++)(c=e[u])!==Z&&(p+=a=D(c),d+=a*a,g++);return 0===g?T:1===g?M:(o=p/g,0===(r=n!==s?h:w((g*d-p*p)/(g*(g-1))))?M:(f=z((o-t)/(r/w(g))),P(f)?f:R(1-D(f))))}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Common"),r=n("CalcEngine"),i=o.Common.k.ac,a=null,s=void 0,l=isNaN,u=isFinite,c=parseInt,f=Math.pow,h=Math.max,p=Math.min,d=Math.floor,g=Math.sin,m=Math.tan,y=Math.PI,v=Math.atan,b=Math.exp,C=Math.abs,w=Math.sqrt,x=Math.log,A=Math.round,M=r.Errors.DivideByZero,S=r.Errors.Value,T=r.Errors.NotAvailable,N=r.Errors.Number,I=r.Errors.Null,R=r.Convert.Nh,k=r.Convert.Ph,E=r.Convert.Rh,D=r.Convert.Pa,j=r.Functions.MathHelper,_=j.Bk,O=j.xk,F=r.Convert.Na,P=r.Convert.vf,H=r.Functions.Hfc,B=r.Functions.sk,L=r.Functions.sja,z=r.Functions.qk,V=r.Functions.ik,G=r.Functions.jk,W=r.Functions.Na,U=r.Functions.hk,Z=r.Convert.CalcConvertedError,q=r.Functions.ak,J=r.Convert.Th,Q=r.Convert.Sh,oe={Hi:0,aj:["< 0",">= 1"]},de={Hi:4,Ii:1,Ji:!0,Ki:!0,Mi:!0,Xi:!0},ge={Hi:4,Ii:1,Ji:!0,Ki:!0,Xi:!0},me={Hi:4,Ii:1,Ki:!0,Mi:!0},ye={Hi:4,Ii:0,Ji:!0},Ce={Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},we={Hi:4,Ii:0,Ji:!0,Ki:!0,Mi:!0,Xi:!0},xe={Hi:4,Ii:0,Ji:!0,Ki:!0},Me=[he={Hi:4,Ii:1,Ji:!0,Ki:!0,Mi:!0},{Hi:2}],Se=[he,ne={Hi:0},{_i:3,Hi:2,aj:"< 1"}],Te=[re={Hi:0,aj:["<= 0",">= 1"]},ie={Hi:0,aj:"<= 0"},X={Hi:2,aj:"< 1"}],Ne=[re,ie,ie,ae={_i:0,Hi:0},se={_i:1,Hi:0}],Ie=[ee={Hi:2,aj:"< 0"},ee,le={Hi:0,aj:["< 0","> 1"]},Y={Hi:7}],Re=[ee,le,re],ke=[ue={Hi:0,aj:"< 0"},ce={Hi:0,aj:["< 1","> 10000000000"]}],Ee=[le,te={Hi:2,aj:["< 1","> 10000000000"]}],De=[pe={Hi:4,Ii:1,Ji:!0,Ki:!0},pe],je=[ue,ie,Y],_e=[ue,fe={Hi:0,aj:["< 1",">= 10000000000"]},fe],Oe=[le,fe,fe],Fe=[he,he],Pe=[ue,ie,ie,Y],He=[le,ie,ie],Be=[le,ne,ie],Le=[ne,ne,ie,Y],ze=[ve={Hi:4,Ii:1,Ji:!0},ve],Ve=[ee,ue,Y],Ge=[ue,X],We=[be={Hi:4,Ii:1,Ji:!0,Ki:!0,Li:!0},be,$={Hi:2},{Hi:2,aj:["< 1","> 3"]}],Ue=[ue,ie,ie,Y],Ze=[he,ne],qe=[Ae={Hi:4,Ii:1,Ki:!0,Li:!0},{},K={_i:!0,Hi:7},{_i:!1,Hi:7}],Je=[{},he,ae],Qe=[{Hi:4,Ii:1,Ji:!0,Ki:!0,hOb:!0,Mi:!0},ne],q("TREND",(function(e,t,n,i){var a,l;for(t=t!==s?k(t,0,!1,!0,!1):e,n=n!==s?k(n,0,!1,!0,!1):t,a=0;a<e.rowCount;a++)for(l=0;l<e.colCount;l++)if(!F(e[a][l]))return S;for(a=0;a<t.rowCount;a++)for(l=0;l<t.colCount;l++)if(!F(t[a][l]))return S;for(a=0;a<n.rowCount;a++)for(l=0;l<n.colCount;l++)if(!F(n[a][l]))return S;return o.Common.qc(e,t,n,i,D,r.CalcArray,S,T)}),1,4,[{Hi:4,Ii:0,Ki:!0},{},{},K],[0,1,2],[0,1,2],{bk:[1,2,3]}),q("GROWTH",(function(e,t,n,i){return t=t!==s?k(t,1,!1,!0,!0):e,n=n!==s?k(n,1,!1,!0,!0):t,o.Common.sc(e,t,n,i,r.CalcArray,N,T)}),1,4,[Ae,{},{},K],"!= 3","!= 3",{bk:[1,2,3]}),q("FORECAST",(function(e,t,n){var o,r,a,s,l=0,u=0,c=0,f=0,h=i(t),p=0;if(h!==i(n))return T;for(o=0;o<h;o++)r=t[o],a=n[o],r!==Z&&a!==Z&&(l+=r,u+=a,c+=a*a,f+=a*r,p++);return 0===p||p*c-u*u==0?M:R(l/p-(s=(p*f-u*l)/(p*c-u*u))*(u/p)+s*e)}),3,3,[ne,pe,pe],"> 0","> 0"),q("AVERAGE",(function(){return H(arguments,2,1)}),1,s,s,-1,-1),q("STDEV",_t,1,s,s,-1,-1),q("STDEV.S",_t,1,s,s,-1,-1),q("PERCENTILE",Ot,2,2,s,0,0),q("PERCENTILE.INC",Ot,2,2,s,0,0),q("MAX",(function(){return H(arguments,2,4)}),1,s,s,-1,-1),q("MAXA",(function(){return Tt(!0,arguments)}),1,s,Ce,-1,-1),q("MIN",(function(){return H(arguments,2,5)}),1,s,s,-1,-1),q("MINA",(function(){return Tt(!1,arguments)}),1,s,Ce,-1,-1),q("LARGE",(function(e,t){return L([e,t],14)}),2,2,Qe,0,0),q("SMALL",(function(e,t){return L([e,t],15)}),2,2,Qe,0,0),q("AVERAGEA",(function(){var e,t,n,o,r=arguments,s=0,l=0;for(e=0;e<i(r);e++)for(o=r[e],t=0;t<i(o);t++)n=o[t],F(n,!0)||V(n)?(s+=D(n),l++):(n===a||G(n))&&l++;return 0===l?M:R(s/l)}),1,s,we,-1,-1),q("AVERAGEIF",(function(e,t,n){if(n!==s){if(e=k(e,0,!0,!1,!1),(n=k(n,1,!0,!1,!1,!0,s,!0)).isError)return n[0]}else{if((e=k(e,1,!0,!1,!1,!0,s,!0)).isError)return e[0];n=e}return r.Convert._isReference(t)?Pt(!1,t,e,n):r.Convert.Ca(t)?Pt(!0,t,e,n):Ft(e,t,n)}),2,3,s,[0,1,2],[0,1,2],{bk:2}),q("AVERAGEIFS",(function(e){var t,n,o,r,i,a,s,l=arguments,u=0,c=0,f=e.length,h=l.length,p=[];for(p.push(e),o=1;o<h;o+=2){if((r=k(l[o],0,!0,!1,!1)).isError)return r[0];p.push(r),i=l[o+1],a=O(i),p.push(a)}for(n=0;n<f;n++)if((t=e[n])!==Z){for(s=!0,o=1;o<h&&(s=(a=p[o+1])(p[o][n]));o+=2);s&&(u+=t,c++)}return 0===c?M:R(u/c)}),3,s,he,[0,"%= 1"],[0,"%= 1"]),q("MEDIAN",(function(){return L(arguments,12)}),1,s,de,-1,-1),q("MODE",Ht,1,s,de,-1,-1),q("MODE.SNGL",Ht,1,s,de,-1,-1),q("GEOMEAN",(function(){return Et(!0,arguments)}),1,s,ge,-1,-1),q("HARMEAN",(function(){return Et(!1,arguments)}),1,s,de,-1,-1),q("TRIMMEAN",(function(e,t){var n,o,r,i=0,a=[];for(pt(e,a),n=function(e){var t,n=0;for(t=0;t<e.length;t++)e[t]!==Z&&n++;return n}(a),r=o=c(""+n*t/2);r<n-o;r++)i+=D(a[r]);return i/(n-2*o)}),2,2,[he,oe],0,0),q("FREQUENCY",(function(e,t){var n,o,i,a,s,l,u,c,f,h,p,d,g=0,m=t.rowCount,y=t.colCount;for(n=0;n<m;n++)for(o=0;o<y;o++)t[n][o]!==Z&&g++;for(a=e.rowCount,s=e.colCount,l=[],u=[],c=g+1,g=0,n=0;n<m;n++)for(o=0;o<y;o++)(i=t[n][o])!==Z&&(l[g++]=D(i));for(f=l.slice(0),ht(l),n=0;n<c;n++)u[n]=[0];for(n=0;n<a;n++)for(o=0;o<s;o++)if(i=e[n][o],F(i)){for(h=D(i),p=!1,d=0;!p&&d<g;d++)h<=l[d]&&(u[f.indexOf(l[d])][0]++,p=!0);p||u[g][0]++}return new r.CalcArray(u)}),2,2,[me,me],-1,-1),q("RANK",Bt,2,3,Je,[0,1],[0,1],{bk:2}),q("RANK.EQ",Bt,2,3,Je,[0,1],1,{bk:2}),q("KURT",(function(){var e,t,n,o,r,a,s=arguments,l=0,u=0,c=0,h=0,p=i(s),d=[];if(p>0){for(a=s[0],d.push(a),o=0;o<i(a);o++)(e=a[o])!==Z&&(l+=e,u+=e*e,h++);if(h<=3)return M;if(t=l/h,0===(n=w((h*u-l*l)/(h*(h-1)))))return M;for(r=0;r<p;r++)for(a=d[r],o=0;o<i(a);o++)(e=a[o])!==Z&&(c+=f((e-t)/n,4));return R(h*(h+1)*c/((h-1)*(h-2)*(h-3))-3*(h-1)*(h-1)/((h-2)*(h-3)))}}),1,s,de,-1,-1),q("PERCENTRANK",Lt,2,3,Se,0,0,{bk:2}),q("PERCENTRANK.INC",Lt,2,3,Se,0,0,{bk:2}),q("PERCENTRANK.EXC",(function(e,t,n){return Ke(e,t,n,!1)}),2,3,Se,0,0,{bk:2}),q("QUARTILE",zt,2,2,Me,0,0),q("QUARTILE.INC",zt,2,2,Me,0,0),q("COUNT",(function(){return H(arguments,2,2)}),1,s,s,-1,-1,{gk:-1}),q("COUNTA",(function(){return H(arguments,2,3)}),1,s,s,-1,-1,{gk:-1}),q("COUNTBLANK",(function(e){var t,n=0;for(t=0;t<i(e);t++)e[t]!==a&&""!==e[t]||n++;return n}),1,1,ye,-1,-1),q("COUNTIF",(function(e,t){var n,o,i,a,s,u,c,f,h;if(t.isArray||t.isReference){for(n=void 0,o=void 0,i=0,a=[],s=t.rowCount,u=t.colCount,c=0;c<s;c++){for(f=[],h=0;h<u;h++,i++)o=Vt(e,t[i]),P(o)?f.push(o):(n=D(o),l(n)?f.push(S):f.push(n));a.push(f)}return new r.CalcArray(a)}return Vt(e,t[0])}),2,2,[ye,ye],[0,1],[0,1]),q("COUNTIFS",(function(e){var t,n,o,r,a,s=arguments,l=0,u=i(e),c=i(s),f=[];for(o=0;o<c;o+=2){if((t=0===o?e:k(s[o],0,!0,!1,!1)).isError)return t[0];u=t.length,f.push(t),r=O(s[o+1]),f.push(r)}for(n=0;n<u;n++){for(a=!0,o=0;o<c&&(a=(r=f[o+1])&&r(f[o][n]));o+=2);a&&l++}return R(l)}),2,s,xe,"%= 0","%= 0"),q("AVEDEV",(function(){return jt(!1,arguments)}),1,s,de,-1,-1),q("STDEVA",(function(){return Rt(arguments,1,!0,!0)}),1,s,we,-1,-1),q("STDEVP",Gt,1,s,s,-1,-1),q("STDEV.P",Gt,1,s,s,-1,-1),q("STDEVPA",(function(){return Rt(arguments,0,!0,!1)}),1,s,we,-1,-1),q("VAR",Wt,1,s,s,-1,-1),q("VAR.S",Wt,1,s,s,-1,-1),q("VARA",(function(){return Rt(arguments,1,!1,!1)}),1,s,we,-1,-1),q("VARP",Ut,1,s,s,-1,-1),q("VAR.P",Ut,1,s,s,-1,-1),q("VARPA",(function(){return Rt(arguments,0,!1,!1)}),1,s,we,-1,-1),q("COVAR",Zt,2,2,De,-1,-1),q("COVARIANCE.P",Zt,2,2,De,-1,-1),q("DEVSQ",(function(){return jt(!0,arguments)}),1,s,de,-1,-1),q("CONFIDENCE",qt,3,3,Te),q("CONFIDENCE.NORM",qt,3,3,Te),q("CONFIDENCE.T",(function(e,t,n){return 1===n?M:t*St(e,n-1,2)/w(n)}),3,3,Te),q("INTERCEPT",(function(e,t){var n,o,r,a=0,s=0,l=0,u=0,c=0,f=i(e);if(f!==i(t))return T;for(r=0;r<f;r++)n=e[r],(o=t[r])!==Z&&n!==Z&&(a+=n,s+=o,l+=o*o,u+=o*n,c++);return 0===c||c*l-s*s==0?M:R(a/c-(c*u-s*a)/(c*l-s*s)*(s/c))}),2,2,[de,de],-1,-1),q("LINEST",(function(e,t,n,o){return Dt(!1,e,t,n,o)}),1,4,qe,[0,1],[0,1],{bk:[1,2,3],fk:1}),q("SLOPE",(function(e,t){var n,o,r,a,s,l=0,u=0,c=0,f=0,h=0,p=i(t);if(p!==i(e))return T;for(n=0;n<p;n++)o=e[n],(r=t[n])===Z||o===Z||P(r)||P(o)||(l+=a=D(o),u+=s=D(r),c+=s*s,f+=s*a,h++);return h*c-u*u==0?M:R((h*f-u*l)/(h*c-u*u))}),2,2,[de,de],-1,-1,{fk:1}),q("LOGEST",(function(e,t,n,o){return Dt(!0,e,t,n,o)}),1,4,qe,[0,1],[0,1],{bk:[1,2,3]}),q("STEYX",(function(e,t){var n,o,r,a,s,l=0,u=0,c=0,f=0,h=0,p=0,d=i(e);if(d!==i(t))return T;for(r=0;r<d;r++)a=e[r],s=t[r],a!==Z&&s!==Z&&(l+=o=a,u+=o*o,c+=n=s,f+=n*n,h+=n*o,p++);return p*(p-2)==0||p*f-c*c==0?M:w((p*u-l*l-(p*h-c*l)*(p*h-c*l)/(p*f-c*c))/(p*(p-2)))}),2,2,De,-1,-1),q("BETADIST",Qt,3,5,[ne,ie,ie,ae,se],s,s,{bk:[3,4]}),q("BETA.DIST",(function(e,t,n,o,r,i){if(e<r||i<e||r===i)return N;var a=(e-r)/(i-r);return o?gt(a,t,n):mt(a,t,n)/(i-r)}),4,6,[ne,ie,ie,Y,ae,se],s,s,{bk:[5,6]}),q("BETAINV",Yt,3,5,Ne,s,s,{bk:[3,4]}),q("BETA.INV",Yt,3,5,Ne,s,s,{bk:[3,4]}),q("BINOMDIST",Kt,4,4,Ie),q("BINOM.DIST",Kt,4,4,Ie),q("NEGBINOMDIST",(function(e,t,n){if(e+t-1<=0)return N;var o=_(e+t-1,t-1);return P(o)?o:R(D(o)*f(n,t)*f(1-n,e))}),3,3,[$,$,oe]),q("NEGBINOM.DIST",(function(e,t,n,o){if(e+t-1<=0)return N;if(o)return 1-gt(1-n,e+1,t);var r,i=f(n,t);for(r=0;r<e;r++)i*=(r+t)/(r+1)*(1-n);return i}),4,4,[ee,X,oe,Y]),q("CRITBINOM",$t,3,3,Re),q("BINOM.INV",$t,3,3,Re),q("CHIDIST",Xt,2,2,ke),q("CHISQ.DIST.RT",Xt,2,2,ke),q("CHISQ.DIST",(function(e,t,n){return n?xt(e,t):function(e,t){var n,o;if(e<=0)return 0;if(t*e>1391e3)n=b((.5*t-1)*x(.5*e)-.5*e-x(2)-Ct(.5*t));else{for(t%2<.5?(n=.5,o=2):(n=1/w(2*e*y),o=1);o<t;)n*=e/o,o+=2;n=e>=1425?b(x(n)-e/2):n*b(-e/2)}return n}(e,t)}),3,3,[ue,te,Y]),q("CHIINV",en,2,2,Ee),q("CHISQ.INV.RT",en,2,2,[le,X]),q("CHISQ.INV",(function(e,t){var n={jl:!1},o=st(function(e,t){return{ge:function(n){return e-xt(n,t)}}}(e,t),.5*t,t,n);return n.jl?T:o}),2,2,Ee),q("CHITEST",tn,2,2,De,-1,-1),q("CHISQ.TEST",tn,2,2,De,-1,-1),q("CORREL",(function(e,t){var n,o,a,s,l,u,c,f,h=r.ExcelCompatibleCalcMode?5:1,p=k(e,h,!0,!1,!1,!0),d=k(t,h,!0,!1,!1,!0),g=0,m=0,y=0,v=0,b=0,C=i(d);if(C!==i(p))return T;for(l=0,u=0;u<C;u++){if(c=p[u],f=d[u],P(c))return c;if(P(f))return f;c!==Z&&f!==Z&&(g+=c,m+=f,y+=c*c,v+=f*f,l++)}if(l<=1)return M;if(n=g/l,o=m/l,a=w((l*y-g*g)/(l*(l-1))),s=w((l*v-m*m)/(l*(l-1))),0===a||0===s)return M;for(u=0;u<C;u++)c=p[u],f=d[u],c!==Z&&f!==Z&&(b+=(c-n)*(f-o));return R(b/D((l-1)*a*s))}),2,2,s,-1,-1),q("EXPONDIST",nn,3,3,je),q("EXPON.DIST",nn,3,3,je),q("FDIST",on,3,3,_e),q("F.DIST",(function(e,t,n,o){return o?1-gt(n/(n+t*e),n/2,t/2):f(t/n,t/2)*f(e,t/2-1)/(f(1+e*t/n,(t+n)/2)*yt(!0,t/2,n/2))}),4,4,[ue,ce,ce,Y]),q("F.DIST.RT",on,3,3,_e),q("FINV",rn,3,3,Oe),q("F.INV.RT",rn,3,3,Oe),q("F.INV",(function(e,t,n){var o=Yt(1-e,n/2,t/2,0,1);return P(o)?o:(1/D(o)-1)*(n/t)}),3,3,[le,te,te]),q("FISHER",(function(e){return x((1+e)/(1-e))/2}),1,1,{Hi:0,aj:["<= -1",">= 1"]}),q("FISHERINV",(function(e){var t=b(2*e)-1,n=b(2*e)+1;return!u(t)&&t>0&&!u(n)&&n>0?1:t/n}),1,1,ne),q("FTEST",an,2,2,Fe,-1,-1),q("F.TEST",an,2,2,Fe,-1,-1),q("GAMMADIST",sn,4,4,Pe),q("GAMMA.DIST",sn,4,4,Pe),q("GAMMAINV",ln,3,3,He),q("GAMMA.INV",ln,3,3,He),q("GAMMALN",un,1,1,ie),q("GAMMALN.PRECISE",un,1,1,ie),q("HYPGEOMDIST",(function(e,t,n,o){return e>p(t,n)||e<h(0,t-o+n)||t>o||n>o?N:At(e,t,n,o)}),4,4,[ee,ee,ee,ee]),q("HYPGEOM.DIST",(function(e,t,n,o,r){var i,a;if(e>p(t,n)||e<h(0,t-o+n)||t>o||n>o)return N;if(r){for(i=0,a=0;a<=e;a++)i+=At(a,t,n,o);return i}return At(e,t,n,o)}),5,5,[ee,ee,ee,ee,Y]),q("LOGNORMDIST",(function(e,t,n){return z((x(e)-t)/n)}),3,3,[ie,ne,ie]),q("LOGNORM.DIST",(function(e,t,n,o){if(o)return z((x(e)-t)/n);var r=(x(e)-t)/n;return.3989422804014327*b(-r*r/2)/n/e}),4,4,[ie,ne,ie,Y]),q("LOGINV",cn,3,3,Be),q("LOGNORM.INV",cn,3,3,Be),q("NORMDIST",fn,4,4,Le),q("NORM.DIST",fn,4,4,Le),q("NORMINV",hn,3,3,Be),q("NORM.INV",hn,3,3,Be),q("NORMSDIST",z,1,1,ne,s,s),q("NORMSINV",pn,1,1,le),q("NORM.S.INV",pn,1,1,le),q("NORM.S.DIST",(function(e,t){return t?function(e){var t,n;return t=D(e=.7071067811865475*-e),l(t)?S:(n=z(t*w(2)),P(n)?NaN:.5*(2-2*n))}(e):b(-f(e,2)/2)/w(2*y)}),2,2,[ne,Y]),q("PEARSON",(function(e,t){var n,o,r,a,s=0,l=0,u=0,c=0,f=0,h=i(e);if(h!==i(t))return T;for(n=0,o=0;o<h;o++)r=e[o],a=t[o],W(r)&&W(a)&&(s+=r,l+=a,u+=r*r,c+=a*a,f+=r*a,n++);return n*u-s*s==0||n*c-l*l==0?M:(n*f-s*l)/w((n*u-s*s)*(n*c-l*l))}),2,2,ze,-1,-1),q("RSQ",(function(e,t){var n,o,r,a,s,l=0,u=0,c=0,f=0,h=0,p=0,d=i(t);if(d!==i(e))return T;for(n=0;n<d;n++)o=t[n],r=e[n],W(o)&&W(r)&&(l+=o,u+=r,c+=o*o,f+=r*r,h+=o*r,p++);return 0===(a=w((p*c-l*l)*(p*f-u*u)))?M:R((s=(p*h-l*u)/a)*s)}),2,2,ze,[0,1],[0,1]),q("POISSON",dn,3,3,Ve),q("POISSON.DIST",dn,3,3,Ve),q("PROB",(function(e,t,n,o){var r,a,u,c,f,h,p=n;if(o!==s&&(p=D(o),l(p)))return S;if(r=0,a=0,(u=i(e))!==i(t))return T;for(c=0;c<u;c++)if(f=e[c],h=t[c],f!==Z&&h!==Z){if(h<=0||1<h)return N;n<=f&&f<=p&&(r+=h),a+=h}return 1!==a?N:r}),3,4,[be,pe,ne],[0,1],[0,1],{bk:3}),q("SKEW",(function(){var e,t,n,o,r,a,s=arguments,l=0,u=0,c=0,h=0,p=[];for(n=0;n<i(s);n++)for(a=s[n],p.push(a),o=0;o<i(a);o++)(r=a[o])!==Z&&(l+=r,u+=r*r,h++);if(h<=2)return M;if(e=l/h,0===(t=w((h*u-l*l)/(h*(h-1)))))return M;for(n=0;n<i(p);n++)for(a=p[n],o=0;o<i(a);o++)(r=a[o])!==Z&&(c+=f((r-e)/t,3));return R(h*c/((h-1)*(h-2)))}),1,s,de,-1,-1),q("STANDARDIZE",(function(e,t,n){return(e-t)/n}),3,3,[ne,ne,ie]),q("TDIST",gn,3,3,[ue,X,$]),q("T.DIST",(function(e,t,n){return Mt(e,t,n?4:3)}),3,3,[ue,X,Y]),q("T.DIST.RT",(function(e,t){return gn(e,t,1)}),2,2,Ge),q("T.DIST.2T",(function(e,t){return gn(e,t,2)}),2,2,Ge),q("TINV",mn,2,2,Ee),q("T.INV.2T",mn,2,2,Ee),q("T.INV",(function(e,t){return e<.5?-St(1-e,t,4):St(e,t,4)}),2,2,[{Hi:0,aj:["<= 0","> 1"]},te]),q("TTEST",yn,4,4,We,[0,1],[0,1]),q("T.TEST",yn,4,4,We,[0,1],[0,1]),q("WEIBULL",vn,4,4,Ue),q("WEIBULL.DIST",vn,4,4,Ue),q("ZTEST",bn,2,3,Ze,0,0,{bk:2}),q("Z.TEST",bn,2,3,Ze,0,0,{bk:2}),q("PERMUT",(function(e,t){e=D(E(e)),t=D(E(t));var n,o=1;if(e<0||t<0||e<t)return N;for(n=e-t+1;n<=e;n++)o*=n;return R(o)}),2,2),q("COVARIANCE.S",(function(e,t){return kt(!1,e,t)}),2,2,De,-1,-1),q("MODE.MULT",(function(){var e,t,n,o=0,a=[],s=dt(arguments),l=i(s);for(e=0;e<l;e++){for(t=0,n=e+1;n<l;n++)s[e]===s[n]&&t++;t>o?(o=t,(a=[]).push([s[e]])):t===o&&a.push([s[e]])}return 0===o?T:new r.CalcArray(a)}),1,s,ge,-1,-1),q("PERCENTILE.EXC",(function(e,t){return L([e,t],18)}),2,2,[he,re],0,0),q("QUARTILE.EXC",(function(e,t){return L([e,t],19)}),2,2,[Ce,$],0,0),q("RANK.AVG",(function(e,t,n){return e.rowCount>1||e.colCount>1?S:Nt(!1,t,e[0],n)}),2,3,[be,ve,ae],[0,1],1,{bk:2}),q("PERMUTATIONA",(function(e,t){var n,o=t;return e>=0&&e<2147483647&&o>=0&&o<2147483647&&(e=Math.pow(c(e),c(o)),(n=Math.abs(e))<=179769e303)?n>=22250738585072014e-324?e:0:N}),2,2,[ne,ne]),q("PHI",(function(e){var t,n;return""===e?S:!0===J(e,t={value:0})?(e=.3989422804014327*Math.exp(-t.value*t.value*.5),(n=Math.abs(e))<=179769e303?n>=22250738585072014e-324?e:0:N):S}),1,1),q("BINOM.DIST.RANGE",(function(e,t,n,o){var r,i,a,s,l,u,c,f,h=[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,0x1b02b9306890000,243290200817664e4,5109094217170944e4,11240007277776077e5,2585201673888498e7,6204484017332394e8,15511210043330986e9,40329146112660565e10,10888869450418352e12,30488834461171387e13,8.841761993739702e30,26525285981219107e16,8222838654177922e18,2631308369336935e20,8683317618811886e21,29523279903960416e22,1.0333147966386145e40,37199332678990125e25,13763753091226346e27,5230226174666011e29,20397882081197444e30,8159152832478977e32,3345252661316381e34,140500611775288e37,6041526306337383e37,2658271574788449e39,11962222086548019e40,5502622159812089e42,25862324151116818e43,12413915592536073e45,6082818640342675e47,30414093201713376e48,15511187532873822e50,8065817517094388e52,42748832840600255e53,2308436973392414e56,12696403353658276e57,7109985878048635e59,40526919504877214e60,23505613312828785e62,1.3868311854568984e80,832098711274139e67,5075802138772248e68,3146997326038794e70,198260831540444e73,12688693218588417e73,8.247650592082472e90,5443449390774431e77,3647111091818868e79,24800355424368305e80,1711224524281413e83,1.1978571669969892e100,8504785885678623e86,61234458376886085e87,44701154615126844e89,3307885441519386e92,248091408113954e95,18854947016660504e95,14518309202828587e97,11324281178206297e99,8946182130782976e101,7156945704626381e103,5.797126020747368e120,4753643337012842e107,3945523969720659e109,3314240134565353e111,281710411438055e114,2.4227095383672734e130,2107757298379528e117,18548264225739844e118,1650795516090846e121,14857159644817615e122,1.352001527678403e140,12438414054641308e126,11567725070816416e128,1087366156656743e131,1032997848823906e133,9916779348709496e134,9619275968248212e136,9426890448883248e138,9332621544394415e140,9332621544394415e142,942594775983836e145,9614466715035127e146,990290071648618e149,10299016745145628e150,1081396758240291e153,1.1462805637347084e170,1226520203196138e157,1324641819451829e159,14438595832024937e160,1588245541522743e163,1.7629525510902446e180,1974506857221074e167,22311927486598138e168,25435597334721877e170,2925093693493016e173,3.393108684451898e190,3969937160808721e177,4684525849754291e179,5574585761207606e181,6689502913449127e183,8.094298525273444e200,9875044200833601e187,1214630436702533e190,1506141741511141e192,1882677176888926e194,2372173242880047e196,30126600184576594e197,3856204823625804e200,4974504222477287e202,6466855489220474e204,847158069087882e207,11182486511960043e208,14872707060906857e210,19929427461615188e212,2.6904727073180504e230,3659042881952549e217,5012888748274992e219,6917786472619489e221,9615723196941089e223,13462012475717526e225,1898143759076171e228,2695364137888163e230,3854370717180073e232,55502938327393044e233,8047926057471992e236,11749972043909107e238,1727245890454639e241,25563239178728654e242,3.80892263763057e260,5713383956445855e247,862720977423324e250,13113358856834524e251,20063439050956823e253,30897696138473508e255,4789142901463394e258,7471062926282894e260,11729568794264145e262,1.853271869493735e280,29467022724950384e266,47147236359920616e268,7590705053947219e271,12296942187394494e273,20044015765453026e275,3287218585534296e278,5423910666131589e280,9003691705778438e282,1.503616514864999e300,25260757449731984e286,4269068009004705e289,7257415615307999e291];function p(e){return e<171?e<0?NaN:h[e]:1/0}function d(e,t){var n,o,r,i;if(e<=t)return e===t&&t>=0?1:S;if(e<2*t&&(t=e-t),t<2)return t>=0?0!==t?e:1:S;if(e<171)return p(e)/(p(t)*p(e-t));if(t>514)return S;if(e>8192){for(n=e,o=2;o<=t;o++)n*=--e/o;return n}for(r=e,e--,i=2;;)switch(t-i){case-1:return r;case 0:return e/i*r;case 1:return e*(e-1)/(i*(i+1))*r;case 2:return e*(e-1)*(e-2)/(i*(i+1)*(i+2))*r;default:r*=e*(e-1)*(e-2)*(e-3)/(i*(i+1)*(i+2)*(i+3)),i+=4,e-=4}}if(e=Q(e,r={value:0}),t=J(t,i={value:0}),n=Q(n,a={value:0}),4===arguments.length&&o?o=Q(o,s={value:0}):(o=n,s=a),!0===e&&!0===t&&!0===n&&!0===o){if(e=r.value,t=i.value,n=a.value,o=s.value,e>=0&&e<=2147483646&&t>=0&&t<=1&&n>=0&&n<=e&&o>=n&&o<=e){if((l=e*t*(1-t))>100)return Ye((o-(t*=e)+.5)/(l=Math.sqrt(l)))-Ye((n-1-t+.5)/l);if(0===(u=d(e,n)*Math.pow(t,n)*Math.pow(1-t,e-n)))return 0;for(c=u,l=u,t/=1-t,f=n;f<o;f++)c+=l*=(e-f)/(f+1)*t;return c<=1?c:1}return N}return S}),3,4,[{_i:0},{_i:0},{_i:0}]),q("GAMMA",(function(e){var t,n,o;if(e>0)e=Math.exp(rt(e));else{if(0===(n=e+(t=Math.abs(c(e)))))return N;e=Math.pow(-1,t-1)*Math.exp(rt(-n))*Math.exp(rt(1+n))/Math.exp(rt(t+1-n))}return(o=Math.abs(e))<=179769e303?o>=22250738585072014e-324?e:0:N}),1,1,ie),q("GAUSS",(function(e){e=Ye(e)-.5;var t=Math.abs(e);return t<=179769e303?t>=22250738585072014e-324?e:0:N}),1,1,ne),q("SKEW.P",(function(){var e,t,n,o,r,a,s,l,u,c,h=arguments,p=0,d=0,g=[];for(n=0;n<i(h);n++){if(a=h[n],1===i(h)&&0===i(a))return I;for(o=0;o<i(a);o++)s={value:0},(r=a[o])!==Z&&"boolean"!=typeof r&&J(r,s)&&(p+=s.value,d++,g.push(s.value))}if(d<=2)return M;for(e=p/d,l=0,u=0,c=0,n=0;n<g.length;n++)c=g[n]-e,u+=f(c,2),l+=f(c,3);return 0===(t=w(u/d))?M:R(l/d/t/t/t)}),1,s,we,-1,-1)},CalcEngine:function(e,t){e.exports=n("@grapecity/js-calc")},Common:function(e,t){e.exports=n("@grapecity/js-sheets-common")}}),e.exports=o.Spread.CalcEngine.AdvancedFunctions},"./node_modules_local/@grapecity/js-calc-advancedfunctions/index.js":function(e,t,n){e.exports=n("./node_modules_local/@grapecity/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js")},"./node_modules_local/@grapecity/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js":function(e,t,n){var o="object"==typeof o?o:{};o.Spread=o.Spread||{},o.Spread.CalcEngine=o.Spread.CalcEngine||{},o.Spread.CalcEngine.BasicFunctions=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){var o,r;if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;if(o=Object.create(null),n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/assets/",n(n.s="./src/basicFunctions.entry.ts")}({"./src/basicFunctions.entry.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("CalcEngine");t.Functions=o.Functions,n("./src/functions-basic.ts")},"./src/functions-basic.ts":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe,re,ie,ae,se,le,ue,ce,fe,he,pe,de,ge,me,ye,ve,be,Ce,we,xe,Ae,Me,Se,Te,Ne,Ie,Re,ke,Ee;function De(e,t){for(;0!==t;){var n=e%t;e=t,t=n}return e}function je(e,t,n,o){return 0===t||0===e?0:0!==n&&e<0?!0===o?le(e/Math.abs(t))*Math.abs(t):se(e/Math.abs(t))*Math.abs(t):!0===o?se(e/Math.abs(t))*Math.abs(t):le(e/Math.abs(t))*Math.abs(t)}function _e(e,t){var n,o,r,i,a,s,l=e[0],u=f(l),c=l.rowCount,h=l.colCount,p=[],d=[],g=[];for(i=1;i<f(e);i+=2){if((s=Z(e[i],0,!0,!1,!1)).rowCount!==c||s.colCount!==h)return E;a=ae.xk(e[i+1]),p.push(s),d.push(a)}for(r=0;r<u;r++){for(o=!0,i=0;i<f(p)&&(a=d[i],n=p[i][r],o=a&&a(n));i++);o&&((n=l[r])!==P&&g.push(n))}return t(g)}function Oe(e,t){return t=t<0?A(t):Math.ceil(t),(e&&t%2==0||!e&&t%2!=0)&&(t+=t<0?-1:1),t}function Fe(e,t,n){return t>0&&n<0?F:t<0&&n>0?(n=-n,e?le(t/n)*n:se(t/n)*n):e?se(t/n)*n:le(t/n)*n}function Pe(e,t,n){var o,r,i,a=ae.yk(b(n));return o=se(t=n<0?t/a:t*a),r=le(t),e&&(i=o,o=r,r=i),t=t<0?o:r,q(t=n<0?t*a:t/a)}function He(e,t,n,o){var r,i,a,s=t?-1:1,l=0;if(f(n)!==f(o))return O;for(a=0;a<f(n);a++)r=n[a],i=o[a],r!==P&&i!==P&&(l+=e?(r-i)*(r-i):r*r+s*i*i);return q(l)}function Be(){var e,t,n,o,r=arguments,i=0;for(e=0;e<f(r);e++){if(t=r[e],n=void 0,o=void 0,H(t))return t;if(B(t)||L(t)){if((n=Z(t,1,!0,!0,!1)).isError)return n[0]}else n=Z(t,1,!0,!0,!0);for(o=0;o<f(n);o++)n[o]!==P&&(i+=n[o])}return i}function Le(e,t,n){var o=E;return p(e,[1,101,2,102,3,103,4,104,5,105,6,106,9,109])>=0?o=oe(n,t,e):p(e,[7,107,8,108,10,110,11,111])>=0&&(o=ie(n,t,e)),o}function ze(e,t){return ae.Ak(e,t)}function Ve(e,t){return Pe(!1,e,t)}function Ge(e,t){return se(e/b(t))*b(t)}function We(e){return q(Math.sin(e))}function Ue(e){return q(Math.cos(e))}function Ze(e){return q(ae.Dk(e,!0))}function qe(e){return q(ae.Dk(e,!1))}function Je(e){var t=M(e),n=M(-e);return q(t-n)/(t+n)}function Qe(e){return q(S((1+e)/(1-e))/2)}function Ye(e,t){var n,o,i,a,s=!0;for(n=0;n<f(t);n++)for(i=t[n],o=0;o<f(i);o++){if(r.ExcelCompatibleCalcMode){if("string"==typeof i[o]||d(i[o]))continue;s=!1}if(a={value:null},i[o]=ce(i[o],a)?a.value:P,e){if(!i[o])return!1}else if(i[o]&&i[o]!==P)return!0}return r.ExcelCompatibleCalcMode&&s?E:!!e}function Ke(e){var t,n=e.getFullYear(),o=e.getMonth(),r=e.getDate();for(t=0;t<o;t++)r+=te(n,t);return r}function $e(e){if(Y(e)){if(7!==f(e)||m(v(e)))return E}else if(!m(e)){if(A(e)<1||A(e)>17)return F;e=""+e}var t,n=["1","2","3","4","5","6","7"],o=[0,0,0,0,0,0,0];switch(f(e)){case 1:if(p(e,n)>=0){o[((t=v(e))+4)%7]=1,o[(t+5)%7]=1;break}return F;case 2:if("1"===e[0]&&p(e[1],n)>=0){o[((t=v(e[1]))+5)%7]=1;break}return F;case 7:for(t=0;t<7;t++)o[t]=v(e[t]);break;default:return E}return o}function Xe(e,t,n,o,r){var i,a=rt(t,3);if(H(a))return a;for(i=V(a);n<0;++n)t.setDate(t.getDate()-1),i=0===i?6:--i,(e&&(5===i||6===i)||!e&&r[i]||o.indexOf(l(t))>=0)&&n--;for(;n>0;--n)t.setDate(t.getDate()+1),i=6===i?0:++i,(e&&(5===i||6===i)||!e&&r[i]||o.indexOf(l(t))>=0)&&n++;return l(t)}function et(e,t,n,o,r,i){var a,s,l,c,h,p,d,m,y;if(i&&(s=$e(e=e!==g?e:"0000011"),H(s)))return s;if(t!==g&&(a=Z(t,4,!0,!0,!1)),!a)return r;if(a.isError)return a[0];for(l=f(a),c=[],h=0;h<l;h++)p=a[h],m=(d=u(p)).getDay(),y=f(s)?s[rt(d,3)]:6===m||0===m,-1===c.indexOf(p)&&!y&&p>=n&&p<=o&&c.push(p);return r-f(c)}function tt(e,t,n,o,r,i){var a,s,u,c=V(l(t)),f=V(l(n)),h=!1;return c>f&&(a=t,t=n,n=a,s=c,c=f,f=s,h=!0),u=i(t,n,u=f-c+1,o),e&&H(u)?u:u<=0?0:(u=et(o,r,c,f,u,e),u=h?-u:u)}function nt(e,t,n){var o,i;return t=r.Convert.Wh(t),(o=new Date(t.getFullYear(),t.getMonth(),1)).setMonth(o.getMonth()+n),i=te(o.getFullYear(),o.getMonth()),o.setDate(e?i:x(t.getDate(),i)),o}function ot(e){var t;return Y(e)&&(t=c(e)),t?(60*(60*t.getHours()+t.getMinutes())+t.getSeconds())/86400:E}function rt(e,t){var n=e.getDay();switch(t){case 1:return n+1;case 2:return 0===n?7:n;case 3:return 0===n?6:n-1;default:return F}}function it(e,t,n,o){var r,i,a,s,l,u,c;if(r=$e(o=o!==g?o:"0000011"),i=0,a=0,H(r))return r;for(s=0;s<f(r);s++)1===r[s]&&i++;if(n<30){for(s=0;s<n;s++)r[(V(rt(e,3))+s)%7]&&a++;return n-a}for(l=n,u=0,c=0,s=0;s<l&&V(rt(e,3)+s)%7!=0;s++)u++;for(s=0;s<u;s++)r[(V(rt(e,3))+s)%7]&&a++;for(s=0;s<l&&(V(rt(t,3))+7-s)%7!=6;s++)c++;for(s=0;s<c;s++)r[(V(rt(t,3))+7-s)%7]&&a++;return(n-=V((l=l-u-c)/7)*i)-a}function at(e){var t,n,o,r=""+e,i="",a=[];if(e<0&&(r=r.substr(1),i="-"),n=r.split("."),(o=f(n))<1||o>2)return E;for(2===o&&(a.push(n[1]),a.push(".")),r=n[0],t=f(r)-3;t>=0;t-=3)a.push(r.substr(t,3)),t>0&&a.push(",");return a.push(r.substring(0,t+3)),a.reverse(),i+a.join("")}function st(e,t){var n,o,r,i,a=[],s=f(e);for(n=0;n<s;n++){if(r=e[n],0===(i=f(r))&&"concat"===t)return R;for(o=0;o<i;o++)d(r[o])||a.push(W(r[o]))}return a.join("")}function lt(e,t,n){var o,r=[],i=0;for(o=0;o<t.length;o++)if("fourByte"===$(t[o])){if(0===i){i++;continue}i=0,r.push(t[o-1]+t[o])}else r.push(t[o]);return n>=r.length?t:r.splice(e?0:r.length-n,n).join("")}function ut(e,t,n,o){var r,i,a=f(e);return t=x(t,a+1),n=x(n||0,a-t+1),r=e.substring(0,t-1),i=e.substr(t-1+n),r.concat(o).concat(i)}function ct(e,t,n){var o,r=f(t);if(0===r)return R;for(o=0;o<r;o++)d(t[o])||""===t[o]?n||e.push(""):e.push(W(t[o]))}function ft(e,t){if(0===e.length)return"";if(1===t.length)return e.join(t[0]);for(var n=e[0],o=1,r=0;o<e.length;o++,r++)r===t.length&&(r=0),n+=t[r]+e[o];return n}function ht(e,t,n){var o,i,a,s,l,u,c,f;if(dt()||r.usedbcs){for(o=[],i=void 0,a=0,s=void 0,l=0,s=0;s<t.length;s++)if(i=t[s],"fourByte"===(u=$(t[s]))){if(a%2==0){a++;continue}a++,i=t[s-1]+t[s],o[o.length]=i}else"doubleByte"===u&&(l++,i=t[s]),o[s-(a>0?a/2:0)+l]=i;return e||(o=ee(o)),n>=(c=o.length)?t:(f=void 0,e?(f=o.slice(0,n-1<0?0:n)).length>0&&d(f[f.length-1])&&(f[f.length-1]=""):(f=o.slice(c-n)).length>0&&d(f[0])&&(f[0]=""),f.join(""))}return lt(e,t,n)}function pt(e,t,n){t--;var o=f(e);return t>=o?"":o<t+n?e.substr(t):e.substr(t,n)}function dt(){return!!o.Common.CultureManager.q4().isJCKCulture}function gt(e,t,n){if(n<1||f(t)<n)return E;var o=t.indexOf(e,n-1);return-1===o?E:o+1}function mt(e,t,n){var o,r,a=-1;return(o=i.ub(e))?(r=i.sb(o).exec(t),a=d(r)?-1:r.index):a=t.toLowerCase().indexOf(e.toLowerCase(),--n),-1===a?E:a+1}function yt(e){for(var t=0;t<e.length;t++)d(e[t])&&e[t-1]&&2!==e[t-1].length&&(e[t]="");return e.join("")}function vt(e,t){return t}function bt(e){return e>=55296&&e<=57343}function Ct(e,t){return!(e<55296||e>56319)&&t>=56320&&t<=57343}function wt(e,t){return H(e)?O:L(e)?Z(e,t,!0,!0,!1):Z(e,t,!0,!0,!0)}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Common"),r=n("CalcEngine"),i=o.Common.q,a=o.Common.u,s=o.Common.l,l=s.Ra,u=s.Xb,c=s.Qa,f=o.Common.k.ac,h=o.Common.j,p=h.Ea,d=h.Fa,g=void 0,m=isNaN,y=parseFloat,v=parseInt,Math.round,b=Math.abs,C=Math.sqrt,w=Math.max,x=Math.min,A=Math.floor,M=Math.exp,S=Math.log,T=Math.PI,N=Math.random,I=Math.pow,R=r.Errors.Null,k=r.Errors.DivideByZero,E=r.Errors.Value,D=r.Errors.Reference,j=r.Errors.Name,_=r.Errors.Calc,O=r.Errors.NotAvailable,F=r.Errors.Number,P=r.Convert.CalcConvertedError,H=r.Convert.vf,B=r.Convert._isReference,L=r.Convert.Ca,z=r.Convert.Uh,V=r.Convert.Rh,G=r.Convert.Pa,W=r.Convert.bc,U=r.Convert.Na,Z=r.Convert.Ph,q=r.Convert.Nh,J=r.Zh.tryExtractToSingleValue,Q=r.Functions.ik,Y=r.Functions.jk,K=r.Functions.kk,$=r.Functions.UAb,X=r.Functions.VAb,ee=r.Functions.WAb,te=r.Functions.nk,ne=r.Functions.tk,oe=r.Functions.Hfc,re=r.Functions.mja,ie=r.Functions.sk,ae=r.Functions.MathHelper,se=ae.zk,le=ae.wk,ue=r.Functions.ak,ce=r.Convert.Th,fe=r.Convert.Uh,he=r.Convert.jja,de={Hi:0,aj:"= 0",bj:k},ge={Hi:0,aj:"= 0",bj:0},me={_i:1,Hi:0,aj:"= 0",bj:0},ye={Hi:2,aj:"< 0"},ve={Hi:0,aj:["> 134217728","< -134217728"]},be={Hi:1},Ce={Hi:2},we={_i:1,Hi:2},xe={_i:1,Hi:2,aj:"< 0",bj:E},Ae={Hi:5},Me={Hi:6},Se={Hi:2,aj:"< 0",bj:E},Te={_i:[],Hi:4,Ii:4,Ji:!0,Ki:!0,Li:!0},Ne={Hi:4,Ii:1,Ji:!0,Ki:!0},Ie={Hi:4,Ii:1,Ki:!0,Li:!0},Re={Hi:4,Ii:1,Ji:!0,Ki:!0,Xi:!0},ke={Hi:4,Ii:3,Ji:!0,Ki:!0,Xi:!0},Ee={Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},ue("ABS",(function(e){return q(b(e))}),1,1,pe={Hi:0}),ue("ACOS",(function(e){return q(Math.acos(e))}),1,1,{Hi:0,aj:["> 1","< -1"]}),ue("ACOT",(function(e){return q(e<0?Math.PI+Math.atan(1/e):Math.atan(1/e))}),1,1,pe),ue("ASIN",(function(e){return q(Math.asin(e))}),1,1,{Hi:0,aj:["> 1","< -1"]}),ue("ATAN",(function(e){return q(Math.atan(e))}),1,1,pe),ue("ATAN2",(function(e,t){return 0===e&&0===t?k:q(Math.atan2(t,e))}),2,2,[pe,pe]),ue("COS",Ue,1,1,pe),ue("SEC",(function(e){var t=Ue(e);return 0===t?k:1/t}),1,1,ve),ue("CEILING",(function(e,t){return Fe(!0,e,t)}),2,2,[ge,ge]),ue("ODD",(function(e){return Oe(!0,e)}),1,1,be),ue("EVEN",(function(e){return Oe(!1,e)}),1,1,be),ue("FLOOR",(function(e,t){return Fe(!1,e,t)}),2,2,[ge,ge]),ue("LN",(function(e){return q(S(e))}),1,1,{Hi:1,aj:"<= 0"}),ue("SQRT",(function(e){return C(e)}),1,1,{Hi:0,aj:"< 0"}),ue("SIN",We,1,1,pe),ue("CSC",(function(e){var t=We(e);return 0===t?k:1/t}),1,1,ve),ue("TAN",(function(e){return q(Math.tan(e))}),1,1,pe),ue("COT",(function(e){return 0===e?k:q(1/Math.tan(e))}),1,1,ve),ue("SIGN",(function(e){return 0===e?0:-1}),1,1,{Hi:1,aj:"> 0",bj:1}),ue("GCD",(function(){var e,t,n,o,r=arguments,i=0;for(e=0;e<f(r);e++)for(n=r[e],t=0;t<f(n);t++)if((o=n[t])!==P){if(o<0)return F;i=De(i,V(o))}return i}),1,g,Re,-1,-1),ue("LCM",(function(){var e,t,n,o,r=arguments,i=1,a=[];for(e=0;e<f(r);e++){for(n=r[e],t=0;t<f(n);t++)if((o=n[t])!==P){if(o<0)return F;if(0===o)return 0;a.push(V(o))}for(t=0;t<f(a);t++)i/=De(i,o=a[t]),i*=o}return i}),1,g,Re,-1,-1),ue("PRODUCT",(function(){return oe(arguments,2,6)}),1,g,g,-1,-1),ue("POWER",(function(e,t){if(0===e&&t<0)return k;if(0===e&&0===t)return F;var n=r.Functions.MathHelper.YDc(e,t);return n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY||isNaN(n)?F:n}),2,2,[pe,pe]),ue("MOD",(function(e,t){return e-t*A(e/t)}),2,2,[pe,{Hi:0,aj:"= 0",bj:k}]),ue("QUOTIENT",(function(e,t){return v(""+e/t)}),2,2,[pe,de],g,g),ue("SUBTOTAL",(function(e){var t,n=arguments,o=[];for(t=1;t<f(n);t++)o[t-1]=n[t];return Le(e,0,o)}),2,g,Ce,"!= 0"),ue("_SUBTOTALFORSTATUSBAR",(function(e){var t,n=arguments,o=[];for(t=1;t<f(n);t++)o[t-1]=n[t];return Le(e,1,o)}),2,g,Ce,"!= 0"),ue("INT",(function(e,t){var n,o,r,i;if(B(t))if(n=t.getRow(0),o=t.getColumn(0),r=t.getRowCount(0),i=t.getColumnCount(0),1===r&&1===i)t=t.getValue(0,0,0);else if(1!==r&&1===i&&n<=e.row&&e.row<n+r)t=t.getValue(0,e.row-n,0);else{if(!(1===r&&1!==i&&o<=e.column&&e.column<o+i))return E;t=t.getValue(0,0,e.column-o)}return t=G(t),isNaN(t)?E:le(t)}),1,1,g,[0],g,{dk:!0}),ue("MROUND",(function(e,t){return e<0&&t>0||t<0&&e>0?F:le(e/t+.5)*t}),2,2,[ge,ge]),ue("ROUND",ze,2,2,[pe,Ce]),ue("ROUNDDOWN",Ve,2,2,[pe,Ce]),ue("ROUNDUP",(function(e,t){return Pe(!0,e,t)}),2,2,[pe,Ce]),ue("TRUNC",Ve,1,2,[pe,{_i:0,Hi:2}],g,g,{bk:1}),ue("EXP",(function(e){return q(M(e))}),1,1,pe),ue("LOG",(function(e,t){return 1===t?k:q(ae.Ek(e,t))}),1,2,[{Hi:0,aj:"<= 0"},{_i:10,Hi:0,aj:"<= 0"}],g,g,{bk:1}),ue("LOG10",(function(e){return q(ae.Ek(e,10))}),1,1,{Hi:0,aj:"<= 0"}),ue("SUM",(function(){var e,t,n,o,i,a;if(!r.ExcelCompatibleCalcMode)return Be.apply(null,arguments);for(e=arguments,t=0,n=0;n<f(e);n++){if(o=e[n],i=void 0,a=void 0,H(o))return o;if(B(o)||L(o)){if((i=Z(o,5,!0,!0,!1,!0)).isError)return i[0]}else i=Z(o,1,!0,!0,!1,!0);for(a=0;a<f(i);a++)i[a]!==P&&(t+=i[a])}return t}),1,g,g,-1,-1),ue("SUMIF",(function(e,t,n,o){var r,i,a,s,l,u,c,h,p,m,y,v,b,C,w,x,A,M,S,T;if(o=o!==g?o:t,d(n)&&(n=0),r=0,i=ae.xk(n),a=L(t),s=L(o),(a?1:t.getRangeCount())!==(s?1:o.getRangeCount()))return E;if(l=o,o===t||s||(u=a?t.getRowCount():t.getRowCount(0),c=a?t.getColumnCount():t.getColumnCount(0),u===o.getRowCount(0)&&c===o.getColumnCount(0)||(h=o.getRow(0),p=o.getColumn(0),l=o.create([{row:h,col:p,rowCount:u,colCount:c}]),m=e.row,y=e.column,v=e.source.getCalcSourceModel().qg(m,y),b=o.getSource(),v&&b.getRangeKey&&(C={id:b.id,row:h,col:p,rowCount:u,colCount:c},w=b.getRangeKey(b,C),v.eOb||(v.eOb={}),v.eOb[w]=C))),x=t.toArray(0,!1,!1),A=l.toArray(1,!1,!1),x.isError)return x[0];if(A.isError)return A[0];for(M=0;M<f(x);M++)for(S=0;S<f(x[M]);S++)T=A[M]&&A[M][S],i&&i(x[M][S])&&T!==P&&T&&(r+=T);return q(r)}),2,3,g,[0,2],[0,2],{bk:2,dk:!0}),ue("SUMIFS",(function(){return _e(arguments,(function(e){var t,n,o=0;for(t=0;t<e.length;t++){if(n=e[t],H(n))return n;o+=n}return o}))}),3,g,{Hi:4,Ii:1,Ji:!0},[0,"%= 1"],[0,"%= 1"]),ue("SUMPRODUCT",(function(){var e,t,n,o,r,i,a,s=arguments,l=0,u=[],c=0;for(e=0;e<f(s);e++){if((o=Z(s[e],1,!0,!0,!1,!0)).isError)return o[0];if(o.isConvertError)return E;if(0===e)t=o.rowCount,n=o.colCount,c=f(o);else if(o.rowCount!==t||o.colCount!==n)return E;u.push(o)}for(e=0;e<c;e++){for(r=1,i=0;i<f(s);i++){if((a=u[i][e])===P){if(1===c)return E;r=0;break}r*=a}l+=r}return q(l)}),1,g,g,-1,-1,{fk:1}),ue("SUMSQ",(function(){var e,t,n,o,r=arguments,i=0;for(t=0;t<f(r);t++)for(o=r[t],n=0;n<f(o);n++)(e=o[n])!==P&&(i+=e*e);return q(i)}),1,g,Re,-1,-1),ue("SUMX2MY2",(function(e,t){return He(!1,!0,e,t)}),2,2,Re,-1,-1),ue("SUMX2PY2",(function(e,t){return He(!1,!1,e,t)}),2,2,Re,-1,-1),ue("SUMXMY2",(function(e,t){return He(!0,!1,e,t)}),2,2,Re,-1,-1),ue("SERIESSUM",(function(e,t,n,o){var r,i,a=0;for(r=0;r<f(o);r++){if(i=G(o[r]),m(i))return E;a+=i*I(e,t+r*n)}return q(a)}),4,4,[pe,Ce,Ce,{Hi:4,Ii:1,Ji:!0,Ki:!0,Li:!0}],3,3),ue("PI",(function(){return T}),0,0),ue("SQRTPI",(function(e){return q(C(e*T))}),1,1,{Hi:0,aj:"< 0"}),ue("DEGREES",(function(e){return 180*e/T}),1,1,be),ue("RADIANS",(function(e){return T*e/180}),1,1,pe),ue("COSH",qe,1,1,pe),ue("SECH",(function(e){if(e>709||e<-709)return 0;var t=qe(e);return 0===t?k:1/t}),1,1,pe),ue("ACOSH",(function(e){return q(S(e+C(e*e-1)))}),1,1,{Hi:0,aj:"< 1"}),ue("SINH",Ze,1,1,pe),ue("CSCH",(function(e){if(e>709||e<-709)return 0;var t=Ze(e);return 0===t?k:1/t}),1,1,pe),ue("ASINH",(function(e){return q(S(e+C(e*e+1)))}),1,1,pe),ue("TANH",Je,1,1,pe),ue("COTH",(function(e){return 0===e?k:e>10?1:e<-10?-1:1/Je(e)}),1,1,{Hi:0}),ue("ATANH",Qe,1,1,{Hi:0,aj:["<= -1",">= 1"]}),ue("ACOTH",(function(e){return Qe(1/e)}),1,1,{Hi:0}),ue("MDETERM",(function(e){var t,n,o,r,i,a,s,l,u=e.rowCount,c=1;if(e.rangeCount>1||u!==e.colCount)return E;for(t=0;t<u-1;t++){if(0===e[t][t]){for(a=!1,n=t+1;!a&&n<u;n++)if(0!==e[n][t]){for(r=t;r<u;r++)s=e[t][r],e[t][r]=e[n][r],e[n][r]=s;c*=-1,a=!0}if(!a)return 0}for(o=t+1;o<u;o++)if(0!==e[o][t])for(l=e[o][t]/e[t][t],i=t;i<u;i++)e[o][i]-=l*e[t][i]}for(t=0;t<u;t++)c*=e[t][t];return c}),1,1,Ie,-1,-1),ue("MINVERSE",(function(e){var t,n,o,i,a,s,l,u,c,f,h,p,d,g,m,y,v=e.rowCount,b=[];if(e.rangeCount>1||v!==e.colCount)return E;for(t=0;t<v;t++)for(b[t]=[v],i=0;i<v;i++)b[t][i]=t===i?1:0;for(n=0;n<v;n++){if(0===e[n][n]){for(y=!1,a=n+1;!y&&a<v;a++)if(0!==e[a][n]){for(l=n;l<v;l++)g=e[n][l],e[n][l]=e[a][l],e[a][l]=g;for(u=1;u<v;u++)m=b[n][u],b[n][u]=b[a][u],b[a][u]=m;y=!0}if(!y)return F}for(s=0;s<v;s++)if(s!==n&&0!==e[s][n]){for(p=e[s][n]/e[n][n],c=n;c<v;c++)e[s][c]-=p*e[n][c];for(f=0;f<v;f++)b[s][f]-=p*b[n][f]}}for(o=0;o<v;o++)for(d=e[o][o],h=0;h<v;h++)b[o][h]/=d;return new r.CalcArray(b)}),1,1,Ie,-1,-1),ue("MMULT",(function(e,t){var n,o,i,a,s,l,u=e.rowCount,c=e.colCount,f=t.rowCount,h=t.colCount,p=[];if(c!==f)return E;for(i=0;i<u;i++)for(p[i]=n=[],o=e[i],a=0;a<h;a++){for(l=0,s=0;s<f;s++)l+=o[s]*t[s][a];n[a]=l}return new r.CalcArray(p)}),2,2,[Ie,Ie],-1,-1),ue("FACT",(function(e){return ne(e)}),1,1,{Hi:3,aj:["< 0","> 170"]}),ue("FACTDOUBLE",(function(e){var t,n=1;for(t=e;t>1;t-=2)n*=t;return n}),1,1,{Hi:3,aj:["< 0","> 300"]}),ue("MULTINOMIAL",(function(){var e,t,n,o,r=arguments,i=0,a=1;for(t=0;t<f(r);t++)for(e=r[t],n=0;n<f(e);n++){if((o=V(e[n]))<0||170<o)return F;i+=o,a*=ne(o)}return i<0||170<i?F:ne(i)/a}),1,g,{Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},-1,-1),ue("RAND",(function(){return b(2*N()-1)}),0,0,g,g,g,{ck:!0}),ue("RANDBETWEEN",(function(e,t){return t<e?F:V(e+N()*(t-e+1))}),2,2,[Ce,Ce],g,g,{ck:!0}),ue("COMBIN",(function(e,t){var n,o=1;if(e<t)return F;for(t=x(e-t,t),n=1;n<=t;n++)o*=e-n+1,o/=n;return q(o)}),2,2,[ye,ye]),ue("COMBINA",(function(e,t){var n,o=1;for(n=1;n<=t;n++)o*=e+n-1;for(n=2;n<=t;n++)o/=n;return q(o)}),2,2,[ye,ye]),ue("DECIMAL",(function(e,t){var n,o,r,i,a,s,l;if(!e||e.length>255)return 0;if(0===(n=e.length))return 0;if("-"===e[0])return F;for(o=0;o<n&&" "===e[o];)o++;if(r=0,o===n)return 0;for(i=1,a=n-1;a>=o;a--){if((l=(s=e.charCodeAt(a)|" ".charCodeAt(0))-"a".charCodeAt(0)>=0?s-87:s-48)<0||l>=t)return F;r+=l*i,i*=t}return r}),2,2,[{_i:"0",Hi:5},{Hi:0,aj:["> 36","< 2"]}]),ue("CEILING.MATH",(function(e,t,n){return je(e,t,n,!0)}),1,3,[pe,{Hi:0,_i:1},{Hi:0,_i:0}]),ue("FLOOR.MATH",(function(e,t,n){return je(e,t,n,!1)}),1,3,[pe,{Hi:0,_i:1},{Hi:0,_i:0}]),ue("BASE",(function(e,t,n){var o=""+e.toString(t);return n&&o.length<n?Array.apply(null,{length:n-o.length+1}).join(0)+o:o}),2,3,[{Hi:0,aj:["< 0",">= 9007199254740992"]},{Hi:3,aj:["> 36","< 2"]},{Hi:3,_i:0,aj:["< 0",">= 256"]}]),ue("ROMAN",(function(e,t){var n,o,r,i,a,s,l,u,c=["M","D","C","L","X","V","I"],f=[1e3,500,100,50,10,5,1],h=[];if((n=Q(t)?t?0:4:t)>4||n<0)return E;for(o=0;o<7;o+=2){if(2<=o&&f[o-2]-f[o]<=e){for(r=o,i=o-2,a=void 0,a=0;a<n&&r+1<7&&f[i]-f[r+1]<=e;a++)r++;h.push(c[r]),h.push(c[i]),e+=f[r],e-=f[i]}if(1<=o&&f[o-1]<=e&&(h.push(c[o-1]),e-=f[o-1]),1<=o&&f[o-1]-f[o]<=e){for(s=o,l=o-1,u=void 0,u=0;u<n&&s+1<7&&f[l]-f[s+1]<=e;u++)s++;h.push(c[s]),h.push(c[l]),e+=f[s],e-=f[l]}for(;f[o]<=e;)h.push(c[o]),e-=f[o]}return h.join("")}),1,2,[{Hi:2,aj:["< 0","> 3999"],bj:E},{_i:0}],g,g,{bk:1}),ue("ARABIC",(function(e){var t,n,o,r,i,a,s,l,u,c;if(!e.length)return 0;if(e.length>255)return E;for(t=0,n=(e=e.toLowerCase()).length-1,r=0,s=-1;n>=0&&" "===e[n];)n--;for(l=0;l<=n&&" "===e[l];)l++;u=!1,l<=n&&"-"===e[l]&&(u=!0,l++);do{for(c=e[o=n],--n;n>=l&&(e[n].charCodeAt(0)|" ".charCodeAt(0))===c.charCodeAt(0);)--n;switch(c){case"i":i=o-n,a=1;break;case"v":i=5*(o-n),a=5;break;case"x":i=10*(o-n),a=10;break;case"l":i=50*(o-n),a=50;break;case"c":i=100*(o-n),a=100;break;case"d":i=500*(o-n),a=500;break;case"m":i=1e3*(o-n),a=1e3;break;default:return E}a>=s?(t+=i-r,s=a,r=0):r+=i}while(n>=l);return 0!==r&&(t-=r),u&&(t=-t),t}),1,1,Ae),ue("CEILING.PRECISE",Ge,1,2,[ge,me]),ue("ISO.CEILING",Ge,1,2,[ge,me]),ue("FLOOR.PRECISE",(function(e,t){return le(e/b(t))*b(t)}),1,2,[ge,me]),ue("MAXIFS",(function(){return _e(arguments,(function(e){var t=null;return e.length>0&&(t=Math.max.apply(null,e)),t}))}),3,g,Ne,[0,"%= 1"],[0,"%= 1"]),ue("MINIFS",(function(){return _e(arguments,(function(e){var t=null;return e.length>0&&(t=Math.min.apply(null,e)),t}))}),3,g,Ne,[0,"%= 1"],[0,"%= 1"]),ue("MUNIT",(function(e){for(var t=[],n=0,o=[];n<e;n++)o[n]=0;for(n=0;n<e;n++)t[n]=o.slice(0),t[n][n]=1;return new r.CalcArray(t)}),1,1,{Hi:2,aj:"<= 0",bj:E}),ue("SEQUENCE",(function(e,t,n,o){var i,a,s,l,u,c,f;if(void 0===e&&(e=1),void 0===t&&(t=1),void 0===n&&(n=1),void 0===o&&(o=1),i=n,0===e||0===t)return _;if(e<0||t<0)return E;if("string"==typeof n||n instanceof Date){if(a={},!r.Convert.Th(n,a))return E;i=a.value}for(s=[],l=0,u=i;l<e;l++)for(c=[],s.push(c),f=0;f<t;f++)c.push(u),u+=o;return new r.CalcArray(s)}),1,4,[Ce,Ce,pe,pe],g,g,{bk:[0,1,2,3]},!0),ue("RANDARRAY",(function(e,t,n,o,i){var a,s,l,u,c,f;if(void 0===e&&(e=1),void 0===t&&(t=1),void 0===n&&(n=0),void 0===o&&(o=1),void 0===i&&(i=!1),0===e||0===t)return _;if(e<0||t<0)return E;if(n>o)return E;if(i&&(n!==A(n)||o!==A(o)))return E;for(a=o-n,i&&a++,s=[],l=0;l<e;l++)for(u=[],s.push(u),c=0;c<t;c++)f=n+N()*a,i&&(f=v(f)),u.push(f);return new r.CalcArray(s)}),0,5,[Ce,Ce,pe,pe],g,g,{ck:!0,bk:[0,1,2,3,4]},!0),ue("AGGREGATE",(function(e,t,n){var o,r=arguments,i=[];for(o=3;o<f(r);o++)i[o-3]=r[o];return re(i,n,t,e)}),3,g,g,"> 1","> 1",{fk:1,dk:!0}),ue("AND",(function(){return Ye(!0,arguments)}),1,g,Ee,-1,-1),ue("OR",(function(){return Ye(!1,arguments)}),1,g,Ee,-1,-1),ue("NOT",(function(e){var t;return r.ExcelCompatibleCalcMode&&"string"==typeof e?E:(t={},r.Convert.Uh(e,t)?!t.value:E)}),1,1),ue("IF",(function(e,t,n){var o,r,i=e,a=t,s=J(i);return H(e)?e:(o=n!==g?n:2!==f(arguments)&&null,r={},z(s.value,r),r.value?a:o)}),2,3,g,[1,2],[1,2],{gk:[1,2],bk:2,isBranch:!0,findTestArgument:0,findBranchArgument:function(e){if(r.Convert.vf(e))return-1;var t={value:!1};return z(e,t),t.value?1:2}}),ue("IFERROR",(function(e,t){var n,o,r,i;if(!H(e)&&B(e)){if(e.getRangeCount()>1)return E;if(n=0,o=0,r=this.y0a)if(n=r.row,o=r.col,(i=e._identities&&e._identities[0])&&1===i.rowCount&&1===i.colCount)n=0,o=0;else if(i&&(n+1>i.rowCount||o+1>i.colCount))return t;e=e.getValue(0,n,o)}return function(e,t){return H(e)?d(t)?0:t:d(e)?0:e}(e,t)}),2,2,g,0,g,{gk:-1}),ue("TRUE",(function(){return!0}),0,0),ue("FALSE",(function(){return!1}),0,0),ue("IFNA",(function(e,t){return he(e)?t:e}),2,2,g,0,g,{gk:-1}),ue("IFS",(function(){var e,t,n;for(e=0,t=arguments.length;e<t;e++){if(n={value:!1},H(arguments[e]))return arguments[e];if(!z(arguments[e++],n))return E;if(n.value)return arguments[e]}return O}),2,254,g,0,g,{gk:-1}),ue("SWITCH",(function(){var e,t,n;if(arguments.length<3)return E;if(H(arguments[0]))return arguments[0];for(e=1,t=arguments.length-1;e<t;e++){if(n=arguments[e++],H(n))return n;if("string"==typeof arguments[0]&&"string"==typeof n){if(arguments[0].toUpperCase()===n.toUpperCase())return arguments[e]}else if(arguments[0]===n)return arguments[e]}return arguments.length%2==0?arguments[arguments.length-1]:O}),3,253,g,g,g,{gk:-1}),ue("XOR",(function(){var e,t,n,o=0;for(e=0;e<f(arguments);e++)for(n=arguments[e],t=0;t<f(n);t++)n[t]&&o++;return!!(o%2)}),1,g,ke,-1,-1),ue("DATE",(function(e,t,n){e<=1899&&(e+=1900);var o=new Date(e,t-1,n);return o<new Date(1899,11,30)?F:o}),3,3,[{Hi:2,aj:["< 0","> 9999"]},Ce,Ce]),ue("TIME",(function(e,t,n){var o=u(0);return o.setHours(e),o.setMinutes(t),o.setSeconds(n),o.setMilliseconds(0),o.getHours()<0&&o.getMinutes()<0&&o.getSeconds()<0?F:o}),3,3,[Ce,Ce,Ce]),ue("DATEVALUE",(function(e){var t,n,o,r;if(Y(e)&&((t=c(e))||((t=new Date(e))&&!m(t.valueOf())||(t=null))),!t)return E;if(o=t.getFullYear(),r=Ke(t),o<1900)return E;for(n=1900;n<o;n++)r+=365,K(n)&&r++;return r}),1,1,{Ni:!0}),ue("TIMEVALUE",ot,1,1,{Ni:!0}),ue("NOW",(function(){return new Date}),0,0,g,g,g,{ck:!0}),ue("TODAY",(function(){var e=new Date;return e.setHours(0,0,0,0),e}),0,0,g,g,g,{ck:!0}),ue("HOUR",(function(e){return e.getHours()}),1,1,Me),ue("MINUTE",(function(e){return e.getMinutes()}),1,1,Me),ue("SECOND",(function(e){return e.getSeconds()}),1,1,Me),ue("DAY",(function(e){return e.getDate()}),1,1,Me),ue("MONTH",(function(e){return e.getMonth()+1}),1,1,Me),ue("YEAR",(function(e){return e.getFullYear()}),1,1,Me),ue("WEEKNUM",(function(e,t){var n,o,r;return 1===t||2===t?(n=Ke(e),o=new Date(e.getFullYear(),0,1).getDay(),2===t&&((o-=1)<0&&(o=6)),(r=n-1-(6-o))<0&&(r=0),1+V(r/7)+(r%7!=0?1:0)):F}),1,2,[Me,we],g,g,{bk:1}),ue("WEEKDAY",rt,1,2,[Me,we],g,g,{bk:1}),ue("EDATE",(function(e,t){return nt(!1,e,t)}),2,2,[Me,Ce]),ue("EOMONTH",(function(e,t){return nt(!0,e,t)}),2,2,[Me,Ce]),ue("WORKDAY",(function(e,t,n){return Xe(!0,e,t,n)}),2,3,[Me,Ce,Te],2,2,{bk:2}),ue("WORKDAY.INTL",(function(e,t,n,o){var r=$e(n);return H(r)?r:"1111111"===r.join("")?E:Xe(!1,e,t,o,r)}),2,4,[Me,Ce,{_i:"0000011"},Te],[2,3],[2,3],{bk:[2,3]}),ue("DAYS360",r.Functions.uk,2,3,[Me,Me,{_i:!1,Hi:7}],g,g,{bk:2}),ue("NETWORKDAYS",(function(e,t,n){return tt(!1,e,t,g,n,(function(e,t,n){var o=V(l(t)-l(e))%7,r=V(rt(e,2)+o),i=0===e.getDay()?1:2;return(n-=o=(o=r>5?r-5:0)>i?i:o)-2*A(n/7)}))}),2,3,[Me,Me],2,2,{bk:2}),ue("NETWORKDAYS.INTL",(function(e,t,n,o){return tt(!0,e,t,n,o,it)}),2,4,[Me,Me],[2,3],[2,3],{bk:[2,3]}),ue("YEARFRAC",r.Functions.vk,2,3,[Me,Me,{_i:0,Hi:2}],g,g,{bk:2}),ue("DATEDIF",(function(e,t,n){var o,i;if(e.setHours(0,0,0,0),t.setHours(0,0,0,0),n=n.toLocaleUpperCase(),o=function(){var e=[];return e[0]=function(e,t){return t.getFullYear()-e.getFullYear()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?-1:0)},e[1]=function(e,t){return 12*(t.getFullYear()-e.getFullYear())+(t.getMonth()-e.getMonth())+(t.getDate()<e.getDate()?-1:0)},e[2]=function(e,t){return(t.getTime()-e.getTime())/864e5},e[3]=function(e,t){var n=new Date(t.getFullYear(),t.getMonth()+(t.getDate()<e.getDate()?-1:0),e.getDate());return(t.getTime()-n.getTime())/864e5},e[4]=function(e,t){return t.getMonth()-e.getMonth()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?12:0)+(t.getDate()<e.getDate()?-1:0)},e[5]=function(e,t){var n=t.getFullYear()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?-1:0),o=e.getMonth(),r=e.getDate(),i=K(e.getFullYear());return 1!==o||29!==r||K(n)||r--,!i&&1===o&&28===r&&K(n)&&r++,(t-new Date(n,o,r))/864e5},e}(),i=p(n,["Y","M","D","MD","YM","YD"]),t<e)return F;if(i<0)throw r.sR().Exp_NotSupported;return(0,o[i])(e,t)}),3,3,[Me,Me,Ae]),ue("DAYS",(function(e,t){var n,o={value:0};if(!ce(e,o))return E;if(!ce(t,n={value:0}))return E;function r(e){return e>=0&&e<2958466}return 2958465,r(o.value)&&r(n.value)?o.value-n.value:F}),2,2),ue("ISOWEEKNUM",(function(e){var t,n,o;if(isNaN(e))return F;function r(e){var t=new Date(e,0,4),n=t.getDay();return 0===n&&(n=7),t.setDate(t.getDate()+1-n),t}return t=new Date(1900,1,28),e.getTime()<=t.getTime()&&e.setDate(e.getDate()-1),1900===(n=e.getFullYear())?n+=400:9999===n&&(n-=400),e.setYear(n),e.getTime()<new Date(n,11,29).getTime()&&n--,o=r(n+1),e.getTime()<o.getTime()&&(o=r(n)),v(""+(e.getTime()-o.getTime())/864e5/7)+1}),1,1,Me),ue("CLEAN",(function(e){var t,n,o=[];for(t=0;t<f(e);t++)0<=(n=e.charCodeAt(t))&&n<=31||127===n||128<=n&&n<=159||o.push(e[t]);return o.join("")}),1,1,Ae),ue("TRIM",(function(e){var t,n,o,r,i;for(e=e.trim(),t=[],n=!0,o=0;o<f(e);o++)(i=" "===(r=e.charAt(o))||"\t"===r||"\n"===r)&&!n||t.push(r),n=!i;return t.join("")}),1,1,Ae),ue("DOLLAR",(function(e,t){return function(e){var t=at(e),n=[];return e<0&&(t=t.substr(1)),n.push("$"),n.push(t),e<0&&(n.push(")"),n.unshift("(")),n.join("")}(e=G(ze(e,t)))}),1,2,[pe,{_i:2,Hi:2,aj:"> 99",bj:E}],g,g,{bk:1}),ue("FIXED",(function(e,t,n){var o,r,i,a,s=0;if(t<0&&(e/=s=V(I(10,b(t)))),e=G(ze(e,w(0,t))),t<0&&(e*=s),o=n?""+e:at(e),t>0)if(-1===(r=o.indexOf(".")))for(o+=".",i=0;i<t;i++)o+="0";else for(a=o.length-(r+1);a<t;a++)o+="0";return o}),1,3,[pe,{_i:2,Hi:2},{_i:!1,Hi:7}],g,g,{bk:[1,2]}),ue("TEXT",(function(e,t){var n;if(""===t)return W(e);d(e)&&(e=0),"string"==typeof e&&(e=e.trim());try{return(n=o.Formatter&&o.Formatter.GeneralFormatter)?new n(t).format(e):""+e}catch(e){return E}}),2,2,[{},Ae]),ue("VALUE",(function(e){if(!e)return 0;var t,n=c(e);return d(n)?function(e){var t,n,i,s,l,u,c,f,h,p,d=o.Common.CultureManager.q4().NumberFormat;if("$"!==e[0]&&e[0]!==d.currencySymbol||(e=e.substring(1)),t=y(e),n=r.isDigit(e[0].charCodeAt(0)),i=45===e[0].charCodeAt(0)&&r.isDigit(e[1].charCodeAt(0)),s=!e||m(t)||!n&&"."!==e[0],l=!e||m(t)||!i&&"-"!==e[0]&&"."!==e[1],s&&l)return E;for(("."===e[0]||"-"===e[0]&&"."===e[1])&&(e="-"===e[0]?e.replace(e[1],"0."):"0"+e),u=e.length,c=0,h=0,p=0;c<u;c++){for(f=e[c];c<u&&r.isDigit(f.charCodeAt(0));)c++,f=e[c];if(c===u){if(h&&c-h<=3)return E;break}if(f===d.numberGroupSeparator){if(p||h&&c-h<=3)return E;h=c}else if(f===d.numberDecimalSeparator){if(p||h&&c-h<=3)return E;p=c}}return e=a.Gb(e,",",""),y(e)}(e):(t=l(n),H(t)?ot(n):t)}),1,1,Ae),ue("LOWER",(function(e){return e.toLowerCase()}),1,1,Ae),ue("UPPER",(function(e){return e.toUpperCase()}),1,1,Ae),ue("PROPER",(function(e){var t,n,o,i=f(e),a=[];if(i>0)for(t=e.toUpperCase(),n=e.toLowerCase(),o=1,a[0]=t[0];o<i;)a[o]=r.ei(e[o-1])?n[o]:t[o],o++;return a.join("")}),1,1,Ae),ue("CHAR",(function(e){return String.fromCharCode(e)}),1,1,{Hi:2,aj:["> 255","< 1"],bj:E}),ue("CODE",(function(e){return e[0].charCodeAt(0)}),1,1,{Hi:5,Ni:!0}),ue("REPLACE",ut,4,4,[Ae,{Hi:2,aj:"< 1",bj:E},Se,Ae],g,g,{bk:2}),ue("SUBSTITUTE",(function(e,t,n,o){var r,i,s,l,u,c,h=f(t);if(f(arguments)>3){if(s=0,l=void 0,(i=V(o))<1)return E;for(l=0;l<i;l++){if(-1===(s=e.indexOf(t,s)))return e;s+=h}u=e.substring(0,s-h),c=e.substr(s),r=u.concat(n).concat(c)}else r=a.yb(e,t,n);return r}),3,4,[Ae,{Hi:5,Ni:!0},Ae],g,g,{bk:3}),ue("CONCATENATE",(function(){return st(arguments,"concatenate")}),1,g,{Hi:4,Ii:0,Ji:!0,Xi:!0},g,-1),ue("LEFT",(function(e,t){return lt(!0,e,t)}),1,2,[Ae,xe],g,g,{bk:1}),ue("MID",pt,3,3,[Ae,{Hi:2,aj:"<= 0",bj:E},Se]),ue("RIGHT",(function(e,t){return lt(!1,e,t)}),1,2,[Ae,xe],g,g,{bk:1}),ue("REPT",(function(e,t){var n,o=[];if(t<0||t*f(e)>32767)return E;for(n=0;n<t;n++)o.push(e);return o.join("")}),2,2,[Ae,Ce]),ue("LEN",(function(e){return e?e.length:0}),1,1,Ae),ue("FIND",gt,2,3,[Ae,Ae,we],g,g,{bk:2}),ue("SEARCH",mt,2,3,[Ae,Ae,xe],g,g,{bk:2}),ue("EXACT",(function(e,t){return e===t}),2,2,[Ae,Ae]),ue("T",(function(e){return Y(e)?e:""}),1,1),ue("UNICHAR",(function(e){if(e){var t=e;return t<=0||t>1114111?E:t>=55296&&t<=57343?O:t<1048576?String.fromCharCode(t):(t-=1048576,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}return E}),1,1,[{Hi:2,bj:E}]),ue("UNICODE",(function(e){var t,n,o=W(e);return""===o||null===o?E:(t=o.charCodeAt(0))>=55296&&t<=56319?1===o.length?E:(void 0,(n=o.charCodeAt(1))>=56320&&n<=57343?t|n<<8:1):t>=56320&&t<=57343?t-53248+53248:t}),1,1),ue("BAHTTEXT",(function(e){var t,n;function o(e){var t,n,o,r,i=["","","","","","",""],a=["","","","","","","","","",""],s=["","","","","","",","," ",""],l="",u=e+"",c=u.length;for(t=c;t>0;--t){if(o=a[n=v(u[c-t])],1===(r=1<t?(t-1)%6:6)&&2===n&&(o=s[4]),1===n)switch(r){case 0:case 6:l+=t<c?s[5]:o;break;case 1:break;default:l+=o}else{if(0===n){0===r&&(l+=i[r]);continue}l+=o}l+=i[r]}return l}return e?(t=Math.abs(v(e)),n=parseFloat((Math.abs(e)-t).toFixed(2)),0!==t?0===n?(e<0?"":"")+o(t)+"":(e<0?"":"")+o(t)+""+o(100*n)+"":0!==n?(e<0?"":"")+o(100*n)+"":""):E}),1,1,[{Hi:0,bj:E}]),ue("CONCAT",(function(){return st(arguments,"concat")}),1,g,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),ue("TEXTJOIN",(function(e,t){var n,o,r,i,a,s,l;if(e.isReference&&0===e.length)return R;if(n={value:!1},o=!!d(t[0])||t[0],!fe(o,n))return E;for(o=n.value,i=[],a=[],s=f(r=arguments),l=2;l<s;l++)ct(i,r[l],o);return ct(a,r[0],!1),ft(i,a)}),3,g,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),ue("FINDB",(function(e,t,n){var o,i,a,s,l,u;return dt()||r.usedbcs?(o=X(t),i=X(e),a=o.length,n<1||a<n?E:(s=yt(o),l=yt(i),-1===(u=s.indexOf(l,n-1))?E:u+1)):gt(e,t,n)}),2,3,[Ae,Ae,we],g,g,{bk:2}),ue("LEFTB",(function(e,t){return ht(!0,e,t)}),1,2,[Ae,xe],g,g,{bk:1}),ue("RIGHTB",(function(e,t){return ht(!1,e,t)}),1,2,[Ae,xe],g,g,{bk:1}),ue("MIDB",(function(e,t,n){var o,i,a;return dt()||r.usedbcs?(i=(o=X(e)).length,--t<0?E:t>=i?"":i<t+n?o.slice(t).join(""):(a=o.slice(t,t+n),"singleByte"!==$(a[a.length-1])&&(a[a.length-1]="",d(a[0])&&(a[a.length]="")),a.join(""))):pt(e,t,n)}),3,3,[Ae,Se,Se]),ue("LENB",(function(e){var t,n,i,a;if(!e)return 0;if(dt()||r.usedbcs){for(t=0,n=0;n<e.length;n++)if(8203!==e[n].charCodeAt(0)&&(i=$(e[n]),a=o.Common.CultureManager.q4(),"doubleByte"===i&&9390!==e[n].charCodeAt(0))){if("ja-jp"===(a&&a.name().toLocaleLowerCase())&&(711===e[n].charCodeAt(0)||9356===e[n].charCodeAt(0)||8212===e[n].charCodeAt(0)))continue;t++}return e.length+t}return e.length}),1,1,Ae),ue("REPLACEB",(function(e,t,n,o){var i,a,s,l,u,c,f;if(dt()||r.usedbcs){for(i=[],a=void 0,s=0,l=0;l<e.length;l++)a=e[l],"doubleByte"===$(e[l])&&(s++,a=e[l]),i[l+s]=a;return u=i.length,t=x(t,u+1),n=x(n||0,u-t+1),d(i[t-1])?(i[t-1]=" ",i[t]=" "):d(i[t-2])&&t>=2&&(i[t-2]=" ",i[t-1]=" "),c=i.slice(0,t-1).join(""),f=i.slice(t-1+n).join(""),c.concat(o).concat(f)}return ut(e,t,n,o)}),4,4,[Ae,{Hi:2,aj:"< 1",bj:E},Se,Ae],g,g,{bk:2}),ue("SEARCHB",(function(e,t,n){var o,i,a,s;return dt()||r.usedbcs?(o=X(t),i=X(e),a=o.length,n<1||a<n?E:(s=mt(yt(i),yt(o),n))===E?E:s):mt(e,t,n)}),2,3,[Ae,Ae,xe],g,g,{bk:2}),ue("ENCODEURL",(function(e){var t,n,o,r,i,a="";if((t=e.length-1)<0)return"";for(n=0;n<=t;n++)if((o=e.charCodeAt(n))>="A".charCodeAt(0)&&o<="Z".charCodeAt(0)||o>="0".charCodeAt(0)&&o<="9".charCodeAt(0)||o>="a".charCodeAt(0)&&o<="z".charCodeAt(0)||o==="-".charCodeAt(0)||o==="_".charCodeAt(0)||o===".".charCodeAt(0))a+=e[n];else{if(r=void 0,bt(o)){if(t===n||!Ct(o,e.charCodeAt(n+1)))return null;r=[o,e.charCodeAt(n+1)],n++}else r=[o];for(i=0;i<r.length;i++)a+="%",a+=r[i].toString(16).toUpperCase()}return a}),0,1,Ae),ue("ISERROR",(function(e){return H(e)}),1,1,g,g,g,{gk:-1}),ue("ISERR",(function(e){return!!H(e)&&e._code!==O._code}),1,1,g,g,g,{gk:-1}),ue("ISNA",(function(e){return!!H(e)&&e._code===O._code}),1,1,g,g,g,{gk:-1}),ue("ERROR.TYPE",(function(e){if(!d(e)&&H(e)){var t=p(e._code,[R._code,k._code,E._code,D._code,j._code,F._code,O._code]);if(t>=0)return t+1}return O}),1,1,g,g,g,{gk:-1}),ue("ISNUMBER",(function(e){return U(e,r.ExcelCompatibleCalcMode)}),1,1,g,g,g,{gk:-1}),ue("ISEVEN",(function(e){return le(b(e))%2==0}),1,1,pe,g,g),ue("ISODD",(function(e){return le(b(e))%2!=0}),1,1,pe,g,g),ue("N",(function(e){return U(e)?G(e):Q(e)?e?1:0:H(e)?e:0}),1,1,g,g,g),ue("ISBLANK",(function(e){return d(e)}),1,1,g,g,g,{gk:-1}),ue("ISLOGICAL",(function(e){return Q(e)}),1,1,g,g,g,{gk:-1}),ue("ISTEXT",(function(e){return Y(e)}),1,1,g,g,g,{gk:-1}),ue("ISNONTEXT",(function(e){return!Y(e)}),1,1,g,g,g,{gk:-1}),ue("ISREF",(function(e){return B(e)}),1,1,g,-1,g,{gk:-1}),ue("TYPE",(function(e){return Q(e)?4:U(e)?1:Y(e)?2:H(e)?16:L(e)?64:E}),1,1,g,g,-1,{gk:-1}),ue("NA",(function(){return O}),0,0),ue("SHEET",(function(e,t){var n,o,i=0,a=e.source.kj;if(L(t))return O;if(t instanceof r.CalcReference||d(t))return o=(n=t)&&(n._source||n.references[0]._source)||e.source,a.parent.getSheetIndex(o.kj.name())+1;if(U(t)||Y(t))for(;i<a.parent.sheets.length;i++)if(t.toUpperCase()===a.parent.sheets[i].name().toUpperCase())return i+1;return O}),0,1,g,-1,g,{dk:!0}),ue("SHEETS",(function(e,t){var n,o,i,a=e.source.kj;return d(t)?a.parent.sheets.length:L(t)||U(t)?O:Y(t)?E:t instanceof r.CalcReference?(o=(n=t).references)?o.length:(i=n._source||e.source,a.parent.getSheetIndex(i.kj.name())+1):O}),0,1,g,-1,g,{dk:!0}),ue("LET",g,3,253,g,g,g,{argsValidator:function(e,t,n){if(n%2==0)throw r.sR().Exp_FormulaInvalid},subExpressionValidator:function(e,t){if(t%2==0&&1===e.type)throw r.sR().Exp_FormulaInvalid}}),ue("OBJECT",(function(){var e,t,n,o,i,a,s,l,u,c,h,p,g,m,y,v,b,C=arguments,w=f(C);if(w<2||w%2!=0)return O;for(t=0;t<w;t+=2){if(i=C[t],a=C[t+1],s=wt(i,2),l=wt(a,0),H(s))return s;if(H(l))return l;if(s.isError||l.isError)return O;if(u=s.length,c=l.length,d(o))o=c;else if(o!==c)return O;if(u>c)return O;if(u<c){if(!1===n||u>1)return O;for(d(e)&&(e=[]),h=l.rowCount,p=l.colCount,g=s[0],m=0;m<h;m++){for(y=e[m],d(y)&&(y=e[m]=[]),v=0;v<p;v++)d(y[v])&&(y[v]={}),y[v][g]=l[v+m*p];e[m]=y}n=!0}else{if(!0===n)return O;for(d(e)&&(e={}),b=0;b<c;b++)e[s[b]]=l[b];n=!1}}return n?new r.CalcArray(e):e}),2,g,g,-1,-1),ue("PROPERTY",(function(){var e,t=arguments,n=t[0],o=t[1],r=o.split("."),i=r.length,a=n;if(d(n)||"object"!=typeof n)return O;for(e=0;e<i;e++)if(a=a[r[e]],d(a))return O;return a}),2,2,g),function(){var e=new r.Functions.AsyncFunction("REFRESH",1,3);e.evaluate=vt,r.Functions.bi.REFRESH=e}()},CalcEngine:function(e,t){e.exports=n("@grapecity/js-calc")},Common:function(e,t){e.exports=n("@grapecity/js-sheets-common")}}),e.exports=o.Spread.CalcEngine.BasicFunctions},"./node_modules_local/@grapecity/js-calc-basicfunctions/index.js":function(e,t,n){e.exports=n("./node_modules_local/@grapecity/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js")},"./node_modules_local/@grapecity/js-calc/dist/gc.spread.calcengine.js":function(e,t,n){var o="object"==typeof o?o:{};o.Spread=o.Spread||{},o.Spread.CalcEngine=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){var o,r;if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;if(o=Object.create(null),n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/assets/",n(n.s="./src/calc.entry.ts")}({"./src/Parser.ts":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function M(){throw r.sR().Exp_FormulaInvalid}function S(e,t,n){throw l.Kb(r.sR()[n||"Exp_FormulaInvalidChar"],[e,t])}function T(e){return e<=255}function N(e){return e<=127}function I(e){return e===r.getBoolean().boolean_true||"TRUE"===e}function R(e){return e===r.getBoolean().boolean_false||"FALSE"===e}function k(e){return e>=48&&e<=57}function E(e,t,n,o,r,i){var a,s,l=e.length,u=n===o?0:1,c=[],f=0;for(a=t+1;a<l;a++)if((s=e[a])===r&&(c.push(s),f++,s=e[++a]),s===n&&u++,s===o)if(u--,n===o&&a+2<l&&e[a+1]===n)c.push(n),a++,f++;else{if(0===u)return{result:c,endIndex:a,skipCount:f};c.push(s)}else c.push(s);i&&S(o,n,"Exp_NoSyntax")}function D(e,t,n){var o,i,a,s,l=e.length,u=l-t;for(o=0;o<r.ErrorList.length;o++)if(t+(a=(i=r.ErrorList[o]).length)<=l&&(s=e.slice(t,t+a),a<=u&&i===s.join("").toUpperCase()))return{result:s,endIndex:t+a-1};n&&S([e[t],t])}function j(e,t){return y.apply(e,t),e}function _(e,t){if(!t||0===t.length||!e.Eh)return!1;var n="'"===t[0]?1:0;return"["===t[n]&&t.indexOf("]")>n}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Common"),r=n("./src/calc.common.ts"),i=void 0,a=null,s="ARRAY",l=o.Common.u,u=o.Common.j,c=u.Fa,t.di=["+","-","%","+","-","*","/","^","&","=","<>","<","<=",">",">=",":",","," "],f={":":1,"^":2," ":3,"*":4,"/":4,",":5,"+":6,"-":6,"&":7,"<":8,"=":8,">":8,">=":8,"<=":8,"<>":8},h=".",p=",",d=";",g=",",m=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1],t.isDigit=k,t.ei=function(e){var t=e.charCodeAt(0);return!T(t)||(N(t)?(t|=32)>=96&&t<=122:0===m[t]||1===m[t])},t.fi=function(e){var t=e.charCodeAt(0);return!T(t)||(N(t)?t<=57?t>=48:(t|=32)>=96&&t<=122:0===m[t]||1===m[t])},t.isNumber=function(e){var t=e.charCodeAt(0);return N(t)?t>=48&&t<=57:8===m[t]||10===m[t]},y=[].push,v=function(){function e(e,t,n,o,r){var i,a,l;this.oi=[],r=r||0,(i=this).Qb=e,a=Array.isArray(e)?e.join(""):e,i.Nc=t,i.mi=n,i.li=o||n+e.length-1,0===t&&0===r&&e?(I(l=a.toUpperCase())||R(l))&&(r=5,a=l):1===t&&a!==s&&(a=a.toUpperCase()),i.ni=a,i.hi=r}return e.prototype.type=function(){return this.Nc},e.prototype.subType=function(){return this.hi},e.prototype.stringValue=function(){return this.ni},e}(),t.FormulaToken=v,b=function(){function e(e){void 0===e&&(e=5e3),this.priority=e}return e.prototype.resolveToken=function(e,t,n,o,r){return 0},e.prototype.unparse=function(e,t,n,o){return!0},e}(),t.TokenResolver=b,t.preOperaterTypesMap={"+":0,"-":1},t.operaterTypesMap={":":15,",":16,"+":3,"-":4,"*":5,"/":6,"^":7,"%":2,"&":8,"=":9,"<":11,"<>":10,"<=":12,">":13,">=":14},C=function(){function e(){}return e.prototype.setParserOption=function(t){var n,r;t!==i&&o.Common.CultureManager.q4()?(r="object"==typeof t&&t.NumberFormat?t.NumberFormat:o.Common.CultureManager.q4().NumberFormat,n=t?r:{}):r=n={},p=e.listSeparator=n.listSeparator||",",h=n.numberDecimalSeparator||".",!t&&e.numberDecimalSeparator||(e.numberGroupSeparator=r.numberGroupSeparator||",",e.numberDecimalSeparator=r.numberDecimalSeparator||"."),d=e.arrayGroupSeparator=n.arrayGroupSeparator||";",g=e.arrayListSeparator=n.arrayListSeparator||","},e.prototype.parse=function(e,t){var n,o;return this.setParserOption(e.culture),n=t.split(""),this.gi=n,o=this.parseToTokens(e,n,!e.ignoreError),this.buildExpressionTree(e,o,!e.ignoreError)},e.prototype.unparse=function(e,t,n){return void 0===n&&(n=[]),this.Cma(e,t,n),"@"===n[0]&&t&&t.arguments[0]&&1===t.arguments[0].type&&e&&e.source&&e.source._service&&!0!==e.source._service.allowDynamicArray&&n.splice(0,1),n.join("")},e.prototype.Cma=function(e,t,n){var o,r;if(t)for(this.setParserOption(e.culture),o=e.getResolvers(),r=0;r<o.length&&!o[r].unparse(e,this,t,n);r++);},e.prototype.parseToTokens=function(e,n,o){var r,i,a,l,u,c,f,m,b,C,w,x,A,M,T,N;for(void 0===o&&(o=!0),r=this,i=function(e,t,n){return t.length>0&&e.push(new v(t,0,n)),[]},a=n.length,l=[],u=[],c=-1,f=[],C=0,A=!1;C<a&&" "===n[C];)C++;for("="===n[C]&&C++,b=C,M=function(C){var M,N,I,R,_,O,F,P,H,B,L=n[C],z=L.charCodeAt(0),V=void 0;if(64===z&&e.kj&&e.kj.Wu&&!0===e.kj.Wu.allowDynamicArray)m=new v(L,1,C,C,1),l.push(m),u[++c]=m,b=C+1,A=!0;else if(z>=97&&z<=122||z>=65&&z<=90)f.push(L);else if(34===z)(V=E(n,C,'"','"',"",o))?(M=new v(V.result,0,C,C+V.result.length+2,3),V.skipCount&&(M.HTa=n.slice(C,V.endIndex+1).join(""),M.li+=V.skipCount),l.push(M),C=V.endIndex,b=C+1):(j(f,n.slice(C,a)),C=a-1);else if(39===z)(V=E(n,C,"'","'","",o))?(I=[],(N=function(e){var t,n,o=[];if(e.indexOf(":")>-1)for(t=e.split(":"),n=0;n<t.length;n++)o.push("'"+t[n].replace(/'/g,"''")+"'");return o}(V.result.join(""))).length>1&&(R=N.join(":").split(""),I=r.parseToTokens(e,R,o)),I&&I.length>0?(I.forEach((function(e){e.mi+=C,e.li+=C})),j(l,I)):(f.push("'"),j(f,V.result),f.push("'")),C=V.endIndex):(f.push("'"),C=a-1);else if(91===z)if(V=E(n,C,"[","]","'",o))f.push("["),j(f,V.result),f.push("]"),C=V.endIndex;else{if(r.lda&&0===f.length&&("R"===f[0]||"r"===f[0]||"C"===f[0]||"c"===f[0]))return T=C,"continue";j(f,n.slice(C,a)),C=a-1}else{if(13===z||10===z)return T=C,"continue";if(35===z)(_=D(n,C))?(l.push(new v(_.result,0,C,C+_.result.length-1,6)),b=C+1,C=_.endIndex):f.push(L);else if(33===z)f.length,(O=l.length)>0&&0===l[O-1].Nc?(F=l[O-1],y.apply(F.Qb,f),l[O-1]=new v(F.Qb,0,F.mi,C,12)):l.push(new v(f,0,b,C,12)),f=[],b=C+1;else if(43===z||45===z)P=0===l.length?null:l[l.length-1],0!==f.length?(l.push(new v(f,0,b)),l.push(new v(L,5,C)),f=[],b=C+1):(P&&7===P.Nc&&l.pop(),!P||2!==P.hi&&6!==P.Nc&&0!==P.Nc?(l.push(new v(L,4,C)),b=C+1):(l.push(new v(L,5,C)),b=C+1));else if(L===h||k(z))f.length>0?f.push(L):(H=function(e,t,n){var o,r,i=e.length,a=0,s=[];for(o=t;o<i;o++)if(k((r=e[o]).charCodeAt(0)))0===a?a=2:3===a?a=4:1===a?a=2:5!==a&&6!==a||(a=7),s.push(r);else if(r===n){if(2===a)a=4;else{if(0!==a&&1!==a)return{};a=3}s.push(".")}else if("+"===r||"-"===r){if(0===a)a=1;else{if(5!==a)return{num:s,endIndex:o-1};a=6}s.push(r)}else if("E"===r||"e"===r){if(2!==a&&4!==a)return{};a=5,s.push(r)}else if(2===a||4===a||7===a)return{num:s,endIndex:o-1};return 2===a||4===a||7===a?{num:s,endIndex:i-1}:{}}(n,C,h)).num?(w=H.endIndex,B=H.num,w<=a-2&&"!"===n[w+1]?(j(f,B),b=w):(l.push(new v(B,0,C,w,4)),b=w+1),C=w):f.push(L);else if(123===z)f.length>0&&o&&S(L,C),m=new v(s,1,C,C,1),l.push(m),u[++c]=m,b=C+1;else if(L===d&&c>=0&&u[c].value===s)f=i(l,f,b),c<0&&o&&S(L,C),l.push(new v(d,3,C,C)),b=C+1;else if(125===z)f=i(l,f,b),w<0&&o&&S(L,C),x=u[c--],x=new v(L,x.Nc,C,C,2),l.push(x),b=C+1;else if(32===z)f=i(l,f,b),b=C+1;else if(L===p||L===g||L===d)f=i(l,f,b),A&&L===p&&(A=!1,x=new v(")",1,C,C,2),l.push(x)),c<0||1!==u[c].Nc?l.push(new v(p,5,C,C,10)):l.push(new v(L,3,C,C)),b=C+1;else if(37===z)f=i(l,f,b),l.push(new v(n[C],6,C,C)),b=C+1;else if(C+2<=a&&t.operaterTypesMap[L+n[C+1]])f=i(l,f,b),l.push(new v(n.slice(C,C+2),5,C,C+1,5)),C++,b=C+1;else if(t.operaterTypesMap[L])f=i(l,f,b),l.push(new v(L,5,C,C)),b=C+1;else if("("===L)f.length>0?(m=new v(f,1,b,C,1),f=[]):m=new v(L,2,C,C,1),l.push(m),u[++c]=m,b=C+1,A=!1;else if(")"===L){if(f=i(l,f,b),c<0)return o&&S(L,C),T=C,"continue";x=u[c--],x=new v(L,x.Nc,C,C,2),l.push(x),b=C+1}else if(":"===L)f=i(l,f,b),l.push(new v(L,5,C,C,11)),b=C+1;else if("\r"===L||"\n"===L);else{if("\\"===L){if(++C>=a)return o&&S(L,C),T=C,"continue";f.push(L),L=n[C]}f.push(L)}}T=C},N=C;N<a;N++)M(N),N=T;return i(l,f,b),l},e.prototype.buildExpressionTree=function(e,t,n){var o,r=this.ii(e,t,n),i=this.ji(e,r,n);return n&&(i||M(),this.rSa(i)),!((o=e.source)&&o.q$a)&&i&&(i.ehc=!0),i},e.prototype.rSa=function(e){for(var t,n,o,i,a,s;10===e.type;)e=e.value;if(t=this,9===e.type)e.value||M(),t.rSa(e.value),e.value2&&t.rSa(e.value2);else if(7===e.type)for(o=(n=e.arguments).length,(i=e.function)&&i.gEc(i.minArgs,i.maxArgs,o),a=0;a<o;a++)s=n[a],i?i.hEc(s,a):r.iEc(s,a),t.rSa(s)},e.prototype.ji=function(e,t,n){var o,i,a,s,l,u,c=this.ki(e,t,n);for(s=3;s<c.length;)if(l=c[s],9!==(u=c[s-2]).type&&n&&M(),l&&9===l.type){for(;s>=3&&f[l.value]>=f[u.value];)i=c[s-3],a=c[s-1],o=r.Kh(u.operatorType,i,a),c.splice(s-3,3,o),(s-=2)>=3&&(u=c[s-2]);s+=2}else s++;if(1===c.length)return c[0];for(s=c.length-2;s>0;s-=2)i=c[s-1],a=c[s+1],9!==c[s].type&&n&&M(),o=r.Kh(c[s].operatorType,i,a),c.splice(s-1,3,o);return o},e.prototype.ki=function(e,t,n){var o,i,a,s,l,u,c,f,h,d,g,m,y,v;for(o=[],i=(t=Array.isArray(t)?t:[t]).length,a=0;a<i;a++){if(l=s=t[a],9===s.type){if(0===s.operatorType||1===s.operatorType)if(a===i-1)n&&M();else{for(u=a;9===t[u].type&&t[u].operatorType<=1;)u++;for(c=this.ji(e,t[u]),f=u-1;f>=a;f--)c=l=r.Kh(t[f].operatorType,c);l=c,a=u}else if(2===s.operatorType){if(0!==a){l=r.Kh(s.operatorType,this.ji(e,o[o.length-1])),o[o.length-1]=l;continue}n&&M()}}else if(10===s.type)s.value=this.ji(e,s.value),l=s;else if(7===s.type){if(h=0,g=[],m=[],(d=s.arguments).length>0){for(y=0;y<=d.length;y++)v=d[y],y===d.length||0===v.type&&v.value===p?(h===y?g.push(new r.Expression(11)):g.push(this.ji(e,m)),h=y+1,m=[]):m.push(v);s.arguments=g}l=s}o.push(l)}return o},e.prototype.ii=function(e,t,n){var o,r,i=[];for(o=0,r=t.length;o<r;)o=this.resolveToken(e,t,i,o,n);return i},e.prototype.resolveToken=function(e,t,n,o,s){var l,u,c,f,h,p=t[o],d=e.getResolvers();for(l=0;l<d.length;l++)if(u=d[l].resolveToken(e,this,t,o,s)){f=o-1,(c=u.expr)&&u.index!==i?o=u.index-1:c=u,(h=n.length>0?n[n.length-1]:a)&&0!==c.type&&7!==c.type&&c.type<9&&0!==h.type&&7!==h.type&&h.type<9&&(t[f].li<p.mi-1&&n.push(r.Kh(17," "))),n.push(c);break}return o+1},e.prototype.resolveSubTokens=function(e,t,n,o){for(var r=[];n<t.length&&2!==t[n].hi;)n=this.resolveToken(e,t,r,n,o);return{exprs:r,index:n+1}},e}(),t.Parser=C,w=function(){function e(e,t,n,o){this.Eh=!1,this.ignoreError=!1;var r=this;r.useR1C1=t,r.baseIdentity=n,r.option=o,r.source=e}return e.prototype.getExternalSource=function(e,t){var n,o=this.source.getCalcService().getAllSourceModels();for(n=0;n<o.length;n++)if(l.Mb(o[n].getSource().getName(),t))return o[n].getSource();return a},e.prototype.getExternalSourceToken=function(e){return e.getName()},e.prototype.setSource=function(e){this.source=e},e.prototype.getResolvers=function(){var e=(this.source||this.kj).getCalcService();return e&&e.getResolvers()},e.prototype.addResolver=function(e){var t=(this.source||this.kj).getCalcService();t&&t.addResolver(e)},e.prototype.getFunction=function(e){var t,n=e,o=r.getMapping()&&r.getMapping().builtInFunctionsMapping;if(!c(o))for(t in o)o[t].alias===e&&(n=t);return this.source&&this.source.getCustomFunction(n)||r.Functions.findGlobalFunction(e)},e}(),t.ParserContext=w,r.CalcSource.prototype.getParserContext=function(e,t,n){return new w(this,e,t,n)},x=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return A(n,e),n.prototype.resolveToken=function(e,n,o,a,u){var c,f,h,p,g,m,y,v,b,C,w,x=o[a],A=x.ni,S=x.Qb,T=x.Nc,N=null,k=x.hi;if(0===T&&12===k){if(g=void 0,A&&("'"===(g=A).charAt(0)&&(g=g.substring(1,g.length-1))),a++,g&&(N=e.getExternalSource("",g)),!(x=o[a]))return(c=new r.Expression(8)).value=A,c;A=x.ni}if(0===T)0===x.hi?I(h=A.toUpperCase())||R(h)?(x.hi=5,x.ni=h,(c=new r.Expression(4)).value=I(h)):(c=new r.Expression(8)).value=A:4===x.hi?((c=new r.Expression(2)).value=parseFloat(A),c.originalValue=A):3===x.hi?(c=new r.Expression(3)).value=A:5===x.hi?(c=new r.Expression(4)).value=I(A):6===x.hi?(c=new r.Expression(5)).value=r.CalcError.parse(A):7===x.hi&&((c=new r.Expression(8)).value=A);else if(1===T){if(A===s){for(c=new r.Expression(6),a++,h=[[]],f=0,m=0,y=0;a<o.length&&2!==o[a].hi;){if(x=o[a],a<o.length-1&&4===x.Nc&&"-"===x.ni&&4===o[a+1].hi&&((x=o[++a]).Qb.unshift("-"),x.ni="-"+x.ni),3===x.Nc){if(x.ni===d){if(m!==y)throw l.Kb(r.sR().Exp_InvalidArrayColumns,[x.mi]);h.push([]),f++,y=0}}else{if(0!==x.Nc||4!==x.hi&&3!==x.hi&&5!==x.hi&&6!==x.hi)throw r.sR().Exp_InvalidArray;b=v=x.ni,4===x.hi?b=parseFloat(v):5===x.hi?b="TRUE"===v.toUpperCase():6===x.hi&&(b=r.CalcError.parse(v)),h[f].push(b),0===f&&m++,y++}a++}if(m!==y)throw l.Kb(r.sR().Exp_InvalidArrayColumns,[x.mi]);return a++,c.value=new r.CalcArray(h),{expr:c,index:a}}if(S.length>0)return C=e.source&&e.source._service&&e.source._service.allowDynamicArray,"@"!==S[0]||C||(x.ni=S.slice(1).join(""),A=x.ni),(c=new r.Expression(7)).functionName=A,w=e.getFunction(c.functionName)||r.Functions.findGlobalFunction(c.functionName),!1===C&&w&&!0===w.isDynamicArrayFunction&&(w=i),c.function=w,(p=n.resolveSubTokens(e,o,a+1))?(c.arguments=p.exprs,{expr:c,index:p.index}):(c.arguments=[],c)}else if(4===T||6===T||5===T)c=r.Kh(4===T?t.preOperaterTypesMap[A]:t.operaterTypesMap[A],A);else if(2===T){if(c=new r.Expression(10),p=n.resolveSubTokens(e,o,a+1))return c.value=p.exprs,{expr:c,index:p.index};u&&M()}else 3===T&&((c=new r.Expression(0)).value=A);return N&&c&&(c.source=N,c={expr:c,index:a+1}),c},n.prototype.unparse=function(e,t,n,o){var i,a,s,l,u,c=this;if(6===n.type||4===n.type||2===n.type||5===n.type||3===n.type)c.qi(e,n,o);else if(9===n.type)c.ri(e,t,n,o);else if(10===n.type)o.push("("),t.Cma(e,n.value,o),o.push(")");else{if(7!==n.type)return(1===n.type||8===n.type)&&(c.unparseRefenceExpressions(e,t,n,o),!0);for(i=n.function&&n.function.name||n.functionName,j(o,((s=(a=r.getMapping()&&r.getMapping().builtInFunctionsMapping)&&a[i])&&s.alias||i).split("")),l="@"===i?["",""]:["(",")"],o.push(l[0]),u=0;u<n.arguments.length;u++)0!==u&&o.push(p),t.Cma(e,n.arguments[u],o);o.push(l[1])}return!0},n.prototype.unparseSource=function(e,t,n,o){if(e.getExternalSourceToken){if(n!==r.BangSource){var i=function(e,t,n){var o,r;if(!t||0===t.length||_(e,t)||_(e,n))return[];if(o=t,n)for(o.push(":"),r=0;r<n.length;r++)o.push(n[r]);return o}(e,e.getExternalSourceToken(n).split(""),o&&e.getExternalSourceToken(o).split(""));if(!(i.length>0))return!1;y.apply(t,i)}return t.push("!"),!0}return!1},n.prototype.unparseRefenceExpressions=function(e,t,n,o){if(n.source===r.BangSource)o.push("!");else if(n.source){if(!this.unparseSource(e,o,n.source,n.endSource))return void o.push("#","R","E","F","!")}8===n.type&&o.push(n.value)},n.prototype.ri=function(e,n,o,r){var i=o.operatorType;2===i?(n.Cma(e,o.value,r),r.push("%")):0===i||1===i?(r.push(t.di[i]),n.Cma(e,o.value,r)):(n.Cma(e,o.value,r),r.push(t.di[i]),n.Cma(e,o.value2,r))},n.prototype.qi=function(e,t,n){var o,s,u,c,f,p,m,y,v=r.sR().Exp_InvalidArray;if(3===t.type)n.push('"'),n.push(l.Gb(t.value,'"','""')),n.push('"');else if(2===t.type)o=t.originalValue||""+t.value,"."!==h&&(o=o.replace(".",h)),n.push(o);else if(4===t.type)n.push(t.value?r.getBoolean().boolean_true:r.getBoolean().boolean_false);else if(6===t.type){if(n.push("{"),(s=t.value).getRowCount()<=0)throw v;for(u=0,c=s.getRowCount();u<c;u++)for(u>=1&&n.push(d),f=0,p=s.getColumnCount();f<p;f++){if(0!==f&&n.push(g),(m=s.getValue(u,f))===i||m===a)throw v;"string"===(y=typeof m)?(n.push('"'),n.push(l.Gb(m,'"','""')),n.push('"')):"boolean"===y?n.push(m?r.getBoolean().boolean_true:r.getBoolean().boolean_false):"number"===y&&"."!==h?n.push((""+m).replace(".",h)):n.push(""+m)}n.push("}")}else 5===t.type?n.push(""+t.value):t.type},n}(b),t.DefaultTokenResolver=x,r.ParserWrapper.XAb=function(){C.numberDecimalSeparator===i&&(new C).setParserOption(!0);return C.numberDecimalSeparator},r.ParserWrapper.YAb=function(){C.numberGroupSeparator===i&&(new C).setParserOption(!0);return C.numberGroupSeparator}},"./src/calc.common.ts":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe,re,ie,ae,se,le,ue,ce=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function fe(e){return e&&e.toUpperCase()}function he(e){return isNaN(e)||!isFinite(e)}function pe(e,t){var n,o,r,l,u,c,f,h,p,d,g;if(!e)return t.value=0,!0;o=typeof e;try{if(o===i)n=e;else if(o===a){if(/[\f\n\r\t\v]/.test(e))return!1;if(r=e,0===(e=e.trim()).length)return t.value=0,!0;if(l=X.XAb(),u=X.YAb(),"."!==l&&"."!==u&&e.indexOf(".")>=0||","!==l&&","!==u&&e.indexOf(",")>=0)return!1;if(c=!1,f=!1,h=e[0],p=e[e.length-1],"("===e[0]&&")"===p){if(f=!0,"+"===(h=(e=e.substring(1,e.length-1).trim())[0])||"-"===h)return!1;p=e[e.length-1]}if("%"===h?(c=!0,e=e.substring(1)):"%"===p?(c=!0,e=e.substring(0,e.length-1)):"$"===h&&(e=e.substring(1)),e.indexOf(u)>=0&&(S.qb("^\\ *[\\+|\\-]?\\ *\\d+(\\"+u+"\\d{3,})+(\\"+l+"\\d*)?([E|e][\\+|\\-]?\\d+)?\\ *$").test(e)&&(e=e.replace(S.qb("[ \\"+u+"]"),"")))," "===(e=e.trim())[1]&&("+"===e[0]?e=e.replace(/^\+ +/,"+"):"-"===e[0]&&(e=e.replace(/^\- +/,"-"))),"."!==l&&(e=e.replace(l,".")),e.indexOf(l)!==e.lastIndexOf(l))return!1;if(e.length>=2&&"0"===e[0]&&"x"===e[1])return!1;if(n=(+e).valueOf(),c&&(n/=100),f&&(n=-n),he(n)){if(d=(e=r.trim()).charCodeAt(0),d|=32,e.length>4&&d>=97&&d<=122&&(g=(g=e[0]+e[1]+e[2]).toUpperCase(),!$[g]))return!1;if(h=e[0],p=e[e.length-1],"/"===h||"-"===h||":"===h||"/"===p||"-"===p)return!1;if(S.qb("[\\'\\$\\#\\*\\%\\!\\@\\&\\(\\)\\=\\;\\\"\\<\\>\\?\\,]").test(e))return!1;if(he((n=new Date(e)).valueOf()))return!1;n=I.Ra(n)}}else if(o===s)n=e?1:0;else{if(!(e instanceof Date))return!1;n=I.Ra(e)}}catch(e){return!1}return t.value=n,!0}function de(e){var n={value:0};if(pe(e,n))return n.value;throw t.sR().Exp_InvalidCast}function ge(e,t){return t&&(e===j||e===_||typeof e===a&&""===e.trim())}function me(e,t){try{if(e)if(typeof e===s);else if(e instanceof Date)e=0!==I.Ra(e);else{if(!ve(e))return!1;e=0!==e}else e=!1}catch(e){return!1}return t.value=e,!0}function ye(e,t,n,r,l){var u,c,f;if(be(e))return e;if(u={value:j},c=G,0!==t&&ge(e,r))return c;switch(t){case 1:case 5:if(n&&5!==t){if(typeof e===s&&l)return c;e=pe(e,u)?u.value:c}else typeof e===i||(e=e instanceof Date?I.Ra(e):c);break;case 11:e=pe(e,u)?u.value:c;break;case 4:typeof e===a?e=(f=o.Common.l.Qa(e))!==_&&f!==j?I.Ra(f):c:n?e=pe(e,u)?u.value:c:typeof e===i||e instanceof Date||(e=c);break;case 3:n?e=pe(e,u)?u.value:c:typeof e!==s&&(e=c);break;case 2:e=e===j||e===_?"":""+e}return e}function ve(e,t){return typeof e===i||e instanceof Date||!t&&(typeof e===s||!isNaN(e)&&!isNaN(parseFloat(e)))}function be(e){return e instanceof W}function Ce(e){return e instanceof ee}function we(e){return e instanceof re}function xe(e,t,n){var o=new oe(5);return t&&(o.source=t),n&&(o.endSource=n),o.value=e,o}function Ae(e,t){return e.charAt(t)}function Me(e,t){for(var n=e.length,o=!1;t<n&&!isNaN(+Ae(e,t));)t++,o=!0;for(t<n&&"."===Ae(e,t)&&t++;t<n&&!isNaN(+Ae(e,t));)t++,o=!0;if(t<n&&("E"===Ae(e,t)||"e"===Ae(e,t)))for(o=!1,++t<n&&("+"===Ae(e,t)||"-"===Ae(e,t))&&t++;t<n&&!isNaN(+Ae(e,t));)t++,o=!0;return{Vi:o,mi:t}}function Se(e){return"string"==typeof e}function Te(e,n){if(!e||8===e.type&&e.value.indexOf("'")>=0)throw t.sR().Exp_FormulaInvalid}function Ne(e,t){return{row:e,col:t}}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Common"),r=n("./src/calcEngine.res.en.ts"),t.ExcelCompatibleCalcMode=!1,t.SR={en:r.resource},t.ErrorCodeList=[0,7,15,23,29,42,36,99,100],i="number",a="string",s="boolean",l="TRUE",u="FALSE",b=[c="#NULL!",f="#DIV/0!",h="#VALUE!",p="#REF!",d="#NAME?",g="#N/A",m="#NUM!",y="#SPILL!",v="#CALC!"],t.ErrorList=b,t.BAND_INDEX_CONST=-2147483648,t.MAX_ROW_COUNT=1048576,t.MAX_COLUMN_COUNT=16384,C=o.Common.j,w=C.Ca,x=C.Fa,A=C.Ea,M=o.Common.k.ac,S=o.Common.q,T=parseInt,N=isNaN,I=o.Common.l,R=I.Ra,k=o.Common.u,E=o.Common.o,D=new o.Common.ResourceManager(t.SR),t.sR=D.getResource.bind(D),t.getMapping=function(){return le&&le.resourceMapping},t.getBoolean=function(){var e=t.getMapping()&&t.getMapping().booleanMapping;return{boolean_true:e&&e.boolean_true||l,boolean_false:e&&e.boolean_false||u}},j=null,_=void 0,O=Math.abs,F=Math.exp,P=Math.log,H=Math.pow,B=Math.floor,L=Math.ceil,z={},t.BangSource=z,V={},t.RefErrorSource=V,t.missingArgument=void 0,G={},W=function(){function e(n){var o=e.nf(n);if(!o)throw t.sR().Exp_NotSupported;this._error=o.error,this._code=o.code}return e.prototype.toString=function(){var e=t.getMapping()&&t.getMapping().clacErrorMapping;return e&&e[this._error]||this._error},e.prototype.clone=function(){return new e(this._error)},e.prototype.toJSON=function(){return{_calcError:this._error,_code:this._code}},e.parse=function(t){try{return new e(t)}catch(e){return _}},e.nf=function(e){var n,o;if(e)for(n=0;n<b.length;n++)if((o=b[n])===e||o===fe(e))return{error:o,code:t.ErrorCodeList[n]};return _},e}(),t.CalcError=W,U={Name:new W(d),Null:new W(c),DivideByZero:new W(f),NotAvailable:new W(g),Value:new W(h),Reference:new W(p),Number:new W(m),Spill:new W(y),Calc:new W(v)},t.Errors=U,Z=U.Value,q=U.Reference,J=U.Number,Q=U.DivideByZero,Y=U.NotAvailable,K=U.Null,$={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12},X=function(){},t.ParserWrapper=X,ee=function(){function e(e,t){this.array=e,this.referenceInTwoDimension=t}return e.prototype.getRowCount=function(){return this.array.length},e.prototype.getColumnCount=function(){var e=this.array[0];return e&&e.length||0},e.prototype.getValue=function(e,t){var n,o=this.array,r=e;return"number"!=typeof t&&(r=(n=e).row,t=n.column),r<0||t<0||r>=o.length||t>=o[0].length?Z:this.array[r][t]},e.prototype.getValueByIndex=function(e){var t=this.getColumnCount(),n=B(e/t),o=e%t;return this.getValue(n,o)},e.prototype.toArray=function(e,t,n,o,r,i,a){var s,l,u,c,f,h,p,d,g;if(void 0===t&&(t=!0),0,u=0,c=[],p=G,l=(s=this).getRowCount())for(u=s.getColumnCount(),d=0;d<l;d++)for(t||(h=[],c.push(h)),g=0;g<u;g++){if(f=s.getValue(d,g),s.referenceInTwoDimension&&we(f)&&(f=f.getValueByIndex(0)),n&&be(f))return(c=[f]).isError=!0,c;if(f=ye(f,e,!1,i),o&&f===p)return(c=[f]).isConvertError=!0,c;t?c.push(f):h.push(f)}return c.rowCount=l,c.colCount=u,c.rangeCount=1,c},e.prototype.slice=function(t,n,o,r){var i,a,s,l=this,u=l.array,c=[];for(n=n<0?0:n,o=(t=t<0?0:t)+o>l.getRowCount()?l.getRowCount()-t:o,r=n+r>l.getColumnCount()?l.getColumnCount()-n:r,a=0;a<o;a++)for(i=[],c.push(i),s=0;s<r;s++)i.push(u[a+t][s+n]);return new e(c)},e}(),t.CalcArray=ee,te=["o","n","s","b","d"],ne=function(){function e(){}return e.jja=function(e){return be(e)&&e._code===t.ErrorCodeList[5]},e.Nh=function(e){return isNaN(e)||!isFinite(e)?J:e},e.Ph=function(t,n,o,r,i,a,s,l){var u,c,f;if(t&&t.length&&t.rowCount&&t.colCount)return t;if(Ce(t))(u=t.toArray(n,o,r,i,a)).isArray=!0;else if(we(t))(u=t.toArray(n,o,r,i,a,s,l)).isReference=!0;else if(w(t)){if(u=[],0===t.length)return u;if(w(t[0]))return e.Oh(t,n,!0);for(c=0;c<t.length;c++)(f=ye(t[c],n,!1))===e.CalcConvertedError&&(u.isConvertError=!0),u.push(f);u.rowCount=1,u.colCount=t.length,u.rangeCount=1}else t=ye(t,n,!0,a),r&&e.vf(t)?(u=[Z]).isError=!0:t===e.CalcConvertedError?(u=[e.CalcConvertedError]).isConvertError=!0:o?(u=[]).push(t):(u=[[]])[0].push(t),u.rowCount=1,u.colCount=1,u.rangeCount=1;return u},e.Oh=function(t,n,o){var r,a,l,u,c,f,h,p,d,g,m,y,v;if(!t||!t.length||!t[0].length)return(r=[]).isError=!0,[[Z]];if(0===n)return t;if(a=te[n],l=t.length,u=t[0].length,p={value:j},d=!1,g=!1,m=e.CalcConvertedError,!(r=t[a]))for(r=[],t[a]=r,y=0;y<l;y++)for(c=t[y],f=r[y]=[],v=0;v<u;v++)if(be(h=c[v]))d||(r.isError=!0,d=!0),f.push(h);else{switch(n){case 1:case 5:o&&5!==n?pe(h,p)?h=p.value:(g||(g=!0,r.isConvertError=!0),h=0):typeof h===i||h instanceof Date||(g||(g=!0,r.isConvertError=!0),h=m);break;case 3:o?me(h,p)?h=p.value:(g||(g=!0,r.isConvertError=!0),h=!1):typeof h!==s&&(g||(g=!0,r.isConvertError=!0),h=m);break;case 2:h=h===j||h===_?"":""+h}f.push(h)}return r},e.Rh=function(e){var n=de(e);if(O(n)<1e21)return parseInt(""+n,10);throw t.sR().Exp_InvalidCast},e.Sh=function(e,t){return""!==e&&(!!pe(e,t)&&O(t.value)<1e21&&(t.value=parseInt(""+t.value,10),!0))},e.Vh=function(n){if(!n)return!1;if(typeof n===s)return n;if(n instanceof Date)return 0!==I.Ra(n);if(e.Na(n))return 0!==n;if(e.vf(n))return!1;throw t.sR().Exp_InvalidCast},e.bc=function(e){try{if(e===_||e===j)return"";if(typeof e===s)return e?l:u;if(typeof e===a)return e;if(e instanceof Date)return""+I.Ra(e);if(Ce(e))throw t.sR().Exp_InvalidCast;return""+e}catch(e){throw t.sR().Exp_InvalidCast}},e.Wh=function(n){var o={value:j};if(e.Xh(n,o))return o.value;throw t.sR().Exp_InvalidCast},e.Xh=function(e,t){var n,r,s,l;if(e)if(e instanceof Date)t.value=new Date(e.valueOf());else if(typeof e===a){if(!(n=o.Common.l.Qa(e)))if(isNaN(e)){if(n=new Date(e),isNaN(n.valueOf()))return!1;try{if(r=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,s=k.ib(k.Db(e.replace(/ |\n/g,"")," ")," "),(l=r.exec(s))&&4===l.length&&(-1===l.indexOf(""+n.getFullYear())||-1===l.indexOf(""+n.getMonth())||-1===l.indexOf(""+n.getDate())))return!1}catch(e){return!1}}else if(!(n=o.Common.l.Xb(parseFloat(e))))return!1;t.value=n}else{if(typeof e!==i)return!1;t.value=o.Common.l.Xb(e)}else t.value=o.Common.l.Xb(0);return!0},e.CalcConvertedError=G,e.Ca=Ce,e.Na=ve,e.vf=be,e._isReference=we,e.wf=ye,e.j$a=ge,e.Qh=he,e.Pa=de,e.Th=pe,e.Uh=me,e}(),t.Convert=ne,function(e){e[e.unknow=0]="unknow",e[e.reference=1]="reference",e[e.number=2]="number",e[e.string=3]="string",e[e.boolean=4]="boolean",e[e.error=5]="error",e[e.array=6]="array",e[e.function=7]="function",e[e.name=8]="name",e[e.operator=9]="operator",e[e.parentheses=10]="parentheses",e[e.missingArgument=11]="missingArgument",e[e.expand=12]="expand",e[e.structReference=13]="structReference",e[e.spillReference=33]="spillReference",e[e.letLocalName=100]="letLocalName"}(t.ExpressionType||(t.ExpressionType={})),oe=function(){function e(e){this.type=e}return e.prototype.sf=function(){return j},e.prototype.offset=function(e,t,n,o,r){return j},e.prototype.offsetWhenCopy=function(e,t,n,o,r,i,a,s,l,u){return j},e.prototype.getRange=function(e,t){var n,o=[];for(n=2;n<arguments.length;n++)o[n-2]=arguments[n];return j},e}(),t.Expression=oe,re=function(){function e(e,t){var n=this;n._source=e,t?(n._identities=t,n.zf=t.length):n.zf=1}return e.prototype.getRangeCount=function(){return this.zf},e.prototype.getSource=function(){return this._source},e.prototype.create=function(t){return new e(this._source,t)},e.prototype.toArray=function(e,t,n,o,r,i,a){var s=this._source,l=s.referenceToArray;return l&&l.call(s,this,e,t,n,o,r,i,a)},e.prototype.getRow=function(e){return this._identities?this._identities[e||0].row:0},e.prototype.getColumn=function(e){return this._identities?this._identities[e||0].col:0},e.prototype.getRowCount=function(e){return this._identities?this._identities[e||0].rowCount:this._source.getRowCount()},e.prototype.getColumnCount=function(e){return this._identities?this._identities[e||0].colCount:this._source.getColumnCount()},e.prototype.getValue=function(e,t,n){var o,r,a;if(typeof e===i?(o=arguments[1],r=arguments[2],t=arguments[0]):(o=(e=e).row,r=e.col),t=t||0,o>=0||r>=0){if(!(a=this._identities))return this._source.getValue(o,r);if(t<a.length)return this._source.getValue(o+a[t].row,r+a[t].col)}return q},e.prototype.getValueByIndex=function(e){var t=this.getColumnCount(),n=B(e/t),o=e%t;return this.getValue(0,n,o)},e.prototype.isHiddenRow=function(e,t,n){return this._source.isHiddenRow(t+this.getRow(e),n)},e.prototype.isSubtotal=function(e,t,n){var o=this._source;return 0===e&&t<o.getRowCount()&&n<o.getColumnCount()&&function e(t){var n,o;if(t){if(7===t.type&&("SUBTOTAL"===t.functionName||"AGGREGATE"===t.functionName))return!0;for(n=t.arguments&&t.arguments.length,o=0;o<n;o++)if(e(t.arguments[o]))return!0;if(e(t.value)||e(t.value2))return!0}return!1}(o.getCalcSourceModel()._getExpressionWithRowColumn(t,n))},e}(),t.CalcReference=re,ie=function(){function e(t){this.id=e.sourceId++,this._service=t,this.Bf=null}return e.prototype.getCalcService=function(){return this._service},e.prototype.Cf=function(){return this._service},e.prototype.setCalcService=function(e){this._service=e},e.prototype.getCalcSourceModel=function(){return this.Bf},e.prototype.setCalcSourceModel=function(e){this.Bf=e},e.prototype.getValue=function(){var e,t=[];for(e=0;e<arguments.length;e++)t[e]=arguments[e];return j},e.prototype.getName=function(){return""},e.prototype.getField=function(e){return j},e.prototype.setValue=function(){var e,t=[];for(e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.getReference=function(e){return new re(this,e&&[e])},e.prototype.getSources=function(e){return[this]},e.prototype.referenceToArray=function(e,t,n,o,r,i,a,s){return e.toArray(t,n,o,r,i,a,s)},e.prototype.setFormula=function(){var e,t=[];for(e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.setArrayFormula=function(){var e,t=[];for(e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.getRowCount=function(){return 1e3},e.prototype.getColumnCount=function(){return 100},e.prototype.isHiddenRow=function(e,t){return!1},e.prototype.startCalculation=function(){},e.prototype.endCalculation=function(){},e.prototype.getCustomFunction=function(e){return j},e.prototype.getCustomName=function(e){return j},e.prototype.refresh=function(){},e.prototype.toJSON=function(e,t){var n,o=[];for(n=2;n<arguments.length;n++)o[n-2]=arguments[n]},e.sourceId=1,e}(),t.CalcSource=ie,t.Hh=xe,t.Ih=xe(q),t.Jh=function(e,t){var n=new oe(7);return n.arguments=t,e instanceof oe?(n.function=e.function,n.functionName=e.functionName):(n.function=e.name&&e,n.functionName=e.name||e),n},t.createExpandExpression=function(e,t){var n=new oe(12);return n.value=e,n.needExpendIndexs=t,n},t.Kh=function(e,t,n){var o=new oe(9);return o.operatorType=e,o.value=t,o.value2=n,o},t.Lh=function(e){var t=new oe(10);return t.value=e,t},t.createStringExpression=function(e){var t=new oe(3);return t.value=e,t},t.createNumberExpression=function(e){var t=new oe(2);return t.value=e,t},t.createBooleanExpression=function(e){var t=new oe(4);return t.value=e,t},ae=function(){function e(){}return e.Yh=function(e,t){var n=16777216;return!!(e===t||O(e-t)<O(e)/(n*n))||(e=E.Lma(e,15),t=E.Lma(t,15),O(e-t)<O(e)/(n*n))},e.getArrayValue=function(e,t,n){return e?t<e.getRowCount()&&n<e.getColumnCount()?e.getValue(t,n):n>=e.getColumnCount()&&1===e.getColumnCount()&&t<e.getRowCount()?e.getValue(t,0):t>=e.getRowCount()&&1===e.getColumnCount()&&n<e.getColumnCount()?e.getValue(0,n):Z:Z},e.tryExtractToSingleValue=function(e){var t,n=!0;return(we(e)||Ce(e))&&((t=ne.Ph(e,0,!1,!0)).isError?e=t[0]:1===t.rowCount&&1===t.colCount?e=t[0][0]:(e=t,n=!1)),{value:e,success:n}},e}(),t.Zh=ae,t.charAtFunc=Ae,se=function(){function e(e){this.Di=e}return e.prototype.$j=function(e){var t,n,o,r,i=this.Di;if(C.Ca(i)||(i=[i]),-1===i[0])return!0;for(t=0;t<i.length;t++)if(o=void 0,r=void 0,Se(n=i[t])){if(o=(n=n.split(" "))[0],r=T(n[1]),"!="===o&&e!==r||">"===o&&e>r||">="===o&&e>=r||"%="===o&&e%2===r)return!0}else if(e===n)return!0;return!1},e.prototype._j=function(){return this.Di},e}(),t.iEc=Te,function(e){var n,o,r,i,a,s,l,u,c,f,h,p,d,g,m,y;function v(){var t,n,o=e.bi,r=e.ci,i=[];for(t in o)i.push(o[t]);for(n in r)i.push(r[n]);return i}function b(o,r,i){var a,s,l;if(x(o))throw t.sR().Exp_InvalidFunctionName;if(o=o.toUpperCase(),e.bi[o])throw t.sR().Exp_InvalidOverrideFunction;if(a=e.bi[o]){if(!i||!i.override)throw t.sR().Exp_OverrideNotAllowed}else e.bi[o]=a=new n(o,0,255);return r&&"function"==typeof r&&(a.evaluate=r),"function"==typeof i.argsValidator&&(s=a.gEc,a.gEc=function(e,t,n){s(e,t,n),i.argsValidator(e,t,n)}),"function"==typeof i.subExpressionValidator&&(l=a.hEc,a.hEc=function(e,t){l(e,t),i.subExpressionValidator(e,t)}),C.H(i,(function(e,t){var n;A(e,["acceptsReference","acceptsArray","acceptsError","acceptsMissingArgument","precedentReference"])>=0?(n=new se(t),a[e]=function(e){return n.$j(e)}):A(e,["isVolatile","isBranch","findTestArgument","returnReference","isContextSensitive","expandColumns","expandRows"])>=0?(n=new se(t),a[e]=function(){return n._j()}):i.hasOwnProperty(e)&&(a[e]=t)})),a}function w(e){return e%400==0||e%4==0&&e%100!=0||1900===e}function I(e,t){switch(t){case 0:case 2:case 4:return 360;case 1:return d(e.getFullYear())?366:365;case 3:return 365;default:return-1}}function k(e,t){return e-t}function D(e,t){return A(t,[0,2,4,6,7,9,11])>=0?31:A(t,[3,5,8,10])>=0?30:1===t?d(e)?29:28:void 0}function z(e,t,n,o){var r,i,a=n.getFullYear(),s=n.getMonth(),l=n.getDate(),u=o.getFullYear(),c=o.getMonth(),f=o.getDate();return e?(r=2===s&&g(a,s)===l,i=2===c&&g(u,c)===f,t?(r&&(l=30),i&&(f=30)):r&&i&&(l=30,f=30),31===f&&l>=30&&(f=30)):31===f&&(f=1,t&&c++),31===l&&(l=30),360*(u-a)+30*(c-s)+f-l}function V(e,t,n){var o,r=1;return k(e,t)>0&&(o=e,e=t,t=o,r=-1),A(n,[1,2,3])>=0?r*s(R(t)-R(e)):A(n,[4,5])>=0?r*z(!1,5===n,e,t):r*z(!0,6===n,e,t)}function U(e,n,o,r,i){var a,s,l,u,h,p,d,g,m,y,v,b,C,w,A=o<100,S=2===o||102===o,T=S||3===o||103===o,N=5===o||105===o,I=4===o||104===o||N,R=9===o||109===o,k=1===o||101===o||R||r,E=6===o||106===o,D=E?1:0,j=!1,_=0;for(a=0;a<M(e);a++){if(y=e[a],v=void 0,T?v=c(y,0,!1,!1,!1,S):(b=1,(!t.ExcelCompatibleCalcMode||Ce(y)||we(y))&&(b=5),v=c(y,b,!1,!1,!1,!0)),v.isError)return v[0];if(v.isConvertError)return Z;for(C=v.rangeCount,w=v.isReference,s=0;s<C;s++)for(l=C>1?v[s]:v,w&&(u=y.getRow(s),h=y.getColumn(s)),p=0;p<M(l);p++)if(2===n||!w||!y.isHiddenRow(s,p,A))for(g=l[p],d=0;d<M(g);d++)if(!(1!==n&&2!==n&&w&&y.isSubtotal(s,p+u,d+h)||(m=g[d],null===m||m===G))){if(m&&m._error&&!T)return i&&(i.sumx=0,i.sumx2=0,i.n=0),m;T&&!x(m)&&(!S||""!==m&&ne.Na(m,!0))?D++:I&&(!j||N&&m<D||!N&&m>D)?D=m:k?r?(i.sumx+=m,i.sumx2+=m*m,i.n++,i.values.push(m),i.values[0]!==m&&(i.allSame=!1)):(D+=m,_++):E&&(D*=m,_++),j=!0}}return k?R?D:r?void 0:0===_?Q:f(D/_):E?f(_>0?D:0):D}function q(e,t,n){var o,r,i=n%100,a=7===i||8===i,s=7===i||10===i?1:0,l={sumx:0,sumx2:0,n:0,values:[],allSame:!1},u=U(e,t,n,!0,l);if(u&&u._error)return u;if(l.n<=s)return Q;if(l.allSame)u=0;else if(p(l.n*l.sumx2,l.sumx*l.sumx))for(u=0,o=l.sumx/l.n,r=0;r<l.n;r++)u+=H(l.values[r]-o,2);else u=l.sumx2-l.sumx*l.sumx/l.n;return u/=l.n-s,f(a?Math.sqrt(u):u)}function $(e){var t=e.charCodeAt(0);return t>=0&&t<129||63728===t||t>=65377&&t<65440||t>=63729&&t<63732?"singleByte":t>=55296&&t<=57343?"fourByte":"doubleByte"}function X(e){var t,n=[];for(t=0;t<e.length;t++)x(e[t])?(n[t]=e[t+1],t++):n[t]=e[t];return n.length===e.length-1&&(n[n.length]=_),n}function te(e,t){var n,o;for(void 0===t&&(t=!0),n=[],o=0;o<M(e);o++)ie(e[o],n,t);return n}function oe(e){e.sort((function(e,t){return e-t}))}function ie(e,t,n){var o,r;for(void 0===n&&(n=!0),o=0;o<M(e);o++)(r=e[o])!==G&&t.push(r);n&&oe(t)}function le(){var e,t,n,o=[];for(e=0;e<arguments.length;e++)o[e]=arguments[e];return t=te(arguments[0]),0===(n=M(t))?J:n%2==0?(l(t[n/2-1])+l(t[n/2]))/2:t[T(""+n/2)]}function ue(e,t,n){var o,r=[];return ie(t,r),o=M(r),n<1||o<n?J:(n=e?L(n):B(n),e?r[o-n]:r[n-1])}function he(e,t){var n,o,r;return e=c(e,1,!0,!0,!1,!0),t=l(t),e.isError?e[0]:e.isConvertError||N(t)?Z:(ie(e,n=[]),!M(n)||t<0||t>1?J:(r=(o=t*(M(n)-1))%1,o=T(""+o),0===r?n[o]:l(n[o])+r*(l(n[o+1])-l(n[o]))))}function pe(e,t){var n,o,r,i,a,s,l=M(e),c=[];for(n=0;n<l;n++)u(e[n],!0)&&c.push(e[n]);return c.length?(o=c.length,oe(c),i=(r=t*(o+1)-1)%1,r<0||o-1<r?J:(s=c[a=B(r)],0===i?s:s+i*(c[a+1]-s))):J}function de(e,t){var n=13===t,o=14===t,r=15===t,i=16===t,a=17===t,s=18===t,l=19===t;return 12===t?le(e):n?function(){var e,t,n,o,r,i,a,s,l=[];for(e=0;e<arguments.length;e++)l[e]=arguments[e];for(t=j,n=0,o=te(arguments[0],!1),r=M(o),i=0;i<r;i++){for(s=0,a=0;a<r;a++)a!==i&&o[a]===o[i]&&s++;s>n&&(n=s,t=o[i])}return 0===n?Y:t}(e):o?function(e,t){return ue(!0,e,t)}(e[0],e[1]):r?function(e,t){return ue(!1,e,t)}(e[0],e[1]):i?he(e[0],e[1]):a?function(e,t){var n=A(t,[0,1,2,3,4]);return n<0?J:he(e,.25*n)}(e[0],e[1]):s?pe(e[0],e[1]):l?function(e,t){var n=A(t,[1,2,3]);return n<0?J:pe(e,.25*(n+1))}(e[0],e[1]):K}function ge(e,t,n){var o;return 0===e?o=t<=n:1===e?o=t>=n:2===e?o=t!==n:3===e?o=t<n:4===e?o=t===n:5===e&&(o=t>n),o}function me(e,t){var n,o=-1,r=!0,i={value:0},s=S.zb(t);return 4===e&&s&&(n=function(e){if(""===e)return!1;var t=S.sb(s);return t.lastIndex=0,t.test(e)}),x(t)?o=0:s||function(e){return 0===(""+e).trim().length}(t)||N(parseFloat(t))||!a(t,i)?r=!1:o=i.value,function(i,l){var c,f;return(""!==t||4===e||2===e)&&!(!l&&i instanceof W)&&(x(i)&&(i=""),c={value:0},r&&a(i,c)?""===i?2===e:ge(e,c.value,o):(!s||!u(i,!0))&&(f=x(t)?"":(""+t).toUpperCase(),s&&n?n(""+i):ge(e,(""+i).toUpperCase(),f)))}}!function(e){e[e.normal=0]="normal",e[e.allwaysExpand=1]="allwaysExpand",e[e.neverExpand=2]="neverExpand"}(e.ArrayArgumentEvaluateMode||(e.ArrayArgumentEvaluateMode={})),n=function(){function e(e,t,n,o){void 0===t&&(t=0),void 0===n&&(n=0),this.name=e,this.minArgs=t,this.maxArgs=n;this.$h=o,this.typeName=""}return e.prototype.description=function(){var e=this,n=t.sR()._h;return e.$h?e.$h:n&&n[e.name]},e.prototype.acceptsArray=function(e){return!1},e.prototype.acceptsReference=function(e){return!1},e.prototype.acceptsError=function(e){return!1},e.prototype.acceptsMissingArgument=function(e){return!1},e.prototype.isVolatile=function(){return!1},e.prototype.isContextSensitive=function(){return!1},e.prototype.isBranch=function(){return!1},e.prototype.findTestArgument=function(){return-1},e.prototype.findBranchArgument=function(e){return-1},e.prototype.expandRows=function(){return!0},e.prototype.expandColumns=function(){return!0},e.prototype.precedentReference=function(){return!0},e.prototype.returnReference=function(){return!1},e.prototype.evaluate=function(){var e,t=[];for(e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.evaluateWithContext=function(e,t){var n=this,o=t;return n.isContextSensitive()&&(o=[e].concat(o)),n.evaluate.apply(n,o)},e.prototype.toJSON=function(){var e,t={};for(e in this)this.hasOwnProperty(e)&&(t[e]=this[e]);return t},e.prototype.fromJSON=function(e){if(e)for(var t in e)e[t]!==_&&(this[t]=e[t])},e.prototype.gEc=function(e,n,o){if(o<e||o>n)throw t.sR().Exp_FormulaInvalid},e.prototype.hEc=function(e,t){Te(e)},e.ai=function(t,n,o){var r,i=new e(t,0,255);if(n&&"function"==typeof n&&(i.evaluate=n),o)for(r in o)o.hasOwnProperty(r)&&"override"!==r&&(i[r]=o[r]);return i},e}(),e.Function=n,o=function(e){function t(t,n,o,r){return e.call(this,t,n,o,r)||this}return ce(t,e),t.prototype.isContextSensitive=function(){return!0},t.prototype.evaluate=function(e,t){return this.evaluateAsync.apply(this,arguments)},t.prototype.evaluateAsync=function(e,t){this.evaluate.apply(this,arguments)},t.prototype.defaultValue=function(){return 0},t.prototype.evaluateMode=function(){return 0},t.prototype.evaluateWhenArgumentsIsSame=function(){return!0},t.prototype.interval=function(){return 1e4},t}(n),e.AsyncFunction=o,e.AsyncFunctionEvaluateMode={onRecalculation:0,calculateOnce:1,onInterval:2},e.bi={},e.ci={},e.defineGlobalCustomFunction=function(t,n){return e.ci[fe(t)]=n,n},e.findGlobalFunction=function(n){var o,r,i;return n?(n=fe(n),o=e.bi,r=e.ci,i=t.getMapping()&&t.getMapping().builtInFunctionsMapping,o&&(function(t,n){var o,r=e.bi;if(!x(t))for(o in t)if(t[o].alias===n)return r[o];return _}(i,n)||o[n])||r&&r[n]):v()},e.findGlobalFunctions=function(){return v()},e.removeGlobalFunction=function(t){if(!t)return e.bi={},void(e.ci={});t=fe(t);var n=e.bi,o=e.ci;n[t]?delete n[t]:o[t]&&delete o[t]},r=t.sR().Exp_Format,i=function(){function t(e,t,n){this.Ri=e,this.Si=t,this.kja=n||"i"}return t.prototype.Pi=function(){return this.Ri},t.prototype.Qi=function(){return this.Si},t.prototype.lja=function(){return this.kja},t.prototype.bc=function(t){t=t||"i";var n=this.Ri,o=this.Si,r="",i=e.CALC_PRECISION;return i&&(n=E.Lma(n,i),o=E.Lma(o,i)),0===n&&0!==o||(r+=""+n),-1===o?r+="-":0!==n&&o>0&&(r+="+"),-1!==o&&0!==o&&1!==o&&(r+=""+o),0!==o&&(r+=t),r},t}(),e.Ui=i,e.Wi=function(e){try{return e?"number"==typeof e?new i(e,0):"string"==typeof e?function(e){var n,o,a,s,l=0,u=0,c=!1,f=0,h=0,p=0,d=e.length;if(!e)throw t.sR().Exp_ArgumentNull;if(0===d)throw r;if(p<d&&("+"===Ae(e,p)||"-"===Ae(e,p))&&p++,p=(s=Me(e,p)).mi,n=s.Vi,p<d&&("+"===Ae(e,p)||"-"===Ae(e,p))?(f=p,p=(s=Me(e,++p)).mi,o=s.Vi,p<d&&("i"===Ae(e,p)||"j"===Ae(e,p))&&(a=Ae(e,p),p++,c=!0),h=p-f):p<d&&("i"===Ae(e,p)||"j"===Ae(e,p))?(a=Ae(e,p),h=++p,o=n,c=!0,n=!1):f=p,p<d)throw r;if(f>0){if(!n)throw r;l=parseInt(e.substr(0,f),10)}if(h>0){if(!c)throw r;if(1===h||2===h&&"+"===Ae(e,f))u=1;else if(2===h&&"-"===Ae(e,f))u=-1;else{if(!o)throw r;u=parseInt(e.substr(f,h-1),10)}}return new i(l,u,a)}(e):null:new i(0,0)}catch(e){return null}},a=ne.Th,s=ne.Rh,l=ne.Pa,u=ne.Na,c=ne.Ph,f=ne.Nh,h=ne.vf,p=ae.Yh,e.ak=function(e,t,n,o,r,i,a,s,l){return s||(s={}),n!==_&&(s.minArgs=n),o!==_&&(s.maxArgs=o),i!==_&&(s.acceptsReference=i),a!==_&&(s.acceptsArray=a),r!==_&&(s.Ci=r),s.bk!==_&&(s.acceptsMissingArgument=s.bk),s.ck!==_&&(s.isVolatile=s.ck),s.dk!==_&&(s.isContextSensitive=s.dk),s.ek!==_&&(s.precedentReference=s.ek),s.fk!==_&&(s.arrayArgumentEvaluateMode=s.fk),s.gk!==_&&(s.acceptsError=s.gk),l!==_&&(s.isDynamicArrayFunction=l),b(e,t,s)},e.hk=179769e303,e.ik=function(e){return"boolean"==typeof e},e.jk=Se,e.Na=function(e){return"number"==typeof e},e.kk=w,d=w,e.lk=I,e.mk=k,e.nk=D,g=D,e.pk=V,e.qk=function(e){var t,n,o;return 0===e?n=0:(o=.5*O(e))>=3?n=1:o<1?n=((((((((.000124818987*(t=o*o)-.001075204047)*t+.005198775019)*t-.019198292004)*t+.059054035642)*t-.151968751364)*t+.319152932694)*t-.5319230073)*t+.797884560593)*o*2:n=(((((((((((((-45255659e-12*(o-=2)+.00015252929)*o-19538132e-12)*o-.000676904986)*o+.001390604284)*o-.00079462082)*o-.002034254874)*o+.006549791214)*o-.010557625006)*o+.011630447319)*o-.009279453341)*o+.005353579108)*o-.002141268741)*o+.000535310849)*o+.999936657524,e>0?.5*(n+1):.5*(1-n)},e.Hfc=U,e.sk=q,e.mja=function(e,t,n,o){var r,i,a,u,f,p,d,g,m,y,v,b,C;if(null===n)return Z;if((n=parseInt(n,10))<=0||n>19)return Z;function w(e){var t,o,s,l,p,d,g,m,y,v,b,C=[];if((t=c(e,f?0:5,!1,!1,!1,!1)).isConvertError)return Z;for(v=t.rangeCount,b=t.isReference,o=0;o<v;o++)for(s=v>1?t[o]:t,b&&(l=e.getRow(o),p=e.getColumn(o)),d=0;d<M(s);d++)if(!(b&&e.isHiddenRow(o,d,!1)&&r))for(m=s[d],g=0;g<M(m);g++)if(!(b&&i&&e.isSubtotal(o,d+l,g+p)||(y=m[g],null===y||a&&h(y)||h(y)&&u))){if(!a&&h(y)&&3!==n)return y;"object"==typeof y&&0===Object.keys(y).length||C.push(y)}return C}if(t||(t=0),r=1===t||3===t||5===t||7===t,i=1===t||2===t||3===t||0===t,a=2===t||3===t||6===t||7===t,f=(u=2===n)||3===n,p=12===n,d=13===n,g=14===n||15===n||16===n||17===n||18===n||19===n,m=[],y=M(e),g){if(2!==y)return Z;if((m=w(e[0]))._error)return m;if(v=void 0,e[1]===j)return J;if(e[1]instanceof re)v=function(e){var t,n=e.getRow(0),r=e.getColumn(0),i=e.getRowCount(0),a=e.getColumnCount(0);if(1===i&&1===a)t=e.getValue(0,0,0);else if(1!==i&&1===a&&n<=o.row&&o.row<n+i)t=e.getValue(0,o.row-n,0);else{if(!(1===i&&1!==a&&r<=o.column&&o.column<r+a))return Z;t=e.getValue(0,0,o.column-r)}return t===j||""===t?J:isNaN(parseInt(t,10))?Z:parseFloat(t)}(e[1]);else if(e[1]instanceof ee)v=e[1].array[0][0];else{if(isNaN(parseInt(e[1],10)))return Z;v=l(e[1])}return v._error?v:(17!==n&&19!==n||(v=s(v)),de([m,v],n))}for(b=0;b<y;b++)if(!(e[b]instanceof re))return Z;for(b=0;b<y;b++){if(!((C=w(e[b]))instanceof Array))return C;m.push.apply(m,C)}return p||d?de([m],n):7===n||8===n||10===n||11===n?q(m,i?1:0,n):U(m,1,n)},e.UAb=$,e.WAb=X,e.VAb=function(e){var t,n,o,r=[],i=0,a=0;for(n=0;n<e.length;n++){if(t=e[n],"doubleByte"===(o=$(e[n]))||"fourByte"===o)if("fourByte"===o){if(i%2==0){i++;continue}a++,i++,t=e[n-1]+e[n]}else a++,t=e[n];r[n-(i>0?i/2:0)+a]=t}return X(r)},e.sja=de,e.tk=function(e){var t,n=1;for(t=e;t>1;t--)n*=t;return n},e.uk=function(e,t,n){var o=e.getDate(),r=t.getDate(),i=e.getMonth(),a=t.getMonth(),s=e.getFullYear(),l=t.getFullYear();return o=31===o?30:o,n?r=31===r?30:r:31===r&&(o<30?(r=1,++a>12&&(a=1,l++)):r=30),30*(12*(l-s)+a-i)+r-o},e.vk=function(e,t,n){return n<0||n>4?J:function(e,t,n){var o,r,i,a,u,c,f,h,p=V(e,t,n);return p<0&&(p=-p,r=e,e=t,t=r),1===n?(i=e.getFullYear(),a=t.getFullYear(),u=void 0,c=void 0,f=void 0,h=void 0,(u=new Date(e.valueOf())).setFullYear(u.getFullYear()+1),k(t,u)>0?(h=a+1-i,u=new Date(i,0,1),c=new Date(a+1,0,1),f=s(R(c)-R(u))-365*(a+1-i)):(h=1,f=d(i)&&e.getMonth()<3||d(a)&&256*t.getMonth()+t.getDate()>=541?1:0),o=365+l(f)/l(h)):o=I(new Date,n),p/o}(e,t,n)},m={},y=function(){function t(){}return t.wk=function(e){var t=B(e);return p(e,t+1)?t+1:t},t.xk=function(e){var t,n,o,r,i,a=e,s=m;if(s||(m=s={}),t=s[a])return t;if(u(e))return s[a]=me(4,e);for("=><",n=x(e)?"":(""+e).toUpperCase(),o="\0",r=0;r<2&&r<M(n);r++){if(i=n[r],-1==="=><".indexOf(i)){if("<"===o)return s[a]=t=me(3,n.substring(1)),t;if(">"===o)return s[a]=t=me(5,n.substring(1)),t;break}if("="===i)return t="<"===o?me(0,n.substring(2)):">"===o?me(1,n.substring(2)):me(4,"\0"===o?n.substring(1):e),s[a]=t,t;if("\0"===o)o=i;else{if("<"===o)return t=">"===i?me(2,n.substring(2)):me(3,n.substring(1)),s[a]=t,t;if(">"===o)return s[a]=t=me(5,n.substring(1)),t}}return s[a]=t=me(4,e),t},t.yk=function(e){var t=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16][e];return x(t)?H(10,parseFloat(e)):t},t.zk=function(e){var t=L(e);return p(e,t-1)?t-1:t},t.Ak=function(e,n){var o,r,i=t.yk(O(n)),a=L,s=B;return o=(e=n<0?e/i:e*i).toExponential(),(r=T(o.split("e")[1])+1)<=15&&r>=-85&&(e=parseFloat(e.toFixed(15-r))),e=e<0?a(e-.5):s(e+.5),f(e=n<0?e*i:e/i)},t.Bk=function(e,t){var n,o;if(e<0||t<0||e<t)return J;for(n=1,t=Math.min(e-t,t),o=1;o<=t;o++)n*=e-o+1,n/=o;return f(n)},t.YDc=function(e,t){if(e<0&&O(t)<1){var n=(1/t).toPrecision(15);if(parseFloat(n)===parseInt(n,10)&&parseInt(n,10)%2!=0)return-H(-e,t)}return H(e,t)},t.Ck=function(t,n){var o=O(t)>.5?H(1+t,n):F(n*P(1+t));return isFinite(o)?N(o)&&(o=5e-324):o===Number.POSITIVE_INFINITY?o=e.hk:o===Number.NEGATIVE_INFINITY&&(o=-e.hk),o},t.Dk=function(e,t){return(F(e)+(t?-1:1)*F(-e))/2},t.Ek=function(e,t){return N(e)?e:N(t)?t:1!==t&&1===e||0!==t&&t!==Number.POSITIVE_INFINITY?P(e)/P(t):NaN},t}(),e.MathHelper=y}(le||(le={})),t.Functions=le,t.gOb=function(e,t,n){var r,i,l,u,c,f,h,p,d,g;if(void 0===n&&(n=!0),be(e))return e;if(be(t))return t;if(l=typeof t===s,(i=typeof e===s)||l)r=i&&l?e===t?0:e>t?1:-1:i?1:-1;else{if(c=typeof t===a,h=(f=(u=typeof e===a)||c)?"":0,e=e===j||e===_?h:e,t=t===j||t===_?h:t,p=function(){var r,i;if(e===t)return 0;if(u&&c){r=void 0;try{r=(i=o.Common.CultureManager.getCultureInfo()).localeCompare?n?i.localeCompare(e,t):i.localeCompare(e.toUpperCase(),t.toUpperCase()):n?e.localeCompare(t):e.toUpperCase().localeCompare(t.toUpperCase())}catch(o){r=n?e.localeCompare(t):e.toUpperCase().localeCompare(t.toUpperCase())}return r}return u?1:c?-1:ae.Yh(e,t)?0:e-t},!f){if(g={value:0},!pe(e,d={value:0})||!pe(t,g))return Z;e=d.value,t=g.value}r=p()}return r},ue=function(e){function t(t){var n=e.call(this,j)||this;return n.u4=t,n}return ce(t,e),t.prototype.startCalculation=function(){},t.prototype.endCalculation=function(){},t.prototype.getValue=function(){return U.Reference},t.prototype.getReference=function(){var e=new re(this,[Ne(0,0)]);return e.getValue=function(){return U.Reference},e},t.prototype.referenceToArray=function(){var e=[U.Reference];return e.isError=!0,e},t.prototype.getName=function(){return this.u4},t.prototype.setValue=function(){},t}(ie),t.ErrorSource=ue},"./src/calc.entry.ts":function(e,t,n){"use strict";var o,r;function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n("./src/calc.common.ts")),i(n("./src/Parser.ts")),i(n("./src/evaluator.ts")),i(n("./src/calc.ts")),i(n("./src/referenceExpression.ts")),o=n("./src/calc.ts"),Object.defineProperty(t,"supportRowColumnFormula",{set:function(e){o.supportRowColumnFormula=e},get:function(){return o.supportRowColumnFormula}}),Object.defineProperty(t,"approximatelyEqual",{set:function(e){o.approximatelyEqual=e},get:function(){return o.approximatelyEqual}}),r=n("./src/calc.common.ts"),Object.defineProperty(t,"ExcelCompatibleCalcMode",{set:function(e){r.ExcelCompatibleCalcMode=e},get:function(){return r.ExcelCompatibleCalcMode}})},"./src/calc.ts":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function L(e,t){var n,o,r,i,a,s;if(e)for(n in e)if(o=+n,r=e[n])for(i in r)a=+i,(s=r[i])&&t.setValue(o,a,s.value,s.oldValue,!0!==s.isAnchorCell)}function z(e,t){var n=t.split(",").map((function(e){return+e})),o=n[0],r=n[1],i=e[o];return i&&i[r]}function V(e,t,n){if(e){var o=n.anchors,r={};e.forEach((function(e){var i,a,s,l,u,c,f,h,p=e.row,d=e.col,g=function(e,t){return[e,t].join(",")}(p,d);for(t.Ag(p,d,1,1),r[g]=!0,i=e.rowCount,a=e.colCount,s=1,l=0;l<i;l++){for(;s<a;s++)if(u=n.getAnchorItem(l+p,s+d))for(f in c=u.anchorRefs)g!==f&&c[f]&&((h=z(o,f))&&!r[f]&&(t.Ag(h.row,h.col,1,1),r[f]=!0));s=0}}))}}function G(e,t,n,o,r){var i,a,s,l,u;for(i in t)t.hasOwnProperty(i)&&(s=((a=t[i]).source||e).getCalcSourceModel(),u=(l=e.getCalcSourceModel())&&l.qg(n,o),s&&u&&a&&s.Ig(u,n,o,a,a,r))}function W(e,t,n,o){var r,i,a,s,l,u,c,f,h,p,d,g;for(r in n)if(n.hasOwnProperty(r))if(i=n[r],a=e.jh[i.id],s=i.row,l=i.col,f=s+(u=i.rowCount)-1,h=l+(c=i.colCount)-1,K(s,l,u,c))a.ug(!0).Jg(s,l,u,c,t,o);else for(p=s;p<=f;p++)for(d=l;d<=h;d++)(g=a.qg(p,d,!0))&&g.gmb(0,t,o)}function U(e,t){var n,o,r;for(n in e)(o=e[n])&&(t?U(o):(r=o.calc)&&r.ng())}function Z(e){var t,n;for(t=0;t<e.length;t++)if((n=e[t].expr)&&7===n.type&&"LET"===n.functionName)return!0;return!1}function q(e,t,n,o,l,u,c){var f,d,b,C,w,x,A,M,S,T,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,q,Y,K,$,X,ee,te,ne,oe,re,ie,ae,se,le,ue,ce,fe,he,pe,de,ge,me,ye=e.row,ve=e.column,be=[],Ce=0,we=e.arrayIdentity?e.arrayIdentity.row:ye,xe=e.arrayIdentity?e.arrayIdentity.col:ve;for(be[Ce]={expr:t,acceptsArray:u||!1,acceptsRef:c||!1,index:-1},f=0,d=0,b=!1,w=o,x=l,A=!1;Ce>=0;){if(M=be[Ce],Ce--,S=M.acceptsArray,T=M.acceptsRef,t=M.expr,I=h,t)if(7===t.type){if(B=(H=(P=t).arguments).length,!P.function){if(!e){I=r.Hh(g);continue}if("ANCHORARRAY"===(L=P.functionName)){1===B&&(V=(z=H[0]).source,G=e.source,1===z.type&&z.sf()?I=i.BLb(G,V,p,z.row,z.column,z.rowRelative,z.columnRelative):5===z.type&&(I=i.lOb(G,V))),I?e.iOb=2:I=r.Hh(g),P.ensureSingle&&(I.ensureSingle=!0),R=I;continue}P.function=e.getFunction(L)}if(W=P.function,U=M.index,F=M.neeedExpendindexs,U<0?(M.arrayArgumentEvaluateMode=A,M.arrayFormulaCatchValue=n,W&&W.arrayArgumentEvaluateMode&&(A=W.arrayArgumentEvaluateMode),M.args=[]):(W&&W.acceptsArray&&W.acceptsArray(U)?f--:b&&(F||(F=[],M.neeedExpendindexs=F),P.arguments[U],F.push(U)),M.args.push(R)),U===B-1){if(A=M.arrayArgumentEvaluateMode,n=M.arrayFormulaCatchValue,Y=!1,(q=M.args)&&q.length>0)for(K=0;K<q.length;K++)if(q[K]!==P.arguments[K]){Y=!0;break}I=Y?r.Jh(P,q):t,F&&F.length>0&&(I=r.createExpandExpression(I,F),b=!0)}else 0===U&&W&&3===W.arrayArgumentEvaluateMode&&3===A&&(A=0),b=!1,U++,M.index=U,W&&W.acceptsArray&&W.acceptsArray(U)&&f++,be[++Ce]=M,be[++Ce]={expr:P.arguments[U],acceptsArray:!!W&&W.acceptsArray&&W.acceptsArray(U),acceptsRef:!!W&&W.acceptsReference&&W.acceptsReference(U),index:-1}}else if(1===t.type&&t.sf())d&&(D=(E=t.source!==r.BangSource&&t.source||e.source).getRowCount(),j=E.getColumnCount(),_=(_=t.rowRelative?(t.row+we)%r.MAX_ROW_COUNT%D:t.row)<0?_+D:_,O=(O=t.columnRelative?(t.column+xe)%r.MAX_COLUMN_COUNT%j:t.column)<0?O+j:O,t=i.rf(t.source&&E,h,_,O,!1,!1));else if(1===t.type||13===t.type){if(13===t.type){if(k=($=t).getRange(ye,ve),$.tzb(ye,ve,e.source.id),!k){$._error?(delete $._error,I=R=m,e.iOb=1):(I=t,R=t);continue}t=i.uf($.source===e.source?h:$.source,h,k.row,k.col,k.row+k.rowCount-1,k.col+k.colCount-1)}X=t.source!==r.BangSource&&t.source,te=(ee=t).ensureSingle,d&&(E=X||e.source,D=r.MAX_ROW_COUNT,j=r.MAX_COLUMN_COUNT,ne=ee.rowRelative?(ee.row+we)%D:ee.row,oe=ee.columnRelative?(ee.column+xe)%j:ee.column,ae=void 0,(ne=ne<0?ne+D:ne)>(re=(re=ee.endRowRelative?(ee.endRow+we)%D:ee.endRow)<0?re+D:re)&&(ae=ne,ne=re,re=ae),(oe=oe<0?oe+j:oe)>(ie=(ie=ee.endColumnRelative?(ee.endColumn+xe)%j:ee.endColumn)<0?ie+j:ie)&&(ae=oe,oe=ie,ie=ae),ne>=(D=E.getRowCount())?(ne%=D,re%=D):re>=D&&(re=D-1),oe>=(j=E.getColumnCount())?(oe%=j,ie%=j):ie>=j&&(ie=j-1),t.row===r.BAND_INDEX_CONST&&(ne=re=r.BAND_INDEX_CONST),t.column===r.BAND_INDEX_CONST&&(oe=ie=r.BAND_INDEX_CONST),t=i.uf(X,t.endSource,ne,oe,re,ie,!1,!1,!1,!1),te&&(t.ensureSingle=!0)),c||T&&(S||!n&&1!==A&&3!==A)||ye<0||ve<0||(f>0&&!n&&1!==A&&3!==A||0===f||2===A?(k=ee.getRange(ye,ve),n||(T||S)&&1===A?!ee.isFullColumn&&1!==k.rowCount&&w>=k.rowCount||!ee.isFullRow&&1!==k.colCount&&x>=k.colCount?I=r.Hh(v):(_=(ee.isFullColumn?0:k.row)+(1===k.rowCount?0:w),O=(ee.isFullRow?0:k.col)+(1===k.colCount?0:x),I=i.rf(X,t.endSource,_,O,!1,!1)):k.rowCount>1&&k.colCount>1||k.rowCount>1&&!ee.isFullColumn&&(ye<k.row||ye>=k.row+k.rowCount)||k.colCount>1&&!ee.isFullRow&&(ve<k.col||ve>=k.col+k.colCount)?I=r.Hh(y):(_=ee.isFullColumn||k.rowCount>1?ye:k.row,O=ee.isFullRow||k.colCount>1?ve:k.col,I=i.rf(X,t.endSource,_,O,!1,!1))):b=!0)}else if(9===t.type)se=t.operatorType>=15,le=T&&e.source&&e.source._service&&e.source._service.allowDynamicArray,-1===M.index?(M.index=t.value2?0:1,be[++Ce]=M,be[++Ce]=J(t.value,se||S,se||le,-1)):0===M.index?(R!==t.value&&(I=r.Kh(t.operatorType,R,t.value2),M.expr=I),b&&((F=[]).push(0),M.neeedExpendindexs=F,b=!1),M.index=1,be[++Ce]=M,be[++Ce]=J(t.value2,se||S,se||le,-1)):(I=t.value2&&R!==t.value2?r.Kh(t.operatorType,t.value,R):t,F=M.neeedExpendindexs,b&&(F?F.push(1):F=[t.value2&&t.value2===C?1:0]),F&&(I=r.createExpandExpression(I,F),b=!0));else if(10===t.type)-1===M.index?(M.index=0,be[++Ce]=M,be[++Ce]=J(t.value,S,T,-1)):t.value!==R&&(I=r.Lh(R));else if(8===t.type)1===M.index?(d--,I=R,M.context&&(e=M.context)):(d++,be[++Ce]=J(t,S,T,1,e),ue=void 0,ce=e,fe=void 0,Z(be)?(ue=new r.Expression(100)).value=t.value:(t.source?(fe=t.source===r.BangSource?e.source:t.source,(ce=new s.EvaluateContext(fe)).cloneFrom(e),ue=fe.getCustomName(t.value)):(ue=e.getName(t.value),e.source.getCustomName(t.value)||(ce=new s.GloableEvaluateContext(e.source)).cloneFrom(e)),ue||(ue=r.Hh(g))),e=ce||e,be[++Ce]=J(ue,S,T,-1,e));else if(6===t.type)if(he=t,pe=t.value,!S&&(f>0||n||1===A||3===A))b=!0,C=t;else if(!S&&0===f)if(de=pe.getRowCount(),ge=pe.getColumnCount(),w>=de&&de>1||x>=ge&&ge>1)I=r.Hh(v);else if(n||!(e.source&&e.source._service&&e.source._service.allowDynamicArray))try{1===de&&(w=0),1===ge&&(x=0),"string"==typeof(me=he.value.getValue(w,x))?I=r.createStringExpression(me):typeof me===N?I=r.createNumberExpression(me):"boolean"==typeof me?I=r.createBooleanExpression(me):me._error?I=r.Hh(me):I=(new a.Parser).parse(e.source.getParserContext(e.useR1C1,Q(0,0)),""+me)}catch(e){I=r.Hh(v)}I===h&&(I=t),R=I}return I}function J(e,t,n,o,r){return{expr:e,acceptsArray:t,acceptsRef:n,index:o,context:r}}function Q(e,t){return{row:e,col:t}}function Y(e,t,n,o){return{row:e,col:t,rowCount:n,colCount:o}}function K(e,t,n,o){return-1===e&&o>127||-1===t&&n>127||n*o>127}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Common"),r=n("./src/calc.common.ts"),i=n("./src/referenceExpression.ts"),a=n("./src/Parser.ts"),s=n("./src/evaluator.ts"),l=o.Common.A,u=o.Common.B,c=o.Common.u,f=o.Common.l,h=null,p=void 0,d=Math.abs,g=r.Errors.Name,m=r.Errors.Reference,y=r.Errors.Value,v=r.Errors.NotAvailable,b=r.Errors.Calc,C=r.Convert.Ca,w=r.Convert._isReference,x=c.Nb,A=o.Common.j,M=A.Fa,S=Math.min,T="rowSliceListeners",N="number",t.approximatelyEqual=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=0),e===t||e instanceof r.CalcError&&t instanceof r.CalcError&&e._code===t._code||d(t-e)<n},t.supportRowColumnFormula=!1,I=function(){function e(e){this.Ze=[],this.ah=e}return e.prototype.getKey=function(){return""},e.prototype.hasListeners=function(){var e,t,n,o;for(e=0,t=this.Ze;e<t.length;e++)if(n=this[t[e]])for(o in n)if(n[o])return!0;return!1},e.prototype.gmb=function(e,t,n){var o,r=this[e],i=t.getKey();t.LDc&&t.LDc.length>=1&&((o=t.LDc)[o.length-1].push(this),i="?"+i),r||(this.Ze.push(e),r=this[e]={}),n?r[i]=t:delete r[i]},e.prototype.Yg=function(){var e,t,n,o,r,i,a=[];for(e=0;e<arguments.length;e++)a[e]=arguments[e];for(t=this.Ze,o=0;o<t.length;o++)if(r=this[t[o]])for(i in r)(n=r[i])&&n.bh()},e.prototype.Bg=function(){var e,t,n,o,r,i,a=[];for(e=0;e<arguments.length;e++)a[e]=arguments[e];for(t=this.Ze,o=0;o<t.length;o++)if(r=this[t[o]])for(i in r)!(n=r[i])||n.dh||n.eh||n.fh()},e.prototype.gh=function(){var e,t,n,o,r,i,a,s,l=[];for(e=0;e<arguments.length;e++)l[e]=arguments[e];for(t=l[0],n=this.Ze,o=t?1:-1,r=0;r<n.length;r++)if(i=this[n[r]])for(a in i)if(s=i[a],"?"===a[0]){if(t||!this.MDc)continue;for(;this.MDc.indexOf(s)>=0;)this.MDc.splice(this.MDc.indexOf(s),1),s.delay--}else s&&(s.delay+=o,t&&s.y$a&&s.y$a())},e.prototype.bh=function(){},e.prototype.fh=function(){},e.prototype.ng=function(){},e.prototype.og=function(){},e.prototype.ZAb=function(){return this.ah.Cf()},e}(),t.BaseCalc=I,R=function(e){function t(t,n){var o=e.call(this,t)||this;return o.name=n,o.delay=0,o}return B(t,e),t.prototype.getKey=function(){var e=this.ah;return(null===e?"":e._source.id+",")+this.name},t.prototype.og=function(){this.ah.Og(this.name,!0)},t.prototype.ng=function(){this.ah.Og(this.name,!1)},t.prototype.bh=function(){this.ZAb().onAddAdjust(this,3)},t.prototype.fh=function(){this.$l=!0,this.ZAb().pg(this,3)},t}(I),t.NameIDCalc=R,k=function(e){function t(t,n,o){var r=e.call(this,t)||this;return r.id=n,r.name=o,r.delay=0,r}return B(t,e),t.prototype.getKey=function(){var e=this;return e.ah.getName()+","+e.id+"#"+e.name},t.prototype.og=function(){var e=this;e.ah.Ig(e.id,e.name,!0)},t.prototype.ng=function(){var e=this;e.ah.Ig(e.id,e.name,!1)},t.prototype.ZAb=function(){return this.ah._service},t.prototype.bh=function(){this.ZAb().onAddAdjust(this,6)},t.prototype.fh=function(){this.$l=!0,this.ZAb().pg(this,6)},t}(I),t.PathCalc=k,E=function(){function e(){this.autoCalculation=!0,this.jh={},this.useR1C1=!1,this.allowDynamicArray=!1,this.iterativeCalculation=!0,this.iterativeCalculationMaximumIterations=1e3,this.iterativeCalculationMaximumChange=.01,this.mh=0,this.Bka=0,this.hmb=[];var e=this;e.kh=new a.Parser,e.lh=new s.Evaluator(e),e.nh=e.uzb&&e.uzb(),e.addResolver(new a.DefaultTokenResolver)}return e.prototype.getResolvers=function(){return this.hmb},e.prototype.addResolver=function(e){var t,n=this.hmb;for(t=0;;t++)if(!n[t]||e.priority>n[t].priority){n.splice(t,0,e);break}},e.prototype.dispose=function(){this.jh={},this.oh=h},e.prototype.cloneFrom=function(e){var t=this;t.useR1C1=e.useR1C1,t.mh=e.mh,t.qh=e.qh,t.calcOnDemand=e.calcOnDemand},e.prototype.ih=function(){return this.nh},e.prototype.getExternalSource=function(e,t){var n,o,r=this.getAllSourceModels();for(n=0,o=r.length;n<o;n++)if(c.Mb(r[n].getSource().getName(),t))return r[n].getSource();return h},e.prototype.getSourceModel=function(e){var t=this.jh[e.id];return t||(t=e.createSourceModel?e.createSourceModel(this):this.createSourceModel(this,e),this.jh[e.id]=t,e.setCalcSourceModel(t),e.setCalcService(this)),t},e.prototype.getGlobalSourceModel=function(e){return this.oh||((e=e||new r.CalcSource).createSourceModel?this.oh=e.createSourceModel(this):this.oh=this.createSourceModel(this,e),e.setCalcSourceModel(this.oh)),this.oh},e.prototype.setSourceModel=function(e,t){this.jh[e.id]=t,t.setCalcService(this)},e.prototype.getAllSourceModels=function(){var e,t=[],n=this.jh;for(e in n)t.push(n[e]);return t},e.prototype.removeSource=function(e){var t,n,o,r;for(n in this.suspend(),this.jh[e.id]&&(this.onRemoveSource(e),delete this.jh[e.id]),this.clearDirties(),t=this.jh)t[n].addDirtyNodesForCalc(!0);o=this._parserContext&&this._parserContext.kj,r=e&&e.kj,o&&r&&r===o&&(this._parserContext=null),this.resume(!1)},e.prototype.clearSource=function(){this.jh={},this._parserContext=null,this.clearDirties()},e.prototype.ignoreDirty=function(){return this.qh},e.prototype.suspend=function(e){this.mh++,this.qh=!!e},e.prototype.resume=function(e){var t=this;t.mh--,t.mh<0&&(t.mh=0),t.IsSuspended()||(t.rh=h,t.qh=!1,t.recalculateAll(e))},e.prototype.suspendAdjust=function(){this.Bka++},e.prototype.resumeAdjust=function(){var e=this;e.Bka--,e.Bka<0&&(e.Bka=0)},e.prototype.isAdjustSuspended=function(){return this.Bka>0},e.prototype.clearDirties=function(){var e,t,n,o=this,r=o.imb;if(r)for(e in r)if(r.hasOwnProperty(e))for(t=r[e];t;)(n=t.eh)?(t.$l=!1,t.eh=n.dh=p,t=n):t=h;o.imb=o.jmb=h},e.prototype.resumeWithoutCalc=function(){this.mh=0,this.clearDirties(),this.qh=!1},e.prototype.IsSuspended=function(){return this.mh>0},e.prototype.recalculateAll=function(e,t){var n,o,r,i=this;if(!i.IsSuspended()){for(r in i.CIb=Date.now(),t||i.lh.startCache(),o=i.jh)(n=o[r]).getSource().startCalculation(),n.addDirtyNodesForCalc(e,t);for(r in i.Gg(),o)(n=o[r]).getSource().endCalculation();t||i.lh.endCache(),delete i.CIb}},e.prototype.Gg=function(e){var t,n,o,r,i,a,s;if(void 0===e&&(e=!0),n=(t=this).imb){if(e){for(o in i=n[1]||n[2],n)n.hasOwnProperty(o)&&(a=parseInt(o),i&&1!==a&&2!==a||(r=n[o])&&(r.ah.addListenersToDirty(t,a),r.processed=!0));for(o in n)n.hasOwnProperty(o)&&((r=n[o])&&(r.processed?delete r.processed:r.ah.addListenersToDirty(t,parseInt(o))))}for(o in n)n.hasOwnProperty(o)&&n[o].ah.initDelay(t,parseInt(o));for(o in n)n.hasOwnProperty(o)&&n[o].ah.adjustDelayOfListeners(t,parseInt(o),!0);do{for(o in s=!1,n)n.hasOwnProperty(o)&&(n[o].ah.calculateDirtyNodes(t,parseInt(o))&&(s=!0))}while(s);for(o in n)n.hasOwnProperty(o)&&n[o].ah.calculateIterations(t,parseInt(o));t.imb=t.jmb=p}},e.prototype.initParserContext=function(e){this._parserContext||(this._parserContext=e.getParserContext(this.useR1C1))},e.prototype.getParserContext=function(e){var t=this,n=t._parserContext;return n||(e?t._parserContext=n=e.getParserContext(t.useR1C1):n=new a.ParserContext(h,t.useR1C1)),n.setSource(e),n},e.prototype.parseWithContext=function(e,t){return this.kh.parse(e,t)},e.prototype.unparseWithContext=function(e,t){return this.kh.unparse(e,t)},e.prototype.pg=function(e,t){var n,o,r,i,a=this;isNaN(t)||(r=a.imb,i=a.jmb,r||(r=a.imb={},i=a.jmb={}),n=r[t],o=i[t],e&&!e.dh&&e!==n&&(n?o.eh=e:r[t]=e,e.dh=o,e.eh=h,i[t]=e))},e.prototype.Bh=function(e,t){var n,o,r,i,a,s=this;isNaN(t)||(o=s.imb,r=s.jmb,o&&(n=s.imb[t]),e&&(e.dh||e===n)&&(i=e.dh,a=e.eh,i?i.eh=a:o&&(a?o[t]=a:delete o[t]),a?a.dh=i:r&&(i?r[t]=i:delete r[t]),e.dh=h,e.eh=h))},e.prototype.evaluateExpression=function(e,t,n){return this.lh.evaluateExpression(t,e.getEvaluatorContext(n,!1),!1)},e.prototype.onClearExpr=function(e,t){this.lh&&this.lh.asyncManager.clearCell(e,t)},e.prototype.parse=function(e,t,n,o,r,i,a){var s,l,u=this,c=u.rh,f=u.getParserContext(e);return f.useR1C1=!a&&u.useR1C1,f.ignoreError=i,f.row=n,f.column=o,f.culture=r,c?(s=c[t])?s:(l=u.kh.parse(f,t),c[t]=l,l):u.kh.parse(f,t)},e.prototype.unparse=function(e,t,n,o,r,i,a){var s,l=this.getParserContext(e);return l.useR1C1=this.useR1C1,l.row=n,l.column=o,l.culture=r,l.addSheetName=a,i&&(l.Eh=!0,l.useR1C1=!1),s=this.kh.unparse(l,t),l.Eh=!1,s},e.prototype.recalculate=function(e,t,n,o){var r=this.getSourceModel(e);-1===n?r.Ag(t,0,1,r.cC()):-1===t?r.Ag(0,n,r.rC(),1):r.Ag(t,n,1,1),this.IsSuspended()||this.recalculateAll(!1,o)},e.prototype.recalculateByName=function(e,t){var n;t&&(n=function(e,t){return e.getSourceModel(t)}(this,e).mg(x(t),!0),this.pg(n,3),this.IsSuspended()||this.recalculateAll(!1))},e.prototype.recalcRange=function(e,t,n,o,r){var i=this.getSourceModel(e);-1===n?i.Ag(t,0,o,i.cC()):-1===t?i.Ag(0,n,i.rC(),r):i.Ag(t,n,o,r),this.IsSuspended()||this.recalculateAll(!1)},e.prototype.evaluate=function(e,t,n,o,i){var a=t instanceof r.Expression?t:this.parse(e,t,n,o);return this.lh.evaluateExpression(a,e.getEvaluatorContext(Q(n,o),!1),!1,i,i)},e.prototype._evaluateParsedFormula=function(e,t,n,o,i,a,s,l){var u,c,f,d,g,m,b,C,w,x,A,M=n.row||0,S=n.col||0,T=a?a.row:M,N=a?a.col:S,I=e.getEvaluatorContext(n,o,a);if(I.NDc=l,c=4===arguments.length&&o||s,this.allowDynamicArray&&!o&&(I.Exb=!0),(u=this.lh.evaluateExpression(t,I,i,c,c))&&u.pause)return u;if(e.ODc){for(f=0;f<e.ODc.length;f++)delete e.ODc[f].PDc;delete e.ODc}if(o&&arguments.length<=5)return u;if(!o&&s&&(r.Convert._isReference(u)||r.Convert.Ca(u)))return u;if(r.Convert._isReference(u)){if(d=u.getRowCount(0),g=u.getColumnCount(0),1!==u.getRangeCount())return y;try{if(m=o?M-T:M-u.getRow(0),b=o?S-N:S-u.getColumn(0),C=Q(0,0),1===d&&1===g);else if(1===d&&g>1&&b>=0&&b<g)C.col=b;else if(d>1&&1===g&&m>=0&&m<d)C.row=m;else{if(!(o&&m<d&&b<g))return o?v:y;C.row=m,C.col=b}u=u.getValue(C,0)}catch(e){return y}}else if(r.Convert.Ca(u))if(o){if(x=(w=u).getRowCount(),A=w.getColumnCount(),1!==x&&M-T>=x||1!==A&&S-N>=A)return v;u=u.getValue(1===x?0:M-T,1===A?0:S-N)}else u=u.getValueByIndex(0);return u===p||u===h?!1===i?u:0:u},e.prototype.onAddAdjust=function(e,t){this.nh.hh(e,t)},e.prototype.onRemoveSource=function(e){this.nh.ph(e)},e.prototype.createSourceModel=function(e,t){return new j(e,t)},e.prototype.NHb=function(){var e,t,n=this.jh;for(e in n)(t=n[e])instanceof j&&t.getAllNodes().forEach((function(e){var t=e.calc;t&&(t.$l=!1,(t.eh||t.dh)&&(t.dh=t.eh=h))}))},e}(),t.CalcService=E,t.setSpillValues=L,t.markAnchorCellDirty=V,D=function(){function e(){}return e.getLength=function(e,t){return C(e)?e.getRowCount()*e.getColumnCount():w(e)?(t=t||0,e.getRowCount(t)*e.getColumnCount(t)):void 0},e.getRowCount=function(e,t){return C(e)?e.getRowCount():w(e)?(t=t||0,e.getRowCount(t)):void 0},e.getColumnCount=function(e,t){return C(e)?e.getColumnCount():w(e)?(t=t||0,e.getColumnCount(t)):void 0},e.getValueByIndex=function(e,t,n){if(C(e))return e.getValueByIndex(t);if(w(e)){n=n||0;var o=e.getColumnCount(n);return e.getValue(n,parseInt(""+t/o,10),t%o)}},e.getValue=function(e,t,n,o){return C(e)?e.getValue(t,n):w(e)?(o=o||0,e.getValue(o,t,n)):void 0},e}(),t.CalcArrayHelper=D,j=function(){function e(e,t){this.Ef=0,this.Ff=0,this.Gf=[],this.qhc=[],this.dataTable={},this.dataTableByName={},this.Hf=[],this.If=[],this.B5=0;this._source=t,this._service=e}return e.prototype.getNode=function(e,t,n){var o,r=this,i=h;return e>=0&&t>=0?(o=r.dataTable[e],n&&!o&&(o=r.dataTable[e]={},e>r.Ef&&(r.Ef=e)),o&&(i=o[t],n&&!i&&(i=o[t]={},t>r.Ff&&(r.Ff=t)))):-1===e&&t>=0?(i=r.If[t],n&&!i&&(i=r.If[t]={},t>r.Ff&&(r.Ff=t))):e>=0&&-1===t?(i=r.Hf[e],n&&!i&&(i=r.Hf[e]={},t>r.Ff&&(r.Ff=t))):-1===e&&-1===t&&(i=r.Jf,n&&!i&&(i=r.Jf={})),i},e.prototype.getNodeByName=function(e,t){var n=this.dataTableByName[e];return t&&!n&&(n=this.dataTableByName[e]={}),n},e.prototype.Kf=function(e,t){var n=this.getNode(e,t);return n&&n.Lf},e.prototype.Mf=function(e,t){var n=this.getNode(e,t);return n&&n.Nf},e.prototype.Qf=function(e,t){return this.getWorkingNodeInfo(e,t,2)},e.prototype._getWorkingExpressionWithRowColumn=function(e,t){return this.getWorkingNodeInfo(e,t,1)},e.prototype._getExpressionWithRowColumn=function(e,t){return this.getWorkingNodeInfo(e,t,0)},e.prototype.CTa=function(e){var t=this.getNodeByName(e);return t&&t.Nf},e.prototype.DTa=function(e){var t=this.getNodeByName(e);return t&&t.Lf},e.prototype.clearAll=function(){var e=this;e.clear(-1,-1,-1,-1),e.dataTable={},e.dataTableByName={},e.Hf=[],e.If=[],e.Jf=h},e.prototype.clear=function(e,t,n,o,r){this.$b(e,t,n,o,r)},e.prototype.rzb=function(){var e=this;U(e.Hf),U(e.If),U(e.dataTable,!0),U(e.dataTableByName),e.eHb()},e.prototype.eHb=function(){var e=this;e.dataTable={},e.dataTableByName={},e.Hf=[],e.If=[],e.Jf=h,e.Gf=[],e.vg=h,e.xg=h},e.prototype.addRows=function(e,t){var n,o=this,r=o.rC();if(!(e<0||e>r||t<0))for(l(o.dataTable,r,e,t),l(o.Hf,r,e,t),n=0;n<t;n++)o.dataTable[e+n]&&(o.dataTable[e+n]={rs:"n"})},e.prototype.deleteRows=function(e,t){var n=this,o=n.rC();e<0||e>=o||t<=0||(e+t>o&&(t=o-e),u(n.dataTable,o,e,t),u(n.Hf,o,e,t))},e.prototype.addColumns=function(e,t){var n,o,r=this,i=r.rC(),a=r.cC();if(!(e<0||e>a||t<0)){for(n=0;n<i;n++)(o=r.dataTable[n])&&e<a&&l(o,a,e,t);l(this.If,a,e,t)}},e.prototype.deleteColumns=function(e,t){var n,o,r=this.rC(),i=this.cC();if(!(e<0||e>=i||t<0)){for(n=0;n<r;n++)(o=this.dataTable[n])&&u(o,i,e,t);u(this.If,i,e,t)}},e.prototype.ETa=function(e,t){var n=[e,t],o=this.getNode(e,t);return o&&n.push(o.Lf,o.Nf,o.Pf),n},e.prototype.FTa=function(e,t,n){e&&e.push(this.ETa(t,n))},e.prototype.dUa=function(){var e=this.getSource(),t=e&&e.getSheet(),n=t&&t._modelManager;return n&&n.dUa()},e.prototype.$Va=function(e,t,n,o,r){var i=this;-1===e?i.kg(t,n,o):-1===t?i.jg(e,n,o):i.ig(e,t,n,o,r)},e.prototype.Rf=function(e,t,n,o){var r=this.getNode(e,t,!!n);r&&(o&&o.push([e,t,r.Lf]),r.Lf=n)},e.prototype.GTa=function(e,t,n,o,r,i,a){var s=this.getNode(e,t,!!n);s&&(this.FTa(a,e,t),s.Lf=n,(s.Nf||o)&&(s.Nf=o),(s.Pf||r)&&(s.Pf=r),s.isVolatile&&!n?this.Tf(s):(i||s.isVolatile)&&(s.isVolatile=i))},e.prototype.Sf=function(e,t,n){this.GTa(e,t,p,p,p,!1,n)},e.prototype.Uf=function(e,t,n,o,r,i){var a=this.getNode(t,n);a&&a.Lf&&e.GTa(o,r,a.Lf,a.Nf,a.Pf,a.isVolatile,i)},e.prototype.ega=function(e,t){var n=this.dataTable[e];return n&&n[t]},e.prototype.Wf=function(e,t,n){var o=this.getNode(e,t,!!n);o&&(o.Nf=n)},e.prototype.Xf=function(e,t,n){var o=this.getNode(e,t,!!n);o&&(o.Pf=n)},e.prototype.Yf=function(e,t){var n=this.getNode(e,t);return n&&n.calc},e.prototype.Zf=function(e,t,n){var o=this.getNode(e,t,!0);o&&(o.calc&&o.calc.isVolatile&&this.Tf(o),o.calc=n,n&&(n.node=o))},e.prototype.Q3=function(e,t,n){var o=this.getNode(e,t,!0);o&&o.calc&&(o.calc.isVolatile&&this.Tf(o),this._service.Bh(o.calc,n),o.calc=p)},e.prototype.$f=function(e,t,n,o,r){var i,a=this;n>=0&&o>=0?((i=a.dataTable[n])||(i=a.dataTable[n]={}),i[o]=r,r&&r.calc&&delete r.calc):n>=0&&-1===o&&e>=0&&-1===t?a.Hf[n]=r:o>=0&&-1===n&&t>=0&&-1===e&&(a.If[o]=r)},e.prototype._f=function(e,t,n,o){var r=this,i=r.getNode(e,t),a=r.getNode(n,o);i&&i.Lf?r.$f(e,t,n,o,i):a&&a.Lf&&r.$f(e,t,n,o,h),a&&a.Lf?r.$f(n,o,e,t,a):i&&i.Lf&&r.$f(n,o,e,t,h)},e.prototype.rhc=function(e,t,n){e.isIterativeCalc||(e.isIterativeCalc=!0,this.qhc.push(e),t||function(e,t){var n,o,r,i=e.ah&&e.ah.getSource();i&&(n=e.row,o=e.column,r=i.getValue(n,o),i.setValue(n,o,t,r))}(e,n))},e.prototype.shc=function(e){delete e.isIterativeCalc},e.prototype.thc=function(){var e,t=this,n=[],o=t.qhc,r=t.qhc.length;for(e=0;e<r;e++)o[e].isIterativeCalc&&n.push(o[e]);return t.qhc=n,t.qhc},e.prototype.lmb=function(){return this.Gf},e.prototype.bg=function(e){e.isVolatile||(e.isVolatile=!0,this.Gf.push(e))},e.prototype.Tf=function(e){var t,n,o,r,i;if(e.isVolatile=p,(t=this).B5++,t.B5>100){for(t.B5=0,n=[],o=t.Gf,r=t.Gf.length,i=0;i<r;i++)o[i].isVolatile&&n.push(o[i]);t.Gf=n}},e.prototype.getCalcService=function(){return this._service},e.prototype.setCalcService=function(e){this._service=e},e.prototype.Cf=function(){return this._service},e.prototype.getSource=function(){return this._source},e.prototype.hasFormula=function(e,t){return e=e!==p?e:-1,t=t!==p?t:-1,!!this._getExpressionWithRowColumn(e,t)},e.prototype.setFormula=function(e,t,n,o,r,i,a,s){var l,u,c,f,d,g=this;if(n&&0===n.length&&(n=h),!r&&g.dg(e,t,1,1)&&g.eg(),l=g.getFormula(e,t),i||l!==n&&(""!==l||n)&&(l||""!==n)||l===n&&g.Qf(e,t)){if(u=g.Cf(),c=h,u)try{f=e>=0?e:0,d=t>=0?t:0,c=o||(n?u.parse(g._source,n,f,d,!1,r):h),g.fg(e,t,c,p,!1,a,s)}catch(e){if(!r)throw e}e>=0&&t>=0&&g._source.setFormula(e,t,n)}},e.prototype.getFormula=function(e,t,n){var o,r,i=this.Cf();return i&&(o=this._getExpressionWithRowColumn(e,t))?(e=(r=this.Qf(e,t))&&!0!==r.isDynamicArray?r.row:e,t=r&&!0!==r.isDynamicArray?r.col:t,i.unparse(this._source,o,e,t,n)):h},e.prototype.setFormulaByName=function(e,t,n,o,r){var i,a,s,l;if(e&&(e=x(e),i=this,t&&0===t.length&&(t=h),(a=i.getFormulaByName(e))!==t&&(""!==a||t)&&(a||""!==t))){if(s=i.Cf(),l=h,s)try{l=t?s.parse(i._source,t,0,0,!1,n):h,i.gg(e,l,p,!1,o,r)}catch(e){if(!n)throw e}i._source.setFormula({name:e},t)}},e.prototype.getFormulaByName=function(e){var t,n=this.Cf();return n&&e&&(t=this.DTa(x(e)))?n.unparse(this._source,t,0,0):h},e.prototype.eg=function(){throw r.sR().Exp_ArrayFromulaPart},e.prototype.rC=function(){return S(this._source.getRowCount())},e.prototype.cC=function(){return S(this._source.getColumnCount())},e.prototype.setArrayFormula=function(e,t,n,o,r,i,a,s){var l,u,c,f,p=this;if(r&&0===r.length&&(r=h),p.dg(e,t,n,o)&&p.eg(),e=e<0?0:e,t=t<0?0:t,(u=p.Cf())&&(p.$b(e,t,n,o,a),r)){try{l=r?u.parse(p._source,r,e,t,!1,i,i):h}catch(e){if(!i)throw e;return}for(c=e;c<e+n;c++)for(f=t;f<t+o;f++)p.fg(c,f,l,Y(e,t,n,o),!1,a,s);e>=0&&t>=0&&p._source.setArrayFormula(e,t,n,o,u.unparse(p._source,l,e,t))}},e.prototype.getWorkingNodeInfo=function(e,t,n){var o,r=this,i=r._source;return e>=i.getRowCount()||t>=i.getColumnCount()?o:(e>=0&&t>=0?((!(o=r.getNode(e,t))||0===n&&!o.Lf||1===n&&!o.Nf||2===n&&!o.Pf)&&(o=r.getNode(e,-1)),(!o||0===n&&!o.Lf||1===n&&!o.Nf||2===n&&!o.Pf)&&(o=r.getNode(-1,t))):o=e>=0&&-1===t?r.getNode(e,-1):-1===e&&t>=0?r.getNode(-1,t):r.getNode(-1,-1),o&&(0===n&&o.Lf||1===n&&o.Nf||2===n&&o.Pf))},e.prototype.fg=function(e,t,n,o,r,i,a){var l,u,c,f,h,d,g,m,y,v,b,C,w,x=this,A=x.Cf();A.nia&&A.lh.asyncManager.endCalcCell(),u=(l=o!==p&&null!==o)?o.row:e,c=l?o.col:t,f=x._source,h=new s.EvaluateContext(f,Q(u,c),l),d=A.allowDynamicArray,g=q(h,n,l,l?e-o.row:0,l?t-o.col:0,d,d),(m=h.iOb)&&(delete h.iOb,2===m?n=g:1===m&&(y=A.unparse(f,n,u,c),n=A.parse(f,y,u,c))),g=g===n?p:g,o!==p&&(v=o),e>=0&&t>=0?((r===p||r)&&(b=e>=0?e:0,C=t>=0?t:0,w=n?A.unparse(f,n,b,C):p,x._source.setFormula(e,t,w)),x.ig(e,t,n,g,v,i,a)):e>=0&&-1===t?x.jg(e,n,g,i,a):-1===e&&t>=0&&x.kg(t,n,g,i,a),A.autoCalculation&&!A.IsSuspended()&&A.recalculateAll(!1)},e.prototype.gg=function(e,t,n,o,r,i){var a,l=this,u=l.Cf(),c=q(new s.EvaluateContext(l._source,Q(0,0),!1),t,!1,0,0);c=c===t?p:c,o!==p&&!o||r||(a=t?u.unparse(l._source,t,0,0):p,l._source.setFormulaByName&&l._source.setFormulaByName(e,a)),l.lg(e,t,c,null,i),u.autoCalculation&&!u.IsSuspended()&&(r||u.recalculateAll(!1))},e.prototype.getRowExpression=function(e){return this.Kf(e,-1)},e.prototype.getColumnExpression=function(e){return this.Kf(-1,e)},e.prototype.lg=function(e,t,n,o,r){var i,a=this.mg(e,!0);a&&(r||a.ng(),(i=this.getNodeByName(e,!0)).Lf=t,o&&(o[0].push("dataTable",e),o[1]=i.Lf),n=t&&n?n:p,i.Nf=n,r||a.og(),a.fh())},e.prototype.ig=function(e,t,n,o,r,i,a){var s=this,l=s.qg(e,t,!0);l&&(s.FTa(i,e,t),s._service.onClearExpr(s._source,Q(e,t)),l.ng(),s.Rf(e,t,n),n?((o||s.Mf(e,t))&&s.Wf(e,t,o),r&&!0===r.isDynamicArray||s.Xf(e,t,r)):(s.Wf(e,t,p),s.Xf(e,t,p)),l.og(),l.fh())},e.prototype.jg=function(e,t,n,o,r){var i=this,a=i.rg(e,!0);a&&(i.FTa(o,e,-1),r||a.ng(),i.Rf(e,-1,t),(n||i.Mf(e,-1))&&i.Wf(e,-1,n),r||a.og(),a.fh())},e.prototype.kg=function(e,t,n,o,r){var i=this,a=i.sg(e,!0);a&&(i.FTa(o,-1,e),r||a.ng(),i.Rf(-1,e,t),(n||i.Mf(-1,e))&&i.Wf(-1,e,n),r||a.og(),a.fh())},e.prototype.$b=function(e,t,n,o,r){var i,a,s,l,u,c=this,f=e<0?0:e,d=t<0?0:t,g=f+(e<0?c.rC():n)-1,m=d+(t<0?c.cC():o)-1,y=function(e,t){if(i=c.Mf(e,t),a=c.Kf(e,t),i||a){var n=(s=c.Qf(e,t))&&!0!==s.isDynamicArray?Y(s.row,s.col,s.rowCount,s.colCount):p;c.fg(e,t,h,n,!0,r)}};for(l=f;l<=g&&l>=0;l++)for(t<0&&y(l,-1),u=d;u<=m&&u>=0;u++)l===f&&e<0&&y(-1,u),y(l,u);e<0&&t<0&&y(e,t)},e.prototype.dg=function(e,t,n,o){return this.tg(e,t,n,o,!0,!0)},e.prototype.tg=function(e,t,n,o,r,i){var a,s,l,u,c,f,h,p,d=this,g=e<0?0:e,m=t<0?0:t,y=e<0?d.rC():n,v=t<0?d.cC():o,b=g+(0===y?1:y)-1,C=m+(0===v?1:v)-1,w=!1,x=[],A=[],M=d.dataTable;for(l=g;l<=b&&l>=0&&!(l>d.Ef);l++)if(s=M[l])for(u=m;u<=C&&u>=0&&!(u>d.Ff);u++)if(a=s[u])if(f=void 0,(c=a.Pf)&&!c.isDynamicArray){if(c.row<g||c.row+c.rowCount-1>b||c.col<m||c.col+c.colCount-1>C){if(r)return h=c.row===e&&0===n,p=c.col===t&&0===o,!h&&!p;w=!0}if(l!==c.row&&l!==g)continue;x.push(Y(c.row,c.col,c.rowCount,c.colCount)),f=a.Lf,A.push(f),u=c.col+c.colCount-1}else i||(f=a.Lf)&&(x.push({row:l,col:u}),A.push(f));return!r&&{hasPart:w,ranges:x,formulas:A}},e.prototype.getCalcObj=function(){var e,t,n,o,r,i,a,s,l,u,c,f=[];for(e=0;e<arguments.length;e++)f[e]=arguments[e];if(t=f[0],n=f[1],o=this,r=t.row,i=t.column,a=null,isNaN(r)||isNaN(i))t.name&&(a=o.mg(t.name,n));else if(r>=0&&i>=0)if(t.sf())a=o.qg(r,i,n);else for(s=t.endRow,l=t.endColumn,a=[],u=r;u<=s;u++)for(c=i;c<=l;c++)a.push(o.qg(u,c,n));else r>=0?a=o.rg(r,n):i>=0&&(a=o.sg(i,n));return a},e.prototype.mg=function(e,t){var n=h,o=this.getNodeByName(e,t);return o&&(!(n=o.calc)&&t&&(n=new R(this,e),o.calc=n,n.node=o)),n},e.prototype.qg=function(e,t,n){var o,r,i,a=this,s=h;if(e>=0&&t>=0){if(!(r=(o=a.dataTable)[e])){if(!n)return s;r=o[e]={},e>a.Ef&&(a.Ef=e)}if(!(i=r[t]))return n&&(i=r[t]={},s=new _(a,e,t),i.calc=s,s.node=i,t>a.Ff&&(a.Ff=t)),s;!(s=i.calc)&&n&&(s=new _(a,e,t),i.calc=s,s.node=i,e>a.Ef&&(a.Ef=e),t>a.Ff&&(a.Ff=t))}return s},e.prototype.rg=function(e,t){var n=this,o=h;return e>=0&&(!(o=n.Yf(e,-1))&&t&&(o=new O(n,e),n.Zf(e,-1,o),e>n.Ef&&(n.Ef=e))),o},e.prototype.sg=function(e,t){var n=this,o=h;return e>=0&&(!(o=n.Yf(-1,e))&&t&&(o=new F(n,e),n.Zf(-1,e,o),e>n.Ff&&(n.Ff=e))),o},e.prototype.ug=function(e){var t=this;return!t.vg&&e&&(t.vg=new H(t)),t.vg},e.prototype.wg=function(e,t){var n,o=this;return e=x(e),o.xg||(o.xg={}),!(n=o.xg[e])&&t&&(n=o.xg[e]=new P(o,e)),n},e.prototype.updateNameCalc=function(e,t){var n=this.wg(x(e));n&&(n.updateListening(!0,t),n.fh())},e.prototype.yg=function(e,t){var n,o,r=this,i=S(r.Ff,e+t-1);for(n=e;-1!==n&&n<=i;n++)r.isDirty(-1,n)&&(o=r.sg(n,!0),r._service.pg(o,2))},e.prototype.zg=function(e,t){var n,o,r=this,i=S(r.Ef,e+t-1);for(n=e;-1!==n&&n<=i;n++)r.isDirty(n,-1)&&(o=r.rg(n,!0),r._service.pg(o,1))},e.prototype.Ag=function(e,t,n,o){var r,i,a,s=this,l=null,u=S(s.Ef,e+n-1),c=S(s.Ff,t+o-1);for(r=e;r<=u;r++)for(i=t;i<=c;i++)s.ega(r,i)&&(s._service.calcOnDemand?(l=s.qg(r,i,!1))&&(l.Bg(),l.$l=!0):(l=s.qg(r,i,!0),s._service.pg(l,0)));s.zg(e,n),s.yg(t,o),(a=s.ug(!1))&&a.Bg(e,t,n,o)},e.prototype.uhc=function(){var e,t,n,o,r,i=this,a=i.lmb().concat(i.thc());for(n=0;n<a.length;n++)o=a[n],i._service.calcOnDemand&&o&&(o.isVolatile||o.isIterativeCalc)&&(o.$l=!0,o.Bg()),o&&(o.isVolatile||o.isIterativeCalc)&&o instanceof _&&!i.Dg(o)&&(r=i.qg(o.row,o.column,!0),i._service.pg(r,0),(e=i.rg(o.row,!1))&&!i.Eg(e)&&i.zg(o.row,1),(t=i.sg(o.column,!1))&&!i.Eg(t)&&i.yg(o.column,1))},e.prototype.Dg=function(e){var t=this.getCalcService().imb;return!!e.dh||e===(t&&t[0])},e.prototype.Eg=function(e){var t=this.getCalcService().imb;return e.dh||e===(t&&t[1])},e.prototype.isDirtyColumn=function(e){var t=this.getCalcService().imb;return e.dh||e===(t&&t[2])},e.prototype.isDirty=function(e,t){return!(!this.Yf(e,t)&&!this.Kf(e,t))},e.prototype.recalculateForContext=function(e,t,n){var o=this._service,r=o.getSourceModel(e),i=t.row,a=t.col;-1===a?r.Ag(i,0,1,r.cC()):-1===i?r.Ag(0,a,r.rC(),1):r.Ag(i,a,1,1),o.IsSuspended()||o.recalculateAll(!1,n)},e.prototype.recalculateCell=function(e,t,n){var o,a,s,l,u,c,d,g,m,v,C,w,x,A,S,T,I,R=this,k=R._source,E=R._getWorkingExpressionWithRowColumn(e,t)||R._getExpressionWithRowColumn(e,t),D=k,j=D.q$a,_=D&&D.kj&&D.kj._modelManager;if(_&&(_.SIb=!0),a=!1,E){if(s=Q(e,t),l=k.getValue(e,t),u=!1,c=void 0,d=void 0,g=void 0,m=void 0,(v=R.Qf(e,t))&&!0!==v.isDynamicArray&&(u=!0,c=v.row,d=v.col,g=v.rowCount,m=v.colCount),(C=R._service).nia&&C.lh.asyncManager.startCalcCell(R._source,s),(w=C._evaluateParsedFormula(R._source,E,s,u,!0,v&&!0!==v.isDynamicArray&&Y(c,d,g,m),C.allowDynamicArray,n))&&w.pause)return w;if((x=R._source.getCalcSourceModel().qg(e,t)).jOb&&(G(k,x.jOb,e,t,!1),delete x.jOb),x.fOb&&(G(k,x.fOb,e,t,!0),x.jOb=x.fOb,delete x.fOb),x.kOb&&(W(C,x,x.kOb,!1),delete x.kOb),x.eOb&&(W(C,x,x.eOb,!0),x.kOb=x.eOb,delete x.eOb),(r.Convert._isReference(w)||r.Convert.Ca(w))&&!0!==E.ensureSingle&&(v={row:e,col:t,rowCount:g=w.getRowCount(),colCount:m=w.getColumnCount(),isDynamicArray:!0},R.Xf(e,t,v)),a=!0,S=void 0,(A=r.Convert._isReference(w)||r.Convert.Ca(w))&&((S=r.Convert.Ph(w,0,!1,!1,!1)).isError||S.isConvertError?(w=y,A=!1):(g=S.rowCount,m=S.colCount,0===g||0===m?(w=b,A=!1):1!==g||1!==m||E instanceof i.SpillReferenceExpression||(w=S[0][0],M(w)&&(w=0),A=!1),E.ensureSingle&&A&&(T=R.getNode(e,t),delete E.ensureSingle,E=T.Lf=r.Jh(r.Functions.findGlobalFunction("@"),[E]),T.Nf=p,w=E.function.evaluate({row:e,column:t},w),A=!1))),A)(I=D.setArray(e,t,g,m,S))&&L(I[1],D);else if((I=D.updateItem&&D.updateItem(e,t,w))&&(L(I[0],D),o=I[1]),"hyperlink",l!==w||"string"==typeof w&&w.hyperlink){if(l instanceof Date){if(w instanceof Date&&l.valueOf()===w.valueOf())return!1;if(typeof w===N){if(f.Ra(l)===w)return!1;w=f.Xb(w)}}k.setValue(e,t,w,l)}else a=!1;C.nia&&C.lh.asyncManager.endCalcCell(R._source,s),D.Ppb&&D.Ppb(e,t)}else j||(I=D.updateItem&&D.updateItem(e,t,h))&&(L(I[0],D),o=I[1]);return _&&(o&&V(o,R,_.ZHb),_.SIb=!1),a},e.prototype.recalculateNameID=function(e){var t,n,o=this,r=o._source,i=o.CTa(e)||o.DTa(e);if(i){if((t=r.getValueByName?r.getValueByName(e):r.getValue({name:e}))===(n=o._service._evaluateParsedFormula(o._source,i,{name:e},!1,!0)))return;if(t instanceof Date&&n instanceof Date&&t.valueOf()===n.valueOf())return;r.setValueByName?r.setValueByName(e,n):r.setValue({name:e},n)}},e.prototype.addDirtyNodesForCalc=function(e,t){var n,o,r=this;!1!==e?(n=r.cC(),o=r.rC(),r.yg(0,n),r.zg(0,o),r.Ag(0,0,o,n)):t||r.uhc()},e.prototype.addListenersToDirtyForRow=function(e){for(var t,n,o,r;e.imb[1];){for(o=(n=(t=e.imb[1]).ah).cC(),r=0;r<o;r++)e.pg(n.qg(t.row,r,!0),0);e.Bh(t,1)}},e.prototype.addListenersToDirtyForCol=function(e){for(var t,n,o,r;e.imb[2];){if((o=(n=(t=e.imb[2]).ah).rC())>0)for(r=0;r<o;r++)e.pg(n.qg(r,t.column,!0),0);else t.Bg();e.Bh(t,2)}},e.prototype.Ah=function(e,t){for(var n=e.length,o=t;o;)e[n]=o,n++,o=o.eh},e.prototype.addListenersToDirty=function(e,t){var n,o,r,i,a,s,l,u,c,f,h,p,d,g;if(1===t)this.addListenersToDirtyForRow(e);else if(2===t)this.addListenersToDirtyForCol(e);else if(0===t)for(n=[],e.imb[2]&&this.Ah(n,e.imb[2]),o=e.imb[0];o;o=o.eh)for(r=o.ah,i=o.row,a=o.column,s=r.rg(i,!1),l=r.sg(a,!1),u=r.ug(!1),o.Bg(),s&&s.Bg(),l&&l.Bg(),u&&u.Bg(i,a,1,1),this.addListenersToDirtyForRow(e);e.imb[2];){for(c=e.imb[2],f=!1,h=0;h<n.length;h++)if(n[h]===c){f=!0;break}if(f)e.Bh(c,2);else{for(n[n.length]=c,p=(r=c.ah).rC(),d=0;d<p;d++)e.pg(r.qg(d,c.column,!0),0);e.Bh(c,2)}}else if(3===t)for(g=e.imb[3];g;g=g.eh)g.Bg()},e.prototype.initDelay=function(e,n){var o,r,i,a,s,l,u;if(0===n)for(o=null,r=e.imb[0];r;r=o)o=r.eh,a=(i=r.ah).rC(),s=i.cC(),r.row<a&&r.column<s?(t.supportRowColumnFormula&&((l=i.sg(r.column,!1))&&(l.delay=0)),r.delay=0,delete r.MDc):e.Bh(r,0);else if(3===n)for(u=e.imb[3];u;u=u.eh)u.delay=0},e.prototype.adjustDelayOfListeners=function(e,t,n){var o,r,i,a,s,l,u,c;if(0===t)for(o=e.imb[t];o;o=o.eh)r=o.ah,i=o.row,a=o.column,s=r.rg(i,!1),l=r.sg(a,!1),u=r.ug(!1),o.gh(n),s&&s.gh(n),l&&l.gh(n),u&&u.gh(i,a,n);else if(3===t)for(c=e.imb[3];c;c=c.eh)c.gh(n)},e.prototype.calculateDirtyNodes=function(e,t){var n,o,r,i,a,s,l,u,c,f,h,p,d,g;if(e.calcOnDemand)return!1;if(n=!1,o=null,0===t){for(i=e.imb[t];i;i=r)if(r=i.eh,0===i.delay){if(this.shc(i),o=i.ah,a=i.row,s=i.column,l=o.rg(a,!1),(u=o.sg(s,!1))&&u.delay)continue;if(c=o.ug(!1),(f=o.recalculateCell(a,s,!0))&&"Branch"===f.pause){if(r=i,f.branch)for(h=0;h<f.branch.length;h++)(f.branch[h].dh||f.branch[h].eh||f.branch[h]===i)&&(i.delay++,(p=f.branch[h]).MDc=p.MDc||[],p.MDc.push(i))}else e.Bh(i,0),i.gh(!1),l&&l.gh(!1),u&&u.gh(!1),c&&c.gh(a,s,!1),(d=i.node&&i.node.Lf)&&d.ehc&&delete d.ehc;n=!0}}else if(3===t)for(g=e.imb[t];g;g=r)r=g.eh,0===g.delay&&((o=g.ah).recalculateNameID(g.name),e.Bh(g,3),g.gh(!1),n=!0);return n},e.prototype.calculateIterations=function(e,n){var o,r,i,a,s,l,u,c,f,d,g,m,y;if(!e.calcOnDemand&&0===n&&(o=e.imb[n])){for(a in r=null,i=!0,e.jh)e.jh.hasOwnProperty(a)&&((s=e.jh[a].getSource()).clearValueCache&&s.clearValueCache());if(e.iterativeCalculation)for(u=0;i&&u<e.iterativeCalculationMaximumIterations;u++)for(i=!1,r=o;r;r=r.eh)l=r.node&&r.node.Lf&&r.node.Lf.ehc,this.rhc(r,!l,h),l&&(r.node.Lf.ehc=p),c=r.ah,f=r.row,d=r.column,g=c.getSource().getValue(f,d),c.recalculateCell(f,d),i||(m=c.getSource().getValue(f,d),t.approximatelyEqual(g,m,e.iterativeCalculationMaximumChange)||(i=!0));else for(r=o;r;r=r.eh)l=r.node&&r.node.Lf&&r.node.Lf.ehc,this.rhc(r,!l,0),l&&(r.node.Lf.ehc=p);for(y=null,r=o;r;r=y)y=r.eh,r.eh=p,y&&(y.dh=p)}},e.prototype.Ig=function(e,t,n,o,a,s,l){var u,c,f,d,g,m,y,v,b,C,w,A,M,S,T,N,I,R,k,E,D,j,O,F,P,H,B,L,z,V,G,W,U=this;for(s&&U.shc(e);12===o.type;)o=o.value;for(;10===o.type;)o=o.value;for(;12===o.type;)o=o.value;if(a){for(;12===a.type;)a=a.value;for(;10===a.type;)a=a.value;for(;12===a.type;)a=a.value}if(13===o.type){if((m=o.getRange(t,n,!0))===h)return;o=1===m.rowCount&&1===m.colCount?i.rf(h,h,m.row,m.col,!1,!1):i.uf(h,h,m.row,m.col,m.row+m.rowCount-1,m.col+m.colCount-1,!1,!1,!1,!1)}if(a&&a!==o&&8===a.type){if(a.source instanceof r.ErrorSource)return;c=a.value,(f=(R=o.source||a.source||l||U._source).getCustomName(c))?k=R.getCalcSourceModel():(f=(k=U._service.getGlobalSourceModel()||R.getCalcSourceModel()).getSource().getCustomName(c))||R.getCalcSourceModel().wg(c,!0).gmb(0,e,s),(d=k.wg(c,!0)).gmb(0,e,s),a=null,f&&U.Ig(e,t,n,f,h,s,k.getSource())}if(1===o.type&&o.endSource)for(D=(E=o).source.getSources(E.endSource),u=0;u<D.length;u++)(j=i.uf(D[u],h,E.row,E.column,E.endRow,E.endColumn,E.rowRelative,E.columnRelative,E.endRowRelative,E.endColumnRelative,t,n)).isFullRow=E.isFullRow,j.isFullColumn=E.isFullColumn,U.Ig(e,t,n,j,h,s);else if(1===o.type){if(!(k=(R=o.source!==r.BangSource&&o.source||U._source).getCalcSourceModel()))return;if(O=o,F=e.row===p||e.column===p,P=O.tf(),y=(H=i.getRangeForReference(O,t,n)).row,b=H.col,v=y+(w=H.rowCount)-1,C=b+(A=H.colCount)-1,0===P){if(0<=t&&0<=n)if(K(void 0,void 0,w,A))g=k.ug(!0),F?g.Xoa(y,b,w,A,e,s):g.Jg(y,b,w,A,e,s);else for(N=y;N<=v;N++)for(I=b;I<=C;I++)M=k.qg(N,I,!0),F?M&&M.gmb(3,e,s):M&&M.gmb(0,e,s);else if(0<=t&&-1===n)for(N=y;N<=v;N++)for(I=b;I<=C;I++)O.columnRelative||O.endColumnRelative?(S=k.rg(N,!0))&&S.Kg(e.row,-I,s):(M=k.qg(N,I,!0))&&M.gmb(1,e,s);else if(0<=n&&-1===t)for(N=y;N<=v;N++)for(I=b;I<=C;I++)O.rowRelative||O.endRowRelative?(T=k.sg(I,!0))&&T.Mg(e,-N,s):(M=k.qg(N,I,!0))&&M.gmb(2,e,s)}else if(1===P){if(0<=t&&0<=n)g=k.ug(!0),F?g.Xoa(y,b,w,A,e,s):g.Jg(y,b,w,A,e,s);else if(0<=t&&-1===n);else if(-1===t&&0<=n)if(O.rowRelative||O.endRowRelative);else for(y=O.row,v=O.endRow,N=y;N<=v;N++)(S=k.rg(N,!0))&&S.gmb(2,e,s)}else if(2===P)if(0<=t&&0<=n)g=k.ug(!0),F?g.Xoa(y,b,w,A,e,s):g.Jg(y,b,w,A,e,s);else if(0<=t&&-1===n);else if(-1===t&&0<=n)for(I=b;I<=C;I++)(T=k.sg(I,!0))&&T.gmb(2,e,s)}else if(9===o.type)U.Ig(e,t,n,o.value,a&&9===a.type&&a.value,s),o.value2&&U.Ig(e,t,n,o.value2,a&&9===a.type&&a.value2,s);else if(8===o.type){if(R=o.source||l||U._source,c=x(o.value),(f=R.getCustomName(c))?k=R.getCalcSourceModel():(f=(k=U._service.getGlobalSourceModel()||R.getCalcSourceModel()).getSource().getCustomName(c))||R.getCalcSourceModel().wg(c,!0).gmb(0,e,s),!(d=k.wg(c,!0)))return;d.gmb(0,e,s),f&&U.Ig(e,t,n,f,h,s,k.getSource())}else if(7===o.type){if(B=o.function){if(B.isVolatile()&&(s?U.bg(e):U.Tf(e)),!B.precedentReference())return;B instanceof r.Functions.AsyncFunction&&(U._service.nia=!0)}for(L=o.arguments.length,u=0;u<L;u++)z=!1,B&&B.isBranch()&&B.findTestArgument()!==u&&e instanceof _&&(o.QDc=!0,o.RDc=o.RDc||[],o.RDc[u]=[],z=!0,e.LDc=e.LDc||[],e.LDc.push(o.RDc[u])),U.Ig(e,t,n,o.arguments[u],a&&7===a.type&&a.arguments[u],s),z&&e.LDc.pop()}else if(25===o.type||26===o.type){if(V=o,!(G=(k=(R=o.source||U._source).getCalcSourceModel()).mg(V.value,!0)))return;G.gmb(0,e,s)}else 33===o.type&&((W=o).isReferenceError||(k=(R=W.source||W.contextSource||U._source).getCalcSourceModel(),H=i.getRangeForReference(W,t,n),(M=k.qg(H.row,H.col,!0))&&M.gmb(0,e,s)))},e.prototype.Og=function(e,t){var n=this.getNodeByName(e);n&&(n.Nf||n.Lf)&&this.Ig(this.mg(e),0,0,n.Nf||n.Lf,n.Lf,t)},e.prototype.Pg=function(e,t,n,o,r){var i,a,s,l,u,c=this,f=e+n,h=t+o;for(l=e;l<f;l++)for(u=t;u<h;u++)i=c.Mf(l,u),a=c.Kf(l,u),(i||a)&&((s=c.Qf(l,u))&&!0!==s.isDynamicArray?c.Ig(c.qg(l,u),s.row,s.col,i||a,a,r):c.Ig(c.qg(l,u),l,u,i||a,a,r))},e.prototype.Qg=function(e,t,n){var o,r,i=e+t;for(o=e;-1!==o&&o<i;o++)(r=this.getColumnExpression(o))&&this.Ig(this.sg(o,!1),-1,o,r,r,n)},e.prototype.Rg=function(e,t,n,o){this.Pg(e,t,n,o,!0)},e.prototype.Sg=function(e,t,n,o){this.Pg(e,t,n,o,!1)},e.prototype.Tg=function(e,t){},e.prototype.Ug=function(e,t){},e.prototype.Vg=function(e,t){this.Qg(e,t,!0)},e.prototype.Wg=function(e,t){this.Qg(e,t,!1)},e.prototype.Xg=function(e,t,n,o,r,i,a){var s,l,u,c=e+n,f=t+o;for(s=e;s<c;s++)for(l=t;l<f;l++)(u=this.qg(s,l,!1))&&(this.FTa(a,s,l),r&&u.Yg(),i&&u.Bg())},e.prototype.Zg=function(e,t,n,o,r){var i,a,s,l,u=this.Hf;if(-1!==e&&u)for(i=S(e+t,u.length),a=e;a<i;a++)(s=u[a])&&s.calc&&(this.FTa(r,a,-1),l=s.calc,n&&l.Yg(),o&&l.Bg())},e.prototype.$g=function(e,t,n,o,r){var i,a,s,l,u=this.If;if(-1!==e&&u)for(i=S(e+t,u.length),a=e;a<i;a++)(s=u[a])&&s.calc&&(this.FTa(r,-1,a),l=s.calc,n&&l.Yg(),o&&l.Bg())},e.prototype._g=function(e,t,n,o,r,i,a){var s,l,u,c;(r||i)&&(s=this,l=void 0,a&&(l=s.dUa()),0<=e&&0<=t?(s.Xg(e,t,n,o,r,i,l),s.Zg(e,n,r,i,l),s.$g(t,o,r,i,l),s.vg&&(r&&s.vg.Yg(e,t,n,o),i&&s.vg.Bg(e,t,n,o))):0<=e&&-1===t?(s.Xg(e,0,n,s.cC(),r,i,l),s.Zg(e,n,r,i,l),s.vg&&(r&&s.vg.Yg(e,t,n,o),i&&s.vg.Bg(e,t,n,o))):-1===e&&0<=t?(s.Xg(0,t,s.rC(),o,r,i,l),s.$g(t,o,r,i,l),s.vg&&(r&&s.vg.Yg(e,t,n,o),i&&s.vg.Bg(e,t,n,o))):-1===e&&-1===t&&(u=s.rC(),c=s.cC(),s.Xg(0,0,u,c,r,i,l),s.Zg(0,u,r,i,l),s.$g(0,c,r,i,l),s.vg&&(r&&s.vg.Yg(e,t,n,o),i&&s.vg.Bg(e,t,n,o))))},e.prototype.getAllNodes=function(){var e,t,n,o,r=[],i=this.dataTable,a=this.Hf,s=this.If,l=this.Jf;for(t in l&&r.push(l),a)a.hasOwnProperty(t)&&((e=a[t])&&r.push(e));for(t in s)s.hasOwnProperty(t)&&((e=s[t])&&r.push(e));for(n in i)if(i.hasOwnProperty(n)&&(o=i[n]))for(t in o)o.hasOwnProperty(t)&&((e=o[t])&&r.push(e));return r},e.prototype.toJSON=function(e){t.supportRowColumnFormula?this._source.toJSON(e,this.dataTable,this.Ef,this.Ff,this.If):this._source.toJSON(e,this.dataTable,this.Ef,this.Ff)},e}(),t.CalcSourceModel=j,_=function(e){function t(t,n,o){var r=e.call(this,t)||this;return r.row=n,r.column=o,r.delay=0,r}return B(t,e),t.prototype.getKey=function(){var e=this,t=e.ah;return(null===t?"":t._source.id+",")+e.row+","+e.column},t.prototype.og=function(){var e=this;e.ah.Rg(e.row,e.column,1,1)},t.prototype.ng=function(){var e=this;e.ah.Sg(e.row,e.column,1,1)},t.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,0)},t.prototype.fh=function(){this.$l=!0,this.ah.Cf().pg(this,0)},t.prototype.Bg=function(){var e,t,n,o,r,i,a,s,l=this.ah.Cf(),u=this.Ze;for(t=0;t<u.length;t++)if(n=this[u[t]])for(o in n)n.hasOwnProperty(o)&&(!(e=n[o])||e.dh||e.eh||e.fh(),l.calcOnDemand&&e&&!e.$l&&(e.$l=!0,e.Bg()));if((r=this.node&&this.node.Pf)&&r.isDynamicArray)for(i=0;i<r.rowCount;i++)for(a=i;a<r.colCount;a++)0===i&&0===a||(s=this.ah.getNode(i+r.row,a+r.col))&&s.calc&&s.calc.Bg()},t.prototype.y$a=function(){var e,t,n,o,r,i,a,s=this,l=s.ah,u=l.getCalcService();u&&u.nia&&(!(t=(e=s.nia)&&s.z$a)&&M(e)&&((n=l.getSource())&&(o=n.getName(),(r=u.lh.asyncManager.y5[o])&&((i=r[s.row])&&((a=i[s.column])&&((t=a[0])?(s.nia=!0,s.z$a=t,t.h_a=s):s.nia=!1))))),t&&0===t.evaluateMode&&(t.v5=!1))},t}(I),t.CellCalc=_,O=function(e){function t(t,n){var o=e.call(this,t)||this;return o.row=n,o}return B(t,e),t.prototype.getKey=function(){var e=this.ah;return(null===e?"":e._source.id+",")+this.row+",-1"},t.prototype.og=function(){this.ah.Tg(this.row,1)},t.prototype.ng=function(){this.ah.Ug(this.row,1)},t.prototype.Kg=function(e,t,n){n?function(e,t,n){e[t]||(e[t]=[]),e[t].push(n)}(this,T,{row:e,columnOffset:t,columnCount:1}):function(e,t,n){var o,r=e[t];if(r)for(o=0;o<r.length;o++)if(r[o]===n)return void r.splice(o,1)}(this,T,{row:e,columnOffset:t,columnCount:1})},t.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,1)},t.prototype.fh=function(){this.$l=!0,this.ah.Cf().pg(this,1)},t}(I),t.RowCalc=O,F=function(e){function t(t,n){var o=e.call(this,t)||this;return o.column=n,o}return B(t,e),t.prototype.getKey=function(){var e=this.ah;return(null===e?"":e._source.id+",")+"-1,"+this.column},t.prototype.og=function(){this.ah.Vg(this.column,1)},t.prototype.ng=function(){this.ah.Wg(this.column,1)},t.prototype.Mg=function(e,t,n){this.gmb(2,e,n)},t.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,2)},t.prototype.fh=function(){this.$l=!0,this.ah.Cf().pg(this,2)},t}(I),t.ColumnCalc=F,P=function(e){function t(t,n){var o=e.call(this,t)||this;return o.name=n,o}return B(t,e),t.prototype.getKey=function(){var e=this.ah;return(null===e?"":e._source.id+",")+this.name},t.prototype.updateListening=function(e,t){var n,o,r,i,a,s,l,u,c=this.Ze;for(r=0;r<c.length;r++)if(i=this[c[r]]){for(s in a=[],i)i.hasOwnProperty(s)&&((n=i[s])&&a.push(n));for(l=a.length,u=0;u<l;u++)o=(n=a[u]).node,n.ng(),o&&(!o.Pf||o.Pf.row===n.row&&o.Pf.col===n.column)&&n.ah.fg(n.row,n.column,o.Lf,o.Pf,!0)}},t.prototype.updateListeningOnRemoved=function(){var e,t,n,o,r,i,a,s,l,u,c=this,f=c.Ze,h=c.ah,d=h.Cf();for(i=0;i<f.length;i++)if(a=c[f[i]])for(s in a)a.hasOwnProperty(s)&&((e=a[s])&&(t=e.ah,n=e.row,o=e.col,n=n===p?-1:n,o=o===p?-1:o,r=t.Kf(n,o),l=t.Qf(n,o),r&&((u=d.ih().adjustFormulaOnRemoveName(h,r,c.name))!==r&&t.fg(n,o,u,l,!0))))},t.prototype.fh=function(){var e,t,n,o,r=this.Ze;for(t=0;t<r.length;t++)if(n=this[r[t]])for(o in n)n.hasOwnProperty(o)&&((e=n[o])&&e.fh())},t}(I),t.NameCalc=P,H=function(e){function t(t){return e.call(this,t)||this}return B(t,e),t.prototype.processListener=function(e,t,n,o,r,i,a){var s,l,u,c=this,f=c[e],h=t+","+n+","+o+","+r;if(3!==e||i instanceof R){if(i.LDc&&i.LDc.length>=1&&((u=i.LDc)[u.length-1].push(this),h="?"+h),f||(c.Ze.push(e),c[e]=f={}),!(s=f[h])){if(!a)return;(s=f[h]=[]).row=t,s.col=n,s.rowCount=o,s.colCount=r}if(a){for(l=0;l<s.length;l++)if(s[l]===i)return;s.push(i)}else{for(l=0;l<s.length;l++)s[l]===i&&s.splice(l,1);s.length<1&&delete f[h]}c.clearListenersCache()}},t.prototype.Jg=function(e,t,n,o,r,i){this.processListener(0,e,t,n,o,r,i)},t.prototype.Xoa=function(e,t,n,o,r,i){this.processListener(3,e,t,n,o,r,i)},t.prototype.Yg=function(e,t,n,o){this.visit(0,e,t,n,o)},t.prototype.clearListenersCache=function(){var e,t=this.Ze;for(e=0;e<t.length;e++)delete this[t[e]+"cached"]},t.prototype.getListeners=function(e,t){var n,o,r,i,a=e[t],s=this[a];if(s&&!(n=this[o=a+"cached"]))for(r in n=this[o]=[],s)s.hasOwnProperty(r)&&((i=s[r])&&n.push(i));return n},t.prototype.visit=function(e,t,n,o,r){var i,a,s,l,u,c,f,h,p,d,g,m,y,v=this.Ze;for(a=0;a<v.length;a++)if(this[v[a]])for(s=this.getListeners(v,a),l=0;l<s.length;l++)if(c=(u=s[l]).row,f=u.col,h=u.rowCount,p=u.colCount,(-1===c||-1===t||c<t+o&&t<c+h)&&(-1===f||-1===n||f<n+r&&n<f+p))for(d=u.length,g=0;g<d;g++)if(i=u[g],0===e){if(y=(m=this.ah.getSource()).getRangeKey&&m.getRangeKey(m,u),i._indirectRanges&&i._indirectRanges[y]){i.fh();continue}i.bh()}else i.fh()},t.prototype.Bg=function(e,t,n,o){this.visit(1,e,t,n,o)},t.prototype.gh=function(e,t,n){var o,r,i,a,s,l,u,c=this.Ze,f=n?1:-1;for(r=0;r<c.length;r++)if(this[c[r]])for(i=this.getListeners(c,r),a=0;a<i.length;a++)if((o=s=i[a])&&(-1===o.row||o.row<=e&&e<o.row+o.rowCount)&&(-1===o.col||o.col<=t&&t<o.col+o.colCount))for(l=s.length,u=0;u<l;u++)s[u].delay+=f},t.prototype.og=function(){},t.prototype.ng=function(){},t}(I),t.RangeCalc=H,t.Mh=q,t._createCellIdentity=Q,t.qf=Y},"./src/calcEngine.res.en.ts":function(e,t,n){"use strict";function o(e,t){return{description:e,parameters:t}}function r(e,t){return{name:e,repeatable:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.resource={Exp_InvalidCast:"Invalid Cast Exception",Exp_FormulaInvalidChar:"The formula contains an invalid character: '{0}' at index on {1}",Exp_FormulaInvalid:"Invalid Formula",Exp_InvalidFunctionName:"Invalid function name",Exp_InvalidOverrideFunction:"Cannot override built-in function",Exp_InvalidArray:"Invalid array",Exp_OverrideNotAllowed:"Attempt to override function while override is not allowed",Exp_NoSyntax:"No syntax '{0}' to match the syntax '{1}'.",Exp_IsValid:"'{0}' is invalid.",Exp_InvalidParameters:"Invalid function parameter at {0}.",Exp_InvalidArrayColumns:"The length of array columns are not equal at {0}.",Exp_ExprIsNull:"The argument 'expr' is null",Exp_InvalidOperation:"Invalid Operation Exception",Exp_ArgumentNull:"Argument Null Exception",Exp_CriteriaIsNull:"Criteria is null",Exp_Format:"Format",Exp_ArrayFromulaPart:"Cannot change part of an array.",Exp_NotSupported:"Not Supported Exception",_h:{ABS:o("This function calculates the absolute value of the specified value.",[r("value")]),ACCRINT:o("This function calculates the accrued interest for a security that pays periodic interest.",[r("issue"),r("first"),r("settle"),r("rate"),r("par"),r("frequency"),r("basis")]),ACCRINTM:o("This function calculates the accrued interest at maturity for a security that pays periodic interest.",[r("issue"),r("maturity"),r("rate"),r("par"),r("basis")]),ACOS:o("This function calculates the arccosine, that is, the angle whose cosine is the specified value.",[r("value")]),ACOSH:o("This function calculates the inverse hyperbolic cosine of the specified value.",[r("value")]),ADDRESS:o("This function uses the row and column numbers to create a cell address in text.",[r("row"),r("column"),r("absnum"),r("a1style"),r("sheettext")]),AGGREGATE:o("This function aggregate a list of numbers using a specified built-in function.",[r("functioncode"),r("option"),r("value1"),r("value2",!0)]),AMORDEGRC:o("This function returns the depreciation for an accounting period, taking into consideration prorated depreciation, and applies a depreciation coefficient in the calculation based on the life of the assets.",[r("cost"),r("datepurchased"),r("firstperiod"),r("salvage"),r("period"),r("drate"),r("basis")]),AMORLINC:o("This function calculates the depreciation for an accounting period, taking into account prorated depreciation.",[r("cost"),r("datepurchased"),r("firstperiod"),r("salvage"),r("period"),r("drate"),r("basis")]),AND:o("Check whether all arguments are True, and returns True if all arguments are True.",[r("logical1"),r("logical2")]),ASIN:o("This function calculates the arcsine, that is, the angle whose sine is the specified value.",[r("value")]),ASINH:o("This function calculates the inverse hyperbolic sine of a number.",[r("value")]),ATAN:o("This function calculates the arctangent, that is, the angle whose tangent is the specified value.",[r("value")]),ATAN2:o("This function calculates the arctangent of the specified x- and y-coordinates.",[r("x"),r("y")]),ATANH:o("This function calculates the inverse hyperbolic tangent of a number.",[r("value")]),AVEDEV:o("This function calculates the average of the absolute deviations of the specified values from their mean.",[r("value1"),r("value2",!0)]),AVERAGE:o("This function calculates the average of the specified numeric values.",[r("value1"),r("value2",!0)]),AVERAGEA:o("This function calculates the average of the specified values, including text or logical values as well as numeric values.",[r("value1"),r("value2",!0)]),AVERAGEIF:o("This function calculates the average of the specified numeric values provided that they meet the specified criteria.",[r("value1"),r("value2",!0),r("condition")]),AVERAGEIFS:o("This function calculates the average of all cells that meet multiple specified criteria.",[r("value1"),r("condition1"),r("value2",!0),r("condition2",!0)]),BESSELI:o("This function calculates the modified Bessel function of the first kind evaluated for purely imaginary arguments.",[r("value"),r("order")]),BESSELJ:o("This function calculates the Bessel function of the first kind.",[r("value"),r("order")]),BESSELK:o("This function calculates the modified Bessel function of the second kind evaluated for purely imaginary arguments.",[r("value"),r("order")]),BESSELY:o("This function calculates the Bessel function of the second kind.",[r("value"),r("order")]),BETADIST:o("This function calculates the cumulative beta distribution function.",[r("x"),r("alpha"),r("beta"),r("lower"),r("upper")]),BETAINV:o("This function calculates the inverse of the cumulative beta distribution function.",[r("prob"),r("alpha"),r("beta"),r("lower"),r("upper")]),BIN2DEC:o("This function converts a binary number to a decimal number",[r("number")]),BIN2HEX:o("This function converts a binary number to a hexadecimal number.",[r("number"),r("places")]),BIN2OCT:o("This function converts a binary number to an octal number.",[r("number"),r("places")]),BINOMDIST:o("This function calculates the individual term binomial distribution probability.",[r("x"),r("n"),r("p"),r("cumulative")]),CEILING:o("This function rounds a number up to the nearest multiple of a specified value.",[r("value"),r("signif")]),CHAR:o("This function returns the character specified by a number.",[r("value")]),CHIDIST:o("This function calculates the one-tailed probability of the chi-squared distribution.",[r("value"),r("deg")]),CHIINV:o("This function calculates the inverse of the one-tailed probability of the chi-squared distribution",[r("prob"),r("deg")]),CHITEST:o("This function calculates the test for independence from the chi-squared distribution.",[r("obs_array"),r("exp_array")]),CHOOSE:o("This function returns a value from a list of values.",[r("index"),r("value1"),r("value2",!0)]),CLEAN:o("This function removes all non-printable characters from text.",[r("text")]),CODE:o("This function returns a numeric code to represent the first character in a text string. The returned code corresponds to the Windows character set (ANSI).",[r("text")]),COLUMN:o("This function returns the column number of a reference.",[r("reference")]),COLUMNS:o("This function returns the number of columns in an array.",[r("array")]),COMBIN:o("This function calculates the number of possible combinations for a specified number of items.",[r("k"),r("n")]),COMPLEX:o("This function converts real and imaginary coefficients into a complex number.",[r("realcoeff"),r("imagcoeff"),r("suffix")]),CONCATENATE:o("This function combines multiple text strings or numbers into one text string.",[r("text1"),r("text2",!0)]),CONFIDENCE:o("This function returns confidence interval for a population mean.",[r("alpha"),r("stdev"),r("size")]),CONVERT:o("This function converts a number from one measurement system to its equivalent in another measurement system.",[r("number"),r("from-unit"),r("to-unit")]),CORREL:o("This function returns the correlation coefficient of the two sets of data.",[r("array1"),r("array2")]),COS:o("This function returns the cosine of the specified angle.",[r("angle")]),COSH:o("This function returns the hyperbolic cosine of the specified value.",[r("value")]),COUNT:o("This function returns the number of cells that contain numbers.",[r("value1"),r("value2",!0)]),COUNTA:o("This function returns the number of number of cells that contain numbers, text, or logical values.",[r("value1"),r("value2",!0)]),COUNTBLANK:o("This function returns the number of empty (or blank) cells in a range of cells on a sheet.",[r("cellrange")]),COUNTIF:o("This function returns the number of cells that meet a certain condition",[r("cellrange"),r("condition")]),COUNTIFS:o("This function returns the number of cells that meet multiple conditions.",[r("cellrange"),r("condition")]),COUPDAYBS:o("This function calculates the number of days from the beginning of the coupon period to the settlement date.",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COUPDAYS:o("This function returns the number of days in the coupon period that contains the settlement date.",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COUPDAYSNC:o("This function calculates the number of days from the settlement date to the next coupon date.",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COUPNCD:o("This function returns a date number of the next coupon date after the settlement date.",[r("settlement"),r("maturity"),r("frequency"),r("basi")]),COUPNUM:o("This function returns the number of coupons due between the settlement date and maturity date.",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COUPPCD:o("This function returns a date number of the previous coupon date before the settlement date.",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COVAR:o("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[r("array1"),r("array2")]),CRITBINOM:o("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[r("n"),r("p"),r("alpha")]),CUMIPMT:o("This function returns the cumulative interest paid on a loan between the starting and ending periods.",[r("rate"),r("nper"),r("pval"),r("startperiod"),r("endperiod"),r("paytype")]),CUMPRINC:o("This function returns the cumulative principal paid on a loan between the start and end periods.",[r("rate"),r("nper"),r("pval"),r("startperiod"),r("endperiod"),r("paytype")]),DATE:o("This function returns the DateTime object for a particular date, specified by the year, month, and day.",[r("year"),r("month"),r("day")]),DATEDIF:o("This function returns the number of days, months, or years between two dates.",[r("date1"),r("date2"),r("outputcode")]),DATEVALUE:o("This function returns a DateTime object of the specified date.",[r("date_string")]),DAVERAGE:o("This function calculates the average of values in a column of a list or database that match the specified conditions.",[r("database"),r("field"),r("criteria")]),DAY:o("This function returns the day number of the month (integer 1 to 31) that corresponds to the specified date.",[r("date")]),DAYS360:o("This function returns the number of days between two dates based on a 360-day year.",[r("startdate"),r("enddate"),r("method")]),DB:o("This function calculates the depreciation of an asset for a specified period using the fixeddeclining balance method",[r("cost"),r("salvage"),r("life"),r("period"),r("month")]),DCOUNT:o("This function counts the cells that contain numbers in a column of a list or database that match the specified conditions",[r("database"),r("field"),r("criteria")]),DCOUNTA:o("This function counts the non-blank cells in a column of a list or database that match the specified conditions",[r("database"),r("field"),r("criteria")]),DDB:o("This function calculates the depreciation of an asset for a specified period using the double-declining balance method or another method you specify.",[r("cost"),r("salvage"),r("life"),r("period"),r("factor")]),DEC2BIN:o("This function converts a decimal number to a binary number.",[r("number"),r("places")]),DEC2HEX:o("This function converts a decimal number to a hexadecimal number",[r("number"),r("places")]),DEC2OCT:o("This function converts a decimal number to an octal number",[r("number"),r("places")]),DEGREES:o("This function converts the specified value from radians to degrees",[r("angle")]),DELTA:o("This function identifies whether two values are equal. Returns 1 if they are equal; returns 0 otherwise.",[r("value1"),r("value2")]),DEVSQ:o("This function calculates the sum of the squares of deviations of data points (or of an array of data points) from their sample mean.",[r("value1"),r("value2",!0)]),DGET:o("This function extracts a single value from a column of a list or database that matches the specified conditions.",[r("database"),r("field"),r("criteria")]),DISC:o("This function calculates the discount rate for a security.",[r("settle"),r("mature"),r("pricep"),r("redeem"),r("basis")]),DMAX:o("This function returns the largest number in a column of a list or database that matches the specified conditions.",[r("database"),r("field"),r("criteria")]),DMIN:o("This function returns the smallest number in a column of a list or database that matches the specified conditions.",[r("database"),r("field"),r("criteria")]),DOLLAR:o("This function converts a number to text using currency format, with the decimals rounded to the specified place.",[r("value"),r("digits")]),DOLLARDE:o("This function converts a fraction dollar price to a decimal dollar price.",[r("fractionaldollar"),r("fraction")]),DOLLARFR:o("This function converts a decimal number dollar price to a fraction dollar price.",[r("decimaldollar"),r("fraction")]),DPRODUCT:o("This function multiplies the values in a column of a list or database that match the specified conditions.",[r("database"),r("field"),r("criteria")]),DSTDEV:o("This function estimates the standard deviation of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[r("database"),r("field"),r("criteria")]),DSTDEVP:o("This function calculates the standard deviation of a population based on the entire population using the numbers in a column of a list or database that match the specified conditions.",[r("database"),r("field"),r("criteria")]),DSUM:o("This function adds the numbers in a column of a list or database that match the specified conditions.",[r("database"),r("field"),r("criteria")]),DURATION:o("This function returns the Macaulay duration for an assumed par value of $100.",[r("settlement"),r("maturity"),r("coupon"),r("yield"),r("frequency"),r("basis")]),DVAR:o("This function estimates the variance of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[r("database"),r("field"),r("criteria")]),DVARP:o("This function calculates the variance of a population based on the entire population by using the numbers in a column of a list or database that match the specified conditions.",[r("database"),r("field"),r("criteria")]),EDATE:o("This function calculates the date that is the indicated number of months before or after a specified date.",[r("startdate"),r("months")]),EFFECT:o("This function calculates the effective annual interest rate for a given nominal annual interest rate and the number of compounding periods per year.",[r("nomrate"),r("comper")]),EOMONTH:o("This function calculates the date for the last day of the month (end of month) that is the indicated number of months before or after the starting date.",[r("startdate"),r("months")]),ERF:o("This function calculates the error function integrated between a lower and an upper limit.",[r("limit"),r("upperlimit")]),ERFC:o("This function calculates the complementary error function integrated between a lower limit and infinity.",[r("lowerlimit")]),"ERROR.TYPE":o("This function returns a number corresponding to one of the error values.",[r("errorvalue")]),EURO:o("This function returns the equivalent of one Euro based on the ISO currency code.",[r("code")]),EUROCONVERT:o("This function converts currency from a Euro member currency (including Euros) to another Euro member currency (including Euros).",[r("currency"),r("source"),r("target"),r("fullprecision"),r("triangulation")]),EVEN:o("This function rounds the specified value up to the nearest even integer.",[r("value")]),EXACT:o("This function returns true if two strings are the same; otherwise, false.",[r("text1"),r("text2")]),EXP:o("This function returns e raised to the power of the specified value.",[r("value")]),EXPONDIST:o("This function returns the exponential distribution or the probability density.",[r("value"),r("lambda"),r("cumulative")]),FACT:o("This function calculates the factorial of the specified number.",[r("number")]),FACTDOUBLE:o("This function calculates the double factorial of the specified number.",[r("number")]),FALSE:o("This function returns the value for logical FALSE.",[]),FDIST:o("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[r("value"),r("degnum"),r("degden")]),FIND:o("This function finds one text value within another and returns the text values position in the text you searched.",[r("findtext"),r("intext"),r("start")]),FINV:o("This function returns the inverse of the F probability distribution.",[r("p"),r("degnum"),r("degden")]),FISHER:o("This function returns the Fisher transformation for a specified value.",[r("value")]),FISHERINV:o("This function returns the inverse of the Fisher transformation for a specified value.",[r("value")]),FIXED:o("This function rounds a number to the specified number of decimal places, formats the number in decimal format using a period and commas (if so specified), and returns the result as text.",[r("num"),r("digits"),r("notcomma")]),FLOOR:o("This function rounds a number down to the nearest multiple of a specified value.",[r("value"),r("signif")]),FORECAST:o("This function calculates a future value using existing values.",[r("value"),r("Yarray"),r("Xarray")]),FREQUENCY:o("This function calculates how often values occur within a range of values. This function returns a vertical array of numbers.",[r("dataarray"),r("binarray")]),FTEST:o("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[r("array1"),r("array2")]),FV:o("This function returns the future value of an investment based on a present value, periodic payments, and a specified interest rate.",[r("rate"),r("numper"),r("paymt"),r("pval"),r("type")]),FVSCHEDULE:o("This function returns the future value of an initial principal after applying a series of compound interest rates. Calculate future value of an investment with a variable or adjustable rate.",[r("principal"),r("schedule")]),GAMMADIST:o("This function returns the gamma distribution.",[r("x"),r("alpha"),r("beta"),r("cumulative")]),GAMMAINV:o("This function returns the inverse of the gamma cumulative distribution.",[r("p"),r("alpha"),r("beta")]),GAMMALN:o("This function returns the natural logarithm of the Gamma function, G(x).",[r("value")]),GCD:o("This function returns the greatest common divisor of two numbers.",[r("number1"),r("number2")]),GEOMEAN:o("This function returns the geometric mean of a set of positive data.",[r("value1"),r("value2",!0)]),GESTEP:o("This function, greater than or equal to step, returns an indication of whether a number is equal to a threshold.",[r("number"),r("step")]),GROWTH:o("This function calculates predicted exponential growth. This function returns the y values for a series of new x values that are specified by using existing x and y values.",[r("y"),r("x"),r("newx"),r("constant")]),HARMEAN:o("This function returns the harmonic mean of a data set.",[r("value1"),r("value2",!0)]),HEX2BIN:o("This function converts a hexadecimal number to a binary number.",[r("number"),r("places")]),HEX2DEC:o("This function converts a hexadecimal number to a decimal number.",[r("number")]),HEX2OCT:o("This function converts a hexadecimal number to an octal number.",[r("number"),r("places")]),HLOOKUP:o("This function searches for a value in the top row and then returns a value in the same column from a specified row.",[r("value"),r("array"),r("row"),r("approx")]),HOUR:o("This function returns the hour that corresponds to a specified time.",[r("time")]),HYPGEOMDIST:o("This function returns the hypergeometric distribution.",[r("x"),r("n"),r("M"),r("N")]),IF:o("This function performs a comparison and returns one of two provided values based on that comparison.",[r("valueTest"),r("valueTrue"),r("valueFalse")]),IFERROR:o("This function evaluates a formula and returns a value you provide if there is an error or the formula result.",[r("value"),r("error")]),IMABS:o("This function returns the absolute value or modulus of a complex number.",[r("complexnum")]),IMAGINARY:o("This function returns the imaginary coefficient of a complex number.",[r("complexnum")]),IMARGUMENT:o("This function returns the argument theta, which is an angle expressed in radians.",[r("complexnum")]),IMCONJUGATE:o("This function returns the complex conjugate of a complex number.",[r("complexnum")]),IMCOS:o("This function returns the cosine of a complex number.",[r("complexnum")]),IMDIV:o("This function returns the quotient of two complex numbers.",[r("complexnum"),r("complexdenom")]),IMEXP:o("This function returns the exponential of a complex number.",[r("complexnum")]),IMLN:o("This function returns the natural logarithm of a complex number.",[r("complexnum")]),IMLOG2:o("This function returns the base-2 logarithm of a complex number.",[r("complexnum")]),IMLOG10:o("This function returns the common logarithm of a complex number.",[r("complexnum")]),IMPOWER:o("This function returns a complex number raised to a power.",[r("complexnum"),r("powernum")]),IMPRODUCT:o("This function returns the product of up to 29 complex numbers in the x+yi or x+yj text format.",[r("complexnum1"),r("complexnum2",!0)]),IMREAL:o("This function returns the real coefficient of a complex number in the x+yi or x+yj text format.",[r("complexnum")]),IMSIN:o("This function returns the sine of a complex number in the x+yi or x+yj text format.",[r("complexnum")]),IMSQRT:o("This function returns the square root of a complex number in the x+yi or x+yj text format.",[r("complexnum")]),IMSUB:o("This function returns the difference of two complex numbers in the x+yi or x+yj text format.",[r("complexnum1"),r("complexnum2")]),IMSUM:o("This function returns the sum of two or more complex numbers in the x+yi or x+yj text format.",[r("complexnum1"),r("complexnum2",!0)]),INDEX:o("This function returns a value or the reference to a value from within an array or range.",[r("return"),r("row"),r("col"),r("area")]),INDIRECT:o("This function returns the reference specified by a text string. References are immediately evaluated to display their contents.",[r("ref_text"),r("a1_style")]),INT:o("This function rounds a specified number down to the nearest integer.",[r("value")]),INTERCEPT:o("This function returns the coordinates of a point at which a line intersects the y-axis, by using existing x values and y values.",[r("dependent"),r("independent")]),INTRATE:o("This function calculates the interest rate for a fully invested security.",[r("settle"),r("mature"),r("invest"),r("redeem"),r("basis")]),IPMT:o("This function calculates the payment of interest on a loan.",[r("rate"),r("per"),r("nper"),r("pval"),r("fval"),r("type")]),IRR:o("This function returns the internal rate of return for a series of cash flows represented by the numbers in an array.",[r("arrayvals"),r("estimate")]),ISBLANK:o("This function tests whether a value, an expression, or contents of a referenced cell is empty.",[r("cellreference")]),ISERR:o("This function, Is Error Other Than Not Available, tests whether a value, an expression, or contents of a referenced cell has an error other than not available (#N/A).",[r("cellreference")]),ISERROR:o("This function, Is Error of Any Kind, tests whether a value, an expression, or contents of a referenced cell has an error of any kind.",[r("cellreference")]),ISEVEN:o("This function, Is Number Even, tests whether a value, an expression, or contents of a referenced cell is even.",[r("cellreference")]),ISLOGICAL:o("This function tests whether a value, an expression, or contents of a referenced cell is a logical (Boolean) value.",[r("cellreference")]),ISNA:o("This function, Is Not Available, tests whether a value, an expression, or contents of a referenced cell has the not available (#N/A) error value.",[r("cellreference")]),ISNONTEXT:o("This function tests whether a value, an expression, or contents of a referenced cell has any data type other than text.",[r("cellreference")]),ISNUMBER:o("This function tests whether a value, an expression, or contents of a referenced cell has numeric data.",[r("cellreference")]),ISODD:o("This function, Is Number Odd, tests whether a value, an expression, or contents of a referenced cell has numeric data.",[r("cellreference")]),ISPMT:o("This function calculates the interest paid during a specific period of an investment.",[r("rate"),r("per"),r("nper"),r("pv")]),ISREF:o("This function, Is Reference, tests whether a value, an expression, or contents of a referenced cell is a reference to another cell.",[r("cellreference")]),ISTEXT:o("This function tests whether a value, an expression, or contents of a referenced cell has text data.",[r("cellreference")]),KURT:o("This function returns the kurtosis of a data set.",[r("value1"),r("value2"),r("value3"),r("value4",!0)]),LARGE:o("This function returns the nth largest value in a data set, where n is specified.",[r("array"),r("n")]),LCM:o("This function returns the least common multiple of two numbers.",[r("number1"),r("number2")]),LEFT:o("This function returns the specified leftmost characters from a text value, and based on the number of characters you specify.",[r("mytext"),r("num_chars")]),LEN:o("This function returns the length of the number of characters in a text string.",[r("value")]),LINEST:o("This function calculates the statistics for a line.",[r("y"),r("x"),r("constant"),r("stats")]),LN:o("This function returns the natural logarithm of the specified number.",[r("value")]),LOG:o("This function returns the logarithm base Y of a number X.",[r("number"),r("base")]),LOG10:o("This function returns the logarithm base 10 of the number given.",[r("value")]),LOGEST:o("This function calculates an exponential curve that fits the data and returns an array of values that describes the curve.",[r("y"),r("x"),r("constant"),r("stats")]),LOGINV:o("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[r("prob"),r("mean"),r("stdev")]),LOGNORMDIST:o("This function returns the cumulative natural log normal distribution of x, where LN(x) is normally distributed with the specified mean and standard deviation. Analyze data that has been logarithmically transformed with this function.",[r("x"),r("mean"),r("stdev")]),LOOKUP:o("This function searches for a value and returns a value from the same location in a second area.",[r("lookupvalue"),r("lookupvector"),r("resultvector")]),LOWER:o("This function converts text to lower case letters.",[r("string")]),MATCH:o("This function returns the relative position of a specified item in a range.",[r("value1"),r("array"),r("type")]),XMATCH:o("This function returns the relative position of an item in an array. By default, an exact match is required.",[r("lookup_value"),r("lookup_array"),r("[match_mode]"),r("[search_mode]")]),XLOOKUP:o("This function searches a range or an array for a match and returns the corresponding item from a second range or array. By default, an exact match is used.",[r("lookup_value"),r("lookup_array"),r("return_array"),r("[if_not_found]"),r("[match_mode]"),r("[search_mode]")]),MAX:o("This function returns the maximum value, the greatest value, of all the values in the arguments.",[r("value1"),r("value2",!0)]),MAXA:o("This function returns the largest value in a list of arguments, including text and logical values.",[r("value1"),r("value2",!0)]),MDETERM:o("This function returns the matrix determinant of an array.",[r("array")]),MDURATION:o("This function calculates the modified Macaulay duration of a security with an assumed par value of $100.",[r("settlement"),r("maturity"),r("coupon"),r("yield"),r("frequency"),r("basis")]),MEDIAN:o("This function returns the median, the number in the middle of the provided set of numbers; that is, half the numbers have values that are greater than the median, and half have values that are less than the median.",[r("value1"),r("value2",!0)]),MID:o("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of characters you specify.",[r("text"),r("start_num"),r("num_chars")]),MIN:o("This function returns the minimum value, the least value, of all the values in the arguments.",[r("value1"),r("value2",!0)]),MINA:o("This function returns the minimum value in a list of arguments, including text and logical values.",[r("value1"),r("value2",!0)]),MINUTE:o("This function returns the minute corresponding to a specified time.",[r("time")]),MINVERSE:o("This function returns the inverse matrix for the matrix stored in an array.",[r("array")]),MIRR:o("This function returns the modified internal rate of return for a series of periodic cash flows.",[r("arrayvals"),r("payment_int"),r("income_int")]),MMULT:o("This function returns the matrix product for two arrays.",[r("array1"),r("array2")]),MOD:o("This function returns the remainder of a division operation.",[r("dividend"),r("divisor")]),MODE:o("This function returns the most frequently occurring value in a set of data.",[r("value1"),r("value2",!0)]),MONTH:o("This function returns the month corresponding to the specified date value.",[r("date")]),MROUND:o("This function returns a number rounded to the desired multiple.",[r("number"),r("multiple")]),MULTINOMIAL:o("This function calculates the ratio of the factorial of a sum of values to the product of factorials.",[r("value1"),r("value2",!0)]),MUNIT:o("The function returns the unit matrix for the specified dimension.",[r("dimension")]),N:o("This function returns a value converted to a number.",[r("value")]),NA:o("This function returns the error value #N/A that means not available.",[]),NEGBINOMDIST:o("This function returns the negative binomial distribution.",[r("x"),r("r"),r("p")]),NETWORKDAYS:o("This function returns the total number of complete working days between the start and end dates.",[r("startdate"),r("enddate"),r("holidays")]),NOMINAL:o("This function returns the nominal annual interest rate for a given effective rate and number of compounding periods per year.",[r("effrate"),r("comper")]),NORMDIST:o("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[r("x"),r("mean"),r("stdev"),r("cumulative")]),NORMINV:o("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[r("prob"),r("mean"),r("stdev")]),NORMSDIST:o("This function returns the standard normal cumulative distribution function.",[r("value")]),NORMSINV:o("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[r("prob")]),NOT:o("This function reverses the logical value of its argument.",[r("value")]),NOW:o("This function returns the current date and time.",[]),NPER:o("This function returns the number of periods for an investment based on a present value, future value, periodic payments, and a specified interest rate.",[r("rate"),r("paymt"),r("pval"),r("fval"),r("type")]),NPV:o("This function calculates the net present value of an investment by using a discount rate and a series of future payments and income.",[r("discount"),r("value1"),r("value2",!0)]),OBJECT:o("This function converts the property/expression sequence to an object.",[r("property1|properties_range1"),r("expression1|expressions_range1"),r("property2|properties_range2"),r("expression2|expressions_range2"),r("...")]),OCT2BIN:o("This function converts an octal number to a binary number.",[r("number"),r("places")]),OCT2DEC:o("This function converts an octal number to a decimal number.",[r("number")]),OCT2HEX:o("This function converts an octal number to a hexadecimal number.",[r("number"),r("places")]),ODD:o("This function rounds the specified value up to the nearest odd integer.",[r("value")]),ODDFPRICE:o("This function calculates the price per $100 face value of a security with an odd first period.",[r("settle"),r("maturity"),r("issue"),r("first"),r("rate"),r("yield"),r("redeem"),r("freq"),r("basis")]),ODDFYIELD:o("This function calculates the yield of a security with an odd first period.",[r("settle"),r("maturity"),r("issue"),r("first"),r("rate"),r("price"),r("redeem"),r("freq"),r("basis")]),ODDLPRICE:o("This function calculates the price per $100 face value of a security with an odd last coupon period.",[r("settle"),r("maturity"),r("last"),r("rate"),r("yield"),r("redeem"),r("freq"),r("basis")]),ODDLYIELD:o("This function calculates the yield of a security with an odd last period.",[r("settle"),r("maturity"),r("last"),r("rate"),r("price"),r("redeem"),r("freq"),r("basis")]),OFFSET:o("This function returns a reference to a range. The range is a specified number of rows and columns from a cell or range of cells. The function returns a single cell or a range of cells.",[r("reference"),r("rows"),r("cols"),r("height"),r("width")]),OR:o("This function calculates logical OR. It returns TRUE if any of its arguments are true; otherwise, returns FALSE if all arguments are false.",[r("argument1"),r("argument2",!0)]),PEARSON:o("This function returns the Pearson product moment correlation coefficient, a dimensionless index between -1.0 to 1.0 inclusive indicative of the linear relationship of two data sets.",[r("array_ind"),r("array_dep")]),PERCENTILE:o("This function returns the nth percentile of values in a range.",[r("array"),r("n")]),PERCENTRANK:o("This function returns the rank of a value in a data set as a percentage of the data set.",[r("array"),r("n"),r("sigdig")]),PERMUT:o("This function returns the number of possible permutations for a specified number of items.",[r("k"),r("n")]),PI:o("This function returns PI as 3.1415926536.",[]),PMT:o("This function returns the payment amount for a loan given the present value, specified interest rate, and number of terms.",[r("rate"),r("nper"),r("pval"),r("fval"),r("type")]),POISSON:o("This function returns the Poisson distribution.",[r("nevents"),r("mean"),r("cumulative")]),POWER:o("This function raises the specified number to the specified power.",[r("number"),r("power")]),PPMT:o("This function returns the amount of payment of principal for a loan given the present value, specified interest rate, and number of terms.",[r("rate"),r("per"),r("nper"),r("pval"),r("fval"),r("type")]),PRICE:o("This function calculates the price per $100 face value of a periodic interest security",[r("settlement"),r("maturity"),r("rate"),r("yield"),r("redeem"),r("frequency"),r("basis")]),PRICEDISC:o("This function returns the price per $100 face value of a discounted security.",[r("settle"),r("mature"),r("discount"),r("redeem"),r("basis")]),PRICEMAT:o("This function returns the price at maturity per $100 face value of a security that pays interest.",[r("settle"),r("mature"),r("issue"),r("rate"),r("yield"),r("basis")]),PROB:o("This function returns the probability that values in a range are between two limits.",[r("array"),r("probs"),r("lower"),r("upper")]),PRODUCT:o("This function multiplies all the arguments and returns the product.",[r("value1"),r("value2",!0)]),PROPER:o("This function capitalizes the first letter in each word of a text string.",[r("text")]),PROPERTY:o("This function returns the value of property path in object.",[r("data_expression"),r("property_path")]),PV:o("This function returns the present value of an investment based on the interest rate, number and amount of periodic payments, and future value. The present value is the total amount that a series of future payments is worth now.",[r("rate"),r("numper"),r("paymt"),r("fval"),r("type")]),QUARTILE:o("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[r("array"),r("quart")]),QUOTIENT:o("This function returns the integer portion of a division. Use this to ignore the remainder of a division.",[r("numerator"),r("denominator")]),RADIANS:o("This function converts the specified number from degrees to radians.",[r("value")]),RAND:o("This function returns an evenly distributed random number between 0 and 1.",[]),RANDBETWEEN:o("This function returns a random number between the numbers you specify.",[r("lower"),r("upper")]),RANGEBLOCKSPARKLINE:o("This function returns a rangetemplate.",[r("template_range"),r("data_expression")]),RANK:o("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[r("number"),r("array"),r("order")]),RATE:o("This function returns the interest rate per period of an annuity.",[r("nper"),r("pmt"),r("pval"),r("fval"),r("type"),r("guess")]),RECEIVED:o("This function returns the amount received at maturity for a fully invested security.",[r("settle"),r("mature"),r("invest"),r("discount"),r("basis")]),REPLACE:o("This function replaces part of a text string with a different text string, based on the number of characters you specify.",[r("old_text"),r("start_char"),r("num_chars"),r("new_text")]),REPT:o("This function repeats text a specified number of times.",[r("text"),r("number")]),RIGHT:o("This function returns the specified rightmost characters from a text value, and based on the number of characters you specify.",[r("text"),r("num_chars")]),ROMAN:o("This function converts an Arabic numeral to a Roman numeral text equivalent.",[r("number"),r("style")]),ROUND:o("This function rounds the specified value to the nearest number, using the specified number of decimal places.",[r("value"),r("places")]),ROUNDDOWN:o("This function rounds the specified number down to the nearest number, using the specified number of decimal places.",[r("value"),r("places")]),ROUNDUP:o("This function rounds the specified number up to the nearest number, using the specified number of decimal places.",[r("value"),r("places")]),ROW:o("This function returns the number of a row from a reference.",[r("reference")]),ROWS:o("This function returns the number of rows in an array.",[r("array")]),RSQ:o("This function returns the square of the Pearson product moment correlation coefficient (R-squared) through data points in known y's and known x's.",[r("array_dep"),r("array_ind")]),SEARCH:o("This function finds one text string in another text string and returns the index of the starting position of the found text.",[r("string1"),r("string2")]),SECOND:o("This function returns the seconds (0 to 59) value for a specified time.",[r("time")]),SERIESSUM:o("This function returns the sum of a power series.",[r("x"),r("n"),r("m"),r("coeff")]),SIGN:o("This function returns the sign of a number or expression.",[r("cellreference")]),SIN:o("This function returns the sine of the specified angle.",[r("angle")]),SINH:o("This function returns the hyperbolic sine of the specified number.",[r("value")]),SKEW:o("This function returns the skewness of a distribution.",[r("number1"),r("number2",!0)]),SLN:o("This function returns the straight-line depreciation of an asset for one period.",[r("cost"),r("salvage"),r("life")]),SLOPE:o("This function calculates the slope of a linear regression.",[r("array_dep"),r("array_ind")]),SMALL:o("This function returns the nth smallest value in a data set, where n is specified.",[r("array"),r("n")]),SQRT:o("This function returns the positive square root of the specified number.",[r("value")]),SQRTPI:o("This function returns the positive square root of a multiple of pi (p).",[r("multiple")]),STANDARDIZE:o("This function returns a normalized value from a distribution characterized by mean and standard deviation.",[r("x"),r("mean"),r("stdev")]),STDEVA:o("This function returns the standard deviation for a set of numbers, text, or logical values.",[r("value1"),r("value2",!0)]),STDEVP:o("This function returns the standard deviation for an entire specified population (of numeric values).",[r("value1"),r("value2",!0)]),STDEVPA:o("This function returns the standard deviation for an entire specified population, including text or logical values as well as numeric values.",[r("value1"),r("value2",!0)]),STEYX:o("This function returns the standard error of the predicted y value for each x. The standard error is a measure of the amount of error in the prediction of y for a value of x.",[r("array_dep"),r("array_ind")]),SUBSTITUTE:o("This function substitutes a new string for specified characters in an existing string.",[r("text"),r("old_piece"),r("new_piece"),r("instance")]),SUBTOTAL:o("This function calculates a subtotal of a list of numbers using a specified built-in function.",[r("functioncode"),r("value1"),r("value2",!0)]),SUM:o("This function returns the sum of cells or range of cells.",[r("value1"),r("value2",!0)]),SUMIF:o("This function adds the cells using a given criteria.",[r("array"),r("condition"),r("sumrange")]),SUMIFS:o("This function adds the cells in a range using multiple criteria.",[r("array"),r("conditionarray"),r("condition",!0)]),SUMPRODUCT:o("This function returns the sum of products of cells. Multiplies corresponding components in the given arrays, and returns the sum of those products.",[r("array1"),r("array2",!0)]),SUMSQ:o("This function returns the sum of the squares of the arguments.",[r("value1"),r("value2",!0)]),SUMX2MY2:o("This function returns the sum of the difference of the squares of corresponding values in two arrays.",[r("array_x"),r("array_y")]),SUMX2PY2:o("This function returns the sum of the sum of squares of corresponding values in two arrays.",[r("array_x"),r("array_y")]),SUMXMY2:o("This function returns the sum of the square of the differences of corresponding values in two arrays.",[r("array_x"),r("array_y")]),SYD:o("This function returns the sum-of-years' digits depreciation of an asset for a specified period.",[r("cost"),r("salvage"),r("life"),r("period")]),T:o("This function returns the text in a specified cell.",[r("value")]),TAN:o("This function returns the tangent of the specified angle.",[r("angle")]),TANH:o("This function returns the hyperbolic tangent of the specified number.",[r("value")]),TBILLEQ:o("This function returns the equivalent yield for a Treasury bill (or T-bill)",[r("settle"),r("mature"),r("discount")]),TBILLPRICE:o("This function returns the price per $100 face value for a Treasury bill (or T-bill).",[r("settle"),r("mature"),r("discount")]),TBILLYIELD:o("This function returns the yield for a Treasury bill (or T-bill).",[r("settle"),r("mature"),r("priceper")]),TDIST:o("This function returns the probability for the t-distribution.",[r("x"),r("deg"),r("tails")]),TEXT:o("This function formats a number and converts it to text.",[r("value"),r("text")]),TIME:o("This function returns the TimeSpan object for a specified time.",[r("hour"),r("minutes"),r("seconds")]),TIMEVALUE:o("This function returns the TimeSpan object of the time represented by a text string.",[r("time_string")]),TINV:o("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[r("prog"),r("deg")]),TODAY:o("This function returns the date and time of the current date.",[]),TRANSPOSE:o("This function returns a vertical range of cells as a horizontal range or a horizontal range of cells as a vertical range.",[r("array")]),TREND:o("This function returns values along a linear trend. This function fits a straight line to the arrays known x and y values. Trend returns the y values along that line for the array of specified new x values.",[r("y"),r("x"),r("newx"),r("constant")]),TRIM:o("This function removes extra spaces from a string and leaves single spaces between words.",[r("text")]),TRIMMEAN:o("This function returns the mean of a subset of data excluding the top and bottom data.",[r("array"),r("percent")]),TRUE:o("This function returns the value for logical TRUE.",[]),TRUNC:o("This function removes the specified fractional part of the specified number.",[r("value"),r("precision")]),TTEST:o("This function returns the probability associated with a t-test.",[r("array1"),r("array2"),r("tails"),r("type")]),TYPE:o("This function returns the type of value.",[r("value")]),UPPER:o("This function converts text to uppercase letters.",[r("string")]),VALUE:o("This function converts a text string that is a number to a numeric value.",[r("text")]),VAR:o("This function returns the variance based on a sample of a population, which uses only numeric values.",[r("value1"),r("value2",!0)]),VARA:o("This function returns the variance based on a sample of a population, which includes numeric, logical, or text values.",[r("value1"),r("value2",!0)]),VARP:o("This function returns variance based on the entire population, which uses only numeric values.",[r("value1"),r("value2",!0)]),VARPA:o("This function returns variance based on the entire population, which includes numeric, logical, or text values.",[r("value1"),r("value2",!0)]),VDB:o("This function returns the depreciation of an asset for any period you specify using the variable declining balance method.",[r("cost"),r("salvage"),r("life"),r("start"),r("end"),r("factor"),r("switchnot")]),VLOOKUP:o("This function searches for a value in the leftmost column and returns a value in the same row from a column you specify.",[r("value"),r("array"),r("colindex"),r("approx")]),WEEKDAY:o("This function returns the number corresponding to the day of the week for a specified date.",[r("date"),r("type")]),WEEKNUM:o("This function returns a number that indicates the week of the year numerically.",[r("date"),r("weektype")]),WEIBULL:o("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[r("x"),r("alpha"),r("beta"),r("cumulative")]),WORKDAY:o("This function returns the number of working days before or after the starting date.",[r("startdate"),r("numdays"),r("holidays")]),XIRR:o("This function calculates the internal rate of return for a schedule of cash flows that may not be periodic.",[r("values"),r("dates"),r("guess")]),XNPV:o("This function calculates the net present value for a schedule of cash flows that may not be periodic.",[r("rate"),r("values"),r("dates")]),YEAR:o("This function returns the year as an integer for a specified date.",[r("date")]),YEARFRAC:o("This function returns the fraction of the year represented by the number of whole days between the start and end dates.",[r("startdate"),r("enddate"),r("basis")]),YIELD:o("This function calculates the yield on a security that pays periodic interest.",[r("settle"),r("maturity"),r("rate"),r("price"),r("redeem"),r("frequency"),r("basis")]),YIELDDISC:o("This function calculates the annual yield for a discounted security.",[r("settle"),r("maturity"),r("price"),r("redeem"),r("basis")]),YIELDMAT:o("This function calculates the annual yield of a security that pays interest at maturity.",[r("settle"),r("maturity"),r("issue"),r("issrate"),r("price"),r("basis")]),ZTEST:o("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[r("array"),r("x"),r("sigma")]),HBARSPARKLINE:o("This function returns a data set used for representing a Hbar sparkline",[r("value"),r("colorScheme"),r("axisVisible"),r("barHeight")]),VBARSPARKLINE:o("This function returns a data set used for representing a Vbar sparkline",[r("value"),r("colorScheme"),r("axisVisible"),r("barWidth")]),VARISPARKLINE:o("This function returns a data set used for representing a variance sparkline",[r("variance"),r("reference"),r("mini"),r("maxi"),r("mark"),r("tickunit"),r("legend"),r("colorPositive"),r("colorNegative"),r("vertical")]),PIESPARKLINE:o("This function returns a data set used for representing a pie sparkline",[r("range|percentage"),r("color",!0)]),AREASPARKLINE:o("This function returns a data set used for representing a area sparkline",[r("points"),r("mini"),r("maxi"),r("line1"),r("line2"),r("colorPositive"),r("colorNegative")]),SCATTERSPARKLINE:o("This function returns a data set used for representing a scatter sparkline",[r("points1"),r("points2"),r("minX"),r("maxX"),r("minY"),r("maxY"),r("hLine"),r("vLine"),r("xMinZone"),r("xMaxZone"),r("yMinZone"),r("yMaxZone"),r("tags"),r("drawSymbol"),r("drawLines"),r("color1"),r("color2"),r("dash")]),LINESPARKLINE:o("This function returns a data set used for representing a line sparkline",[r("data"),r("dataOrientation"),r("dateAxisData"),r("dateAxisOrientation"),r("setting")]),COLUMNSPARKLINE:o("This function returns a data set used for representing a column sparkline",[r("data"),r("dataOrientation"),r("dateAxisData"),r("dateAxisOrientation"),r("setting")]),WINLOSSSPARKLINE:o("This function returns a data set used for representing a win/loss sparkline",[r("data"),r("dataOrientation"),r("dateAxisData"),r("dateAxisOrientation"),r("setting")]),BULLETSPARKLINE:o("This function returns a data set used for representing a bullet sparkline",[r("measure"),r("target"),r("maxi"),r("good"),r("bad"),r("forecast"),r("tickunit"),r("colorScheme"),r("vertical"),r("measureColor"),r("targetColor"),r("maxiColor"),r("goodColor"),r("badColor"),r("forecastColor"),r("allowMeasureOverMaxi"),r("barSize")]),SPREADSPARKLINE:o("This function returns a data set used for representing a spread sparkline",[r("points"),r("showAverage"),r("scaleStart"),r("scaleEnd"),r("style"),r("colorScheme"),r("vertical")]),STACKEDSPARKLINE:o("This function returns a data set used for representing a stacked sparkline",[r("points"),r("colorRange"),r("labelRange"),r("maximum"),r("targetRed"),r("targetGreen"),r("targetBlue"),r("tragetYellow"),r("color"),r("highlightPosition"),r("vertical"),r("textOrientation"),r("textSize")]),BOXPLOTSPARKLINE:o("This function returns a data set used for representing a boxplot sparkline",[r("points"),r("boxPlotClass"),r("showAverage"),r("scaleStart"),r("scaleEnd"),r("acceptableStart"),r("acceptableEnd"),r("colorScheme"),r("style"),r("vertical")]),CASCADESPARKLINE:o("This function returns a data set used for representing a cascade sparkline",[r("pointsRange"),r("pointIndex"),r("labelsRange"),r("minimum"),r("maximum"),r("colorPositive"),r("colorNegative"),r("vertical"),r("itemTypeRange"),r("colorTotal")]),PARETOSPARKLINE:o("This function returns a data set used for representing a pareto sparkline",[r("points"),r("pointIndex"),r("colorRange"),r("target"),r("target2"),r("highlightPosition"),r("label"),r("vertical"),r("targetColor"),r("target2Color"),r("labelColor"),r("barSize")]),MONTHSPARKLINE:o("This function returns a data set used for representing a month sparkline",[r("year"),r("month"),r("dataRange"),r("emptyColor"),r("startColor"),r("middleColor"),r("endColor")]),YEARSPARKLINE:o("This function returns a data set used for representing a year sparkline",[r("year"),r("dataRange"),r("emptyColor"),r("startColor"),r("middleColor"),r("endColor")]),"CEILING.PRECISE":o("This function rounds a number up to the nearest integer or to the nearest multiple of a specified value.",[r("number"),r("signif")]),"COVARIANCE.S":o("This function returns the sample covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[r("array1"),r("array2")]),"FLOOR.PRECISE":o("This function rounds a number down to the nearest integer or to the nearest multiple of a specified value.",[r("number"),r("signif")]),"PERCENTILE.EXC":o("This function returns the nth percentile of values in a range.",[r("array"),r("n")]),"QUARTILE.EXC":o("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[r("array"),r("quart")]),"RANK.AVG":o("This function returns the rank of a number in a set of numbers. If some values have the same rank, it will return the average rank.",[r("number"),r("array"),r("order")]),"MODE.MULT":o("This function returns the most frequently occurring vertical array or the most frequently occurring value in a set of data.",[r("number1"),r("number2",!0)]),"STDEV.P":o("This function returns the standard deviation for an entire specified population (of numeric values).",[r("value1"),r("value2",!0)]),"VAR.P":o("This function returns variance based on the entire population, which uses only numeric values.",[r("value1"),r("value2",!0)]),"COVARIANCE.P":o("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[r("array1"),r("array2")]),"MODE.SNGL":o("This function returns the most frequently occurring value in a set of data.",[r("value1"),r("value2",!0)]),"PERCENTILE.INC":o("This function returns the nth percentile of values in a range.",[r("array"),r("n")]),"QUARTILE.INC":o("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[r("array"),r("quart")]),"RANK.EQ":o("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[r("number"),r("array"),r("order")]),STDEV:o("This function returns standard deviation is estimated based on a sample.",[r("number1"),r("number2",!0)]),"STDEV.S":o("This function returns standard deviation is estimated based on a sample.",[r("number1"),r("number2",!0)]),"VAR.S":o("This function returns the variance based on a sample of a population, which uses only numeric values.",[r("value1"),r("value2",!0)]),"BETA.INV":o("This function calculates the inverse of the cumulative beta distribution function.",[r("prob"),r("alpha"),r("beta"),r("lower"),r("upper")]),"BINOM.DIST":o("This function calculates the individual term binomial distribution probability.",[r("x"),r("n"),r("p"),r("cumulative")]),"BINOM.INV":o("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[r("n"),r("p"),r("alpha")]),"CHISQ.DIST.RT":o("This function calculates the one-tailed probability of the chi-squared distribution.",[r("value"),r("deg")]),"CHISQ.INV.RT":o("This function calculates the inverse of the one-tailed probability of the chi-squared distribution.",[r("prob"),r("deg")]),"CHISQ.TEST":o("This function calculates the test for independence from the chi-squared distribution.",[r("obs_array"),r("exp_array")]),"CONFIDENCE.NORM":o("This function returns confidence interval for a population mean.",[r("alpha"),r("stdev"),r("size")]),"EXPON.DIST":o("This function returns the exponential distribution or the probability density.",[r("value"),r("lambda"),r("cumulative")]),"F.DIST.RT":o("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[r("value"),r("degnum"),r("degden")]),"F.INV.RT":o("This function returns the inverse of the F probability distribution.",[r("p"),r("degnum"),r("degden")]),"F.TEST":o("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[r("array1"),r("array2")]),"GAMMA.DIST":o("This function returns the gamma distribution.",[r("x"),r("alpha"),r("beta"),r("cumulative")]),"GAMMA.INV":o("This function returns the inverse of the gamma cumulative distribution.",[r("p"),r("alpha"),r("beta")]),"LOGNORM.INV":o("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[r("prob"),r("mean"),r("stdev")]),"NORM.DIST":o("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[r("x"),r("mean"),r("stdev"),r("cumulative")]),"NORM.INV":o("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[r("prob"),r("mean"),r("stdev")]),"NORM.S.INV":o("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[r("prob")]),"PERCENTRANK.INC":o("This function returns the rank of a value in a data set as a percentage of the data set.",[r("array"),r("n"),r("signif")]),"POISSON.DIST":o("This function returns the Poisson distribution.",[r("nevents"),r("mean"),r("cumulative")]),"T.INV.2T":o("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[r("prog"),r("deg")]),"T.TEST":o("This function returns the probability associated with a t-test.",[r("array1"),r("array2"),r("tails"),r("type")]),"WEIBULL.DIST":o("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[r("x"),r("alpha"),r("beta"),r("cumulative")]),"Z.TEST":o("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[r("array"),r("x"),r("sigma")]),"T.DIST.RT":o("This function returns the right-tailed t-distribution.",[r("x"),r("deg")]),"T.DIST.2T":o("This function returns the two-tailed t-distribution.",[r("x"),r("deg")]),"ISO.CEILING":o("This function returns a number up to the nearest integer or to the nearest multiple of significance, regardless of sign of significance.",[r("number"),r("signif")]),"BETA.DIST":o("This function returns the beta distribution.",[r("x"),r("alpha"),r("beta"),r("cumulative"),r("lower"),r("upper")]),"GAMMALN.PRECISE":o("This function returns the natural logarithm of the gamma function.",[r("value")]),"ERF.PRECISE":o("This function returns the error function.",[r("lowerlimit")]),"ERFC.PRECISE":o("This function returns the complementary ERF function.",[r("lowerlimit")]),"PERCENTRANK.EXC":o("This function returns the percentage rank(0..1, exclusive) of a value in a data set.",[r("array"),r("n"),r("signif")]),"HYPGEOM.DIST":o("This function returns the hypergeometric distribution.",[r("x"),r("n"),r("M"),r("N"),r("cumulative")]),"LOGNORM.DIST":o("This function returns the log normal distribution of x.",[r("x"),r("mean"),r("stdev"),r("cumulative")]),"NEGBINOM.DIST":o("This function returns the negative binomial distribution.",[r("x"),r("r"),r("p"),r("cumulative")]),"NORM.S.DIST":o("This function returns the standard normal distribution.",[r("z"),r("cumulative")]),"T.DIST":o("This function returns the t-distribution.",[r("x"),r("deg"),r("cumulative")]),"F.DIST":o("This function returns the F probability distribution.",[r("x"),r("degnum"),r("degden"),r("cumulative")]),"CHISQ.DIST":o("This function returns the chi-squared distribution.",[r("x"),r("deg"),r("cumulative")]),"F.INV":o("This function returns the inverse of the F probability distribution.",[r("probability"),r("degnum"),r("degden")]),"T.INV":o("This function returns the left-tailed inverse of the t-distribution.",[r("probability"),r("deg")]),"CHISQ.INV":o("This function returns the inverse of left-tailed probability of the chi-squared distribution.",[r("probability"),r("deg")]),"CONFIDENCE.T":o("This function returns the confidence interval for a Student's t distribution.",[r("alpha"),r("stdev"),r("size")]),"NETWORKDAYS.INTL":o("This function returns the number of workdays between two dates using arguments to indicate holidays and weekend days.",[r("startdate"),r("enddate"),r("weekend"),r("holidays")]),"WORKDAY.INTL":o("This function returns the serial number of the date before or after a number of workdays with custom weekend parameters. These parameters indicate weekend days and holidays.",[r("startdate"),r("numdays"),r("weekend"),r("holidays")]),REFRESH:o("This function decides how to re-calculate the formula. Can use the evaluateMode argument to specific the formula re-calculate on the reference value changed, evaluate once , re-calculate or interval.",[r("formula"),r("evaluateMode"),r("interval")]),DAYS:o("This function returns the number of days between two dates.",[r("startdate"),r("enddate")]),ISOWEEKNUM:o("This function returns the number of the ISO week number of the year for a given date.",[r("date")]),BITAND:o('This function returns a bitwise "AND" of two numbers.',[r("number1"),r("number2")]),BITLSHIFT:o('This function returns a bitwise "OR" of two numbers.',[r("number1"),r("number2")]),BITOR:o('This function returns a bitwise "OR" of two numbers.',[r("number1"),r("number2")]),BITRSHIFT:o('This function returns a bitwise "OR" of two numbers.',[r("number1"),r("number2")]),BITXOR:o('This function returns a bitwise "XOR" of two numbers.',[r("number1"),r("number2")]),IMCOSH:o("This function returns the hyperbolic cosine of a complex number in x+yi or x+yj text format.",[r("complexnum")]),IMCOT:o("This function returns the cotangent of a complex number in x+yi or x+yj text format.",[r("complexnum")]),IMCSC:o("This function returns the cosecant of a complex number in x+yi or x+yj text format.",[r("complexnum")]),IMCSCH:o("This function returns the hyperbolic cosecant of a complex number in x+yi or x+yj text format.",[r("complexnum")]),IMSEC:o("This function returns the secant of a complex number in x+yi of x+yj text format.",[r("complexnum")]),IMSECH:o("This function returns the hyperbolic secant of a complex number in x+yi or x+yj text format.",[r("complexnum")]),IMSINH:o("This function returns the hyperbolic sine of a complex number in x+yi of x+yj text format.",[r("complexnum")]),IMTAN:o("This function returns the tangent of a complex number in x+yi or x+yj text format.",[r("complexnum")]),PDURATION:o("This function returns the number of periods required by an investment to reach a specified value.",[r("rate"),r("pval"),r("fval")]),RRI:o("This function returns an equivalent interest rate for the growth of an investment.",[r("nper"),r("pval"),r("fval")]),ISFORMULA:o("This function tests whether contains a formula of a referenced cell.",[r("cellreference")]),IFNA:o("This function returns the value you specify if the formula returns the #N/A error value, otherwise returns the result of the formula.",[r("value"),r("value_if_na")]),IFS:o("This function checks whether one or more conditions are met and returns a value that corresponds to the first TRUE condition.",[r("valueTest1"),r("valueTrue1",!0)]),SWITCH:o("This function evaluates one value for a list of values, and returns the result corresponding to the first matching value, otherwise returns the default value",[r("convertvalue"),r("matchvalue"),r("matchtrue"),r("matchfalse")]),XOR:o("This function returns a logical exclusive or of all arguments.",[r("logical",!0)]),AREAS:o("This function returns the number of areas in a reference.",[r("reference")]),FORMULATEXT:o("This function returns a formula as a string.",[r("reference")]),HYPERLINK:o("This function creates a shortcut or jump that opens a document stored on a network server, an intranet, or the Internet.",[r("link_location"),r("friendly_name")]),ACOT:o("This function calculates the inverse arccotangent of a number.",[r("value")]),ACOTH:o("This function calculates the inverse hyperbolic arccotangent of a number.",[r("value")]),ARABIC:o("This function converts a Roman numeral text to an Arabic numeral equivalent.",[r("text")]),BASE:o("This function converts a number into a text representation with the given radix (base).",[r("number"),r("radix"),r("minLength")]),"CEILING.MATH":o("This function round  a number up to the nearest integer or to the nearest multiple of significance.",[r("value"),r("signif"),r("mode")]),COMBINA:o("This function calculates the number of possible combinations with repetitions for a specified number of items.",[r("number"),r("number_choosen")]),COT:o("This function returns the cotangent of the specified angle.",[r("angle")]),COTH:o("This function returns the hyperbolic cotangent of the specified number.",[r("value")]),CSC:o("This function returns the cosecant of the specified angle.",[r("angle")]),CSCH:o("This function returns the hyperbolic cosecant of the specified number.",[r("value")]),DECIMAL:o("This function converts a text representation of a number in a given base into a decimal number.",[r("text"),r("radix")]),"FLOOR.MATH":o("This function round a number down to the nearest integer or to the nearest multiple of significance.",[r("value"),r("signif"),r("mode")]),SEC:o("This function returns the secant of the specified angle.",[r("angle")]),SECH:o("This function returns the hyperbolic secant of the specified value.",[r("value")]),"BINOM.DIST.RANGE":o("This function calculates the probability of a trial result using a binomial distribution.",[r("x"),r("n"),r("p"),r("cumulative")]),GAMMA:o("This function returns the gamma function value.",[r("number")]),MAXIFS:o("This function returns the maximum value among cells specified by a given set of conditions or criteria.",[r("array"),r("conditionarray"),r("condition",!0)]),GAUSS:o("This function calculates the probability that a member of a standard normal population will fall between the mean and z standard deviations from the mean.",[r("number")]),MINIFS:o("This function returns the minimum value among cells specified by a given set of conditions or criteria.",[r("array"),r("conditionarray"),r("condition",!0)]),PERMUTATIONA:o("This function returns the number of permutations for a given number of object that can be selected from the total objects.",[r("k"),r("n")]),PHI:o("This function returns the value of the density function for a standard normal distribution.",[r("value")]),"SKEW.P":o("This function returns the skewness of a distribution base on a poopulation: a characterization of the degree of asymmetry of a distribution around its mean.",[r("number1"),r("number2",!0)]),BAHTTEXT:o('This function converts a number to Thai text and adds a suffix of "Baht"',[r("number")]),CONCAT:o('This function combines multiple text strings or numbers into one text string, the function will stay available for compatibility with "CONCATENATE" function.',[r("text1"),r("text2",!0)]),FINDB:o("This function finds one text value within another and returns the text value's position in the text you searched, and counts each double-byte characte as 2 when set DBCS as the default language.",[r("findtext"),r("intext"),r("start")]),LEFTB:o("This function returns the specified leftmost characters from a text value, and based on the number of bytes you specify.",[r("mytext"),r("num_bytes")]),LENB:o("This function returns the length of the number of bytes in a text string.",[r("value")]),MIDB:o("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of bytes you specify.",[r("text"),r("start_num"),r("num_bytes")]),REPLACEB:o("This function replaces part of a text string with a different text string, based on the number of bytes you specify.",[r("old_text"),r("start_byte"),r("num_bytes"),r("new_text")]),RIGHTB:o("This function returns the specified rightmost characters from a text value, and based on the number of bytes you specify.",[r("text"),r("num_bytes")]),SEARCHB:o("This function finds one text string in another text string and returns the index of the starting position of the found text, and counts each double-byte characte as 2 when set DBCS as the default language.",[r("string1"),r("string2")]),TEXTJOIN:o("This function combines multiple ranges and/or strings into one text, and the text includes a delimiter you specify between each text value.",[r("delimiter"),r("ignore_empty"),r("text1"),r("text2",!0)]),UNICHAR:o("This function returns the Unicode character of a given numeric reference.",[r("number")]),UNICODE:o("This function returns the number corresponding to the first character of the text.",[r("text")]),ENCODEURL:o("This function returns a URL-encoded string.",[r("text")]),BC_QRCODE:o("This function returns a data set for representing a QRCode",[r("value"),r("color"),r("backgroundColor"),r("errorCorrectionLevel"),r("model"),r("version"),r("mask"),r("connection"),r("connectionNo"),r("charCode"),r("charset"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_EAN13:o("This function returns a data set for representing a EAN13.",[r("value"),r("color"),r("backgroundColor"),r("showLabel"),r("labelPosition"),r("addOn"),r("addOnLabelPosition"),r("fontFamily"),r("fontStyle"),r("fontWeight"),r("textDecoration"),r("textAlign"),r("fontSize"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_EAN8:o("This function returns a data set for representing a EAN8.",[r("value"),r("color"),r("backgroundColor"),r("showLabel"),r("labelPosition"),r("fontFamily"),r("fontStyle"),r("fontWeight"),r("textDecoration"),r("textAlign"),r("fontSize"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_CODABAR:o("This function returns a data set for representing a CODABAR.",[r("value"),r("color"),r("backgroundColor"),r("showLabel"),r("labelPosition"),r("checkDigit"),r("nwRatio"),r("fontFamily"),r("fontStyle"),r("fontWeight"),r("textDecoration"),r("textAlign"),r("fontSize"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_CODE39:o("This function returns a data set for representing a CODE39.",[r("value"),r("color"),r("backgroundColor"),r("showLabel"),r("labelPosition"),r("labelWithStartAndStopCharacter"),r("checkDigit"),r("nwRatio"),r("fullASCII"),r("fontFamily"),r("fontStyle"),r("fontWeight"),r("textDecoration"),r("textAlign"),r("fontSize"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_CODE93:o("This function returns a data set for representing a CODE93.",[r("value"),r("color"),r("backgroundColor"),r("showLabel"),r("labelPosition"),r("checkDigit"),r("fullASCII"),r("fontFamily"),r("fontStyle"),r("fontWeight"),r("textDecoration"),r("textAlign"),r("fontSize"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_CODE128:o("This function returns a data set for representing a CODE128.",[r("value"),r("color"),r("backgroundColor"),r("showLabel"),r("labelPosition"),r("codeSet"),r("fontFamily"),r("fontStyle"),r("fontWeight"),r("textDecoration"),r("textAlign"),r("fontSize"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_GS1_128:o("This function returns a data set for representing a GS1_128.",[r("value"),r("color"),r("backgroundColor"),r("showLabel"),r("labelPosition"),r("fontFamily"),r("fontStyle"),r("fontWeight"),r("textDecoration"),r("textAlign"),r("fontSize"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_CODE49:o("This function returns a data set for representing a CODE49.",[r("value"),r("color"),r("backgroundColor"),r("showLabel"),r("labelPosition"),r("grouping"),r("groupNo"),r("fontFamily"),r("fontStyle"),r("fontWeight"),r("textDecoration"),r("textAlign"),r("fontSize"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_PDF417:o("This function returns a data set for representing a PDF417.",[r("value"),r("color"),r("backgroundColor"),r("errorCorrectionLevel"),r("rows"),r("columns"),r("compact"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_DATAMATRIX:o("This function returns a data set for representing a DATAMATRIX.",[r("value"),r("color"),r("backgroundColor"),r("eccMode"),r("ecc200SymbolSize"),r("ecc200EncodingMode"),r("ecc00_140SymbolSize"),r("structuredAppend"),r("structureNumber"),r("fileIdentifier"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),FILTER:o("This function filter a range or array.",[r("array"),r("include"),r("if_empty")]),RANDARRAY:o("This function returns an array of random numbers.",[r("rows"),r("columns"),r("min"),r("max"),r("whole_number")]),SEQUENCE:o("This function returns a sequence of numbers.",[r("rows"),r("columns"),r("start"),r("step")]),SINGLE:o("This function returns a single value when given a value, range or array.",[r("value")]),SORT:o("This function sorts a range or array.",[r("array"),r("sort_index"),r("sort_order"),r("by_col")]),SORTBY:o("This function sorts a range or array based on the values in a corresponding range or array.",[r("array"),r("by_array1"),r("sort_order1"),r("by_array2"),r("sort_order2"),r("...")]),UNIQUE:o("This function returns the unique values from a range or array.",[r("array"),r("by_col"),r("occurs_once")]),LET:o("This function assigns calculation results to names. Useful for storing intermediate calculations and values by defining names inside a formula. These names only apply within the scope of the LET function.",[r("name1"),r("name_value1"),r("calculation_or_name2"),r("[name_value2, ...")])},Fbx_Summary:"Summary",Fbx_TableName_Description:"Table name for ",Fbx_CustomName_Description:"Custom name for ",B2:{All:{name:"#All",description:"Returns the entire contents of the table, or specified table columns including column headers, data and total rows."},Data:{name:"#Data",description:"Returns the data cells of the table or specified table columns."},Headers:{name:"#Headers",description:"Returns the columns headers for the table, or specified table columns."},Totals:{name:"#Totals",description:"Returns the total rows for the table or specified table columns."},thisRow:{name:"#This Row",description:"This row."}}}},"./src/evaluator.ts":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function O(e,t,n,o){return{row:e,col:t,rowCount:n,colCount:o}}function F(e,t){return e&&t?e.row===t.row&&e.col===t.col:e===t}function P(e){var t,n;for(n=0;n<e.oi.length;n++)(t=e.oi[n]).v5=!1,t.oi.length>0&&P(t)}function H(e){var t,n=!0,o=e;return e&&e.getValue&&((t=d(e,0,!1,!1)).isError?o=t[0]:1===t.rowCount&&1===t.colCount?o=t[0][0]:(o=t,n=!1)),{value:o,success:n}}function B(e,t,n){return p(t)?t:p(n)?n:e<=2?function(e,t,n){var o,i,a,s,l,u,c,f;if(!t)return 0;if((o=H(t)).success)return L(e,o.value);if(n){for(i=[],a=o.value,s=a.rowCount,l=a.colCount,u=0;u<s;u++)for(c=i[u]=[],f=0;f<l;f++)c[f]=L(e,a[u][f]);return new r.CalcArray(i)}}(e,t,n):e<=14?function(e,t,n){var o,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b;if(o=e<=7?L:8===e?z:V,i=H(t),a=H(n),i.success&&a.success)return o(e,i.value,a.value);if(t=i.value,n=a.value,s=i.success?-1:t.rowCount,l=i.success?-1:t.colCount,u=a.success?-1:n.rowCount,c=a.success?-1:n.colCount,f=-1,h=-1,i.success||a.success)i.success?(f=u,h=c):(f=s,h=l);else{if(1!==s&&1!==u&&s!==u||1!==l&&1!==c&&l!==c)return C;f=1===s?u:s,h=1===l?c:l}for(p=[],d=0;d<f;d++)for(p[d]=[],g=0;g<h;g++)!i.success&&(1!==s&&s<f||1!==l&&l<h)||!a.success&&(1!==u&&u<f||1!==c&&c<h)?p[d][g]=C:(m=1===s?0:d,y=1===l?0:g,v=1===u?0:d,b=1===c?0:g,p[d][g]=o(e,i.success?t:t[m][y],a.success?n:n[v][b]));return new r.CalcArray(p)}(e,t,n):function(e,t,n){var o,i,a,s,l,u,h,p,d,g,m,y,b;if(!t||!n||(1!==t.getRangeCount()||1!==n.getRangeCount())&&16!==e||t.endSource||n.endSource)return v;if(!(o=t.getSource())||o!==n.getSource())return v;if(16===e)i=t._identities.concat(n._identities);else{if(a=15===e?c:f,s=15===e?f:c,l=t.getRow(0),u=t.getColumn(0),h=n.getRow(0),p=n.getColumn(0),d=a(l,h),g=a(u,p),m=s(l+t.getRowCount(0),h+n.getRowCount(0))-d,y=s(u+t.getColumnCount(0),p+n.getColumnCount(0))-g,m<1||y<1)return r.Errors.Null;i=[O(d,g,m,y)]}return(b=new r.CalcReference(o,i)).ck=t.ck||n.ck,b}(e,t,n)}function L(e,t,n){var i,a,s,l;function c(e){return"string"==typeof e&&0===e.trim().length}if(c(t)||c(n))return v;if(!h(t,i={value:0}))return 0===e&&"string"==typeof t||t instanceof r.CalcError?t:v;if(a=i.value,n!==u){if(!h(n,i))return n instanceof r.CalcError?n:v;s=i.value}else s=0;return 0===e?a:1===e?-a:2===e?a/100:3===e?r.Zh.Yh(a,-s)?0:a+s:4===e?r.Zh.Yh(a,s)?0:a-s:5===e?o.Common.o.Lma(a*s,r.Functions.CALC_PRECISION||15):6===e?s?a/s:w:7===e?!a&&s<0?w:0===a&&0===s?x:(l=r.Functions.MathHelper.YDc(a,s))===Number.POSITIVE_INFINITY||l===Number.NEGATIVE_INFINITY||isNaN(l)?x:l:void 0}function z(e,t,n){if(8===e)return p(t)?t:p(n)?n:r.Convert.bc(t)+r.Convert.bc(n)}function V(e,t,n){var o=i.gOb(t,n,!1);return p(o)?o:9===e&&0===o||10===e&&0!==o||11===e&&o<0||12===e&&o<=0||13===e&&o>0||14===e&&o>=0}function G(e,t){var n,o,i,a=!0;switch(t.Hi){case 0:n=R(e),o=!0;break;case 1:n=parseFloat(e),o=!0;break;case 2:n=k(e),o=!0;break;case 3:n=parseInt(e,10),o=!0;break;case 4:(n=d(e,t.Ii,t.Ji||!1,t.Ki||!1,t.Li||!1,t.Mi,t.xTa,t.hOb)).isError&&(n=n[0],a=!1),n.isConvertError&&(n=v,a=!1);break;case 5:n=E(e),t.Ni&&""===n&&(n=v,a=!1);break;case 6:D(e,i={value:l})?n=i.value:(n=v,a=!1);break;case 7:n=j(e);break;case 8:!(n=r.Functions.Wi(e))||t.Oi&&0===n.Pi()&&0===n.Qi()?(n=r.Errors.Number,a=!1):n={Ri:n.Pi(),Si:n.Qi()};break;default:n=e}return o&&isNaN(n)&&(n=v,a=!1),{Ti:n,Ei:a}}function W(e,t,n){var o,i,a,s,l;for(Array.isArray(t)||(t=[t]),o=e.Ti,i=0;i<t.length;i++)if(s=(a=t[i].split(" "))[0],l=parseInt(a[1],10),"<"===s&&o<l||">"===s&&o>l||"<="===s&&o<=l||">="===s&&o>=l||"="===s&&o===l||"!="===s&&o!==l||"checkLength"===s&&o.length>l)return e.Ti=n===u?r.Errors.Number:n,void(e.Ei=!1)}function U(e,t){var n,o,i,a,s,l=[];if(!t)return{Di:e,Ei:!0};if(t.Xi)for(i=0;i<e.length;i++)l.push(t);else l=Array.isArray(t)?t:[t];for(o=0;o<l.length;o++){if((a=l[o]).Yi&&!e[o])throw r.sR().Exp_ArgumentNull;if(s=e[o]!==u){if(n=G(e[o],a),a.aj&&W(n,a.aj,a.bj),!n.Ei)break;e[o]=a.Zi?{$i:s,Qb:n.Ti}:n.Ti}else e[o]=a.Zi?{$i:s,Qb:a._i}:a._i}return n?{Di:e,Ei:n.Ei,Fi:n.Ti}:void 0}Object.defineProperty(t,"__esModule",{value:!0}),o=n("Common"),r=n("./src/calc.common.ts"),i=n("./src/calc.common.ts"),a=n("./src/calc.ts"),s=o.Common.j.Fa,l=null,u=void 0,Math.pow,c=Math.min,f=Math.max,h=r.Convert.Th,p=r.Convert.vf,d=r.Convert.Ph,g=r.Convert.Ca,m=r.Convert._isReference,y=r.Errors.Reference,v=r.Errors.Value,b=r.Errors.Name,C=r.Errors.NotAvailable,w=r.Errors.DivideByZero,x=r.Errors.Number,A=function(){function e(e,t,n,o){var r,i,a=[];for(r=4;r<arguments.length;r++)a[r-4]=arguments[r];this.si=0,this.ti=0,this.ui=0,(i=this).source=e,i.arrayFormulaMode=!!n,i.identity=t||i.$Ab(0,0),i.arrayIdentity=o,i.row=o?o.row:i.identity.row||0,i.column=o?o.col:i.identity.col||0,i.rowOffset=o?i.identity.row-o.row:i.row,i.columnOffset=o?i.identity.col-o.col:i.column}return e.prototype.$Ab=function(e,t){return{row:e,col:t}},e.prototype.fga=function(e){return e===r.BangSource?this.source:e},e.prototype.getValue=function(e,t){return e?this.fga(e).getValue(t):y},e.prototype.getReference=function(e,t){return e?this.fga(e).getReference(t):y},e.prototype.getSheetRangeReference=function(e){return e&&e.source&&e.endSource?this.fga(e.source).getSheetRangeReference(e):y},e.prototype.getFunction=function(e){return this.source?this.source.getCustomFunction(e):l},e.prototype.getName=function(e){var t,n=this,o=n.source?n.source.getCustomName(e):l;return!o&&n.source&&(o=(t=n.source.Cf().getGlobalSourceModel())&&t.getSource().getCustomName(e)),o},e.prototype.getField=function(e){return this.source?this.source.getField(e):l},e.prototype.vi=function(){return this.ui>0},e.prototype.wi=function(){this.ui++},e.prototype.xi=function(){this.ui--},e.prototype.SetAsyncResult=function(e,t){this.source.Cf().lh.SetAsyncResult(e,t)},e.prototype.cloneFrom=function(e){this.acceptsReference=e.acceptsReference,this.arrayFormulaMode=e.arrayFormulaMode},e}(),t.EvaluateContext=A,r.CalcSource.prototype.getEvaluatorContext=function(e,t,n){return new A(this,e,t,n)},M=function(){function e(e,t){this.id=e.si++,this.ctx=e,this.row=e.row+(e.arrayFormulaMode&&e.rowOffset||0),this.col=e.column+(e.arrayFormulaMode&&e.columnOffset||0),this.node=t}return e.prototype.setAsyncResult=function(e){this.node.Fi=e,this.node.v5=!0,this.ctx.SetAsyncResult(this,e),this.ctx.source.refresh()},e.prototype.getFormula=function(){return this.ctx.source.getCalcService().unparse(this.ctx.source,this.expression,this.row,this.col)},e}(),t.AsyncEvaluateContext=M,S=function(e){function t(t,n,o,r,i,a,s,u){var c=e.call(this,t,isNaN(u)?l:{row:s,col:u},n,isNaN(a)?l:{row:o,col:r,rowCount:i,colCount:a})||this,f=t.Cf().getGlobalSourceModel(t);return c.yi=f&&f.getSource(),c}return _(t,e),t.prototype.getName=function(e){return this.yi?this.yi.getCustomName(e):l},t}(A),t.GloableEvaluateContext=S,T=function(){function e(e){this.service=e,this.asyncManager=new I(this)}return e.prototype.evaluateExpression=function(e,t,n,i,a){var s,c,f=void 0===e.type&&e.Lf?e.Lf:e,h=this.evaluate(f,t,!!i,!!a);return h&&h.pause?h:h===u||h===l?!1===n?h:0:((g(h)&&!i||m(h)&&!a)&&(h=this.getOneValue(t,h)),s=15,"number"==typeof h&&h>-10&&h<10&&(((c=""+h).indexOf("000000000000")>1||c.indexOf("999999999999")>1)&&(s=14)),o.Common.o.Lma(h,r.Functions.CALC_PRECISION||s))},e.prototype.evaluate=function(e,t,n,o){var i,a,s,c;if(!e)throw r.sR().Exp_ExprIsNull;if(void 0===e.type){if(e._error)return e;e.Lf&&(e=e.Lf)}for(;10===e.type;)e=e.value;if(i=this,s=l,12===e.type?(s=e.needExpendIndexs,e=e.value):t.Exb&&(n=!0,s=[]),(c=e.type)>=2&&c<=6)a=i.evaluateConst(e,t,n);else if(1===c||13===c||33===c)a=i.evaluateReference(e,t,o,n);else if(8===c)a=i.evaluateName(e,t,n,o);else if(e&&100===e.type)a=i.evaluateLocalName(e,t,n,o);else if(9!==c||e.value2){if(9===c)a=i.evaluateBinaryOperation(e,t,n,o,s);else if(7===c){if(e.QDc&&t.NDc&&((a=i.evaluateBranchFunction(e,t,n,o,s))&&a.pause))return a;a=i.evaluateFunction(e,t,n,o,s)}else if(11===c)a=u;else if(14===c)a=i.evaluateField(e,t);else if(t.evaluate)return t.evaluate(e,n,o)}else a=i.evaluateUnaryOperation(e,t,n,o,s);return a},e.prototype.evaluateLocalName=function(e,t,n,o){var i,a,s,l;if(t.letContext)for(i=e.value,a=t.letContext.length-1;a>=0;a--)if((s=t.letContext[a])[i]!==u)return e.bhc=!0,s[i];return(l=new r.Expression(8)).value=e.value,this.evaluate(l,t,n,o)},e.prototype.evaluateConst=function(e,t,n){var o=e.value;return g(o)?n||t&&(t.arrayFormulaMode||t.vi())?o:o.getValue(0,0):o},e.prototype.evaluateReference=function(e,t,n,o){var i,a,s,l,u,c,f,h,p,d,g,m,b,C,w,x;if(!t)return v;if(i=e.source||t.source,a=isNaN(t.row)?0:t.row,s=isNaN(t.column)?0:t.column,l=e.getRange&&e.getRange(a,s),u=e.type,!l)return 13===u?v:y;if(33===u&&l.isSpillError)return r.Errors.Spill;if(c=l.row<0?0:l.row,f=l.col<0?0:l.col,h=l.rowCount,p=l.colCount,o&&(d=i.getRowCount(),g=i.getColumnCount(),(-1===h||h>d)&&(h=d),(-1===p||p>g)&&(p=g)),n||t.arrayFormulaMode)return e.endSource?t.getSheetRangeReference({source:e.source,endSource:e.endSource,row:c,col:f,rowCount:h,colCount:p}):t.getReference(i,l);if(o&&(h>1||p>1)){for(m=[],b=0;b<h;b++)for(m[b]=[],C=0;C<p;C++)m[b][C]=i.getValue(b+c,C+f);return new r.CalcArray(m)}if(h>1||p>1)if(w=a>=l.row&&a<l.row+h,x=s>=l.col&&s<l.col+p,w&&x)c=a,f=s;else{if(!w&&!x)return v;if(w&&1===p)c=a;else{if(!x||1!==h)return v;f=s}}else if(-1===l.row&&-1===h){if(1!==p)return v;c=a}else if(-1===l.col&&-1===p){if(1!==h)return v;f=s}return i.getValue(c,f)},e.prototype.evaluateName=function(e,t,n,o){var r,i;return t?(e.source&&(t=e.source.getEvaluatorContext(t.identity,t.arrayFormulaMode,t.arrayIdentity)),(r=t.getName(e.value))?(i=a.Mh(t,r,!1,0,0,n,o),this.evaluate(i,t,n,o)):b):b},e.prototype.evaluateUnaryOperation=function(e,t,n,o,i){var a,s=!1;return i&&i.length>0&&(n=!0,s=!0),(a=this.evaluate(e.value,t,n,s))&&a.pause||r.Convert.vf(a)?a:a===r.missingArgument?C:this.evaluateWithArgs(e,(function(n){return B(e.operatorType,n[0],t.Exb)}),t,i,[a],n,o)},e.prototype.evaluateBinaryOperation=function(e,t,n,o,i){var a,s,l,u,c,f,h,p,d;if(t.Exb&&(n=!0),a=[n,n],l=[s=e.operatorType>=15,s],i&&i.length>0)for(u=0;u<i.length;u++)a[i[u]]=!0,l[i[u]]=!0;for(c=function(e,t){if(0===t){for(;10===e.type;)e=e.value;if(7===e.type&&e.function&&e.function.TAb)return null}return t},f=[e.value,e.value2],h=[],u=0;u<2;u++){if((p=this.evaluate(f[u],t,a[u],l[u]))&&p.pause)return p;if(d=c(f[u],p),r.Convert.vf(d))return d;if(d===r.missingArgument)return C;h[u]=d}return this.evaluateWithArgs(e,(function(t){return B(e.operatorType,t[0],t[1])}),t,i,h,n,o)},e.prototype.evaluateField=function(e,t){return t?(e.source&&(t=e.source.getEvaluatorContext(t.identity,t.arrayFormulaMode,t.arrayIdentity)),t.getField(e.value)||C):b},e.prototype.startCache=function(){this.Bi={},this.service.nia&&this.asyncManager.startCalc()},e.prototype.endCache=function(){this.Bi=l},e.prototype.evaluateBranchFunction=function(e,t,n,o,r){var i,a,l,u,c,f,h;if(s(e.PDc))return i=e.function,a=e.arguments.length,l=i.findTestArgument(),c=(u=this.preprocessFunction(t,i,a,r)).acceptsArrays,f=u.keepArrayValuesFlagSet,(h=this.testArgGetBranch(t,i,e,c[l],!1,l))&&h.pause?h:(f&&delete t.Exb,h.branchArgument>=0&&"number"==typeof h.branchArgument?(e.PDc=!0,t.source.ODc=t.source.ODc||[],t.source.ODc.push(e),{pause:"Branch",branch:e.RDc[h.branchArgument]}):void delete e.QDc)},e.prototype.evaluateLetFunction=function(e,t,n,o){var r,i,a,s,l,u,c,f,h=e.arguments.length;for(t.letContext=t.letContext||[],i={},a=1;a<h-1;a+=2){if(s=e.arguments[a-1],l=e.arguments[a],u=s.value,c=t,t.letContext.push(i),(r=this.evaluate(l,c,n,o))&&r.pause)return r;t.letContext.pop(),i[u]=r,s.bhc=!0}return t.letContext.push(i),(f=this.evaluate(e.arguments[h-1],t,n,o))&&f.pause||(t.letContext.pop(),0===t.letContext.length&&delete t.letContext),f},e.prototype.preprocessFunction=function(e,t,n,o){var r,i,a,s,u=[],c=[],f=e.Exb,h=!1,p=l;for(f||1!==t.arrayArgumentEvaluateMode||(f=e.Exb=!0,h=!0),r=0;r<n;r++)u[r]=t.acceptsArray(r),c[r]=t.acceptsReference(r);if(o&&o.length>0||f){for(p=[],r=0;r<n;r++)p[r]=!0;for(i=f?n:o.length,r=0;r<i;r++)u[a=f?r:o[r]]=!0,c[a]=!0,(s=!(t.acceptsReference(a)&&!t.acceptsArray(a)))&&f&&t.acceptsReference(a)&&(s=!1),p[a]=s}return t.isBranch()&&(e.arrayFormulaMode||e.vi())&&(u[t.findTestArgument()]=!0,c[t.findTestArgument()]=!0),{acceptsArrays:u,acceptsReferences:c,getReferenceValues:p,keepArrayValuesFlagSet:h}},e.prototype.testArgGetBranch=function(e,t,n,o,r,i){var a,s=-1,l=e.Exb;return e.arrayFormulaMode&&(e.Exb=!0),t.acceptsArray(i)&&e.wi(),(a=this.evaluate(n.arguments[i],e,o,r))&&a.pause?a:(t.acceptsArray(i)&&e.xi(),e.Exb=l,m(a)||g(a)||(s=t.findBranchArgument(a)),{testArgValue:a,branchArgument:s})},e.prototype.evaluateFunction=function(e,t,n,o,i){var a,s,u,c,f,h,p,d,y,v,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F;if(!e||!e.function||"string"==typeof e.function)return b;if(a=e.arguments.length,s=this,u=t.ti,"LET"===e.functionName)return s.evaluateLetFunction(e,t,n,o);if(c=e.function,f=[],p=l,c instanceof r.Functions.AsyncFunction&&this.asyncManager.startCalcFunction(c,e.arguments,t),0!==a){if(v=(y=s.preprocessFunction(t,c,a,i)).acceptsArrays,C=y.acceptsReferences,p=y.getReferenceValues,d=y.keepArrayValuesFlagSet,w=void 0,x=void 0,A=void 0,c.isBranch()){if(x=c.findTestArgument(),(M=s.testArgGetBranch(t,c,e,v[x],C[x],x))&&M.pause)return M;w=M.testArgValue,A=M.branchArgument}for(S=0;S<a;S++){if(x===S)h=w;else{if(A>=0&&S!==A){f[S]=null;continue}if(c.acceptsArray(S)&&t.wi(),(h=s.evaluate(e.arguments[S],t,v[S],C[S]))&&h.pause)return h;c.acceptsArray(S)&&t.xi()}if(!c.acceptsArray(S)&&g(h)||!c.acceptsReference(S)&&m(h))if(T=g(h)?h:l,N=m(h)?h:l,T&&1===T.getRowCount()&&1===T.getColumnCount())h=T.getValue(0,0);else if(N&&1===N.getRowCount(0)&&1===N.getColumnCount(0))h=N.getValue(0,0,0);else{if(I=[],R=!1,i)for(k=0;k<i.length;k++)I.push(i[k]),i[k]===S&&(R=!0);R||(I.push(S),i=I)}if(r.Convert.vf(h)&&!c.acceptsError(S))return c instanceof r.Functions.AsyncFunction&&this.asyncManager.endCalcFunction(),h;if(h!==r.missingArgument||c.acceptsMissingArgument(S)||(h=l),f[S]=h,h&&"INDIRECT"!==e.functionName&&h.ck&&h._source)for(E=h.getRangeCount(),D=h._source,j=t.source.getCalcSourceModel().qg(t.row,t.column,!0),_=0;_<E;_++)(O=h._identities[_]).id=D.id,D.getRangeKey&&(F=D.getRangeKey(D,O),j.eOb||(j.eOb={}),j.eOb[F]=O)}}return d&&delete t.Exb,s.evaluateWithArgs(e,(function(e,n,i){var a,l,f,h,p,d=U(e,c.Ci);return e=d.Di,c.isContextSensitive()?(t.acceptsReference=o||t.vi(),c instanceof r.Functions.AsyncFunction?(s.T4=s.T4||{},c.evaluateWhenArgumentsIsSame()?s.evaluateAsyncFunction(t,n,c,u,e,i):s.evaluateWithCache(c,e,(function(){return s.evaluateAsyncFunction(t,n,c,u,e,i)}),s.T4)):c.evaluateWithContext(t,e)):((l=t.arrayFormulaMode)&&(c.y0a={row:t.rowOffset,col:t.columnOffset}),f=r.getMapping()&&r.getMapping().builtInFunctionsMapping,h=f&&f[c.name]&&f[c.name].specialFun,p=function(){return d.Ei?h&&h.apply(c,e)||c.evaluate.apply(c,e):d.Fi},a=l?s.evaluateWithCache(c,e,p,s.Bi):p(),delete c.y0a,a)}),t,i,f,n,o,p)},e.prototype.evaluateAsyncFunction=function(e,t,n,o,r,i){var a,s,l=this.asyncManager.getNode();if(l.v5)a=l.Fi;else if(l.canEvaluate()){if(s=new M(e,l),a=n.evaluateWithContext(s,r),s.notAsync)return a;a===u?a=l.Fi!==u?l.Fi:n.defaultValue():1===l.evaluateMode&&(l.v5=!0)}else a=l.Fi!==u?l.Fi:n.defaultValue();return l.Fi=a,i||this.asyncManager.endCalcFunction(),a},e.prototype.evaluateWithCache=function(e,t,n,o){var i,a,s,l,c,f,h,p,d,g,m,y;if(o)if(a=!1,i=o[e.name+t.length])for(s=0;s<i.length;s++){if(a=!1,(l=i[s]).args.length===t.length){for(a=!0,c=0;c<t.length;c++)if((f=l.args[c])!==(h=t[c])){if(!(f instanceof r.CalcReference&&h instanceof r.CalcReference)){a=!1;break}if(p=f.zf,f._source!==h._source||p!==h.zf){a=!1;break}for(d=0;d<p;d++)if(f.getRow(d)!==h.getRow(d)||f.getColumn(d)!==h.getColumn(d)||f.getRowCount(d)!==h.getRowCount(d)||f.getColumnCount(d)!==h.getColumnCount(d)){a=!1;break}}a&&!F(l.y0a,e.y0a)&&(a=!1)}if(a)return l.flag++,l.value}else i=o[e.name+t.length]=[];if(g=n(),o&&g!==u){if((m=i.length)>=100){for(y=[],s=0;s<m;s++)i[s].flag>0&&y.push(i[s]);y.sort((function(e,t){return t.flag-e.flag})),m=Math.min(50,y.length),i=y.slice(0,m),o[e.name+t.length]=i}i.push({args:t,value:g,flag:0,y0a:e.y0a})}return g},e.prototype.SetAsyncResult=function(e){var t,n,o=[];for(t=1;t<arguments.length;t++)o[t-1]=arguments[t];(n=e.ctx).source.Cf().recalculate(n.source,e.row,e.col,!0)},e.prototype.evaluateWithArgs=function(e,t,n,o,i,a,s,l){var u,c,f,h,p,d,y,b,w,x,A,M,S,T,N=n.Exb;if(!N||o&&o.length>0||(o=[],(u=7===e.type&&e.function)&&i.forEach((function(e,t){(!u.acceptsArray(t)&&g(e)||!u.acceptsReference(t)&&m(e))&&o.push(t)}))),o&&o.length>0){if(!(f=this.Gi(n,e,i,o,l)))return C;for(h=[],p=f[0].length,d=f[0][0].length,y=0;y<p;y++)for(h[y]=[],b=0;b<d;b++)try{for(w=[],x=0;x<i.length;x++)w[x]=f[x][y][b];if(c=t(w,e,y+1!==p||b+1!==d),m(c)&&!N){if(7===e.type&&((u=e.function).returnReference&&u.returnReference()))return c;c=this.getOneValue(n,c)}h[y][b]=c}catch(e){h[y][b]=v}return new r.CalcArray(h,N)}try{if(c=t(i,e),n.arrayFormulaMode&&n.vi())return c;if(g(c)&&!a)return this.getOneValue(n,c);if(m(c)&&!s){if(A=c,a&&1===A.getRangeCount()){for(M=[],S=0;S<A.getRowCount(0);S++)for(M[S]=[],T=0;T<A.getColumnCount(0);T++)M[S][T]=A.getValue(0,S,T);return new r.CalcArray(M)}return this.getOneValue(n,c)}return c}catch(e){return v}},e.prototype.getOneValue=function(e,t){var n,o,r,i,a,s;return m(t)?(i=(r=t).getRowCount(0),a=r.getColumnCount(0),r.getRangeCount()>1||!e.arrayFormulaMode&&i>1&&a>1?t=v:(-1!==e.rowOffset||-1!==e.columnOffset?(n=1===i?0:e.arrayFormulaMode?e.rowOffset:e.rowOffset-r.getRow(0),o=1===a?0:e.arrayFormulaMode?e.columnOffset:e.columnOffset-r.getColumn(0)):(n=1===i?0:e.row-r.getRow(0),o=1===a?0:e.column-r.getColumn(0)),t=n>=i||o>=a?C:r.getValue(0,n,o))):g(t)&&(s=t,!e.arrayFormulaMode||-1===e.rowOffset&&-1===e.columnOffset?t=s.getValue(0,0):(n=1===s.getRowCount()?0:e.rowOffset,o=1===s.getColumnCount()?0:e.columnOffset,t=n>=s.getRowCount()||o>=s.getColumnCount()?C:s.getValue(n,o))),m(t)||g(t)?this.getOneValue(e,t):t},e.prototype.Gi=function(e,t,n,r,i){var a,s,c,f,h,p,d,y,v,b,w,x,A,M,S,T,N,I,R,k=1,E=1,D=-1,j=!0,_=!0,F=1,P=1,H=7===t.type?t:l,B=H&&H.function,L=e.arrayFormulaMode||e.source&&e.source._service&&e.source._service.allowDynamicArray;if(B&&!B.expandRows()&&(j=!1),B&&!B.expandColumns()&&(_=!1),B&&B.isBranch()&&(L||e.vi())){if(D=B.findTestArgument(),c=[],f=!1,r)for(h=0;h<r.length;h++)c.push(r[h]),r[h]===D&&(f=!0);if(f||g(n[D])||m(n[D])){for(p=0;p<H.arguments.length;p++)p!==D&&o.Common.k.Cb(c,p)<0&&(g(n[p])||m(n[p]))&&c.push(p);r=c}}for(d=[],v=r[y=0],b=n.length,A=[],w=0;w<b;w++)x=n[w],a=l,s=l,F=P=1,w===v?(a=g(x)?x:l,s=m(x)?x:l,(a||s)&&(F=a&&a.getRowCount()||(j?s.getRowCount(0):1),P=a&&a.getColumnCount()||(_?s.getColumnCount(0):1)),v=++y<r.length?r[y]:-1):i===u&&(a=g(x)?x:l,s=m(x)?x:l,(a||s)&&(F=a&&a.getRowCount()||(j?s.getRowCount(0):1),P=a&&a.getColumnCount()||(_?s.getColumnCount(0):1))),A[w]=[a,s,x,F,P],k=F>k?F:k,E=P>E?P:E;for(w=0;w<b;w++){if(M=d[w]=[],a=(S=A[w])[0],s=S[1],x=S[2],F=S[3],P=S[4],(a||s)&&(1!==F&&F!==k||1!==P&&P!==E)&&(-1===D||w===D)&&!L)return;for(T=0;T<k;T++)for(N=M[T]=[],I=0;I<E;I++)1!==F&&T>=F||1!==P&&I>=P?N[I]=C:a?(R=a.getValue(1===F?0:T,1===P?0:I),g(R)&&(R=R.getValue(0,0)),N[I]=R):s?!i||i[w]?N[I]=s.getValue(0,1===F?0:T,1===P?0:I):N[I]=s.create([O(s.getRow(0)+(1===F?0:T),s.getColumn(0)+(1===P?0:I),1,1)]):N[I]=x}return d},e}(),t.Evaluator=T,N=function(){function e(e,t){this.id=e,this.Fi=u,this.v5=!1,this.oi=[],t!==u&&(this.evaluateMode=t)}return e.prototype.canEvaluate=function(){var e,t=this.oi;for(e=0;e<t.length;e++)if(!t[e].v5)return!1;return!0},e}(),t.AsyncFunctionNode=N,I=function(){function e(e){var t=this;t.w5=[],t.x5=-1,t.y5={},t.z5=-1,t.lh=e,t.vQa=0}return e.prototype.startCalc=function(){var e,t,n,o,r,i,a,s,l;if(this.vQa)for(t in this.y5)if(n=this.y5[t])for(o in n)if(r=n[o])for(i in r)if((a=r[i])&&(e=a.length)>0)for(s=0;s<e;s++)0===(l=a[s]).evaluateMode&&(l.v5=!1)},e.prototype.startCalcCell=function(e,t){var n,o,r,i,a=this,s=e.getName(),l=t.row,u=t.col;return a.z5=-1,a.source=e,(n=a.y5[s])||(n=a.y5[s]={}),(o=n[l])||(o=n[l]={}),(r=o[u])?void(a.cellNodes=r):(i=new N(-1),r=o[u]=[],a.vQa++,a.x5=-1,a.cellNodes=r,a.row=l,a.col=u,r.root=i,a.w5[++a.x5]=i,void(a.evaluateMode=-1))},e.prototype.startCalcFunction=function(e,t,n){var o,r,i,a,s,l,u,c,f,h=this;if(h.z5++,h.isNewNode=!1,o=h.cellNodes[h.z5])return h.currentNode=o,o;if(h.isNewNode=!0,r=h.evaluateMode,i=e.evaluateMode(),"REFRESH"===e.name?(i=t[1]?h.lh.evaluate(t[1],n,!1,!1):0,h.evaluateMode=i):-1!==r&&(i=r),o=new N(h.z5,i),h.cellNodes[h.z5]=o,h.w5[h.x5].oi.push(o),o.parent=h.w5[h.x5],h.w5.push(o),h.x5++,h.currentNode=o,2===i&&-1===r){for(6e4,a=h.intervals,s=e.interval()||6e4,"REFRESH"===e.name&&(o.isRefresh=!0,s=t[2]?h.lh.evaluate(t[2],n,!1,!1):6e4),a||(h.intervals=a={}),(l=a[s])||"object"!=typeof window||((l=a[s]=[]).intervalObj=window.setInterval((function(){var e,t,n=h.intervals[s];for(u=0;u<n.length;u++)(t=(e=n[u]).node).v5=!1,t.isRefresh&&P(t),h.lh.service.recalculate(e.source,e.row,e.col,!0),h.source.refresh()}),s)),c=!1,u=0;u<l.length;u++)if((f=l[u]).source===h.source&&f.node===o&&f.row===h.row&&f.col===h.col){c=!0;break}c||l.push({source:h.source,node:o,row:h.row,col:h.col})}return o},e.prototype.getNode=function(){return this.currentNode},e.prototype.endCalcFunction=function(){this.isNewNode&&(this.w5.pop(),this.x5--),this.currentNode=this.currentNode.parent},e.prototype.endCalcCell=function(){var e,t=[];for(e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.clearCell=function(e,t){var n,o,r,i,a,s,l,c,f,h,p,d,g,m,y=this;if(y.vQa&&(n=e.getName(),o=t.row,r=t.col,y.z5=-1,y.source=e,(i=y.y5[n])&&((a=i[o])&&((s=a[r])&&((c=(l=s[0])&&l.h_a)&&(delete c.nia,delete c.z$a),a[r]=u,y.vQa--))),"object"==typeof window))for(h in f=y.intervals)if(p=f[h]){for(d=[],g=0;g<p.length;g++)(m=p[g]).source===e&&m.row===t.row&&m.col===t.col||d.push(m);d.length?d.length!==p.length&&(d.intervalObj=p.intervalObj,f[h]=d):(f[h]=u,window.clearInterval(p.intervalObj))}},e.prototype.setAsyncResult=function(e,t){e.Fi=t},e.prototype.addRows=function(e,t,n){this.GQa(e,t,n,!0)},e.prototype.deleteRows=function(e,t,n){this.GQa(e,t,n,!1)},e.prototype.GQa=function(e,t,n,o){var r,i,a,s,l,u,c,f,h,p,d,g,m=this;if(m.vQa){if(r=e.getName(),i=m.y5[r]){for(s in a={},i)(l=i[s])&&(u=parseInt(s,10),o?a[u>=t?u+n:u]=l:u<t?a[u]=l:u>=t+n&&(a[u-n]=l));m.y5[r]=a}for(f in c=m.intervals)if(h=c[f]){for(p=[],d=0;d<h.length;d++)(g=h[d]).source===e&&o&&g.row>=t?g.row+=n:g.source===e&&!o&&(g.row<t||g.row>=t+n)&&(g.row=g.row<t?g.row:g.row-n,p.push(g));o||p.length===h.length||(p.intervalObj=h.intervalObj,c[f]=p)}}},e.prototype.addColumns=function(e,t,n){this.HQa(e,t,n,!0)},e.prototype.deleteColumns=function(e,t,n){this.HQa(e,t,n,!1)},e.prototype.HQa=function(e,t,n,o){var r,i,a,s,l,u,c,f,h,p,d,g,m,y,v=this;if(v.vQa){if(r=e.getName(),i=v.y5[r])for(a in i)if(s=i[a]){for(u in l={},s)(c=s[u])&&c.length&&(f=parseInt(u,10),o?l[f>=t?f+n:f]=c:f<t?l[f]=c:f>=t+n&&(l[f-n]=c));i[a]=l}for(p in h=v.intervals)if(d=h[p]){for(g=[],m=0;m<d.length;m++)(y=d[m]).source===e&&o&&y.col>=t?y.col+=n:y.source===e&&!o&&(y.col<t||y.col>=t+n)&&(y.col=y.col<t?y.col:y.col-n,g.push(y));o||g.length===d.length||(g.intervalObj=d.intervalObj,h[p]=g)}}},e.prototype.changeSourceName=function(e,t){var n,o=this;o.vQa&&((n=o.y5[e])&&(o.y5[t]=n,delete o.y5[e]))},e}(),t.evaluateOperator=B,R=r.Convert.Pa,k=r.Convert.Rh,E=r.Convert.bc,D=r.Convert.Xh,j=r.Convert.Vh},"./src/referenceExpression.ts":function(e,t,n){"use strict";var o,r,i,a,s,l=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function u(e,t,n,o,r,i){var s=new a(1);return s.row=n,s.column=o,s.rowRelative=r,s.columnRelative=i,e&&(s.source=e),t&&(s.endSource=t),s}function c(e,t,n,r,i,s,l,u,c,f,h,p,d){var g,m,y,v,b,C=new a(1);return C.isFullRow=r===o.BAND_INDEX_CONST,h=h||0,p=p||0,m=n-(l?0:h),y=r-(u?0:p),v=i-(c?0:h),b=s-(f?0:p),C.isFullRow&&0===n&&i===o.MAX_ROW_COUNT-1&&(n=i=o.BAND_INDEX_CONST),C.isFullColumn=n===o.BAND_INDEX_CONST,m>v&&(g=n,n=i,i=g,g=l,l=c,c=g),y>b&&(g=r,r=s,s=g,g=u,u=f,f=g),C.row=n,C.column=r,C.endRow=i,C.endColumn=s,C.rowRelative=l,C.columnRelative=u,C.endRowRelative=c,C.endColumnRelative=f,C.isArrayReference=d,e&&(C.source=e),t&&(C.endSource=t),C}function f(e,t,n){var r,a,s,l,u={row:-1,col:-1,rowCount:-1,colCount:-1};return e.isFullRow?(u.col=-1,u.colCount=-1):(e.columnRelative?s=(s=e.column+n)>=o.MAX_COLUMN_COUNT?s%o.MAX_COLUMN_COUNT:s:s=e.column,e.sf()?(u.col=s,u.colCount=1):(e.endColumnRelative?l=(l=e.endColumn+n)>=o.MAX_COLUMN_COUNT?l%o.MAX_COLUMN_COUNT:l:l=e.endColumn,u.col=s<=l?s:l,u.colCount=i(l-s)+1)),e.isFullColumn?(u.row=-1,u.rowCount=-1):(e.rowRelative?r=(r=e.row+t)>=o.MAX_ROW_COUNT?r%o.MAX_ROW_COUNT:r:r=e.row,e.sf()?(u.row=r,u.rowCount=1):(e.endRowRelative?a=(a=e.endRow+t)>=o.MAX_ROW_COUNT?a%o.MAX_ROW_COUNT:a:a=e.endRow,u.row=r<=a?r:a,u.rowCount=i(a-r)+1)),u}function h(e,t,n,o,r,i,a,l){var u=new s(o,r,i,a,l);return u.contextSource=e,u.source=t,u.endSource=n,u}function p(e,t){return h(e,t,r,0,0,!1,!1,!0)}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./src/calc.common.ts"),r=void 0,i=Math.abs,a=function(e){function t(t){return e.call(this,t)||this}return l(t,e),t.prototype.sf=function(){return this.endRow===r||this.endColumn===r},t.prototype.tf=function(){var e=this;return e.isFullRow&&e.isFullColumn?3:e.isFullRow?1:e.isFullColumn?2:0},t.prototype.getRange=function(e,t){return f(this,e,t)},t.prototype.offset=function(e,t,n,o,r){var i,a=this,s=a.source,l=a.endSource;return a.sf()?u(s,l,a.row+(a.rowRelative||n?e:0),a.column+(a.columnRelative||n?t:0),a.rowRelative,a.columnRelative):((i=c(s,l,a.row+(a.rowRelative||n?e:0),a.column+(a.columnRelative||n?t:0),a.endRow+(a.isFullColumn||!a.endRowRelative&&!n?0:e),a.endColumn+(a.isFullRow||!a.endColumnRelative&&!n?0:t),a.rowRelative,a.columnRelative,a.endRowRelative,a.endColumnRelative,o,r)).isFullRow=a.isFullRow,i.isFullColumn=a.isFullColumn,i)},t.prototype.offset2=function(e,t,n,o,r,i){var a=this,s=c(a.source,a.endSource,a.row+(a.isFullColumn?0:e),a.column+(a.isFullRow?0:t),a.endRow+(a.isFullColumn?0:n),a.endColumn+(a.isFullRow?0:o),a.rowRelative,a.columnRelative,a.endRowRelative,a.endColumnRelative,r,i);return s.isFullRow=a.isFullRow,s.isFullColumn=a.isFullColumn,s},t}(o.Expression),t.ReferenceExpression=a,t.rf=u,t.uf=c,t.getRangeForReference=f,s=function(e){function t(t,n,o,r,i){var a=e.call(this,33)||this;return a.row=t,a.column=n,a.rowRelative=o,a.columnRelative=r,a.isReferenceError=i,a.sf=function(){return!this.isReferenceError},a.getRange=function(e,t){var n,o,r,i,a,s=this,l=s.source||s.contextSource;if(!s.isReferenceError&&l&&(o=(n=f(s,e,t)).row,r=n.col,i=l.getReference({row:o,col:r,spillRef:!0})))return a={spillRef:!0,row:o,col:r,rowCount:i.getRowCount(),colCount:i.getColumnCount()},i.isSpillError&&(a.isSpillError=!0),a},a.offset=function(e,t,n){var o=this,r=o.contextSource,i=o.source,a=o.endSource;return this.isReferenceError?p(r,i):h(r,i,a,o.row+(o.rowRelative||n?e:0),o.column+(o.columnRelative||n?t:0),o.rowRelative,o.columnRelative)},a}return l(t,e),t}(o.Expression),t.SpillReferenceExpression=s,t.BLb=h,t.lOb=p},Common:function(e,t){e.exports=n("@grapecity/js-sheets-common")}}),e.exports=o.Spread.CalcEngine},"./node_modules_local/@grapecity/js-calc/index.js":function(e,t,n){e.exports=n("./node_modules_local/@grapecity/js-calc/dist/gc.spread.calcengine.js")},"./node_modules_local/@grapecity/js-sheets-common/dist/gc.spread.common.js":function(e,t){var n="object"==typeof n?n:{};n.Spread=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){var o,r;if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;if(o=Object.create(null),n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/assets/",n(n.s="./src/all.entry.ts")}({"./node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"./src/all.entry.ts":function(e,t,n){"use strict";var o,r,i,a,s;Object.defineProperty(t,"__esModule",{value:!0}),o=n("./src/common/common.entry.ts"),t.Common=o,r=n("./src/plugins/commands/commands.entry.ts"),t.Commands=r,i=n("./src/plugins/formatter/formatter.entry.ts"),t.Formatter=i,a=n("./src/plugins/sparkline/sparkline.entry.ts"),t.Sparklines=a,s=n("./src/plugins/slicer/slicer.entry.ts"),t.Slicers=s},"./src/common/common.entry.ts":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c;function f(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./src/common/util/colorhelper.ts"),t.pc=o.pc,r=n("./src/common/util/types.ts"),t.j=r.j,i=n("./src/common/util/arrayhelper.ts"),t.k=i.k,a=n("./src/common/util/datetimehelper.ts"),t.l=a.l,s=n("./src/common/util/numberhelper.ts"),t.o=s.o,l=n("./src/common/util/regexhelper.ts"),t.q=l.q,u=n("./src/common/util/stringhelper.ts"),t.u=u.u,f(n("./src/common/util/common.ts")),c=n("./src/common/culture/cultureInfo.ts"),t.CultureInfo=c.CultureInfo,t.CultureManager=c.CultureManager,f(n("./src/common/util/functionhelper.ts"))},"./src/common/culture/cultureInfo.ts":function(e,t,n){"use strict";(function(e){var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function T(e){return e.split("").join(" ").toUpperCase()}function N(e){var t,n,o=[];for(t=0,n=e.length;t<n;t++)o[t]=T(e[t]);return o}function I(e,t,n){var o=T(e),r=t.indexOf(o);return-1===r&&(r=n.indexOf(o)),r}function R(e,t,n){var o,r,i;for(r=0,i=t.length;r<i;r++)o=t[r],this[e][o]=n[r]}function k(e){var t;"object"==typeof document&&("function"!=typeof CustomEvent?(t=document.createEvent("CustomEvent")).initCustomEvent("cultureChanged",!1,!1,void 0):t=new CustomEvent("cultureChanged",{}),t.cultureInfo=e,a.gcCultureInfo=e,document.dispatchEvent(t))}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./src/common/util/types.ts"),r=n("./src/common/util/common.ts"),i=n("./src/common/util/arrayhelper.ts"),a="undefined"!=typeof window?window:e,s=void 0,l=null,u=o.j.H,c=o.j.Ia,p=["MM-dd-yyyy","MM-d-yyyy","M-dd-yyyy","M-d-yyyy","yy-MM-dd","yy-MM-d","yy-M-dd","yy-M-d","yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","dd-MMMM-yy","dd-MMM-yy"],d=(f=["MM/dd/yyyy","MM/d/yyyy","M/dd/yyyy","M/d/yyyy","yy/MM/dd","yy/MM/d","yy/M/dd","yy/M/d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d"]).concat(h=["hh:mm:ss","hh:mm:s","hh:m:ss","hh:m:s","h:mm:ss","h:mm:s","h:m:ss","h:m:s","hh:mm:ss tt","hh:mm:s tt","hh:m:ss tt","hh:m:s tt","h:mm:ss tt","h:mm:s tt","h:m:ss tt","h:m:s tt","hh:mm","hh:m","h:mm","h:m","hh:mm tt","hh:m tt","h:mm tt","h:m tt"]),u(f,(function(e,t){u(h,(function(e,n){e<h.length-4&&d.push(t+" "+n)}))})),d=d.concat(p),u(p,(function(e,t){u(h,(function(e,n){e<h.length-4&&d.push(t+" "+n)}))})),g=function(){function e(){this.NumberFormat={currencyDecimalDigits:2,currencyDecimalSeparator:".",currencyGroupSeparator:",",currencyGroupSizes:[3],currencyNegativePattern:0,currencyPositivePattern:0,currencySymbol:"",digitSubstitution:1,isReadOnly:!0,numberGroupSizes:[3],nanSymbol:"NaN",nativeDigits:["0","1","2","3","4","5","6","7","8","9"],numberNegativePattern:1,negativeInfinitySymbol:"-Infinity",negativeSign:"-",numberDecimalDigits:2,numberDecimalSeparator:".",numberGroupSeparator:",",positiveInfinitySymbol:"Infinity",positiveSign:"+",percentDecimalDigits:2,percentDecimalSeparator:".",percentGroupSeparator:",",percentGroupSizes:[3],percentNegativePattern:0,percentPositivePattern:0,percentSymbol:"%",perMilleSymbol:"",listSeparator:",",arrayListSeparator:",",arrayGroupSeparator:";",dbNumber:{},standardDictionaryNumbers:{Hundreds:"Hundreds",Thousands:"Thousands",Millions:"Millions",Billions:"Billions",Trillions:"Trillions"}},this.DateTimeFormat={abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],abbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],amDesignator:"AM",calendarIsReadOnly:!0,calendarWeekRule:0,Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,isReadOnly:!0},dateSeparator:"/",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],defaultDatePattern:"MM/dd/yyyy H:mm:ss",firstDayOfWeek:0,fullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",longDatePattern:"dddd, dd MMMM yyyy",longTimePattern:"HH:mm:ss",monthDayPattern:"MMMM dd",monthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],nativeCalendarName:"Gregorian Calendar",pmDesignator:"PM",rfc1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",shortDatePattern:"MM/dd/yyyy",shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],shortTimePattern:"HH:mm",sortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",timeSeparator:":",universalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",yearMonthPattern:"yyyy MMMM",filterDialogDateFormatter:"yyyy/mmmm/dd",preselectedFormatters:[],eraFormatter:["ge/M/d","ge-M-d","ge.M.d","gee/MM/dd"]},this.name=function(){return""},this.id=-1}return e.prototype.ma=function(){var e,t,n,o;return this.na||(n=(n=[t=(e=this.DateTimeFormat).shortDatePattern.replace(/m/g,"M"),t+" h:mm",t+" h:mm:ss",t+" h:mm:ss.0","MMMdd","MMMd","MMM dd","MMM d"]).concat(d),1041===this.id&&(o=e.eraFormatter,n=(n=n.concat(this._Ab)).concat(o)),n=n.concat(e.preselectedFormatters),this.na=n),this.na},e.prototype.oa=function(e){var t=this;return t.pa||(t.pa=N(t.DateTimeFormat.monthNames),t.qa=N(t.DateTimeFormat.monthGenitiveNames)),I(e,t.pa,t.qa)},e.prototype.ra=function(e){var t=this;return t.sa||(t.sa=N(t.DateTimeFormat.abbreviatedMonthNames),t.ta=N(t.DateTimeFormat.abbreviatedMonthGenitiveNames)),I(e,t.sa,t.ta)},e.prototype.ua=function(e){var t=this;return t.va||(t.va=N(t.DateTimeFormat.dayNames)),t.va.indexOf(T(e))},e.prototype.wa=function(e){var t=this;return t.xa||(t.xa=N(t.DateTimeFormat.abbreviatedDayNames)),t.xa.indexOf(T(e))},e}(),t.CultureInfo=g,m=function(){function e(){}return e.I=function(t){return t>=e.J()&&t<=e.K()},e.L=function(){var e,t,n=g.eras;if(n!==s){for(e=[],t=0;t<n.length;t++)e[t]=new Date(n[t].startDate.replace(/-/g,"/"));return e}return this.O},e.P=function(t){var n,o,r,i,a;switch(t){case"g":n="symbol",o=e.R;break;case"gg":n="abbreviation",o=e.S;break;case"ggg":n="name",o=e.U;break;default:return[]}if(i=[],(r=g.eras)!==s){for(a=0;a<r.length;a++)i[a]=r[a][n];return i}return o},e.K=function(){var e,t=g.eras;return t!==s&&t.length>0?((e=new Date(t[t.length-1].startDate.replace(/-/g,"/"))).setFullYear(e.getFullYear()+99),e):this.W},e.J=function(){var e=g.eras;return e!==s&&e.length>0?new Date(e[0].startDate.replace(/-/g,"/")):this.Z},e.$=function(){var e=g.eras;return e!==s?e.length:this._},e.aa=function(){var e,t,n,o,r=g.eras;if(r!==s){for(e=[],t=1;t<r.length;t++)n=new Date(r[t-1].startDate.replace(/-/g,"/")),o=new Date(r[t].startDate.replace(/-/g,"/")),e[t-1]=o.getFullYear()-n.getFullYear()+1;return e[t-1]=99,e}return this.ba},e.ca=function(t){var n,o={da:-1,ea:-1};if(!e.I(t))return o;for(n=0;n<e.$();n++)if(t<(n+1!==e.$()?e.L()[n+1]:e.fa(e.K(),1))){o.da=n,o.ea=t.getFullYear()-e.L()[n].getFullYear()+1;break}return o},e.fa=function(e,t){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());return n.setMilliseconds(n.getMilliseconds()+t),new Date(n.valueOf())},e.ga=function(t,n){return e.L()[t].getFullYear()+n-1},e.ha=function(t,n){var o,r;for(n=n.toUpperCase(),o=e.P(t),r=0;r<o.length;r++)if(o[r]===n)return r;return-1},e.ia=function(t,n,o){var r,i,a,s=e,l=s.ca(n),u=l.da;if(u>=0&&(r=s.P(t)).length>0)return r[u];if((i=l.ea)>=0){if("1"===(a=""+i)&&o)return"";if("ee"===t)return 1===a.length&&(a="0"+a),a;if("e"===t)return a}return""},e.O=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8),new Date(2019,4,1)],e._=5,e.ba=[45,15,64,31,99],e.W=new Date(2117,11,31,23,59,59),e.Z=new Date(1868,8,8),e.ja=["1,m","2,t","3,s","4,h","5,r"],e.ka=[0,1,2,3,0,1,2,3],e.U=["","","","",""],e.R=["M","T","S","H","R"],e.S=["","","","",""],e.la=99,e.eraExcelFormatter="[$-ja-JP-x-gannen]",e.eraInternalFormatter="[$-411]",e}(),t.aBb=m,y=function(e){function t(){var t,n=e.call(this)||this;return R.call(n,"NumberFormat",["currencySymbol","isReadOnly"],["$",!1]),t=["MMM yyyy","MMMM yyyy"],R.call(n,"DateTimeFormat",["fullDateTimePattern","longDatePattern","longTimePattern","shortDatePattern","shortTimePattern","yearMonthPattern","calendarIsReadOnly","preselectedFormatters"],["dddd, MMMM dd, yyyy h:mm:ss tt","dddd, MMMM dd, yyyy","h:mm:ss tt","M/d/yyyy","h:mm tt","MMMM, yyyy",!1,t]),n.DateTimeFormat.defaultDatePattern=n.DateTimeFormat.shortDatePattern+" H:mm:ss",n.name=function(){return"en-US"},n.id=1033,n}return S(t,e),t}(g),v=function(e){function t(){var t,n,o,r=e.call(this)||this,i={1:{letters:["","","","","","","","","","","","",""],numbers:["","","","","","","","","",""]},2:{letters:["","","","","","","","","","","","",""],numbers:["","","","","","","","","",""]},3:{letters:l,numbers:["","","","","","","","","",""]}};return R.call(r,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[0,1,"",!1,"NaN ()","-",1,1,"+",i,{Hundreds:"",Thousands:"",Millions:"",Billions:"",Trillions:""}]),t=["1","2","3","4","5","6","7","8","9","10","11","12",""],n=["1","2","3","4","5","6","7","8","9","10","11","12",""],o=["yyyyMd","yyyyMdd","yyyyMMd","yyyyMMdd"],R.call(r,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter","preselectedFormatters","EraFilterDialogDateFormatter"],[["","","","","","",""],t,t,"",!1,["","","","","","",""],"yyyy''M''d'' H:mm:ss","yyyy''M''d''","H:mm:ss","M''d''",n,n," ()","","yyyy/MM/dd",["","","","","","",""],"H:mm","yyyy''M''","yyyy/mmmm/d",o,"ggge/mmmm/d"]),r.DateTimeFormat.eras=!0,r.DateTimeFormat.defaultDatePattern=r.DateTimeFormat.shortDatePattern+" "+r.DateTimeFormat.longTimePattern,r._Ab=['gggee""MM""dd"','gggee""M""d"','ge""M""d"','ggge""M""d"','ggee""M""d"','gge""M""d"'],r.name=function(){return"ja-JP"},r.id=1041,r.isJCKCulture=!0,r}return S(t,e),t}(g),b=function(e){function t(){var t,n,o=e.call(this)||this,r={1:{letters:["","","","","","","","","","","","",""],numbers:["","","","","","","","","",""]},2:{letters:["","","","","","","","","","","","",""],numbers:["","","","","","","","","",""]},3:{letters:l,numbers:["","","","","","","","","",""]}};return R.call(o,"NumberFormat",["currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[2,"",!1,"","",1,1,"",r,{Hundreds:"",Thousands:"",Millions:"",Billions:"",Trillions:""}]),t=["1","2","3","4","5","6","7","8","9","10","11","12",""],n=["","","","","","","","","","","","",""],R.call(o,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[["","","","","","",""],t,t,"",!1,["","","","","","",""],1,"yyyy''M''d'' H:mm:ss","yyyy''M''d''","H:mm:ss","M''d''",n,n,"","","yyyy/M/d",["","","","","","",""],"H:mm","yyyy''M''","yyyy/mmmm/d"]),o.DateTimeFormat.defaultDatePattern=o.DateTimeFormat.shortDatePattern+" "+o.DateTimeFormat.longTimePattern,o.name=function(){return"zh-cn"},o.id=2052,o.isJCKCulture=!0,o.localeCompare=function(e,t){return e.localeCompare(t,"en")},o}return S(t,e),t}(g),C=function(e){function t(){var t,n,o=e.call(this)||this;return R.call(o,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","dbNumber","standardDictionaryNumbers"],[0,1,"",!1,{1:{letters:["","","","","","","","","","","","",""],numbers:["","","","","","","","","",""]},2:{letters:["","","","","","","","","","","","",""],numbers:["","","","","","","","","",""]},3:{letters:["","","","","","","","","","","","",""],numbers:["","","","","","","","","",""]},4:{letters:["","","","","","","","","","","","",""],numbers:["","","","","","","","","",""]}},{Hundreds:"",Thousands:"",Millions:"",Billions:"10",Trillions:""}]),t=["1","2","3","4","5","6","7","8","9","10","11","12",""],n=["1","2","3","4","5","6","7","8","9","10","11","12",""],R.call(o,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[["","","","","","",""],t,t,"",!1,["","","","","","",""],1,"yyyy'' M'' d'' dddd h:mm:ss","yyyy'' M'' d'' dddd","h:mm:ss","M'' d''",n,n,"","","yyyy-MM-dd",["","","","","","",""],"tt h:mm","yyyy'' M''","yyyy/mmmm/d"]),o.DateTimeFormat.defaultDatePattern=o.DateTimeFormat.shortDatePattern+" "+o.DateTimeFormat.longTimePattern,o.name=function(){return"ko-kr"},o.id=1042,o.isJCKCulture=!0,o}return S(t,e),t}(g),w={invariant:new g,"en-us":new y,"ja-jp":new v,"zh-cn":new b,"ko-kr":new C},x={},A=["lsru","lsde","ls1","ls2","ls3","ls4","ls5","ls6"],M=function(){function e(){this.bBb=1}return e.instance=function(){return this.cBb||(this.cBb=new this)},e.prototype.culture=function(t){return 0===arguments.length?e.dBb:void(t&&e.dBb!==t&&(e.dBb=t.toLowerCase(),this.bBb++,k(e.dBb)))},e.prototype.addCultureInfo=function(e,t,n){var o,i,a,s;if(t&&t instanceof g){if(o=t.NumberFormat&&t.NumberFormat.numberDecimalSeparator,i=t.NumberFormat.arrayListSeparator,a=t.NumberFormat.arrayGroupSeparator,o===t.NumberFormat.listSeparator||a===i)throw new r.ResourceManager(r.SR).getResource().Exp_Separator;w[e.toLowerCase()]=t}n&&"object"==typeof n&&(s=e.toLowerCase(),x[s]=c(!0,{},n),this.bBb++)},e.prototype.getCultureInfo=function(t){var n,o,r;if(0===arguments.length)return w[e.dBb];for(r in"string"==typeof t&&(t=t.toLowerCase()),o=l,n=w)if(r===t||n[r].id!==s&&n[r].id===t){o=n[r];break}return o},e.prototype.getLanguage=function(e){if("string"==typeof e){var t=e.toLowerCase();return x[t]}return l},e.prototype.eBb=function(e,t){var n,o,r=x[e.toLowerCase()];for(n in t)i.k.Bb(A,n)||null!==(o=this.fBb(r,n))&&"string"==typeof o&&"string"==typeof t[n]&&(t[n]=o);t._h&&r.Functions&&this.gBb(r.Functions,t._h),t.B2&&r.TableFunctions&&c(!0,t.B2,r.TableFunctions)},e.prototype.fBb=function(e,t){var n,o;if(e.hasOwnProperty(t))return e[t];for(n in e)if("object"==typeof(o=e[n])&&o.hasOwnProperty(t))return o[t];return null},e.prototype.gBb=function(e,t){var n,o,r,i,a,s,l;for(n in t)if(e.hasOwnProperty(n))for(s in o=t[n],r=e[n],i=o.parameters,a=r.parameters,o.description=r.description,i)a.hasOwnProperty(s)&&("string"==typeof(l=a[s])&&(i[s].name=l));return{}},e.prototype.q4=function(t){var n=this.getCultureInfo(t);return n||((n=w[e.dBb])||(n=new g)),n},e.prototype.LZa=function(e,t){var n=(this.getCultureInfo(e)||this.getCultureInfo("en-US")).DateTimeFormat,o=n.filterDialogDateFormatter;return(t.indexOf("g")>=0||t.indexOf("e")>=0)&&(o=n.EraFilterDialogDateFormatter||o),o},e.dBb="en-us",e}(),t.CultureManager=M.instance()}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./src/common/util/arrayhelper.ts":function(e,t,n){"use strict";var o,r;Object.defineProperty(t,"__esModule",{value:!0}),o=null,r=function(){function e(){}return e.Eb=function(e,t,n){e.splice(t,0,n)},e.Sb=function(e,t){e.push(t)},e.Bb=function(e,t){return e.indexOf(t)>-1},e.Fb=function(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)},e.Zb=function(e,t){return e.slice(0,t).concat(e.slice(t+1))},e.Cb=function(e,t,n){return e.indexOf(t,n)},e.$b=function(e,t,n){if(!(t<0))for(var r=0;r<n&&t+r<e.length;r++)e[t+r]=o},e._b=function(e,t){var n;for(t<0&&(t=-1),n=t+1;n<e.length;n++)if(void 0!==e[n]&&e[n]!==o)return n;return-1},e.ac=function(e){return e&&e.length},e.Uo=function(e){var t=[];return function e(t,n){var r,i;for(r in n)n.hasOwnProperty(r)&&(i=n[r],Array.isArray(i)?(t[r]=[],e(t[r],n[r])):i!==o&&"object"==typeof i?(t[r]={},e(t[r],n[r])):t[r]=n[r])}(t,e),t},e}(),t.k=r},"./src/common/util/colorhelper.ts":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f;function h(e,t,n){return n<0&&(n+=240),n>240&&(n-=240),n<40?e+((t-e)*n+20)/40:n<120?t:n<160?e+((t-e)*(160-n)+20)/40:e}function p(e,t,n){var o,r,i,a,s;return 0===n?o=r=i=l(255*t/240+"",10):(void 0,void 0,o=d(a=2*t-(s=t<=120?l((t*(240+n)+120)/240+""):t+n-l((t*n+120)/240+"")),s,e+80),r=d(a,s,e),i=d(a,s,e-80)),{a:255,r:o,g:r,b:i}}function d(e,t,n){return i(l((255*h(e,t,n)+120)/240+""),255)}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./src/common/util/numberhelper.ts"),r=o.o.pb,i=Math.min,a=Math.max,s=Math.abs,l=parseInt,u=function(){function e(e){var t,n,o,r,s=this,u=e.r,c=e.g,f=e.b,h=a(a(u,c),f),p=i(i(u,c),f),d=h+p;s.kc=l((240*d+255)/510+"",10),0===(t=h-p)?(s.mc=0,s.lc=160):(s.kc<=120?s.mc=l((240*t+d/2)/d+"",10):s.mc=l((240*t+(510-d)/2)/(510-d)+"",10),n=(40*(h-u)+t/2)/t,o=(40*(h-c)+t/2)/t,r=(40*(h-f)+t/2)/t,s.lc=l(u===h?r-o+"":c===h?80+n-r+"":160+o-n+"",10),s.lc<0&&(s.lc+=240),s.lc>240&&(s.lc-=240))}return e.prototype.nc=function(e){var t=this,n=t.kc,o=t.oc(t.kc,500,!0);return p(t.lc,n+(o-n)*e,t.mc)},e.prototype.oc=function(e,t,n){return 0===t?e:n?t>0?(e*(1e3-t)+241*t)/1e3:e*(t+1e3)/1e3:((e+=240*t/1e3)<0&&(e=0),e>240&&(e=240),e)},e}(),c=/rgb[a]?\((\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})(\s*,\s*(\d{0,1}))?\)/,f=function(){function e(){}return e.bc=function(e){var t=e.a,n=e.r,o=e.g,i=e.b;return 3===arguments.length&&(t=255,n=arguments[0],o=arguments[1],i=arguments[2]),4===arguments.length&&(t=arguments[0],n=arguments[1],o=arguments[2],i=arguments[3]),255===t?"#"+r(n,!0,2)+r(o,!0,2)+r(i,!0,2):"rgba("+n+","+o+","+i+","+t+")"},e.Pka=function(e,t){return e.stops||e.type?JSON.stringify(e)===JSON.stringify(t):e.a===t.a&&e.r===t.r&&e.g===t.g&&e.b===t.b},e.dc=function(e){return(299*e.r+587*e.g+114*e.b)/1e3},e.hc=function(e,t){var n=255-s(e.r-t.r),o=255-s(e.g-t.g),r=255-s(e.b-t.b),i=s(e.a-t.a);return!!(((n/=255)+(o/=255)+(r/=255))/3>=.9&&i<=.05)},e.ic=function(t){var n=255^t.r,o=255^t.g,r=255^t.b;return e.bc(t.a,n,o,r)},e.hBb=function(t){var n,o,r;return"object"!=typeof document?function(e){var t,n,o,r;return/^#[A-Fa-f0-9]+$/.test(e)?(t=e.replace(/^#/,""),n=t.length,(o=(o=t.split(3===n?/(.)/:/(..)/)).filter(Boolean).map((function(e){return 3===n?parseInt(e+e,16):parseInt(e,16)})))[0]||(o[0]=0),o[1]||(o[1]=0),o[2]||(o[2]=0),[o[0],o[1],o[2],1]):null!==(r=c.exec(e))?[r[1],r[2],r[3],1]:null}(t):((n=e.Yn)||(o=document.createElement("canvas"))&&o.getContext&&(n=e.Yn=o.getContext("2d")),n?(n.clearRect(1,1,1,1),n.fillStyle=t,n.fillRect(1,1,1,1),(r=n.getImageData(1,1,1,1))?r.data:null):t)},e.ec=function(t){var n,o,r,i,a;return t instanceof e||"object"==typeof t?t:(n=0,o=0,r=0,i=0,t&&((a=e.hBb(t))&&(o=a[0],r=a[1],i=a[2],n=a[3])),{a:n,r:o,g:r,b:i})},e.jc=function(t,n){var o,r;return 0===n?t:(o=new u(t),r=l((n>0?(240-o.kc)*n:o.kc*n)+"",10),e.gc(o.lc,o.kc+r,o.mc))},e.nc=function(t,n){var o=e.ec(t),r=new u(o).nc(n);return e.bc(r)},e.fc=h,e.gc=p,e}(),t.pc=f},"./src/common/util/common.ts":function(e,t,n){"use strict";var o,r,i,a,s;Object.defineProperty(t,"__esModule",{value:!0}),o=n("./src/common/culture/cultureInfo.ts"),r=n("./src/common/util/util.res.en.ts"),i=n("./src/common/util/types.ts"),t.SR={en:r},a=i.j.Ia,s=function(){function e(e){this.res=e,this.cachedResource=this.iBb(e,!0),this.bBb=0}return e.prototype.getResource=function(){var e=this.iBb(this.res,!this.cachedResource);return e&&(this.cachedResource=e),this.cachedResource},e.prototype.iBb=function(e,t){var n,r,i,s=o.CultureManager.culture();if(e&&s){if(n=o.CultureManager.bBb,this.bBb===n&&!t)return;return this.bBb=n,o.CultureManager.getLanguage(s)?(r=a(!0,{},e.en),o.CultureManager.eBb(s,r),r):(i=s.substr(0,2).toLowerCase(),e.hasOwnProperty(i)?e[i]:e.en)}return{}},e}(),t.ResourceManager=s,t.A=function(e,t,n,o){var r,i,a,s,l;if(e&&0<=n&&n<t){for(r=[],void 0,a=void 0,a=n;a<t;a++)void 0!==e[a]&&r.push(a);for(i=r.length,a=0;a<i;a++)l=e[s=r[i-a-1]],e[s]=null,e[Math.floor(s)+o]=l}},t.B=function(e,t,n,o){var r,i,a,s,l,u;if(e&&0<=n&&n<t){for(r=[],void 0,a=n+o,s=void 0,s=n;s<t;s++)void 0!==e[s]&&(n<=s&&s<a?e[s]=null:s>=a&&r.push(s));for(i=r.length,s=0;s<i;s++)u=e[l=r[s]],e[l]=null,e[Math.floor(l)-o]=u}},t.D=function(e,t){return e.hasOwnProperty(t)},t.F=function(e,t){return e instanceof t}},"./src/common/util/datetimehelper.ts":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v;function b(e,t,n,o){var r,i,s,l,c,f,h,g,y,v,w,x,A,M,S,T,N,I,R,k,E,D,j,_=n.DateTimeFormat,O=_.Calendar.convert;if(!t||!t.length)return n&&n.name.length?O?b(e,_.fullDateTimePattern,n):e.toLocaleString():""+e;function F(){return l||c||(l=f.test(t),c=!0),l}function P(e,t){if(y)return y[t];switch(t){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();default:return}}for(r=_.eras,i="",f=/([^d]|^)(d|dd)([^d]|$)/g,h=0,g=/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|000|00|0|zzz|zz|z|ggg|gg|g|ee|e|\[H\]|\[HH\]|\[h\]|\[hh\]|\[mm\]|\[m\]|\[ss\]|\[s\]/g,!("s"===t)&&O&&(y=O.fromGregorian(e)),v=-2,w=-2,x={Qb:""},A=0;M=g.lastIndex,S=g.exec(t),T=t.slice(M,S?S.index:t.length),x.Qb="",h+=C(T,x),i+=x.Qb,S;A++)if(h%2!=1)switch(N=e.getFullYear(),I=e.getDay(),R=e.getHours(),k=e.getMinutes(),E=e.getSeconds(),D=e.getMilliseconds(),j=e.getTimezoneOffset(),S[0]){case"dddd":i+=_.dayNames[I];break;case"ddd":i+=_.abbreviatedDayNames[I];break;case"dd":l=!0,i+=u(P(e,2),2);break;case"d":l=!0,i+=P(e,2);break;case"MMMM":i+=_.monthGenitiveNames&&F()?_.monthGenitiveNames[P(e,1)]:_.monthNames[P(e,1)];break;case"MMM":i+=_.abbreviatedMonthGenitiveNames&&F()?_.abbreviatedMonthGenitiveNames[P(e,1)]:_.abbreviatedMonthNames[P(e,1)];break;case"MM":i+=u(P(e,1)+1,2);break;case"M":i+=P(e,1)+1;break;case"yyyy":case"yyy":i+=v>=0?a.aBb.ia("ee",e,o):u(y?y[0]:N,4);break;case"yy":i+=v>=0?a.aBb.ia("ee",e,o):u((y?y[0]:N)%100,2);break;case"y":i+=v>=0?a.aBb.ia("e",e,o):""+(y?y[0]:N)%100;break;case"hh":0===(s=R%12)&&(s=12),i+=u(s,2);break;case"h":0===(s=R%12)&&(s=12),i+=s;break;case"HH":i+=u(R,2);break;case"H":i+=""+R;break;case"mm":i+=u(k,2);break;case"m":i+=""+k;break;case"ss":i+=u(E,2);break;case"s":i+=""+E;break;case"tt":i+=R<12?_.amDesignator:_.pmDesignator;break;case"t":i+=(R<12?_.amDesignator:_.pmDesignator).charAt(0);break;case"f":case"0":i+=u(D,3).charAt(0);break;case"ff":case"00":i+=u(D,3).substr(0,2);break;case"fff":case"000":i+=u(D,3);break;case"z":i+=((s=j/60)<=0?"+":"-")+p(d(s));break;case"zz":i+=((s=j/60)<=0?"+":"-")+u(p(d(s)),2);break;case"zzz":i+=((s=j/60)<=0?"+":"-")+u(p(d(s)),2)+":"+u(d(j%60),2);break;case"g":case"gg":case"ggg":if(!r)break;if(v===A-1){v=A;break}i+=a.aBb.ia(S[0],e,o),v=A;break;case"e":case"ee":if(!r){i+=u(y?y[0]:N,4);break}if(w===A-1){w=A;break}i+=a.aBb.ia(S[0],e,o),w=A;break;case"/":i+=_.dateSeparator;break;case"[h]":case"[hh]":case"[H]":case"[HH]":case"[mm]":case"[m]":case"[ss]":case"[s]":i+=S[0];break;default:throw Error(m().Exp_InvalidDateFormat)}else i+=S[0];return""+i}function C(e,t){var n,o,r,i=0,a=h;for(n=0,o=e.length;n<o;n++)switch(r=e.charAt(n)){case'"':a?t.Qb+="'":i++,a=h;break;case"\\":a&&(t.Qb+="\\"),a=!a;break;default:t.Qb+=r,a=h}return i}function w(e,t){var n,o=new Date;return e.DateTimeFormat.eras&&t<100&&((t+=(n=a.aBb.ca(o).ea)-n%100)>e.DateTimeFormat.Calendar.TwoDigitYearMax&&(t-=100)),t}function x(e,t,n){var o,r,a,s,l,u,f,h,p,d,g;if(e.Rb){if(e.Rb[t])return e.Rb[t]}else e.Rb={};for(o=(o=(o=t).replace("%M","M")).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),r="^",a={Qb:""},s=[],l=0,u=0,f=/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|000|00|0|zzz|zz|z|ggg|gg|g|ee|e|\[H\]|\[HH\]|\[h\]|\[hh\]|\[mm\]|\[m\]|\[ss\]|\[s\]/g;(h=f.exec(o))!==c;)if(a.Qb="",p=o.slice(l,h.index),l=f.lastIndex,u+=C(p,a),r+=a.Qb,u%2!=1){switch(h[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gggg":case"ggg":case"gg":case"g":r+="(\\D+)";break;case"tt":case"t":r+="(\\D*)";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":r+="(\\d\\d?\\d?)";break;case"eee":case"ee":case"e":r+=n?"(\\u5143|\\d\\d?)":"(\\d\\d?)";break;case"yyy":case"yyyy":r+="(\\d{2}|\\d{4})";break;case"fff":case"000":r+="(\\d{3})";break;case"ff":case"00":r+="(\\d{2})";break;case"f":case"0":r+="(\\d)";break;case"zzz":r+="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":r+="([+-]?\\d\\d?)";break;case"/":r+="/"===e.dateSeparator?"(\\/)":"([\\/\\"+e.dateSeparator+"])";break;default:throw Error(m().Exp_InvalidDateFormat)}i.k.Sb(s,h[0])}else r+=h[0];return a.Qb="",C(o.slice(l),a),r+=a.Qb,g={Tb:d=(""+(r+="$")).replace(/\s+/g,"\\s+"),Ub:s,_a:RegExp(d)},e.Rb[t]=g,g}function A(e){var t=e.getTimezoneOffset();return-485===t&&(t=-485-43/60),-321===t&&(t=-321-10/60),-507===t&&(t=-507-52/60),t}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./src/common/util/common.ts"),r=n("./src/common/util/stringhelper.ts"),i=n("./src/common/util/arrayhelper.ts"),a=n("./src/common/culture/cultureInfo.ts"),s=n("./src/common/util/types.ts"),l=s.j.Fa,u=r.u.Sa,c=null,f=parseInt,h=!1,p=Math.floor,d=Math.abs,g=new o.ResourceManager(o.SR),m=g.getResource.bind(g),y={},v=function(){function e(){}return e.mb=function(e,t,n,o){return n||(n=a.CultureManager.q4()),b(e,t,n,o)},e.Vb=function(e,t,n){return b(e,t,n||a.CultureManager.q4())},e.gBa=function(t,n,o){var r,i,a,s,l,u=h;for((l=o).slice(1).forEach((function(e){e&&(u=!0)})),u||(l=l.concat(n.ma())),r=1,i=l.length;r<i;r++)if((s=l[r])&&(u=!0,a=e.Wb(t,s,n)))return a;return c},e.Qa=function(t,n,o){var r,i;return n||o||void 0===(i=y[t])?(r=n?[t,n]:[t],i=e.gBa(t,o||a.CultureManager.q4(),r),n||o||(y[t]=i),i?new Date(i):i):i?new Date(i):i},e.lb=function(t,n){return e.gBa(t,a.CultureManager.q4("invariant"),[t,n])},e.Wb=function(e,t,n){var o,i,s,l,u,p,d,g,m,y,v,b,C,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B;if(e=e.trim(),(l=(s=x(o=n.DateTimeFormat,t,i=1041===n.id))._a.exec(e))===c)return c;for(u=s.Ub,p=c,d=c,g=c,m=c,y=c,v=0,C=0,A=0,M=0,S=c,T=h,N=h,I=0,R=u.length;I<R;I++)if(k=l[I+1])switch(u[I]){case"dd":case"d":if((m=f(k,10))<1||m>31)return c;break;case"MMMM":if((g=n.oa(k))<0||g>11)return c;break;case"MMM":if((g=n.ra(k))<0||g>11)return c;break;case"M":case"MM":case"%M":if((g=f(k,10)-1)<0||g>11)return c;break;case"e":case"ee":if((d=i&&""===k?1:w(n,f(k,10)))<0||d>9999)return c;break;case"y":case"yy":case"yyy":case"yyyy":if((d=f(k,10))<0||d>9999)return c;break;case"h":case"hh":case"H":case"HH":if((v=f(k,10))<0)return c;break;case"m":case"mm":if((C=f(k,10))<0||C>59)return c;break;case"s":case"ss":if((A=f(k,10))<0||A>59)return c;break;case"tt":case"t":if(T=(E=k.toUpperCase())===o.pmDesignator.toUpperCase(),N=E===o.amDesignator.toUpperCase(),!T&&!N)return c;break;case"f":case"0":if((M=100*f(k,10))<0||M>999)return c;break;case"ff":case"00":if((M=10*f(k,10))<0||M>999)return c;break;case"fff":case"000":if((M=f(k,10))<0||M>999)return c;break;case"dddd":if((y=n.ua(k))<0||y>6)return c;break;case"ddd":if((y=n.wa(k))<0||y>6)return c;break;case"zzz":if(2!==(D=k.split(/:/)).length)return c;if((b=f(D[0],10))<-12||b>13)return c;if((j=f(D[1],10))<0||j>59)return c;S=60*b+(r.u.kb(k,"-")?-j:j);break;case"z":case"zz":if((b=f(k,10))<-12||b>13)return c;S=60*b;break;case"g":case"gg":case"ggg":if(!(_=k)||!o.eras)return c;if((p=a.aBb.ha(u[I],_))<0)return c}if(F=(O=/^(\d|\d\d|\d\d\d):/.test(e))?new Date(1899,11,30):new Date,(H=o.Calendar.convert)&&(P=H.fromGregorian(F)),H||(P=[F.getFullYear(),F.getMonth(),F.getDate()]),d===c?d=P[0]:d<100&&(o.eras&&p!==c?d=a.aBb.ga(p||0,d):d+=d>=30?1900:2e3),g===c&&(g=P[1]),m===c&&(m=O?P[2]:1),H){if((F=H.toGregorian(d,g,m))===c)return c}else{if(F.setFullYear(d,g,m),F.getDate()!==m)return c;if(y!==c&&F.getDay()!==y)return c}return T&&v<12?v+=12:N&&12===v&&(v=0),F.setHours(v,C,A,M),S!==c&&(B=F.getMinutes()-(S+F.getTimezoneOffset()),F.setHours(F.getHours()+B/60,B%60)),F},e.Xb=function(e){var t,n=e-25569,o=n>=0?1:-1,r=A(new Date(864e5*n)),i=(864e5*e*1440+o-3181192704e6+864e5*r)/1440,a=new Date(i),s=r>=0?1:-1,l=A(new Date(i+36e5*s));if(r!==l)if(t=new Date(i+60*(l-r)*1e3),r>l){if(-1===s||l===A(a))return 999===t.getMilliseconds()?new Date(t.valueOf()+1):t}else if(r<l&&(1===s||l===A(a)))return 999===t.getMilliseconds()?new Date(t.valueOf()+1):t;return 999===a.getMilliseconds()?new Date(a.valueOf()+1):a},e.Rka=function(t){if("/OADate("===t.substr(0,8)){var n=parseFloat(t.substr(8,t.length-10));return e.Xb(n)}},e.Daa=function(t){return"/OADate("+e.Ra(t)+")/"},e.Ra=function(e){if(l(e))return 0;"number"==typeof e&&(e=new Date(e));var t=A(e);return(1440*e.getTime()+3181192704e6-864e5*t)/124416e6},e.Yb=function(t){var n,o,r=c,i=!0;if(l(t)?r=e.Xb(0):t instanceof Date?r=new Date(t.valueOf()):"string"==typeof t?((n=e.Qa(t))||(isNaN(t)?e.fvb(t)?i=h:(n=new Date(t),isNaN(n.valueOf())&&(i=h),(o=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/.exec(t.replace(/ |\n/g,"").trim()))&&4===o.length&&(-1!==o.indexOf(""+n.getFullYear())&&-1!==o.indexOf(""+(n.getMonth()+1))&&-1!==o.indexOf(""+n.getDate())||(i=h))):(n=e.Xb(parseFloat(t)))||(i=h)),r=n):"number"==typeof t?r=e.Xb(t):i=h,i)return r;throw m().Exp_InvalidCast},e.fvb=function(e){var t=a.CultureManager.q4().DateTimeFormat,n=function(e,t){var n=0;return t.forEach((function(t){t&&e.indexOf(t)>-1&&n++})),n>1};return n(e,t.monthNames)||n(e,t.abbreviatedMonthNames)||n(e,t.dayNames)||n(e,t.abbreviatedDayNames)||function(e,t){if(e&&e.indexOf(" ")>-1){var n=e.split(" "),o=n.length;return o>=2&&t.indexOf(n[o-2])<=-1&&!isNaN(n[o-1])}return!1}(e,t.monthNames.concat(t.abbreviatedMonthNames))},e.Ska=function(e){return e&&(e.constructor===Date||e.getUTCDate&&e.setFullYear)},e}(),t.l=v},"./src/common/util/functionhelper.ts":function(e,t,n){"use strict";var o,r,i;function a(e){return e}function s(e,t,n,a,s,l,u,c,f,h,p){var d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P=n[r],H=n[i],B=t[r],L=t[i],z=a[r],V=a[i],G=1===H,W=1===L;if(B===P&&L===H){for(k=0,E=0,D=0,j=0,C=P*H,d=0;d<P;d++)for(g=0;g<H;g++){if(y=l(n[d][g]),v=l(t[d][g]),e&&(o(y)||o(v)))return f;k+=y,E+=y*y,D+=v=h(v),j+=y*v}for(_=C*j-k*D,b=s?_/(C*E-k*k):j/E,w=s?(D*E-k*j)/(C*E-k*k):0,x=[],d=0;d<z;d++)for(x[d]=[],g=0;g<V;g++){if(y=l(a[d][g]),e&&o(y))return f;x[d][g]=0===_?t[0][0]:p(b*y+w)}return u?new u(x):x}if(W&&B===P||1===B&&L===H){for(y=[],v=[],I=H+1,R=H+2,d=0;d<P;d++){if(w=l(M=W?t[d][0]:t[0][d]),e&&o(w))return f;v[d]=G?h(w):w}for(d=0;d<P;d++)for(y[d]=[],g=0;g<H;g++){if(w=l(n[d][g]),e&&o(w))return f;y[d][g]=w}for(O=[],b=0;b<I;b++)for(O[b]=[],C=0;C<R;C++)O[b][C]=0;for(m=0;m<P;m++)for(O[0][I]+=v[m],d=0;d<H;d++)for(M=d+1,O[0][M]+=y[m][d],O[M][0]=O[0][M],O[M][I]+=y[m][d]*v[m],g=d;g<H;g++)O[T=g+1][M]+=y[m][d]*y[m][g],O[M][T]=O[T][M];for(O[0][0]=P,A=F=s?0:1;A<I;A++){if(e){if(0===O[A][A]){for(N=!1,g=A+1;!N&&g<I;g++)if(0!==O[g][A]){for(m=0;m<R;m++)T=O[A][m],O[A][m]=O[g][m],O[g][m]=T;N=!0}if(!N)return c}}else{for(d=A;d<I&&0===O[d][A];)d++;if(d>=I)return c;for(S=F;S<R;S++)M=O[A][S],O[A][S]=O[d][S],O[d][S]=M}for(M=1/O[A][A],S=F;S<R;S++)O[A][S]*=M;for(d=F;d<I;d++)if(d!==A)for(M=-O[d][A],S=0;S<R;S++)O[d][S]+=M*O[A][S];s||(O[0][I]=0)}for(x=[],W||(x[0]=[]),d=0;d<z;d++){for(W&&(x[d]=[]),M=O[0][I],g=0;g<H;g++){if(w=l(W?a[d][g]:a[g][d]),e&&o(w))return f;M+=O[g+1][I]*w}W?x[d][0]=p(M):x[0][d]=p(M)}return u?new u(x):x}return c}Object.defineProperty(t,"__esModule",{value:!0}),o=isNaN,r="rowCount",i="colCount",t.qc=function(e,t,n,o,r,i,l,u){return s(!0,e,t,n,o,r,i,u,l,a,a)},t.sc=function(e,t,n,o,l,u,c){var f,h;for(f=0;f<e[r];f++)for(h=0;h<e[i];h++)if(e[f][h]<=0)return u;return s(!1,e,t,n,o,a,l,c,null,Math.log,Math.exp)}},"./src/common/util/numberhelper.ts":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k;function E(e,t,n,o){return t&&0!==t.length&&"i"!==t?function(e,t,n,o){var r=_(t);return V(e,r,n,o)}(e,t,n.NumberFormat,o):n&&n.name.length>0?e.toLocaleString():""+e}function D(e,t){for(var n,o,r,i,a,s,l,u=m(y(e)),c={Xa:1,Ya:0};u>=10;)u/=10,c.Xa++;return o=(n=""+e).search(/e/gi),r=n.indexOf(t),-1!==o?(a=x(n,0,o),s=x(n,o+1),l=0,-1!==r&&(l=x(a,r+1).length),(i=l-p(s))<0&&(i=0),c.Ya=i):(i=0,-1!==r&&(i=x(n,r+1).length),c.Ya=i),c}function j(e){var t,n={Za:e.charAt(0),$a:0,_a:0},o="";for(t=1;t<e.length;t++)if("+"===(o=e.charAt(t)))n.$a=1;else{if("-"!==o){if("0"===o){n._a=e.length-t;break}throw Error(S().Exp_InvalidExponentFormat)}n.$a=-1}return n}function _(e){var t,n,o,r,i,a,s={ab:f,bb:f,cb:d,eb:0,fb:0,Rja:0,hb:f},l="",u=d,c=d,h=d,p=d,m=d,y=d,v=f,b=[];for(n=0;n<e.length;n++){if(t=e.charAt(n),u)l+=t,'"'===t&&(b.push(l),l="",u=d);else if(c){if("E"===v||"e"===v){if(!(["+","-","0"].indexOf(t)>=0)){c=d,n--;continue}l+=t}else if("+"===v||"-"===v){if("0"!==t){c=d,n--;continue}l+=t}else if("0"===v){if("0"!==t){c=d,m||(m=g,s.hb=j(l)),n--;continue}l+=t}}else if("*"!==v&&"_"!==v&&"\\"!==v||""===l)if("*"===t||"_"===t||"\\"===t)y=d,""!==l&&(b.push(l),l=""),l+=t;else if("'"===t)y=d,""!==l&&(b.push(l),l=""),b.push(t);else if('"'===t)y=d,u=g,""!==l&&(b.push(l),l=""),l+=t;else if(R.indexOf(t)>=0)y=g,R.indexOf(v)<0&&""!==l&&(b.push(l),l=""),l+=t;else if("."!==t||h)if("%"===t)y=d,s.fb++,""!==l&&(b.push(l),l=""),b.push(t);else if(""===t)y=d,s.Rja++,""!==l&&(b.push(l),l=""),b.push(t);else if(","===t)if(y){for(o=void 0,""!==l&&(b.push(l),l=""),r=g,i="",a=n+1;a<e.length;a++)if(o=e.charAt(a),""===i)if('"'===o)i=o;else{if(R.indexOf(o)>=0){r=d;break}if("."===o||";"===o)break}else'"'===o&&(i="");r?s.eb++:h||(o=e.charAt(n+1))&&R.indexOf(o)>=0&&(p=g)}else l+=t;else"E"===t||"e"===t?(y=d,c=g,""!==l&&(b.push(l),l=""),l+=t):(y=d,R.indexOf(v)>=0&&""!==l&&(b.push(l),l=""),l+=t);else""!==l&&(b.push(l),l=""),s.ab=b,b=[],h=g,y=d;else l+=t,b.push(l),l="";v=t}return""!==l&&(c&&!m&&(s.hb=j(l)),b.push(l)),p&&(s.cb=g),h?s.bb=b:s.ab=b,s}function O(e,t,n,o){var r,i,a,s,l,u=t[0],c=1,f=0,h=d,p=e.length;for(r=0;r<p;r++)if("number"===(i=e[r].type)){for(a="",l=(s=e[r].value).length-1;l>=0;){if(!(1<=u&&u<=9||0===u&&c===t.length))throw Error(S().Exp_InvalidNumberGroupSize);/\d/gi.test(s[l])?(h&&(a&&e.push({type:"number",value:a}),e.push({type:"groupSeparator",value:n}),a="",h=d),f++):f=0,a=s[l]+a,f===u&&u>0&&(h=g,f=0,c<t.length&&(u=t[c],c++)),l--}a&&e.push({type:i,value:a})}else"fillingChar"===i&&(o.infillIndex=e.length-p),e.push({type:i,value:e[r].value});return e.splice(0,p)}function F(e,t,n,o,r,i){var a,s,l,f,p=U(e,-t);return isFinite(p)||(p=e),f=(a=""+(e=p)).split(/e/i),a=f[0],l=f.length>1?h(f[1],10):0,f=a.split("."),a=f[0],s=f.length>1?f[1]:"",l>0?(a+=(s=c(s,l)).slice(0,l),s=x(s,l)):l<0&&(l=-l,s=(a=e<0?i+u(a.replace(i,""),l+1):u(a,l+1)).slice(-l,a.length)+s,a=a.slice(0,-l)),t>0?s=r+(s=s.length>t?s.slice(0,t):c(s,t)):s="",a+s}function P(e,t,n,o){var r=e;return t>0&&(r=q(e*v(100,t),15)),n>0&&(r=q(e*v(1e3,n),15)),o>0&&(r=q(e/v(1e3,o),15)),r}function H(e){var t,n,o=f;if(e)for(o="",t=0;t<e.length;t++)n=e[t],/^(0|#|\?)+/g.test(n)&&(o+=n);return o}function B(e,t,n){var o,r={value:e,exponentValue:0},i=D(e,".").Xa,a=y(e),s=n?n.length:1;if(a>=1)i>s?(i-=s,r.value=e/v(10,i),r.exponentValue=i):r.exponentValue=0,-1===t.$a&&(t.$a=0);else if(a<1&&a>0){for(t.$a=-1,o=v(10,s);10*a<o;)a*=10,r.exponentValue++;r.value*=v(10,r.exponentValue)}return r}function L(e,t,n,o,r,i,a,s){var l,c,f,h,p,d,m,y,v,b,C,w=s.numberGroupSizes,A=s.numberGroupSeparator,M=s.negativeSign,S=s.percentSymbol,T=s.perMilleSymbol,N=o.hb,R=x(t,0,1);for(R===M&&(t=x(t,1)),t=0===(l=1===t.length&&"0"===t?0:t.length)?"":t,c=0,f="",h=e.length-1;h>=0;h--)if(p="",d=e[h],/^(0|#|\?)+/g.test(d)){if(f!==n){for(m=d.length,y=l-c-1;y>=0&&m>0;y--)p=t.charAt(y)+p,m--,c++;for(v=m-1;v>=0;v--)c++,"0"===(b=d[v])?p=b+p:"?"===b&&(""!==p&&(i.push({type:"number",value:p}),p=""),i.push({type:"numberPlaceholder",value:b}));(f=d+f)===n&&c<l&&(p=t.substr(0,l-c)+p),""!==p&&i.push({type:"number",value:p})}}else o.hb&&!a.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(d)?(a.replaceExponent=g,C="",C+=N.Za,C+=I[N.$a],C+=u(""+r,N._a),i.push({type:"exponent",value:C})):"_"===d[0]?i.push({type:"placeholder",value:d[1]}):"*"===d[0]?a.hasInfilling||(i.push({type:"fillingChar",value:d[1]}),a.hasInfilling=!0,a.infillIndex=i.length-1):"\\"===d[0]?2===d.length&&i.push({type:"text",value:d[1]}):'"'===d[0]&&'"'===d[d.length-1]?d.length>2&&i.push({type:"text",value:d.substr(1,d.length-2)}):d===S?i.push({type:"percent",value:d}):d===T?i.push({type:"permille",value:d}):k[d]?i.push({type:"currency",value:d}):i.push({type:"text",value:d});R===M&&n&&i.push({type:"text",value:R}),o.cb===g&&O(i,w,A,a),i.reverse(),a.infillIndex=i.length-1-a.infillIndex}function z(e,t,n,o,r,i,a,s,l){var c,f,h,p,d,m,y,v,b,C,w,x,A=l.numberDecimalSeparator,M=l.percentSymbol,S=l.perMilleSymbol,R=t.indexOf(A),E=r.hb;for((R>0||o!==T||n!==N)&&a.push({type:"decimalSeparator",value:A}),c=-1!==R?t.substring(R+1):"",f=0,h="",p=0;p<e.length;p++)if(d=e[p],/^(0|#|\?)+/g.test(d)){if(m="",h!==n){for(y=d.length,v=0,b=f;y>0&&c.length-f>0;)m+=c.charAt(b),y--,f++,v++,b++;for(C=v;y>0;)w=d[C],C++,f++,y--,"0"===w?m+=w:"?"===w&&(""!==m&&(a.push({type:"number",value:m}),m=""),a.push({type:"numberPlaceholder",value:w}));""!==m&&a.push({type:"number",value:m}),h+=d}}else E&&!s.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(d)?(s.replaceExponent=g,x="",x+=E.Za,x+=I[E.$a],x+=u(""+i,E._a),a.push({type:"exponent",value:x})):"_"===d[0]?a.push({type:"placeholder",value:d[1]}):"*"===d[0]?(a.push({type:"fillingChar",value:d[1]}),s.hasInfilling&&a.splice(s.infillIndex,1),s.hasInfilling=!0,s.infillIndex=a.length-1):"\\"===d[0]?2===d.length&&a.push({type:"text",value:d[1]}):'"'===d[0]&&'"'===d[d.length-1]?d.length>2&&a.push({type:"text",value:d.substr(1,d.length-2)}):d===M?a.push({type:"percent",value:d}):d===S?a.push({type:"permille",value:d}):k[d]?a.push({type:"currency",value:d}):a.push({type:"text",value:d})}function V(e,t,n,o){var r,i,a,s,l,u,c,f,h,p,g,m,y=[];return e=P(e,t.fb,t.Rja,t.eb),r=t.ab,i=t.bb,r||i?(a=H(r),(s=H(i))||(s=""),t.hb&&(e=(u=B(e,t.hb,a)).value,l=u.exponentValue),c=D(e,"."),n.numberGroupSizes,n.numberGroupSeparator,f=n.numberDecimalSeparator,h=n.negativeSign,p=F(e,b(c.Ya,s.length),0,0,f,h),o||(p=function(e,t){var n=e;return-1!==e.indexOf(t)&&(n=e.replace(/0+$/,"")),n}(p,f)),""===p?(y.push({type:"text",value:(r?r.join(""):"")+(i?i.join(""):"")}),y):(g={hasInfilling:d,infillIndex:-1,replaceExponent:d},"10"!==(m=p.split(f)[0])||isNaN(l)||(m="1",l+=t&&t.hb&&-1===t.hb.$a?-1:1),r&&L(r,m,a,t,l,y,g,n),"0"!==m&&""===a&&i&&y.push({type:"number",value:m}),i&&z(i,p,s,a,t,l,y,g,n),y)):y}function G(e,t){var n,o,r,i,s,u,c,d,g,m,y,v,b,C,w,A;return(e=l(e)?"":a.u.ib(e,"")).match(/^[+-]?infinity$/i)?p(e):e.match(/^0x[a-f0-9]+$/i)?h(e,10):(i=(r=W(e,n=t.NumberFormat,o=n.numberNegativePattern))[0],s=r[1],""===i&&1!==o&&(i=(r=W(e,n,1))[0],s=r[1]),""===i&&(i="+"),s[0]===n.currencySymbol&&(s=x(s,1)),(d=s.indexOf("e"))<0&&(d=s.indexOf("E")),d<0?(c=s,u=f):(c=x(s,0,d),u=x(s,d+1)),(y=c.indexOf("."))<0?(g=c,m=f):(g=x(c,0,y),m=x(c,y+1)),g=g.split(",").join(""),","!==(v=",".replace(/\u00A0/g," "))&&(g=g.split(v).join("")),b=i+g,m!==f&&(b+="."+m),b[b.length-1]===n.percentSymbol&&(b=x(b,0,b.length-1),-1===(C=(b=a.u.ib(b,"")).indexOf("."))&&(C=b.length),w="",w+=x(b,0,C-2),w+=".",w+=x(b,C-2,2),b=w+=x(b,C+1)),u!==f&&(""===(A=W(u,n,1))[0]&&(A[0]="+"),b+="e"+A[0]+A[1]),b.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?p(b):NaN)}function W(e,t,n){var o=t.negativeSign,r=t.positiveSign;if(4!==n&&2!==n||(o=" "+o,r=" "+r),4===n||3===n){if(a.u.jb(e,o))return["-",x(e,0,e.length-o.length)];if(a.u.jb(e,r))return["+",x(e,0,e.length-r.length)]}else if(2===n||1===n){if(a.u.kb(e,o))return["-",x(e,o.length)];if(a.u.kb(e,r))return["+",x(e,r.length)]}else{if(0!==n)throw Error("");if(a.u.kb(e,"(")&&a.u.jb(e,")"))return["-",x(e,1,e.length-2)]}return["",e]}function U(e,t){var n,o;return e=+e,t=+t,isNaN(e)||t%1!=0?NaN:(e=(n=e<0)?-e:e,void 0===typeof t||0===t?(e=Math.round(e),n?-e:e):(o=(""+e).split("e"),e=Math.round(+(o[0]+"e"+(o[1]?+o[1]-t:-t))),+((o=(""+(e=n?-e:e)).split("e"))[0]+"e"+(o[1]?+o[1]+t:t))))}function Z(e){var t=s.CultureManager.q4().NumberFormat;return"string"==typeof e&&(t=s.CultureManager.q4(e).NumberFormat),t}function q(e,t){return"number"==typeof e&&(""+e).length>=t&&(e=+e.toPrecision(t)),e}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./src/common/util/common.ts"),r=n("./src/common/util/types.ts"),i=n("./src/common/util/regexhelper.ts"),a=n("./src/common/util/stringhelper.ts"),s=n("./src/common/culture/cultureInfo.ts"),l=r.j.Fa,u=a.u.Sa,c=a.u.Ta,f=null,h=parseInt,p=parseFloat,d=!1,g=!0,m=Math.floor,y=Math.abs,v=Math.pow,b=Math.min,C="#dot#",w="#group#",x=function(e,t,n){return e.substr(t,n)},A=function(e){return i.q.qb(e)},M=new o.ResourceManager(o.SR),S=M.getResource.bind(M),T="##################0",N="################",I={1:"+",0:"","-1":"-"},R=["0","#","?"],k={"":"",Br:"Br",Fdj:"Fdj",Nfk:"Nfk",R:"R",$:"$",FCFA:"FCFA","GH":"GH","":"","..":"..",XDR:"XDR","..":"..","..":"..","..":"..","..":"..","":"","..":"..","..":"..","...":"...","..":"..","..":"..","..":"..","..":"..","..":"..","..":"..","..":"..","..":"..",S:"S","":"","..":"..","..":"..","..":"..","":"",TSh:"TSh","":"","":"","":"",K:"K",".":".","":"",CFA:"CFA","":"","":"",KM:"KM","":"",USh:"USh","K":"K","kr.":"kr.",Ksh:"Ksh",CHF:"CHF",".":".","Nu.":"Nu.",EC$:"EC$",P:"P",US$:"US$",D:"D",Rp:"Rp",Ar:"Ar",MOP$:"MOP$",Rs:"Rs",MK:"MK",RM:"RM","":"",RF:"RF",SR:"SR",SDG:"SDG",Le:"Le","NAf.":"NAf.",E:"E",T$:"T$",VT:"VT",WS$:"WS$",Bs:"Bs","":"",Q:"Q",L:"L",C$:"C$","B/.":"B/.","S/.":"S/.","":"","Bs.":"Bs.","":"",FG:"FG",UM:"UM",kr:"kr",FBu:"FBu",FC:"FC",DA:"DA",G:"G",CF:"CF",DH:"DH",FCFP:"FCFP",LS:"LS",DT:"DT",kn:"kn",HUF:"HUF","":"",ISK:"ISK","":"","":"","":"","":"","":"","":"",Kz:"Kz","":"",MTn:"MTn","":"","":"","":"","Afl.":"Afl.",".":".",".":".","z":"z","":"",R$:"R$",Db:"Db",RON:"RON","":"",MAD:"MAD",".":".","Lek":"Lek",den:"den",RSD:"RSD",".":".","..":"..","Rs.":"Rs.","":"","":"","m.":"m.","":"","":"","som":"som","":"","":"",HK$:"HK$",MOP:"MOP",NT$:"NT$"},t.o={Qa:function(e){return G(e,s.CultureManager.q4())},lb:function(e){return G(e,s.CultureManager.q4("invariant"))},mb:function(e,t,n,o){return n||(n=s.CultureManager.q4()),E(e,t,n,o)},nb:function(e,t){var n,o,r;return"string"!=typeof e||(o=(n=Z(t)).numberDecimalSeparator,r=n.numberGroupSeparator,"."!==o&&(e=e.replace(A("[.]"),C)),","!==r&&(e=e.replace(A("[,]"),w)),"."!==o&&(e=e.replace(A(C),o)),","!==r&&(e=e.replace(A(w),r))),e},Oa:function(e,t){var n,o,r;return"string"!=typeof e||(o=(n=Z(t)).numberDecimalSeparator,r=n.numberGroupSeparator,"."!==o&&(e=e.replace(A("["+o+"]"),C)),","!==r&&(e=e.replace(A("["+r+"]"),w)),"."!==o&&(e=e.replace(A(C),".")),","!==r&&(e=e.replace(A(w),","))),e},Xia:function(e,t){var n,o,r;return!("string"==typeof e&&(n=Z(t),o=n.numberDecimalSeparator,r=n.numberGroupSeparator,"."!==o&&"."!==r&&e.indexOf(".")>=0||","!==o&&","!==r&&e.indexOf(",")>=0))},ob:function(e,t){return p(this.Oa(e,t))},pb:function(e,t,n){if(0!==y(m(e)-e))throw Error(S().Exp_BadFormatSpecifier);var o=e>=0?e.toString(16):(4294967295+e+1).toString(16);return o=t?o.toLowerCase():o.toUpperCase(),!l(n)&&o.length<n?u(o,n):o},Hja:_,Ija:V,Jja:function(e){var t,n,o,r="";if(Array.isArray(e)&&e.length>0)for(t=0;t<e.length;t++)if(n=e[t].type,o=e[t].value,"placeholder"===n)r+=" ";else{if("fillingChar"===n)continue;r+="numberPlaceholder"===n?" ":o}return r},eka:T,fka:N,Lma:q}},"./src/common/util/regexhelper.ts":function(e,t,n){"use strict";var o,r,i;Object.defineProperty(t,"__esModule",{value:!0}),o=n("./src/common/util/stringhelper.ts"),r=!0,i=function(){function e(){}return e.qb=function(t){var n=e.rb[t];return n||(n=e.rb[t]=RegExp(t,"g")),n.lastIndex=0,n},e.sb=function(t){var n=e.tb[t];return n||(n=e.tb[t]=RegExp(t,"gi")),n.lastIndex=0,n},e.ub=function(t,n,o){var i,a,s,l,u;if(e.vb[t])return e.wb[t];if("[~?*]+",e.qb("[~?*]+").test(t)){for(i=[],a=t.split(""),s=void 0,l={".":r,"+":r,$:r,"^":r,"[":r,"]":r,"(":r,")":r,"{":r,"}":r,"|":r,"/":r},u=0;u<a.length;u++)"~"===(s=a[u])&&u<a.length-1?("*"===(s=a[++u])||"?"===s?i.push("\\"):n&&i.push("~"),i.push(s)):"?"===s?i.push("."):"*"===s?(i.push("[\\s\\S]"),o?i.push("+"):i.push("*")):l[s]?(i.push("\\"),i.push(s)):i.push(s);return i.join("")}return null},e.zb=function(t,n,o){var r=e.ub(t,n,o);return r&&(r="^"+r+"$"),r},e.xb=function(e,t){for(var n="#"+e+"0#",r=1;t.indexOf(n)>0;)n=o.u.yb(n,"#"+e+(r-1)+"#","#"+e+r+"#"),r++;return n},e.Ab=function(e){return e.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},e.rb={},e.tb={},e.vb={},e.wb={},e}(),t.q=i},"./src/common/util/stringhelper.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("./src/common/util/regexhelper.ts");function r(e,t,n){return e.substr(t,n)}function i(e){return null==e}function a(e,t,n,o){var r,a;if(i(t))throw Error();return""===t||!(t.length>e.length)&&(r=e,a=t,n&&(r=r.toLowerCase(),a=a.toLowerCase()),o(r,a))}t.u={Bb:function(e,t,n){return n&&(e=e.toLowerCase(),t=t.toLowerCase()),""===t||e.indexOf(t)>=0},Cb:function(e,t,n){var o,r;return n?(o=e.toLowerCase(),r=t.toLowerCase(),o.indexOf(r)):e.indexOf(t)},Db:function(e,t){if(!t)return e;for(var n=e;r(n,0,t.length)===t;)n=r(n,t.length);return n},ib:function(e,t){if(!t)return e;for(var n=e;r(n,n.length-t.length,t.length)===t;)n=r(n,0,n.length-t.length);return n},Eb:function(e,t,n){if(t<0||t>e.length||i(n))throw Error();return r(e,0,t)+n+r(e,t,e.length-t)},Fb:function(e,t,n){if(i(n)&&(n=e.length-t),t<0||n<0||t+n>e.length)throw Error();return r(e,0,t)+r(e,t+n,e.length-t-n)},kb:function(e,t,n){return void 0===n&&(n=!1),a(e,t,n,(function(e,t){return e.slice(0,t.length)===t}))},jb:function(e,t,n){return void 0===n&&(n=!1),a(e,t,n,(function(e,t){return e.slice(-t.length)===t}))},Gb:function(e,t,n,o){if(!t)throw Error();return n=(""+n).replace(/\$/g,"$$$$"),e.replace(RegExp(t,"g"+(o?"i":"")),n)},Hb:function(e,n,r,i){return n=o.q.Ab(n),t.u.Gb(e,n,r,i)},Ib:function(e,t){var n=e.indexOf(t);return n<0||n>=e.length?e:r(e,0,n)},Jb:function(e,t){for(var n=0,o=e.indexOf(t);o>=0;)n+=1,o=e.indexOf(t,o+1);return n},yb:function(e,t,n){return e.split(t).join(n)},Kb:function(e,t){var n,o,r=e;for(n=0;n<t.length;n++)o=RegExp("\\{"+n+"\\}","g"),r=r.replace(o,t[n]);return r},Lb:function(e,t,n){var o,r=""+e;for(o=r.length;o<t;o++)r=n?"0"+r:r+"0";return r},Sa:function(e,n){return t.u.Lb(e,n,!0)},Ta:function(e,n){return t.u.Lb(e,n,!1)},Mb:function(e,t){return e===t||!e&&!t||e&&t&&e.toLowerCase()===t.toLowerCase()},Nb:function(e){return e.toUpperCase()},Ob:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},n=o.q.qb("(?:&|<|>|\"|'|`)");return n.test(e)?e.replace(n,(function(e){return t[e]})):e},Pb:function(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`"},n=o.q.qb("(?:&amp;|&lt;|&gt;|&quot;|&#x27;|&#x60;)");return n.test(e)?e.replace(n,(function(e){return t[e]})):e},BIc:function(e){return e.replace(/javascript:/gi,"")}}},"./src/common/util/types.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.j={r4:null,H:function(e,n){var o,r,i;if(t.j.ya(e))for(o=0,r=e.length;o<r&&!1!==n.call(e[o],o,e[o]);o++);else for(i in e)if(e.hasOwnProperty(i)&&!1===n.call(e[i],i,e[i]))break;return e},za:function(e){return!e||"object"==typeof e&&0===Object.keys(e).length},Aa:function(e){return"function"===t.j.Ba(e)},Ca:function(e){return Array.isArray?Array.isArray(e):"array"===t.j.Ba(e)},Da:function(e){return t.j.jk(e)&&(e=parseFloat(e)),!isNaN(e)&&isFinite(e)},jk:function(e){return"string"==typeof e},Ba:function(e){var n,o,r,i,a,s;if(null===e)return"null";if(!(n=t.j.r4))for(n=t.j.r4={},r=0,i=(o=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"]).length;r<i;r++)n["[object "+o[r]+"]"]=o[r].toLowerCase();return a=n.toString,"object"===(s=typeof e)||"function"===s?n[a.call(e)]||"object":s},Ea:function(e,n,o){var r,i;if(n){if(i=[].indexOf)return i.call(n,e,o);for(r=n.length,t.j.Fa(o)&&(o=0),o=o<0?Math.max(0,r+o):o;o<r;o++)if(o in n&&n[o]===e)return o}return-1},Ga:function(e,t){var n=t.length,o=e.length,r=0;if("number"==typeof n)for(;r<n;r++)e[o++]=t[r];else for(;void 0!==t[r];)e[o++]=t[r++];return e.length=o,e},Ha:function(e,n,o){var r,i,a,s,l=[];if(t.j.ya(e))for(i=0,a=e.length;i<a;i++)null!==(r=n(e[i],i,o))&&(l[l.length]=r);else for(s in s=void 0,e)e.hasOwnProperty(s)&&(null!==(r=n(e[s],s,o))&&(l[l.length]=r));return l.concat([])},Ia:function(){var e,n,o,r,i,a,s,l,u,c,f,h=[];for(e=0;e<arguments.length;e++)h[e]=arguments[e];for(l=h[0]||{},u=1,c=h.length,f=!1,"boolean"==typeof l&&(f=l,l=h[1]||{},u=2),"object"==typeof l||t.j.Aa(l)||(l={}),c===u&&(l=this,--u);u<c;u++)if(a=h[u],!t.j.Fa(a))for(i in a)n=l[i],l!==(r=a[i])&&(o=t.j.Ca(r),f&&r&&(t.j.Ja(r)||o)?(s=o?n&&t.j.Ca(n)?n:[]:n&&t.j.Ja(n)?n:{},l[i]=t.j.Ia(f,s,r)):void 0!==r&&(l[i]=r));return l},G:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o},Ka:function(e){return null!==e&&e===e.window},Ja:function(e){var n,o;if(!e||"object"!==t.j.Ba(e)||e.nodeType||t.j.Ka(e))return!1;n={}.hasOwnProperty;try{if(e.constructor&&!n.call(e,"constructor")&&!n.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}for(o in e);return void 0===o||n.call(e,o)},ya:function(e){if(t.j.Fa(e))return!1;var n=e.length,o=t.j.Ba(e);return!t.j.Ka(e)&&(!(1!==e.nodeType||!n)||"array"===o||"function"!==o&&(0===n||"number"==typeof n&&n>0&&n-1 in e))},La:function(e,n){var o=n||[];return null!==e&&(t.j.ya(Object(e))?t.j.Ga(o,"string"==typeof e?[e]:e):[].push.call(o,e)),o},Ma:null,Fa:function(e){return null==e},Na:null,Pa:null,C4:function(e){if(!e)return e;if("number"==typeof e||"string"==typeof e||"boolean"==typeof e||t.j.Fa(e))return e;if(e.clone)return e.clone();if(e instanceof Date)return new Date(e.valueOf());var n,o,r;for(o in n=e instanceof Object?new e.constructor:new e.constructor(e.valueOf()),e)e.hasOwnProperty(o)&&(r=e[o],e.hasOwnProperty(o)&&n[o]!==r&&(n[o]="object"==typeof r?t.j.C4(r):r));return n.toString=e.toString,n.valueOf=e.valueOf,n}}},"./src/common/util/util.res.en.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_InvalidDateFormat="Invalid date format pattern",t.Exp_InvalidExponentFormat="invalid exponent format",t.Exp_InvalidSemicolons="invalid format : too many semicolons",t.Exp_InvalidNumberGroupSize="NumberGroupSize must be between 1 and 9, except for the last element, which can be zero.",t.Exp_BadFormatSpecifier="Bad Format Specifier",t.Exp_InvalidNumberFormat="Invalid number format pattern",t.Exp_InvalidCast="InvalidCastException",t.Exp_Separator="numberDecimalSeparator, listSeparator and arrayListSeparator should be different in cluture info."},"./src/plugins/commands/commands.entry.ts":function(e,t,n){"use strict";var o,r;Object.defineProperty(t,"__esModule",{value:!0}),o=n("./src/plugins/commands/commands.ts"),t.Key=o.Key,t.CommandManager=o.CommandManager,r=n("./src/plugins/commands/undomanager.ts"),t.UndoManager=r.UndoManager},"./src/plugins/commands/commands.ts":function(e,t,n){"use strict";var o,r,i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.left=37]="left",e[e.right=39]="right",e[e.up=38]="up",e[e.down=40]="down",e[e.tab=9]="tab",e[e.enter=13]="enter",e[e.shift=16]="shift",e[e.ctrl=17]="ctrl",e[e.space=32]="space",e[e.altkey=18]="altkey",e[e.home=36]="home",e[e.end=35]="end",e[e.pup=33]="pup",e[e.pdn=34]="pdn",e[e.backspace=8]="backspace",e[e.del=46]="del",e[e.esc=27]="esc",e[e.a=65]="a",e[e.c=67]="c",e[e.v=86]="v",e[e.x=88]="x",e[e.z=90]="z",e[e.y=89]="y"}(o=t.Key||(t.Key={})),r=function(){function e(e,t,n){var o,r;this.tc=e,this.j4=t,this.Cj=n,o=this,Object.defineProperty(o,"shortcutKey",{get:function(){return o.vc},set:function(e){var t,n,i=o.vc;i!==e&&((t=(r=o.tc.wc)[i])&&((n=t.indexOf(o))>=0&&t.splice(n,1)),o.vc=e,e&&((t=r[e])||(r[e]=t=[]),t.splice(0,0,o)))}})}return e.prototype.canUndo=function(){return this.j4.canUndo},e.prototype.execute=function(e,t,n){var o,r=this,i=!0;try{i=!1!==(o=(r.j4.execute||r.j4)(e,t,1===n))}catch(e){i=!1}return t&&i&&r.tc.g4({command:t,result:o,s4:n}),o},e}(),i=function(){function e(e){this.xc=e,this.Ze={},this.wc={}}return e.prototype.register=function(e,t,n,o,i,a,s){var l=this,u=new r(l,t,e);l[e]=u,n&&(u.shortcutKey=l.getShortcutKey(n,o,i,a,s))},e.prototype.getCommand=function(e){return this[e]},e.prototype.execute=function(e){var t=this[e.cmd];if(t)return t.execute(this.xc,e,0)},e.prototype.setShortcutKey=function(e,t,n,o,r,i){var a,s,l,u,c=this;if(e)(a=c[e])&&(a.shortcutKey=c.getShortcutKey(t,n,o,r,i));else if(s=c.getShortcutKey(t,n,o,r,i),l=c.getCommands(s))for(u=l.length-1;u>=0;u--)l[u].shortcutKey=void 0},e.prototype.getShortcutKey=function(e,t,n,r,i){if(e){var a="A".charCodeAt(0)<=e&&e<="Z".charCodeAt(0)?String.fromCharCode(e):o[e];return a||(a=e),a+(t?"+ctrl":"")+(n?"+shift":"")+(r?"+alt":"")+(i?"+window":"")}},e.prototype.getCommands=function(e){return this.wc[e]},e.prototype.addListener=function(e,t){this.Ze[e]=t},e.prototype.removeListener=function(e){delete this.Ze[e]},e.prototype.g4=function(e){var t,n=this.Ze;for(t in n)n.hasOwnProperty(t)&&n[t](e)},e.prototype.no=function(){this.xc=null},e}(),t.CommandManager=i},"./src/plugins/commands/undomanager.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,n){var o=this;o.xc=e,t<0&&(t=2147483647),o.yc=t,o.zc=n,o.Ac=[],o.Bc=[]}return e.prototype.Cc=function(e,t){var n,o,r,i=this;if(e)if(1===t)i.Bc.push(e);else{if(n=i.yc,o=i.Ac.length,n>0&&o>=n)for(r=0;r<o-n+1;r++)i.Ac.shift();i.Ac.push(e),0===t&&(i.Bc=[])}},e.prototype.canUndo=function(){return this.Ac.length>0},e.prototype.undo=function(){var e,t,n=this,o=n.Ac,r=!0;if(n.zc&&n.canUndo()){e=o[o.length-1];try{(t=n.xc.commandManager()[e.cmd])&&(e.yTa=!0,r=t.execute(n.xc,e,1))}catch(e){r=!1}delete e.yTa,!1!==r&&(o.pop(),n.Bc.push(e))}return r},e.prototype.canRedo=function(){return this.Bc.length>0},e.prototype.redo=function(){var e,t,n=this,o=n.Bc,r=!0;if(n.zc&&n.canRedo()){e=o[o.length-1];try{(t=n.xc.commandManager()[e.cmd])&&(e.yTa=!0,r=t.execute(n.xc,e,2))}catch(e){r=!1}delete e.yTa,!1!==r&&(o.pop(),n.Ac.push(e))}return r},e.prototype.clear=function(){this.Ac=[],this.Bc=[]},e.prototype.PY=function(e){this.Ac=this.Ac.filter(e),this.Bc=this.Bc.filter(e)},e.prototype.no=function(){this.xc=null},e}();t.UndoManager=o},"./src/plugins/formatter/formatter.entry.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n("./src/plugins/formatter/formatter.ts"))},"./src/plugins/formatter/formatter.res.en.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_TokenIsNull="token is null",t.Exp_InvalidBackslash="the '\\' cannot be evaluated",t.Exp_FormatIllegal="format is illegal.",t.Exp_ValueIsNull="value is null",t.Exp_DuplicatedDescriptor="The type of descriptor was added.",t.Exp_TokenIllegal="token is illegal.",t.Exp_ValueIllegal="value is illegal.",t.Exp_InvalidCast="InvalidCastException"},"./src/plugins/formatter/formatter.ts":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function $(e,t,n){return e.substr(t,n)}function X(e){return i.j.Fa(e)?"":"boolean"==typeof e?e?"TRUE":"FALSE":"string"==typeof e?e:""+e}function ee(e,t){if("\\"===e[t])throw Error(f().Exp_InvalidBackslash);if(t-1>0&&t-1<e.length&&"\\"===e[t-1]){if(t-2<0)return!0;if(t-2>0&&t-2<e.length)return"\\"!==e[t-2]}return!1}function te(e){if(!e)throw Error(f().Exp_TokenIsNull);return"["+e+"]"}function ne(e){var t,n,o,r,i;if(e===p||e===h||""===e)return e;for(t="",n=0,o=!1,r=0;r<e.length;r++)'"'===(i=e[r])?(o=!o,t+=i):o?t+=i:"["===i?n++:"]"===i?--n<0&&(n=0):0===n&&(t+=i);return""+t}function oe(e){return e=re(e,"[",""),re(e,"]","")}function re(e,t,n){return!e||e===F.Dc||ae(t,n,!0)?e:(t=t.replace(v,"\\$1"),e.replace(RegExp(t,"g"),n))}function ie(e){var t,n,o=e.length,r=!1,i="";for(t=0;t<o;t++)"\\"===(n=e.charAt(t))?(r=!r)||(i+=n):(r=!1,i+=n);return i}function ae(e,t,n){return n?D(e)===D(t):e===t}function se(e,t){var n,o,r,i;for(1===arguments.length&&(t=!0),n=!1,o="",r=0;r<e.length;r++){if('"'===(i=e[r]))n=!n;else if(!n&&!t&&"/"===i&&!ee(e,r))continue;o+=i}return o}function le(e,t){var n,o,r;if(!e||e===F.Dc)return!1;for(n=function(e){var t,n,o,r="",i=!1;for(t=0,n=e.length;t<n;t++)'"'===(o=e[t])&&(i=!i),"E"===o||i||(r+=D(o));return r}(se(e)),o=0;o<t.length;o++){if(0===(r=n.indexOf(t[o])))return!0;if(r>0&&"_"!==n[r-1]&&"*"!==n[r-1])return!0}return!1}function ue(e,t,n,o){this.Ic=e,this.Jc=t,this.cultureName=n,this.nOb=o}function ce(e){this.Kc=e}function fe(e){var t,n,r=oe(e);return r&&r!==F.Dc?(n=r[0],["<",">","="].indexOf(n)>-1?(t=L).Name="ConditionalFormatPart":o.u.kb(r,"DBNum",!0)?(t=z).Name="DBNumberFormatPart":ae(r[0],"$",!1)&&r.indexOf("-")>-1?(t=H).Name="LocaleIDFormatPart":function(e){var t,n=D(e),o=n[0];if("h"!==o&&"m"!==o&&"s"!==o)return!1;for(t=1;t<n.length;t++)if(o!==n[t])return!1;return!0}(r)?(t=G).Name="ABSTimeFormatPart":r.indexOf("$")<0&&r.length>=3&&((t=W).Name="ColorFormatPart"),t):t}function he(e,t,n){var o,r;return o=e?e.cultureInfo():R(n),(t<4||4===t&&("ko-kr"===n||"ko-kr"===o.name()))&&(r=o.NumberFormat.dbNumber)?r[t]:h}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./src/common/util/stringhelper.ts"),r=n("./src/common/util/datetimehelper.ts"),i=n("./src/common/util/types.ts"),a=n("./src/common/util/numberhelper.ts"),s=n("./src/common/culture/cultureInfo.ts"),l=n("./src/common/util/common.ts"),u=n("./src/plugins/formatter/formatter.res.en.ts"),i.j.Ia(l.SR.en,u),c=new l.ResourceManager(l.SR),f=c.getResource.bind(c),i.j.Ma=function(e,t){if(i.j.Fa(e))return"null"===t;if(!t)return!1;if(t instanceof Function&&e instanceof t)return!0;if(typeof e===t)return!0;if("function"===t&&/^\s*\bfunction\b/.test(""+e))return!0;if(Object.prototype.toString.call(e).slice(8,-1).toLowerCase()===t.toLowerCase())return!0;if("DateTime"===t)return e instanceof Date;if("TimeSpan"===t){if(e instanceof Date){var n=r.l.Ra(e);return n>=0&&n<1}return!1}return"string"==typeof t&&"undefined number boolean string".indexOf(t),!1},i.j.Na=function(e,t){return!!a.o.Xia(e,t)&&(e=a.o.Oa(e,t),i.j.Ma(e,"number")||i.j.Ma(e,"DateTime")||i.j.Ma(e,"TimeSpan")||e&&!i.j.Ma(e,"boolean")&&!isNaN(e)&&!isNaN(parseFloat(e))&&!(e.length>=2&&"0"===e[0]&&"x"===e[1]))},i.j.Pa=function(e){return i.j.Fa(e)||""===e?0:i.j.Ma(e,"number")?e:i.j.Ma(e,"string")&&!isNaN(e)?a.o.Qa(e):i.j.Ma(e,"boolean")?e?1:0:i.j.Ma(e,"DateTime")?r.l.Ra(e):i.j.Ma(e,"TimeSpan")?Math.floor(r.l.Ra(e)):parseFloat(e)},h=null,p=void 0,d=Math.abs,g={Rc:"yy",vd:"y",Qc:"yyyy",jd:"m",hd:"mm",gd:"mmm",fd:"mmmm",dd:"mmmmm",ud:"d",wd:"dd",kd:"aaa",ld:"aaaa",md:"h",nd:"hh",xd:"m",yd:"mm",td:"s",zd:"ss",ea:"e",rd:"AM/PM",sd:"A/P",ed:"@mmmmm",qd:new Date(1899,11,30,0,0,0,0)},m=[g.vd,g.Rc,g.Qc,g.jd,g.hd,g.gd,g.fd,g.dd,g.ud,g.wd,g.kd,g.ld,g.md,g.nd,g.xd,g.yd,g.td,g.zd,"ggg","gg","g","ee","e"],y={Hc:0,Va:1,Ua:2,_text:3},v=RegExp("([.+?*$^\\[\\](){}|/])","g"),b=[["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"],["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"],["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"],["H:m","h:m tt"],["H:m:s","H:m:s"],["H:m:s.FFF","h:m:s.FFF tt"],["h:m:s tt","h:mm:ss tt"],["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt"],["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt"],["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","M-d-yyyy H:m:s tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]],C=i.j.Ma,w=i.j.Ca,x=a.o,A=x.eka+"."+x.fka,M=x.Jja,S=x.mb,T=x.Lma,N=i.j.Fa,I=isNaN,R=function(e){return s.CultureManager.q4(e)},k=function(e){return R(e).DateTimeFormat},E=function(e){return R(e).NumberFormat},D=function(e){return e&&e.toLowerCase()},j=function(e){return e&&e.toUpperCase()},_=function(){throw Error(f().Exp_FormatIllegal)},O=function(){return s.CultureManager.booleanMapping},F={Dc:"",Kb:function(){var e,t,n,o,r,i,a=[];for(e=0;e<arguments.length;e++)a[e]=arguments[e];for(t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(0===arguments.length)return h;for(o=t[0],r=1;r<arguments.length;r++)i=RegExp("\\{"+(r-1)+"\\}","gm"),o=o.replace(i,arguments[r]);return o},Ec:function(e){return!e||e===F.Dc}},P={Fc:function(e){var t=e.charCodeAt(0);return t>=48&&t<=57},Gc:function(e){var t=e.charCodeAt(0);return t>=9&&t<=13||32===t||133===t||160===t}},H=function(){function e(e,t){var n,r,i,a;if(ce.call(this,t),(n=this).Uc=e,i=ae((r=n.Uc)[0],"$",!1),a=r.indexOf("-"),!(i&&a>-1))throw Error(f().Exp_TokenIllegal);n.Vc=$(r,1,a-1),(r=o.u.Fb(r,0,a+1)).length>0&&(n.Wc=parseInt(r,16))}return e.prototype.cultureInfo=function(){var e=this;return e.Xc||(e.Xc=R(e.Wc),e.Vc&&e.Vc!==F.Dc&&!e.Xc.NumberFormat.isReadOnly&&(e.Xc.NumberFormat.currencySymbol=e.Vc)),e.Xc},e.prototype.currencySymbol=function(){return this.Vc?o.u.Gb(this.Vc,"\\.",'"."'):F.Dc},e.prototype.allowScience=function(){if(this.Xc)return!this.Xc.isJCKCulture},e.prototype.toString=function(){return this.Uc?te(this.Uc):F.Dc},e.Name="LocaleIDFormatPart",e}(),B=function(){function e(e,t){this.formatCached=e,this.cultureName=t,this.typeName=""}return e.prototype.format=function(e){return h},e.prototype.parse=function(e){return h},e.prototype.formatString=function(e){return this.formatCached},e.prototype.toJSON=function(){var e,t={};for(e in this)this.hasOwnProperty(e)&&(t[e]=this[e]);return t},e.prototype.fromJSON=function(e){if(e)for(var t in e)e[t]!==p&&(this[t]=e[t])},e}(),t.FormatterBase=B,L=function(){function e(e,t){var n,r,i,a,s,l,u,c;for(ce.call(this,t),n=this,l=0,u=(s=["<=","<>",">=",">","<","="]).length;l<u;l++)if(r=s[l],o.u.kb(e,r,!0)){i=o.u.Fb(e,0,r.length),c=parseFloat(i),I(c)||(a=c);break}if(a===h&&a===p)throw Error(f().Exp_TokenIllegal);n.value=a,n.Sc=r,n.isMeetCondition=function(e){var t=n.Sc,o=n.value;switch(t){case"<=":return e<=o;case"<>":return e!==o;case">=":return e>=o;case">":return e>o;case"<":return e<o;case"=":return e===o}}}return e.prototype.toString=function(){return te(this.Sc+""+this.value)},e}(),z=function(){function e(e,t){ce.call(this,t);var n=this;if(n.token=e,n.type=parseInt(o.u.Fb(e,0,5),10),n.type<0||n.type>4)throw Error(f().Exp_TokenIllegal)}return e.prototype.Pc=function(t,n,r){var i,a,s,l,u,c,f,h,p,d;if(!t||t===F.Dc)return t;for(i=t,a=t,s=-1,l=-1,u=!1,p=t.length-1;p>=0;p--)d=a[p],!I(d)&&!ae(d," ",!1)||ae(d,".",!1)&&!u?(ae(d,".",!1)&&(u=!0),-1===s&&(s=p),l=p):l>-1&&s>-1&&(c=$(a,l,s-l+1),f=parseFloat(c),I(f)||(h=e.numberString(c,n,r),i=o.u.Fb(i,l,s-l+1),i=o.u.Eb(i,l,h)),s=-1,l=-1,u=!1);return l>-1&&s>-1&&(c=$(a,l,s-l+1),f=parseFloat(c),I(f)||(h=e.numberString(c,n,r),i=o.u.Fb(i,l,s-l+1),i=o.u.Eb(i,l,h))),i},e.prototype.toString=function(){if(this.type>-1)return te("DBNum"+this.type);throw Error()},e.numberString=function(t,n,o){var r=e.formatNumberString,i=t.split(".");if(i){if(1===i.length)return r(i[0],n.numbers,o?n.letters:h);if(2===i.length)return r(i[0],n.numbers,o?n.letters:h)+"."+r(i[1],n.numbers)}throw Error(f().Exp_ValueIllegal)},e.formatNumberString=function(t,n,o){var r,i,a,s,l,u,c,f,h,p,d,g,m,y=t,v=0,b=0;if(2===arguments.length){for(i="",v=0;v<y.length;v++)r=$(y,v,1),i+=n[b=parseInt(r,10)];return i}if(3===arguments.length){if(!o)return e.formatNumberString(t,n);for(a=0,s="",l=y.length,u=!1,c=[],v=0;v<l;v++)(f=o.length-1-v)>-1?c.push(""+o[f]):c.push(F.Dc);for(h=[],p=c.length-1;p>=0;p--)h[c.length-p-1]=c[p];for(c=h,d=!1,p=0;p<l;p++)r=$(y,p,1),b=parseInt(r,10),g=void 0,m=F.Dc,l-p-16>0?(g=n[b],m="",d=!0):p!==l-1&&p!==l-5&&p!==l-9&&p!==l-13?"0"===r?(g="",m="",a+=1):"0"!==r&&0!==a?(g=n[0]+n[b],m=c[p],a=0):(g=n[b],m=c[p],a=0):"0"!==r&&0!==a?(g=n[0]+n[b],m=c[p],a=0):"0"!==r&&0===a||d?(g=n[b],m=c[p],a=0,d=!1):"0"===r&&a>=3?(g="",m="",a+=1):l>=11?(g="",a+=1):(g="",m=c[p],a+=1),g+m===F.Dc||(u=!1),p!==l-13||u||(m=c[p],u=!0),p!==l-9||u||(m=c[p],u=!0),p===l-1&&(m=c[p],u=!0),s=s+g+m;return 0===parseInt(t,10)?n[0]:s}},e}(),V=function(){function e(e,t,n,o,r,i){ue.call(this,t,n,o,i);var a=this;a.Yc=a.Zc(se(e)),a.$c=r,a._c=2,a.ad()}return e.prototype.ad=function(){var t,n,o,r=this,i={Qb:r.Yc};if(e.Lc(i.Qb)){if(t=r.bd(i),r.hasJD=r.Gb(i.Qb,g.dd,'"'+g.ed+'"',!0,!1,i,!1),r.Gb(i.Qb,g.fd,"MMMM",!0,!1,i,!1),r.Gb(i.Qb,g.gd,"MMM",!0,!1,i,!1),r.Gb(i.Qb,g.hd,"MM",!0,!1,i,!1),r.Gb(i.Qb,g.jd,"M",!0,!1,i,!1),r.Gb(i.Qb,g.kd,"ddd",!0,!0,i,!0),r.Gb(i.Qb,g.ld,"dddd",!0,!0,i,!0),t||(r.Gb(i.Qb,g.md,"H",!0,!0,i,!1),r.Gb(i.Qb,g.nd,"HH",!0,!0,i,!1)),r.Jc&&r.Ic&&(r.od=r.od||r.Gb(i.Qb,g.Qc,'"@'+g.Qc+'"',!0,!1,i,!0),r.od=r.od||r.Gb(i.Qb,g.Rc,'"@'+g.Rc+'"',!0,!1,i,!0)),r.$c)for(n=0;n<r.$c.length;n++)o=r.$c[n],r.Gb(i.Qb,o.Kc,"@"+o.Kc,!0,!0,i,!0);r.pd=i.Qb}else _()},e.prototype.formatString=function(){return this.Yc},e.prototype.format=function(e){var t,n,i,a,s,l,u=this,c=F.Dc,f=h;try{if((f=r.l.Yb(e))&&I(f.valueOf())&&(f=h),f?e=f:c=""+e,f&&(c=r.l.mb(f,u.pd,u.Ic&&u.Ic.cultureInfo()||R(u.cultureName),u.nOb),u.hasJD&&(t=R(u.cultureName).DateTimeFormat.monthNames[f.getMonth()],c=o.u.Gb(c,g.ed,$(t,0,1))),u.$c))for(n=24*(r.l.Ra(f)-r.l.Ra(g.qd))*60*60*1e3,i=0;i<u.$c.length;i++)s=(a=u.$c[i]).Tc(n),N(s)||(l=a.Kc.replace("[","\\[").replace("]","\\]"),c=o.u.Gb(c,"@"+l,s))}catch(t){c=X(e)}return function(e,t,n,o,i){var a,s=e;return!N(o)&&t instanceof Date&&(a=he(n,o.type,i),s=o.Pc(s,a,!0),1===o.type&&(s=s.replace(RegExp("","g"),"")),s=(s=s.replace("@"+g.Qc,r.l.Vb(t,g.Qc))).replace("@"+g.Rc,r.l.Vb(t,g.Rc)),s=o.Pc(s,a,!1)),s}(c,e,u.Ic,u.Jc,u.cultureName)},e.prototype.parse=function(e){var t,n,o,i,a;if(!e||e===F.Dc)return h;if(t=this,"true"===(o=D(n=e)))return!0;if("false"===o)return!1;if(t.pd&&(i=r.l.Wb(n,t.pd,R(t.cultureName))))return i;try{return(a=r.l.Yb(n))&&!I(a)?a:(a=new Date(n),I(a.valueOf())?n:a)}catch(e){return n}},e.prototype.Zc=function(e){var t,n,o,r=e,i="",a=!1;for(t=0;t<r.length;t++)'"'===(n=r[t])?a=!a:a||("Y"===n||"D"===n||"S"===n||"E"===n||"G"===n?n=D(n):"M"===n&&(ae("A",o=r[t-1],!0)||ae("P",o,!0)||(n=D(n)))),i+=n;return i},e.prototype.bd=function(e){var t,n=[g.rd,k(this.cultureName).amDesignator+"/"+k(this.cultureName).pmDesignator,g.sd],r=["tt","tt","t"],i=e.Qb;for(t=0;t<3;t++){if(o.u.Bb(i,r[t]))return!0;if(o.u.Bb(i,n[t],!0))return e.Qb=o.u.Gb(i,n[t],r[t],!0),!0}return!1},e.prototype.Gb=function(t,n,r,i,a,s,l){var u,c,f,h,p,d,g,m,y,v,b;if(i||a){for(u=[],c=!0,!e.hasDate(t)&&e.hasTime(t)&&(c=!1),f=!1,h=0;h<t.length;h++){if(p=t[h],e.hasTime(p)&&!f?c=!1:e.hasDate(p)&&!f&&(c=!0),i&&ae(p,n[0],l)&&c||a&&ae(p,n[0],l)&&!c){for(d=!0,g=0;g<n.length;g++)if(g+h>=t.length||!ae(n[g],t[g+h],l)){d=!1;break}if(m=h+n.length-1,d&&m+1<t.length){for(y=t[m],v=-1,v=m+1;v<t.length&&ae(y,t[v],l);v++);v>m+1&&(h=v,d=!1)}d&&!f&&u.splice(0,0,h)}'"'===p&&(f=!f)}if(s.Qb=t,u.length>0){for(h=0;h<u.length;h++)b=u[h],s.Qb=o.u.Fb(s.Qb,b,n.length),s.Qb=o.u.Eb(s.Qb,b,r);return!0}return!1}return!1},e.hasTime=function(e){return o.u.Cb(e,g.md[0],!0)>-1||o.u.Cb(e,g.td[0],!0)>-1},e.hasDate=function(e){return o.u.Cb(e,g.Rc[0],!0)>-1||o.u.Cb(e,g.ud[0],!0)>-1},e.Lc=function(e,t){return le(e,t||m)},e}(),t.lxb=V,G=function(){function e(e,t){var n,o;if(ce.call(this,t),this,"h"===(n=D(e)[0]))o=3600;else if("m"===n)o=60;else{if("s"!==n)throw Error(f().Exp_TokenIllegal);o=1}this.Tc=function(e){var t=e/1e3/o;return Math.abs(t-Math.round(t))<1e-6?Math.round(t):Math.floor(t)}}return e.Name="ABSTimeFormatPart",e}(),W=function(){function e(e,t){ce.call(this,t),this.foreColor=e}return e.prototype.toString=function(){return te(this.foreColor)},e.Name="ColorFormatPart",e}(),U=function(){function e(e,t,n,o){var r,i,a,s,l;ue.call(this,t,n,o),(r=this).Ad=!1,r._c=1,r.Bd=ne(e),i=se(e),t&&(i=re(i,r.Ic.Kc,r.Ic.currencySymbol())),(i=ne(i)).indexOf("/")>-1&&((a=function(e,t){var n,o,r,i,a,s=[];if(e===h||""===e)return s;for(n=!1,o=[],r=!1,i=0;i<e.length;i++)'"'!==(a=e[i])||n||(r=!r),n||r||a!==t?o.push(a):(s.push(o.join("")),o=[]),n="\\"===a&&!n;return s.push(o.join("")),s}(i,"/"))&&2===a.length&&(r.Cd=a[1],(s=a[0])&&((l=s.lastIndexOf(" "))>-1?(r.Dd=$(s,0,l),r.Ed=$(s,l+1,s.length-l-1)):r.Ed=s))),r.Fd=i}return e.prototype.formatString=function(){return this.Bd},e.prototype.format=function(t){var n,o,r,a,s,l,u,c,f,p,d,g,m,y,v,b,w,x,A,T,k;return C(t,"boolean")?(""+t).toUpperCase():(n=this,o=i.j.Pa(t),I(o)||!isFinite(o)||I(t)?"string"==typeof t?t:h:(r=R(n.cultureName),n.Ed&&n.Cd?(f={value:0},p={value:0},d={value:0},g=n.bPa(),e.getFraction(o,g,f,p,d)?((m=e.getGCD(p.value,d.value))>1&&(p.value/=m,d.value/=m),n.Dd?(c="",1===d.value&&(f.value+=p.value,p.value=0,d.value=0),(y=M(S(f.value,n.Dd,r)))&&"0"!==y&&(c+=y,c+=" "),0===f.value&&o<0&&(c+=r.NumberFormat.negativeSign),0===o&&(c+="0"),a=n.Cd,s=parseFloat(a),!I(s)&&s>0&&(0!==p.value&&0!==d.value&&(p.value*=s/d.value),d.value=s,a=a.replace(/^\d+/,e.toNumberPlaceholder(s)),u=(l=Math.ceil(p.value))-p.value,p.value=u<=.5&&u>=0?parseFloat(""+l):parseFloat(""+(l-1))),v=n.Ed,b=parseFloat(v),I(b)||0!==b||((w=v.length)>(A=(x=""+p.value).length)?v=v.substr(0,w-(w-A)):w<A&&(x=x.substr(0,A-(A-w)),p.value=parseInt(x,10))),T=n.Mja(p.value,d.value,v,a,r),0===p.value&&(T=T.replace(/./g," "),""===y)?"0 "+T:""===(c+=T)?"0":c):(c="",k=f.value*d.value+p.value,a=n.Cd,(s=parseFloat(a))>0?(k*=s/d.value,d.value=s,c+=(k=(u=(l=Math.ceil(k))-k)<=.5&&u>=0?parseFloat(""+l):parseFloat(""+(l-1)))+"/"+d.value):c+=n.Mja(k,d.value,n.Ed,n.Cd,r),0===k?"0":c)):""+o):function(e,t,n,o,r){var i,a,s,l,u,c,f;if(!N(o)&&(i=he(n,o.type,r),!N(i))){for(a=!1,s=void 0,l=R(r),u=void 0,c=0,f=e.length;c<f;c++)"decimalSeparator"===e[c].type&&(a=!0,e[c].value=o.Pc(e[c].value,i,t),s=e[c].value),"number"===e[c].type&&(e[c].value=a?o.Pc(s+e[c].value,i,t).slice(1):o.Pc(e[c].value,i,t),"ja-JP"===l.name()&&e[c].value.length>1&&(""===(u=e[c].value.substr(0,2))||""===u||""===u)&&(e[c].value=e[c].value.substr(1)));return e}return e}(S(o,n.Fd,r),n.Ad,n.Ic,n.Jc,n.cultureName)))},e.prototype.parse=function(e){var t,n,r,i,a,s,l,u,c,f,p=this;return e&&e!==F.Dc?!!("TRUE"===(t=j(e))||t===O()&&O().boolean_true)||!("FALSE"===t||t===O()&&O().boolean_false)&&(n=p.Ed&&p.Cd,r=p.Jd(p.Fd).Kd,(n||r)&&(0<(i=e.indexOf("/"))&&i<e.length-1&&(a=parseInt(e.substr(0,i),10),s=parseInt(e.substr(i+1),10),!isNaN(a)&&!isNaN(s)&&0!==s))?a/s:(e=p.Hd(e),e=p.Id(e),u=(l=p.Jd(e)).Kd,c=l.Ld,p.jBb(c)&&(c=o.u.Hb(c,E(p.cultureName).numberGroupSeparator,"",!1),f=x.ob(c,p.cultureName),!I(f)&&isFinite(f))?(u&&(f=T(f/100,15)),f):h)):h},e.prototype.bPa=function(){var e,t,n=this.Cd,o=0;if(n)for(e=n.length,t=0;t<e&&n[t].match(/[#?0\d]/);t++)o++;return o},e.prototype.jBb=function(e){var t,n="",o=0,r=0,i=0,a=h,s=E(this.cultureName);for(t=e.length-1;t>-1;t--){if(e[t]===s.numberDecimalSeparator)o++,i>0&&(a=!1),n="";else if("e"===D(e[t])){if(r++,n="",t===e.length-1)return!1}else if(e[t]===s.numberGroupSeparator)a=3===n.length,i++,n="";else if("-"===e[t]||"+"===e[t]){if(t>0&&"e"!==D(e[t-1]))return!1}else{if(!P.Fc(e[t]))return!1;if(n+=e[t],0===t&&0===parseInt(n,10)&&a)return!1}if(o>1||r>1||!1===a)return!1}return!0},e.prototype.Hd=function(e){var t,n,r,i,a,s,l=e,u=[];for(t=0;t<l.length;t++)P.Fc(l[t])&&u.push(t);for(r=[(n=E(this.cultureName)).currencyDecimalSeparator,n.currencyGroupSeparator,n.currencySymbol,n.nanSymbol,n.negativeInfinitySymbol,n.negativeSign,n.numberDecimalSeparator,n.numberGroupSeparator,n.percentDecimalSeparator,n.percentGroupSeparator,n.percentSymbol,n.perMilleSymbol,n.positiveInfinitySymbol,n.positiveSign],i=l.length-1;i>-1;i--)if(a=l[i],!P.Gc(a)||r.indexOf(""+a)>-1){if(("-"===a||"+"===a)&&(s=i>0?""+l[i-1]:h,["e","E","(",E(this.cultureName).currencySymbol].indexOf(s)<0))break}else(i<u[0]||u[u.length-1]<i)&&(l=o.u.Fb(l,i,1));return l},e.prototype.Id=function(e){var t=E(this.cultureName).currencySymbol,n=o.u.kb(e,t)?o.u.Fb(e,0,t.length):e;return n.indexOf(t)<0?n:e},e.prototype.Jd=function(e){var t=E(this.cultureName).percentSymbol,n=!0,r=e;return o.u.kb(e,t)?r=o.u.Fb(e,0,t.length):o.u.jb(e,t)?r=o.u.Fb(e,e.length-t.length,t.length):n=!1,o.u.Bb(r,t)&&(n=!1),{Ld:r,Kd:n}},e.prototype.Mja=function(e,t,n,o,r){var i=M(S(e,n,r)),a=M(S("0."+t,"#."+o,r,!0)),s=i+"/"+a.substr(a.indexOf(".")+1);return""===n&&(s=e+s),""===o&&(s+=t),s},e.getGCD=function(e,t){var n,o;if(0===e)return d(t);if(0===t)return d(e);for(o=Math.max(e,t)%(n=Math.min(e,t));0!==o;)o=n%(n=o);return d(n)},e.getFraction=function(e,t,n,o,r){var i,a,s,l,u,c,f,h,p,g=0,m=0,y=0,v=0,b=Math.ceil;for(e>0?1===(v=e-b(e)+1)?(v=0,g=e):g=b(e)-1:e<0&&(g=b(e),v=b(e)-e),(i=Math.pow(10,t-1))<2&&(i=2),(a=Math.pow(10,t)-1)<2&&(a=2),s=!1,l=0,u=i;u<=a&&(c=u*v,f=Math.round(c),p=d((h=f/u)-v),!((!s||p<d(l-v))&&(s=!0,l=h,m=f,y=u,p<1e-5)));u++);return n.value=g,o.value=m,r.value=y,s},e.toNumberPlaceholder=function(e){return(""+e).replace(/\d/g,"?")},e}(),Z=function(){function e(t,n,o,r){ue.call(this,n,o,r),arguments.length>0?(e.kBb(t)||_(),this.Bd=t):this.Bd="General",this._c=0}return e.kBb=function(e){var t,n,o="",r=!1,i=-1,a=e.length;for(t=0;t<a;t++)'"'===(n=e[t])?i=(r=!r)?t:-1:r||(o+=n);return i>0&&(o+=e.substring(i,a)),!(o.indexOf("0")>=0||o.indexOf("#")>=0||o.indexOf(".")>=0||o.indexOf("@")>=0)},e.prototype.Nd=function(){var e,t=this;return t.Od||(e=re(e=t.Bd,"General",A),t.Od=new U(e,t.Ic,t.Jc,t.cultureName),t.Od.Ad=!0),t.Od},e.prototype.Pd=function(){var e=this;return e.Qd||(e.Qd=new U("0.#####E+00",e.Ic,e.Jc,e.cultureName),e.Qd.Ad=!0),e.Qd},e.prototype.formatString=function(){return o.u.Gb(this.Bd,"@NumberFormat","General")},e.prototype.format=function(e){var t,n,r=this;if(i.j.Na(e,r.cultureName)){if(t=!r.Ic||r.Ic.allowScience(),(n=i.j.Pa(e))!==p&&n!==h)return d(n)>99999999999&&t||d(n)<1e-11&&0!==n?r.Pd().format(e):r.Nd().format(e)}else{if(C(e,"string"))return ie(o.u.Gb(r.formatString(),'"',"")),e;if(C(e,"boolean"))return(""+e).toUpperCase()}return""},e.prototype.parse=function(e){var t,n,i,a,l,u,c,f,g,m,y,v,b,w;return F.Ec(e)?h:"number"==typeof e?e:(t=!1,n=e.trim(),(i=o.u.Cb(n,"-",!1))>0&&!ae(n.charAt(i-1),"E",!0)&&(t=!0),u=(l=(a=R(this.cultureName)).DateTimeFormat).dateSeparator,c=l.timeSeparator,f=l.monthNames,g=l.abbreviatedMonthNames,m=function(e,t){var n,r,i;if(!t||0===t.length)return!1;for(n=!1,r=0,i=t.length;r<i;r++)if(o.u.Bb(e,t[r],!0)){n=!0;break}return n},(t||o.u.Bb(n,u,!1)||o.u.Bb(n,c,!1)||o.u.Bb(n,"/",!1)||o.u.Bb(n,":",!1)||o.u.Bb(n,"-",!1)||o.u.Bb(n,"",!1)||o.u.Bb(n,"",!1)||o.u.Bb(n,"",!1)||m(n,f)||m(n,g)||"ja-JP"===a.name()&&s.aBb.R.indexOf(n[0].toUpperCase())>=0&&o.u.Bb(n,".",!1))&&(y=r.l.Qa(n))?y:(b="-"===n.charAt(0),(w="("===(n=b?o.u.Fb(n,0,1):n).charAt(0)&&")"===n.charAt(n.length-1))&&(n=n.substring(1,n.length-1)),(v=this.Nd().parse(n))!==h&&v!==p?(w||b)&&C(v,"number")?-1*d(v):v:e))},e}(),q=function(){function e(e,t,n,o){var r,i=this;ue.call(i,t,n,o),r=se(e,!1),t&&(r=re(r,i.Ic.Kc,i.Ic.currencySymbol())),r=ie(r=ne(r)),i.Yc=r,i._c=3}return e.prototype.format=function(e){var t,n,o=this;try{return void 0,void 0,t=e instanceof Date?""+r.l.Ra(e):X(e),n=o.Kja(o.Yc),o.Lja(t,n)}catch(e){return""}},e.prototype.parse=function(e){return e||""},e.prototype.formatString=function(){return this.Yc},e.prototype.Kja=function(e){var t,n,o="",r=!1,i=h,a=[];for(n=0;n<e.length;n++)t=e.charAt(n),r?('"'!==t?o+=t:(o+=t,a.push(o),o="",r=!1),i=t):"*"!==i&&"_"!==i&&"\\"!==i||""===o?"*"!==t&&"_"!==t&&"\\"!==t?"@"!==t?'"'!==t?(o+=t,i=t):(i=t,""!==o&&a.push(o),o=t,r=!0):(i=t,""!==o&&(a.push(o),o=""),a.push(t)):(i=t,""!==o&&(a.push(o),o=""),o+=t):(o+=t,a.push(o),o="");return""!==o&&a.push(o),a},e.prototype.Lja=function(e,t){var n,o,r=[],i=!1;for(n=t.length-1;n>=0;n--)"*"===(o=t[n])[0]?i||(i=!0,r.push({type:"fillingChar",value:o[1]})):"_"===o[0]?r.push({type:"placeholder",value:o[1]}):'"'===o[0]&&'"'===o[o.length-1]?o.length>2&&r.push({type:"text",value:o.substr(1,o.length-2)}):"@"===o[0]?r.push({type:"text",value:e}):r.push({type:"text",value:o});return r.reverse()},e}(),J=function(){return{pattern:b,formatter:["d-mmm","mmm-yy",k().shortDatePattern,"h:mm","h:mm:ss","h:mm:ss.0","h:mm:ss tt",k().shortDatePattern+" h:mm",k().shortDatePattern+" h:mm:ss",k().shortDatePattern+" h:mm:ss.0"]}},Q=function(){function e(e,t){var n=this;0===arguments.length?(n.formatCached="General",n.Rd=new Z):n.ad(e,t)}return e.prototype.ad=function(t,n){var o,r,i,a,l,u,c,f,d,g,m,y,v,b,C,w;for(t!==h&&t!==p||_(),o=t,(r=this).formatCached=t,i="",a="",l=!1,u=!1,c=!1,f=[],d=0;d<t.length;d++)'"'===(g=t[d])?(u=!u,a+=g):u?a+=g:"["===g?(l&&_(),a&&(i||(i=""),i+=a),a=""+g,l=!0):"]"===g?(l||_(),a?(m=""+(a+=g),(y=fe(""+a))?"ABSTimeFormatPart"===y.Name?(f.push(new y(e.preProcessPart(m),m)),i+=a):m===s.aBb.eraExcelFormatter?(r.addPart(y,s.aBb.eraInternalFormatter),c=!0):r.addPart(y,m):(i+=v=e.partToNormalStr(m),o=re(t,m,v)),a=""):_(),l=!1):a+=g;a?l?_():i+=a:i||(i=r.o$a()),r.localeIDFormatPart&&(n=r.localeIDFormatPart.cultureInfo().name()),C=(b=function(e,t){var n,o=!1;return le(e=e?""+e:F.Dc,["general"])?n=Z:V.Lc(e)?n=V:le(e,["E+","E-","#",".",",","%","0","/","?"])||t?(o=!0,n=U):(o=!0,n=q),{Mc:o,Nc:n}}(i,r.conditionalFormatPart)).Nc,w=b.Mc?o:i,C?r.Rd=new C(w,r.localeIDFormatPart,r.dbNumberFormatPart,n,f.length>0?f:h,c):_()},e.prototype.o$a=function(){var t=this,n="";return t.dbNumberFormatPart&&(e.proNames.some((function(e){return"dbNumberFormatPart"!==e&&t[e]}))||(n="General")),n},e.prototype.formatString=function(){var t,n,o,r=this,i="";for(t=0,n=e.proNames.length;t<n;t++)r[o=e.proNames[t]]&&(i+=""+r[o]);return i+r.Rd.formatString()},e.prototype.addPart=function(t,n){var o,r,i,a=e.proNames,s=e.preProcessPart(n);for(o=0,r=a.length;o<r;o++)if(ae(i=a[o],t.Name,!0)){if(this[i])throw Error(f().Exp_DuplicatedDescriptor);this[i]=new t(s,n)}},e.prototype.format=function(e){return this.Rd.format(e)},e.prototype.parse=function(e){return this.Rd.parse(e)},e.checkFormatter=function(e){if(!e||e===F.Dc)throw Error(f().Exp_TokenIllegal)},e.preProcessPart=function(t){e.checkFormatter(t);var n=oe(t);return e.checkFormatter(n),n},e.partToNormalStr=function(t){var n=e.preProcessPart(t);return"$"===n[0]&&(n=n.slice(1)),'"'+n+'"'},e.proNames=["colorFormatPart","conditionalFormatPart","dbNumberFormatPart","localeIDFormatPart"],e}(),Y=function(e){function t(t,n){var o=e.call(this,t,n)||this,r=o;return r.Sd=!0,r.PropertyChanged=[],F.Ec(t)&&(t="General"),r.formatCached=t,r.cultureName=n,r.init(),o}return K(t,e),t.prototype.toJSON=function(){var e=this,t={formatCached:e.formatCached};return e.cultureName&&(t.customerCultureName=e.cultureName),"general"===D(e.formatCached)&&delete t.formatCached,t},t.prototype.hasFormatedColor=function(){var e,t;for(e in y)if(y.hasOwnProperty(e)&&((t=this.getFormatter(y[e]))&&t.colorFormatPart))return!0;return!1},t.prototype.formatString=function(e){var t,n,o,r=this;if(0===arguments.length){for(t=F.Dc,n=0,o=r.formatters.length;n<o;n++)t+=r.formatters[n].formatString(),n!==o-1&&(t+=";");return t}if(!e)throw Error(f().Exp_ValueIsNull);return r.formatters=h,r.formatCached=e,r.init(),r.Td("formatString"),r},t.prototype.getFormatter=function(e){return this.formatters&&this.formatters[e]},t.prototype.getPreferredEditingFormatter=function(e){var n,o,r=k(this.cultureName),a=t.defFormatter;return C(e,"TimeSpan")?a(r.longTimePattern):C(e,"DateTime")?(n=0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()?"":" h:mm:ss",a(r.shortDatePattern+n)):i.j.Na(e,this.cultureName)?a((o=i.j.Pa(e))>=1e20||o<=1e-17&&o>0||o<=-1e20||o<0&&o>=-1e-17?"0.##E+00":A):a("General")},t.prototype.getPreferredDisplayFormatter=function(e,n){var a,s,l,u,c,f,p,d,g,m,y,v,b,w,x,A,M,S,T,N,I,k,D,j=this,_=t.defFormatter;if(n||(n={value:h}),n.value=h,F.Ec(e))return new t;if(a=e,s=n.value=j.parse(a),C(s,"DateTime")||C(s,"TimeSpan")){for(u=(l=J()).pattern,c=l.formatter,(d=(p=(f=R(j.cultureName)).DateTimeFormat).preselectedFormatters).length>0&&(u=u.concat([d]),c=c.concat([d[0]])),"ja-JP"===f.name()&&(u=u.concat([p.eraFormatter]),c=c.concat(["ge.M.d"]),g=f._Ab.filter((function(e){return"ggge"===e.substr(0,4)})),u=u.concat([g]),c=c.concat(['ggge""M""d"']),m=f._Ab.filter((function(e){return"gge"===e.substr(0,3)})),u=u.concat([m]),c=c.concat(['gge""M""d"']),y=f._Ab.filter((function(e){return"ge"===e.substr(0,2)})),u=u.concat([y]),c=c.concat(['ge""M""d"'])),v=0;v<u.length;v++)for(b=u[v],w=0;w<b.length;w++)if(x=b[w],(A=r.l.Qa(e,x))&&A-s==0)return new t(c[v])}else if(i.j.Na(s,j.cultureName)){if(S=(M=E(j.cultureName)).currencySymbol,T=M.numberDecimalSeparator,N=M.percentSymbol,I=M.numberGroupSeparator,"E",D=(k=o.u.Bb)(a,T)?".00":"",a[0]===S)return _(F.Kb("{0}#,##0{1};[Red]({0}#,##0{1})",S,D));if(k(a,"E",!0))return _("0.00E+00");if(""+a[0]===N||""+a[a.length-1]===N)return _(F.Kb("0{0}%",D));if(k(a,I))return _(F.Kb("#,##0{0}",D))}return _("General")},t.prototype.format=function(e,t){var n,o,r,a,s;if(C(e,"boolean"))return O()&&(e=e?O().boolean_true:O().boolean_false),(""+e).toUpperCase();if(o=0,r=this.Ud(e)){a=r.colorFormatPart,t&&a&&(t.conditionalForeColor=t.value=a.foreColor),(n=i.j.Na(e,this.cultureName))&&(o=i.j.Pa(e)),s=F.Dc;try{n&&r===this.getFormatter(y.Va)?s=r.format(r.considerNegSymbol?o:d(o)):(s=r.value)===p&&(s=r.format(e)),t&&(t.content=w(s)?s:[{type:"text",value:s}]),w(s)&&(s=x.Jja(s))}catch(t){C(e,"string")&&(s=""+e)}return s}return n&&o<0?"-":C(e,"string")?""+e:e===p||e===h?F.Dc:""+e},t.prototype.parse=function(e){var t=this;return t.formatters&&t.formatters.length>0?t.formatters[0].parse(e):h},t.prototype.init=function(){var e,t,n,o=this,r=o.formatCached;for(F.Ec(r)&&_(),o.formatters=[],e=r.split(";"),o.Sd=1===e.length,(!e||e.length<1||e.length>4)&&_(),t=0;t<e.length;t++)n=new Q(e[t],o.cultureName),o.formatters.push(n);o.getFormatter(y.Hc)||_()},t.prototype.Ud=function(e){var t,n,o,r,a,s,l,u=this,c=u.getFormatter(y.Hc),f=c&&c.conditionalFormatPart,p=u.getFormatter(y._text);if("string"==typeof e&&I(e))return p||(f?e:c);if(i.j.Na(e,u.cultureName)||C(e,"boolean")){if(t=u.getFormatter(y.Va),n=u.getFormatter(y.Ua),o=i.j.Pa(e),r=f&&c.conditionalFormatPart.isMeetCondition(o),s=(a=t&&t.conditionalFormatPart)&&t.conditionalFormatPart.isMeetCondition(o),l=void 0,u.Sd||(f?r:o>0||0===o&&!n))l=c;else if(a?s:o<0)l=t;else if(n)l=n;else if(t){if(f&&a)return{value:o+""};l=t}return l&&(!f||a||l!==t||n||(l.considerNegSymbol=!0),f&&a&&l===t&&t.conditionalFormatPart&&t.conditionalFormatPart.isMeetCondition(1e-10)&&(l.considerNegSymbol=!0)),l}return h},t.prototype.Td=function(e){var t,n,o=this;if(o.PropertyChanged)for(t=0;t<o.PropertyChanged.length;t++)"function"==typeof(n=o.PropertyChanged[t])&&n(o,e)},t.defFormatter=function(e){var n=t[e];return n||(n=new t(e),t[e]=n),n},t}(B),t.GeneralFormatter=Y},"./src/plugins/slicer/slicer.entry.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n("./src/plugins/slicer/slicer.ts"))},"./src/plugins/slicer/slicer.ts":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f;function h(e){return e&&e.text!==r}function p(e,t){var n,o,u;if(e===i||e===r)return!1;if(w(e)===a)t.value=e;else if(w(e)===l)t.value=e?1:0;else if(e instanceof Date)t.value=c.Ra(e);else{if(w(e)!==s)return!1;if(0===x(e=e.trim()))return!1;if(n=!1,"%"===e.charAt(x(e)-1)&&(n=!0,e=e.substr(0,x(e)-1)),x(e)>=2&&"0"===e[0]&&"x"===e[1])return!1;if(o=(+e).valueOf(),isNaN(o)||!isFinite(o)){if(u=new Date(e),isNaN(u))return!1;o=c.Ra(u)}n&&(o/=100),t.value=o}return!0}function d(e){var t,n,o,r,i,a,s,l,u,c,f,h,p,d=e.Ce;for(d||(e.Ee=[],e.Ie=[]),t=d?e.De:e.Ee,n=e.Fe,o=e.Ge,r=d?e.He:e.Ie,i=e.Je,a=e.Ke,s=e.Le,l=x(e.data),c=0;c<l;c++){for(f=!1,h=void 0,p=0;p<x(i)&&(h=i[p],d&&h===e.Me||(o[h]?(u=e.getExclusiveRowIndex(e.columnNames[h],c),f=!o[h][u]):n[h]&&(f=!n[h][c]),!f));p++);!f&&d&&(a?f=!a[u=e.getExclusiveRowIndex(e.columnNames[h],c)]:s&&(f=!s[c])),f||(t[c]=!0)}for(p=0;p<x(t);p++)t[p]&&r.push(p)}function g(e){return"string"==typeof e?e.toLowerCase():e instanceof Date?c.Ra(e):e}function m(e,t){var n,o,r,i,a,s,l,u=e.Oe,c=e.Pe,f=e.Se,p=e.Qe,d=e.Re,m=e.data,y=d[t]=[];for(e._e=[],u[t]=[],c[t]=[],f[t]={},p[t]=[],n={},o=0;o<x(m);o++)i=h(r=m[o][t])?r.text.trim():r,u[t].push(i),(a=n[g(i)])?(a.list.push(o),y[o]=a.index):(s=[o],c[t].push(i),p[t].push(s),l=x(p[t])-1,f[t][i]=l,y[o]=l,n[g(i)]={list:s,index:l})}function y(e,t,n){var o,r,i,a,s,l,u,c,f,p,d,g,m=e.Te,y=e.getColumnIndex(t),v=[];if(!y)return v;if(o=e.Ce?e.Ue:e.Ve[y],r=e.Ee,!o)return v;for(m[y]||e.We(y),i=[],a=m[y],s=0;s<x(a);s++)u=h(l=e.data[s][y])?l.value:l,i[a[s]]=u;for(c=e.af[y],s=0;s<x(o);s++){for(f=o[s],p=!1,g=(d=e.Xe(i,f)).start;g<=d.end;g++)if(r[c[g]]){p=!0;break}p!==n&&v.push(f)}return v}function v(e,t){var n,o,r,i,a,s,l,u=[],c={},f=e.getColumnIndex(t);if(f>=0)for(n=e.Ke||e.Le,o=e.Ge[f]||e.Fe[f],r=e.Ce&&f===e.Me?n:o,a=x((i=!!e.Fe[f])?e.getData(t):e.getExclusiveData(t)),s=0;s<a;s++)r&&!r[s]&&(c[l=i?e.getExclusiveRowIndex(t,s):s]||(c[l]=!0,u.push(l)));return u}function b(e,t){e.Ce=!1,e.Ke=[],e.He=[],e.De=[],e.Le=[],t&&e.onFiltered()}function C(e){return e===i||e===r}function w(e){return typeof e}function x(e){return e?e.length:0}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./src/common/util/datetimehelper.ts"),r=void 0,i=null,a="number",s="string",l="boolean",u=o.l.Ra,function(e){e[e.all=0]="all",e[e.byCurrentColumn=1]="byCurrentColumn",e[e.byOtherColumns=2]="byOtherColumns"}(t.FilteredOutDataType||(t.FilteredOutDataType={})),function(e){e[e.average=1]="average",e[e.count=2]="count",e[e.counta=3]="counta",e[e.max=4]="max",e[e.min=5]="min",e[e.product=6]="product",e[e.stdev=7]="stdev",e[e.stdevp=8]="stdevp",e[e.sum=9]="sum",e[e.vars=10]="vars",e[e.varp=11]="varp"}(t.SlicerAggregateType||(t.SlicerAggregateType={})),c=function(){function e(){}return e.Ra=function(e){return u(e)},e.quickSort=function(t){var n,o=x(t),r=[];for(n=0;n<o;n++)r[n]={index:n,value:t[n]};return e.quickSortImp(r)},e.quickSortImp=function(t){var n,o,r,i,a,s,l;if(x(t)<=1)return t;for(n=e,o=t[Math.floor(x(t)/2)],r=[],i=[],a=[],s=0;s<x(t);s++)(l=n.sortCompare(t[s].value,o.value))<0?r.push(t[s]):l>0?i.push(t[s]):a.push(t[s]);return n.quickSortImp(r).concat(a,n.quickSortImp(i))},e.isEquals=function(e,t){return!(!C(e)&&""!==e||!C(t)&&""!==t)||(e instanceof Date&&t instanceof Date?e.valueOf()===t.valueOf():w(e)===s&&w(t)===s?e.toLowerCase()===t.toLowerCase():e===t)},e.isGreaterThan=function(t,n){var o=w(t),r=w(n);return o===l?t=t?1:0:t instanceof Date&&(t=e.Ra(t)),r===l?n=n?1:0:n instanceof Date&&(n=e.Ra(n)),o===r||o!==a&&r!==a?o===s&&r===s?t.toLowerCase()>n.toLowerCase():t>n:w(n)===a},e.sortCompare=function(t,n){var o=e,r=C(t)||""===t||w(t)===a&&isNaN(t),i=C(n)||""===n||w(n)===a&&isNaN(n);return r&&i?0:r?1:i?-1:o.isEquals(t,n)?0:o.isGreaterThan(t,n)?1:-1},e}(),t.jf=c,f=function(){function e(e,t){var n,o=this;for(o.Ne={},o.Oe=[],o.Pe=[],o.Se=[],o.Qe=[],o.Re=[],o.Ge=[],o.Ye=[],o.Fe=[],o.Ve=[],o.Ee=[],o.Ie=[],o.Je=[],o.He=[],o.De=[],o.Ce=!1,o.Ze=[],o.$e=0,o._e=[],o.af=[],o.Te=[],o.bf(e,t),n=0;n<x(o.data);n++)o.Ee[n]=!0,o.Ie.push(n)}return e.prototype.inPreview=function(){return this.Ce},e.prototype.bf=function(e,t){var n=this;n.data=e,n.columnNames=t,function(e){var t,n,o=e.Ne={};for(e.Oe=[],e.Pe=[],e.Qe=[],e.Re=[],t=e.columnNames,n=0;n<x(t);n++)o[(t[n]+"").toUpperCase()]=n}(n)},e.prototype.onDataChanged=function(e){var t,n,o,r,i,a,s,l,u,c,f=this,p=Array(x(f.columnNames)),g=f.Ye,y=f.Pe,v=f.Ge,b=f.Oe;for(t=0;t<x(e);t++)o=(n=e[t]).data,r=n.row,i=f.getColumnIndex(n.columnName),f.data[r][i]=o,a=h(o)?o.text:o,b[i]&&(b[i][r]=a),p[i]=!0;for(s=0;s<x(p);s++)if(p[s]){for(l=g[s],g[s]=l?[]:void 0,v[s]=l?[]:void 0,u=[],t=0;l&&t<x(l);t++)u.push(y[s][l[t]]);for(m(f,s),t=0;t<x(u);t++)c=f.Se[s][u[t]],g[s].push(c),v[s][c]=!0}d(f),f.cf("onDataChanged",e)},e.prototype.cf=function(e){var t,n,o,r,i=[];for(t=1;t<arguments.length;t++)i[t-1]=arguments[t];for(n=this.Ze||[],o=0;o<x(n);o++)(r=n[o])[e]&&r[e].apply(r,i)},e.prototype.onColumnNameChanged=function(e,t){var n=this,o=n.Ne,r=n.getColumnIndex(e);r<0||(n.columnNames[r]=t,delete o[e.toUpperCase()],o[t.toUpperCase()]=r,n.cf("onColumnNameChanged",e,t))},e.prototype.onRowsAdded=function(e,t,n){var o,a,s,l,u,f,h,p,d,g,m,y,v,b=this,C=x(b.columnNames),w=b.data,A=b.Oe,M=b.Pe,S=b.Qe,T=b.Re,N=b.Ge,I=b.Ye,R=b.Ee,k=b.Ie,E=b.Je;for(b._e=[],o=0;o<t;o++)w.splice(e,0,Array(C));for(a=0;a<C;a++){for(o=0;o<t;o++)A[a]&&A[a].splice(e,0,r);if(u=void 0,l=M[a]){for(f=i,h=0;h<x(l);h++){for(p=S[a][h],d=0;d<x(p);d++)p[d]>=e&&(p[d]+=t);c.isEquals(l[h],i)&&(f=p,u=h)}for(f||(f=[],l.push(i),u=x(l)-1,b.Se[a][i]=u,S[a].push(f),N[a]&&-1===E.indexOf(a)&&(N[a][u]=!0,I[a].push(u))),g=e;g<e+t;g++)f.push(g);for(s=e;s<e+t;s++)T[a].splice(s,0,u)}}for(m=!0,o=0;o<x(E);o++)y=T[a=E[o]][e],!0!==N[a][y]&&(m=!1);for(o=0;o<x(k);o++)k[o]>=e&&(k[o]+=t);for(s=x(w)-1;s>=e+t;s--)R[s]=R[s-t];for(v=x(E)>0,s=e;s<e+t;s++)m&&k.push(s),R[s]=!v;n||b.cf("onRowsChanged",e,t,!0)},e.prototype.onRowsRemoved=function(e,t){this.df(e,t,!0)},e.prototype.df=function(e,t,n){var o,r,i,a,s,l,u,c,f=this,h=f.Ye,p=f.Pe,g=f.Ge,y=f.data,v=x(f.columnNames),b=f.Oe;for(y.splice(e,t),r=0;r<v;r++){if(b[r]&&b[r].splice(e,t),a=[],(i=h[r])&&n){for(o=0;o<x(i);o++){for(s=f.getRowIndexes(f.columnNames[r],i[o]),l=!0,u=0;u<x(s);u++)if(s[u]<e||s[u]>=e+t){l=!1;break}l||a.push(p[r][i[o]])}h[r]=[],g[r]=[]}if(m(f,r),i&&n)for(o=0;o<x(a);o++)c=f.Se[r][a[o]],h[r].push(c),g[r][c]=!0}n&&d(f),f.cf("onRowsChanged",e,t,!1)},e.prototype.onColumnsRemoved=function(e,t){var n,o,r,i,a,s,l,u,c=this,f=c.data,h=[],p=c.Je,d=e+t;for(n=e;n<d;n++)o=c.columnNames[n],r=n,h.push(o),-1!==p.indexOf(r)&&c.doUnfilter(o);for(i=c.Ge||c.Fe,a=c.Ye||c.Ve,s=c.Ne,n=0;n<x(f);n++)f[n].splice(e,t);for(l in c._e=[],c.columnNames.splice(e,t),c.Oe.splice(e,t),c.Pe.splice(e,t),c.Se.splice(e,t),c.Qe.splice(e,t),c.Re.splice(e,t),i.splice(e,t),a.splice(e,t),s)s[l]>=e+t&&(s[l]-=t);for(n=0;n<x(h);n++)delete s[(o=h[n]).toUpperCase()],e=c.getColumnIndex(o),-1!==(u=p.indexOf(e))&&p.splice(u,1),c.cf("onColumnRemoved",h[n])},e.prototype.ef=function(){return this._e},e.prototype.ff=function(){return this.af},e.prototype.We=function(e){var t,n,o,r,i,a,s,l,u,f,p,d=this,g=d.data;for(d.Oe[e]||m(d,e),t=x(g),n=[],o=0;o<t;o++)i=h(r=g[o][e])?r.value:r,n.push(i);for(a=c.quickSort(n),s=d._e[e]=[],l=d.af[e]=[],u=d.Te[e]=[],f=0;f<x(a);f++)p=a[f],s.push(p.value),l.push(p.index),u[p.index]=f},e.prototype.getColumnIndex=function(e){var t=this.Ne[e.toUpperCase()];return void 0===t?-1:t},e.prototype.getFilteredRowIndexes=function(){var e=this;return e.Ce?e.He:e.Ie},e.prototype.getFilteredOutRowIndexes=function(){var e,t=this,n=x(t.data),o=t.Ce?t.De:t.Ee,r=[];for(e=0;e<n;e++)o[e]||r.push(e);return r},e.prototype.getData=function(e,t){var n,o,r,i,a,s,l,u=this,c=u.Oe,f=u.getColumnIndex(e);if(f>=0){if(t){for(u._e[f]||u.We(f),n=c[f],o=u._e[f],i=(r=u.Xe(o,t)).start,a=r.end,s=[],l=i;l<=a;l++)s.push(n[u.af[f][l]]);return s}return c[f]||m(u,f),c[f]}return[]},e.prototype.aggregateData=function(e,t,n){var o,i,a,s,l,u,c,f,h,p=this,d=p.getColumnIndex(e);return d<0?r:(p._e[d]||p.We(d),s=x(a=p._e[d]),o=(l=p.Xe(a,n)).start,i=l.end,5===t?o>=s?r:a[o]:4===t?i<0?r:a[i]:3===t?i<o?0:i-o+1:(c=(u=p.Qka(a,t,o,i)).data1,f=u.data2,h=u.data3,1===t?c/=f:7===t||10===t?(c=(h*f-c*c)/(h*(h-1)),c=7===t?Math.sqrt(c):c):8!==t&&11!==t||(c=(h*f-c*c)/(h*h),c=8===t?Math.sqrt(c):c),c))},e.prototype.Qka=function(e,t,n,o){var a,s,l,u=6===t?1:0,c=0,f=0;for(a=n;a<=o;a++)(s=e[a])===i&&s===r||p(s,l={value:i})&&(s=l.value,1===t?(u+=s,c++):2===t?u++:9===t?u+=s:6===t?u*=s:7!==t&&8!==t&&10!==t&&11!==t||(u+=s,c+=s*s,f++));return{data1:u,data2:c,data3:f}},e.prototype.Xe=function(e,t){var n,o,i,a,s=x(e);if(t){if(t.min===-1/0)n=0;else for(i=0;i<s;i++)if(a=e[i],c.isEquals(t.min,a)||c.isGreaterThan(a,t.min)){n=i;break}if(n===r&&(n=s),o===1/0)o=s-1;else{for(i=s-1;i>=0;i--)if(a=e[i],c.isEquals(a,t.max)||c.isGreaterThan(t.max,a)){o=i;break}o===r&&(o=-1)}}else n=0,o=s-1;return{start:n,end:o}},e.prototype.getExclusiveData=function(e){var t=this,n=t.Pe,o=t.getColumnIndex(e);return o>=0?(n[o]||m(t,o),n[o]):[]},e.prototype.getRowIndexes=function(e,t){var n=this,o=n.getColumnIndex(e);return o>=0?(n.Re[o]||m(n,o),n.Qe[o][t]):[]},e.prototype.getExclusiveRowIndex=function(e,t){var n=this,o=n.Re,r=n.getColumnIndex(e);return r>=0?(o[r]||m(n,r),o[r][t]):-1},e.prototype.getFilteredIndexes=function(e){var t=[];return this.gf(e,t,{}),t},e.prototype.gf=function(e,t,n){var o,r,i,a=this,s=a.Ce?a.He:a.Ie;for(o=0;o<x(s);o++)r=s[o],n[i=a.getExclusiveRowIndex(e,r)]?n[i]++:(n[i]=1,t.push(i))},e.prototype.getFilteredRanges=function(e){return y(this,e,!1)},e.prototype.getFilteredOutRanges=function(e){return y(this,e,!0)},e.prototype.getFilteredOutIndexes=function(e,t){var n=this;return 0===t?function(e,t){var n,o,r,i,a=[];if(e.getColumnIndex(t)>=0){for(n=x(e.getData(t)),o=e.Ce?e.De:e.Ee,r=0;r<n;r++)o[r]||(i=e.getExclusiveRowIndex(t,r),-1===a.indexOf(i)&&a.push(i));return a}}(n,e):1===t?v(n,e):function(e,t){var n,o,r,i,a,s,l,u,c,f,h={},p=e.columnNames;for(n=0,o=x(p);n<o;n++)if(p[n]!==t)for(r=v(e,p[n]),i=0;i<x(r);i++)for(a=e.getRowIndexes(p[n],r[i]),s=0;s<x(a);s++)h[a[s]]||(h[a[s]]=!0);for(l={},n=0,o=x(e.data);n<o;n++)u=e.getExclusiveRowIndex(t,n),h[n]||(l[u]=!0);for(c=x(e.getExclusiveData(t)),f=[],n=0;n<c;n++)l[n]||f.push(n);return f}(n,e)},e.prototype.attachListener=function(e){this.Ze.push(e)},e.prototype.detachListener=function(e){var t,n=this.Ze||[];for(t=0;t<x(n);t++)if(n[t]===e){n.splice(t,1);break}},e.prototype.suspendFilteredEvents=function(){this.$e++},e.prototype.resumeFilteredEvents=function(){var e=this;e.$e--,0===e.$e&&e.onFiltered()},e.prototype.doFilter=function(e,t,n){this.hf(e,t,n),this.onFiltered()},e.prototype.hf=function(e,t,n){var o=this,r=o.Je,i=o.getColumnIndex(e);i<0||(n?(o.Ce=!0,o.Me=i):o.Ce&&b(o,!1),r.indexOf(i)<0&&r.push(i),t.ranges?function(e,t,n,o){var r,i,a,s,l,u,c,f,p=e.getColumnIndex(t),g=e.Te;for(g[p]||e.We(p),r=[],i=g[p],a=0;a<x(i);a++)l=h(s=e.data[a][p])?s.value:s,r[i[a]]=l;for(u=[],a=0;a<x(n);a++)for(c=e.Xe(r,n[a]),f=0;f<x(i);f++)i[f]>=c.start&&i[f]<=c.end&&(u[f]=!0);o?(e.Le=u,e.Ue=n):(e.Ve[p]=n,e.Fe[p]=u,delete e.Ge[p],delete e.Ye[p]),d(e)}(o,e,t.ranges,n):function(e,t,n,o){var r,i=e.getColumnIndex(t),a=[];for(r=0;r<x(n);r++)a[n[r]]=!0;o?e.Ke=a:(e.Ge[i]=a,e.Ye[i]=n,delete e.Ve[i],delete e.Fe[i]),d(e)}(o,e,t.exclusiveRowIndexes,n))},e.prototype.clearPreview=function(){b(this,!0)},e.prototype.doUnfilter=function(e){this.if(e),this.onFiltered()},e.prototype.if=function(e){var t,n,o=this;o.Ce&&b(o,!1),(t=o.getColumnIndex(e))<0||(delete o.Ve[t],delete o.Fe[t],delete o.Ge[t],delete o.Ye[t],d(o),(n=o.Je.indexOf(t))>=0&&o.Je.splice(n,1))},e.prototype.onFiltered=function(){var e=this;0===e.$e&&e.cf("onFiltered",{rowIndexes:e.getFilteredRowIndexes(),isPreview:e.Ce})},e.prototype.getListener=function(){return this.Ze},e}(),t.GeneralSlicerData=f},"./src/plugins/sparkline/sparkline.entry.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n("./src/plugins/sparkline/sparkline.ts"))},"./src/plugins/sparkline/sparkline.ts":function(e,t,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R,k,E,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function te(e,t){return{x:e,y:t}}function ne(e,t,n,o){return{x:e,y:t,width:n,height:o}}function oe(e,t){var n,o,r,i=e[0],a=i&&i.value?i.value:i;for(o=1,r=e.length;o<r;o++)n=(i=e[o])&&i.value?i.value:i,(t&&a>n||!t&&a<n)&&(a=n);return a}function re(e,t,n,o,r,i,a){i&&(e.strokeStyle=i),a&&(e.lineWidth=a),e.beginPath(),e.moveTo(t,n),e.lineTo(o,r),e.stroke()}function ie(e,t,n,o,r,i,a,s,l,u,c,f){t?re(e,n,o,r,i,c,f):re(e,a,s,l,u,c,f)}function ae(e){return r.pc.dc(l(e))<127.5?j:_}function se(e,t,n,o,r,i,s,l){var u,c,f,h,p=l;return a(l)&&(p=r),s?(u=t+p+i,f=o-2*p,c=e+r,h=n-2*r):(u=e+p,f=n-2*p,c=t+r,h=o-2*r),{left:u,top:c,width:f,height:h}}function le(e,t){var n,o,r=0;for(n=0,o=e.length;n<o;n++)r+=t&&!t(e[n])?0:e[n];return r}function ue(e,t,n,o){var r,i,a,s,l=[];for(i=0,a=0,s=e.length;i<s;i++)t?t(e[i])?l[a++]=n?n(e[i]):e[i]:l[a++]=0:(r=T(e[i]),!S(r)&&isFinite(r)&&(l[a++]=r));return o&&o(l),l}function ce(e,t,n,o,r,i){var a=v(t+o),s=v(n+r);t=v(t),n=v(n),o=v(a-t),r=v(s-n),e.beginPath(),e.fillStyle=i,e.fillRect(t,n,o,r),e.fill()}function fe(e,t,n){return e=m(e,t),y(e,n)}function he(e,t,n,o,r){e.save(),e.rect(t,n,o,r),e.clip()}function pe(e,t){var n,o,i,a,s,u,c=[],f=t.length;if(e<=f)c=t.slice(0,e);else{for(0===f?(c.push("darkgray"),f=1):c=t.slice(0),n=[],o=void 0,i=e-f+1,a=void 0,a=0;a<f;a++)n[a]=l(c[a]);for(a=f;a<e;a++){for(s in o=n[a%f])o.hasOwnProperty(s)&&(u=o[s],o[s]=h(u-u/i*(a/f)));o.a=255,c[a]=r.pc.bc(o)}}return c}function de(e,t,n){return{x:e,y:t,value:n}}function ge(e,t,n,o,r){return((t-r)*n+(r-o)*e)/(t-o)}function me(e,t){var n,o,r=t?1:-1,i=t?m:y,a=new W(te(r*N,r*N)),s=e.length;for(o=0;o<s;o++)n=e[o],a.x=i(a.x,n.x),a.y=i(a.y,n.y);return a}function ye(e,t,n,o){return n/o*(t-e)+e}function ve(e,t,n,o,r,i,a){var s,l,u,c,f,h,p,d,g,m,y,v,w,x;if(a){for(s=C(b(o-t,2)+b(r-n,2)),l=0,6,2,4,c=void 0,f=void 0,h=void 0,p=void 0,t<=o?(c=t,f=o,h=t,p=n):(c=o,f=t,h=o,p=r),g=n-(d=(r-n)/(o-t))*t,(u=[]).push(new W(te(h,p))),m=[6,4,2,4];l<s;)for(y=0,v=m.length;y<v;y++)(l+=m[y])<=s&&(p=d*(h=ye(c,f,l,s))+g,u.push(new W(te(h,p))));for(w=0,x=u.length;w<x-1;w+=2)re(e,u[w].x,u[w].y,u[w+1].x,u[w+1].y,i)}else re(e,t,n,o,r,i)}function be(e){var t,n,o,r=[],i=e.length;if(i>0)if(i<(t=e[0].length)){if(i>=2)for(n=0;n<t;n++)r.push(new W(te(e[0][n],e[1][n])))}else if(t>=2)for(o=0;o<i;o++)r.push(new W(te(e[o][0],e[o][1])));return r}function Ce(e,t,n,o){for(var r,i=[],a=y(100,10*e),s=0,l=[],u=0;i.length<e;)r=h(o[u++]*t),(s>a||we(r,l))&&(i.push(r),l.push([r-n,r+n])),s++;return i}function we(e,t){var n,o,r;for(n=0,o=t.length;n<o;n++)if((r=t[n])[0]<=e&&e<=r[1])return!1;return!0}function xe(e,t,n,o,r,i){re(e,Se(t),Se(n),Se(o),Se(r),a(i)?_:i,1)}function Ae(e,t,n,o,r){var i,a,s,l,u,c=.4*o;switch(t=Se(t),n=Se(n),e.beginPath(),e.moveTo(t,n),i=c/2,a=C(3)*c/2,s=c/C(3),r){case 0:l=[-i,0,i],u=[a,s,a];break;case 2:l=[-i,0,i],u=[-a,-s,-a];break;case 3:l=[a,s,a],u=[-i,0,i];break;case 1:l=[-a,-s,-a],u=[-i,0,i];break;default:l=[],u=[]}l.forEach((function(o,r){e.lineTo(Se(t+o),Se(n+u[r]))})),e.lineTo(t,n),e.closePath(),e.fillStyle=j,e.fill()}function Me(e,t,n,o,r,i,s){var l,u,c,f,h,p,d,g,m,y,v,b,C,x,A=n.value,M=n.colorScheme,N=n.axisVisible,I=n.barHeight,R=n.barWidth,k=!1,E=T(A);if(!S(E)){if(a(d=0===e?I:R))g=.7;else{if(S(d)||d<=0)return;g=Math.min(1,d)}E>1?(E=1,k=!0):E<-1&&(E=-1,k=!0),M=a(M)?"grey":M,N=!!a(N)||N,t.save(),0===e?(m=i-10,y=s*g,E>=0?(k&&(l=new W(te(o+5+m-5,r+s/2))),u=new U(ne(o+5,r+s*(1-g)/2,m*E,y)),c=new W(te(o+5,r+1)),f=new W(te(o+5,r+s)),h=1):(v=w(m*E),k&&(l=new W(te(o+5+5,r+s/2))),u=new U(ne(o+i-5-v,r+s*(1-g)/2,v,y)),c=new W(te(o+i-5,r+1)),f=new W(te(o+i-5,r+s)),h=3),p=a(d)?s:s*g):1===e&&(b=s-10,C=i*g,E>=0?(u=new U(ne(o+(1-g)/2*i,r+s-5-(x=b*E),C,x)),k&&(l=new W(te(o+i/2,r+s-5-x+5)),h=0),c=new W(te(o+1,r+s-5)),f=new W(te(o+i,r+s-5))):(E=w(E),u=new U(ne(o+(1-g)/2*i,r+5,C,b*E)),k&&(l=new W(te(o+i/2,r+5+b-5)),h=2),c=new W(te(o+1,r+5)),f=new W(te(o+i,r+5))),p=a(d)?i:i*g),t.beginPath(),u&&(ce(t,u.x,u.y,u.width,u.height,M),he(t,u.x,u.y,u.width,u.height)),l&&Ae(t,l.x,l.y,p,h),t.restore(),N&&c&&xe(t,c.x,c.y,f.x,f.y),t.restore()}}function Se(e){return v(e)-.5}function Te(e,t,n,o,r){t=v(t),n=v(n),t===(o=v(o))&&(t=o-=.5),n===(r=v(r))&&(n=r-=.5),e.moveTo(t,n),e.lineTo(o,r)}function Ne(e,t,n,o,r,i,a,s,l,u,c){e.beginPath(),e.strokeStyle=n,t?Te(e,o,r,i,a):Te(e,s,l,u,c),e.stroke()}function Ie(e,t,n,o,r){e.rect(t,n,o,r),e.clip()}function Re(e,t,n,o,r,i){var s,l,u,c,f,h=i.labelText,p=i.fontSize,d=i.startBox,g=i.endBox,m=i.boxColor,y=i.isInRightOrTopOfBox,v=i.fillStyle;e.save(),e.beginPath(),e.font=p+G,v=a(v)?_:v,i.vertical?(u=B,y?p+g-(d-n)>0&&d-g-n<g?(c=L,v=ae(m),l=d-g+1,Ie(e,t,d-g,o,g)):(c=z,l=d-g-1):p-(n+r-d)>0&&n+r-d<g?(Ie(e,t,d-g,o,g),c=z,v=ae(m),l=d-1):(c=L,l=d+1),e.textAlign=u,e.textBaseline=c,e.fillStyle=v,e.fillText(h,t+o/2,l)):(c=V,f=e.measureText(h),y?f.width+g-(t+o-d)>0&&t+o-(d+g)<g?(Ie(e,d,n,g,r),u=H,v=ae(m),s=d+g-1):(u=P,s=d+g+1):f.width-(d-t)>0&&d-t<g?(Ie(e,d,n,g,r),s=d+1,u=P,v=ae(m)):(u=H,s=d-1),e.textAlign=u,e.textBaseline=c,e.fillStyle=v,e.fillText(h,s,n+r/2)),e.restore()}function ke(e,t){switch(t){case 2:return e%4==0&&e%100!=0||e%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}}function Ee(e,t,n){var o,r,i,a,s,u;return e<0&&(e=0),e>1&&(e=1),o=l(t),r=l(n),i=o.a*(1-e)+r.a*e,a=o.r*(1-e)+r.r*e+"",s=o.g*(1-e)+r.g*e+"",u=o.b*(1-e)+r.b*e+"","rgba("+parseInt(a,10)+","+parseInt(s,10)+","+parseInt(u,10)+","+T(i/255+"")+")"}function De(e,t,n){return e===t&&e===n?1:e<=t?0:e>=n?1:(e-t)/(n-t)}function je(e,t,n,o,r,i,a){var s,l,u;o?e.forEach((function(e,r){0!==e&&e!==c&&e!==f&&(t[n+r]=o[r]||t[n+r])})):(s=function(e){var t=N,n=-N;return e.forEach((function(e){e!==c&&e!==f&&(t>e&&(t=e),n<e&&(n=e))})),{min:t,max:n}}(e),l=s.min,u=s.max,e.forEach((function(e,o){0!==e&&e!==c&&e!==f&&(t[n+o]=function(e,t,n,o,r,i){var a=(i+r)/2;return r<=o&&o<=a?Ee(De(o,r,a),e,t):Ee(De(o,a,i),t,n)}(r,i,a,e,l,u))})))}function _e(e){var t,n=e.getFullYear(),o=e.getMonth(),r=e.getDate();for(t=1;t<o+1;t++)r+=ke(n,t);return r}Object.defineProperty(t,"__esModule",{value:!0}),o=n("./src/common/util/types.ts"),r=n("./src/common/util/colorhelper.ts"),i=n("./src/common/util/arrayhelper.ts"),a=o.j.Fa,s=r.pc.nc,l=r.pc.ec,u=i.k.Cb,t.Vd={},c=null,f=void 0,h=Math.floor,p=Math.PI,d=Math.sin,g=Math.cos,m=Math.min,y=Math.max,v=Math.round,b=Math.pow,C=Math.sqrt,w=Math.abs,x=Math.ceil,A="undefined",M="string",S=isNaN,T=parseFloat,N=Number.MAX_VALUE,I=new Date(""),R="#969696",k="#CB0000",E="#646464",D="#DCDCDC",j="white",_="black",O="blue",F="green",P="left",H="right",B="center",L="top",z="bottom",V="middle",G="px Arial",U=function(e){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height},Z=function(e){function t(t){var n=e.call(this,te(t.x,t.y))||this;return n.value=t.value,n}return ee(t,e),t}(W=function(e){this.x=e.x,this.y=e.y}),q="7ns",J="5ns",Q="tukey",Y="bowley",K="sigma3",$=function(e,t,n,o){this.X=e,this.Y=t,this.Width=n,this.Height=o,this.Left=this.X,this.Right=this.Left+this.Width,this.Top=this.Y,this.Bottom=this.Y+this.Height},X=function(){function e(){this.Wd=2,this.Xd=I,this.Yd=I,this.Zd=N,this.$d=-N}return e.prototype.paint=function(e,t,n,o,r,i){var a,s,l,u=this;u.options=t,u.setting=t.settings,a=t.values,s=t.dateValues,l=t.zoomFactor,e.save(),e.rect(n,o,r,i),e.clip(),e.beginPath(),0===t.sparklineType&&u._d(e,n,o,r,i,a,s,l),u.ae(e,n,o,r,i,a,s,l),u.be(e,n,o,r,i,a,s,l),e.restore()},e.prototype.ce=function(e){return 0===this.options.sparklineType?3+this.de(e)+1:3},e.prototype.ee=function(e,n){var o,r,a,s,l,h,p,d,g,y=this.fe;if(y)return y;if(y=this.fe=[],o=e.length,this.options.displayDateAxis){for(s=n.length,h=[],(l=m(o,s))>0&&(h=n.slice(0,l)),h.sort((function(e,n){return e===n?0:(e===t.Vd&&(e=0),n===t.Vd&&(n=0),e-n)})),p=h.length,d=void 0,g=void 0,r=0;r<p;r++)if(typeof(d=h[r])!==A&&d!==c){for(g=u(n,d);i.k.Bb(y,g);)g=u(n,d,g+1);isNaN(d)||((a=e[g])!==f&&a!==c&&isNaN(a)&&a!==t.Vd||y.push(g))}}else for(r=0;r<o;r++)typeof(a=e[r])!==A&&a!==c&&isNaN(a)&&a!==t.Vd||y.push(r);return y},e.prototype.ge=function(e,n){var o=n[e];return typeof o===A||o===c?1===this.setting.options.displayEmptyCellsAs&&(o=0):o===t.Vd&&(o=0),o},e.prototype._d=function(e,t,n,o,r,i,a,s){var l,u,f,h,p,d,g,m,y,v,b,C,w,x,M,S=this,T=S.ee(i,a),N=T.length-1;for(N<0&&(N=0),h=S.setting.options,p=S.linePos=[],b=h.displayEmptyCellsAs,l=0;l<N;l++)if(typeof(d=S.ge(T[l],i))!==A&&d!==c){if(m=l+1,typeof(g=S.ge(T[m],i))===A||g===c)if(1===b)g=0;else if(2===b)for(m=l+2;m<=N;m++)if(typeof(C=i[T[m]])!==A&&C!==c){g=C;break}typeof g!==A&&g!==c?(y=S.he(T[l],{Width:o,Height:r},i,a,s),v=S.he(T[m],{Width:o,Height:r},i,a,s),w=y.Width/2,u={X:y.X+w,Y:y.Y+w},f={X:v.X+w,Y:v.Y+w},p[l]={P1:u,P2:f}):l++}if((x=p.length)>0)for(e.strokeStyle=S.options.getColor(h.seriesColor),e.lineCap="round",e.lineWidth=S.de(s),l=0;l<x;l++)(M=p[l])&&(e.beginPath(),u=M.P1,f=M.P2,e.moveTo(t+u.X,n+u.Y),e.lineTo(t+f.X,n+f.Y),e.stroke(),e.closePath())},e.prototype.ie=function(e,t,n){var o,r=this,i=r.options,a=r.setting.options,s=c,l=r.ge(e,t),h=r.ee(t,n),p=h.length,d=i.getColor.bind(r);return typeof l!==A&&l!==c&&(r.Zd!==N&&r.$d!==-N||r.je(t),l===r.Zd&&a.showLow&&(s=d(a.lowMarkerColor)),l!==r.$d||!a.showHigh||typeof s!==A&&s!==c||(s=d(a.highMarkerColor)),typeof s!==A&&s!==c||(i.displayDateAxis?0===u(h,e)&&a.showFirst&&(s=d(a.firstMarkerColor)):0===e&&a.showFirst&&(s=d(a.firstMarkerColor))),typeof s!==A&&s!==c||(i.displayDateAxis?u(h,e)===p-1&&a.showLast&&(s=d(a.lastMarkerColor)):e===p-1&&a.showLast&&(s=d(a.lastMarkerColor))),l<0&&a.showNegative&&(typeof s===A||s===c)&&(s=d(a.negativeColor)),typeof s!==A&&s!==c||(0===(o=i.sparklineType)?a.showMarkers&&(s=d(a.markersColor)):(1===o||2===o)&&(s=d(a.seriesColor)))),s===f||s===c?"Transparent":s},e.prototype.ae=function(e,t,n,o,r,i,a,s){var l,u,c,f,d,g,m,y,v,b,C=this,w={Width:o,Height:r},x=C.ee(i,a),A=x.length,M=C.options.sparklineType;for(b=0;b<A;b++)l=x[b],u=C.ie(l,i,a),c=C.he(l,w,i,a,s),e.fillStyle!==u&&(e.fillStyle=u),0===M?(e.save(),f=t+c.X+c.Width/2,d=n+c.Y+c.Height/2,e.translate(f,d),e.rotate(45*p/180),e.fillRect(0-c.Width/2,0-c.Height/2,c.Width,c.Height),e.restore()):(g=t+c.X+c.Width/4,g=h(g),m=n+c.Y,y=c.Width/2,v=c.Height,e.fillRect(g,m,y,v))},e.prototype.be=function(e,t,n,o,r,i,a,s){var l,u,c,f,p,d,g,m=this,y=m.setting&&m.setting.options;y&&y.displayXAxis&&m.ke(i,a)&&(l={Width:o,Height:r},u=m.ce(s),c=l.Width-m.ce(s),p=f=h(m.le(l,i,s))+.5,d=m.options.getColor(y.axisColor),(g=s)<1&&(g=1),e.strokeStyle!==d&&(e.strokeStyle=d),e.lineWidth!==g&&(e.lineWidth=g),e.beginPath(),e.moveTo(t+u,n+f),e.lineTo(t+c,n+p),e.stroke())},e.prototype.me=function(e){var t,n=this.ne(e);return n===-N||(t=this.oe(e))===N||n===t||n*t<=0},e.prototype.ke=function(e,t){var n,o,r,i,a=this.me(e);if(2!==this.options.sparklineType)return a;if(o=(n=this.ee(e,t)).length,!a&&o>0)for(i=0;i<o;i++)if(typeof(r=e[n[i]])!==A&&r!==c)return!0;return a},e.prototype.pe=function(e,t){var n=this.Xd;return isNaN(n&&n.valueOf())&&this.qe(e,t),this.Xd},e.prototype.re=function(e,t){var n=this.Yd;return isNaN(n&&n.valueOf())&&this.qe(e,t),this.Yd},e.prototype.qe=function(e,t){var n,o,r,i,a=this,s=new Date(0,0,0),l=N,u=a.ee(e,t),f=u.length;for(i=0;i<f;i++)o=t[n=u[i]],isNaN(o)||((r=a.ge(n,e))!==c&&typeof r===A||isNaN(r)||typeof o!==A&&o!==c&&(o>s&&(s=o),o<l&&(l=o)));a.Yd=s,a.Xd=l},e.prototype.se=function(e,t,n,o){var r,i,a,s,l,u,c=this,f=c.pe(t,n),h=c.re(t,n),p=[],d=c.ee(t,n),g=d.length;for(r=0;r<g;r++)(i=n[d[r]])&&!isNaN(i)&&p.push(i);if(p.sort((function(e,t){return e-t})),(a=p.length)>1&&f!==h){for(s=N,l=0,void 0,r=1;r<a;r++)(i=p[r]-p[r-1])<s&&i>0&&(s=i),l+=i;return(u=(e.Width-c.ce(o)-c.ce(o))*s/l/2)<2&&(u=2),u}return(e.Width-c.ce(o)-c.ce(o))/2},e.prototype.te=function(e,t,n,o){var r,i=this;return i.options.displayDateAxis?i.se(e,t,n,o):(r=i.ee(t,n).length,(e.Width-i.ce(o)-i.ce(o))/r)},e.prototype.ue=function(e,t,n,o,r){var i,a,s,l,c,f,p,d=this,g=d.ce(r);return d.options.displayDateAxis?(i=d.te(e,n,o,r),(a=d.re(n,o))===(s=d.pe(n,o))?g+i/2:(l=o[t])?(c=e.Width-g-d.ce(r),c-=i,f=a.valueOf()-s.valueOf(),g+h((l.valueOf()-s.valueOf())/f*c)):0):(i=d.te(e,n,o,r),p=u(d.ee(n,o),t),h(g+i*p))},e.prototype.ve=function(e,t){var n,o=this,r=e.Width-o.ce(t)-o.ce(t);return r=y(r,0),n=e.Height-o.ce(t)-o.ce(t),{Width:r,Height:n=y(n,0)}},e.prototype.je=function(e){var t,n,o=this,r=e.length;for(n=0;n<r;n++)typeof(t=e[n])!==A&&t!==c&&("number"!=typeof t&&(t=0),t<o.Zd&&(o.Zd=t),t>o.$d&&(o.$d=t))},e.prototype.ne=function(e){var t,n,o=this;return o.$d!==-N&&o.$d||o.je(e),0===(n=(t=o.setting.options).maxAxisType)?o.$d:1===n?t.groupMaxValue:2===n?t.manualMax:o.$d},e.prototype.oe=function(e){var t,n,o=this;return o.Zd!==N&&o.Zd||o.je(e),0===(n=(t=o.setting.options).minAxisType)?o.Zd:1===n?t.groupMinValue:2===n?t.manualMin:void 0},e.prototype.we=function(e,t,n,o){var r,i=this.ve(e,o),a=this.ne(n),s=this.oe(n),l=a-s;if(a===s){if(0===a)return 0;l=w(a)}return(r=n[t])||(r=0),r*(i.Height/l)},e.prototype.xe=function(e,t,n,o){var r,i,a,s=this,l=s.options.sparklineType;if(0===l)return s.we(e,t,n,o);if(1===l){if(r=n[t],1===s.setting.options.displayEmptyCellsAs&&(typeof r===A||r===c))return 0;if((i=s.we(e,t,n,o))>-s.Wd&&i<s.Wd){if(r>0)return i+s.Wd;if(r<0)return i-s.Wd}return i}return 2===l?typeof(r=n[t])===A||r===c||0===r||isNaN(r)?0:(a=s.ve(e,o),r>=0?a.Height/2:-a.Height/2):void 0},e.prototype.ye=function(e,t,n){var o,r,i=this,a=i.ve(e,n),s=i.ne(t),l=i.oe(t);if(s===-N||l===N)return e.Height/2;if(o=s-l,s===l){if(0===s)return e.Height/2;o=s,s<0&&(s=0)}return r=a.Height/o,i.ce(n)+s*r},e.prototype.le=function(e,t,n){return 2===this.options.sparklineType?e.Height/2:this.ye(e,t,n)},e.prototype.ze=function(e,t,n,o){var r,i,a=this,s=a.ve(e,o),l=a.ne(n),u=a.oe(n),f=l-u;if(l===u){if(0===l)return 0;f=l}return r=s.Height/f,typeof(i=a.ge(t,n))!==A&&i!==c||(i=0),l!==u&&l*u>0?(0,i>=0?(i-u)*r:(i-l)*r):i*r},e.prototype.Ae=function(e,t,n,o){var r,i,a,s=this,l=s.options.sparklineType;return 0===l?s.ze(e,t,n,o):1===l?(r=s.ze(e,t,n,o))>-(i=s.Wd)&&r<i&&(typeof(a=s.ge(t,n))!==A&&a!==c||(a=0),0!==a)?a>0?r+i:r-i:r:2===l?s.xe(e,t,n,o):void 0},e.prototype.Be=function(e,t,n,o,r){var i,a,s,l,u,c,f,p,d,g=this,m=g.te(t,n,o,r),v=g.ue(t,e,n,o,r);return m<0&&(m=0),(m=h(m))%2==1&&(m+=1),i=g.xe(t,e,n,r),a=g.le(t,n,r),s=g.ne(n),l=g.oe(n),u=0,s<0&&l<0?u=y(g.ce(r),a):(u=a,i>=0&&(u=a-i)),c=g.Ae(t,e,n,r),f=new $(v,u,m,w(c)),0!==i&&(p=g.ce(r),f.Y<p&&f.Bottom<p+1?f.Height=h(f.Height+1):(d=t.Height-g.ce(r),f.Bottom>d&&f.Y>d-1&&(f.Y=d-c,f.Height=c))),f},e.prototype.de=function(e){var t=this.setting.options.lineWeight*e;return t<1&&(t=1),t},e.prototype.he=function(e,t,n,o,r){var i,a,s,l,u=this,f=u.de(r);return++f<2&&(f=2),i=u.Be(e,t,n,o,r),0===u.options.sparklineType&&(i.X=i.X+(i.Width-f)/2,typeof(a=u.ge(e,n))!==A&&a!==c?(a>=0?i.Y-=f/2:i.Y=i.Bottom-f/2,i.Width=f,i.Height=f):(i.Width=0,i.Height=0)),u.setting.options.rightToLeft&&(s=i.X,l=t.Width-s-i.Width,i=new $(l,i.Y,i.Width,i.Height)),i},e}(),t.SparklineRender=X,t.SparklineExRenders={PIESPARKLINE:function(e,t,n,o,r,i){var s,l,u,c,f,h,y=n+r/2,v=o+i/2,b=m(r,i)/2-5,C=-.5*p,x=y+b*g(C),A=v+b*d(C),M=[],T=[];if(!(b<=0)){for(c=pe(u=(l=ue(t.values,(function(e){return!a(e)&&!S(e)&&isFinite(e)}),(function(e){return w(e)}),(function(e){1===e.length&&(e[1]=1-e[0])}))).length,t.colors),f=le(l),e.save(),h=0;h<u;h++)s=C+l[h]/f*2*p,e.beginPath(),e.moveTo(y,v),e.lineTo(x,A),e.arc(y,v,b,C,s,!1),e.lineTo(y,v),e.fillStyle=c[h],e.fill(),M.push(x),T.push(A),x=y+b*g(C=s),A=v+b*d(C);for(h=0;h<u;h++)re(e,y,v,M[h],T[h],j);e.restore()}},AREASPARKLINE:function(e,t,n,o,r,i){var s,l,u,f,h,p,d,g,b,C,w,x,M,T,N,I,R,E,D,j,_,F,P,H,B,L,z,V,G,W,U;for(e.save(),s=t.points,l=t.mini,u=t.maxi,f=t.line1,h=t.line2,p=t.colorPositive,d=t.colorNegative,5,s=ue(s,(function(e){return!a(e)&&!S(e)&&isFinite(e)})),p=a(p)?"#787878":p,d=a(d)?k:d,E=oe(s,!1),u=a(u)?E:u,b=y(u,E),D=oe(s,!0),l=a(l)?D:l,g=m(l,D),C=(C=(C=0)>(b=b<0?0:b)?b:C)<(g=g>0?0:g)?g-1:C,w=s.length,j=se(n,o,r,i,5),x=j.left,M=j.top,T=j.width,N=j.height,I=T/(w-1),_=[],L=M+(b-C)/(R=(b-g)/N),G=0;G<w;G++)F=s[G],z=x+I*G,V=M+(b-F)/R,0===G&&_.push(new Z(de(z,L,C))),G>0&&F*s[G-1]<0&&((H=_[_.length-1])&&(B=ge(H.x,H.y,z,V,L),_.push(new Z(de(B,L,C))))),_.push(new Z(de(z,V,F))),G===w-1&&_.push(new Z(de(z,L,C)));for(e.beginPath(),W=0,U=_.length;W<U;W++)(P=_[W])&&(0===W?e.moveTo(P.x,P.y):e.lineTo(P.x,P.y),H=_[W-1],P.value===C&&H&&(e.fillStyle=H.value>C?p:d,e.fill(),W!==U-1&&(e.beginPath(),e.moveTo(P.x,P.y))));function q(t){var n,o;t===c&&typeof t!==A||(n=fe(t,b,g),o=v(M+(0!==R?(b-n)/R:N/2))-.5,re(e,x,o,x+T,o,O))}q(f),q(h),e.restore()},SCATTERSPARKLINE:function(e,t,n,o,r,i){var s,l,u,c,f,h,d,g,b,C,w,x,A,M,S,T,I,E,j,_,O,F,P,H,B,L,z=t.points1,V=t.points2,G=t.minX,W=t.maxX,U=t.minY,Z=t.maxY,q=t.hLine,J=t.vLine,Q=t.xMinZone,Y=t.xMaxZone,K=t.yMinZone,$=t.yMaxZone,X=t.tags,ee=t.drawSymbol,te=t.drawLines,ne=t.color1,oe=t.color2,re=t.dash,ie=se(n,o,r,i,5),ae=ie.left,le=ie.top,ue=ie.width,fe=ie.height;function pe(t,n,o,r){g=t[n],C=g.x,w=g.y,g=t[n+1],x=g.x,A=g.y,M=ae+(C-f)*ue/(h-f),T=ae+(x-f)*ue/(h-f),S=le+(c-w)*fe/(c-u),I=le+(c-A)*fe/(c-u),te&&ve(e,M,S,T,I,o,re),ee&&(0===n&&r(M,S),r(T,I))}function de(e,t,n,o,r){var i=me(e,!0),s=me(e,!1);u=a(U)?i.y:t,c=a(Z)?s.y:n,f=a(G)?i.x:o,h=a(W)?s.x:r,h=f>=h?f+1:h,c=u>=c?u+1:c}function ge(t,n,o){e.beginPath(),e.arc(t-2,n-2,2,0,2*p,!1),e.fillStyle=o,e.fill()}function ye(t,n){e.beginPath(),e.strokeStyle=ne,e.arc(t-2,n-2,2,0,2*p,!1),e.stroke()}function Ce(t,n){e.beginPath(),e.strokeStyle=oe,e.strokeRect(t-2,n-2,4,4)}if(z&&!(z.length<=0)&&!((s=be(z)).length<=0||V&&V.length>0&&(l=be(V),l.length<=0))){for(he(e,n,o,r,i),e.beginPath(),ee=!!a(ee)||ee,ne=a(ne)?R:ne,oe=a(oe)?k:oe,de(s,U,Z,G,W),!a(Q)&&!a(Y)&&!a(K)&&!a($)&&f<=Q&&Q<=h&&f<=Y&&Y<=h&&u<=K&&K<=c&&u<=$&&$<=c&&((P=y(f,Q))>=(H=m(h,Y))&&(H=P+1),(B=y(u,K))>=(L=m(c,$))&&(L=B+1),ce(e,ae+(P-f)*ue/(h-f),le+(c-L)*fe/(c-u),(H-P)*ue/(h-f),(L-B)*fe/(c-u),D)),E=-N,j=-N,_=N,O=N,d=0,b=s.length;d<b-1;d++)pe(s,d,ne,ye),X&&(0===d&&(S>j&&(E=M,j=S),S<O&&(_=M,O=S)),I>j&&(E=T,j=I),I<O&&(_=T,O=I));if(l&&l.length>0)for(de(l,u,c,f,h),d=0,b=l.length;d<b-1;d++)pe(l,d,oe,Ce);X&&(ge(E,j,k),ge(_,O,"#0000FF")),!a(q)&&u<=q&&q<=c&&(F=v(le+(c-q)*fe/(c-u))-.5,ve(e,ae,F,ae+ue,F,k)),!a(J)&&f<=J&&J<=h&&(F=v(ae+(J-f)*ue/(h-f))-.5,ve(e,F,le,F,le+fe,k)),e.restore()}},BULLETSPARKLINE:function(e,t,n,o,r,i){var l,u,c,f,p,d,g,m,y,b,C,w,x,A,M,T=t.measure,N=t.target,I=t.maxi,R=t.good,D=t.bad,j=t.forecast,_=t.tickUnit,O=t.colorScheme,F=t.vertical,P=t.measureColor,H=t.targetColor,B=t.maxiColor,L=t.goodColor,z=t.badColor,V=t.forecastColor,G=t.allowMeasureOverMaxi,W=t.barSize;function Z(t,a,s,l,u){var h,p,d;e.fillStyle=t,h=c,(p=f*(a/s))>f&&!G&&(p=f),d=new U(F?ne(n+r*l,h-p,r*u,p):ne(h,o+i*l,p,i*u)),e.fillRect(d.x,d.y,d.width,d.height)}if(!(a(I)||I<0)&&(a(W)||!(S(W)||W<=0))){if(W>1&&(W=1),T=a(T)||T<0?0:T,R=a(R)||R<0?0:R,D=a(D)||D<0?0:D,N=a(N)?0:N,j=a(j)?0:j,_=a(_)?0:_,O=a(O)?"#A0A0A0":O,l=a(P)?"#252525":P,T>I&&!G&&(T=I,l=k),R>I&&(R=I,l=k),D>I&&(D=I,l=k),N>I&&(N=0,l=k),j>I&&(j=I,l=k),u=se(n,o,r,i,5,i-10,F),c=u.left,f=u.width,e.save(),p=a(W)?.2:(1-W)/2,d=a(W)?.6:W,g=G?Math.max(I,T):I,Z(a(B)?s(O,1.66):B,I,g,p,d),Z(a(L)?s(O,1.33):L,R,g,p,d),Z(a(z)?O:z,D,g,p,d),m=.25*W/.6,Z(l,T,g,a(W)?.375:(1-m)/2,a(W)?.25:m),j>0&&(y=c,(b=f*(j/g))>f&&(b=f),C=a(W)?3:3*W/.6,ie(e,F,n+.5*r,y,n+.5*r,y-b,y,o+.5*i,y+b,o+.5*i,a(V)?"#3690BF":V,C)),N>0&&(w=v(c-(F?1:-1)*f*(N/g))-.5,ie(e,F,n+r*p,w,n+r*(1-p),w,w,o+i*p,w,o+i*(1-p),a(H)?k:H,1)),_>0)for(x=h(g/_),A=void 0,M=0;M<=x;M++)A=v(c-f/g*_*(F?1:-1)*M)-.5,ie(e,F,n,A,n+.05*r,A,A,o+i,A,o+.95*i,E,1);e.restore()}},SPREADSPARKLINE:function(e,t,n,o,r,i){var s,l,u,c,f,h,p,d,g,b,C,w,x,A,M,S,T,N,I,R=t.spreadData,D=t.showAverage,j=t.scaleStart,_=t.scaleEnd,O=t.style,F=t.colorScheme,P=t.vertical,H=R.length;if(!(H<=0)){for(s=R[0].key,l=R[H-1].key,j=a(j)?s:j,_=a(_)?l:_,O=a(O)?4:O,F=a(F)?E:F,c=(u=se(n,o,r,i,5,i-10,P)).left,f=u.width,h=u.top,p=u.height,he(e,n,o,r,i),e.beginPath(),e.strokeStyle=F,e.fillStyle=F,e.lineWidth=2,b=oe(R,!1),w=0,x=R.length;w<x;w++)if(M=(A=R[w]).key,S=A.value,d=c+(P?-1:1)*f*(M-j)/(_-j),P?(d=m(d,c),d=y(d,c-f)):(d=y(d,c),d=m(d,c+f)),d=v(d),1===O)ie(e,P,T=h+p/2-(C=(C=S/2*p/b)<.5?.5:C),d,N=h+p/2+C,d,d,T,d,N);else if(4===O)ie(e,P,h,d,h+(C=(C=S*p/b)<1?1:C),d,d,h+p,d,h+p-C);else if(6===O)ie(e,P,h,d,h+p,d,d,h,d,h+p);else for(2,I=1;I<=S;I++){switch(O){case 2:g=h+p/2-5-(S/2-I)*p/b;break;case 3:g=h+p-5-Ce(S,p,3,A.randomNumbers)[I-1];break;case 5:default:g=h+p-I*p/b}g=v(g),e.beginPath(),e.fillRect(P?g:d,P?d:g,2,2)}D&&ie(e,P,h-5,d=c-(P?1:-1)*f*(function(e){var t,n,o,r=0,i=0;for(t=0,n=e.length;t<n;t++)o=e[t],i+=o.value,r+=o.key*o.value;return 0===i?0:r/i}(R)-j)/(_-j),h+p+5,d,d,h-5,d,h+p+5,k),e.restore()}},STACKEDSPARKLINE:function(e,t,n,o,r,i,l){var u,h,p,d,g,m,y,b,C,w,x,A,M,T,N,I,R,D,j,_=t.points,P=t.colorRange,H=t.labelRange,L=t.maximum,z=t.targetRed,W=t.targetGreen,U=t.targetBlue,Z=t.targetYellow,q=t.color,J=t.highlightPosition,Q=t.vertical,Y=t.textOrientation,K=t.textSize;function $(t,n,o){var r,i;n!==c&&n!==f&&(n=n>L?L:n,o&&!o(n)||(i=(n=n<0?0:n)/L*m,Q?(r=v(g-i)-.5,re(e,y,r,y+b,r,t)):(r=v(g+i)-.5,re(e,r,y,r,y+b,t))))}if(!(a(_)||(u=_.length)<=0)){if(q=a(q)?E:q,a(P)||P.length!==u||function(e){for(var t=0,n=e.length;t<n;t++)if(a(e[t]))return!0;return!1}(P))for(P=[],h=0;h<u;h++)P.push(s(q,1+h/u));for(p=le(_,(function(e){return e>0})),L=a(L)||L<p?p:L,Y=a(Y)?0:Y,K=a(K)||K<=0?10:K,K=S(K)?K:K*l.zoomFactor,d=se(n,o,r,i,5,i-10,Q),g=d.left,m=d.width,y=d.top,b=d.height,e.save(),C=g,I=0,R=u;I<R;I++)(N=_[I])<=0||(w=N/L*m,Q?(x=n+.15*r,M=.7*r,A=C-w,T=w):(x=C,M=w,A=o+.15*i,T=.7*i),D=I+1===J?k:P[I],e.save(),e.fillStyle=D,e.fillRect(x,A,M,T),(j=H&&H[I])&&(e.save(),e.fillStyle=ae(D),e.textBaseline=V,e.textAlign=B,e.font=K+G,e.rect(x,A,M,T),e.clip(),1===Y?(e.translate(x+M/2,A),e.rotate(Math.PI/2),e.fillText(j,T/2,0)):e.fillText(j,x+M/2,A+T/2),e.restore()),C+=(Q?-1:1)*w,e.restore());$("red",z,(function(e){return e>0})),$(F,W),$(O,U),$("yellow",Z),e.restore()}},HBARSPARKLINE:function(e,t,n,o,r,i){Me(0,e,t,n,o,r,i)},VBARSPARKLINE:function(e,t,n,o,r,i){Me(1,e,t,n,o,r,i)},VARISPARKLINE:function(e,t,n,o,r,i,s){var l,u,c,f,h,p,d,g,m,y,v,b,x,A,M,N,I,E,D,j,O,W=t.variance,U=t.reference,Z=t.mini,q=t.maxi,J=t.mark,Q=t.tickUnit,Y=t.legend,K=t.colorPositive,$=t.colorNegative,X=t.vertical,ee=k,te=R,ne=13*s.zoomFactor,oe=T(W);function re(t,a,s,u,c,f,d,m,y,v,b,w,x,S){var T,N,I,R,k;X?ce(e,T=n+.25*r,N=0===a?A-M:A,I=.5*r,R=M,t):ce(e,T=0===a?A:A-M,N=o+.25*i,I=M,R=.5*i,t),g&&(he(e,T,N,I,R),X?Ae(e,n+r/2,l+s,p,c):Ae(e,l+u,o+i/2,p,f),e.restore()),Y&&(void 0,k=0,g&&(k=.4*p*C(3)/2+5+2),e.save(),e.beginPath(),e.font=ne+G,e.fillStyle=_,X?(e.textAlign=B,ie(ne+M+d,S,t,m,y,T,N,I,R,X),e.fillText(h,n+r/2,A+x*(M-k))):(e.textBaseline=V,ie(e.measureText(h).width+M+v,S,t,b,w,T,N,I,R,X),e.fillText(h,A+x*(k-M),o+i/2)),e.restore())}function ie(t,n,o,r,i,a,s,l,u,c){c?e.textBaseline=r:e.textAlign=r,t>0&&n<M&&(e.rect(a,s,l,u),e.clip(),c?e.textBaseline=i:e.textAlign=i,e.fillStyle=ae(o))}function se(t,n,o,r,i,a,s,l,u,c){X?xe(e,t,n,o,r,u):xe(e,i,a,s,l,c)}if(!(S(oe)||($=a($)?"red":$,K=a(K)?F:K,Q=a(Q)?0:Q,q=a(q)?1:q,Z=a(Z)?-1:Z,d=!a(U),d||(U=0),X?(l=o+i-5,u=i-10,c=r-20,f=-1):(l=n+5,u=r-10,c=i-20,f=1),Y&&(m=T(t.variance),S(m)||(y=""+m,v=y.substr(y.indexOf(".")+1).length,h=v>=2?(100*m).toFixed(v-2)+"%":(100*m).toFixed(0)+"%")),oe>q&&(oe=q,g=!0),oe<Z&&(oe=Z,g=!0),U=fe(U,q,Z),g&&(p=fe(c,60,15)),b=w(q-Z),x=u/b,A=l+f*w(Z-U)*x,M=w(oe-U)*x,M>w(b)*x&&(M=w(b+Z)*x),N=l+f*u,X&&A<N||!X&&A>N))){if(he(e,n,o,r,i),oe>U?re(K,0,5-u,u-5,0,1,o-A,z,L,A-n-r,P,H,-1,w(q-oe)*x):(M>w(b)*x&&(M=w(b+Z)*x,A=l),re($,1,-5,5,2,3,A-o-i,L,z,n-A,H,P,1,w(Z-oe)*x)),d&&(I=l+f*(Math.abs(Z-U)*x),se(n,I,n+r,I,I,o,I,o+i)),Q>0)for(e.beginPath(),E=b/Q,D=0;D<=E;D++)se(n,j=l+u/E*D*f,n+.1*r,j,j,o+.9*i,j,o+i,te,te);!a(J)&&Z<=J&&J<=q&&(e.beginPath(),O=l-(X?1:-1)*w(Z-J)*x,se(n,O,n+.33*r,O,O,o+.66*i,O,o+i,ee,ee),e.fill()),e.restore()}},BOXPLOTSPARKLINE:function(e,t,n,o,r,i){var s,l,u,f,h,p,d,g,v,b,C,x,A,N,I,D,j,_,O,F,P,H,B,L,z,V,G,W,U,Z,$,X,ee,te,ne,re,ae,fe,pe,de,ge,me,ye,ve,be,Ce,we,xe,Ae,Me,Se,Te,Ne,Ie=t.points,Re=t.boxPlotClass,ke=t.showAverage,Ee=t.scaleStart,De=t.scaleEnd,je=t.acceptableStart,_e=t.acceptableEnd,Oe=t.style,Fe=t.colorScheme,Pe=t.vertical,He=oe(Ie,!1),Be=oe(Ie,!0);function Le(t,n,o,r,i,a,s,l,u){Pe?ce(e,n,o,r,i,t):ce(e,a,s,l,u,t)}function ze(t,n,o,r){ie(e,Pe,U+Z*t,o,U+Z*n,o,o,U+Z*t,o,U+Z*n,r)}if(!(a(Ie)||(Ie=ue(Ie),Ie.length<=0))){for((Re=Re===c||typeof Re!==M?J:Re.toLocaleLowerCase())!==J&&Re!==q&&Re!==Q&&Re!==Y&&Re!==K&&(Re=J),s=T(Ee),s=S(s)?Be:s,l=T(De),l=S(l)?He:l,u=T(je),f=T(_e),Fe!==c&&typeof Fe===M||(Fe="#D2D2D2"),(Oe===c||0!==Oe&&1!==Oe)&&(Oe=0),h=k,s>Be&&(Fe=h,s=Be),l<He&&(Fe=h,l=He),he(e,n,o,r,i),e.lineWidth=2,d=(p=se(n,o,r,i,5,i-10,Pe)).left,g=p.width,v=p.top,b=p.height,C=Pe?-1:1,x=t.perc02,A=t.perc09,N=t.perc10,I=t.perc90,D=t.perc91,j=t.perc98,_=t.q1,P=Be,H=He,B=1.5*(F=(O=t.q3)-_),L=1.5*F,z=t.stDev,V=le(Ie)/y(1,Ie.length),G=0,W=0,U=v+.1*b,Z=.7*b,$=w(l-s),X=0,ee=Ie.length;X<ee;X++)(te=Ie[X])<_&&te>=_-1.5*F&&te-(_-1.5*F)<B&&(B=te-(_-1.5*F),P=te),te>O&&te<=O+1.5*F&&O+1.5*F-te<L&&(L=O+1.5*F-te,H=te),ne=!1,G=d+C*(g*((te-s)/$)),Re===Q&&(te<=_-1.5*F||te>=O+1.5*F)&&(ne=!0,W=te<=_-3*F||te>=O+3*F?0:1),Re===q&&(te<=x||te>=j)&&(ne=!0,W=1),Re===K&&(te<=V-2*z||te>=V+2*z)&&(ne=!0,W=te<=V-3*z||te>=V+3*z?0:1),re=R,ne&&(1===Oe?1===W?ze(.2,.8,G,re):ze(.3,.7,G,re):((ae=.1*b)<2&&(ae=2),e.beginPath(),e.strokeStyle=re,fe=v+.45*b,pe=G,e.arc(Pe?fe:pe,Pe?pe:fe,ae/2,0,2*Math.PI),e.stroke()));switch((s>u||l<f)&&(Fe="#C0FF00"),(u=y(s,u))>(f=m(l,f))?Fe=h:u<f&&ie(e,Pe,me=v+.9*b,de=d+C*(g*((u-s)/$)),me,ge=d+C*(g*((f-s)/$)),de,me,ge,me,E),ve=w(d+C*(g*((O-s)/$))-(ye=d+C*(g*((_-s)/$)))),be=d+C*(g*((t.median-s)/$)),Re){case q:xe=x,Ae=j;break;case Q:xe=P,Ae=H;break;case K:ve=w(d+C*(g*((V+z-s)/$))-(ye=d+C*(g*((V-z-s)/$)))),be=d+C*(g*((V-s)/$)),xe=(Me=V-2*z)>s?Me:Be,Ae=(Me=V+2*z)<l?Me:He,ke=!1;break;case J:case Y:default:xe=Be,Ae=He}Ce=d+C*(g*((xe-s)/$)),we=d+C*(g*((Ae-s)/$)),Se=R,1===Oe?Le("#F2F2F2",U,we,Z,Ce-we,Ce,U,we-Ce,Z):ie(e,Pe,Te=v+.45*b,Ce,Te,we,Ce,Te,we,Te,Se),Le(Fe,U,ye-ve,Z,ve,ye,U,ve,Z),ie(e,Pe,U,be,U+Z,be,be,U,be,U+Z,Se),0===Oe&&(ie(e,Pe,U+.3*Z,we,U+.7*Z,we,we,U+.3*Z,we,U+.7*Z,Se),ie(e,Pe,U+.3*Z,Ce,U+.7*Z,Ce,Ce,U+.3*Z,Ce,U+.7*Z,Se)),Re!==q&&Re!==Y||(void 0,void 0,Re===q?(xe=A,Ae=D):(xe=N,Ae=I),Ne=d+C*(g*((xe-s)/$)),ze(.3,.7,d+C*(g*((Ae-s)/$)),Se),ze(.3,.7,Ne,Se)),ke&&ze(.2,.8,G=d+C*(g*((V-s)/$)),h),e.restore()}},CASCADESPARKLINE:function(e,t,n,o,r,i,l){var u,f,h,p,d,g,v,b,C,x,A,N,I,R,k,E,j,O,F,P,H,B,L,z,V,G,W,U,Z,q,J,Q,Y,K,$,X,ee,te,ne,oe,re,ie=t.points,ae=t.labels,le=t.pointIndex,ue=t.minimum,fe=t.maximum,pe=t.colorPositive,de=t.colorNegative,ge=t.vertical,me=t.itemTypeRange,ye=t.colorTotal,ve=13*l.zoomFactor;if(!(a(ie)||(u=ie.length,u<=0||(f=parseInt(le,10),S(f)||f<=0||f>u)))){for(ae=a(ae)?[]:ae,pe!==c&&typeof pe===M||(pe="#8CBF64"),de!==c&&typeof de===M||(de="#D6604D"),typeof ye!==M&&(ye=c),h=pe,p=s(pe,1.3),d=de,g=s(de,1.3),v=1,b=0,C=0,x=0,A=0,N=[],I=0,R=0,E=0,j=u;E<j;E++)R=ie[E],k=me[E],O=!1,a(k)||("+"===k?R=w(R):"-"===k?R=-w(R):"="===k&&(O=!0,R=b)),N[v]=[],F=N[v],S(R)?(F[0]=0,F[1]=b,F[2]=0):(F[0]=w(R),b=O?b:R+b,F[1]=R>0?C:b,F[2]=R),F[3]=v,x=m(C,x),A=y(C,A),(a(k)&&v===u||O)&&(I=x<0?-x:0,F[1]=R>0?0:R),!a(k)&&O||(C=R+C),v++;a(k)&&(b-=R),B=T(ue),S(B)||B>0||B>x?(P=x,B=x):(P=B,I=-B),L=T(fe),S(L)||L<0||L<A?H=A:(H=L,I=-B),V=(z=se(n,o,r,i,5,i-10,ge)).left,G=z.width,W=z.top,U=z.height,Z=ge?-1:1,q=G/(H-P),he(e,n,o,r,i),e.beginPath(),e.lineWidth=1,Q=(J=N[f])[2],Y=me[f-1],K=V+Z*(J[1]+I)*q,$=J[0]*q,ee="="===Y,te=a(Y)&&f===u||ee,X=ye&&te?ye:1===f||te?Q>=0?h:d:Q>=0?p:g,ge?ce(e,W,K-$,U,$,X):ce(e,K,W,$,U,X),ge?(1!==f&&(f!==u?Ne(e,Q>0,D,n,K,W+U,K,n,K-$,W+U,K-$):Ne(e,!0,D,n,ne=V-(b+I)*q,W+U,ne)),f!==u&&Ne(e,Q>0,D,W,K-$,n+r,K-$,W,K,n+r,K)):(1!==f&&(f!==u?Ne(e,Q>0,D,K,o,K,W+U,K+$,o,K+$,W+U):Ne(e,!0,D,oe=V+(b+I)*q,o,oe,W+U)),f!==u&&Ne(e,Q>0,D,K+$,W,K+$,o+i,K,W,K,o+i)),re=ae[f-1],ae.length>0&&!a(re)&&""!==re&&Re(e,n,o,r,i,{labelText:re,vertical:ge,isInRightOrTopOfBox:Q>0,fontSize:ve,startBox:K,endBox:$,boxColor:X}),Ne(e,ge,_,n,V-I*q,n+r,V-I*q,V+I*q,o,V+I*q,o+i),e.restore()}},PARETOSPARKLINE:function(e,t,n,o,r,i,s){var l,u,c,f,h,p,d,g,m,y,b,C,w,A,N,I,E,D,j,_,O,F,P,H,B,L,z=t.points,V=t.pointIndex,G=t.colorRange,W=t.target,U=t.target2,Z=t.highlightPosition,q=t.label,J=t.vertical,Q=13*s.zoomFactor,Y=t.targetColor,K=t.target2Color,$=t.labelColor,X=t.barSize;if(!a(z)&&(a(X)||!(S(X)||X<=0))&&(X>1&&(X=1),!((l=z.length)<=0||(u=parseInt(V,10),S(u)||u<=0||u>l)))){for(G=a(G)?[]:G,c=parseInt(q,10),c=S(c)?0:c,f=1,h=0,p=[],d=0,g=z.length;d<g;d++)m=z[d],p[f]=[],y=p[f],m<0||S(m)||a(m)?(y[0]=1===f?0:h,y[1]=0):(h+=m,y[0]=1===f?0:h-m,y[1]=m),f++;5,b=a(X)?5:J?r*(1-X)/2:i*(1-X)/2,C=se(n,o,r,i,b,i-10,J,5),w=C.left,A=C.width,N=C.top,I=C.height,E=J?-1:1,D=A/h,he(e,n,o,r,i),e.beginPath(),e.lineWidth=1,_=(j=p[u])[1],O=w+E*j[0]*D,F=j[1]*D,P=u===Z?k:0===G.length||typeof G[u-1]!==M?R:G[u-1],J?ce(e,N,O-F,I,F,P):ce(e,O,N,F,I,P),1===c?H=(j[0]+_)/h*1e3:2===c&&(H=_/h*1e3),B=v(H)/10+"%",1!==c&&2!==c||""===B||Re(e,n,o,r,i,{labelText:B,vertical:J,isInRightOrTopOfBox:(j[0]+j[1])*D<A/2,fontSize:Q,startBox:O,endBox:F,boxColor:P,fillStyle:$}),L=[a(Y)?"#8CBF64":Y,a(K)?"#EE5D5D":K],[W,U].forEach((function(t,a){var s=function(e){var t=T(e);return(t=(t=S(t)?0:t)<0?0:t)>1?1:t}(t),l=x(w+E*A*s);Ne(e,J,L[a],n,l,n+r,l,l,o,l,o+i)})),e.restore()}},MONTHSPARKLINE:function(e,t,n,o,r,i){var a,s,l,u,c=t.year,f=t.month,h=t.values,p=t.emptyColor||"lightgray",d=t.startColor,g=t.middleColor,m=t.endColor,y="white",v=(r-14)/6,b=(i-16)/7,C=[],w=new Date(c,f-1,1).getDay();for(a=0;a<42;a++)a<w?C[a]=y:a<w+ke(c,f)?C[a]=p:C[a]=y;for(je(h,C,w,t.colors,d,g,m),e.save(),e.rect(n,o,r,i),e.clip(),e.beginPath(),s=0,l=0;l<6;l++)for(u=0;u<7;u++)e.fillStyle=C[s++],e.fillRect(n+l*v+2*(l+1),o+u*b+2*(u+1),v,b);e.restore()},YEARSPARKLINE:function(e,t,n,o,r,i,a){var s,l,u,c,f,h,p,d,g,m,y,v,b,C,w,x,A,M,S,T,N,I,R=t.year,k=t.values,E=t.emptyColor||"lightgray",D=t.startColor,j=t.middleColor,_=t.endColor,O="white",F=parseInt(366/7+"",10)+2,P=[],H=new Date(R,0,1).getDay(),B=_e(new Date(R,11,31));for(s=0;s<7*F;s++)P[s]=s<H?O:s<H+B?E:O;for(je(k,P,H,t.colors,D,j,_),e.save(),e.rect(n,o,r,i),e.clip(),c=n+(u=15*(l=a.zoomFactor)),f=o,h=r-u,p=i,e.save(),e.translate(n+u/2,f+p),e.rotate(-Math.PI/2),e.font=13*l+G,e.fillStyle="black",e.textBaseline="middle",e.textAlign="center",e.fillText(R+"",p/2,0),e.restore(),2,d=(h-2*(F+1))/F,g=(p-16)/7,m=0,C=[],v=0;v<F;v++)for(y=0;y<7;y++)b={x:c+v*d+2*(v+1),y:f+y*g+2*(y+1),w:d,h:g},C[m]=b,e.fillStyle=P[m++],e.fillRect(b.x,b.y,b.w,b.h);for(w=[],x={},A=0;A<12;A++)x[A]=_e(new Date(R,A,1))-1+H;for(M=x[11]+ke(R,12)-1,m=0,v=0;v<F;v++)for(y=0;y<7;y++)H<=m&&m<H+B&&(T=x[(S=new Date(R,0,m-H+1)).getMonth()],b=C[m],T<=m&&m<7+T&&w.push({x1:b.x,y1:b.y-1,x2:b.x,y2:b.y+b.h+1}),m!==T&&0!==S.getDay()||w.push({x1:b.x-1,y1:b.y,x2:b.x+b.w+1+(m===T?2:0),y2:b.y}),M-7<m&&m<=M&&w.push({x1:b.x+b.w,y1:b.y-1,x2:b.x+b.w,y2:b.y+b.h+1}),m!==M&&6!==S.getDay()||w.push({x1:b.x-1-(m===M?2:0),y1:b.y+b.h,x2:b.x+b.w+1,y2:b.y+b.h})),m++;for(e.strokeStyle="black",e.lineWidth=2,N=0;N<w.length;N++)I=w[N],e.beginPath(),e.moveTo(I.x1,I.y1),e.lineTo(I.x2,I.y2),e.stroke();e.restore()}}}}),e.exports=n.Spread},"./node_modules_local/@grapecity/js-sheets-common/index.js":function(e,t,n){e.exports=n("./node_modules_local/@grapecity/js-sheets-common/dist/gc.spread.common.js")},"@grapecity/js-calc":function(e,t){e.exports=i.Spread.CalcEngine},"@grapecity/js-sheets-common":function(e,t){e.exports=i.Spread},Bindings:function(e,t){e.exports=i.Spread.Sheets.Bindings},CellTypes:function(e,t){e.exports=i.Spread.Sheets.CellTypes},ConditionalFormatting:function(e,t){e.exports=i.Spread.Sheets.ConditionalFormatting},Core:function(e,t){e.exports=i.Spread.Sheets},Filters:function(e,t){e.exports=i.Spread.Sheets.Filter},SheetsCalc:function(e,t){e.exports=i.Spread.Sheets.CalcEngine},Sparkline:function(e,t){e.exports=i.Spread.Sheets.Sparklines}}),r=i||{},"object"==typeof e.exports?e.exports=r:void 0===(o=function(){return r}.apply(t,[]))||(e.exports=o)}}]);